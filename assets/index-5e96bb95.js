import{L as I,h as R,p as B,B as re,C as U,v as c,z as S,t as l,ap as ie,ak as oe,aa as se,as as le,aJ as de,aK as ce,a2 as Z,am as ue,q as V,af as L,R as x,aB as W,M as H,O as K,aR as me,aS as pe,s as fe}from"./index-9eb3c9b0.js";import{m as he,E as ye}from"./el-select-79c11062.js";import{C as T}from"./index-0cebeaed.js";import{_ as ve}from"./next-97e487b5.js";import{e as be,c as ge}from"./index-f7adadce.js";import{V as we}from"./index.min-bc40f02e.js";const Se=c("span",{class:"dialog-footer"},null,-1),xe={__name:"dialog",props:["dialogVisible","data"],emits:["closeDialog"],setup(J,{emit:r}){const p=J;let _=I();async function O(){we.preview(_.value,`

`+g.value)}function D(m){if(!m)return"0.00";var m=Math.round(parseFloat(m)*100)/100,h=m.toString().split(".");if(h.length==1)return m=m.toString()+".00",m;if(h.length>1)return h[1].length<2&&(m=m.toString()+"0"),m}R(()=>p.dialogVisible);function A($,m=0){let h=`
`;const w=y=>"  ".repeat(y);for(const[y,v]of Object.entries($))typeof v=="object"&&v!==null?(h+=`${w(m)}- **${y}**
`,h+=A(v,m+1)):h+=`${w(m)}- ${y}: ${v}
`;return h}function k($){return new Date($).toISOString()}let g=R(()=>{let $=()=>{let h="";for(const w in p.data.resources){const y=p.data.resources[w];h+=`The resource with ID ${y.resourceId} was originally planned to have ${D(y.plannedUnits)} units. The initial planned usage rate was ${D(y.plannedUnitsPerHour)} units per hour, and it currently remains at ${D(y.Units)} units per hour. However, after optimization, the new usage rate is ${D(y.newUnitsPerHour)} units per hour, and the new daily usage is ${D(y.newUnitsPerDay)} units per day.
`}return h};return`This is a task named '${p.data.name}' categorized as '${p.data.type}', and it is ${p.data.critical==!0?"":"not"} a Critical Task.
   Before optimization,
   it is scheduled to start on ${k(p.data.plannedStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${k(p.data.plannedFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${p.data.remainingDuration} hours. 
  After optimization,
   it is scheduled to start on ${k(p.data.newStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${k(p.data.newFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${p.data.newDuration} hours. 
Resources:
${$()}As of now, the task has not commenced and is labeled as '${p.data.status}.' The task's duration ratio is ${D(p.data.durationRatio)}.`+A(p.data)});const E=()=>{r("closeDialog")};return($,m)=>{const h=ie;return B(),re(h,{onOpen:O,onClose:E,modelValue:p.dialogVisible,"onUpdate:modelValue":m[0]||(m[0]=w=>p.dialogVisible=w),title:"Detailed content",width:"50%",draggable:""},{footer:U(()=>[Se]),default:U(()=>[c("span",null,S(l(g).id),1),c("div",{ref_key:"editorRef",ref:_},null,512)]),_:1},8,["modelValue"])}}};const _e={class:"contain"},De={class:"box"},$e={class:"sp"},Ce={class:"step"},ze={class:"step"},ke={class:"maintop"},Ie={class:"mainEchar1"},Re={class:"Echar1top"},Ne=me('<div class="choosebox" data-v-bf6e11cd><div class="choose" data-v-bf6e11cd><div style="background-color:#b0e054;" class="item" data-v-bf6e11cd></div><div data-v-bf6e11cd>Optimized</div></div><div class="choose" data-v-bf6e11cd><div style="background-color:#5474c4;" class="item" data-v-bf6e11cd></div><div data-v-bf6e11cd>Baseline</div></div><div class="choose" data-v-bf6e11cd><div style="background-color:red;" class="item" data-v-bf6e11cd></div><div data-v-bf6e11cd>Critical Path</div></div><div class="choose" data-v-bf6e11cd><div style="background-color:pink;" class="item" data-v-bf6e11cd></div><div data-v-bf6e11cd>Critical Path(Baseline)</div></div></div><div id="main" data-v-bf6e11cd></div>',2),Be={ref:"main",style:{width:"1350px",height:"610px"},id:"myEcharts"},Oe={class:"mainEchar2"},Me={class:"Echar2top"},Fe={class:"resources-title"},Ve={class:"types"},Ue={ref:"main01",style:{width:"1350px",height:"610px"},id:"myEcharts01"},Ae={class:"button"},Ee={__name:"index",setup(J){const r=se(),p=le();let _=I("Compare"),O=I(!1),D=I("");const A=()=>{O.value=!1};de((t,a,n)=>{t.name=="InputData",n()}),ce(()=>{r.selectChange&&(C.value="",q(),P(),r.selectChange=!1)});function k(t,a){return Math.round(t/a*1e4)/100+"%"}function g(t){return new Date(t).toISOString()}function E(t){const a=new Date(t);return`${a.getUTCFullYear()}/${a.getUTCMonth()+1}/${a.getUTCDate()} ${("0"+a.getUTCHours()).slice(-2)}:${("0"+a.getUTCMinutes()).slice(-2)}:${("0"+a.getUTCSeconds()).slice(-2)}`}const $=t=>t[0]===void 0||t[0].length===0?[]:t[0].xy.map(a=>{const[n,u]=Object.entries(a)[0];return{value:[g(parseInt(n)),u],name:g(parseInt(n))+u+t[1]}});let m=be,h=I(2),w;R(()=>r.selectedData?r.selectedData.baselineTasks.filter(a=>a.critical):void 0);function y(t){return`<span >${t}</span>`}var v,z;function q(){_.value="Compare",v=[],z=r.selectedData.baselineTasks.map((e,i)=>{let d=r.selectedData.tasks.find(s=>s.id===e.id);d.old=e,v.push(d);function o(s){return s===1?1:s+(s-1)*2}return i=o(r.selectedData.baselineTasks.length-i),{name:e.name,value:[i,g(e.newStart),g(e.newFinish),e,{baseNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration},changeNew:{start:d.newStart,finish:d.newFinish,duration:d.newDuration}}],itemStyle:{color:e.critical?"pink":void 0}}}),v=v.map((e,i)=>{function d(o){return o===2?2:o+(o-2)*2}return i=d(v.length-i+1),{id:e.id,name:e.name,value:[i,g(e.newStart),g(e.newFinish),e,{baseNew:{start:e.old.newStart,finish:e.old.newFinish,duration:e.old.newDuration},changeNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration}}],itemStyle:{color:e.critical?"red":void 0}}});let t=m.init(document.getElementById("myEcharts"),"purple-passion");t.on("click",function(e){D.value=e.data.value[3],O.value=!0});var a;let n=(e,i)=>{let d=i.coord([i.value(1),i.value(0)]),o=i.coord([i.value(2),i.value(0)]),s=i.size([0,1])[1];return{type:"rect",shape:ge({x:d[0],y:d[1]-s/2,width:Math.max(o[0]-d[0],1),height:s},e.coordSys),style:i.style(),focus:"self",blurScope:"coordinateSystem",emphasis:{}}},u;v.length<30?u=!0:u=!1,a={toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"weakFilter",xAxisIndex:[0],labelFormatter:function(e){return E(e)},moveHandleSize:15,height:15,moveHandleStyle:{}},{type:"slider",filterMode:"weakFilter",yAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",xAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",yAxisIndex:[0]}],legend:{data:["Baseline","New"]},xAxis:{name:"date",type:"time",splitNumber:5,boundaryGap:[0,0],axisTick:{show:!0,alignWithLabel:!0},minInterval:24*3600,max:function(e){return e.max+(e.max-e.min)*.01},min:function(e){return e.min-(e.max-e.min)*.01},axisLabel:{showMaxLabel:"true",showMinLabel:"true",formatter:function(e,i){return E(e)}}},yAxis:{name:"tasks"},selectedMode:"single",series:[{name:"Baseline",type:"custom",data:z,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:u,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}},{name:"New",type:"custom",data:v,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:u,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}}],tooltip:{axisPointer:{},formatter:e=>{let i="Resources: <br/>";if(e.value[3].resources)for(const o in e.value[3].resources){let s=e.value[3].resources,b=r.selectedData.newResources.find(M=>M.id==o);b||(b=""),i+=` &nbsp&nbspResource &nbsp  ${b==null?void 0:b.name} &nbsp id: ${o}  <br/>&nbsp&nbsp&nbsp&nbspunits/hour:${j(s[o].plannedUnitsPerHour)}=> ${j(s[o].newUnitsPerHour)}<br/>`}function d(o){let s;switch(o){case"New":e.value[3].critical?s="red":s="#b0e054";break;case"Old":e.value[3].critical?s="pink":s="#5474c4"}return`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${s};"></span>`}return`${e.name}<br/>
        <div style='margin-top:20px'>
         ${d("New")} New: ${y(g(e.value[4].changeNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${y(g(e.value[4].changeNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
         (${e.value[4].changeNew.duration})
        <br/>
         ${d("Old")} Old: ${y(g(e.value[4].baseNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${y(g(e.value[4].baseNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
       (${e.value[4].baseNew.duration})
         <br/>
         ${i}
        </div>`}}},a&&t.setOption(a),t.off("datazoom"),t.on("datazoom",function(e){f(e,z,v,u)}),Z(_,(e,i)=>{if(e==="Compare"){let d={series:[{name:"Baseline",type:"custom",data:z,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:u,color:"black",position:"inside",formatter:function(o){return o.data.name},fontSize:12}}},{name:"New",type:"custom",data:v,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:u,color:"black",position:"inside",formatter:function(o){return o.data.name},fontSize:12}}}]};t.setOption(d),t.off("datazoom"),t.on("datazoom",function(o){f(o,z,v,u)})}else{let d=JSON.parse(JSON.stringify(z)).map((b,M)=>{let F={...b};return F.value[0]=z.length*2-M,F}),o=JSON.parse(JSON.stringify(v)).map((b,M)=>{let F={...b};return F.value[0]=z.length-M,F}),s={series:[{name:"Baseline",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:u,color:"black",position:"inside",formatter:function(b){return b.data.name},fontSize:12}}},{name:"New",type:"custom",data:o,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:u,color:"black",position:"inside",formatter:function(b){return b.data.name},fontSize:12}}}]};t.setOption(s),t.off("datazoom"),t.on("datazoom",function(b){f(b,d,o,u)})}});function f(e,i,d,o){o||(e.batch[0].end-e.batch[0].start<30/d.length*100?t.setOption({series:[{name:"Baseline",type:"custom",data:i,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"New",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}):t.setOption({series:[{name:"baseline",type:"custom",data:i,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"new",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}))}t.on("mousemove",function(e){t.dispatchAction({type:"highlight",dataIndex:e.dataIndex})}),w=m.init(document.getElementById("myEcharts01"),"purple-passion"),w.on("mousemove",function(e){w.dispatchAction({type:"highlight",name:e.name})}),w.on("click",function(e){w.dispatchAction({type:"select",name:e.name})})}let N=I("");function j(a){if(!a)return"0.00";var a=Math.round(parseFloat(a)*100)/100,n=a.toString().split(".");if(n.length==1)return a=a.toString()+".00",a;if(n.length>1)return n[1].length<2&&(a=a.toString()+"0"),a}function G(t,a){return t.reduce(function(n,u){let f=u[a];return n[f]||(n[f]=[]),n[f].push(u),n},{})}let Y=R(()=>{let t=r.selectedData.baselineResources.map(n=>({id:n.id,name:n.name,type:n.type})),a=G(t,"type");if(N.value){const n=new RegExp(N.value,"i");let u={};for(let f in a)u[f]=a[f].filter(e=>n.test(e.name));return u}else return a}),Q=R(()=>{var n;const t=r.selectedData.baselineResources;let a="base";return C.value?[t.filter(f=>f.id&&f.id===C.value)[0].distribution,a]:t.length==0?[]:(C.value=t[0].id,[(n=t[0])==null?void 0:n.distribution,a])}),X=R(()=>{var n;const t=r.selectedData.newResources;let a="new";return C.value?[t.filter(f=>f.id&&f.id===C.value)[0].distribution,a]:t.length==0?[]:[(n=t[0])==null?void 0:n.distribution,a]}),ee=R(()=>({toolbox:{feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"none"},{type:"slider",filterMode:"none"},{type:"inside",filterMode:"none"},{type:"inside",filterMode:"none"}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},animation:!1,legend:{data:["Baseline","New"]},xAxis:{name:"date",type:"time",axisLabel:{formatter:"{yyyy}-{MM}-{dd}"}},yAxis:{name:"units / day"},series:[{name:"Baseline",type:"bar",data:$(Q.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"self",blurScope:"coordinateSystem"}},{name:"New",type:"bar",data:$(X.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"series",blurScope:"coordinateSystem"}}]}));function P(){w.setOption(ee.value)}Z(h,()=>{P()});async function te(){p.push({name:"OptimizedReport"}),r.active=3}let C=I("");function ae(){p.push({name:"BaselineSummary"}),r.active=1}function ne(t){C.value=t}return Z(C,()=>{P()}),(t,a)=>{const n=ye,u=he,f=pe,e=ue("v-btn");return B(),V(H,null,[c("div",_e,[c("div",De,[c("h2",null,[L(S(t.$t("optimizedSummary.title[0]"))+" ",1),c("span",$e,S(l(r).SummaryData.group.replace("_"," ").replace("base","Base")),1),c("div",Ce,[c("span",null,S(l(r).setting.Steps)+" "+S(t.$t("optimizedSummary.title[1]")),1)]),c("div",ze,[c("span",null,S(`${l(r).setting.Ratio[0]*100}% - ${l(r).setting.Ratio[1]*100}% ${t.$t("optimizedSummary.title[2]")}`),1)])]),c("div",ke,[x(T,{title:t.$t("optimizedSummary.header[0]"),height:180,precent:k(l(r).SummaryData.changedDuration-l(r).SummaryData.baseDuration,l(r).SummaryData.baseDuration),isPositive:!0,body:[l(r).SummaryData.changedDuration+" days",l(r).SummaryData.baseDuration+" days",l(r).SummaryData.planDurationDays+" days"]},null,8,["title","precent","body"]),x(T,{title:t.$t("baselineSummary.Tsidebar[1]"),height:180,precent:k(l(r).SummaryData.maxResourceUnit-l(r).SummaryData.BasemaxResourceUnit,l(r).SummaryData.BasemaxResourceUnit),isPositive:!0,body:[l(r).SummaryData.maxResourceUnit,l(r).SummaryData.BasemaxResourceUnit]},null,8,["title","precent","body"]),x(T,{title:t.$t("optimizedSummary.header[2]"),height:180,body:[l(r).SummaryData.changgedTasks,l(r).SummaryData.TotalTasks]},null,8,["title","body"]),x(T,{title:t.$t("optimizedSummary.header[3]"),height:180,body:[l(r).SummaryData.changedCriticalPath,l(r).SummaryData.changedCriticalPath,l(r).SummaryData.baseCriticalPath]},null,8,["title","body"])]),c("div",Ie,[c("div",Re,[c("div",null,S(t.$t("optimizedSummary.chartName[0]")),1),x(u,{modelValue:l(_),"onUpdate:modelValue":a[0]||(a[0]=i=>W(_)?_.value=i:_=i),class:"m-2",placeholder:"Select",size:"large"},{default:U(()=>[x(n,{label:"Compare Mode",value:"Compare"}),x(n,{label:"Separate Mode",value:"Separate"})]),_:1},8,["modelValue"])]),c("span",null,S(t.$t("optimizedSummary.chartName[1]")),1),Ne,c("div",Be,null,512)]),c("div",Oe,[c("div",Me,[c("div",null,S(t.$t("optimizedSummary.chartName[2]")),1)]),c("span",null,S(t.$t("optimizedSummary.chartName[3]")),1),x(f,{modelValue:l(N),"onUpdate:modelValue":a[1]||(a[1]=i=>W(N)?N.value=i:N=i),placeholder:"Search Resources"},null,8,["modelValue"]),(B(!0),V(H,null,K(l(Y),(i,d)=>(B(),V("div",null,[c("div",Fe,S(d)+" Resources",1),c("div",Ve,[(B(!0),V(H,null,K(i,(o,s)=>(B(),V("div",{key:s,class:"type"},[x(e,{variant:"text",value:s,class:fe({activeType:l(C)==o.id}),onClick:()=>{ne(o.id)}},{default:U(()=>[L(S(o.name)+" "+S(o.type),1)]),_:2},1032,["value","class","onClick"])]))),128))])]))),256)),c("div",Ue,null,512)]),c("div",Ae,[x(e,{onClick:ae,class:"btnback"},{default:U(()=>[L("BACK")]),_:1}),x(ve,{style:"color:white;margin-left:1050px",disabled:!0,onClicked:te,title:t.$t("optimizedSummary.btn[1]")},null,8,["title"])])])]),x(xe,{onCloseDialog:A,data:l(D),dialogVisible:l(O)},null,8,["data","dialogVisible"])],64)}}},je=oe(Ee,[["__scopeId","data-v-bf6e11cd"]]);export{je as default};
