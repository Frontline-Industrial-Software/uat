import{bp as T,r as x,bK as R,bL as j,a_ as V,D as A,F as S,M as t,N as o,H as d,bM as z,as as v,bN as Q,bO as Y,af as I,a$ as $,aI as B,aV as L,A as O,aq as D,O as q,a8 as c,G as J,aB as ee,bo as te,aW as M,aX as N,bq as ae,a9 as _,J as le,aa as oe}from"./index-e159460d.js";import"./el-tag-7cbf6649.js";import{E as ne,a as se}from"./el-select-37914448.js";import"./el-tooltip-4ed993c7.js";import{_ as ie}from"./next-b636ffc9.js";import{E as W}from"./el-progress-12747bfe.js";import{E as re,L as ue,i as de}from"./luckyexcel.umd-edbfbd2a.js";import"./index-13b0ea8e.js";import"./strings-b9be3dc1.js";const ce={__name:"upload",setup(n){const s=T();let f=x(!1);function e(){f.value=!1}let a=x(!1);function r(){a.value=!1}function m(l){const u=l.lastIndexOf(".");return u!==-1?l.replace(/[^\w\d](?=.*\..*$)/g,(i,p)=>p<u?"_":i):l.replace(/[^\w\d]/g,"_")}let g=x();setTimeout(async()=>{const l=await R.currentAuthenticatedUser();j.identify(l.attributes.sub,{email:l.attributes.email});let u=await V.checkUser(l.attributes.email);g.value=u,s.isVip=g},0);async function y(){}const h=async l=>{s.file.name="";const u=l.name,i=m(u),p=new File([l],i,{type:l.type});s.truefile=l.name,s.file.size=p.size;let b=await V.sendFile(p);if(s.loginAndauthRequired=b.data.loginAndauthRequired,b.data.loginAndauthRequired===!1)console.log("文件满足要求"),$({showClose:!0,message:"Upload Success",type:"success"});else if(s.loginStatus===!0)if(console.log("用户已登录"),s.isVip.auth===!0)console.log("用户为付费用户"),$({showClose:!0,message:"Upload Success",type:"success"});else{console.log("用户未付费"),$({showClose:!0,message:"File size exceeded, requires permission authorization. Please contact us.",type:"error",duration:1e4}),a.value=!0;return}else{console.log("用户未登录"),$({showClose:!0,message:"File size exceeded, please log in to obtain authorization.",type:"error",duration:1e4}),f.value=!0;return}return s.file.name=b.data.mapping[i],b.data.mapping[i]&&(s.newUpload=!0),s.originalplan.originalDurationDays=b.data.originalDurationDaysWithCalendar,s.originalplan.newCriticalTasksLen=b.data.newCriticalTasksLen,s.originalplan.maxResourceUnitAgg=b.data.maxResourceUnitAgg,s.ConstraintsFile="",!1};return(l,u)=>{const i=B,p=W;return A(),S(I,null,[t(p,{class:"upload-demo",action:"",multiple:"","before-upload":h,limit:3,onClick:y},{default:o(()=>[t(i,{icon:d(z),color:"rgb(42, 123, 108)",style:{color:"white"},type:"primary"},{default:o(()=>[v(" Upload ")]),_:1},8,["icon"])]),_:1}),t(Q,{onClose:e,dialogVisible:d(f)},null,8,["dialogVisible"]),t(Y,{onClose:r,dialogVisible:d(a)},null,8,["dialogVisible"])],64)}}},fe=function(n,s){const f=new re.Workbook;return Object.prototype.toString.call(n)==="[object Object]"&&(n=[n]),n.forEach(function(a){if(a.data.length===0)return!0;const r=f.addWorksheet(a.name),m=a.config&&a.config.merge||{},g=a.config&&a.config.borderInfo||{};return _e(a.data,r),pe(m,r),me(g,r),!0}),f.xlsx.writeBuffer().then(a=>{const r=new Blob([a],{type:"application/vnd.ms-excel;charset=utf-8"});return new File([r],`${s}.xlsx`,{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})})};var pe=function(n={},s){Object.values(n).forEach(function(e){s.mergeCells(e.r+1,e.c+1,e.r+e.rs,e.c+e.cs)})},me=function(n,s){Array.isArray(n)&&n.forEach(function(f){if(f.rangeType==="range"){let e=ye(f.borderType,f.style,f.color),a=f.range[0],r=a.row,m=a.column;for(let g=r[0]+1;g<r[1]+2;g++)for(let y=m[0]+1;y<m[1]+2;y++)s.getCell(g,y).border=e}if(f.rangeType==="cell"){const{col_index:e,row_index:a}=f.value,r=Object.assign({},f.value);delete r.col_index,delete r.row_index;let m=ve(r);s.getCell(a+1,e+1).border=m}})},_e=function(n,s){Array.isArray(n)&&n.forEach(function(f,e){f.every(function(a,r){if(!a)return!0;let m=ge(a.bg),g=he(a.ff,a.fc,a.bl,a.it,a.fs,a.cl,a.ul),y=be(a.vt,a.ht,a.tb,a.tr),h="";a.f?h={formula:a.f,result:a.v}:!a.v&&a.ct&&a.ct.s?a.ct.s.forEach(i=>{h+=i.v}):h=a.v;let l=we(r),u=s.getCell(l+(e+1));for(const i in m){u.fill=m;break}return u.font=g,u.alignment=y,u.value=h,!0})})},ge=function(n){return n?{type:"pattern",pattern:"solid",fgColor:{argb:n.replace("#","")}}:{}},he=function(n=0,s="#000000",f=0,e=0,a=10,r=0,m=0){const g={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(h){return h!==0}};return{name:typeof n=="number"?g[n]:n,family:1,size:a,color:{argb:s.replace("#","")},bold:g.num2bl(f),italic:g.num2bl(e),underline:g.num2bl(m),strike:g.num2bl(r)}},be=function(n="default",s="default",f="default",e="default"){const a={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}};return{vertical:a.vertical[n],horizontal:a.horizontal[s],wrapText:a.wrapText[f],textRotation:a.textRotation[e]}},ye=function(n,s=1,f="#000"){if(!n)return{};const e={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};let a={style:e.style[s],color:{argb:f.replace("#","")}},r={};return e.type[n]==="all"?(r.top=a,r.right=a,r.bottom=a,r.left=a):r[e.type[n]]=a,r};function ve(n,s,f){let e={};const a={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(const r in n)n[r].color.indexOf("rgb")===-1?e[a.type[r]]={style:a.style[n[r].style],color:{argb:n[r].color.replace("#","")}}:e[a.type[r]]={style:a.style[n[r].style],color:{argb:n[r].color}};return e}function we(n){let s="A".charCodeAt(0),e="Z".charCodeAt(0)-s+1,a="";for(;n>=0;)a=String.fromCharCode(n%e+s)+a,n=Math.floor(n/e)-1;return a}const De=n=>(M("data-v-1a4b91f2"),n=n(),N(),n),ke={class:"content"},xe=De(()=>c("div",{id:"luckysheet"},null,-1)),Ce={id:"tip"},Ae={__name:"luckysheet",props:{open:Boolean,url:Object},emits:["close"],setup(n,{expose:s,emit:f}){const e=n;O(async()=>{}),s({start:r});async function a(){let y=await fe(luckysheet.getAllSheets(),"constraints");await V.sendConstraintsFile(y,"constraints")}function r(){setTimeout(()=>{const y=e.url,h="test";m.value=!0,ue.transformExcelToLuckyByUrl(y,h,(l,u)=>{var i;if(l.sheets==null||l.sheets.length==0){alert("Failed to read the content of the excel file, currently does not support xls files!");return}g.value=l,m.value=!1,de((i=window==null?void 0:window.luckysheet)==null?void 0:i.destroy)&&window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:l.sheets,title:l.info.name,userInfo:l.info.name.creator})})},0)}const m=x(!1);x("");const g=x({});return(y,h)=>{const l=D("v-btn"),u=te;return A(),q(u,{onClose:h[0]||(h[0]=()=>{f("close")}),width:"80%",fullscreen:!1,modelValue:e.open,"onUpdate:modelValue":h[1]||(h[1]=i=>e.open=i)},{default:o(()=>[t(l,{class:"upload",color:"rgb(64, 170, 151)",style:{color:"white"},onClick:a},{default:o(()=>[v(" Upload ")]),_:1}),c("div",ke,[xe,J(c("div",Ce,"Downloading",512),[[ee,m.value]])])]),_:1},8,["modelValue"])}}},Ve=L(Ae,[["__scopeId","data-v-1a4b91f2"]]),$e={__name:"constraintsUpload",setup(n){const s=T(),f=async e=>{let a=await V.sendConstraintsFile(e,s.file.name);return s.ConstraintsFile=a,!1};return(e,a)=>{const r=B,m=W;return A(),q(m,{class:"upload-demo",disabled:!d(s).file.name,action:"",multiple:"","before-upload":f,limit:3},{default:o(()=>[t(r,{icon:d(z),disabled:!d(s).file.name,color:"rgb(42, 123, 108)",style:{color:"white"},type:"primary"},{default:o(()=>[v(" Upload ")]),_:1},8,["icon","disabled"])]),_:1},8,["disabled"])}}};const k=n=>(M("data-v-f390d7e4"),n=n(),N(),n),Se={class:"contentData"},Te={class:"uploadBox"},Fe={key:0,style:{color:"rgb(42, 123, 108)","margin-left":"10px"}},Ue={key:1,style:{color:"rgb(42, 123, 108)","margin-left":"10px"}},Ee={class:"uploadBox"},Re={style:{color:"rgb(42, 123, 108)","margin-left":"10px"}},je=k(()=>c("h4",{style:{color:"white"}},"False:",-1)),ze=k(()=>c("br",null,null,-1)),Ie=k(()=>c("h4",{style:{color:"white"}},"Any:",-1)),Be=k(()=>c("br",null,null,-1)),Le=k(()=>c("h4",{style:{color:"white"}},"All:",-1)),Oe=k(()=>c("h4",{style:{color:"white"}},"Adjust task duration:",-1)),qe=k(()=>c("br",null,null,-1)),Me=k(()=>c("br",null,null,-1)),Ne=k(()=>c("h4",{style:{color:"white"}},"Adjust task-task lag:",-1)),We=k(()=>c("br",null,null,-1)),Pe=k(()=>c("br",null,null,-1)),He={__name:"index",setup(n){let s=x(!1);const f=ae(),e=T(),a=x(null);O(async()=>{let l;try{l=await R.currentAuthenticatedUser(),l?(e.loginStatus=!0,e.email=l.attributes.email):e.loginStatus=!1}catch{e.loginStatus=!1}await j.identify(l.attributes.sub,{email:l.attributes.email})});function r(){s.value=!1}async function m(){Object.keys(e.dataArray).forEach(l=>{e.dataArray[l].all=[],e.dataArray[l].data=[],e.dataArray[l].span=[],e.dataArray[l].cost=[]}),e.selectedData=null,e.wss=await e.connectWebsocket(),f.push({name:"BaselineSummary"}),e.active=1,e.end.data=!1}async function g(){e.ConstraintsFile="",fetch("demo_project.xml").then(l=>l.blob()).then(async l=>{const u=new File([l],"demo_project.xml");e.truefile=u.name,e.file.size=u.size;let i=await V.sendFile(u);e.file.name=i.data.mapping[u.name],e.originalplan.originalDurationDays=i.data.originalDurationDaysWithCalendar,e.originalplan.newCriticalTasksLen=i.data.newCriticalTasksLen,e.originalplan.maxResourceUnitAgg=i.data.maxResourceUnitAgg,e.loginAndauthRequired=i.data.loginAndauthRequired})}let y=x("");async function h(){e.file.name&&await V.constraintsFileDownload(`${e.file.name.split(".")[0]}.xlsx`)}return(l,u)=>{const i=D("v-sheet"),p=D("v-col"),b=D("v-row"),P=D("v-divider"),F=D("v-radio"),H=D("v-radio-group"),Z=D("v-text-field"),U=oe,C=ne,E=se,K=D("v-range-slider"),G=D("v-slider"),X=D("v-container");return A(),S(I,null,[c("div",Se,[t(X,{class:"container"},{default:o(()=>[t(b,{"no-gutters":""},{default:o(()=>[t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[c("h2",null,_(l.$t("inputData.title")),1)]),_:1})]),_:1})]),_:1}),t(b,{"no-gutters":""},{default:o(()=>[t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[c("h2",null,_(l.$t("inputData.oneData[0]")),1),c("h3",null,_(l.$t("inputData.oneData[1]")),1)]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[c("div",Te,[t(ce),d(e).file.name?(A(),S("span",Ue,_(d(e).truefile),1)):(A(),S("span",Fe,_(l.$t("inputData.oneData[3]")),1))])]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[v(_(l.$t("inputData.oneData[4]"))+" ",1),c("span",{onClick:u[0]||(u[0]=w=>g()),style:{"text-decoration":"underline",cursor:"pointer"}},_(l.$t("inputData.oneData[5]")),1)]),_:1})]),_:1})]),_:1}),t(P),c("div",{class:le({disabled:!d(e).file.name})},[t(b,{disabled:!d(e).file.name,"no-gutters":""},{default:o(()=>[t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[c("h2",null,_(l.$t("inputData.twoData[0]")),1),c("h3",null,[v(_(l.$t("inputData.twoData[1]"))+" ",1),c("span",{style:{cursor:"pointer","text-decoration":"underline"},onClick:h},_(l.$t("inputData.twoData[2]")),1)])]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[c("div",Ee,[t($e),c("span",Re,_(d(e).ConstraintsFile),1)]),c("div",{onClick:u[1]||(u[1]=()=>{l.openSheet()})},_(l.$t("Online editing")),1)]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"})]),_:1})]),_:1},8,["disabled"]),t(b,{"no-gutters":""},{default:o(()=>[t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[c("h2",null,_(l.$t("inputData.threeData[0]")),1),c("h3",null,_(l.$t("inputData.threeData[1]")),1)]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[c("label",null,_(l.$t("inputData.threeData[2]")),1),t(H,{disabled:!d(e).file.name,modelValue:d(e).setting.IgnoreProject,"onUpdate:modelValue":u[2]||(u[2]=w=>d(e).setting.IgnoreProject=w),inline:""},{default:o(()=>[t(F,{label:l.$t("inputData.threeData[3]"),value:!0},null,8,["label"]),t(F,{label:l.$t("inputData.threeData[4]"),value:!1},null,8,["label"])]),_:1},8,["disabled","modelValue"])]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[v(_(l.$t("inputData.threeData[5]"))+" ",1),c("p",null,[t(Z,{disabled:!d(e).file.name,density:"compact",modelValue:d(e).setting.Rate,"onUpdate:modelValue":u[3]||(u[3]=w=>d(e).setting.Rate=w),placeholder:"0.025",variant:"outlined"},null,8,["disabled","modelValue"])])]),_:1})]),_:1})]),_:1}),t(b,{"no-gutters":""},{default:o(()=>[t(p),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[t(U,{class:"box-item",effect:"dark",placement:"top-end"},{content:o(()=>[je,v(" Tasks without explicitly assigned resources will not receive any default resource allocation. "),ze,Ie,v(" Any task without a specified resource will automatically be allocated a default Labor resource at a rate of 1.0 unit per hour. "),Be,Le,v(" Default Labor resources are assigned to tasks only when there are no existing resource or role definitions or when no tasks are explicitly assigned to resources or roles. ")]),default:o(()=>[c("label",null,_(l.$t("How To Handle Tasks Without Resources?")),1)]),_:1}),t(E,{modelValue:d(e).setting.considerDefaultResourceType,"onUpdate:modelValue":u[4]||(u[4]=w=>d(e).setting.considerDefaultResourceType=w),class:"m-2",style:{width:"300px"},placeholder:"Select",size:"large"},{default:o(()=>[t(C,{label:"All:Fill default resource for all tasks",value:"all"}),t(C,{label:"Any:Fill default resource for unassigned tasks",value:"any"}),t(C,{label:"False:No default resource filled",value:"false"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[t(U,{class:"box-item",effect:"dark",placement:"top-end"},{content:o(()=>[Oe,v(" This option involves modifying the actual time required to complete a task, aiming to align it with the available resources. "),qe,v(" For instance, this could mean shortening or extending the duration of a task to fit within the constraints of the available resources. "),Me,Ne,v(" This option revolves around altering the time gap between tasks, ensuring a more reasonable schedule for the waiting time between tasks considering the limitations in available resources. "),We,v(" This adjustment might involve delaying the start time of the subsequent task to accommodate the existing resource constraints. "),Pe]),default:o(()=>[c("label",null,_(l.$t("Method To Satisfy Resource Constraints")),1)]),_:1}),t(E,{modelValue:d(e).setting.resourceConstraint,"onUpdate:modelValue":u[5]||(u[5]=w=>d(e).setting.resourceConstraint=w),class:"m-3",placeholder:"Select",size:"large",style:{width:"300px"}},{default:o(()=>[t(C,{label:"Adjust task duration",value:!1}),t(C,{label:"Adjust task-task lag",value:"lag"}),t(C,{label:"Adjust task-task logic ",value:"logic"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(b,{"no-gutters":""},{default:o(()=>[t(p,{cols:"4"},{default:o(()=>[t(i,{class:"pa-2 ma-2"})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[v(_(`${l.$t("inputData.fourData[0]")}(${Math.floor(d(e).setting.Ratio[0]*100)}% - ${Math.floor(d(e).setting.Ratio[1]*100)}%)`)+" ",1),t(K,{disabled:!d(e).file.name,max:10,min:.1,step:.1,modelValue:d(e).setting.Ratio,"onUpdate:modelValue":u[6]||(u[6]=w=>d(e).setting.Ratio=w),color:"rgb(112, 191, 177)"},null,8,["disabled","modelValue"])]),_:1})]),_:1})]),_:1}),t(b,{"no-gutters":""},{default:o(()=>[t(p,{cols:"4"},{default:o(()=>[t(i,{class:"pa-2 ma-2"})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[v(_(l.$t("inputData.fiveData[0]"))+" ("+_(d(e).setting.Steps)+") ",1),t(G,{disabled:!d(e).file.name,step:1,modelValue:d(e).setting.Steps,"onUpdate:modelValue":u[7]||(u[7]=w=>d(e).setting.Steps=w),color:"rgb(112, 191, 177)"},null,8,["disabled","modelValue"])]),_:1})]),_:1})]),_:1}),t(b,{justify:"space-between"},{default:o(()=>[t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"})]),_:1}),t(p,null,{default:o(()=>[t(i,{class:"pa-2 ma-2"},{default:o(()=>[t(ie,{style:"color:white",disabled:d(e).file.name,onClicked:m,title:"next"},null,8,["disabled"])]),_:1})]),_:1})]),_:1})],2)]),_:1})]),t(Ve,{ref_key:"sheet",ref:a,open:d(s),url:d(y),onClose:r},null,8,["open","url"])],64)}}},at=L(He,[["__scopeId","data-v-f390d7e4"]]);export{at as default};
