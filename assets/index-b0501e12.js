import{K as I,h as R,p as M,B as re,C as F,v as c,z as b,t as l,af as ie,a9 as oe,am as se,aD as le,aE as de,a1 as Z,ah as ce,q as N,ad as T,Q as x,av as W,L as H,M as q,aL as ue,s as me}from"./index-59538e28.js";import{E as pe,p as fe,q as he,m as ye}from"./el-overlay-3d8f470c.js";import{C as P}from"./index-73b09929.js";import{e as ve,c as ge}from"./index-f7adadce.js";import"./index-6bc54a03.js";import{V as be}from"./index.min-28076409.js";const we=c("span",{class:"dialog-footer"},null,-1),Se={__name:"dialog",props:["dialogVisible","data"],emits:["closeDialog"],setup(j,{emit:r}){const p=j;let D=I();async function V(){be.preview(D.value,`

`+w.value)}function _(m){if(!m)return"0.00";var m=Math.round(parseFloat(m)*100)/100,h=m.toString().split(".");if(h.length==1)return m=m.toString()+".00",m;if(h.length>1)return h[1].length<2&&(m=m.toString()+"0"),m}R(()=>p.dialogVisible);function E($,m=0){let h=`
`;const S=y=>"  ".repeat(y);for(const[y,v]of Object.entries($))typeof v=="object"&&v!==null?(h+=`${S(m)}- **${y}**
`,h+=E(v,m+1)):h+=`${S(m)}- ${y}: ${v}
`;return h}function k($){return new Date($).toISOString()}let w=R(()=>{let $=()=>{let h="";for(const S in p.data.resources){const y=p.data.resources[S];h+=`The resource with ID ${y.resourceId} was originally planned to have ${_(y.plannedUnits)} units. The initial planned usage rate was ${_(y.plannedUnitsPerHour)} units per hour, and it currently remains at ${_(y.Units)} units per hour. However, after optimization, the new usage rate is ${_(y.newUnitsPerHour)} units per hour, and the new daily usage is ${_(y.newUnitsPerDay)} units per day.
`}return h};return`This is a task named '${p.data.name}' categorized as '${p.data.type}', and it is ${p.data.critical==!0?"":"not"} a Critical Task.
   Before optimization,
   it is scheduled to start on ${k(p.data.plannedStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${k(p.data.plannedFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${p.data.remainingDuration} hours. 
  After optimization,
   it is scheduled to start on ${k(p.data.newStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${k(p.data.newFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${p.data.newDuration} hours. 
Resources:
${$()}As of now, the task has not commenced and is labeled as '${p.data.status}.' The task's duration ratio is ${_(p.data.durationRatio)}.`+E(p.data)});const B=()=>{r("closeDialog")};return($,m)=>{const h=pe;return M(),re(h,{onOpen:V,onClose:B,modelValue:p.dialogVisible,"onUpdate:modelValue":m[0]||(m[0]=S=>p.dialogVisible=S),title:"Detailed content",width:"50%",draggable:""},{footer:F(()=>[we]),default:F(()=>[c("span",null,b(l(w).id),1),c("div",{ref_key:"editorRef",ref:D},null,512)]),_:1},8,["modelValue"])}}};const xe={class:"contain"},De={class:"box"},_e={class:"sp"},$e={class:"step"},Ce={class:"step"},ze={class:"maintop"},ke={class:"mainEchar1"},Ie={class:"Echar1top"},Re=ue('<div class="choosebox" data-v-a5c695ca><div class="choose" data-v-a5c695ca><div style="background-color:#b0e054;" class="item" data-v-a5c695ca></div><div data-v-a5c695ca>Optimized</div></div><div class="choose" data-v-a5c695ca><div style="background-color:#5474c4;" class="item" data-v-a5c695ca></div><div data-v-a5c695ca>Baseline</div></div><div class="choose" data-v-a5c695ca><div style="background-color:red;" class="item" data-v-a5c695ca></div><div data-v-a5c695ca>Critical Path</div></div><div class="choose" data-v-a5c695ca><div style="background-color:pink;" class="item" data-v-a5c695ca></div><div data-v-a5c695ca>Critical Path(baseline)</div></div></div><div id="main" data-v-a5c695ca></div>',2),Oe={ref:"main",style:{width:"1350px",height:"610px"},id:"myEcharts"},Me={class:"mainEchar2"},Fe={class:"Echar2top"},Ve={class:"resources-title"},Ue={class:"types"},Ae={ref:"main01",style:{width:"1350px",height:"610px"},id:"myEcharts01"},Ne={class:"button"},Ee={__name:"index",setup(j){const r=oe(),p=se();let D=I("Compare"),V=I(!1),_=I("");const E=()=>{V.value=!1};le((t,a,n)=>{t.name=="InputData",n()}),de(()=>{r.selectChange&&(C.value="",K(),L(),r.selectChange=!1)});function k(t,a){return Math.round(t/a*1e4)/100+"%"}function w(t){return new Date(t).toISOString()}function B(t){const a=new Date(t);return`${a.getUTCFullYear()}/${a.getUTCMonth()+1}/${a.getUTCDate()} ${("0"+a.getUTCHours()).slice(-2)}:${("0"+a.getUTCMinutes()).slice(-2)}:${("0"+a.getUTCSeconds()).slice(-2)}`}const $=t=>t[0]===void 0||t[0].length===0?[]:t[0].xy.map(a=>{const[n,u]=Object.entries(a)[0];return{value:[w(parseInt(n)),u],name:w(parseInt(n))+u+t[1]}});let m=ve,h=I(2),S;R(()=>r.selectedData?r.selectedData.baselineTasks.filter(a=>a.critical):void 0);function y(t){return`<span >${t}</span>`}var v,z;function K(){D.value="Compare",v=[],z=r.selectedData.baselineTasks.map((e,i)=>{let d=r.selectedData.tasks.find(s=>s.id===e.id);d.old=e,v.push(d);function o(s){return s===1?1:s+(s-1)*4}return i=o(r.selectedData.baselineTasks.length-i),{name:e.name,value:[i,w(e.newStart),w(e.newFinish),e,{baseNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration},changeNew:{start:d.newStart,finish:d.newFinish,duration:d.newDuration}}],itemStyle:{color:e.critical?"pink":void 0}}}),v=v.map((e,i)=>{function d(o){return o===2?2:o+(o-2)*4}return i=d(v.length-i+1),{id:e.id,name:e.name,value:[i,w(e.newStart),w(e.newFinish),e,{baseNew:{start:e.old.newStart,finish:e.old.newFinish,duration:e.old.newDuration},changeNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration}}],itemStyle:{color:e.critical?"red":void 0}}});let t=m.init(document.getElementById("myEcharts"),"purple-passion");t.on("click",function(e){_.value=e.data.value[3],V.value=!0});var a;let n=(e,i)=>{let d=i.coord([i.value(1),i.value(0)]),o=i.coord([i.value(2),i.value(0)]),s=i.size([0,1])[1];return{type:"rect",shape:ge({x:d[0],y:d[1]-s/2,width:Math.max(o[0]-d[0],1),height:s},e.coordSys),style:i.style(),focus:"self",blurScope:"coordinateSystem",emphasis:{}}},u;v.length<30?u=!0:u=!1,a={toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"weakFilter",xAxisIndex:[0],labelFormatter:function(e){return B(e)},moveHandleSize:15,height:15,moveHandleStyle:{}},{type:"slider",filterMode:"weakFilter",yAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",xAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",yAxisIndex:[0]}],legend:{data:["baseline","new"]},xAxis:{name:"date",type:"time",boundaryGap:[0,0],axisTick:{show:!0,alignWithLabel:!0},minInterval:24*3600,max:function(e){return e.max+(e.max-e.min)*.01},min:function(e){return e.min-(e.max-e.min)*.01},axisLabel:{showMaxLabel:"true",showMinLabel:"true",formatter:function(e,i){return B(e)}}},yAxis:{name:"tasks"},selectedMode:"single",series:[{name:"baseline",type:"custom",data:z,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:u,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}},{name:"new",type:"custom",data:v,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:u,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}}],tooltip:{axisPointer:{},formatter:e=>{let i="Resources: <br/>";if(e.value[3].resources)for(const o in e.value[3].resources){let s=e.value[3].resources,g=r.selectedData.newResources.find(U=>U.id==o);g||(g=""),i+=` &nbsp&nbspResource &nbsp  ${g==null?void 0:g.name} &nbsp id: ${o}  <br/>&nbsp&nbsp&nbsp&nbspunits/hour:${J(s[o].plannedUnitsPerHour)}=> ${J(s[o].newUnitsPerHour)}<br/>`}function d(o){let s;switch(o){case"New":e.value[3].critical?s="red":s="#b0e054";break;case"Old":e.value[3].critical?s="pink":s="#5474c4"}return`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${s};"></span>`}return`${e.name}<br/>
        <div style='margin-top:20px'>
         ${d("New")} New: ${y(w(e.value[4].changeNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${y(w(e.value[4].changeNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
         (${e.value[4].changeNew.duration})
        <br/>
         ${d("Old")} Old: ${y(w(e.value[4].baseNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${y(w(e.value[4].baseNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
       (${e.value[4].baseNew.duration})
         <br/>
         ${i}
        </div>`}}},a&&t.setOption(a),t.off("datazoom"),t.on("datazoom",function(e){f(e,z,v,u)}),Z(D,(e,i)=>{if(e==="Compare"){let d={series:[{name:"baseline",type:"custom",data:z,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:u,color:"black",position:"inside",formatter:function(o){return o.data.name},fontSize:12}}},{name:"new",type:"custom",data:v,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:u,color:"black",position:"inside",formatter:function(o){return o.data.name},fontSize:12}}}]};t.setOption(d),t.off("datazoom"),t.on("datazoom",function(o){f(o,z,v,u)})}else{let d=JSON.parse(JSON.stringify(z)).map((g,U)=>{let A={...g};return A.value[0]=z.length*2-U,A}),o=JSON.parse(JSON.stringify(v)).map((g,U)=>{let A={...g};return A.value[0]=z.length-U,A}),s={series:[{name:"baseline",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:u,color:"black",position:"inside",formatter:function(g){return g.data.name},fontSize:12}}},{name:"new",type:"custom",data:o,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:u,color:"black",position:"inside",formatter:function(g){return g.data.name},fontSize:12}}}]};t.setOption(s),t.off("datazoom"),t.on("datazoom",function(g){f(g,d,o,u)})}});function f(e,i,d,o){o||(e.batch[0].end-e.batch[0].start<30/d.length*100?t.setOption({series:[{name:"baseline",type:"custom",data:i,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"new",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}):t.setOption({series:[{name:"baseline",type:"custom",data:i,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"new",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}))}t.on("mousemove",function(e){t.dispatchAction({type:"highlight",dataIndex:e.dataIndex})}),S=m.init(document.getElementById("myEcharts01"),"purple-passion"),S.on("mousemove",function(e){S.dispatchAction({type:"highlight",name:e.name})}),S.on("click",function(e){S.dispatchAction({type:"select",name:e.name})})}let O=I("");function J(a){if(!a)return"0.00";var a=Math.round(parseFloat(a)*100)/100,n=a.toString().split(".");if(n.length==1)return a=a.toString()+".00",a;if(n.length>1)return n[1].length<2&&(a=a.toString()+"0"),a}function G(t,a){return t.reduce(function(n,u){let f=u[a];return n[f]||(n[f]=[]),n[f].push(u),n},{})}let Q=R(()=>{let t=r.selectedData.baselineResources.map(n=>({id:n.id,name:n.name,type:n.type})),a=G(t,"type");if(O.value){const n=new RegExp(O.value,"i");let u={};for(let f in a)u[f]=a[f].filter(e=>n.test(e.name));return u}else return a}),Y=R(()=>{var n;const t=r.selectedData.baselineResources;let a="base";return C.value?[t.filter(f=>f.id&&f.id===C.value)[0].distribution,a]:t.length==0?[]:(C.value=t[0].id,[(n=t[0])==null?void 0:n.distribution,a])}),X=R(()=>{var n;const t=r.selectedData.newResources;let a="new";return C.value?[t.filter(f=>f.id&&f.id===C.value)[0].distribution,a]:t.length==0?[]:[(n=t[0])==null?void 0:n.distribution,a]}),ee=R(()=>({toolbox:{feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"none"},{type:"slider",filterMode:"none"},{type:"inside",filterMode:"none"},{type:"inside",filterMode:"none"}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},animation:!1,legend:{data:["baseline","new"]},xAxis:{name:"date",type:"time",axisLabel:{formatter:"{yyyy}-{MM}-{dd}"}},yAxis:{name:"units / day"},series:[{name:"baseline",type:"bar",data:$(Y.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"self",blurScope:"coordinateSystem"}},{name:"new",type:"bar",data:$(X.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"series",blurScope:"coordinateSystem"}}]}));function L(){S.setOption(ee.value)}Z(h,()=>{L()});async function te(){p.push({name:"OptimizedReport"}),r.active=3}let C=I("");function ae(){p.push({name:"BaselineSummary"}),r.active=1}function ne(t){C.value=t}return Z(C,()=>{L()}),(t,a)=>{const n=ye,u=fe,f=he,e=ce("v-btn");return M(),N(H,null,[c("div",xe,[c("div",De,[c("h2",null,[T(b(t.$t("optimizedSummary.title[0]"))+" ",1),c("span",_e,b(l(r).SummaryData.group),1),c("div",$e,[c("span",null,b(l(r).setting.Steps)+" "+b(t.$t("optimizedSummary.title[1]")),1)]),c("div",Ce,[c("span",null,b(`${l(r).setting.Ratio[0]*100}% - ${l(r).setting.Ratio[1]*100}% ${t.$t("optimizedSummary.title[2]")}`),1)])]),c("div",ze,[x(P,{title:t.$t("optimizedSummary.header[0]"),height:180,precent:k(l(r).SummaryData.changedDuration-l(r).SummaryData.baseDuration,l(r).SummaryData.baseDuration),isPositive:!0,body:[l(r).SummaryData.changedDuration+" days",l(r).SummaryData.baseDuration+" days",l(r).SummaryData.planDurationDays+" days"]},null,8,["title","precent","body"]),x(P,{title:t.$t("baselineSummary.Tsidebar[1]"),height:180,precent:k(l(r).SummaryData.maxResourceUnit-l(r).SummaryData.BasemaxResourceUnit,l(r).SummaryData.BasemaxResourceUnit),isPositive:!1,body:[l(r).SummaryData.maxResourceUnit,l(r).SummaryData.BasemaxResourceUnit]},null,8,["title","precent","body"]),x(P,{title:t.$t("optimizedSummary.header[2]"),height:180,body:[l(r).SummaryData.changgedTasks,l(r).SummaryData.TotalTasks]},null,8,["title","body"]),x(P,{title:t.$t("optimizedSummary.header[3]"),height:180,body:[l(r).SummaryData.changedCriticalPath,l(r).SummaryData.changedCriticalPath,l(r).SummaryData.baseCriticalPath]},null,8,["title","body"])]),c("div",ke,[c("div",Ie,[c("div",null,b(t.$t("optimizedSummary.chartName[0]")),1),x(u,{modelValue:l(D),"onUpdate:modelValue":a[0]||(a[0]=i=>W(D)?D.value=i:D=i),class:"m-2",placeholder:"Select",size:"large"},{default:F(()=>[x(n,{label:"Compare Mode",value:"Compare"}),x(n,{label:"Separate Mode",value:"Separate"})]),_:1},8,["modelValue"])]),c("span",null,b(t.$t("optimizedSummary.chartName[1]")),1),Re,c("div",Oe,null,512)]),c("div",Me,[c("div",Fe,[c("div",null,b(t.$t("optimizedSummary.chartName[2]")),1)]),c("span",null,b(t.$t("optimizedSummary.chartName[3]")),1),x(f,{modelValue:l(O),"onUpdate:modelValue":a[1]||(a[1]=i=>W(O)?O.value=i:O=i),placeholder:"Search Resources"},null,8,["modelValue"]),(M(!0),N(H,null,q(l(Q),(i,d)=>(M(),N("div",null,[c("div",Ve,b(d)+" Resources",1),c("div",Ue,[(M(!0),N(H,null,q(i,(o,s)=>(M(),N("div",{key:s,class:"type"},[x(e,{variant:"text",value:s,class:me({activeType:l(C)==o.id}),onClick:()=>{ne(o.id)}},{default:F(()=>[T(b(o.name)+" "+b(o.type),1)]),_:2},1032,["value","class","onClick"])]))),128))])]))),256)),c("div",Ae,null,512)]),c("div",Ne,[x(e,{onClick:ae,class:"btnback"},{default:F(()=>[T("BACK")]),_:1}),x(e,{onClick:te,class:"btngo"},{default:F(()=>[T(b(t.$t("optimizedSummary.btn[1]")),1)]),_:1})])])]),x(Se,{onCloseDialog:E,data:l(_),dialogVisible:l(V)},null,8,["data","dialogVisible"])],64)}}},je=ie(Ee,[["__scopeId","data-v-a5c695ca"]]);export{je as default};
