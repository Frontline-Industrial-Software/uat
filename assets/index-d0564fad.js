import{K as I,h as R,p as M,B as re,C as F,v as u,z as g,t as l,af as ie,a9 as oe,am as se,aD as le,aE as de,a1 as Z,ah as ue,q as N,ad as T,Q as x,av as W,L as H,M as q,aL as ce,s as me}from"./index-4928a2c1.js";import{E as pe,p as fe,q as he,m as ye}from"./el-overlay-c094cef6.js";import{C as P}from"./index-9c736207.js";import{e as be,c as ve}from"./index-f7adadce.js";import"./index-fe419108.js";import{V as ge}from"./index.min-e00bb511.js";const we=u("span",{class:"dialog-footer"},null,-1),Se={__name:"dialog",props:["dialogVisible","data"],emits:["closeDialog"],setup(j,{emit:r}){const p=j;let z=I();async function V(){ge.preview(z.value,`

`+w.value)}function D(m){if(!m)return"0.00";var m=Math.round(parseFloat(m)*100)/100,h=m.toString().split(".");if(h.length==1)return m=m.toString()+".00",m;if(h.length>1)return h[1].length<2&&(m=m.toString()+"0"),m}R(()=>p.dialogVisible);function E(_,m=0){let h=`
`;const S=y=>"  ".repeat(y);for(const[y,b]of Object.entries(_))typeof b=="object"&&b!==null?(h+=`${S(m)}- **${y}**
`,h+=E(b,m+1)):h+=`${S(m)}- ${y}: ${b}
`;return h}function k(_){return new Date(_).toISOString()}let w=R(()=>{let _=()=>{let h="";for(const S in p.data.resources){const y=p.data.resources[S];h+=`The resource with ID ${y.resourceId} was originally planned to have ${D(y.plannedUnits)} units. The initial planned usage rate was ${D(y.plannedUnitsPerHour)} units per hour, and it currently remains at ${D(y.Units)} units per hour. However, after optimization, the new usage rate is ${D(y.newUnitsPerHour)} units per hour, and the new daily usage is ${D(y.newUnitsPerDay)} units per day.
`}return h};return`This is a task named '${p.data.name}' categorized as '${p.data.type}', and it is ${p.data.critical==!0?"":"not"} a Critical Task.
   Before optimization,
   it is scheduled to start on ${k(p.data.plannedStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${k(p.data.plannedFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${p.data.remainingDuration} hours. 
  After optimization,
   it is scheduled to start on ${k(p.data.newStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${k(p.data.newFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${p.data.newDuration} hours. 
Resources:
${_()}As of now, the task has not commenced and is labeled as '${p.data.status}.' The task's duration ratio is ${D(p.data.durationRatio)}.`+E(p.data)});const B=()=>{r("closeDialog")};return(_,m)=>{const h=pe;return M(),re(h,{onOpen:V,onClose:B,modelValue:p.dialogVisible,"onUpdate:modelValue":m[0]||(m[0]=S=>p.dialogVisible=S),title:"Detailed content",width:"50%",draggable:""},{footer:F(()=>[we]),default:F(()=>[u("span",null,g(l(w).id),1),u("div",{ref_key:"editorRef",ref:z},null,512)]),_:1},8,["modelValue"])}}};const xe={class:"contain"},De={class:"box"},_e={class:"sp"},$e={class:"step"},ze={class:"step"},Ce={class:"maintop"},ke={class:"mainEchar1"},Ie={class:"Echar1top"},Re=ce('<div class="choosebox" data-v-36754bb2><div class="choose" data-v-36754bb2><div style="background-color:#b0e054;" class="item" data-v-36754bb2></div><div data-v-36754bb2>Optimized</div></div><div class="choose" data-v-36754bb2><div style="background-color:#5474c4;" class="item" data-v-36754bb2></div><div data-v-36754bb2>Baseline</div></div><div class="choose" data-v-36754bb2><div style="background-color:red;" class="item" data-v-36754bb2></div><div data-v-36754bb2>Critical Path</div></div><div class="choose" data-v-36754bb2><div style="background-color:pink;" class="item" data-v-36754bb2></div><div data-v-36754bb2>Critical Path(baseline)</div></div></div><div id="main" data-v-36754bb2></div>',2),Oe={ref:"main",style:{width:"1350px",height:"610px"},id:"myEcharts"},Me={class:"mainEchar2"},Fe={class:"Echar2top"},Ve={class:"resources-title"},Ue={class:"types"},Ae={ref:"main01",style:{width:"1350px",height:"610px"},id:"myEcharts01"},Ne={class:"button"},Ee={__name:"index",setup(j){const r=oe(),p=se();let z=I("Compare"),V=I(!1),D=I("");const E=()=>{V.value=!1};le((t,a,n)=>{t.name=="InputData",n()}),de(()=>{r.selectChange&&($.value="",K(),L(),r.selectChange=!1)});function k(t,a){return Math.round(t/a*1e4)/100+"%"}function w(t){return new Date(t).toISOString()}function B(t){const a=new Date(t);return`${a.getUTCFullYear()}/${a.getUTCMonth()+1}/${a.getUTCDate()} ${("0"+a.getUTCHours()).slice(-2)}:${("0"+a.getUTCMinutes()).slice(-2)}:${("0"+a.getUTCSeconds()).slice(-2)}`}const _=t=>t[0]===void 0||t[0].length===0?[]:t[0].xy.map(a=>{const[n,c]=Object.entries(a)[0];return{value:[w(parseInt(n)),c],name:w(parseInt(n))+c+t[1]}});let m=be,h=I(2),S;R(()=>r.selectedData?r.selectedData.baselineTasks.filter(a=>a.critical):void 0);function y(t){return`<span >${t}</span>`}var b,C;function K(){b=[],C=r.selectedData.baselineTasks.map((e,i)=>{let d=r.selectedData.tasks.find(s=>s.id===e.id);d.old=e,b.push(d);function o(s){return s===1?1:s+(s-1)*4}return i=o(r.selectedData.baselineTasks.length-i),{name:e.name,value:[i,w(e.newStart),w(e.newFinish),e,{baseNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration},changeNew:{start:d.newStart,finish:d.newFinish,duration:d.newDuration}}],itemStyle:{color:e.critical?"pink":void 0}}}),b=b.map((e,i)=>{function d(o){return o===2?2:o+(o-2)*4}return i=d(b.length-i+1),{id:e.id,name:e.name,value:[i,w(e.newStart),w(e.newFinish),e,{baseNew:{start:e.old.newStart,finish:e.old.newFinish,duration:e.old.newDuration},changeNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration}}],itemStyle:{color:e.critical?"red":void 0}}});let t=m.init(document.getElementById("myEcharts"),"purple-passion");t.on("click",function(e){D.value=e.data.value[3],V.value=!0});var a;let n=(e,i)=>{let d=i.coord([i.value(1),i.value(0)]),o=i.coord([i.value(2),i.value(0)]),s=i.size([0,1])[1];return{type:"rect",shape:ve({x:d[0],y:d[1]-s/2,width:Math.max(o[0]-d[0],1),height:s},e.coordSys),style:i.style(),focus:"self",blurScope:"coordinateSystem",emphasis:{}}},c;b.length<30?c=!0:c=!1,a={toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"weakFilter",xAxisIndex:[0],labelFormatter:function(e){return B(e)},moveHandleSize:15,height:15,moveHandleStyle:{}},{type:"slider",filterMode:"weakFilter",yAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",xAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",yAxisIndex:[0]}],legend:{data:["baseline","new"]},xAxis:{name:"date",type:"time",boundaryGap:[0,0],axisTick:{show:!0,alignWithLabel:!0},minInterval:24*3600,max:function(e){return e.max+(e.max-e.min)*.01},min:function(e){return e.min-(e.max-e.min)*.01},axisLabel:{showMaxLabel:"true",showMinLabel:"true",formatter:function(e,i){return B(e)}}},yAxis:{name:"tasks"},selectedMode:"single",series:[{name:"baseline",type:"custom",data:C,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:c,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}},{name:"new",type:"custom",data:b,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:c,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}}],tooltip:{axisPointer:{},formatter:e=>{let i="Resources: <br/>";if(e.value[3].resources)for(const o in e.value[3].resources){let s=e.value[3].resources,v=r.selectedData.newResources.find(U=>U.id==o);v||(v=""),i+=` &nbsp&nbspResource &nbsp  ${v==null?void 0:v.name} &nbsp id: ${o}  <br/>&nbsp&nbsp&nbsp&nbspunits/hour:${J(s[o].plannedUnitsPerHour)}=> ${J(s[o].newUnitsPerHour)}<br/>`}function d(o){let s;switch(o){case"New":e.value[3].critical?s="red":s="#b0e054";break;case"Old":e.value[3].critical?s="pink":s="#5474c4"}return`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${s};"></span>`}return`${e.name}<br/>
        <div style='margin-top:20px'>
         ${d("New")} New: ${y(w(e.value[4].changeNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${y(w(e.value[4].changeNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
         (${e.value[4].changeNew.duration})
        <br/>
         ${d("Old")} Old: ${y(w(e.value[4].baseNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${y(w(e.value[4].baseNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
       (${e.value[4].baseNew.duration})
         <br/>
         ${i}
        </div>`}}},a&&t.setOption(a),t.off("datazoom"),t.on("datazoom",function(e){f(e,C,b,c)}),Z(z,(e,i)=>{if(e==="Compare"){let d={series:[{name:"baseline",type:"custom",data:C,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:c,color:"black",position:"inside",formatter:function(o){return o.data.name},fontSize:12}}},{name:"new",type:"custom",data:b,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:c,color:"black",position:"inside",formatter:function(o){return o.data.name},fontSize:12}}}]};t.setOption(d),t.off("datazoom"),t.on("datazoom",function(o){f(o,C,b,c)})}else{let d=JSON.parse(JSON.stringify(C)).map((v,U)=>{let A={...v};return A.value[0]=C.length*2-U,A}),o=JSON.parse(JSON.stringify(b)).map((v,U)=>{let A={...v};return A.value[0]=C.length-U,A}),s={series:[{name:"baseline",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:c,color:"black",position:"inside",formatter:function(v){return v.data.name},fontSize:12}}},{name:"new",type:"custom",data:o,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:c,color:"black",position:"inside",formatter:function(v){return v.data.name},fontSize:12}}}]};t.setOption(s),t.off("datazoom"),t.on("datazoom",function(v){f(v,d,o,c)})}});function f(e,i,d,o){o||(e.batch[0].end-e.batch[0].start<30/d.length*100?t.setOption({series:[{name:"baseline",type:"custom",data:i,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"new",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}):t.setOption({series:[{name:"baseline",type:"custom",data:i,large:!0,renderItem:n,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"new",type:"custom",data:d,large:!0,renderItem:n,encode:{x:[1,2],y:0},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}))}t.on("mousemove",function(e){t.dispatchAction({type:"highlight",dataIndex:e.dataIndex})}),S=m.init(document.getElementById("myEcharts01"),"purple-passion"),S.on("mousemove",function(e){S.dispatchAction({type:"highlight",name:e.name})}),S.on("click",function(e){S.dispatchAction({type:"select",name:e.name})})}let O=I("");function J(a){if(!a)return"0.00";var a=Math.round(parseFloat(a)*100)/100,n=a.toString().split(".");if(n.length==1)return a=a.toString()+".00",a;if(n.length>1)return n[1].length<2&&(a=a.toString()+"0"),a}function G(t,a){return t.reduce(function(n,c){let f=c[a];return n[f]||(n[f]=[]),n[f].push(c),n},{})}let Q=R(()=>{let t=r.selectedData.baselineResources.map(n=>({id:n.id,name:n.name,type:n.type})),a=G(t,"type");if(O.value){const n=new RegExp(O.value,"i");let c={};for(let f in a)c[f]=a[f].filter(e=>n.test(e.name));return c}else return a}),Y=R(()=>{var n;const t=r.selectedData.baselineResources;let a="base";return $.value?[t.filter(f=>f.id&&f.id===$.value)[0].distribution,a]:t.length==0?[]:($.value=t[0].id,[(n=t[0])==null?void 0:n.distribution,a])}),X=R(()=>{var n;const t=r.selectedData.newResources;let a="new";return $.value?[t.filter(f=>f.id&&f.id===$.value)[0].distribution,a]:t.length==0?[]:[(n=t[0])==null?void 0:n.distribution,a]}),ee=R(()=>({toolbox:{feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"none"},{type:"slider",filterMode:"none"},{type:"inside",filterMode:"none"},{type:"inside",filterMode:"none"}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},animation:!1,legend:{data:["baseline","new"]},xAxis:{name:"date",type:"time",axisLabel:{formatter:"{yyyy}-{MM}-{dd}"}},yAxis:{name:"units / day"},series:[{name:"baseline",type:"bar",data:_(Y.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"self",blurScope:"coordinateSystem"}},{name:"new",type:"bar",data:_(X.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"series",blurScope:"coordinateSystem"}}]}));function L(){S.setOption(ee.value)}Z(h,()=>{L()});async function te(){p.push({name:"OptimizedReport"}),r.active=3}let $=I("");function ae(){p.push({name:"BaselineSummary"}),r.active=1}function ne(t){$.value=t}return Z($,()=>{L()}),(t,a)=>{const n=ye,c=fe,f=he,e=ue("v-btn");return M(),N(H,null,[u("div",xe,[u("div",De,[u("h2",null,[T(g(t.$t("optimizedSummary.title[0]"))+" ",1),u("span",_e,g(l(r).SummaryData.group),1),u("div",$e,[u("span",null,g(l(r).setting.Steps)+" "+g(t.$t("optimizedSummary.title[1]")),1)]),u("div",ze,[u("span",null,g(`${l(r).setting.Ratio[0]*100}% - ${l(r).setting.Ratio[1]*100}% ${t.$t("optimizedSummary.title[2]")}`),1)])]),u("div",Ce,[x(P,{title:t.$t("optimizedSummary.header[0]"),height:180,precent:k(l(r).SummaryData.changedDuration-l(r).SummaryData.baseDuration,l(r).SummaryData.baseDuration),isPositive:!0,body:[l(r).SummaryData.changedDuration+" days",l(r).SummaryData.baseDuration+" days",l(r).SummaryData.planDurationDays+" days"]},null,8,["title","precent","body"]),x(P,{title:t.$t("baselineSummary.Tsidebar[1]"),height:180,precent:k(l(r).SummaryData.maxResourceUnit-l(r).SummaryData.BasemaxResourceUnit,l(r).SummaryData.BasemaxResourceUnit),isPositive:!1,body:[l(r).SummaryData.maxResourceUnit,l(r).SummaryData.BasemaxResourceUnit]},null,8,["title","precent","body"]),x(P,{title:t.$t("optimizedSummary.header[2]"),height:180,body:[l(r).SummaryData.changgedTasks,l(r).SummaryData.TotalTasks]},null,8,["title","body"]),x(P,{title:t.$t("optimizedSummary.header[3]"),height:180,body:[l(r).SummaryData.changedCriticalPath,l(r).SummaryData.changedCriticalPath,l(r).SummaryData.baseCriticalPath]},null,8,["title","body"])]),u("div",ke,[u("div",Ie,[u("div",null,g(t.$t("optimizedSummary.chartName[0]")),1),x(c,{modelValue:l(z),"onUpdate:modelValue":a[0]||(a[0]=i=>W(z)?z.value=i:z=i),class:"m-2",placeholder:"Select",size:"large"},{default:F(()=>[x(n,{label:"Compare Mode",value:"Compare"}),x(n,{label:"Separate Mode",value:"Separate"})]),_:1},8,["modelValue"])]),u("span",null,g(t.$t("optimizedSummary.chartName[1]")),1),Re,u("div",Oe,null,512)]),u("div",Me,[u("div",Fe,[u("div",null,g(t.$t("optimizedSummary.chartName[2]")),1)]),u("span",null,g(t.$t("optimizedSummary.chartName[3]")),1),x(f,{modelValue:l(O),"onUpdate:modelValue":a[1]||(a[1]=i=>W(O)?O.value=i:O=i),placeholder:"Search Resources"},null,8,["modelValue"]),(M(!0),N(H,null,q(l(Q),(i,d)=>(M(),N("div",null,[u("div",Ve,g(d)+" Resources",1),u("div",Ue,[(M(!0),N(H,null,q(i,(o,s)=>(M(),N("div",{key:s,class:"type"},[x(e,{variant:"text",value:s,class:me({activeType:l($)==o.id}),onClick:()=>{ne(o.id)}},{default:F(()=>[T(g(o.name)+" "+g(o.type),1)]),_:2},1032,["value","class","onClick"])]))),128))])]))),256)),u("div",Ae,null,512)]),u("div",Ne,[x(e,{onClick:ae,class:"btnback"},{default:F(()=>[T("BACK")]),_:1}),x(e,{onClick:te,class:"btngo"},{default:F(()=>[T(g(t.$t("optimizedSummary.btn[1]")),1)]),_:1})])])]),x(Se,{onCloseDialog:E,data:l(D),dialogVisible:l(V)},null,8,["data","dialogVisible"])],64)}}},je=ie(Ee,[["__scopeId","data-v-36754bb2"]]);export{je as default};
