import{ah as Xy,ai as DY,af as lj,e as sj,aj as NY,o as zl,n as _c,t as HY,c as oa,y as LY,z as xn,F as gb,H as rt,u as ht,x as pb,$ as jY,r as mb,a0 as FY,ag as BY,X as VY,ac as bb,a2 as Lf,q as Zt,Z as ji,v as wb,a as Sb,ak as WY,a3 as UY,a4 as zY}from"./index-979567ae.js";import{E as YY}from"./el-button-4740fd87.js";import"./index-66d2cb58.js";import{a as vk}from"./index-1b326afd.js";var je=function(e){try{return!!e()}catch{return!0}},GY=je,Kd=!GY(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),uj=Kd,fj=Function.prototype,iC=fj.call,KY=uj&&fj.bind.bind(iC,iC),Ye=uj?KY:function(e){return function(){return iC.apply(e,arguments)}},cj=Ye,qY=cj({}.toString),XY=cj("".slice),Wn=function(e){return XY(qY(e),8,-1)},ZY=Ye,QY=je,JY=Wn,Cb=Object,eG=ZY("".split),qd=QY(function(){return!Cb("z").propertyIsEnumerable(0)})?function(e){return JY(e)=="String"?eG(e,""):Cb(e)}:Cb,Cn=function(e){return e==null},tG=Cn,rG=TypeError,Ar=function(e){if(tG(e))throw rG("Can't call method on "+e);return e},nG=qd,oG=Ar,zr=function(e){return nG(oG(e))},Vv=function(e){return e&&e.Math==Math&&e},vt=Vv(typeof globalThis=="object"&&globalThis)||Vv(typeof window=="object"&&window)||Vv(typeof self=="object"&&self)||Vv(typeof Xy=="object"&&Xy)||function(){return this}()||Xy||Function("return this")(),hj={exports:{}},iG=!1,yk=vt,aG=Object.defineProperty,a0=function(e,t){try{aG(yk,e,{value:t,configurable:!0,writable:!0})}catch{yk[e]=t}return t},lG=vt,sG=a0,gk="__core-js_shared__",uG=lG[gk]||sG(gk,{}),l0=uG,pk=l0;(hj.exports=function(e,t){return pk[e]||(pk[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"});var wf=hj.exports,fG=Ar,cG=Object,Ir=function(e){return cG(fG(e))},hG=Ye,dG=Ir,vG=hG({}.hasOwnProperty),Dt=Object.hasOwn||function(t,r){return vG(dG(t),r)},yG=Ye,gG=0,pG=Math.random(),mG=yG(1 .toString),rm=function(e){return"Symbol("+(e===void 0?"":e)+")_"+mG(++gG+pG,36)},Qa=typeof navigator<"u"&&String(navigator.userAgent)||"",dj=vt,_b=Qa,mk=dj.process,bk=dj.Deno,wk=mk&&mk.versions||bk&&bk.version,Sk=wk&&wk.v8,hn,jg;Sk&&(hn=Sk.split("."),jg=hn[0]>0&&hn[0]<4?1:+(hn[0]+hn[1]));!jg&&_b&&(hn=_b.match(/Edge\/(\d+)/),(!hn||hn[1]>=74)&&(hn=_b.match(/Chrome\/(\d+)/),hn&&(jg=+hn[1])));var Xd=jg,Ck=Xd,bG=je,wG=vt,SG=wG.String,Sf=!!Object.getOwnPropertySymbols&&!bG(function(){var e=Symbol();return!SG(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ck&&Ck<41}),CG=Sf,vj=CG&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_G=vt,OG=wf,_k=Dt,RG=rm,EG=Sf,TG=vj,Yl=_G.Symbol,Ob=OG("wks"),PG=TG?Yl.for||Yl:Yl&&Yl.withoutSetter||RG,wt=function(e){return _k(Ob,e)||(Ob[e]=EG&&_k(Yl,e)?Yl[e]:PG("Symbol."+e)),Ob[e]},aC=typeof document=="object"&&document.all,kG=typeof aC>"u"&&aC!==void 0,yj={all:aC,IS_HTMLDDA:kG},gj=yj,$G=gj.all,Ot=gj.IS_HTMLDDA?function(e){return typeof e=="function"||e===$G}:function(e){return typeof e=="function"},Ok=Ot,pj=yj,AG=pj.all,zt=pj.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Ok(e)||e===AG}:function(e){return typeof e=="object"?e!==null:Ok(e)},IG=zt,MG=String,xG=TypeError,Lt=function(e){if(IG(e))return e;throw xG(MG(e)+" is not an object")},s0={},DG=je,Yt=!DG(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),NG=Yt,HG=je,mj=NG&&HG(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),_r={},LG=vt,Rk=zt,lC=LG.document,jG=Rk(lC)&&Rk(lC.createElement),nm=function(e){return jG?lC.createElement(e):{}},FG=Yt,BG=je,VG=nm,bj=!FG&&!BG(function(){return Object.defineProperty(VG("div"),"a",{get:function(){return 7}}).a!=7}),WG=Kd,Wv=Function.prototype.call,Xt=WG?Wv.bind(Wv):function(){return Wv.apply(Wv,arguments)},Rb=vt,UG=Ot,zG=function(e){return UG(e)?e:void 0},Wo=function(e,t){return arguments.length<2?zG(Rb[e]):Rb[e]&&Rb[e][t]},YG=Ye,xi=YG({}.isPrototypeOf),GG=Wo,KG=Ot,qG=xi,XG=vj,ZG=Object,Zd=XG?function(e){return typeof e=="symbol"}:function(e){var t=GG("Symbol");return KG(t)&&qG(t.prototype,ZG(e))},QG=String,Cf=function(e){try{return QG(e)}catch{return"Object"}},JG=Ot,e3=Cf,t3=TypeError,Ja=function(e){if(JG(e))return e;throw t3(e3(e)+" is not a function")},r3=Ja,n3=Cn,el=function(e,t){var r=e[t];return n3(r)?void 0:r3(r)},Eb=Xt,Tb=Ot,Pb=zt,o3=TypeError,wj=function(e,t){var r,n;if(t==="string"&&Tb(r=e.toString)&&!Pb(n=Eb(r,e))||Tb(r=e.valueOf)&&!Pb(n=Eb(r,e))||t!=="string"&&Tb(r=e.toString)&&!Pb(n=Eb(r,e)))return n;throw o3("Can't convert object to primitive value")},i3=Xt,Ek=zt,Tk=Zd,a3=el,l3=wj,s3=wt,u3=TypeError,f3=s3("toPrimitive"),Sj=function(e,t){if(!Ek(e)||Tk(e))return e;var r=a3(e,f3),n;if(r){if(t===void 0&&(t="default"),n=i3(r,e,t),!Ek(n)||Tk(n))return n;throw u3("Can't convert object to primitive value")}return t===void 0&&(t="number"),l3(e,t)},c3=Sj,h3=Zd,om=function(e){var t=c3(e,"string");return h3(t)?t:t+""},d3=Yt,v3=bj,y3=mj,Uv=Lt,Pk=om,g3=TypeError,kb=Object.defineProperty,p3=Object.getOwnPropertyDescriptor,$b="enumerable",Ab="configurable",Ib="writable";_r.f=d3?y3?function(t,r,n){if(Uv(t),r=Pk(r),Uv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Ib in n&&!n[Ib]){var o=p3(t,r);o&&o[Ib]&&(t[r]=n.value,n={configurable:Ab in n?n[Ab]:o[Ab],enumerable:$b in n?n[$b]:o[$b],writable:!1})}return kb(t,r,n)}:kb:function(t,r,n){if(Uv(t),r=Pk(r),Uv(n),v3)try{return kb(t,r,n)}catch{}if("get"in n||"set"in n)throw g3("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var m3=Math.ceil,b3=Math.floor,w3=Math.trunc||function(t){var r=+t;return(r>0?b3:m3)(r)},S3=w3,Di=function(e){var t=+e;return t!==t||t===0?0:S3(t)},C3=Di,_3=Math.max,O3=Math.min,Qd=function(e,t){var r=C3(e);return r<0?_3(r+t,0):O3(r,t)},R3=Di,E3=Math.min,tl=function(e){return e>0?E3(R3(e),9007199254740991):0},T3=tl,en=function(e){return T3(e.length)},P3=zr,k3=Qd,$3=en,kk=function(e){return function(t,r,n){var o=P3(t),i=$3(o),a=k3(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},u0={includes:kk(!0),indexOf:kk(!1)},Jd={},A3=Ye,Mb=Dt,I3=zr,M3=u0.indexOf,x3=Jd,$k=A3([].push),Cj=function(e,t){var r=I3(e),n=0,o=[],i;for(i in r)!Mb(x3,i)&&Mb(r,i)&&$k(o,i);for(;t.length>n;)Mb(r,i=t[n++])&&(~M3(o,i)||$k(o,i));return o},f0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],D3=Cj,N3=f0,ev=Object.keys||function(t){return D3(t,N3)},H3=Yt,L3=mj,j3=_r,F3=Lt,B3=zr,V3=ev;s0.f=H3&&!L3?Object.defineProperties:function(t,r){F3(t);for(var n=B3(r),o=V3(r),i=o.length,a=0,l;i>a;)j3.f(t,l=o[a++],n[l]);return t};var W3=Wo,_j=W3("document","documentElement"),U3=wf,z3=rm,Ak=U3("keys"),im=function(e){return Ak[e]||(Ak[e]=z3(e))},Y3=Lt,G3=s0,Ik=f0,K3=Jd,q3=_j,X3=nm,Z3=im,Mk=">",xk="<",sC="prototype",uC="script",Oj=Z3("IE_PROTO"),xb=function(){},Rj=function(e){return xk+uC+Mk+e+xk+"/"+uC+Mk},Dk=function(e){e.write(Rj("")),e.close();var t=e.parentWindow.Object;return e=null,t},Q3=function(){var e=X3("iframe"),t="java"+uC+":",r;return e.style.display="none",q3.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(Rj("document.F=Object")),r.close(),r.F},zv,Zy=function(){try{zv=new ActiveXObject("htmlfile")}catch{}Zy=typeof document<"u"?document.domain&&zv?Dk(zv):Q3():Dk(zv);for(var e=Ik.length;e--;)delete Zy[sC][Ik[e]];return Zy()};K3[Oj]=!0;var _f=Object.create||function(t,r){var n;return t!==null?(xb[sC]=Y3(t),n=new xb,xb[sC]=null,n[Oj]=t):n=Zy(),r===void 0?n:G3.f(n,r)},J3=wt,eK=_f,tK=_r.f,fC=J3("unscopables"),cC=Array.prototype;cC[fC]==null&&tK(cC,fC,{configurable:!0,value:eK(null)});var tv=function(e){cC[fC][e]=!0},rv={},rK=vt,nK=Ot,Nk=rK.WeakMap,Ej=nK(Nk)&&/native code/.test(String(Nk)),nv=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},oK=Yt,iK=_r,aK=nv,rl=oK?function(e,t,r){return iK.f(e,t,aK(1,r))}:function(e,t,r){return e[t]=r,e},lK=Ej,Tj=vt,sK=zt,uK=rl,Db=Dt,Nb=l0,fK=im,cK=Jd,Hk="Object already initialized",hC=Tj.TypeError,hK=Tj.WeakMap,Fg,Bc,Bg,dK=function(e){return Bg(e)?Bc(e):Fg(e,{})},vK=function(e){return function(t){var r;if(!sK(t)||(r=Bc(t)).type!==e)throw hC("Incompatible receiver, "+e+" required");return r}};if(lK||Nb.state){var On=Nb.state||(Nb.state=new hK);On.get=On.get,On.has=On.has,On.set=On.set,Fg=function(e,t){if(On.has(e))throw hC(Hk);return t.facade=e,On.set(e,t),t},Bc=function(e){return On.get(e)||{}},Bg=function(e){return On.has(e)}}else{var cl=fK("state");cK[cl]=!0,Fg=function(e,t){if(Db(e,cl))throw hC(Hk);return t.facade=e,uK(e,cl,t),t},Bc=function(e){return Db(e,cl)?e[cl]:{}},Bg=function(e){return Db(e,cl)}}var Uo={set:Fg,get:Bc,has:Bg,enforce:dK,getterFor:vK},Un={},ov={},Pj={}.propertyIsEnumerable,kj=Object.getOwnPropertyDescriptor,yK=kj&&!Pj.call({1:2},1);ov.f=yK?function(t){var r=kj(this,t);return!!r&&r.enumerable}:Pj;var gK=Yt,pK=Xt,mK=ov,bK=nv,wK=zr,SK=om,CK=Dt,_K=bj,Lk=Object.getOwnPropertyDescriptor;Un.f=gK?Lk:function(t,r){if(t=wK(t),r=SK(r),_K)try{return Lk(t,r)}catch{}if(CK(t,r))return bK(!pK(mK.f,t,r),t[r])};var $j={exports:{}},dC=Yt,OK=Dt,Aj=Function.prototype,RK=dC&&Object.getOwnPropertyDescriptor,c0=OK(Aj,"name"),EK=c0&&function(){}.name==="something",TK=c0&&(!dC||dC&&RK(Aj,"name").configurable),iv={EXISTS:c0,PROPER:EK,CONFIGURABLE:TK},PK=Ye,kK=Ot,vC=l0,$K=PK(Function.toString);kK(vC.inspectSource)||(vC.inspectSource=function(e){return $K(e)});var Ij=vC.inspectSource,h0=Ye,AK=je,IK=Ot,Yv=Dt,yC=Yt,MK=iv.CONFIGURABLE,xK=Ij,Mj=Uo,DK=Mj.enforce,NK=Mj.get,jk=String,Qy=Object.defineProperty,HK=h0("".slice),LK=h0("".replace),jK=h0([].join),FK=yC&&!AK(function(){return Qy(function(){},"length",{value:8}).length!==8}),BK=String(String).split("String"),VK=$j.exports=function(e,t,r){HK(jk(t),0,7)==="Symbol("&&(t="["+LK(jk(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Yv(e,"name")||MK&&e.name!==t)&&(yC?Qy(e,"name",{value:t,configurable:!0}):e.name=t),FK&&r&&Yv(r,"arity")&&e.length!==r.arity&&Qy(e,"length",{value:r.arity});try{r&&Yv(r,"constructor")&&r.constructor?yC&&Qy(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=DK(e);return Yv(n,"source")||(n.source=jK(BK,typeof t=="string"?t:"")),e};Function.prototype.toString=VK(function(){return IK(this)&&NK(this).source||xK(this)},"toString");var xj=$j.exports,WK=Ot,UK=_r,zK=xj,YK=a0,tn=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(WK(r)&&zK(r,i,n),n.global)o?e[t]=r:YK(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:UK.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},nl={},GK=Cj,KK=f0,qK=KK.concat("length","prototype");nl.f=Object.getOwnPropertyNames||function(t){return GK(t,qK)};var av={};av.f=Object.getOwnPropertySymbols;var XK=Wo,ZK=Ye,QK=nl,JK=av,e4=Lt,t4=ZK([].concat),Dj=XK("Reflect","ownKeys")||function(t){var r=QK.f(e4(t)),n=JK.f;return n?t4(r,n(t)):r},Fk=Dt,r4=Dj,n4=Un,o4=_r,Nj=function(e,t,r){for(var n=r4(t),o=o4.f,i=n4.f,a=0;a<n.length;a++){var l=n[a];!Fk(e,l)&&!(r&&Fk(r,l))&&o(e,l,i(t,l))}},i4=je,a4=Ot,l4=/#|\.prototype\./,lv=function(e,t){var r=u4[s4(e)];return r==c4?!0:r==f4?!1:a4(t)?i4(t):!!t},s4=lv.normalize=function(e){return String(e).replace(l4,".").toLowerCase()},u4=lv.data={},f4=lv.NATIVE="N",c4=lv.POLYFILL="P",am=lv,Hb=vt,h4=Un.f,d4=rl,v4=tn,y4=a0,g4=Nj,p4=am,$e=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Hb:o?a=Hb[r]||y4(r,{}):a=(Hb[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=h4(a,l),s=f&&f.value):s=a[l],i=p4(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;g4(u,s)}(e.sham||s&&s.sham)&&d4(u,"sham",!0),v4(a,l,u,e)}},m4=je,Hj=!m4(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),b4=Dt,w4=Ot,S4=Ir,C4=im,_4=Hj,Bk=C4("IE_PROTO"),gC=Object,O4=gC.prototype,sv=_4?gC.getPrototypeOf:function(e){var t=S4(e);if(b4(t,Bk))return t[Bk];var r=t.constructor;return w4(r)&&t instanceof r?r.prototype:t instanceof gC?O4:null},R4=je,E4=Ot,T4=zt,Vk=sv,P4=tn,k4=wt,pC=k4("iterator"),Lj=!1,La,Lb,jb;[].keys&&(jb=[].keys(),"next"in jb?(Lb=Vk(Vk(jb)),Lb!==Object.prototype&&(La=Lb)):Lj=!0);var $4=!T4(La)||R4(function(){var e={};return La[pC].call(e)!==e});$4&&(La={});E4(La[pC])||P4(La,pC,function(){return this});var jj={IteratorPrototype:La,BUGGY_SAFARI_ITERATORS:Lj},A4=_r.f,I4=Dt,M4=wt,Wk=M4("toStringTag"),lm=function(e,t,r){e&&!r&&(e=e.prototype),e&&!I4(e,Wk)&&A4(e,Wk,{configurable:!0,value:t})},x4=jj.IteratorPrototype,D4=_f,N4=nv,H4=lm,L4=rv,j4=function(){return this},F4=function(e,t,r,n){var o=t+" Iterator";return e.prototype=D4(x4,{next:N4(+!n,r)}),H4(e,o,!1),L4[o]=j4,e},B4=Ye,V4=Ja,W4=function(e,t,r){try{return B4(V4(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},U4=Ot,z4=String,Y4=TypeError,G4=function(e){if(typeof e=="object"||U4(e))return e;throw Y4("Can't set "+z4(e)+" as a prototype")},K4=W4,q4=Lt,X4=G4,d0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=K4(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return q4(o),X4(i),e?r(o,i):o.__proto__=i,o}}():void 0),Z4=$e,Q4=Xt,Fj=iv,J4=Ot,e6=F4,Uk=sv,zk=d0,t6=lm,r6=rl,Fb=tn,n6=wt,o6=rv,Bj=jj,i6=Fj.PROPER,a6=Fj.CONFIGURABLE,Yk=Bj.IteratorPrototype,Gv=Bj.BUGGY_SAFARI_ITERATORS,jf=n6("iterator"),Gk="keys",Ff="values",Kk="entries",l6=function(){return this},v0=function(e,t,r,n,o,i,a){e6(r,t,n);var l=function(w){if(w===o&&h)return h;if(!Gv&&w in f)return f[w];switch(w){case Gk:return function(){return new r(this,w)};case Ff:return function(){return new r(this,w)};case Kk:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[jf]||f["@@iterator"]||o&&f[o],h=!Gv&&c||l(o),d=t=="Array"&&f.entries||c,v,y,m;if(d&&(v=Uk(d.call(new e)),v!==Object.prototype&&v.next&&(Uk(v)!==Yk&&(zk?zk(v,Yk):J4(v[jf])||Fb(v,jf,l6)),t6(v,s,!0))),i6&&o==Ff&&c&&c.name!==Ff&&(a6?r6(f,"name",Ff):(u=!0,h=function(){return Q4(c,this)})),o)if(y={values:l(Ff),keys:i?h:l(Gk),entries:l(Kk)},a)for(m in y)(Gv||u||!(m in f))&&Fb(f,m,y[m]);else Z4({target:t,proto:!0,forced:Gv||u},y);return f[jf]!==h&&Fb(f,jf,h,{name:o}),o6[t]=h,y},y0=function(e,t){return{value:e,done:t}},s6=zr,g0=tv,qk=rv,Vj=Uo,u6=_r.f,f6=v0,Kv=y0,c6=Yt,Wj="Array Iterator",h6=Vj.set,d6=Vj.getterFor(Wj),v6=f6(Array,"Array",function(e,t){h6(this,{type:Wj,target:s6(e),index:0,kind:t})},function(){var e=d6(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Kv(void 0,!0)):r=="keys"?Kv(n,!1):r=="values"?Kv(t[n],!1):Kv([n,t[n]],!1)},"values"),Xk=qk.Arguments=qk.Array;g0("keys");g0("values");g0("entries");if(c6&&Xk.name!=="values")try{u6(Xk,"name",{value:"values"})}catch{}var y6=wt,g6=y6("toStringTag"),Uj={};Uj[g6]="z";var p0=String(Uj)==="[object z]",p6=p0,m6=Ot,Jy=Wn,b6=wt,w6=b6("toStringTag"),S6=Object,C6=Jy(function(){return arguments}())=="Arguments",_6=function(e,t){try{return e[t]}catch{}},sm=p6?Jy:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=_6(t=S6(e),w6))=="string"?r:C6?Jy(t):(n=Jy(t))=="Object"&&m6(t.callee)?"Arguments":n},O6=p0,R6=sm,E6=O6?{}.toString:function(){return"[object "+R6(this)+"]"},T6=p0,P6=tn,k6=E6;T6||P6(Object.prototype,"toString",k6,{unsafe:!0});var $6=sm,A6=String,Gt=function(e){if($6(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return A6(e)},m0=Ye,I6=Di,M6=Gt,x6=Ar,D6=m0("".charAt),Zk=m0("".charCodeAt),N6=m0("".slice),Qk=function(e){return function(t,r){var n=M6(x6(t)),o=I6(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=Zk(n,o),a<55296||a>56319||o+1===i||(l=Zk(n,o+1))<56320||l>57343?e?D6(n,o):a:e?N6(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},b0={codeAt:Qk(!1),charAt:Qk(!0)},H6=b0.charAt,L6=Gt,zj=Uo,j6=v0,Jk=y0,Yj="String Iterator",F6=zj.set,B6=zj.getterFor(Yj);j6(String,"String",function(e){F6(this,{type:Yj,string:L6(e),index:0})},function(){var t=B6(this),r=t.string,n=t.index,o;return n>=r.length?Jk(void 0,!0):(o=H6(r,n),t.index+=o.length,Jk(o,!1))});var V6=je,w0=!V6(function(){return Object.isExtensible(Object.preventExtensions({}))}),W6=tn,S0=function(e,t,r){for(var n in t)W6(e,n,t[n],r);return e},Gj={exports:{}},um={},U6=om,z6=_r,Y6=nv,Of=function(e,t,r){var n=U6(t);n in e?z6.f(e,n,Y6(0,r)):e[n]=r},e$=Qd,G6=en,K6=Of,q6=Array,X6=Math.max,C0=function(e,t,r){for(var n=G6(e),o=e$(t,n),i=e$(r===void 0?n:r,n),a=q6(X6(i-o,0)),l=0;o<i;o++,l++)K6(a,l,e[o]);return a.length=l,a},Z6=Wn,Q6=zr,Kj=nl.f,J6=C0,qj=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],e8=function(e){try{return Kj(e)}catch{return J6(qj)}};um.f=function(t){return qj&&Z6(t)=="Window"?e8(t):Kj(Q6(t))};var t8=je,r8=t8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),n8=je,o8=zt,i8=Wn,t$=r8,eg=Object.isExtensible,a8=n8(function(){eg(1)}),l8=a8||t$?function(t){return!o8(t)||t$&&i8(t)=="ArrayBuffer"?!1:eg?eg(t):!0}:eg,s8=$e,u8=Ye,f8=Jd,c8=zt,_0=Dt,h8=_r.f,r$=nl,d8=um,O0=l8,v8=rm,y8=w0,Xj=!1,Lo=v8("meta"),g8=0,R0=function(e){h8(e,Lo,{value:{objectID:"O"+g8++,weakData:{}}})},p8=function(e,t){if(!c8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!_0(e,Lo)){if(!O0(e))return"F";if(!t)return"E";R0(e)}return e[Lo].objectID},m8=function(e,t){if(!_0(e,Lo)){if(!O0(e))return!0;if(!t)return!1;R0(e)}return e[Lo].weakData},b8=function(e){return y8&&Xj&&O0(e)&&!_0(e,Lo)&&R0(e),e},w8=function(){S8.enable=function(){},Xj=!0;var e=r$.f,t=u8([].splice),r={};r[Lo]=1,e(r).length&&(r$.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Lo){t(o,i,1);break}return o},s8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d8.f}))},S8=Gj.exports={enable:w8,fastKey:p8,getWeakData:m8,onFreeze:b8};f8[Lo]=!0;var uv=Gj.exports,C8=Wn,_8=Ye,fv=function(e){if(C8(e)==="Function")return _8(e)},n$=fv,O8=Ja,R8=Kd,E8=n$(n$.bind),cv=function(e,t){return O8(e),t===void 0?e:R8?E8(e,t):function(){return e.apply(t,arguments)}},T8=wt,P8=rv,k8=T8("iterator"),$8=Array.prototype,Zj=function(e){return e!==void 0&&(P8.Array===e||$8[k8]===e)},A8=sm,o$=el,I8=Cn,M8=rv,x8=wt,D8=x8("iterator"),E0=function(e){if(!I8(e))return o$(e,D8)||o$(e,"@@iterator")||M8[A8(e)]},N8=Xt,H8=Ja,L8=Lt,j8=Cf,F8=E0,B8=TypeError,Qj=function(e,t){var r=arguments.length<2?F8(e):t;if(H8(r))return L8(N8(r,e));throw B8(j8(e)+" is not iterable")},V8=Xt,i$=Lt,W8=el,Jj=function(e,t,r){var n,o;i$(e);try{if(n=W8(e,"return"),!n){if(t==="throw")throw r;return r}n=V8(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return i$(n),r},U8=cv,z8=Xt,Y8=Lt,G8=Cf,K8=Zj,q8=en,a$=xi,X8=Qj,Z8=E0,l$=Jj,Q8=TypeError,tg=function(e,t){this.stopped=e,this.result=t},s$=tg.prototype,T0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=U8(t,n),u,f,c,h,d,v,y,m=function(S){return u&&l$(u,"normal",S),new tg(!0,S)},w=function(S){return o?(Y8(S),l?s(S[0],S[1],m):s(S[0],S[1])):l?s(S,m):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=Z8(e),!f)throw Q8(G8(e)+" is not iterable");if(K8(f)){for(c=0,h=q8(e);h>c;c++)if(d=w(e[c]),d&&a$(s$,d))return d;return new tg(!1)}u=X8(e,f)}for(v=i?e.next:u.next;!(y=z8(v,u)).done;){try{d=w(y.value)}catch(S){l$(u,"throw",S)}if(typeof d=="object"&&d&&a$(s$,d))return d}return new tg(!1)},J8=xi,e5=TypeError,P0=function(e,t){if(J8(t,e))return e;throw e5("Incorrect invocation")},t5=wt,eF=t5("iterator"),tF=!1;try{var r5=0,u$={next:function(){return{done:!!r5++}},return:function(){tF=!0}};u$[eF]=function(){return this},Array.from(u$,function(){throw 2})}catch{}var rF=function(e,t){if(!t&&!tF)return!1;var r=!1;try{var n={};n[eF]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},n5=Ot,o5=zt,f$=d0,k0=function(e,t,r){var n,o;return f$&&n5(n=t.constructor)&&n!==r&&o5(o=n.prototype)&&o!==r.prototype&&f$(e,o),e},i5=$e,a5=vt,l5=Ye,c$=am,s5=tn,u5=uv,f5=T0,c5=P0,h5=Ot,d5=Cn,Bb=zt,Vb=je,v5=rF,y5=lm,g5=k0,fm=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=a5[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=l5(l[w]);s5(l,w,w=="add"?function(k){return S(this,k===0?0:k),this}:w=="delete"?function(C){return o&&!Bb(C)?!1:S(this,C===0?0:C)}:w=="get"?function(k){return o&&!Bb(k)?void 0:S(this,k===0?0:k)}:w=="has"?function(k){return o&&!Bb(k)?!1:S(this,k===0?0:k)}:function(k,O){return S(this,k===0?0:k,O),this})},c=c$(e,!h5(a)||!(o||l.forEach&&!Vb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),u5.enable();else if(c$(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=Vb(function(){h.has(1)}),y=v5(function(w){new a(w)}),m=!o&&Vb(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});y||(s=t(function(w,S){c5(w,l);var C=g5(new a,w,s);return d5(S)||f5(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||m)&&(f("delete"),f("has"),n&&f("get")),(m||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,i5({global:!0,constructor:!0,forced:s!=a},u),y5(s,e),o||r.setStrong(s,e,n),s},p5=Wn,Rf=Array.isArray||function(t){return p5(t)=="Array"},m5=Ye,b5=je,nF=Ot,w5=sm,S5=Wo,C5=Ij,oF=function(){},_5=[],iF=S5("Reflect","construct"),$0=/^\s*(?:class|function)\b/,O5=m5($0.exec),R5=!$0.exec(oF),Bf=function(t){if(!nF(t))return!1;try{return iF(oF,_5,t),!0}catch{return!1}},aF=function(t){if(!nF(t))return!1;switch(w5(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return R5||!!O5($0,C5(t))}catch{return!0}};aF.sham=!0;var cm=!iF||b5(function(){var e;return Bf(Bf.call)||!Bf(Object)||!Bf(function(){e=!0})||e})?aF:Bf,h$=Rf,E5=cm,T5=zt,P5=wt,k5=P5("species"),d$=Array,$5=function(e){var t;return h$(e)&&(t=e.constructor,E5(t)&&(t===d$||h$(t.prototype))?t=void 0:T5(t)&&(t=t[k5],t===null&&(t=void 0))),t===void 0?d$:t},A5=$5,A0=function(e,t){return new(A5(e))(t===0?0:t)},I5=cv,M5=Ye,x5=qd,D5=Ir,N5=en,H5=A0,v$=M5([].push),qo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,f,c){for(var h=D5(s),d=x5(h),v=I5(u,f),y=N5(d),m=0,w=c||H5,S=t?w(s,y):r||a?w(s,0):void 0,C,k;y>m;m++)if((l||m in d)&&(C=d[m],k=v(C,m,h),e))if(t)S[m]=k;else if(k)switch(e){case 3:return!0;case 5:return C;case 6:return m;case 2:v$(S,C)}else switch(e){case 4:return!1;case 7:v$(S,C)}return i?-1:n||o?o:S}},ol={forEach:qo(0),map:qo(1),filter:qo(2),some:qo(3),every:qo(4),find:qo(5),findIndex:qo(6),filterReject:qo(7)},L5=Ye,y$=S0,qv=uv.getWeakData,j5=P0,F5=Lt,B5=Cn,Wb=zt,V5=T0,lF=ol,g$=Dt,sF=Uo,W5=sF.set,U5=sF.getterFor,z5=lF.find,Y5=lF.findIndex,G5=L5([].splice),K5=0,Xv=function(e){return e.frozen||(e.frozen=new uF)},uF=function(){this.entries=[]},Ub=function(e,t){return z5(e.entries,function(r){return r[0]===t})};uF.prototype={get:function(e){var t=Ub(this,e);if(t)return t[1]},has:function(e){return!!Ub(this,e)},set:function(e,t){var r=Ub(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=Y5(this.entries,function(r){return r[0]===e});return~t&&G5(this.entries,t,1),!!~t}};var fF={getConstructor:function(e,t,r,n){var o=e(function(s,u){j5(s,i),W5(s,{type:t,id:K5++,frozen:void 0}),B5(u)||V5(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=U5(t),l=function(s,u,f){var c=a(s),h=qv(F5(u),!0);return h===!0?Xv(c).set(u,f):h[c.id]=f,s};return y$(i,{delete:function(s){var u=a(this);if(!Wb(s))return!1;var f=qv(s);return f===!0?Xv(u).delete(s):f&&g$(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!Wb(u))return!1;var c=qv(u);return c===!0?Xv(f).has(u):c&&g$(c,f.id)}}),y$(i,r?{get:function(u){var f=a(this);if(Wb(u)){var c=qv(u);return c===!0?Xv(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},q5=w0,p$=vt,rg=Ye,m$=S0,X5=uv,Z5=fm,cF=fF,Zv=zt,Qv=Uo.enforce,Q5=je,J5=Ej,hv=Object,e9=Array.isArray,Jv=hv.isExtensible,hF=hv.isFrozen,t9=hv.isSealed,dF=hv.freeze,r9=hv.seal,b$={},w$={},n9=!p$.ActiveXObject&&"ActiveXObject"in p$,Vf,vF=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},yF=Z5("WeakMap",vF,cF),Bl=yF.prototype,ng=rg(Bl.set),o9=function(){return q5&&Q5(function(){var e=dF([]);return ng(new yF,e,1),!hF(e)})};if(J5)if(n9){Vf=cF.getConstructor(vF,"WeakMap",!0),X5.enable();var S$=rg(Bl.delete),ey=rg(Bl.has),C$=rg(Bl.get);m$(Bl,{delete:function(e){if(Zv(e)&&!Jv(e)){var t=Qv(this);return t.frozen||(t.frozen=new Vf),S$(this,e)||t.frozen.delete(e)}return S$(this,e)},has:function(t){if(Zv(t)&&!Jv(t)){var r=Qv(this);return r.frozen||(r.frozen=new Vf),ey(this,t)||r.frozen.has(t)}return ey(this,t)},get:function(t){if(Zv(t)&&!Jv(t)){var r=Qv(this);return r.frozen||(r.frozen=new Vf),ey(this,t)?C$(this,t):r.frozen.get(t)}return C$(this,t)},set:function(t,r){if(Zv(t)&&!Jv(t)){var n=Qv(this);n.frozen||(n.frozen=new Vf),ey(this,t)?ng(this,t,r):n.frozen.set(t,r)}else ng(this,t,r);return this}})}else o9()&&m$(Bl,{set:function(t,r){var n;return e9(t)&&(hF(t)?n=b$:t9(t)&&(n=w$)),ng(this,t,r),n==b$&&dF(t),n==w$&&r9(t),this}});var gF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},i9=nm,zb=i9("span").classList,_$=zb&&zb.constructor&&zb.constructor.prototype,pF=_$===Object.prototype?void 0:_$,O$=vt,mF=gF,a9=pF,gc=v6,Yb=rl,bF=wt,Gb=bF("iterator"),R$=bF("toStringTag"),Kb=gc.values,wF=function(e,t){if(e){if(e[Gb]!==Kb)try{Yb(e,Gb,Kb)}catch{e[Gb]=Kb}if(e[R$]||Yb(e,R$,t),mF[t]){for(var r in gc)if(e[r]!==gc[r])try{Yb(e,r,gc[r])}catch{e[r]=gc[r]}}}};for(var qb in mF)wF(O$[qb]&&O$[qb].prototype,qb);wF(a9,"DOMTokenList");var l9=je,Ef=function(e,t){var r=[][e];return!!r&&l9(function(){r.call(null,t||function(){return 1},1)})},s9=$e,u9=fv,f9=u0.indexOf,c9=Ef,mC=u9([].indexOf),SF=!!mC&&1/mC([1],1,-0)<0,h9=SF||!c9("indexOf");s9({target:"Array",proto:!0,forced:h9},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return SF?mC(this,t,r)||0:f9(this,t,r)}});var E$=Cf,d9=TypeError,CF=function(e,t){if(!delete e[t])throw d9("Cannot delete property "+E$(t)+" of "+E$(e))},T$=C0,v9=Math.floor,bC=function(e,t){var r=e.length,n=v9(r/2);return r<8?y9(e,t):g9(e,bC(T$(e,0,n),t),bC(T$(e,n),t),t)},y9=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},g9=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},p9=bC,m9=Qa,P$=m9.match(/firefox\/(\d+)/i),b9=!!P$&&+P$[1],w9=Qa,S9=/MSIE|Trident/.test(w9),C9=Qa,k$=C9.match(/AppleWebKit\/(\d+)\./),_9=!!k$&&+k$[1],O9=$e,_F=Ye,R9=Ja,E9=Ir,$$=en,T9=CF,A$=Gt,I0=je,P9=p9,k9=Ef,I$=b9,$9=S9,M$=Xd,x$=_9,fi=[],D$=_F(fi.sort),A9=_F(fi.push),I9=I0(function(){fi.sort(void 0)}),M9=I0(function(){fi.sort(null)}),x9=k9("sort"),OF=!I0(function(){if(M$)return M$<70;if(!(I$&&I$>3)){if($9)return!0;if(x$)return x$<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)fi.push({k:r+o,v:n})}for(fi.sort(function(i,a){return a.v-i.v}),o=0;o<fi.length;o++)r=fi[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),D9=I9||!M9||!x9||!OF,N9=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:A$(t)>A$(r)?1:-1}};O9({target:"Array",proto:!0,forced:D9},{sort:function(t){t!==void 0&&R9(t);var r=E9(this);if(OF)return t===void 0?D$(r):D$(r,t);var n=[],o=$$(r),i,a;for(a=0;a<o;a++)a in r&&A9(n,r[a]);for(P9(n,N9(t)),i=$$(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)T9(r,a++);return r}});var H9=$e,L9=ol.find,j9=tv,wC="find",RF=!0;wC in[]&&Array(1)[wC](function(){RF=!1});H9({target:"Array",proto:!0,forced:RF},{find:function(t){return L9(this,t,arguments.length>1?arguments[1]:void 0)}});j9(wC);var F9=Lt,EF=function(){var e=F9(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},M0=je,B9=vt,x0=B9.RegExp,D0=M0(function(){var e=x0("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),V9=D0||M0(function(){return!x0("a","y").sticky}),W9=D0||M0(function(){var e=x0("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),N0={BROKEN_CARET:W9,MISSED_STICKY:V9,UNSUPPORTED_Y:D0},U9=je,z9=vt,Y9=z9.RegExp,TF=U9(function(){var e=Y9(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),G9=je,K9=vt,q9=K9.RegExp,PF=G9(function(){var e=q9("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Gl=Xt,hm=Ye,X9=Gt,Z9=EF,Q9=N0,J9=wf,e7=_f,t7=Uo.get,r7=TF,n7=PF,o7=J9("native-string-replace",String.prototype.replace),Vg=RegExp.prototype.exec,SC=Vg,i7=hm("".charAt),a7=hm("".indexOf),l7=hm("".replace),Xb=hm("".slice),CC=function(){var e=/a/,t=/b*/g;return Gl(Vg,e,"a"),Gl(Vg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),kF=Q9.BROKEN_CARET,_C=/()??/.exec("")[1]!==void 0,s7=CC||_C||kF||r7||n7;s7&&(SC=function(t){var r=this,n=t7(r),o=X9(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=Gl(SC,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=kF&&r.sticky,y=Gl(Z9,r),m=r.source,w=0,S=o;if(v&&(y=l7(y,"y",""),a7(y,"g")===-1&&(y+="g"),S=Xb(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&i7(o,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",S=" "+S,w++),l=new RegExp("^(?:"+m+")",y)),_C&&(l=new RegExp("^"+m+"$(?!\\s)",y)),CC&&(s=r.lastIndex),u=Gl(Vg,v?l:r,S),v?u?(u.input=Xb(u.input,w),u[0]=Xb(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:CC&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),_C&&u&&u.length>1&&Gl(o7,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=e7(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var dm=SC,u7=$e,N$=dm;u7({target:"RegExp",proto:!0,forced:/./.exec!==N$},{exec:N$});var f7=Kd,$F=Function.prototype,H$=$F.apply,L$=$F.call,il=typeof Reflect=="object"&&Reflect.apply||(f7?L$.bind(H$):function(){return L$.apply(H$,arguments)}),j$=fv,F$=tn,c7=dm,B$=je,AF=wt,h7=rl,d7=AF("species"),Zb=RegExp.prototype,vm=function(e,t,r,n){var o=AF(e),i=!B$(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!B$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[d7]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=j$(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=j$(u),y=f.exec;return y===c7||y===Zb.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});F$(String.prototype,e,s[0]),F$(Zb,o,s[1])}n&&h7(Zb[o],"sham",!0)},v7=b0.charAt,H0=function(e,t,r){return t+(r?v7(e,t).length:1)},L0=Ye,y7=Ir,g7=Math.floor,Qb=L0("".charAt),p7=L0("".replace),Jb=L0("".slice),m7=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,b7=/\$([$&'`]|\d{1,2})/g,w7=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=b7;return o!==void 0&&(o=y7(o),s=m7),p7(i,s,function(u,f){var c;switch(Qb(f,0)){case"$":return"$";case"&":return e;case"`":return Jb(t,0,r);case"'":return Jb(t,a);case"<":c=o[Jb(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=g7(h/10);return d===0?u:d<=l?n[d-1]===void 0?Qb(f,1):n[d-1]+Qb(f,1):u}c=n[h-1]}return c===void 0?"":c})},V$=Xt,S7=Lt,C7=Ot,_7=Wn,O7=dm,R7=TypeError,ym=function(e,t){var r=e.exec;if(C7(r)){var n=V$(r,e,t);return n!==null&&S7(n),n}if(_7(e)==="RegExp")return V$(O7,e,t);throw R7("RegExp#exec called on incompatible receiver")},E7=il,W$=Xt,gm=Ye,T7=vm,P7=je,k7=Lt,$7=Ot,A7=Cn,I7=Di,M7=tl,hl=Gt,x7=Ar,D7=H0,N7=el,H7=w7,L7=ym,j7=wt,OC=j7("replace"),F7=Math.max,B7=Math.min,V7=gm([].concat),ew=gm([].push),U$=gm("".indexOf),z$=gm("".slice),W7=function(e){return e===void 0?e:String(e)},U7=function(){return"a".replace(/./,"$0")==="$0"}(),Y$=function(){return/./[OC]?/./[OC]("a","$0")==="":!1}(),z7=!P7(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});T7("replace",function(e,t,r){var n=Y$?"$":"$0";return[function(i,a){var l=x7(this),s=A7(i)?void 0:N7(i,OC);return s?W$(s,i,l,a):W$(t,hl(l),i,a)},function(o,i){var a=k7(this),l=hl(o);if(typeof i=="string"&&U$(i,n)===-1&&U$(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=$7(i);u||(i=hl(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=L7(a,l);if(d===null||(ew(h,d),!f))break;var v=hl(d[0]);v===""&&(a.lastIndex=D7(l,M7(a.lastIndex),c))}for(var y="",m=0,w=0;w<h.length;w++){d=h[w];for(var S=hl(d[0]),C=F7(B7(I7(d.index),l.length),0),k=[],O=1;O<d.length;O++)ew(k,W7(d[O]));var W=d.groups;if(u){var Y=V7([S],k,C,l);W!==void 0&&ew(Y,W);var q=hl(E7(i,void 0,Y))}else q=H7(S,l,C,k,W,i);C>=m&&(y+=z$(l,m,C)+q,m=C+S.length)}return y+z$(l,m)}]},!z7||!U7||Y$);var Y7=je,G7=wt,K7=Xd,q7=G7("species"),dv=function(e){return K7>=51||!Y7(function(){var t=[],r=t.constructor={};return r[q7]=function(){return{foo:1}},t[e](Boolean).foo!==1})},X7=$e,Z7=ol.filter,Q7=dv,J7=Q7("filter");X7({target:"Array",proto:!0,forced:!J7},{filter:function(t){return Z7(this,t,arguments.length>1?arguments[1]:void 0)}});var eq=vt,IF=eq,j0={},tq=wt;j0.f=tq;var G$=IF,rq=Dt,nq=j0,oq=_r.f,F0=function(e){var t=G$.Symbol||(G$.Symbol={});rq(t,e)||oq(t,e,{value:nq.f(e)})},iq=Xt,aq=Wo,lq=wt,sq=tn,MF=function(){var e=aq("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=lq("toPrimitive");t&&!t[n]&&sq(t,n,function(o){return iq(r,this)},{arity:1})},uq=F0,fq=MF;uq("toPrimitive");fq();var cq=Lt,hq=wj,dq=TypeError,vq=function(e){if(cq(this),e==="string"||e==="default")e="string";else if(e!=="number")throw dq("Incorrect hint");return hq(this,e)},yq=Dt,gq=tn,pq=vq,mq=wt,K$=mq("toPrimitive"),q$=Date.prototype;yq(q$,K$)||gq(q$,K$,pq);var X$=xj,bq=_r,vv=function(e,t,r){return r.get&&X$(r.get,t,{getter:!0}),r.set&&X$(r.set,t,{setter:!0}),bq.f(e,t,r)},pm=$e,B0=vt,V0=Xt,wq=Ye,hs=Yt,ds=Sf,Sq=je,nr=Dt,Cq=xi,RC=Lt,mm=zr,W0=om,_q=Gt,EC=nv,Vc=_f,xF=ev,Oq=nl,DF=um,Rq=av,NF=Un,HF=_r,Eq=s0,LF=ov,tw=tn,Tq=vv,U0=wf,Pq=im,jF=Jd,Z$=rm,kq=wt,$q=j0,Aq=F0,Iq=MF,Mq=lm,FF=Uo,bm=ol.forEach,$r=Pq("hidden"),wm="Symbol",Wc="prototype",xq=FF.set,Q$=FF.getterFor(wm),Qr=Object[Wc],Da=B0.Symbol,pc=Da&&Da[Wc],Dq=B0.TypeError,rw=B0.QObject,BF=NF.f,ia=HF.f,VF=DF.f,Nq=LF.f,WF=wq([].push),jo=U0("symbols"),yv=U0("op-symbols"),Hq=U0("wks"),TC=!rw||!rw[Wc]||!rw[Wc].findChild,PC=hs&&Sq(function(){return Vc(ia({},"a",{get:function(){return ia(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=BF(Qr,t);n&&delete Qr[t],ia(e,t,r),n&&e!==Qr&&ia(Qr,t,n)}:ia,nw=function(e,t){var r=jo[e]=Vc(pc);return xq(r,{type:wm,tag:e,description:t}),hs||(r.description=t),r},Sm=function(t,r,n){t===Qr&&Sm(yv,r,n),RC(t);var o=W0(r);return RC(n),nr(jo,o)?(n.enumerable?(nr(t,$r)&&t[$r][o]&&(t[$r][o]=!1),n=Vc(n,{enumerable:EC(0,!1)})):(nr(t,$r)||ia(t,$r,EC(1,{})),t[$r][o]=!0),PC(t,o,n)):ia(t,o,n)},z0=function(t,r){RC(t);var n=mm(r),o=xF(n).concat(YF(n));return bm(o,function(i){(!hs||V0(kC,n,i))&&Sm(t,i,n[i])}),t},Lq=function(t,r){return r===void 0?Vc(t):z0(Vc(t),r)},kC=function(t){var r=W0(t),n=V0(Nq,this,r);return this===Qr&&nr(jo,r)&&!nr(yv,r)?!1:n||!nr(this,r)||!nr(jo,r)||nr(this,$r)&&this[$r][r]?n:!0},UF=function(t,r){var n=mm(t),o=W0(r);if(!(n===Qr&&nr(jo,o)&&!nr(yv,o))){var i=BF(n,o);return i&&nr(jo,o)&&!(nr(n,$r)&&n[$r][o])&&(i.enumerable=!0),i}},zF=function(t){var r=VF(mm(t)),n=[];return bm(r,function(o){!nr(jo,o)&&!nr(jF,o)&&WF(n,o)}),n},YF=function(e){var t=e===Qr,r=VF(t?yv:mm(e)),n=[];return bm(r,function(o){nr(jo,o)&&(!t||nr(Qr,o))&&WF(n,jo[o])}),n};ds||(Da=function(){if(Cq(pc,this))throw Dq("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:_q(arguments[0]),r=Z$(t),n=function(o){this===Qr&&V0(n,yv,o),nr(this,$r)&&nr(this[$r],r)&&(this[$r][r]=!1),PC(this,r,EC(1,o))};return hs&&TC&&PC(Qr,r,{configurable:!0,set:n}),nw(r,t)},pc=Da[Wc],tw(pc,"toString",function(){return Q$(this).tag}),tw(Da,"withoutSetter",function(e){return nw(Z$(e),e)}),LF.f=kC,HF.f=Sm,Eq.f=z0,NF.f=UF,Oq.f=DF.f=zF,Rq.f=YF,$q.f=function(e){return nw(kq(e),e)},hs&&(Tq(pc,"description",{configurable:!0,get:function(){return Q$(this).description}}),tw(Qr,"propertyIsEnumerable",kC,{unsafe:!0})));pm({global:!0,constructor:!0,wrap:!0,forced:!ds,sham:!ds},{Symbol:Da});bm(xF(Hq),function(e){Aq(e)});pm({target:wm,stat:!0,forced:!ds},{useSetter:function(){TC=!0},useSimple:function(){TC=!1}});pm({target:"Object",stat:!0,forced:!ds,sham:!hs},{create:Lq,defineProperty:Sm,defineProperties:z0,getOwnPropertyDescriptor:UF});pm({target:"Object",stat:!0,forced:!ds},{getOwnPropertyNames:zF});Iq();Mq(Da,wm);jF[$r]=!0;var jq=Sf,GF=jq&&!!Symbol.for&&!!Symbol.keyFor,Fq=$e,Bq=Wo,Vq=Dt,Wq=Gt,KF=wf,Uq=GF,ow=KF("string-to-symbol-registry"),zq=KF("symbol-to-string-registry");Fq({target:"Symbol",stat:!0,forced:!Uq},{for:function(e){var t=Wq(e);if(Vq(ow,t))return ow[t];var r=Bq("Symbol")(t);return ow[t]=r,zq[r]=t,r}});var Yq=$e,Gq=Dt,Kq=Zd,qq=Cf,Xq=wf,Zq=GF,J$=Xq("symbol-to-string-registry");Yq({target:"Symbol",stat:!0,forced:!Zq},{keyFor:function(t){if(!Kq(t))throw TypeError(qq(t)+" is not a symbol");if(Gq(J$,t))return J$[t]}});var Qq=Ye,gv=Qq([].slice),Jq=Ye,e1=Rf,eX=Ot,t1=Wn,tX=Gt,r1=Jq([].push),rX=function(e){if(eX(e))return e;if(e1(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?r1(r,o):(typeof o=="number"||t1(o)=="Number"||t1(o)=="String")&&r1(r,tX(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(e1(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},nX=$e,qF=Wo,XF=il,oX=Xt,pv=Ye,ZF=je,n1=Ot,o1=Zd,QF=gv,iX=rX,aX=Sf,lX=String,di=qF("JSON","stringify"),ty=pv(/./.exec),i1=pv("".charAt),sX=pv("".charCodeAt),uX=pv("".replace),fX=pv(1 .toString),cX=/[\uD800-\uDFFF]/g,a1=/^[\uD800-\uDBFF]$/,l1=/^[\uDC00-\uDFFF]$/,s1=!aX||ZF(function(){var e=qF("Symbol")();return di([e])!="[null]"||di({a:e})!="{}"||di(Object(e))!="{}"}),u1=ZF(function(){return di("\uDF06\uD834")!=='"\\udf06\\ud834"'||di("\uDEAD")!=='"\\udead"'}),hX=function(e,t){var r=QF(arguments),n=iX(t);if(!(!n1(n)&&(e===void 0||o1(e))))return r[1]=function(o,i){if(n1(n)&&(i=oX(n,this,lX(o),i)),!o1(i))return i},XF(di,null,r)},dX=function(e,t,r){var n=i1(r,t-1),o=i1(r,t+1);return ty(a1,e)&&!ty(l1,o)||ty(l1,e)&&!ty(a1,n)?"\\u"+fX(sX(e,0),16):e};di&&nX({target:"JSON",stat:!0,arity:3,forced:s1||u1},{stringify:function(t,r,n){var o=QF(arguments),i=XF(s1?hX:di,null,o);return u1&&typeof i=="string"?uX(i,cX,dX):i}});var vX=$e,yX=Sf,gX=je,JF=av,pX=Ir,mX=!yX||gX(function(){JF.f(1)});vX({target:"Object",stat:!0,forced:mX},{getOwnPropertySymbols:function(t){var r=JF.f;return r?r(pX(t)):[]}});var bX=$e,wX=Yt,SX=vt,ry=Ye,CX=Dt,_X=Ot,OX=xi,RX=Gt,EX=vv,TX=Nj,oo=SX.Symbol,Fi=oo&&oo.prototype;if(wX&&_X(oo)&&(!("description"in Fi)||oo().description!==void 0)){var f1={},ny=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:RX(arguments[0]),r=OX(Fi,this)?new oo(t):t===void 0?oo():oo(t);return t===""&&(f1[r]=!0),r};TX(ny,oo),ny.prototype=Fi,Fi.constructor=ny;var PX=String(oo("test"))=="Symbol(test)",kX=ry(Fi.valueOf),$X=ry(Fi.toString),AX=/^Symbol\((.*)\)[^)]+$/,IX=ry("".replace),MX=ry("".slice);EX(Fi,"description",{configurable:!0,get:function(){var t=kX(this);if(CX(f1,t))return"";var r=$X(t),n=PX?MX(r,7,-1):IX(r,AX,"$1");return n===""?void 0:n}}),bX({global:!0,constructor:!0,forced:!0},{Symbol:ny})}var xX=Ye,eB=xX(1 .valueOf),tB=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,DX=Ye,NX=Ar,HX=Gt,$C=tB,c1=DX("".replace),LX=RegExp("^["+$C+"]+"),jX=RegExp("(^|[^"+$C+"])["+$C+"]+$"),iw=function(e){return function(t){var r=HX(NX(t));return e&1&&(r=c1(r,LX,"")),e&2&&(r=c1(r,jX,"$1")),r}},rB={start:iw(1),end:iw(2),trim:iw(3)},FX=$e,nB=iG,BX=Yt,oB=vt,iB=IF,aB=Ye,VX=am,h1=Dt,WX=k0,UX=xi,zX=Zd,lB=Sj,YX=je,GX=nl.f,KX=Un.f,qX=_r.f,XX=eB,ZX=rB.trim,Cm="Number",Zl=oB[Cm];iB[Cm];var Y0=Zl.prototype,QX=oB.TypeError,JX=aB("".slice),oy=aB("".charCodeAt),eZ=function(e){var t=lB(e,"number");return typeof t=="bigint"?t:tZ(t)},tZ=function(e){var t=lB(e,"number"),r,n,o,i,a,l,s,u;if(zX(t))throw QX("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=ZX(t),r=oy(t,0),r===43||r===45){if(n=oy(t,2),n===88||n===120)return NaN}else if(r===48){switch(oy(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=JX(t,2),l=a.length,s=0;s<l;s++)if(u=oy(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},G0=VX(Cm,!Zl(" 0o1")||!Zl("0b1")||Zl("+0x1")),rZ=function(e){return UX(Y0,e)&&YX(function(){XX(e)})},_m=function(t){var r=arguments.length<1?0:Zl(eZ(t));return rZ(this)?WX(Object(r),this,_m):r};_m.prototype=Y0;G0&&!nB&&(Y0.constructor=_m);FX({global:!0,constructor:!0,wrap:!0,forced:G0},{Number:_m});var nZ=function(e,t){for(var r=BX?GX(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)h1(t,o=r[n])&&!h1(e,o)&&qX(e,o,KX(t,o))};(G0||nB)&&nZ(iB[Cm],Zl);var oZ=$e,iZ=d0;oZ({target:"Object",stat:!0},{setPrototypeOf:iZ});var aZ=$e,lZ=je,sZ=Ir,sB=sv,uZ=Hj,fZ=lZ(function(){sB(1)});aZ({target:"Object",stat:!0,forced:fZ,sham:!uZ},{getPrototypeOf:function(t){return sB(sZ(t))}});var uB=Ye,cZ=Ja,hZ=zt,dZ=Dt,d1=gv,vZ=Kd,fB=Function,yZ=uB([].concat),gZ=uB([].join),aw={},pZ=function(e,t,r){if(!dZ(aw,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";aw[t]=fB("C,a","return new C("+gZ(n,",")+")")}return aw[t](e,r)},mZ=vZ?fB.bind:function(t){var r=cZ(this),n=r.prototype,o=d1(arguments,1),i=function(){var l=yZ(o,d1(arguments));return this instanceof i?pZ(r,l.length,l):r.apply(t,l)};return hZ(n)&&(i.prototype=n),i},bZ=cm,wZ=Cf,SZ=TypeError,cB=function(e){if(bZ(e))return e;throw SZ(wZ(e)+" is not a constructor")},CZ=$e,_Z=Wo,lw=il,OZ=mZ,v1=cB,RZ=Lt,y1=zt,EZ=_f,hB=je,K0=_Z("Reflect","construct"),TZ=Object.prototype,PZ=[].push,dB=hB(function(){function e(){}return!(K0(function(){},[],e)instanceof e)}),vB=!hB(function(){K0(function(){})}),g1=dB||vB;CZ({target:"Reflect",stat:!0,forced:g1,sham:g1},{construct:function(t,r){v1(t),RZ(r);var n=arguments.length<3?t:v1(arguments[2]);if(vB&&!dB)return K0(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return lw(PZ,o,r),new(lw(OZ,t,o))}var i=n.prototype,a=EZ(y1(i)?i:TZ),l=lw(t,a,r);return y1(l)?l:a}});var p1=Dt,kZ=function(e){return e!==void 0&&(p1(e,"value")||p1(e,"writable"))},$Z=$e,AZ=Xt,IZ=zt,MZ=Lt,xZ=kZ,DZ=Un,NZ=sv;function yB(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(MZ(e)===r)return e[t];if(n=DZ.f(e,t),n)return xZ(n)?n.value:n.get===void 0?void 0:AZ(n.get,r);if(IZ(o=NZ(e)))return yB(o,t,r)}$Z({target:"Reflect",stat:!0},{get:yB});var HZ=$e,LZ=je,jZ=zr,gB=Un.f,pB=Yt,FZ=!pB||LZ(function(){gB(1)});HZ({target:"Object",stat:!0,forced:FZ,sham:!pB},{getOwnPropertyDescriptor:function(t,r){return gB(jZ(t),r)}});var BZ=F0;BZ("iterator");var VZ=$e,m1=Rf,WZ=cm,UZ=zt,b1=Qd,zZ=en,YZ=zr,GZ=Of,KZ=wt,qZ=dv,XZ=gv,ZZ=qZ("slice"),QZ=KZ("species"),sw=Array,JZ=Math.max;VZ({target:"Array",proto:!0,forced:!ZZ},{slice:function(t,r){var n=YZ(this),o=zZ(n),i=b1(t,o),a=b1(r===void 0?o:r,o),l,s,u;if(m1(n)&&(l=n.constructor,WZ(l)&&(l===sw||m1(l.prototype))?l=void 0:UZ(l)&&(l=l[QZ],l===null&&(l=void 0)),l===sw||l===void 0))return XZ(n,i,a);for(s=new(l===void 0?sw:l)(JZ(a-i,0)),u=0;i<a;i++,u++)i in n&&GZ(s,u,n[i]);return s.length=u,s}});var eQ=Xt,tQ=Dt,rQ=xi,nQ=EF,w1=RegExp.prototype,mB=function(e){var t=e.flags;return t===void 0&&!("flags"in w1)&&!tQ(e,"flags")&&rQ(w1,e)?eQ(nQ,e):t},oQ=iv.PROPER,iQ=tn,aQ=Lt,S1=Gt,lQ=je,sQ=mB,q0="toString",uQ=RegExp.prototype,bB=uQ[q0],fQ=lQ(function(){return bB.call({source:"a",flags:"b"})!="/a/b"}),cQ=oQ&&bB.name!=q0;(fQ||cQ)&&iQ(RegExp.prototype,q0,function(){var t=aQ(this),r=S1(t.source),n=S1(sQ(t));return"/"+r+"/"+n},{unsafe:!0});var hQ=Yt,dQ=iv.EXISTS,wB=Ye,vQ=vv,SB=Function.prototype,yQ=wB(SB.toString),CB=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,gQ=wB(CB.exec),pQ="name";hQ&&!dQ&&vQ(SB,pQ,{configurable:!0,get:function(){try{return gQ(CB,yQ(this))[1]}catch{return""}}});var mQ=Lt,bQ=Jj,wQ=function(e,t,r,n){try{return n?t(mQ(r)[0],r[1]):t(r)}catch(o){bQ(e,"throw",o)}},SQ=cv,CQ=Xt,_Q=Ir,OQ=wQ,RQ=Zj,EQ=cm,TQ=en,C1=Of,PQ=Qj,kQ=E0,_1=Array,$Q=function(t){var r=_Q(t),n=EQ(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=SQ(i,o>2?arguments[2]:void 0));var l=kQ(r),s=0,u,f,c,h,d,v;if(l&&!(this===_1&&RQ(l)))for(h=PQ(r,l),d=h.next,f=n?new this:[];!(c=CQ(d,h)).done;s++)v=a?OQ(h,i,[c.value,s],!0):c.value,C1(f,s,v);else for(u=TQ(r),f=n?new this(u):_1(u);u>s;s++)v=a?i(r[s],s):r[s],C1(f,s,v);return f.length=s,f},AQ=$e,IQ=$Q,MQ=rF,xQ=!MQ(function(e){Array.from(e)});AQ({target:"Array",stat:!0,forced:xQ},{from:IQ});var DQ=$e,NQ=w0,HQ=je,LQ=zt,jQ=uv.onFreeze,AC=Object.freeze,FQ=HQ(function(){AC(1)});DQ({target:"Object",stat:!0,forced:FQ,sham:!NQ},{freeze:function(t){return AC&&LQ(t)?AC(jQ(t)):t}});var BQ=iv.PROPER,VQ=je,O1=tB,R1="âÂá ",WQ=function(e){return VQ(function(){return!!O1[e]()||R1[e]()!==R1||BQ&&O1[e].name!==e})},UQ=$e,zQ=rB.trim,YQ=WQ;UQ({target:"String",proto:!0,forced:YQ("trim")},{trim:function(){return zQ(this)}});var GQ=$e,KQ=u0.includes,qQ=je,XQ=tv,ZQ=qQ(function(){return!Array(1).includes()});GQ({target:"Array",proto:!0,forced:ZQ},{includes:function(t){return KQ(this,t,arguments.length>1?arguments[1]:void 0)}});XQ("includes");var QQ=$e,JQ=b0.codeAt;QQ({target:"String",proto:!0},{codePointAt:function(t){return JQ(this,t)}});var eJ=Di,tJ=Gt,rJ=Ar,nJ=RangeError,X0=function(t){var r=tJ(rJ(this)),n="",o=eJ(t);if(o<0||o==1/0)throw nJ("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},_B=Ye,oJ=tl,E1=Gt,iJ=X0,aJ=Ar,lJ=_B(iJ),sJ=_B("".slice),uJ=Math.ceil,T1=function(e){return function(t,r,n){var o=E1(aJ(t)),i=oJ(r),a=o.length,l=n===void 0?" ":E1(n),s,u;return i<=a||l==""?o:(s=i-a,u=lJ(l,uJ(s/l.length)),u.length>s&&(u=sJ(u,0,s)),e?o+u:u+o)}},fJ={start:T1(!1),end:T1(!0)},cJ=Qa,hJ=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(cJ),dJ=$e,vJ=fJ.start,yJ=hJ;dJ({target:"String",proto:!0,forced:yJ},{padStart:function(t){return vJ(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var OB;function ee(){return OB.apply(null,arguments)}function gJ(e){OB=e}function pn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Na(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Z0(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(it(e,t))return!1;return!0}function Tr(e){return e===void 0}function Fo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function mv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function RB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function ci(e,t){for(var r in t)it(t,r)&&(e[r]=t[r]);return it(t,"toString")&&(e.toString=t.toString),it(t,"valueOf")&&(e.valueOf=t.valueOf),e}function zn(e,t,r,n){return qB(e,t,r,n,!0).utc()}function pJ(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ke(e){return e._pf==null&&(e._pf=pJ()),e._pf}var IC;Array.prototype.some?IC=Array.prototype.some:IC=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function Q0(e){if(e._isValid==null){var t=Ke(e),r=IC.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Om(e){var t=zn(NaN);return e!=null?ci(Ke(t),e):Ke(t).userInvalidated=!0,t}var P1=ee.momentProperties=[],uw=!1;function J0(e,t){var r,n,o,i=P1.length;if(Tr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Tr(t._i)||(e._i=t._i),Tr(t._f)||(e._f=t._f),Tr(t._l)||(e._l=t._l),Tr(t._strict)||(e._strict=t._strict),Tr(t._tzm)||(e._tzm=t._tzm),Tr(t._isUTC)||(e._isUTC=t._isUTC),Tr(t._offset)||(e._offset=t._offset),Tr(t._pf)||(e._pf=Ke(t)),Tr(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=P1[r],o=t[n],Tr(o)||(e[n]=o);return e}function bv(e){J0(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),uw===!1&&(uw=!0,ee.updateOffset(this),uw=!1)}function mn(e){return e instanceof bv||e!=null&&e._isAMomentObject!=null}function EB(e){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function rn(e,t){var r=!0;return ci(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])it(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}EB(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var k1={};function TB(e,t){ee.deprecationHandler!=null&&ee.deprecationHandler(e,t),k1[e]||(EB(t),k1[e]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Yn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function mJ(e){var t,r;for(r in e)it(e,r)&&(t=e[r],Yn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function MC(e,t){var r=ci({},e),n;for(n in t)it(t,n)&&(Na(e[n])&&Na(t[n])?(r[n]={},ci(r[n],e[n]),ci(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)it(e,n)&&!it(t,n)&&Na(e[n])&&(r[n]=ci({},r[n]));return r}function eE(e){e!=null&&this.set(e)}var xC;Object.keys?xC=Object.keys:xC=function(e){var t,r=[];for(t in e)it(e,t)&&r.push(t);return r};var bJ={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function wJ(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Yn(n)?n.call(t,r):n}function Vn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var tE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,iy=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,fw={},Ql={};function Pe(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(Ql[e]=o),t&&(Ql[t[0]]=function(){return Vn(o.apply(this,arguments),t[1],t[2])}),r&&(Ql[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function SJ(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function CJ(e){var t=e.match(tE),r,n;for(r=0,n=t.length;r<n;r++)Ql[t[r]]?t[r]=Ql[t[r]]:t[r]=SJ(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Yn(t[a])?t[a].call(o,e):t[a];return i}}function og(e,t){return e.isValid()?(t=PB(t,e.localeData()),fw[t]=fw[t]||CJ(t),fw[t](e)):e.localeData().invalidDate()}function PB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(iy.lastIndex=0;r>=0&&iy.test(e);)e=e.replace(iy,n),iy.lastIndex=0,r-=1;return e}var _J={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function OJ(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(tE).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var RJ="Invalid date";function EJ(){return this._invalidDate}var TJ="%d",PJ=/\d{1,2}/;function kJ(e){return this._ordinal.replace("%d",e)}var $J={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function AJ(e,t,r,n){var o=this._relativeTime[r];return Yn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function IJ(e,t){var r=this._relativeTime[e>0?"future":"past"];return Yn(r)?r(t):r.replace(/%s/i,t)}var Oc={};function cr(e,t){var r=e.toLowerCase();Oc[r]=Oc[r+"s"]=Oc[t]=e}function nn(e){return typeof e=="string"?Oc[e]||Oc[e.toLowerCase()]:void 0}function rE(e){var t={},r,n;for(n in e)it(e,n)&&(r=nn(n),r&&(t[r]=e[n]));return t}var kB={};function hr(e,t){kB[e]=t}function MJ(e){var t=[],r;for(r in e)it(e,r)&&t.push({unit:r,priority:kB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function Rm(e){return e%4===0&&e%100!==0||e%400===0}function Zr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Qe(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Zr(t)),r}function Tf(e,t){return function(r){return r!=null?($B(this,e,r),ee.updateOffset(this,t),this):Wg(this,e)}}function Wg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function $B(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&Rm(e.year())&&e.month()===1&&e.date()===29?(r=Qe(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Am(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function xJ(e){return e=nn(e),Yn(this[e])?this[e]():this}function DJ(e,t){if(typeof e=="object"){e=rE(e);var r=MJ(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=nn(e),Yn(this[e]))return this[e](t);return this}var AB=/\d/,Yr=/\d\d/,IB=/\d{3}/,nE=/\d{4}/,Em=/[+-]?\d{6}/,Rt=/\d\d?/,MB=/\d\d\d\d?/,xB=/\d\d\d\d\d\d?/,Tm=/\d{1,3}/,oE=/\d{1,4}/,Pm=/[+-]?\d{1,6}/,Pf=/\d+/,km=/[+-]?\d+/,NJ=/Z|[+-]\d\d:?\d\d/gi,$m=/Z|[+-]\d\d(?::?\d\d)?/gi,HJ=/[+-]?\d+(\.\d{1,3})?/,wv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ug;Ug={};function be(e,t,r){Ug[e]=Yn(t)?t:function(n,o){return n&&r?r:t}}function LJ(e,t){return it(Ug,e)?Ug[e](t._strict,t._locale):new RegExp(jJ(e))}function jJ(e){return Br(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Br(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var DC={};function yt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Fo(t)&&(n=function(i,a){a[t]=Qe(i)}),o=e.length,r=0;r<o;r++)DC[e[r]]=n}function Sv(e,t){yt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function FJ(e,t,r){t!=null&&it(DC,e)&&DC[e](t,r._a,r,e)}var sr=0,uo=1,jn=2,Qt=3,yn=4,fo=5,sa=6,BJ=7,VJ=8;function WJ(e,t){return(e%t+t)%t}var Vt;Array.prototype.indexOf?Vt=Array.prototype.indexOf:Vt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Am(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=WJ(t,12);return e+=(t-r)/12,r===1?Rm(e)?29:28:31-r%7%2}Pe("M",["MM",2],"Mo",function(){return this.month()+1});Pe("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Pe("MMMM",0,0,function(e){return this.localeData().months(this,e)});cr("month","M");hr("month",8);be("M",Rt);be("MM",Rt,Yr);be("MMM",function(e,t){return t.monthsShortRegex(e)});be("MMMM",function(e,t){return t.monthsRegex(e)});yt(["M","MM"],function(e,t){t[uo]=Qe(e)-1});yt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[uo]=o:Ke(r).invalidMonth=e});var UJ="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),DB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),NB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,zJ=wv,YJ=wv;function GJ(e,t){return e?pn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||NB).test(t)?"format":"standalone"][e.month()]:pn(this._months)?this._months:this._months.standalone}function KJ(e,t){return e?pn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[NB.test(t)?"format":"standalone"][e.month()]:pn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function qJ(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=zn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Vt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Vt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Vt.call(this._shortMonthsParse,a),o!==-1?o:(o=Vt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Vt.call(this._longMonthsParse,a),o!==-1?o:(o=Vt.call(this._shortMonthsParse,a),o!==-1?o:null))}function XJ(e,t,r){var n,o,i;if(this._monthsParseExact)return qJ.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=zn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function HB(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Qe(t);else if(t=e.localeData().monthsParse(t),!Fo(t))return e}return r=Math.min(e.date(),Am(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function LB(e){return e!=null?(HB(this,e),ee.updateOffset(this,!0),this):Wg(this,"Month")}function ZJ(){return Am(this.year(),this.month())}function QJ(e){return this._monthsParseExact?(it(this,"_monthsRegex")||jB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=zJ),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function JJ(e){return this._monthsParseExact?(it(this,"_monthsRegex")||jB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=YJ),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function jB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=zn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Br(t[o]),r[o]=Br(r[o]);for(o=0;o<24;o++)n[o]=Br(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Pe("Y",0,0,function(){var e=this.year();return e<=9999?Vn(e,4):"+"+e});Pe(0,["YY",2],0,function(){return this.year()%100});Pe(0,["YYYY",4],0,"year");Pe(0,["YYYYY",5],0,"year");Pe(0,["YYYYYY",6,!0],0,"year");cr("year","y");hr("year",1);be("Y",km);be("YY",Rt,Yr);be("YYYY",oE,nE);be("YYYYY",Pm,Em);be("YYYYYY",Pm,Em);yt(["YYYYY","YYYYYY"],sr);yt("YYYY",function(e,t){t[sr]=e.length===2?ee.parseTwoDigitYear(e):Qe(e)});yt("YY",function(e,t){t[sr]=ee.parseTwoDigitYear(e)});yt("Y",function(e,t){t[sr]=parseInt(e,10)});function Rc(e){return Rm(e)?366:365}ee.parseTwoDigitYear=function(e){return Qe(e)+(Qe(e)>68?1900:2e3)};var FB=Tf("FullYear",!0);function eee(){return Rm(this.year())}function tee(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function Uc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function zg(e,t,r){var n=7+t-r,o=(7+Uc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function BB(e,t,r,n,o){var i=(7+r-n)%7,a=zg(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=Rc(s)+l):l>Rc(e)?(s=e+1,u=l-Rc(e)):(s=e,u=l),{year:s,dayOfYear:u}}function zc(e,t,r){var n=zg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Ho(a,t,r)):o>Ho(e.year(),t,r)?(i=o-Ho(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Ho(e,t,r){var n=zg(e,t,r),o=zg(e+1,t,r);return(Rc(e)-n+o)/7}Pe("w",["ww",2],"wo","week");Pe("W",["WW",2],"Wo","isoWeek");cr("week","w");cr("isoWeek","W");hr("week",5);hr("isoWeek",5);be("w",Rt);be("ww",Rt,Yr);be("W",Rt);be("WW",Rt,Yr);Sv(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Qe(e)});function ree(e){return zc(e,this._week.dow,this._week.doy).week}var nee={dow:0,doy:6};function oee(){return this._week.dow}function iee(){return this._week.doy}function aee(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function lee(e){var t=zc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Pe("d",0,"do","day");Pe("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Pe("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Pe("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Pe("e",0,0,"weekday");Pe("E",0,0,"isoWeekday");cr("day","d");cr("weekday","e");cr("isoWeekday","E");hr("day",11);hr("weekday",11);hr("isoWeekday",11);be("d",Rt);be("e",Rt);be("E",Rt);be("dd",function(e,t){return t.weekdaysMinRegex(e)});be("ddd",function(e,t){return t.weekdaysShortRegex(e)});be("dddd",function(e,t){return t.weekdaysRegex(e)});Sv(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Ke(r).invalidWeekday=e});Sv(["d","e","E"],function(e,t,r,n){t[n]=Qe(e)});function see(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function uee(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function iE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var fee="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),VB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),cee="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),hee=wv,dee=wv,vee=wv;function yee(e,t){var r=pn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?iE(r,this._week.dow):e?r[e.day()]:r}function gee(e){return e===!0?iE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function pee(e){return e===!0?iE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function mee(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=zn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Vt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Vt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Vt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Vt.call(this._weekdaysParse,a),o!==-1||(o=Vt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Vt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Vt.call(this._shortWeekdaysParse,a),o!==-1||(o=Vt.call(this._weekdaysParse,a),o!==-1)?o:(o=Vt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Vt.call(this._minWeekdaysParse,a),o!==-1||(o=Vt.call(this._weekdaysParse,a),o!==-1)?o:(o=Vt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function bee(e,t,r){var n,o,i;if(this._weekdaysParseExact)return mee.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=zn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function wee(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=see(e,this.localeData()),this.add(e-t,"d")):t}function See(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Cee(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=uee(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function _ee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||aE.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=hee),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Oee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||aE.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=dee),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ree(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||aE.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=vee),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function aE(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=zn([2e3,1]).day(i),l=Br(this.weekdaysMin(a,"")),s=Br(this.weekdaysShort(a,"")),u=Br(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function lE(){return this.hours()%12||12}function Eee(){return this.hours()||24}Pe("H",["HH",2],0,"hour");Pe("h",["hh",2],0,lE);Pe("k",["kk",2],0,Eee);Pe("hmm",0,0,function(){return""+lE.apply(this)+Vn(this.minutes(),2)});Pe("hmmss",0,0,function(){return""+lE.apply(this)+Vn(this.minutes(),2)+Vn(this.seconds(),2)});Pe("Hmm",0,0,function(){return""+this.hours()+Vn(this.minutes(),2)});Pe("Hmmss",0,0,function(){return""+this.hours()+Vn(this.minutes(),2)+Vn(this.seconds(),2)});function WB(e,t){Pe(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}WB("a",!0);WB("A",!1);cr("hour","h");hr("hour",13);function UB(e,t){return t._meridiemParse}be("a",UB);be("A",UB);be("H",Rt);be("h",Rt);be("k",Rt);be("HH",Rt,Yr);be("hh",Rt,Yr);be("kk",Rt,Yr);be("hmm",MB);be("hmmss",xB);be("Hmm",MB);be("Hmmss",xB);yt(["H","HH"],Qt);yt(["k","kk"],function(e,t,r){var n=Qe(e);t[Qt]=n===24?0:n});yt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});yt(["h","hh"],function(e,t,r){t[Qt]=Qe(e),Ke(r).bigHour=!0});yt("hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[yn]=Qe(e.substr(n)),Ke(r).bigHour=!0});yt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[yn]=Qe(e.substr(n,2)),t[fo]=Qe(e.substr(o)),Ke(r).bigHour=!0});yt("Hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[yn]=Qe(e.substr(n))});yt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[yn]=Qe(e.substr(n,2)),t[fo]=Qe(e.substr(o))});function Tee(e){return(e+"").toLowerCase().charAt(0)==="p"}var Pee=/[ap]\.?m?\.?/i,kee=Tf("Hours",!0);function $ee(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var zB={calendar:bJ,longDateFormat:_J,invalidDate:RJ,ordinal:TJ,dayOfMonthOrdinalParse:PJ,relativeTime:$J,months:UJ,monthsShort:DB,week:nee,weekdays:fee,weekdaysMin:cee,weekdaysShort:VB,meridiemParse:Pee},Et={},Wf={},Yc;function Aee(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function $1(e){return e&&e.toLowerCase().replace("_","-")}function Iee(e){for(var t=0,r,n,o,i;t<e.length;){for(i=$1(e[t]).split("-"),r=i.length,n=$1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=Im(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&Aee(i,n)>=r-1)break;r--}t++}return Yc}function Mee(e){return e.match("^[^/\\\\]*$")!=null}function Im(e){var t=null,r;if(Et[e]===void 0&&typeof module<"u"&&module&&module.exports&&Mee(e))try{t=Yc._abbr,r=require,r("./locale/"+e),vi(t)}catch{Et[e]=null}return Et[e]}function vi(e,t){var r;return e&&(Tr(t)?r=zo(e):r=sE(e,t),r?Yc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Yc._abbr}function sE(e,t){if(t!==null){var r,n=zB;if(t.abbr=e,Et[e]!=null)TB("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Et[e]._config;else if(t.parentLocale!=null)if(Et[t.parentLocale]!=null)n=Et[t.parentLocale]._config;else if(r=Im(t.parentLocale),r!=null)n=r._config;else return Wf[t.parentLocale]||(Wf[t.parentLocale]=[]),Wf[t.parentLocale].push({name:e,config:t}),null;return Et[e]=new eE(MC(n,t)),Wf[e]&&Wf[e].forEach(function(o){sE(o.name,o.config)}),vi(e),Et[e]}else return delete Et[e],null}function xee(e,t){if(t!=null){var r,n,o=zB;Et[e]!=null&&Et[e].parentLocale!=null?Et[e].set(MC(Et[e]._config,t)):(n=Im(e),n!=null&&(o=n._config),t=MC(o,t),n==null&&(t.abbr=e),r=new eE(t),r.parentLocale=Et[e],Et[e]=r),vi(e)}else Et[e]!=null&&(Et[e].parentLocale!=null?(Et[e]=Et[e].parentLocale,e===vi()&&vi(e)):Et[e]!=null&&delete Et[e]);return Et[e]}function zo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Yc;if(!pn(e)){if(t=Im(e),t)return t;e=[e]}return Iee(e)}function Dee(){return xC(Et)}function uE(e){var t,r=e._a;return r&&Ke(e).overflow===-2&&(t=r[uo]<0||r[uo]>11?uo:r[jn]<1||r[jn]>Am(r[sr],r[uo])?jn:r[Qt]<0||r[Qt]>24||r[Qt]===24&&(r[yn]!==0||r[fo]!==0||r[sa]!==0)?Qt:r[yn]<0||r[yn]>59?yn:r[fo]<0||r[fo]>59?fo:r[sa]<0||r[sa]>999?sa:-1,Ke(e)._overflowDayOfYear&&(t<sr||t>jn)&&(t=jn),Ke(e)._overflowWeeks&&t===-1&&(t=BJ),Ke(e)._overflowWeekday&&t===-1&&(t=VJ),Ke(e).overflow=t),e}var Nee=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Hee=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Lee=/Z|[+-]\d\d(?::?\d\d)?/,ay=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],cw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],jee=/^\/?Date\((-?\d+)/i,Fee=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Bee={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function YB(e){var t,r,n=e._i,o=Nee.exec(n)||Hee.exec(n),i,a,l,s,u=ay.length,f=cw.length;if(o){for(Ke(e).iso=!0,t=0,r=u;t<r;t++)if(ay[t][1].exec(o[1])){a=ay[t][0],i=ay[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(cw[t][1].exec(o[3])){l=(o[2]||" ")+cw[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(Lee.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),cE(e)}else e._isValid=!1}function Vee(e,t,r,n,o,i){var a=[Wee(e),DB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Wee(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Uee(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function zee(e,t,r){if(e){var n=VB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Ke(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Yee(e,t,r){if(e)return Bee[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function GB(e){var t=Fee.exec(Uee(e._i)),r;if(t){if(r=Vee(t[4],t[3],t[2],t[5],t[6],t[7]),!zee(t[1],r,e))return;e._a=r,e._tzm=Yee(t[8],t[9],t[10]),e._d=Uc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Ke(e).rfc2822=!0}else e._isValid=!1}function Gee(e){var t=jee.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(YB(e),e._isValid===!1)delete e._isValid;else return;if(GB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ee.createFromInputFallback(e)}ee.createFromInputFallback=rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Vl(e,t,r){return e??t??r}function Kee(e){var t=new Date(ee.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function fE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=Kee(e),e._w&&e._a[jn]==null&&e._a[uo]==null&&qee(e),e._dayOfYear!=null&&(a=Vl(e._a[sr],o[sr]),(e._dayOfYear>Rc(a)||e._dayOfYear===0)&&(Ke(e)._overflowDayOfYear=!0),r=Uc(a,0,e._dayOfYear),e._a[uo]=r.getUTCMonth(),e._a[jn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Qt]===24&&e._a[yn]===0&&e._a[fo]===0&&e._a[sa]===0&&(e._nextDay=!0,e._a[Qt]=0),e._d=(e._useUTC?Uc:tee).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Qt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Ke(e).weekdayMismatch=!0)}}function qee(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=Vl(t.GG,e._a[sr],zc(_t(),1,4).year),n=Vl(t.W,1),o=Vl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=zc(_t(),i,a),r=Vl(t.gg,e._a[sr],u.year),n=Vl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Ho(r,i,a)?Ke(e)._overflowWeeks=!0:s!=null?Ke(e)._overflowWeekday=!0:(l=BB(r,n,o,i,a),e._a[sr]=l.year,e._dayOfYear=l.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function cE(e){if(e._f===ee.ISO_8601){YB(e);return}if(e._f===ee.RFC_2822){GB(e);return}e._a=[],Ke(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=PB(e._f,e._locale).match(tE)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(LJ(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Ke(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),Ql[i]?(n?Ke(e).empty=!1:Ke(e).unusedTokens.push(i),FJ(i,n,e)):e._strict&&!n&&Ke(e).unusedTokens.push(i);Ke(e).charsLeftOver=l-s,t.length>0&&Ke(e).unusedInput.push(t),e._a[Qt]<=12&&Ke(e).bigHour===!0&&e._a[Qt]>0&&(Ke(e).bigHour=void 0),Ke(e).parsedDateParts=e._a.slice(0),Ke(e).meridiem=e._meridiem,e._a[Qt]=Xee(e._locale,e._a[Qt],e._meridiem),u=Ke(e).era,u!==null&&(e._a[sr]=e._locale.erasConvertYear(u,e._a[sr])),fE(e),uE(e)}function Xee(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Zee(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){Ke(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=J0({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],cE(t),Q0(t)&&(a=!0),i+=Ke(t).charsLeftOver,i+=Ke(t).unusedTokens.length*10,Ke(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));ci(e,r||t)}function Qee(e){if(!e._d){var t=rE(e._i),r=t.day===void 0?t.date:t.day;e._a=RB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),fE(e)}}function Jee(e){var t=new bv(uE(KB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function KB(e){var t=e._i,r=e._f;return e._locale=e._locale||zo(e._l),t===null||r===void 0&&t===""?Om({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),mn(t)?new bv(uE(t)):(mv(t)?e._d=t:pn(r)?Zee(e):r?cE(e):ete(e),Q0(e)||(e._d=null),e))}function ete(e){var t=e._i;Tr(t)?e._d=new Date(ee.now()):mv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Gee(e):pn(t)?(e._a=RB(t.slice(0),function(r){return parseInt(r,10)}),fE(e)):Na(t)?Qee(e):Fo(t)?e._d=new Date(t):ee.createFromInputFallback(e)}function qB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Na(e)&&Z0(e)||pn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,Jee(i)}function _t(e,t,r,n){return qB(e,t,r,n,!1)}var tte=rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_t.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Om()}),rte=rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_t.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Om()});function XB(e,t){var r,n;if(t.length===1&&pn(t[0])&&(t=t[0]),!t.length)return _t();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function nte(){var e=[].slice.call(arguments,0);return XB("isBefore",e)}function ote(){var e=[].slice.call(arguments,0);return XB("isAfter",e)}var ite=function(){return Date.now?Date.now():+new Date},Uf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function ate(e){var t,r=!1,n,o=Uf.length;for(t in e)if(it(e,t)&&!(Vt.call(Uf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Uf[n]]){if(r)return!1;parseFloat(e[Uf[n]])!==Qe(e[Uf[n]])&&(r=!0)}return!0}function lte(){return this._isValid}function ste(){return _n(NaN)}function Mm(e){var t=rE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=ate(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=zo(),this._bubble()}function ig(e){return e instanceof Mm}function NC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function ute(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Qe(e[a])!==Qe(t[a]))&&i++;return i+o}function ZB(e,t){Pe(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Vn(~~(r/60),2)+t+Vn(~~r%60,2)})}ZB("Z",":");ZB("ZZ","");be("Z",$m);be("ZZ",$m);yt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=hE($m,e)});var fte=/([\+\-]|\d\d)/gi;function hE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(fte)||["-",0,0],i=+(o[1]*60)+Qe(o[2]),i===0?0:o[0]==="+"?i:-i)}function dE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(mn(e)||mv(e)?e.valueOf():_t(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ee.updateOffset(r,!1),r):_t(e).local()}function HC(e){return-Math.round(e._d.getTimezoneOffset())}ee.updateOffset=function(){};function cte(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=hE($m,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=HC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?eV(this,_n(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:HC(this)}function hte(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function dte(e){return this.utcOffset(0,e)}function vte(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(HC(this),"m")),this}function yte(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=hE(NJ,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function gte(e){return this.isValid()?(e=e?_t(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function pte(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function mte(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var e={},t;return J0(e,this),e=KB(e),e._a?(t=e._isUTC?zn(e._a):_t(e._a),this._isDSTShifted=this.isValid()&&ute(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function bte(){return this.isValid()?!this._isUTC:!1}function wte(){return this.isValid()?this._isUTC:!1}function QB(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Ste=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Cte=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function _n(e,t){var r=e,n=null,o,i,a;return ig(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Fo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Ste.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Qe(n[jn])*o,h:Qe(n[Qt])*o,m:Qe(n[yn])*o,s:Qe(n[fo])*o,ms:Qe(NC(n[sa]*1e3))*o}):(n=Cte.exec(e))?(o=n[1]==="-"?-1:1,r={y:Bi(n[2],o),M:Bi(n[3],o),w:Bi(n[4],o),d:Bi(n[5],o),h:Bi(n[6],o),m:Bi(n[7],o),s:Bi(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=_te(_t(r.from),_t(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Mm(r),ig(e)&&it(e,"_locale")&&(i._locale=e._locale),ig(e)&&it(e,"_isValid")&&(i._isValid=e._isValid),i}_n.fn=Mm.prototype;_n.invalid=ste;function Bi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function A1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function _te(e,t){var r;return e.isValid()&&t.isValid()?(t=dE(t,e),e.isBefore(t)?r=A1(e,t):(r=A1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function JB(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(TB(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=_n(r,n),eV(this,o,e),this}}function eV(e,t,r,n){var o=t._milliseconds,i=NC(t._days),a=NC(t._months);e.isValid()&&(n=n??!0,a&&HB(e,Wg(e,"Month")+a*r),i&&$B(e,"Date",Wg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&ee.updateOffset(e,i||a))}var Ote=JB(1,"add"),Rte=JB(-1,"subtract");function tV(e){return typeof e=="string"||e instanceof String}function Ete(e){return mn(e)||mv(e)||tV(e)||Fo(e)||Pte(e)||Tte(e)||e===null||e===void 0}function Tte(e){var t=Na(e)&&!Z0(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||it(e,i);return t&&r}function Pte(e){var t=pn(e),r=!1;return t&&(r=e.filter(function(n){return!Fo(n)&&tV(e)}).length===0),t&&r}function kte(e){var t=Na(e)&&!Z0(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||it(e,i);return t&&r}function $te(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Ate(e,t){arguments.length===1&&(arguments[0]?Ete(arguments[0])?(e=arguments[0],t=void 0):kte(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||_t(),n=dE(r,this).startOf("day"),o=ee.calendarFormat(this,n)||"sameElse",i=t&&(Yn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,_t(r)))}function Ite(){return new bv(this)}function Mte(e,t){var r=mn(e)?e:_t(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function xte(e,t){var r=mn(e)?e:_t(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function Dte(e,t,r,n){var o=mn(e)?e:_t(e),i=mn(t)?t:_t(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function Nte(e,t){var r=mn(e)?e:_t(e),n;return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function Hte(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Lte(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function jte(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=dE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=nn(t),t){case"year":i=ag(this,n)/12;break;case"month":i=ag(this,n);break;case"quarter":i=ag(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Zr(i)}function ag(e,t){if(e.date()<t.date())return-ag(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Fte(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Bte(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?og(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Yn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",og(r,"Z")):og(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Vte(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Wte(e){e||(e=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var t=og(this,e);return this.localeData().postformat(t)}function Ute(e,t){return this.isValid()&&(mn(e)&&e.isValid()||_t(e).isValid())?_n({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function zte(e){return this.from(_t(),e)}function Yte(e,t){return this.isValid()&&(mn(e)&&e.isValid()||_t(e).isValid())?_n({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Gte(e){return this.to(_t(),e)}function rV(e){var t;return e===void 0?this._locale._abbr:(t=zo(e),t!=null&&(this._locale=t),this)}var nV=rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function oV(){return this._locale}var Yg=1e3,Jl=60*Yg,Gg=60*Jl,iV=(365*400+97)*24*Gg;function es(e,t){return(e%t+t)%t}function aV(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-iV:new Date(e,t,r).valueOf()}function lV(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-iV:Date.UTC(e,t,r)}function Kte(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?lV:aV,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=es(t+(this._isUTC?0:this.utcOffset()*Jl),Gg);break;case"minute":t=this._d.valueOf(),t-=es(t,Jl);break;case"second":t=this._d.valueOf(),t-=es(t,Yg);break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function qte(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?lV:aV,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Gg-es(t+(this._isUTC?0:this.utcOffset()*Jl),Gg)-1;break;case"minute":t=this._d.valueOf(),t+=Jl-es(t,Jl)-1;break;case"second":t=this._d.valueOf(),t+=Yg-es(t,Yg)-1;break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function Xte(){return this._d.valueOf()-(this._offset||0)*6e4}function Zte(){return Math.floor(this.valueOf()/1e3)}function Qte(){return new Date(this.valueOf())}function Jte(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function ere(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function tre(){return this.isValid()?this.toISOString():null}function rre(){return Q0(this)}function nre(){return ci({},Ke(this))}function ore(){return Ke(this).overflow}function ire(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pe("N",0,0,"eraAbbr");Pe("NN",0,0,"eraAbbr");Pe("NNN",0,0,"eraAbbr");Pe("NNNN",0,0,"eraName");Pe("NNNNN",0,0,"eraNarrow");Pe("y",["y",1],"yo","eraYear");Pe("y",["yy",2],0,"eraYear");Pe("y",["yyy",3],0,"eraYear");Pe("y",["yyyy",4],0,"eraYear");be("N",vE);be("NN",vE);be("NNN",vE);be("NNNN",gre);be("NNNNN",pre);yt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Ke(r).era=o:Ke(r).invalidEra=e});be("y",Pf);be("yy",Pf);be("yyy",Pf);be("yyyy",Pf);be("yo",mre);yt(["y","yy","yyy","yyyy"],sr);yt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[sr]=r._locale.eraYearOrdinalParse(e,o):t[sr]=parseInt(e,10)});function are(e,t){var r,n,o,i=this._eras||zo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=ee(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=ee(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function lre(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function sre(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ee(e.since).year():ee(e.since).year()+(t-e.offset)*r}function ure(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function fre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function cre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function hre(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-ee(o[e].since).year())*r+o[e].offset;return this.year()}function dre(e){return it(this,"_erasNameRegex")||yE.call(this),e?this._erasNameRegex:this._erasRegex}function vre(e){return it(this,"_erasAbbrRegex")||yE.call(this),e?this._erasAbbrRegex:this._erasRegex}function yre(e){return it(this,"_erasNarrowRegex")||yE.call(this),e?this._erasNarrowRegex:this._erasRegex}function vE(e,t){return t.erasAbbrRegex(e)}function gre(e,t){return t.erasNameRegex(e)}function pre(e,t){return t.erasNarrowRegex(e)}function mre(e,t){return t._eraYearOrdinalRegex||Pf}function yE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Br(a[o].name)),e.push(Br(a[o].abbr)),r.push(Br(a[o].narrow)),n.push(Br(a[o].name)),n.push(Br(a[o].abbr)),n.push(Br(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pe(0,["gg",2],0,function(){return this.weekYear()%100});Pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function xm(e,t){Pe(0,[e,e.length],0,t)}xm("gggg","weekYear");xm("ggggg","weekYear");xm("GGGG","isoWeekYear");xm("GGGGG","isoWeekYear");cr("weekYear","gg");cr("isoWeekYear","GG");hr("weekYear",1);hr("isoWeekYear",1);be("G",km);be("g",km);be("GG",Rt,Yr);be("gg",Rt,Yr);be("GGGG",oE,nE);be("gggg",oE,nE);be("GGGGG",Pm,Em);be("ggggg",Pm,Em);Sv(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Qe(e)});Sv(["gg","GG"],function(e,t,r,n){t[n]=ee.parseTwoDigitYear(e)});function bre(e){return sV.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function wre(e){return sV.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Sre(){return Ho(this.year(),1,4)}function Cre(){return Ho(this.isoWeekYear(),1,4)}function _re(){var e=this.localeData()._week;return Ho(this.year(),e.dow,e.doy)}function Ore(){var e=this.localeData()._week;return Ho(this.weekYear(),e.dow,e.doy)}function sV(e,t,r,n,o){var i;return e==null?zc(this,n,o).year:(i=Ho(e,n,o),t>i&&(t=i),Rre.call(this,e,t,r,n,o))}function Rre(e,t,r,n,o){var i=BB(e,t,r,n,o),a=Uc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Pe("Q",0,"Qo","quarter");cr("quarter","Q");hr("quarter",7);be("Q",AB);yt("Q",function(e,t){t[uo]=(Qe(e)-1)*3});function Ere(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Pe("D",["DD",2],"Do","date");cr("date","D");hr("date",9);be("D",Rt);be("DD",Rt,Yr);be("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});yt(["D","DD"],jn);yt("Do",function(e,t){t[jn]=Qe(e.match(Rt)[0])});var uV=Tf("Date",!0);Pe("DDD",["DDDD",3],"DDDo","dayOfYear");cr("dayOfYear","DDD");hr("dayOfYear",4);be("DDD",Tm);be("DDDD",IB);yt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Qe(e)});function Tre(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Pe("m",["mm",2],0,"minute");cr("minute","m");hr("minute",14);be("m",Rt);be("mm",Rt,Yr);yt(["m","mm"],yn);var Pre=Tf("Minutes",!1);Pe("s",["ss",2],0,"second");cr("second","s");hr("second",15);be("s",Rt);be("ss",Rt,Yr);yt(["s","ss"],fo);var kre=Tf("Seconds",!1);Pe("S",0,0,function(){return~~(this.millisecond()/100)});Pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pe(0,["SSS",3],0,"millisecond");Pe(0,["SSSS",4],0,function(){return this.millisecond()*10});Pe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});cr("millisecond","ms");hr("millisecond",16);be("S",Tm,AB);be("SS",Tm,Yr);be("SSS",Tm,IB);var hi,fV;for(hi="SSSS";hi.length<=9;hi+="S")be(hi,Pf);function $re(e,t){t[sa]=Qe(("0."+e)*1e3)}for(hi="S";hi.length<=9;hi+="S")yt(hi,$re);fV=Tf("Milliseconds",!1);Pe("z",0,0,"zoneAbbr");Pe("zz",0,0,"zoneName");function Are(){return this._isUTC?"UTC":""}function Ire(){return this._isUTC?"Coordinated Universal Time":""}var ne=bv.prototype;ne.add=Ote;ne.calendar=Ate;ne.clone=Ite;ne.diff=jte;ne.endOf=qte;ne.format=Wte;ne.from=Ute;ne.fromNow=zte;ne.to=Yte;ne.toNow=Gte;ne.get=xJ;ne.invalidAt=ore;ne.isAfter=Mte;ne.isBefore=xte;ne.isBetween=Dte;ne.isSame=Nte;ne.isSameOrAfter=Hte;ne.isSameOrBefore=Lte;ne.isValid=rre;ne.lang=nV;ne.locale=rV;ne.localeData=oV;ne.max=rte;ne.min=tte;ne.parsingFlags=nre;ne.set=DJ;ne.startOf=Kte;ne.subtract=Rte;ne.toArray=Jte;ne.toObject=ere;ne.toDate=Qte;ne.toISOString=Bte;ne.inspect=Vte;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=tre;ne.toString=Fte;ne.unix=Zte;ne.valueOf=Xte;ne.creationData=ire;ne.eraName=ure;ne.eraNarrow=fre;ne.eraAbbr=cre;ne.eraYear=hre;ne.year=FB;ne.isLeapYear=eee;ne.weekYear=bre;ne.isoWeekYear=wre;ne.quarter=ne.quarters=Ere;ne.month=LB;ne.daysInMonth=ZJ;ne.week=ne.weeks=aee;ne.isoWeek=ne.isoWeeks=lee;ne.weeksInYear=_re;ne.weeksInWeekYear=Ore;ne.isoWeeksInYear=Sre;ne.isoWeeksInISOWeekYear=Cre;ne.date=uV;ne.day=ne.days=wee;ne.weekday=See;ne.isoWeekday=Cee;ne.dayOfYear=Tre;ne.hour=ne.hours=kee;ne.minute=ne.minutes=Pre;ne.second=ne.seconds=kre;ne.millisecond=ne.milliseconds=fV;ne.utcOffset=cte;ne.utc=dte;ne.local=vte;ne.parseZone=yte;ne.hasAlignedHourOffset=gte;ne.isDST=pte;ne.isLocal=bte;ne.isUtcOffset=wte;ne.isUtc=QB;ne.isUTC=QB;ne.zoneAbbr=Are;ne.zoneName=Ire;ne.dates=rn("dates accessor is deprecated. Use date instead.",uV);ne.months=rn("months accessor is deprecated. Use month instead",LB);ne.years=rn("years accessor is deprecated. Use year instead",FB);ne.zone=rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",hte);ne.isDSTShifted=rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",mte);function Mre(e){return _t(e*1e3)}function xre(){return _t.apply(null,arguments).parseZone()}function cV(e){return e}var at=eE.prototype;at.calendar=wJ;at.longDateFormat=OJ;at.invalidDate=EJ;at.ordinal=kJ;at.preparse=cV;at.postformat=cV;at.relativeTime=AJ;at.pastFuture=IJ;at.set=mJ;at.eras=are;at.erasParse=lre;at.erasConvertYear=sre;at.erasAbbrRegex=vre;at.erasNameRegex=dre;at.erasNarrowRegex=yre;at.months=GJ;at.monthsShort=KJ;at.monthsParse=XJ;at.monthsRegex=JJ;at.monthsShortRegex=QJ;at.week=ree;at.firstDayOfYear=iee;at.firstDayOfWeek=oee;at.weekdays=yee;at.weekdaysMin=pee;at.weekdaysShort=gee;at.weekdaysParse=bee;at.weekdaysRegex=_ee;at.weekdaysShortRegex=Oee;at.weekdaysMinRegex=Ree;at.isPM=Tee;at.meridiem=$ee;function Kg(e,t,r,n){var o=zo(),i=zn().set(n,t);return o[r](i,e)}function hV(e,t,r){if(Fo(e)&&(t=e,e=void 0),e=e||"",t!=null)return Kg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Kg(e,n,r,"month");return o}function gE(e,t,r,n){typeof e=="boolean"?(Fo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Fo(t)&&(r=t,t=void 0),t=t||"");var o=zo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return Kg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=Kg(t,(a+i)%7,n,"day");return l}function Dre(e,t){return hV(e,t,"months")}function Nre(e,t){return hV(e,t,"monthsShort")}function Hre(e,t,r){return gE(e,t,r,"weekdays")}function Lre(e,t,r){return gE(e,t,r,"weekdaysShort")}function jre(e,t,r){return gE(e,t,r,"weekdaysMin")}vi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Qe(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ee.lang=rn("moment.lang is deprecated. Use moment.locale instead.",vi);ee.langData=rn("moment.langData is deprecated. Use moment.localeData instead.",zo);var Xn=Math.abs;function Fre(){var e=this._data;return this._milliseconds=Xn(this._milliseconds),this._days=Xn(this._days),this._months=Xn(this._months),e.milliseconds=Xn(e.milliseconds),e.seconds=Xn(e.seconds),e.minutes=Xn(e.minutes),e.hours=Xn(e.hours),e.months=Xn(e.months),e.years=Xn(e.years),this}function dV(e,t,r,n){var o=_n(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Bre(e,t){return dV(this,e,t,1)}function Vre(e,t){return dV(this,e,t,-1)}function I1(e){return e<0?Math.floor(e):Math.ceil(e)}function Wre(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=I1(LC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Zr(e/1e3),n.seconds=o%60,i=Zr(o/60),n.minutes=i%60,a=Zr(i/60),n.hours=a%24,t+=Zr(a/24),s=Zr(vV(t)),r+=s,t-=I1(LC(s)),l=Zr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function vV(e){return e*4800/146097}function LC(e){return e*146097/4800}function Ure(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=nn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+vV(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(LC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function zre(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function Yo(e){return function(){return this.as(e)}}var Yre=Yo("ms"),Gre=Yo("s"),Kre=Yo("m"),qre=Yo("h"),Xre=Yo("d"),Zre=Yo("w"),Qre=Yo("M"),Jre=Yo("Q"),ene=Yo("y");function tne(){return _n(this)}function rne(e){return e=nn(e),this.isValid()?this[e+"s"]():NaN}function al(e){return function(){return this.isValid()?this._data[e]:NaN}}var nne=al("milliseconds"),one=al("seconds"),ine=al("minutes"),ane=al("hours"),lne=al("days"),sne=al("months"),une=al("years");function fne(){return Zr(this.days()/7)}var io=Math.round,Kl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function cne(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function hne(e,t,r,n){var o=_n(e).abs(),i=io(o.as("s")),a=io(o.as("m")),l=io(o.as("h")),s=io(o.as("d")),u=io(o.as("M")),f=io(o.as("w")),c=io(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,cne.apply(null,h)}function dne(e){return e===void 0?io:typeof e=="function"?(io=e,!0):!1}function vne(e,t){return Kl[e]===void 0?!1:t===void 0?Kl[e]:(Kl[e]=t,e==="s"&&(Kl.ss=t-1),!0)}function yne(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Kl,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Kl,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=hne(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var hw=Math.abs;function dl(e){return(e>0)-(e<0)||+e}function Dm(){if(!this.isValid())return this.localeData().invalidDate();var e=hw(this._milliseconds)/1e3,t=hw(this._days),r=hw(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Zr(e/60),o=Zr(n/60),e%=60,n%=60,i=Zr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=dl(this._months)!==dl(l)?"-":"",f=dl(this._days)!==dl(l)?"-":"",c=dl(this._milliseconds)!==dl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var nt=Mm.prototype;nt.isValid=lte;nt.abs=Fre;nt.add=Bre;nt.subtract=Vre;nt.as=Ure;nt.asMilliseconds=Yre;nt.asSeconds=Gre;nt.asMinutes=Kre;nt.asHours=qre;nt.asDays=Xre;nt.asWeeks=Zre;nt.asMonths=Qre;nt.asQuarters=Jre;nt.asYears=ene;nt.valueOf=zre;nt._bubble=Wre;nt.clone=tne;nt.get=rne;nt.milliseconds=nne;nt.seconds=one;nt.minutes=ine;nt.hours=ane;nt.days=lne;nt.weeks=fne;nt.months=sne;nt.years=une;nt.humanize=yne;nt.toISOString=Dm;nt.toString=Dm;nt.toJSON=Dm;nt.locale=rV;nt.localeData=oV;nt.toIsoString=rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Dm);nt.lang=nV;Pe("X",0,0,"unix");Pe("x",0,0,"valueOf");be("x",km);be("X",HJ);yt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});yt("x",function(e,t,r){r._d=new Date(Qe(e))});//! moment.js
ee.version="2.29.4";gJ(_t);ee.fn=ne;ee.min=nte;ee.max=ote;ee.now=ite;ee.utc=zn;ee.unix=Mre;ee.months=Dre;ee.isDate=mv;ee.locale=vi;ee.invalid=Om;ee.duration=_n;ee.isMoment=mn;ee.weekdays=Hre;ee.parseZone=xre;ee.localeData=zo;ee.isDuration=ig;ee.monthsShort=Nre;ee.weekdaysMin=jre;ee.defineLocale=sE;ee.updateLocale=xee;ee.locales=Dee;ee.weekdaysShort=Lre;ee.normalizeUnits=nn;ee.relativeTimeRounding=dne;ee.relativeTimeThreshold=vne;ee.calendarFormat=$te;ee.prototype=ne;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const gne=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));var pne=TypeError,mne=9007199254740991,yV=function(e){if(e>mne)throw pne("Maximum allowed index exceeded");return e},bne=$e,wne=je,Sne=Rf,Cne=zt,_ne=Ir,One=en,M1=yV,x1=Of,Rne=A0,Ene=dv,Tne=wt,Pne=Xd,gV=Tne("isConcatSpreadable"),kne=Pne>=51||!wne(function(){var e=[];return e[gV]=!1,e.concat()[0]!==e}),$ne=function(e){if(!Cne(e))return!1;var t=e[gV];return t!==void 0?!!t:Sne(e)},Ane=!kne||!Ene("concat");bne({target:"Array",proto:!0,arity:1,forced:Ane},{concat:function(t){var r=_ne(this),n=Rne(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],$ne(u))for(s=One(u),M1(o+s),a=0;a<s;a++,o++)a in u&&x1(n,o,u[a]);else M1(o+1),x1(n,o++,u);return n.length=o,n}});var Ine=zt,Mne=Wn,xne=wt,Dne=xne("match"),pE=function(e){var t;return Ine(e)&&((t=e[Dne])!==void 0?!!t:Mne(e)=="RegExp")},Nne=pE,Hne=TypeError,mE=function(e){if(Nne(e))throw Hne("The method doesn't accept regular expressions");return e},Lne=wt,jne=Lne("match"),bE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[jne]=!1,"/./"[e](t)}catch{}}return!1},Fne=$e,Bne=Ye,Vne=mE,Wne=Ar,D1=Gt,Une=bE,zne=Bne("".indexOf);Fne({target:"String",proto:!0,forced:!Une("includes")},{includes:function(t){return!!~zne(D1(Wne(this)),D1(Vne(t)),arguments.length>1?arguments[1]:void 0)}});var Yne=Wo,Gne=vv,Kne=wt,qne=Yt,N1=Kne("species"),pV=function(e){var t=Yne(e);qne&&t&&!t[N1]&&Gne(t,N1,{configurable:!0,get:function(){return this}})},Xne=_f,Zne=vv,H1=S0,Qne=cv,Jne=P0,eoe=Cn,toe=T0,roe=v0,ly=y0,noe=pV,zf=Yt,L1=uv.fastKey,mV=Uo,j1=mV.set,dw=mV.getterFor,bV={getConstructor:function(e,t,r,n){var o=e(function(u,f){Jne(u,i),j1(u,{type:t,index:Xne(null),first:void 0,last:void 0,size:0}),zf||(u.size=0),eoe(f)||toe(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=dw(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,y;return d?d.value=c:(h.last=d={index:y=L1(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),zf?h.size++:u.size++,y!=="F"&&(h.index[y]=d)),u},s=function(u,f){var c=a(u),h=L1(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return H1(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,zf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),zf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=Qne(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),H1(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),zf&&Zne(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=dw(t),i=dw(n);roe(e,t,function(a,l){j1(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,ly(void 0,!0)):l=="keys"?ly(s.key,!1):l=="values"?ly(s.value,!1):ly([s.key,s.value],!1)},r?"entries":"values",!r,!0),noe(t)}},ooe=fm,ioe=bV;ooe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},ioe);var F1=Lt,aoe=cB,loe=Cn,soe=wt,uoe=soe("species"),foe=function(e,t){var r=F1(e).constructor,n;return r===void 0||loe(n=F1(r)[uoe])?t:aoe(n)},coe=il,Yf=Xt,wE=Ye,hoe=vm,doe=Lt,voe=Cn,yoe=pE,B1=Ar,goe=foe,poe=H0,moe=tl,vw=Gt,boe=el,V1=C0,W1=ym,woe=dm,Soe=N0,Coe=je,vl=Soe.UNSUPPORTED_Y,U1=4294967295,_oe=Math.min,wV=[].push,Ooe=wE(/./.exec),yl=wE(wV),Gf=wE("".slice),Roe=!Coe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});hoe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=vw(B1(this)),l=i===void 0?U1:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!yoe(o))return Yf(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=Yf(woe,c,a))&&(d=c.lastIndex,!(d>f&&(yl(s,Gf(a,f,h.index)),h.length>1&&h.index<a.length&&coe(wV,s,V1(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!Ooe(c,""))&&yl(s,""):yl(s,Gf(a,f)),s.length>l?V1(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Yf(t,this,o,i)}:n=t,[function(i,a){var l=B1(this),s=voe(i)?void 0:boe(i,e);return s?Yf(s,i,l,a):Yf(n,vw(l),i,a)},function(o,i){var a=doe(this),l=vw(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=goe(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(vl?"g":"y"),h=new u(vl?"^(?:"+a.source+")":a,c),d=i===void 0?U1:i>>>0;if(d===0)return[];if(l.length===0)return W1(h,l)===null?[l]:[];for(var v=0,y=0,m=[];y<l.length;){h.lastIndex=vl?0:y;var w=W1(h,vl?Gf(l,y):l),S;if(w===null||(S=_oe(moe(h.lastIndex+(vl?y:0)),l.length))===v)y=poe(l,y,f);else{if(yl(m,Gf(l,v,y)),m.length===d)return m;for(var C=1;C<=w.length-1;C++)if(yl(m,w[C]),m.length===d)return m;y=v=S}}return yl(m,Gf(l,v)),m}]},!Roe,vl);function SV(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function jC(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Ec(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function jt(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Wr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function We(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function A(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function CV(e){return jt(e,function(t,r){return t+r},0)}function Eoe(e){return jt(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function Toe(e){return jt(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function Poe(e){return e.length?CV(e)/e.length:0}function _V(e){return jt(e,function(t,r){return t.concat(Array.isArray(r)?_V(r):r)},[])}function SE(e){var t=[];return A(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function FC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function koe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return l.includes(s)})}),a}function $oe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return A(i,function(l){A(l,function(s){a.has(s)||a.add(s)})}),Array.from(a)}function BC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const Aoe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Poe,arrayEach:A,arrayFilter:Wr,arrayFlatten:_V,arrayMap:We,arrayMax:Eoe,arrayMin:Toe,arrayReduce:jt,arraySum:CV,arrayUnique:SE,extendArray:jC,getDifferenceOfArrays:FC,getIntersectionOfArrays:koe,getUnionOfArrays:$oe,pivot:Ec,stringToArray:BC,to2dArray:SV},Symbol.toStringTag,{value:"Module"}));function dt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=jt(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var z1,Y1,G1,K1,q1,X1;function ts(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function VC(e){"@babel/helpers - typeof";return VC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VC(e)}function xt(e){var t;switch(VC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ve(e){return typeof e<"u"}function mt(e){return typeof e>"u"}function qt(e){return e===null||e===""||mt(e)}function OV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var mc="length",Tc=function(t){return parseInt(t,16)},Z1=function(t){return parseInt(t,10)},qg=function(t,r,n){return t.substr(r,n)},Pc=function(t){return t.codePointAt(0)-65},WC=function(t){return"".concat(t).replace(/\-/g,"")},Ioe=function(t){return Tc(qg(WC(t),Tc("12"),Pc("F")))/(Tc(qg(WC(t),Pc("B"),~~![][mc]))||9)},Moe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},Q1=!1,J1={invalid:function(){return dt(z1||(z1=ts([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(Y1||(Y1=ts([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return dt(G1||(G1=ts([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},eA={invalid:function(){return dt(K1||(K1=ts([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(q1||(q1=ts([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return dt(X1||(X1=ts([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function RV(e,t){var r=!qt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="13.0.0",i,a="invalid",l="invalid";e=WC(e||"");var s=xoe(e);if(r||n||s)if(s){var u=ee("22/06/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=Ioe(e);i=ee((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(Moe()&&(a="valid",l="valid"),!Q1&&a!=="valid"){var h=J1[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](J1[a]({keyValidityDate:i,hotVersion:o})),Q1=!0}if(l!=="valid"&&t.parentNode){var d=eA[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=eA[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function xoe(e){var t=[][mc],r=t;if(e[mc]!==Pc("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=Pc(o.shift());i;i=Pc(o.shift()||"A"))--i<""[mc]?r=r|(Z1("".concat(Z1(Tc(n)+(Tc(qg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=qg(e,i,i?o[mc]===1?9:8:6);return r===t}const Doe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:RV,isDefined:ve,isEmpty:qt,isRegExp:OV,isUndefined:mt,stringify:xt},Symbol.toStringTag,{value:"Module"}));var Noe=Ir,tA=Qd,Hoe=en,Loe=function(t){for(var r=Noe(this),n=Hoe(r),o=arguments.length,i=tA(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:tA(a,n);l>i;)r[i++]=t;return r},joe=$e,Foe=Loe,Boe=tv;joe({target:"Array",proto:!0},{fill:Foe});Boe("fill");var Voe=$e,Woe=Ir,EV=ev,Uoe=je,zoe=Uoe(function(){EV(1)});Voe({target:"Object",stat:!0,forced:zoe},{keys:function(t){return EV(Woe(t))}});var Yoe=ol.forEach,Goe=Ef,Koe=Goe("forEach"),qoe=Koe?[].forEach:function(t){return Yoe(this,t,arguments.length>1?arguments[1]:void 0)},rA=vt,nA=gF,Xoe=pF,yw=qoe,Zoe=rl,TV=function(e){if(e&&e.forEach!==yw)try{Zoe(e,"forEach",yw)}catch{e.forEach=yw}};for(var gw in nA)nA[gw]&&TV(rA[gw]&&rA[gw].prototype);TV(Xoe);function oA(e,t,r){return t=Qoe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qoe(e){var t=Joe(e,"string");return Bo(t)==="symbol"?t:String(t)}function Joe(e,t){if(Bo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bo(e){"@babel/helpers - typeof";return Bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bo(e)}function vs(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},ze(e,function(r,n){n!=="__children"&&(r&&Bo(r)==="object"&&!Array.isArray(r)?t[n]=vs(r):Array.isArray(r)?r.length&&Bo(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[vs(r[0])]:t[n]=[]:t[n]=null)})),t}function Go(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function Ut(e,t,r){var n=Array.isArray(r);return ze(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function Cv(e,t){ze(t,function(r,n){t[n]&&Bo(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Cv(e[n],t[n])):e[n]=t[n]})}function fr(e){return Bo(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Sr(e){var t={};return ze(e,function(r,n){t[n]=r}),t}function gt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return A(r,function(o){e.MIXINS.push(o.MIXIN_NAME),ze(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(y){var m=y;return(Array.isArray(m)||Ue(m))&&(m=fr(m)),m};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function Nm(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function Gn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function ze(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function PV(e,t){var r=t.split("."),n=e;return ze(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function lg(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(Mt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function Hm(e){if(!Ue(e))return 0;var t=function r(n){var o=0;return Ue(n)?ze(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function ja(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},oA(t,n,e),oA(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function Mt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const eie=Object.freeze(Object.defineProperty({__proto__:null,clone:Sr,createObjectPropListener:ja,deepClone:fr,deepExtend:Cv,deepObjectSize:Hm,defineGetter:Gn,duckSchema:vs,extend:Ut,getProperty:PV,hasOwnProperty:Mt,inherit:Go,isObject:Ue,isObjectEqual:Nm,mixin:gt,objectEach:ze,setProperty:lg},Symbol.toStringTag,{value:"Module"}));var kr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Ur={chrome:kr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:kr(function(e){return/CriOS/.test(e)}),edge:kr(function(e){return/Edge/.test(e)}),edgeWebKit:kr(function(e){return/EdgiOS/.test(e)}),firefox:kr(function(e){return/Firefox/.test(e)}),firefoxWebKit:kr(function(e){return/FxiOS/.test(e)}),ie:kr(function(e){return/Trident/.test(e)}),ie9:kr(function(){return!!document.documentMode}),mobile:kr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:kr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},kf={mac:kr(function(e){return/^Mac/.test(e)}),win:kr(function(e){return/^Win/.test(e)}),linux:kr(function(e){return/^Linux/.test(e)}),ios:kr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function kV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;ze(Ur,function(i){var a=i.test;return void a(r,o)})}function $V(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;ze(kf,function(n){var o=n.test;return void o(r)})}kV();$V();function CE(){return Ur.chrome.value}function AV(){return Ur.chromeWebKit.value}function sg(){return Ur.firefox.value}function IV(){return Ur.firefoxWebKit.value}function MV(){return Ur.safari.value}function xV(){return Ur.edge.value}function tie(){return Ur.edgeWebKit.value}function DV(){return Ur.ie.value}function NV(){return Ur.ie9.value}function rie(){return Ur.ie.value||Ur.edge.value}function gn(){return Ur.mobile.value}function _E(){return kf.ios.value}function OE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&kf.mac.value}function UC(){return kf.win.value}function Xg(){return kf.mac.value}function nie(){return kf.linux.value}const oie=Object.freeze(Object.defineProperty({__proto__:null,isChrome:CE,isChromeWebKit:AV,isEdge:xV,isEdgeWebKit:tie,isFirefox:sg,isFirefoxWebKit:IV,isIE:DV,isIE9:NV,isIOS:_E,isIpadOS:OE,isLinuxOS:nie,isMSBrowser:rie,isMacOS:Xg,isMobileBrowser:gn,isSafari:MV,isWindowsOS:UC,setBrowserMeta:kV,setPlatformMeta:$V},Symbol.toStringTag,{value:"Module"}));var me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:sg()?182:174,AUDIO_MUTE:sg()?181:173,AUDIO_UP:sg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},iie=[me.ALT,me.ARROW_DOWN,me.ARROW_LEFT,me.ARROW_RIGHT,me.ARROW_UP,me.AUDIO_DOWN,me.AUDIO_MUTE,me.AUDIO_UP,me.BACKSPACE,me.CAPS_LOCK,me.DELETE,me.END,me.ENTER,me.ESCAPE,me.F1,me.F2,me.F3,me.F4,me.F5,me.F6,me.F7,me.F8,me.F9,me.F10,me.F11,me.F12,me.F13,me.F14,me.F15,me.F16,me.F17,me.F18,me.F19,me.HOME,me.INSERT,me.MEDIA_NEXT,me.MEDIA_PLAY_PAUSE,me.MEDIA_PREV,me.MEDIA_STOP,me.NULL,me.NUM_LOCK,me.PAGE_DOWN,me.PAGE_UP,me.PAUSE,me.SCROLL_LOCK,me.SHIFT,me.TAB];function HV(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function RE(e){return iie.includes(e)}function aie(e){var t=[];return Xg()?t.push(me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX):t.push(me.CONTROL),t.includes(e)}function LV(e){return[me.CONTROL,me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX].includes(e)}function ys(e,t){var r=t.split("|"),n=!1;return A(r,function(o){if(e===me[o])return n=!0,!1}),n}const lie=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:me,isCtrlKey:aie,isCtrlMetaKey:LV,isFunctionKey:RE,isKey:ys,isPrintableChar:HV},Symbol.toStringTag,{value:"Module"}));function bn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function aa(e){return e.isImmediatePropagationEnabled===!1}function ki(e){return e.button===2}function Lm(e){return e.button===0}const sie=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:aa,isLeftClick:Lm,isRightClick:ki,stopImmediatePropagation:bn},Symbol.toStringTag,{value:"Module"}));var uie=_r.f,fie=function(e,t,r){r in e||uie(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},cie=Yt,EE=vt,_v=Ye,hie=am,die=k0,vie=rl,yie=nl.f,iA=xi,gie=pE,aA=Gt,pie=mB,jV=N0,mie=fie,bie=tn,wie=je,Sie=Dt,Cie=Uo.enforce,_ie=pV,Oie=wt,FV=TF,BV=PF,Rie=Oie("match"),yi=EE.RegExp,Wl=yi.prototype,Eie=EE.SyntaxError,Tie=_v(Wl.exec),Zg=_v("".charAt),lA=_v("".replace),sA=_v("".indexOf),Pie=_v("".slice),kie=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ha=/a/g,pw=/a/g,$ie=new yi(Ha)!==Ha,VV=jV.MISSED_STICKY,Aie=jV.UNSUPPORTED_Y,Iie=cie&&(!$ie||VV||FV||BV||wie(function(){return pw[Rie]=!1,yi(Ha)!=Ha||yi(pw)==pw||yi(Ha,"i")!="/a/i"})),Mie=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Zg(e,r),i==="\\"){n+=i+Zg(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},xie=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=Zg(e,r),f==="\\")f=f+Zg(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":Tie(kie,Pie(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||Sie(i,u))throw new Eie("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(hie("RegExp",Iie)){for(var Vi=function(t,r){var n=iA(Wl,this),o=gie(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Vi)return t;if((o||iA(Wl,t))&&(t=t.source,i&&(r=pie(l))),t=t===void 0?"":aA(t),r=r===void 0?"":aA(r),l=t,FV&&"dotAll"in Ha&&(u=!!r&&sA(r,"s")>-1,u&&(r=lA(r,/s/g,""))),s=r,VV&&"sticky"in Ha&&(f=!!r&&sA(r,"y")>-1,f&&Aie&&(r=lA(r,/y/g,""))),BV&&(c=xie(t),t=c[0],a=c[1]),h=die(yi(t,r),n?this:Wl,Vi),(u||f||a.length)&&(d=Cie(h),u&&(d.dotAll=!0,d.raw=Vi(Mie(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{vie(h,"source",l===""?"(?:)":l)}catch{}return h},uA=yie(yi),fA=0;uA.length>fA;)mie(Vi,yi,uA[fA++]);Wl.constructor=Vi,Vi.prototype=Wl,bie(EE,"RegExp",Vi,{constructor:!0})}_ie("RegExp");var Die=$e,Nie=Ye,Hie=qd,Lie=zr,jie=Ef,Fie=Nie([].join),Bie=Hie!=Object,Vie=Bie||!jie("join",",");Die({target:"Array",proto:!0,forced:Vie},{join:function(t){return Fie(Lie(this),t===void 0?",":t)}});function zC(e){"@babel/helpers - typeof";return zC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zC(e)}function jm(e){return window.requestAnimationFrame(e)}function WV(){return!!document.documentElement.classList}function UV(){return!!document.createTextNode("test").textContent}function zV(){return!!window.getComputedStyle}function Gc(e){window.cancelAnimationFrame(e)}function TE(){return"ontouchstart"in window}var YC;function Wie(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),YC=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function PE(){return YC===void 0&&Wie(),YC}var gl;function YV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return gl||((typeof Intl>"u"?"undefined":zC(Intl))==="object"?gl=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?gl=function(n,o){return"".concat(n).localeCompare(o)}:gl=function(n,o){return n===o?0:n>o?-1:1},gl)}var Kf;function GV(){if(Kf!==void 0)return Kf;try{var e={get passive(){Kf=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Kf=!1}return Kf}const Uie=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Gc,getComparisonFunction:YV,hasCaptionProblem:PE,isClassListSupported:WV,isGetComputedStyleSupported:zV,isPassiveEventSupported:GV,isTextContentSupported:UV,isTouchSupported:TE,requestAnimationFrame:jm},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function si(e){"@babel/helpers - typeof";return si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},si(e)}function GC(e,t){return GC=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},GC(e,t)}function zie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ug(e,t,r){return zie()?ug=Reflect.construct:ug=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&GC(u,a.prototype),u},ug.apply(null,arguments)}function un(e){return Yie(e)||Gie(e)||Kie(e)||qie()}function Yie(e){if(Array.isArray(e))return KC(e)}function Gie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kie(e,t){if(e){if(typeof e=="string")return KC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KC(e,t)}}function KC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Xie=Object.hasOwnProperty,cA=Object.setPrototypeOf,Zie=Object.isFrozen,Qie=Object.getPrototypeOf,Jie=Object.getOwnPropertyDescriptor,Cr=Object.freeze,wn=Object.seal,eae=Object.create,KV=typeof Reflect<"u"&&Reflect,Qg=KV.apply,qC=KV.construct;Qg||(Qg=function(t,r,n){return t.apply(r,n)});Cr||(Cr=function(t){return t});wn||(wn=function(t){return t});qC||(qC=function(t,r){return ug(t,un(r))});var tae=Jr(Array.prototype.forEach),hA=Jr(Array.prototype.pop),qf=Jr(Array.prototype.push),fg=Jr(String.prototype.toLowerCase),mw=Jr(String.prototype.toString),rae=Jr(String.prototype.match),an=Jr(String.prototype.replace),nae=Jr(String.prototype.indexOf),oae=Jr(String.prototype.trim),vr=Jr(RegExp.prototype.test),bw=iae(TypeError);function Jr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Qg(e,t,n)}}function iae(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return qC(e,r)}}function Xe(e,t,r){r=r||fg,cA&&cA(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(Zie(t)||(t[n]=i),o=i)}e[o]=!0}return e}function Wi(e){var t=eae(null),r;for(r in e)Qg(Xie,e,[r])===!0&&(t[r]=e[r]);return t}function sy(e,t){for(;e!==null;){var r=Jie(e,t);if(r){if(r.get)return Jr(r.get);if(typeof r.value=="function")return Jr(r.value)}e=Qie(e)}function n(o){return console.warn("fallback value for",o),null}return n}var dA=Cr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ww=Cr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Sw=Cr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),aae=Cr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Cw=Cr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),lae=Cr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),vA=Cr(["#text"]),yA=Cr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),_w=Cr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gA=Cr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),uy=Cr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),sae=wn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),uae=wn(/<%[\w\W]*|[\w\W]*%>/gm),fae=wn(/\${[\w\W]*}/gm),cae=wn(/^data-[\-\w.\u00B7-\uFFFF]/),hae=wn(/^aria-[\-\w]+$/),dae=wn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),vae=wn(/^(?:\w+script|data):/i),yae=wn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),gae=wn(/^html$/i),pae=function(){return typeof window>"u"?null:window},mae=function(t,r){if(si(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function qV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pae(),t=function(H){return qV(H)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,y=sy(v,"cloneNode"),m=sy(v,"nextSibling"),w=sy(v,"childNodes"),S=sy(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var k=mae(d,r),O=k?k.createHTML(""):"",W=n,Y=W.implementation,q=W.createNodeIterator,G=W.createDocumentFragment,X=W.getElementsByTagName,Q=r.importNode,oe={};try{oe=Wi(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof S=="function"&&Y&&typeof Y.createHTMLDocument<"u"&&oe!==9;var ue=sae,he=uae,Oe=fae,we=cae,$=hae,P=vae,g=yae,p=dae,b=null,E=Xe({},[].concat(un(dA),un(ww),un(Sw),un(Cw),un(vA))),R=null,F=Xe({},[].concat(un(yA),un(_w),un(gA),un(uy))),x=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Z=null,re=!0,ie=!0,se=!1,_e=!0,Se=!1,U=!1,Ne=!1,Be=!1,ke=!1,Ie=!1,Ae=!1,_=!0,T=!1,I="user-content-",j=!0,M=!1,B={},N=null,D=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,L=Xe({},["audio","video","img","source","image","track"]),z=null,le=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",He="http://www.w3.org/1999/xhtml",Ze=He,st=!1,Ge=null,Me=Xe({},[pe,Re,He],mw),De,dr=["application/xhtml+xml","text/html"],Ft="text/html",Ve,Je=null,St=n.createElement("form"),ut=function(H){return H instanceof RegExp||H instanceof Function},ft=function(H){Je&&Je===H||((!H||si(H)!=="object")&&(H={}),H=Wi(H),De=dr.indexOf(H.PARSER_MEDIA_TYPE)===-1?De=Ft:De=H.PARSER_MEDIA_TYPE,Ve=De==="application/xhtml+xml"?mw:fg,b="ALLOWED_TAGS"in H?Xe({},H.ALLOWED_TAGS,Ve):E,R="ALLOWED_ATTR"in H?Xe({},H.ALLOWED_ATTR,Ve):F,Ge="ALLOWED_NAMESPACES"in H?Xe({},H.ALLOWED_NAMESPACES,mw):Me,z="ADD_URI_SAFE_ATTR"in H?Xe(Wi(le),H.ADD_URI_SAFE_ATTR,Ve):le,V="ADD_DATA_URI_TAGS"in H?Xe(Wi(L),H.ADD_DATA_URI_TAGS,Ve):L,N="FORBID_CONTENTS"in H?Xe({},H.FORBID_CONTENTS,Ve):D,K="FORBID_TAGS"in H?Xe({},H.FORBID_TAGS,Ve):{},Z="FORBID_ATTR"in H?Xe({},H.FORBID_ATTR,Ve):{},B="USE_PROFILES"in H?H.USE_PROFILES:!1,re=H.ALLOW_ARIA_ATTR!==!1,ie=H.ALLOW_DATA_ATTR!==!1,se=H.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=H.SAFE_FOR_TEMPLATES||!1,U=H.WHOLE_DOCUMENT||!1,ke=H.RETURN_DOM||!1,Ie=H.RETURN_DOM_FRAGMENT||!1,Ae=H.RETURN_TRUSTED_TYPE||!1,Be=H.FORCE_BODY||!1,_=H.SANITIZE_DOM!==!1,T=H.SANITIZE_NAMED_PROPS||!1,j=H.KEEP_CONTENT!==!1,M=H.IN_PLACE||!1,p=H.ALLOWED_URI_REGEXP||p,Ze=H.NAMESPACE||He,x=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&ut(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&ut(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(ie=!1),Ie&&(ke=!0),B&&(b=Xe({},un(vA)),R=[],B.html===!0&&(Xe(b,dA),Xe(R,yA)),B.svg===!0&&(Xe(b,ww),Xe(R,_w),Xe(R,uy)),B.svgFilters===!0&&(Xe(b,Sw),Xe(R,_w),Xe(R,uy)),B.mathMl===!0&&(Xe(b,Cw),Xe(R,gA),Xe(R,uy))),H.ADD_TAGS&&(b===E&&(b=Wi(b)),Xe(b,H.ADD_TAGS,Ve)),H.ADD_ATTR&&(R===F&&(R=Wi(R)),Xe(R,H.ADD_ATTR,Ve)),H.ADD_URI_SAFE_ATTR&&Xe(z,H.ADD_URI_SAFE_ATTR,Ve),H.FORBID_CONTENTS&&(N===D&&(N=Wi(N)),Xe(N,H.FORBID_CONTENTS,Ve)),j&&(b["#text"]=!0),U&&Xe(b,["html","head","body"]),b.table&&(Xe(b,["tbody"]),delete K.tbody),Cr&&Cr(H),Je=H)},et=Xe({},["mi","mo","mn","ms","mtext"]),Ko=Xe({},["foreignobject","desc","title","annotation-xml"]),db=Xe({},["title","style","font","a","script"]),Li=Xe({},ww);Xe(Li,Sw),Xe(Li,aae);var Nf=Xe({},Cw);Xe(Nf,lae);var IY=function(H){var ae=S(H);(!ae||!ae.tagName)&&(ae={namespaceURI:Ze,tagName:"template"});var de=fg(H.tagName),lt=fg(ae.tagName);return Ge[H.namespaceURI]?H.namespaceURI===Re?ae.namespaceURI===He?de==="svg":ae.namespaceURI===pe?de==="svg"&&(lt==="annotation-xml"||et[lt]):!!Li[de]:H.namespaceURI===pe?ae.namespaceURI===He?de==="math":ae.namespaceURI===Re?de==="math"&&Ko[lt]:!!Nf[de]:H.namespaceURI===He?ae.namespaceURI===Re&&!Ko[lt]||ae.namespaceURI===pe&&!et[lt]?!1:!Nf[de]&&(db[de]||!Li[de]):!!(De==="application/xhtml+xml"&&Ge[H.namespaceURI]):!1},Kn=function(H){qf(t.removed,{element:H});try{H.parentNode.removeChild(H)}catch{try{H.outerHTML=O}catch{H.remove()}}},vb=function(H,ae){try{qf(t.removed,{attribute:ae.getAttributeNode(H),from:ae})}catch{qf(t.removed,{attribute:null,from:ae})}if(ae.removeAttribute(H),H==="is"&&!R[H])if(ke||Ie)try{Kn(ae)}catch{}else try{ae.setAttribute(H,"")}catch{}},lk=function(H){var ae,de;if(Be)H="<remove></remove>"+H;else{var lt=rae(H,/^[\r\n\t ]+/);de=lt&&lt[0]}De==="application/xhtml+xml"&&Ze===He&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");var Rr=k?k.createHTML(H):H;if(Ze===He)try{ae=new h().parseFromString(Rr,De)}catch{}if(!ae||!ae.documentElement){ae=Y.createDocument(Ze,"template",null);try{ae.documentElement.innerHTML=st?O:Rr}catch{}}var ir=ae.body||ae.documentElement;return H&&de&&ir.insertBefore(n.createTextNode(de),ir.childNodes[0]||null),Ze===He?X.call(ae,U?"html":"body")[0]:U?ae.documentElement:ir},sk=function(H){return q.call(H.ownerDocument||H,H,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},MY=function(H){return H instanceof c&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof f)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},Hf=function(H){return si(a)==="object"?H instanceof a:H&&si(H)==="object"&&typeof H.nodeType=="number"&&typeof H.nodeName=="string"},qn=function(H,ae,de){J[H]&&tae(J[H],function(lt){lt.call(t,ae,de,Je)})},uk=function(H){var ae;if(qn("beforeSanitizeElements",H,null),MY(H)||vr(/[\u0080-\uFFFF]/,H.nodeName))return Kn(H),!0;var de=Ve(H.nodeName);if(qn("uponSanitizeElement",H,{tagName:de,allowedTags:b}),H.hasChildNodes()&&!Hf(H.firstElementChild)&&(!Hf(H.content)||!Hf(H.content.firstElementChild))&&vr(/<[/\w]/g,H.innerHTML)&&vr(/<[/\w]/g,H.textContent)||de==="select"&&vr(/<template/i,H.innerHTML))return Kn(H),!0;if(!b[de]||K[de]){if(!K[de]&&ck(de)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de)))return!1;if(j&&!N[de]){var lt=S(H)||H.parentNode,Rr=w(H)||H.childNodes;if(Rr&&lt)for(var ir=Rr.length,or=ir-1;or>=0;--or)lt.insertBefore(y(Rr[or],!0),m(H))}return Kn(H),!0}return H instanceof l&&!IY(H)||(de==="noscript"||de==="noembed")&&vr(/<\/no(script|embed)/i,H.innerHTML)?(Kn(H),!0):(Se&&H.nodeType===3&&(ae=H.textContent,ae=an(ae,ue," "),ae=an(ae,he," "),ae=an(ae,Oe," "),H.textContent!==ae&&(qf(t.removed,{element:H.cloneNode()}),H.textContent=ae)),qn("afterSanitizeElements",H,null),!1)},fk=function(H,ae,de){if(_&&(ae==="id"||ae==="name")&&(de in n||de in St))return!1;if(!(ie&&!Z[ae]&&vr(we,ae))){if(!(re&&vr($,ae))){if(!R[ae]||Z[ae]){if(!(ck(H)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,H)||x.tagNameCheck instanceof Function&&x.tagNameCheck(H))&&(x.attributeNameCheck instanceof RegExp&&vr(x.attributeNameCheck,ae)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(ae))||ae==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de))))return!1}else if(!z[ae]){if(!vr(p,an(de,g,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&H!=="script"&&nae(de,"data:")===0&&V[H])){if(!(se&&!vr(P,an(de,g,"")))){if(de)return!1}}}}}}return!0},ck=function(H){return H.indexOf("-")>0},hk=function(H){var ae,de,lt,Rr;qn("beforeSanitizeAttributes",H,null);var ir=H.attributes;if(ir){var or={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};for(Rr=ir.length;Rr--;){ae=ir[Rr];var Bv=ae,er=Bv.name,yb=Bv.namespaceURI;if(de=er==="value"?ae.value:oae(ae.value),lt=Ve(er),or.attrName=lt,or.attrValue=de,or.keepAttr=!0,or.forceKeepAttr=void 0,qn("uponSanitizeAttribute",H,or),de=or.attrValue,!or.forceKeepAttr&&(vb(er,H),!!or.keepAttr)){if(!_e&&vr(/\/>/i,de)){vb(er,H);continue}Se&&(de=an(de,ue," "),de=an(de,he," "),de=an(de,Oe," "));var dk=Ve(H.nodeName);if(fk(dk,lt,de)){if(T&&(lt==="id"||lt==="name")&&(vb(er,H),de=I+de),k&&si(d)==="object"&&typeof d.getAttributeType=="function"&&!yb)switch(d.getAttributeType(dk,lt)){case"TrustedHTML":de=k.createHTML(de);break;case"TrustedScriptURL":de=k.createScriptURL(de);break}try{yb?H.setAttributeNS(yb,er,de):H.setAttribute(er,de),hA(t.removed)}catch{}}}}qn("afterSanitizeAttributes",H,null)}},xY=function Ee(H){var ae,de=sk(H);for(qn("beforeSanitizeShadowDOM",H,null);ae=de.nextNode();)qn("uponSanitizeShadowNode",ae,null),!uk(ae)&&(ae.content instanceof o&&Ee(ae.content),hk(ae));qn("afterSanitizeShadowDOM",H,null)};return t.sanitize=function(Ee){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,de,lt,Rr,ir;if(st=!Ee,st&&(Ee="<!-->"),typeof Ee!="string"&&!Hf(Ee)){if(typeof Ee.toString!="function")throw bw("toString is not a function");if(Ee=Ee.toString(),typeof Ee!="string")throw bw("dirty is not a string, aborting")}if(!t.isSupported){if(si(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(Hf(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Ne||ft(H),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var or=Ve(Ee.nodeName);if(!b[or]||K[or])throw bw("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)ae=lk("<!---->"),de=ae.ownerDocument.importNode(Ee,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?ae=de:ae.appendChild(de);else{if(!ke&&!Se&&!U&&Ee.indexOf("<")===-1)return k&&Ae?k.createHTML(Ee):Ee;if(ae=lk(Ee),!ae)return ke?null:Ae?O:""}ae&&Be&&Kn(ae.firstChild);for(var Bv=sk(M?Ee:ae);lt=Bv.nextNode();)lt.nodeType===3&&lt===Rr||uk(lt)||(lt.content instanceof o&&xY(lt.content),hk(lt),Rr=lt);if(Rr=null,M)return Ee;if(ke){if(Ie)for(ir=G.call(ae.ownerDocument);ae.firstChild;)ir.appendChild(ae.firstChild);else ir=ae;return(R.shadowroot||R.shadowrootmod)&&(ir=Q.call(r,ir,!0)),ir}var er=U?ae.outerHTML:ae.innerHTML;return U&&b["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&vr(gae,ae.ownerDocument.doctype.name)&&(er="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+er),Se&&(er=an(er,ue," "),er=an(er,he," "),er=an(er,Oe," ")),k&&Ae?k.createHTML(er):er},t.setConfig=function(Ee){ft(Ee),Ne=!0},t.clearConfig=function(){Je=null,Ne=!1},t.isValidAttribute=function(Ee,H,ae){Je||ft({});var de=Ve(Ee),lt=Ve(H);return fk(de,lt,ae)},t.addHook=function(Ee,H){typeof H=="function"&&(J[Ee]=J[Ee]||[],qf(J[Ee],H))},t.removeHook=function(Ee){if(J[Ee])return hA(J[Ee])},t.removeHooks=function(Ee){J[Ee]&&(J[Ee]=[])},t.removeAllHooks=function(){J={}},t}var bae=qV();function ur(e){return e[0].toUpperCase()+e.substr(1)}function wae(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=xt(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function kE(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function $E(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function AE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function XC(e){return Fm("".concat(e),{ALLOWED_TAGS:[]})}function Fm(e,t){return bae.sanitize(e,t)}const Sae=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:wae,isPercentValue:$E,randomString:kE,sanitize:Fm,stripTags:XC,substitute:AE,toUpperCaseFirst:ur},Symbol.toStringTag,{value:"Module"}));function pA(e){return Rae(e)||Oae(e)||_ae(e)||Cae()}function Cae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ae(e,t){if(e){if(typeof e=="string")return ZC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZC(e,t)}}function Oae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rae(e){if(Array.isArray(e))return ZC(e)}function ZC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XV(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function ZV(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Kc(e){return ZV(e)&&e.parent}function Eae(e){return!!Object.getPrototypeOf(e.parent)}function gi(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function bc(e,t,r){for(var n=[],o=e;o&&(o=gi(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function pi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function QV(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function ai(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var QC,JC,e_;function fy(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(WV()){var mA=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};QC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},JC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=fy(o),o.length>0)if(mA(n)){var i;(i=t.classList).add.apply(i,pA(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},e_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=fy(o),o.length>0)if(mA(n)){var i;(i=t.classList).remove.apply(i,pA(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var Ow=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};QC=function(t,r){return t.className!==void 0&&Ow(r).test(t.className)},JC=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=fy(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!Ow(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},e_=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=fy(i);i[n];)o=o.replace(Ow(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return QC(e,t)}function te(e,t){JC(e,t)}function Le(e,t){e_(e,t)}function IE(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)IE(t[r])}function Sn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var JV=/(<(.*)>|&(.*);)/;function ll(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;JV.test(t)?e.innerHTML=r?Fm(t):t:$i(e,t)}function $i(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?UV?r.textContent=t:r.data=t:(Sn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function gs(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return gs(r.host.impl);if(r.host)return gs(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Wt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(PE()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function ps(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Fa(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function qc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?ps(t):e.scrollTop}function Jg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Fa(t):e.scrollLeft}function Xc(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=zV(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function Ba(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ai(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function ms(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ai(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function Tae(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ai(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ct(e){return e.offsetWidth}function Tt(e){return PE()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function co(e){return e.clientHeight||e.innerHeight}function kc(e){return e.clientWidth||e.innerWidth}function Pae(e,t,r){e.addEventListener(t,r,!1)}function kae(e,t,r){e.removeEventListener(t,r,!1)}function ME(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function eW(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function tW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function t_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Ov(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var Rw;function $ae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Jt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Rw===void 0&&(Rw=$ae(e)),Rw}function rW(e){return e.offsetWidth!==e.clientWidth}function nW(e){return e.offsetHeight!==e.clientHeight}function Bm(e,t,r){NV()?(e.style.top=r,e.style.left=t):MV()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Aae(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function Rv(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Zc(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Vm(e){return Zc(e)&&e.hasAttribute("data-hot-input")===!1}function oW(e){var t=e.ownerDocument.activeElement;Vm(t)||e.select()}function xE(e){return!e.parentNode}function iW(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const Iae=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:JV,addClass:te,addEvent:Pae,clearTextSelection:t_,closest:gi,closestDown:bc,empty:Sn,fastInnerHTML:ll,fastInnerText:$i,getCaretPosition:ME,getComputedStyle:Ai,getCssTransform:Aae,getFrameElement:ZV,getParent:XV,getParentWindow:Kc,getScrollLeft:Jg,getScrollTop:qc,getScrollableElement:Xc,getScrollbarWidth:Jt,getSelectionEndPosition:eW,getSelectionText:tW,getStyle:ms,getTrimmingContainer:Ba,getWindowScrollLeft:Fa,getWindowScrollTop:ps,hasAccessToParentWindow:Eae,hasClass:xe,hasHorizontalScrollbar:nW,hasVerticalScrollbar:rW,index:QV,innerHeight:co,innerWidth:kc,isChildOf:pi,isDetached:xE,isInput:Zc,isOutsideInput:Vm,isVisible:gs,matchesCSSRules:Tae,observeVisibilityChangeOnce:iW,offset:Wt,outerHeight:Tt,outerWidth:ct,overlayContainsElement:ai,removeClass:Le,removeEvent:kae,removeTextNodes:IE,resetCssTransform:Rv,selectElementIfAllowed:oW,setCaretPosition:Ov,setOverlayPosition:Bm},Symbol.toStringTag,{value:"Module"}));var Mae=fm,xae=bV;Mae("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},xae);var Dae=Yt,Nae=Rf,Hae=TypeError,Lae=Object.getOwnPropertyDescriptor,jae=Dae&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Fae=jae?function(e,t){if(Nae(e)&&!Lae(e,"length").writable)throw Hae("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Bae=$e,Vae=Ir,Wae=Qd,Uae=Di,zae=en,Yae=Fae,Gae=yV,Kae=A0,qae=Of,Ew=CF,Xae=dv,Zae=Xae("splice"),Qae=Math.max,Jae=Math.min;Bae({target:"Array",proto:!0,forced:!Zae},{splice:function(t,r){var n=Vae(this),o=zae(n),i=Wae(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=Jae(Qae(Uae(r),0),o-i)),Gae(o+l-s),u=Kae(n,s),f=0;f<s;f++)c=i+f,c in n&&qae(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:Ew(n,h);for(f=o;f>o-s+l;f--)Ew(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:Ew(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return Yae(n,o-s+l),u}});function bt(){if(ve(console)){var e;(e=console).warn.apply(e,arguments)}}function DE(){if(ve(console)){var e;(e=console).error.apply(e,arguments)}}var ele=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",tle=TypeError,aW=function(e,t){if(e<t)throw tle("Not enough arguments");return e},lW=vt,rle=il,nle=Ot,ole=ele,ile=Qa,ale=gv,lle=aW,sle=lW.Function,ule=/MSIE .\./.test(ile)||ole&&function(){var e=lW.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),NE=function(e,t){var r=t?2:1;return ule?function(n,o){var i=lle(arguments.length,1)>r,a=nle(n)?n:sle(n),l=i?ale(arguments,r):[],s=i?function(){rle(a,this,l)}:a;return t?e(s,o):e(s)}:e},fle=$e,sW=vt,cle=NE,bA=cle(sW.setInterval,!0);fle({global:!0,bind:!0,forced:sW.setInterval!==bA},{setInterval:bA});var hle=$e,uW=vt,dle=NE,wA=dle(uW.setTimeout,!0);hle({global:!0,bind:!0,forced:uW.setTimeout!==wA},{setTimeout:wA});var vle=$e,yle=Ye,gle=Rf,ple=yle([].reverse),SA=[1,2];vle({target:"Array",proto:!0,forced:String(SA)===String(SA.reverse())},{reverse:function(){return gle(this)&&(this.length=this.length),ple(this)}});function pt(e){return typeof e=="function"}function fW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,s),r=0,o=void 0},h)),n}return i}function mle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=fW(e,t),o=r;function i(){o=r}function a(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return o?(o-=1,e.apply(this,s)):n.apply(this,s)}return a.clearHits=i,a}function HE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function ble(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return jt(o,function(u,f){return f(u)},n.apply(this,l))}}function LE(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function cW(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function wle(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a.reverse()),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function ep(e,t,r,n,o,i,a,l){return ve(l)?e.call(t,r,n,o,i,a,l):ve(a)?e.call(t,r,n,o,i,a):ve(i)?e.call(t,r,n,o,i):ve(o)?e.call(t,r,n,o):ve(n)?e.call(t,r,n):ve(r)?e.call(t,r):e.call(t)}const Sle=Object.freeze(Object.defineProperty({__proto__:null,curry:cW,curryRight:wle,debounce:HE,fastCall:ep,isFunction:pt,partial:LE,pipe:ble,throttle:fW,throttleAfterHits:mle},Symbol.toStringTag,{value:"Module"}));function Qc(e){"@babel/helpers - typeof";return Qc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(e)}var CA;function Cle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ole(n.key),n)}}function _le(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ole(e){var t=Rle(e,"string");return Qc(t)==="symbol"?t:String(t)}function Rle(e,t){if(Qc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ele(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var pl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Tle=dt(CA||(CA=Ele([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Tw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Pw=new Map([]),hW=function(){function e(){Cle(this,e),this.globalBucket=this.createEmptyBucket()}return _le(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return A(pl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))A(n,function(s){return o.add(r,s,i)});else{Tw.has(r)&&bt(AE(Tle,{hookName:r,removedInVersion:Tw.get(r)})),Pw.has(r)&&bt(Pw.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&A(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?A(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=ep(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],y=v?v.length:0,m=0;if(y)for(;m<y;){if(!v[m]||v[m].skip){m+=1;continue}var w=ep(v[m],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[m]&&v[m].runOnce&&this.remove(n,v[m],r),m+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ze(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||pl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&pl.splice(pl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Pw.has(r)||Tw.has(r)}},{key:"isRegistered",value:function(r){return pl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return pl}}],[{key:"getSingleton",value:function(){return kle()}}]),e}(),Ple=new hW;function kle(){return Ple}const ge=hW;function OA(e){return Mle(e)||Ile(e)||Ale(e)||$le()}function $le(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ale(e,t){if(e){if(typeof e=="string")return r_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r_(e,t)}}function Ile(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mle(e){if(Array.isArray(e))return r_(e)}function r_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var kw=new Map;function on(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";kw.has(e)||kw.set(e,new Map);var t=kw.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return OA(t.keys())}function a(){return OA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var n_=new WeakMap,Ev=on("editors"),xle=Ev.register,dW=Ev.getItem,vW=Ev.hasItem,Dle=Ev.getNames;Ev.getValues;function Nle(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ge.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function yW(e,t){var r;if(typeof e=="function")n_.get(e)||Pr(null,e),r=n_.get(e);else if(typeof e=="string")r=dW(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function tp(e){if(typeof e=="function")return e;if(!vW(e))throw Error('No registered editor found under "'.concat(e,'" name'));return dW(e).getConstructor()}function Pr(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new Nle(t);typeof e=="string"&&xle(e,r),n_.set(t,r)}function Jc(e){"@babel/helpers - typeof";return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}function Hle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jle(n.key),n)}}function Lle(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jle(e){var t=Fle(e,"string");return Jc(t)==="symbol"?t:String(t)}function Fle(e,t){if(Jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cg=0,Ble=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Hle(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Lle(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,Vle(s))}return typeof a!="boolean"&&!GV()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),cg+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),cg-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),cg-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function Vle(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),bn(this)},e}const Pt=Ble;function Wle(){return cg}function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}function Ule(e,t){return Kle(e)||Gle(e,t)||Yle(e,t)||zle()}function zle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yle(e,t){if(e){if(typeof e=="string")return EA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EA(e,t)}}function EA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Kle(e){if(Array.isArray(e))return e}function qle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zle(n.key),n)}}function Xle(e,t,r){return t&&TA(e.prototype,t),r&&TA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zle(e){var t=Qle(e,"string");return eh(t)==="symbol"?t:String(t)}function Qle(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wm="editorManager.navigation",$c="editorManager.handlingEditor",o_=function(){function e(t,r,n){var o=this;qle(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Pt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return Xle(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:$c};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),bn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=Ule(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&Vm(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=yW(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!RE(o)&&!LV(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ve(n.instance.getSelected())},group:Wm};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),PA=new WeakMap;o_.getInstance=function(e,t,r){var n=PA.get(e);return n||(n=new o_(e,t,r),PA.set(e,n)),n};const Jle=o_;var ese="hooksRefRegisterer",gW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;A(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;ze(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Gn(gW,"MIXIN_NAME",ese,{writable:!1,enumerable:!1});const tse=gW;function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function rse(e,t){return ase(e)||ise(e,t)||ose(e,t)||nse()}function nse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ose(e,t){if(e){if(typeof e=="string")return kA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kA(e,t)}}function kA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ise(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ase(e){if(Array.isArray(e))return e}function lse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i_(e,t)}function i_(e,t){return i_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},i_(e,t)}function sse(e){var t=cse();return function(){var n=rp(e),o;if(t){var i=rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return use(this,o)}}function use(e,t){if(t&&(bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fse(e)}function fse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(e)}function $A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hse(n.key),n)}}function IA(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hse(e){var t=dse(e,"string");return bs(t)==="symbol"?t:String(t)}function dse(e,t){if(bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vse="base",tr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),a_="baseEditor",$f=function(){function e(t){$A(this,e),this.hot=t,this.instance=t,this.state=tr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return IA(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=tr.VIRGIN}},{key:"extend",value:function(){return function(r){lse(o,r);var n=sse(o);function o(){return $A(this,o),n.apply(this,arguments)}return IA(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=rse(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),y={runOnlyIf:function(){return ve(o.hot.getSelected())},group:a_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===tr.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=tr.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:xt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(a_),u.removeShortcutsByGroup(Wm),this.state===tr.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===tr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=tr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=tr.FINISHED,i.discardEditor(c)}):(this.state=tr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=tr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===tr.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=tr.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=tr.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===tr.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Wt(n),u=ct(n),f=Wt(this.hot.rootElement),c=ct(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,y=d!==l?d.scrollLeft:0,m=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,C=S.name,k=["master","inline_start"].includes(C)?v:0,O=["master","top","bottom"].includes(C)?y:0,W=s.top===f.top?0:1,Y=s.top-f.top-W-k,q=0;this.hot.isRtl()?q=l.innerWidth-s.left-u-m-1+O:q=s.left-f.left-1-O,["top","top_inline_start_corner"].includes(C)&&(Y+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(q+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var G=this.hot.hasColHeaders(),X=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),oe=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=oe-this.hot.view._wt.getSetting("fixedRowsBottom");(G&&X<=0||X===J)&&(Y+=1),Q<=0&&(q+=1);var ue=a.rowsRenderCalculator.startPosition,he=a.columnsRenderCalculator.startPosition,Oe=Math.abs(i.inlineStartOverlay.getScrollPosition()),we=i.topOverlay.getScrollPosition(),$=Jt(this.hot.rootDocument),P=n.offsetTop+ue-we,g=0;if(this.hot.isRtl()){var p=n.offsetLeft;p>=0?g=S.getWidth()-n.offsetLeft:g=Math.abs(p),g+=he-Oe-u}else g=n.offsetLeft+he-Oe;var b=Ai(this.TD,this.hot.rootWindow),E=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",R=parseInt(b[E],10)>0?0:1,F=parseInt(b.borderTopWidth,10)>0?0:1,x=ct(n)+R,K=Tt(n)+F,Z=rW(h)?$:0,re=nW(d)?$:0,ie=this.hot.view.maximumVisibleElementWidth(g)-Z+R,se=Math.max(this.hot.view.maximumVisibleElementHeight(P)-re+F,23);return{top:Y,start:q,height:K,maxHeight:se,width:x,maxWidth:ie}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return vse}}]),e}();gt($f,tse);var yse=$e,gse=ol.map,pse=dv,mse=pse("map");yse({target:"Array",proto:!0,forced:!mse},{map:function(t){return gse(this,t,arguments.length>1?arguments[1]:void 0)}});function bse(e){return _se(e)||Cse(e)||Sse(e)||wse()}function wse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sse(e,t){if(e){if(typeof e=="string")return l_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l_(e,t)}}function Cse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _se(e){if(Array.isArray(e))return l_(e)}function l_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s_(e){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function wr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=s_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(bse(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function pW(e){return wr(e,[","])}function Ce(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function np(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function jE(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const Ose=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:wr,isNumericLike:pW,rangeEach:Ce,rangeEachReverse:np,valueAccordingPercent:jE},Symbol.toStringTag,{value:"Module"}));function Rse(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,y){d.addEventListener(v,y,!1)},a=function(d,v,y){d.removeEventListener(v,y,!1)},l=function(d){var v,y;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(d.maxHeight);isNaN(y)||(e.maxHeight=y)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(d.minWidth);isNaN(m)||(e.minWidth=m)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,y){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,y){f(d,v,y)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function MA(e,t){for(var r=ME(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}Ov(t,o)}function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function xA(e,t){return kse(e)||Pse(e,t)||Tse(e,t)||Ese()}function Ese(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tse(e,t){if(e){if(typeof e=="string")return DA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DA(e,t)}}function DA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kse(e){if(Array.isArray(e))return e}function $se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ise(n.key),n)}}function Ase(e,t,r){return t&&NA(e.prototype,t),r&&NA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ise(e){var t=Mse(e,"string");return ws(t)==="symbol"?t:String(t)}function Mse(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ac(){return typeof Reflect<"u"&&Reflect.get?Ac=Reflect.get.bind():Ac=function(t,r,n){var o=xse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ac.apply(this,arguments)}function xse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Va(e),e!==null););return e}function Dse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u_(e,t)}function u_(e,t){return u_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u_(e,t)}function Nse(e){var t=Lse();return function(){var n=Va(e),o;if(t){var i=Va(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hse(this,o)}}function Hse(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mW(e)}function mW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(e){return Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Va(e)}var jse="ht_editor_visible",cy="ht_editor_hidden",HA="textEditor",Fse="text",sl=function(e){Dse(r,e);var t=Nse(r);function r(n){var o;return $se(this,r),o=t.call(this,n),o.eventManager=new Pt(mW(o)),o.autoResize=Rse(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return Ase(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(Ac(Va(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==tr.FINISHED&&this.hideEditableElement();var d=!h;d&&!gn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===tr.VIRGIN&&(this.TEXTAREA.value="",Ac(Va(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),Ov(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,cy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(DV()||xV())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,cy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Ce(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,cy)&&Le(this.TEXTAREA_PARENT,cy),i?(this.layerClass=jse,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==tr.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ai(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ai(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),y=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),m=s-v,w=f-y,S=u-v,C=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,S),minHeight:Math.min(w,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),_E()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ve(o.hot.getSelected())},group:HA},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:$c,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:$c,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:$c,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=xA(c,1),d=h[0];MA(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=xA(c,1),d=h[0];MA(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Wm),i.removeShortcutsByGroup(HA),i.removeShortcutsByGroup(a_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[me.ARROW_UP,me.ARROW_RIGHT,me.ARROW_DOWN,me.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return Fse}}]),r}($f);function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function Bse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wse(n.key),n)}}function Vse(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wse(e){var t=Use(e,"string");return Ss(t)==="symbol"?t:String(t)}function Use(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cn(){return typeof Reflect<"u"&&Reflect.get?cn=Reflect.get.bind():cn=function(t,r,n){var o=zse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cn.apply(this,arguments)}function zse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fr(e),e!==null););return e}function Yse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f_(e,t)}function f_(e,t){return f_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},f_(e,t)}function Gse(e){var t=Xse();return function(){var n=Fr(e),o;if(t){var i=Fr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kse(this,o)}}function Kse(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qse(e)}function qse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fr(e)}var jA="handsontableEditor",Zse="handsontable",FE=function(e){Yse(r,e);var t=Gse(r);function r(){return Bse(this,r),t.apply(this,arguments)}return Vse(r,[{key:"open",value:function(){cn(Fr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Ov(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),cn(Fr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){cn(Fr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var y=this.getSourceData(v.row,v.col);y!==void 0&&f.setValue(y),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ut(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||cn(Fr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){cn(Fr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}cn(Fr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");cn(Fr(r.prototype),"registerShortcuts",this).call(this);var l={group:jA,relativeToGroup:Wm,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),bn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){cn(Fr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(jA)}}],[{key:"EDITOR_TYPE",get:function(){return Zse}}]),r}(sl),Qse="base";function Af(e,t,r,n,o,i,a){var l=[],s=[];a.className&&te(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Le(t,s),te(t,l)}Af.RENDERER_TYPE=Qse;var Jse="text";function Ni(e,t,r,n,o,i,a){Af.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=xt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Sn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else $i(t,l)}Ni.RENDERER_TYPE=Jse;function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function eue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bW(n.key),n)}}function tue(e,t,r){return t&&FA(e.prototype,t),r&&FA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ua(){return typeof Reflect<"u"&&Reflect.get?ua=Reflect.get.bind():ua=function(t,r,n){var o=rue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ua.apply(this,arguments)}function rue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function nue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c_(e,t)}function c_(e,t){return c_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},c_(e,t)}function oue(e){var t=aue();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iue(this,o)}}function iue(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h_(e)}function h_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}function lue(e,t,r){return t=bW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bW(e){var t=sue(e,"string");return Cs(t)==="symbol"?t:String(t)}function sue(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $w=new WeakMap,uue="autocomplete",BE=function(e){nue(r,e);var t=oue(r);function r(n){var o;return eue(this,r),o=t.call(this,n),lue(h_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,y;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=XC(xt(a[v])),l)y=d.indexOf(i);else{var m=this.cellProperties.locale;y=d.toLocaleLowerCase(m).indexOf(i.toLocaleLowerCase(m))}y!==-1&&(h=d.length-y-f,s.push({baseIndex:v,index:y,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],$w.set(h_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return tue(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ve(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){ua(ho(r.prototype),"createElements",this).call(this),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=$w.get(this);ua(ho(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Jt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[ct(this.TEXTAREA)-2]:void 0,width:l?ct(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,y,m){Ni(f,c,h,d,v,y,m);var w=o.cellProperties,S=w.filteringCaseSensitive,C=w.allowHtml,k=w.locale,O=o.query,W=xt(y),Y,q;W&&!C&&(Y=S===!0?W.indexOf(O):W.toLocaleLowerCase(k).indexOf(O.toLocaleLowerCase(k)),Y!==-1&&(q=W.substr(Y,O.length),W=W.replace(q,"<strong>".concat(q,"</strong>")))),c.innerHTML=W},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),ua(ho(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){ua(ho(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=ME(this.TEXTAREA),a=eW(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,y=c.length;v<y&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Ec([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),Ov(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Ba(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Wt(this.TEXTAREA),s=Tt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Tt(this.hot.view._wt.wtTable.THEAD),h=Wt(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,y=u>v&&d>v;return y?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(y?d:v,u),y}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=We(o,function(s){return xt(s)}),l=We(a,function(s){return i?s:XC(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===me.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===me.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=$w.get(this);if(a.skipOne=!1,HV(o.keyCode)||o.keyCode===me.BACKSPACE||o.keyCode===me.DELETE||o.keyCode===me.INSERT){var l=10;if(o.keyCode===me.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return uue}}]),r}(FE);function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function fue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hue(n.key),n)}}function cue(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hue(e){var t=due(e,"string");return _s(t)==="symbol"?t:String(t)}function due(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d_(e,t)}function d_(e,t){return d_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},d_(e,t)}function yue(e){var t=mue();return function(){var n=op(e),o;if(t){var i=op(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gue(this,o)}}function gue(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pue(e)}function pue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function op(e){return op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},op(e)}var bue="checkbox",wW=function(e){vue(r,e);var t=yue(r);function r(){return fue(this,r),t.apply(this,arguments)}return cue(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return bue}}]),r}($f),SW={exports:{}};const wue=DY(gne);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=wue}catch{}e.exports=n(o)}})(Xy,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function($,P,g,p){o?$.addEventListener(P,g,!!p):$.attachEvent("on"+P,g)},s=function($,P,g,p){o?$.removeEventListener(P,g,!!p):$.detachEvent("on"+P,g)},u=function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},f=function($,P){return(" "+$.className+" ").indexOf(" "+P+" ")!==-1},c=function($,P){f($,P)||($.className=$.className===""?P:$.className+" "+P)},h=function($,P){$.className=u((" "+$.className+" ").replace(" "+P+" "," "))},d=function($){return/Array/.test(Object.prototype.toString.call($))},v=function($){return/Date/.test(Object.prototype.toString.call($))&&!isNaN($.getTime())},y=function($){var P=$.getDay();return P===0||P===6},m=function($){return $%4===0&&$%100!==0||$%400===0},w=function($,P){return[31,m($)?29:28,31,30,31,30,31,31,30,31,30,31][P]},S=function($){v($)&&$.setHours(0,0,0,0)},C=function($,P){return $.getTime()===P.getTime()},k=function($,P,g){var p,b;for(p in P)b=$[p]!==void 0,b&&typeof P[p]=="object"&&P[p]!==null&&P[p].nodeName===void 0?v(P[p])?g&&($[p]=new Date(P[p].getTime())):d(P[p])?g&&($[p]=P[p].slice(0)):$[p]=k({},P[p],g):(g||!b)&&($[p]=P[p]);return $},O=function($,P,g){var p;i.createEvent?(p=i.createEvent("HTMLEvents"),p.initEvent(P,!0,!1),p=k(p,g),$.dispatchEvent(p)):i.createEventObject&&(p=i.createEventObject(),p=k(p,g),$.fireEvent("on"+P,p))},W=function($){return $.month<0&&($.year-=Math.ceil(Math.abs($.month)/12),$.month+=12),$.month>11&&($.year+=Math.floor(Math.abs($.month)/12),$.month-=12),$},Y={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},q=function($,P,g){for(P+=$.firstDay;P>=7;)P-=7;return g?$.i18n.weekdaysShort[P]:$.i18n.weekdays[P]},G=function($){var P=[],g="false";if($.isEmpty)if($.showDaysInNextAndPreviousMonths)P.push("is-outside-current-month"),$.enableSelectionDaysInNextAndPreviousMonths||P.push("is-selection-disabled");else return'<td class="is-empty"></td>';return $.isDisabled&&P.push("is-disabled"),$.isToday&&P.push("is-today"),$.isSelected&&(P.push("is-selected"),g="true"),$.hasEvent&&P.push("has-event"),$.isInRange&&P.push("is-inrange"),$.isStartRange&&P.push("is-startrange"),$.isEndRange&&P.push("is-endrange"),'<td data-day="'+$.day+'" class="'+P.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+$.year+'" data-pika-month="'+$.month+'" data-pika-day="'+$.day+'">'+$.day+"</button></td>"},X=function($,P){$.setHours(0,0,0,0);var g=$.getDate(),p=$.getDay(),b=P,E=b-1,R=7,F=function(ie){return(ie+R-1)%R};$.setDate(g+E-F(p));var x=new Date($.getFullYear(),0,b),K=24*60*60*1e3,Z=($.getTime()-x.getTime())/K,re=1+Math.round((Z-E+F(x.getDay()))/R);return re},Q=function($,P,g,p){var b=new Date(g,P,$),E=n?r(b).isoWeek():X(b,p);return'<td class="pika-week">'+E+"</td>"},oe=function($,P,g,p){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(P?$.reverse():$).join("")+"</tr>"},J=function($){return"<tbody>"+$.join("")+"</tbody>"},ue=function($){var P,g=[];for($.showWeekNumber&&g.push("<th></th>"),P=0;P<7;P++)g.push('<th scope="col"><abbr title="'+q($,P)+'">'+q($,P,!0)+"</abbr></th>");return"<thead><tr>"+($.isRTL?g.reverse():g).join("")+"</tr></thead>"},he=function($,P,g,p,b,E){var R,F,x,K=$._o,Z=g===K.minYear,re=g===K.maxYear,ie='<div id="'+E+'" class="pika-title" role="heading" aria-live="assertive">',se,_e,Se=!0,U=!0;for(x=[],R=0;R<12;R++)x.push('<option value="'+(g===b?R-P:12+R-P)+'"'+(R===p?' selected="selected"':"")+(Z&&R<K.minMonth||re&&R>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[R]+"</option>");for(se='<div class="pika-label">'+K.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+x.join("")+"</select></div>",d(K.yearRange)?(R=K.yearRange[0],F=K.yearRange[1]+1):(R=g-K.yearRange,F=1+g+K.yearRange),x=[];R<F&&R<=K.maxYear;R++)R>=K.minYear&&x.push('<option value="'+R+'"'+(R===g?' selected="selected"':"")+">"+R+"</option>");return _e='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+x.join("")+"</select></div>",K.showMonthAfterYear?ie+=_e+se:ie+=se+_e,Z&&(p===0||K.minMonth>=p)&&(Se=!1),re&&(p===11||K.maxMonth<=p)&&(U=!1),P===0&&(ie+='<button class="pika-prev'+(Se?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),P===$._o.numberOfMonths-1&&(ie+='<button class="pika-next'+(U?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),ie+="</div>"},Oe=function($,P,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ue($)+J(P)+"</table>"},we=function($){var P=this,g=P.config($);P._onMouseDown=function(b){if(P._v){b=b||window.event;var E=b.target||b.srcElement;if(E)if(f(E,"is-disabled")||(f(E,"pika-button")&&!f(E,"is-empty")&&!f(E.parentNode,"is-disabled")?(P.setDate(new Date(E.getAttribute("data-pika-year"),E.getAttribute("data-pika-month"),E.getAttribute("data-pika-day"))),g.bound&&a(function(){P.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):f(E,"pika-prev")?P.prevMonth():f(E,"pika-next")&&P.nextMonth()),f(E,"pika-select"))P._c=!0;else if(b.preventDefault)b.preventDefault();else return b.returnValue=!1,!1}},P._onChange=function(b){b=b||window.event;var E=b.target||b.srcElement;E&&(f(E,"pika-select-month")?P.gotoMonth(E.value):f(E,"pika-select-year")&&P.gotoYear(E.value))},P._onKeyChange=function(b){if(b=b||window.event,P.isVisible())switch(b.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:P.adjustDate("subtract",1);break;case 38:P.adjustDate("subtract",7);break;case 39:P.adjustDate("add",1);break;case 40:P.adjustDate("add",7);break;case 8:case 46:P.setDate(null);break}},P._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var b=r(g.field.value,g.format,g.formatStrict);return b&&b.isValid()?b.toDate():null}else return new Date(Date.parse(g.field.value))},P._onInputChange=function(b){var E;b.firedBy!==P&&(E=P._parseFieldValue(),v(E)&&P.setDate(E),P._v||P.show())},P._onInputFocus=function(){P.show()},P._onInputClick=function(){P.show()},P._onInputBlur=function(){var b=i.activeElement;do if(f(b,"pika-single"))return;while(b=b.parentNode);P._c||(P._b=a(function(){P.hide()},50)),P._c=!1},P._onClick=function(b){b=b||window.event;var E=b.target||b.srcElement,R=E;if(E){!o&&f(E,"pika-select")&&(E.onchange||(E.setAttribute("onchange","return;"),l(E,"change",P._onChange)));do if(f(R,"pika-single")||R===g.trigger)return;while(R=R.parentNode);P._v&&E!==g.trigger&&R!==g.trigger&&P.hide()}},P.el=i.createElement("div"),P.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),l(P.el,"mousedown",P._onMouseDown,!0),l(P.el,"touchend",P._onMouseDown,!0),l(P.el,"change",P._onChange),g.keyboardInput&&l(i,"keydown",P._onKeyChange),g.field&&(g.container?g.container.appendChild(P.el):g.bound?i.body.appendChild(P.el):g.field.parentNode.insertBefore(P.el,g.field.nextSibling),l(g.field,"change",P._onInputChange),g.defaultDate||(g.defaultDate=P._parseFieldValue(),g.setDefaultDate=!0));var p=g.defaultDate;v(p)?g.setDefaultDate?P.setDate(p,!0):P.gotoDate(p):P.gotoDate(new Date),g.bound?(this.hide(),P.el.className+=" is-bound",l(g.trigger,"click",P._onInputClick),l(g.trigger,"focus",P._onInputFocus),l(g.trigger,"blur",P._onInputBlur)):this.show()};return we.prototype={config:function($){this._o||(this._o=k({},Y,!0));var P=k(this._o,$,!0);P.isRTL=!!P.isRTL,P.field=P.field&&P.field.nodeName?P.field:null,P.theme=typeof P.theme=="string"&&P.theme?P.theme:null,P.bound=!!(P.bound!==void 0?P.field&&P.bound:P.field),P.trigger=P.trigger&&P.trigger.nodeName?P.trigger:P.field,P.disableWeekends=!!P.disableWeekends,P.disableDayFn=typeof P.disableDayFn=="function"?P.disableDayFn:null;var g=parseInt(P.numberOfMonths,10)||1;if(P.numberOfMonths=g>4?4:g,v(P.minDate)||(P.minDate=!1),v(P.maxDate)||(P.maxDate=!1),P.minDate&&P.maxDate&&P.maxDate<P.minDate&&(P.maxDate=P.minDate=!1),P.minDate&&this.setMinDate(P.minDate),P.maxDate&&this.setMaxDate(P.maxDate),d(P.yearRange)){var p=new Date().getFullYear()-10;P.yearRange[0]=parseInt(P.yearRange[0],10)||p,P.yearRange[1]=parseInt(P.yearRange[1],10)||p}else P.yearRange=Math.abs(parseInt(P.yearRange,10))||Y.yearRange,P.yearRange>100&&(P.yearRange=100);return P},toString:function($){return $=$||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,$):n?r(this._d).format($):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function($,P){n&&r.isMoment($)&&this.setDate($.toDate(),P)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function($,P){if(!$)return this._d=null,this._o.field&&(this._o.field.value="",O(this._o.field,"change",{firedBy:this})),this.draw();if(typeof $=="string"&&($=new Date(Date.parse($))),!!v($)){var g=this._o.minDate,p=this._o.maxDate;v(g)&&$<g?$=g:v(p)&&$>p&&($=p),this._d=new Date($.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),O(this._o.field,"change",{firedBy:this})),!P&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function($){var P=!0;if(v($)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),b=$.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),P=b<g.getTime()||p.getTime()<b}P&&(this.calendars=[{month:$.getMonth(),year:$.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function($,P){var g=this.getDate()||new Date,p=parseInt(P)*24*60*60*1e3,b;$==="add"?b=new Date(g.valueOf()+p):$==="subtract"&&(b=new Date(g.valueOf()-p)),this.setDate(b)},adjustCalendars:function(){this.calendars[0]=W(this.calendars[0]);for(var $=1;$<this._o.numberOfMonths;$++)this.calendars[$]=W({month:this.calendars[0].month+$,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function($){isNaN($)||(this.calendars[0].month=parseInt($,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function($){isNaN($)||(this.calendars[0].year=parseInt($,10),this.adjustCalendars())},setMinDate:function($){$ instanceof Date?(S($),this._o.minDate=$,this._o.minYear=$.getFullYear(),this._o.minMonth=$.getMonth()):(this._o.minDate=Y.minDate,this._o.minYear=Y.minYear,this._o.minMonth=Y.minMonth,this._o.startRange=Y.startRange),this.draw()},setMaxDate:function($){$ instanceof Date?(S($),this._o.maxDate=$,this._o.maxYear=$.getFullYear(),this._o.maxMonth=$.getMonth()):(this._o.maxDate=Y.maxDate,this._o.maxYear=Y.maxYear,this._o.maxMonth=Y.maxMonth,this._o.endRange=Y.endRange),this.draw()},setStartRange:function($){this._o.startRange=$},setEndRange:function($){this._o.endRange=$},draw:function($){if(!(!this._v&&!$)){var P=this._o,g=P.minYear,p=P.maxYear,b=P.minMonth,E=P.maxMonth,R="",F;this._y<=g&&(this._y=g,!isNaN(b)&&this._m<b&&(this._m=b)),this._y>=p&&(this._y=p,!isNaN(E)&&this._m>E&&(this._m=E));for(var x=0;x<P.numberOfMonths;x++)F="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),R+='<div class="pika-lendar">'+he(this,x,this.calendars[x].year,this.calendars[x].month,this.calendars[0].year,F)+this.render(this.calendars[x].year,this.calendars[x].month,F)+"</div>";this.el.innerHTML=R,P.bound&&P.field.type!=="hidden"&&a(function(){P.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),P.bound&&P.field.setAttribute("aria-label",P.ariaLabel)}},adjustPosition:function(){var $,P,g,p,b,E,R,F,x,K,Z,re;if(!this._o.container){if(this.el.style.position="absolute",$=this._o.trigger,P=$,g=this.el.offsetWidth,p=this.el.offsetHeight,b=window.innerWidth||i.documentElement.clientWidth,E=window.innerHeight||i.documentElement.clientHeight,R=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Z=!0,re=!0,typeof $.getBoundingClientRect=="function")K=$.getBoundingClientRect(),F=K.left+window.pageXOffset,x=K.bottom+window.pageYOffset;else for(F=P.offsetLeft,x=P.offsetTop+P.offsetHeight;P=P.offsetParent;)F+=P.offsetLeft,x+=P.offsetTop;(this._o.reposition&&F+g>b||this._o.position.indexOf("right")>-1&&F-g+$.offsetWidth>0)&&(F=F-g+$.offsetWidth,Z=!1),(this._o.reposition&&x+p>E+R||this._o.position.indexOf("top")>-1&&x-p-$.offsetHeight>0)&&(x=x-p-$.offsetHeight,re=!1),this.el.style.left=F+"px",this.el.style.top=x+"px",c(this.el,Z?"left-aligned":"right-aligned"),c(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,Z?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function($,P,g){var p=this._o,b=new Date,E=w($,P),R=new Date($,P,1).getDay(),F=[],x=[];S(b),p.firstDay>0&&(R-=p.firstDay,R<0&&(R+=7));for(var K=P===0?11:P-1,Z=P===11?0:P+1,re=P===0?$-1:$,ie=P===11?$+1:$,se=w(re,K),_e=E+R,Se=_e;Se>7;)Se-=7;_e+=7-Se;for(var U=!1,Ne=0,Be=0;Ne<_e;Ne++){var ke=new Date($,P,1+(Ne-R)),Ie=v(this._d)?C(ke,this._d):!1,Ae=C(ke,b),_=p.events.indexOf(ke.toDateString())!==-1,T=Ne<R||Ne>=E+R,I=1+(Ne-R),j=P,M=$,B=p.startRange&&C(p.startRange,ke),N=p.endRange&&C(p.endRange,ke),D=p.startRange&&p.endRange&&p.startRange<ke&&ke<p.endRange,V=p.minDate&&ke<p.minDate||p.maxDate&&ke>p.maxDate||p.disableWeekends&&y(ke)||p.disableDayFn&&p.disableDayFn(ke);T&&(Ne<R?(I=se+I,j=K,M=re):(I=I-E,j=Z,M=ie));var L={day:I,month:j,year:M,hasEvent:_,isSelected:Ie,isToday:Ae,isDisabled:V,isEmpty:T,isStartRange:B,isEndRange:N,isInRange:D,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&Ie&&(U=!0),x.push(G(L)),++Be===7&&(p.showWeekNumber&&x.unshift(Q(Ne-R,P,$,p.firstWeekOfYearMinDays)),F.push(oe(x,p.isRTL,p.pickWholeWeek,U)),x=[],Be=0,U=!1)}return Oe(p,F,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var $=this._v;$!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,$!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var $=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),$.keyboardInput&&s(i,"keydown",this._onKeyChange),$.field&&(s($.field,"change",this._onInputChange),$.bound&&(s($.trigger,"click",this._onInputClick),s($.trigger,"focus",this._onInputFocus),s($.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},we})})(SW);var Sue=SW.exports;const VA=lj(Sue);function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function Cue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oue(n.key),n)}}function _ue(e,t,r){return t&&WA(e.prototype,t),r&&WA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oue(e){var t=Rue(e,"string");return Os(t)==="symbol"?t:String(t)}function Rue(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lo(){return typeof Reflect<"u"&&Reflect.get?lo=Reflect.get.bind():lo=function(t,r,n){var o=Eue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},lo.apply(this,arguments)}function Eue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dn(e),e!==null););return e}function Tue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v_(e,t)}function v_(e,t){return v_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},v_(e,t)}function Pue(e){var t=Aue();return function(){var n=dn(e),o;if(t){var i=dn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kue(this,o)}}function kue(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $ue(e)}function $ue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dn(e){return dn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dn(e)}var CW="date",UA="dateEditor",_W=function(e){Tue(r,e);var t=Pue(r);function r(n){var o;return Cue(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return _ue(r,[{key:"init",value:function(){var o=this;if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof VA!="function")throw new Error("You need to include Pikaday to your project.");lo(dn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){lo(dn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new Pt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){lo(dn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");lo(dn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:UA})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(UA),lo(dn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}lo(dn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?RE(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new VA(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Tt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-ct(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Cv(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ee(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return CW}}]),r}(sl);function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function Iue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xue(n.key),n)}}function Mue(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xue(e){var t=Due(e,"string");return Rs(t)==="symbol"?t:String(t)}function Due(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hg(){return typeof Reflect<"u"&&Reflect.get?hg=Reflect.get.bind():hg=function(t,r,n){var o=Nue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hg.apply(this,arguments)}function Nue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Es(e),e!==null););return e}function Hue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},y_(e,t)}function Lue(e){var t=Bue();return function(){var n=Es(e),o;if(t){var i=Es(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jue(this,o)}}function jue(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fue(e)}function Fue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Es(e){return Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Es(e)}var Vue="dropdown",VE=function(e){Hue(r,e);var t=Lue(r);function r(){return Iue(this,r),t.apply(this,arguments)}return Mue(r,[{key:"prepare",value:function(o,i,a,l,s,u){hg(Es(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Vue}}]),r}(BE);ge.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===VE&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function Wue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zue(n.key),n)}}function Uue(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zue(e){var t=Yue(e,"string");return Ts(t)==="symbol"?t:String(t)}function Yue(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g_(e,t)}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},g_(e,t)}function Kue(e){var t=Zue();return function(){var n=ip(e),o;if(t){var i=ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return que(this,o)}}function que(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xue(e)}function Xue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ip(e){return ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ip(e)}var Que="numeric",OW=function(e){Gue(r,e);var t=Kue(r);function r(){return Wue(this,r),t.apply(this,arguments)}return Uue(r,null,[{key:"EDITOR_TYPE",get:function(){return Que}}]),r}(sl);function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function Jue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tfe(n.key),n)}}function efe(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tfe(e){var t=rfe(e,"string");return Ps(t)==="symbol"?t:String(t)}function rfe(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dg(){return typeof Reflect<"u"&&Reflect.get?dg=Reflect.get.bind():dg=function(t,r,n){var o=nfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dg.apply(this,arguments)}function nfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ks(e),e!==null););return e}function ofe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},p_(e,t)}function ife(e){var t=sfe();return function(){var n=ks(e),o;if(t){var i=ks(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return afe(this,o)}}function afe(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lfe(e)}function lfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ks(e){return ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ks(e)}var ufe="password",RW=function(e){ofe(r,e);var t=ife(r);function r(){return Jue(this,r),t.apply(this,arguments)}return efe(r,[{key:"createElements",value:function(){dg(ks(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Sn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return ufe}}]),r}(sl);function Wa(e){"@babel/helpers - typeof";return Wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wa(e)}function ffe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hfe(n.key),n)}}function cfe(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hfe(e){var t=dfe(e,"string");return Wa(t)==="symbol"?t:String(t)}function dfe(e,t){if(Wa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vg(){return typeof Reflect<"u"&&Reflect.get?vg=Reflect.get.bind():vg=function(t,r,n){var o=vfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vg.apply(this,arguments)}function vfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$s(e),e!==null););return e}function yfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function gfe(e){var t=bfe();return function(){var n=$s(e),o;if(t){var i=$s(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pfe(this,o)}}function pfe(e,t){if(t&&(Wa(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mfe(e)}function mfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $s(e){return $s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$s(e)}var Aw="ht_editor_visible",qA="selectEditor",wfe="select",Sfe=function(e){yfe(r,e);var t=gfe(r);function r(){return ffe(this,r),t.apply(this,arguments)}return cfe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,Aw)&&Le(this.select,Aw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;vg($s(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),Sn(this.select),ze(h,function(d,v){var y=f.hot.rootDocument.createElement("OPTION");y.value=v,ll(y,d),f.select.appendChild(y)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Wa(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===tr.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",te(this.select,Aw)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:qA};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(qA)}}],[{key:"EDITOR_TYPE",get:function(){return wfe}}]),r}($f);function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function Cfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ofe(n.key),n)}}function _fe(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ofe(e){var t=Rfe(e,"string");return As(t)==="symbol"?t:String(t)}function Rfe(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yg(){return typeof Reflect<"u"&&Reflect.get?yg=Reflect.get.bind():yg=function(t,r,n){var o=Efe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},yg.apply(this,arguments)}function Efe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Is(e),e!==null););return e}function Tfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b_(e,t)}function b_(e,t){return b_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},b_(e,t)}function Pfe(e){var t=Afe();return function(){var n=Is(e),o;if(t){var i=Is(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kfe(this,o)}}function kfe(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $fe(e)}function $fe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Afe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Is(e){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Is(e)}var Ife="time",EW=function(e){Tfe(r,e);var t=Pfe(r);function r(){return Cfe(this,r),t.apply(this,arguments)}return _fe(r,[{key:"prepare",value:function(o,i,a,l,s,u){yg(Is(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return Ife}}]),r}(sl);function Mfe(){Pr($f),Pr(BE),Pr(wW),Pr(_W),Pr(VE),Pr(FE),Pr(OW),Pr(RW),Pr(Sfe),Pr(sl),Pr(EW)}var xfe="html";function WE(e,t,r,n,o,i,a){Af.apply(this,[e,t,r,n,o,i,a]),ll(t,i??"",!1)}WE.RENDERER_TYPE=xfe;var Dfe="autocomplete";function If(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?WE:Ni,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),te(t,"htAutocomplete"),!e.acArrowListener){var f=new Pt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}If.RENDERER_TYPE=Dfe;var ZA=new WeakMap,QA=new WeakMap,Nfe="htBadValue",Ms="data-row",xs="data-col",Hfe="checkboxRenderer",TW="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===TW){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function UE(e,t,r,n,o,i,a){var l=e.rootDocument;Af.apply(this,[e,t,r,n,o,i,a]),Lfe(e);var s=jfe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Sn(t),i===a.checkedTemplate||xt(i).toLocaleLowerCase(a.locale)===xt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||xt(i).toLocaleLowerCase(a.locale)===xt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:qt(i)?te(s,"noValue"):(s.style.display="none",te(s,Nfe),f=!0),s.setAttribute(Ms,r),s.setAttribute(xs,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=Ffe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),ZA.has(e)||(ZA.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),C={group:Hfe};S.addShortcuts([{keys:[["space"]],callback:function(){return y(),!m()}},{keys:[["enter"]],callback:function(){return y(),!m()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!m()},relativeToGroup:$c,position:"before"}],C)}function y(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var k=S[C].getTopStartCorner(),O=k.row,W=k.col,Y=S[C].getBottomEndCorner(),q=Y.row,G=Y.col,X=[],Q=O;Q<=q;Q+=1)for(var oe=W;oe<=G;oe+=1){var J=e.getCellMeta(Q,oe);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var ue=e.getDataAtCell(Q,oe);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ue)?X.push([Q,oe,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ue)&&X.push([Q,oe,J.checkedTemplate]):X.push([Q,oe,J.uncheckedTemplate])}}X.length>0&&e.setDataAtCell(X)}}function m(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var C=w[S].getTopStartCorner(),k=w[S].getBottomEndCorner(),O=C.row;O<=k.row;O++)for(var W=C.col;W<=k.col;W++){var Y=e.getCellMeta(O,W);if(Y.type!=="checkbox")return!1;var q=e.getCell(O,W);if(q==null)return!0;var G=q.querySelectorAll("input[type=checkbox]");if(G.length>0&&!Y.readOnly)return!0}return!1}}}UE.RENDERER_TYPE=TW;function Lfe(e){var t=QA.get(e);if(!t){var r=e.rootElement;t=new Pt(e),t.addEventListener(r,"click",function(n){return Vfe(n,e)}),t.addEventListener(r,"mouseup",function(n){return Bfe(n,e)}),t.addEventListener(r,"change",function(n){return Wfe(n,e)}),QA.set(e,t)}return t}function jfe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function Ffe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function Bfe(e,t){var r=e.target;zE(r)&&(!r.hasAttribute(Ms)||!r.hasAttribute(xs)||setTimeout(t.listen,10))}function Vfe(e,t){var r=e.target;if(zE(r)&&!(!r.hasAttribute(Ms)||!r.hasAttribute(xs))){var n=parseInt(r.getAttribute(Ms),10),o=parseInt(r.getAttribute(xs),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function Wfe(e,t){var r=e.target;if(zE(r)&&!(!r.hasAttribute(Ms)||!r.hasAttribute(xs))){var n=parseInt(r.getAttribute(Ms),10),o=parseInt(r.getAttribute(xs),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function zE(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function hy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var PW={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof hy=="function"&&hy;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof hy=="function"&&hy,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function S(G){var X=0|G;return 0<G||G===X?X:X-1}function C(G){for(var X,Q,oe=1,J=G.length,ue=G[0]+"";oe<J;){for(X=G[oe++]+"",Q=d-X.length;Q--;X="0"+X);ue+=X}for(J=ue.length;ue.charCodeAt(--J)===48;);return ue.slice(0,J+1||1)}function k(G,X){var Q,oe,J=G.c,ue=X.c,he=G.s,Oe=X.s,we=G.e,$=X.e;if(!he||!Oe)return null;if(Q=J&&!J[0],oe=ue&&!ue[0],Q||oe)return Q?oe?0:-Oe:he;if(he!=Oe)return he;if(Q=he<0,oe=we==$,!J||!ue)return oe?0:!J^Q?1:-1;if(!oe)return $<we^Q?1:-1;for(Oe=(we=J.length)<($=ue.length)?we:$,he=0;he<Oe;he++)if(J[he]!=ue[he])return J[he]>ue[he]^Q?1:-1;return we==$?0:$<we^Q?1:-1}function O(G,X,Q,oe){if(G<X||Q<G||G!==(G<0?s(G):u(G)))throw Error(f+(oe||"Argument")+(typeof G=="number"?G<X||Q<G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(G))}function W(G){var X=G.c.length-1;return S(G.e/d)==X&&G.c[X]%2!=0}function Y(G,X){return(1<G.length?G.charAt(0)+"."+G.slice(1):G)+(X<0?"e":"e+")+X}function q(G,X,Q){var oe,J;if(X<0){for(J=Q+".";++X;J+=Q);G=J+G}else if(++X>(oe=G.length)){for(J=Q,X-=oe;--X;J+=Q);G+=J}else X<oe&&(G=G.slice(0,X)+"."+G.slice(X));return G}(a=function G(X){var Q,oe,J,ue,he,Oe,we,$,P,g,p=U.prototype={constructor:U,toString:null,valueOf:null},b=new U(1),E=20,R=4,F=-7,x=21,K=-1e7,Z=1e7,re=!1,ie=1,se=0,_e={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Se="0123456789abcdefghijklmnopqrstuvwxyz";function U(_,T){var I,j,M,B,N,D,V,L,z=this;if(!(z instanceof U))return new U(_,T);if(T==null){if(_ instanceof U)return z.s=_.s,z.e=_.e,void(z.c=(_=_.c)?_.slice():_);if((D=typeof _=="number")&&0*_==0){if(z.s=1/_<0?(_=-_,-1):1,_===~~_){for(B=0,N=_;10<=N;N/=10,B++);return z.e=B,void(z.c=[_])}L=String(_)}else{if(L=String(_),!l.test(L))return J(z,L,D);z.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(B=L.indexOf("."))&&(L=L.replace(".","")),0<(N=L.search(/e/i))?(B<0&&(B=N),B+=+L.slice(N+1),L=L.substring(0,N)):B<0&&(B=L.length)}else{if(O(T,2,Se.length,"Base"),L=String(_),T==10)return Ie(z=new U(_ instanceof U?_:L),E+z.e+1,R);if(D=typeof _=="number"){if(0*_!=0)return J(z,L,D,T);if(z.s=1/_<0?(L=L.slice(1),-1):1,U.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+_);D=!1}else z.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(I=Se.slice(0,T),B=N=0,V=L.length;N<V;N++)if(I.indexOf(j=L.charAt(N))<0){if(j=="."){if(B<N){B=V;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,N=-1,B=0;continue}return J(z,String(_),D,T)}-1<(B=(L=oe(L,T,10,z.s)).indexOf("."))?L=L.replace(".",""):B=L.length}for(N=0;L.charCodeAt(N)===48;N++);for(V=L.length;L.charCodeAt(--V)===48;);if(L=L.slice(N,++V)){if(V-=N,D&&U.DEBUG&&15<V&&(v<_||_!==u(_)))throw Error(c+z.s*_);if(Z<(B=B-N-1))z.c=z.e=null;else if(B<K)z.c=[z.e=0];else{if(z.e=B,z.c=[],N=(B+1)%d,B<0&&(N+=d),N<V){for(N&&z.c.push(+L.slice(0,N)),V-=d;N<V;)z.c.push(+L.slice(N,N+=d));L=L.slice(N),N=d-L.length}else N-=V;for(;N--;L+="0");z.c.push(+L)}}else z.c=[z.e=0]}function Ne(_,T,I,j){var M,B,N,D,V;if(I==null?I=R:O(I,0,8),!_.c)return _.toString();if(M=_.c[0],N=_.e,T==null)V=C(_.c),V=j==1||j==2&&(N<=F||x<=N)?Y(V,N):q(V,N,"0");else if(B=(_=Ie(new U(_),T,I)).e,D=(V=C(_.c)).length,j==1||j==2&&(T<=B||B<=F)){for(;D<T;V+="0",D++);V=Y(V,B)}else if(T-=N,V=q(V,B,"0"),D<B+1){if(0<--T)for(V+=".";T--;V+="0");}else if(0<(T+=B-D))for(B+1==D&&(V+=".");T--;V+="0");return _.s<0&&M?"-"+V:V}function Be(_,T){for(var I,j=1,M=new U(_[0]);j<_.length;j++){if(!(I=new U(_[j])).s){M=I;break}T.call(M,I)&&(M=I)}return M}function ke(_,T,I){for(var j=1,M=T.length;!T[--M];T.pop());for(M=T[0];10<=M;M/=10,j++);return(I=j+I*d-1)>Z?_.c=_.e=null:_.c=I<K?[_.e=0]:(_.e=I,T),_}function Ie(_,T,I,j){var M,B,N,D,V,L,z,le=_.c,pe=y;if(le){e:{for(M=1,D=le[0];10<=D;D/=10,M++);if((B=T-M)<0)B+=d,N=T,z=(V=le[L=0])/pe[M-N-1]%10|0;else if((L=s((B+1)/d))>=le.length){if(!j)break e;for(;le.length<=L;le.push(0));V=z=0,N=(B%=d)-d+(M=1)}else{for(V=D=le[L],M=1;10<=D;D/=10,M++);z=(N=(B%=d)-d+M)<0?0:V/pe[M-N-1]%10|0}if(j=j||T<0||le[L+1]!=null||(N<0?V:V%pe[M-N-1]),j=I<4?(z||j)&&(I==0||I==(_.s<0?3:2)):5<z||z==5&&(I==4||j||I==6&&(0<B?0<N?V/pe[M-N]:0:le[L-1])%10&1||I==(_.s<0?8:7)),T<1||!le[0])return le.length=0,j?(T-=_.e+1,le[0]=pe[(d-T%d)%d],_.e=-T||0):le[0]=_.e=0,_;if(B==0?(le.length=L,D=1,L--):(le.length=L+1,D=pe[d-B],le[L]=0<N?u(V/pe[M-N]%pe[N])*D:0),j)for(;;){if(L==0){for(B=1,N=le[0];10<=N;N/=10,B++);for(N=le[0]+=D,D=1;10<=N;N/=10,D++);B!=D&&(_.e++,le[0]==h&&(le[0]=1));break}if(le[L]+=D,le[L]!=h)break;le[L--]=0,D=1}for(B=le.length;le[--B]===0;le.pop());}_.e>Z?_.c=_.e=null:_.e<K&&(_.c=[_.e=0])}return _}function Ae(_){var T,I=_.e;return I===null?_.toString():(T=C(_.c),T=I<=F||x<=I?Y(T,I):q(T,I,"0"),_.s<0?"-"+T:T)}return U.clone=G,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(_){var T,I;if(_!=null){if(typeof _!="object")throw Error(f+"Object expected: "+_);if(_.hasOwnProperty(T="DECIMAL_PLACES")&&(O(I=_[T],0,w,T),E=I),_.hasOwnProperty(T="ROUNDING_MODE")&&(O(I=_[T],0,8,T),R=I),_.hasOwnProperty(T="EXPONENTIAL_AT")&&((I=_[T])&&I.pop?(O(I[0],-w,0,T),O(I[1],0,w,T),F=I[0],x=I[1]):(O(I,-w,w,T),F=-(x=I<0?-I:I))),_.hasOwnProperty(T="RANGE"))if((I=_[T])&&I.pop)O(I[0],-w,-1,T),O(I[1],1,w,T),K=I[0],Z=I[1];else{if(O(I,-w,w,T),!I)throw Error(f+T+" cannot be zero: "+I);K=-(Z=I<0?-I:I)}if(_.hasOwnProperty(T="CRYPTO")){if((I=_[T])!==!!I)throw Error(f+T+" not true or false: "+I);if(I){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!I,Error(f+"crypto unavailable");re=I}else re=I}if(_.hasOwnProperty(T="MODULO_MODE")&&(O(I=_[T],0,9,T),ie=I),_.hasOwnProperty(T="POW_PRECISION")&&(O(I=_[T],0,w,T),se=I),_.hasOwnProperty(T="FORMAT")){if(typeof(I=_[T])!="object")throw Error(f+T+" not an object: "+I);_e=I}if(_.hasOwnProperty(T="ALPHABET")){if(typeof(I=_[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(I))throw Error(f+T+" invalid: "+I);Se=I}}return{DECIMAL_PLACES:E,ROUNDING_MODE:R,EXPONENTIAL_AT:[F,x],RANGE:[K,Z],CRYPTO:re,MODULO_MODE:ie,POW_PRECISION:se,FORMAT:_e,ALPHABET:Se}},U.isBigNumber=function(_){return _ instanceof U||_&&_._isBigNumber===!0||!1},U.maximum=U.max=function(){return Be(arguments,p.lt)},U.minimum=U.min=function(){return Be(arguments,p.gt)},U.random=(ue=9007199254740992,he=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(_){var T,I,j,M,B,N=0,D=[],V=new U(b);if(_==null?_=E:O(_,0,w),M=s(_/d),re)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(M*=2));N<M;)9e15<=(B=131072*T[N]+(T[N+1]>>>11))?(I=crypto.getRandomValues(new Uint32Array(2)),T[N]=I[0],T[N+1]=I[1]):(D.push(B%1e14),N+=2);N=M/2}else{if(!crypto.randomBytes)throw re=!1,Error(f+"crypto unavailable");for(T=crypto.randomBytes(M*=7);N<M;)9e15<=(B=281474976710656*(31&T[N])+1099511627776*T[N+1]+4294967296*T[N+2]+16777216*T[N+3]+(T[N+4]<<16)+(T[N+5]<<8)+T[N+6])?crypto.randomBytes(7).copy(T,N):(D.push(B%1e14),N+=7);N=M/7}if(!re)for(;N<M;)(B=he())<9e15&&(D[N++]=B%1e14);for(M=D[--N],_%=d,M&&_&&(B=y[d-_],D[N]=u(M/B)*B);D[N]===0;D.pop(),N--);if(N<0)D=[j=0];else{for(j=-1;D[0]===0;D.splice(0,1),j-=d);for(N=1,B=D[0];10<=B;B/=10,N++);N<d&&(j-=d-N)}return V.e=j,V.c=D,V}),U.sum=function(){for(var _=1,T=arguments,I=new U(T[0]);_<T.length;)I=I.plus(T[_++]);return I},oe=function(){var _="0123456789";function T(I,j,M,B){for(var N,D,V=[0],L=0,z=I.length;L<z;){for(D=V.length;D--;V[D]*=j);for(V[0]+=B.indexOf(I.charAt(L++)),N=0;N<V.length;N++)V[N]>M-1&&(V[N+1]==null&&(V[N+1]=0),V[N+1]+=V[N]/M|0,V[N]%=M)}return V.reverse()}return function(I,j,M,B,N){var D,V,L,z,le,pe,Re,He,Ze=I.indexOf("."),st=E,Ge=R;for(0<=Ze&&(z=se,se=0,I=I.replace(".",""),pe=(He=new U(j)).pow(I.length-Ze),se=z,He.c=T(q(C(pe.c),pe.e,"0"),10,M,_),He.e=He.c.length),L=z=(Re=T(I,j,M,N?(D=Se,_):(D=_,Se))).length;Re[--z]==0;Re.pop());if(!Re[0])return D.charAt(0);if(Ze<0?--L:(pe.c=Re,pe.e=L,pe.s=B,Re=(pe=Q(pe,He,st,Ge,M)).c,le=pe.r,L=pe.e),Ze=Re[V=L+st+1],z=M/2,le=le||V<0||Re[V+1]!=null,le=Ge<4?(Ze!=null||le)&&(Ge==0||Ge==(pe.s<0?3:2)):z<Ze||Ze==z&&(Ge==4||le||Ge==6&&1&Re[V-1]||Ge==(pe.s<0?8:7)),V<1||!Re[0])I=le?q(D.charAt(1),-st,D.charAt(0)):D.charAt(0);else{if(Re.length=V,le)for(--M;++Re[--V]>M;)Re[V]=0,V||(++L,Re=[1].concat(Re));for(z=Re.length;!Re[--z];);for(Ze=0,I="";Ze<=z;I+=D.charAt(Re[Ze++]));I=q(I,L,D.charAt(0))}return I}}(),Q=function(){function _(j,M,B){var N,D,V,L,z=0,le=j.length,pe=M%m,Re=M/m|0;for(j=j.slice();le--;)z=((D=pe*(V=j[le]%m)+(N=Re*V+(L=j[le]/m|0)*pe)%m*m+z)/B|0)+(N/m|0)+Re*L,j[le]=D%B;return z&&(j=[z].concat(j)),j}function T(j,M,B,N){var D,V;if(B!=N)V=N<B?1:-1;else for(D=V=0;D<B;D++)if(j[D]!=M[D]){V=j[D]>M[D]?1:-1;break}return V}function I(j,M,B,N){for(var D=0;B--;)j[B]-=D,D=j[B]<M[B]?1:0,j[B]=D*N+j[B]-M[B];for(;!j[0]&&1<j.length;j.splice(0,1));}return function(j,M,B,N,D){var V,L,z,le,pe,Re,He,Ze,st,Ge,Me,De,dr,Ft,Ve,Je,St,ut=j.s==M.s?1:-1,ft=j.c,et=M.c;if(!(ft&&ft[0]&&et&&et[0]))return new U(j.s&&M.s&&(ft?!et||ft[0]!=et[0]:et)?ft&&ft[0]==0||!et?0*ut:ut/0:NaN);for(st=(Ze=new U(ut)).c=[],ut=B+(L=j.e-M.e)+1,D||(D=h,L=S(j.e/d)-S(M.e/d),ut=ut/d|0),z=0;et[z]==(ft[z]||0);z++);if(et[z]>(ft[z]||0)&&L--,ut<0)st.push(1),le=!0;else{for(Ft=ft.length,Je=et.length,ut+=2,1<(pe=u(D/(et[z=0]+1)))&&(et=_(et,pe,D),ft=_(ft,pe,D),Je=et.length,Ft=ft.length),dr=Je,Me=(Ge=ft.slice(0,Je)).length;Me<Je;Ge[Me++]=0);St=et.slice(),St=[0].concat(St),Ve=et[0],et[1]>=D/2&&Ve++;do{if(pe=0,(V=T(et,Ge,Je,Me))<0){if(De=Ge[0],Je!=Me&&(De=De*D+(Ge[1]||0)),1<(pe=u(De/Ve)))for(D<=pe&&(pe=D-1),He=(Re=_(et,pe,D)).length,Me=Ge.length;T(Re,Ge,He,Me)==1;)pe--,I(Re,Je<He?St:et,He,D),He=Re.length,V=1;else pe==0&&(V=pe=1),He=(Re=et.slice()).length;if(He<Me&&(Re=[0].concat(Re)),I(Ge,Re,Me,D),Me=Ge.length,V==-1)for(;T(et,Ge,Je,Me)<1;)pe++,I(Ge,Je<Me?St:et,Me,D),Me=Ge.length}else V===0&&(pe++,Ge=[0]);st[z++]=pe,Ge[0]?Ge[Me++]=ft[dr]||0:(Ge=[ft[dr]],Me=1)}while((dr++<Ft||Ge[0]!=null)&&ut--);le=Ge[0]!=null,st[0]||st.splice(0,1)}if(D==h){for(z=1,ut=st[0];10<=ut;ut/=10,z++);Ie(Ze,B+(Ze.e=z+L*d-1)+1,N,le)}else Ze.e=L,Ze.r=+le;return Ze}}(),Oe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,we=/^([^.]+)\.$/,$=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(_,T,I,j){var M,B=I?T:T.replace(g,"");if(P.test(B))_.s=isNaN(B)?null:B<0?-1:1,_.c=_.e=null;else{if(!I&&(B=B.replace(Oe,function(N,D,V){return M=(V=V.toLowerCase())=="x"?16:V=="b"?2:8,j&&j!=M?N:D}),j&&(M=j,B=B.replace(we,"$1").replace($,"0.$1")),T!=B))return new U(B,M);if(U.DEBUG)throw Error(f+"Not a"+(j?" base "+j:"")+" number: "+T);_.c=_.e=_.s=null}},p.absoluteValue=p.abs=function(){var _=new U(this);return _.s<0&&(_.s=1),_},p.comparedTo=function(_,T){return k(this,new U(_,T))},p.decimalPlaces=p.dp=function(_,T){var I,j,M;if(_!=null)return O(_,0,w),T==null?T=R:O(T,0,8),Ie(new U(this),_+this.e+1,T);if(!(I=this.c))return null;if(j=((M=I.length-1)-S(this.e/d))*d,M=I[M])for(;M%10==0;M/=10,j--);return j<0&&(j=0),j},p.dividedBy=p.div=function(_,T){return Q(this,new U(_,T),E,R)},p.dividedToIntegerBy=p.idiv=function(_,T){return Q(this,new U(_,T),0,1)},p.exponentiatedBy=p.pow=function(_,T){var I,j,M,B,N,D,V,L,z=this;if((_=new U(_)).c&&!_.isInteger())throw Error(f+"Exponent not an integer: "+Ae(_));if(T!=null&&(T=new U(T)),N=14<_.e,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!_.c||!_.c[0])return L=new U(Math.pow(+Ae(z),N?2-W(_):+Ae(_))),T?L.mod(T):L;if(D=_.s<0,T){if(T.c?!T.c[0]:!T.s)return new U(NaN);(j=!D&&z.isInteger()&&T.isInteger())&&(z=z.mod(T))}else{if(9<_.e&&(0<z.e||z.e<-1||(z.e==0?1<z.c[0]||N&&24e7<=z.c[1]:z.c[0]<8e13||N&&z.c[0]<=9999975e7)))return B=z.s<0&&W(_)?-0:0,-1<z.e&&(B=1/B),new U(D?1/B:B);se&&(B=s(se/d+2))}for(V=N?(I=new U(.5),D&&(_.s=1),W(_)):(M=Math.abs(+Ae(_)))%2,L=new U(b);;){if(V){if(!(L=L.times(z)).c)break;B?L.c.length>B&&(L.c.length=B):j&&(L=L.mod(T))}if(M){if((M=u(M/2))===0)break;V=M%2}else if(Ie(_=_.times(I),_.e+1,1),14<_.e)V=W(_);else{if((M=+Ae(_))==0)break;V=M%2}z=z.times(z),B?z.c&&z.c.length>B&&(z.c.length=B):j&&(z=z.mod(T))}return j?L:(D&&(L=b.div(L)),T?L.mod(T):B?Ie(L,se,R,void 0):L)},p.integerValue=function(_){var T=new U(this);return _==null?_=R:O(_,0,8),Ie(T,T.e+1,_)},p.isEqualTo=p.eq=function(_,T){return k(this,new U(_,T))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(_,T){return 0<k(this,new U(_,T))},p.isGreaterThanOrEqualTo=p.gte=function(_,T){return(T=k(this,new U(_,T)))===1||T===0},p.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},p.isLessThan=p.lt=function(_,T){return k(this,new U(_,T))<0},p.isLessThanOrEqualTo=p.lte=function(_,T){return(T=k(this,new U(_,T)))===-1||T===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(_,T){var I,j,M,B,N=this,D=N.s;if(T=(_=new U(_,T)).s,!D||!T)return new U(NaN);if(D!=T)return _.s=-T,N.plus(_);var V=N.e/d,L=_.e/d,z=N.c,le=_.c;if(!V||!L){if(!z||!le)return z?(_.s=-T,_):new U(le?N:NaN);if(!z[0]||!le[0])return le[0]?(_.s=-T,_):new U(z[0]?N:R==3?-0:0)}if(V=S(V),L=S(L),z=z.slice(),D=V-L){for((M=(B=D<0)?(D=-D,z):(L=V,le)).reverse(),T=D;T--;M.push(0));M.reverse()}else for(j=(B=(D=z.length)<(T=le.length))?D:T,D=T=0;T<j;T++)if(z[T]!=le[T]){B=z[T]<le[T];break}if(B&&(M=z,z=le,le=M,_.s=-_.s),0<(T=(j=le.length)-(I=z.length)))for(;T--;z[I++]=0);for(T=h-1;D<j;){if(z[--j]<le[j]){for(I=j;I&&!z[--I];z[I]=T);--z[I],z[j]+=h}z[j]-=le[j]}for(;z[0]==0;z.splice(0,1),--L);return z[0]?ke(_,z,L):(_.s=R==3?-1:1,_.c=[_.e=0],_)},p.modulo=p.mod=function(_,T){var I,j,M=this;return _=new U(_,T),!M.c||!_.s||_.c&&!_.c[0]?new U(NaN):!_.c||M.c&&!M.c[0]?new U(M):(ie==9?(j=_.s,_.s=1,I=Q(M,_,0,3),_.s=j,I.s*=j):I=Q(M,_,0,ie),(_=M.minus(I.times(_))).c[0]||ie!=1||(_.s=M.s),_)},p.multipliedBy=p.times=function(_,T){var I,j,M,B,N,D,V,L,z,le,pe,Re,He,Ze,st,Ge=this,Me=Ge.c,De=(_=new U(_,T)).c;if(!(Me&&De&&Me[0]&&De[0]))return!Ge.s||!_.s||Me&&!Me[0]&&!De||De&&!De[0]&&!Me?_.c=_.e=_.s=null:(_.s*=Ge.s,Me&&De?(_.c=[0],_.e=0):_.c=_.e=null),_;for(j=S(Ge.e/d)+S(_.e/d),_.s*=Ge.s,(V=Me.length)<(le=De.length)&&(He=Me,Me=De,De=He,M=V,V=le,le=M),M=V+le,He=[];M--;He.push(0));for(Ze=h,st=m,M=le;0<=--M;){for(I=0,pe=De[M]%st,Re=De[M]/st|0,B=M+(N=V);M<B;)I=((L=pe*(L=Me[--N]%st)+(D=Re*L+(z=Me[N]/st|0)*pe)%st*st+He[B]+I)/Ze|0)+(D/st|0)+Re*z,He[B--]=L%Ze;He[B]=I}return I?++j:He.splice(0,1),ke(_,He,j)},p.negated=function(){var _=new U(this);return _.s=-_.s||null,_},p.plus=function(_,T){var I,j=this,M=j.s;if(T=(_=new U(_,T)).s,!M||!T)return new U(NaN);if(M!=T)return _.s=-T,j.minus(_);var B=j.e/d,N=_.e/d,D=j.c,V=_.c;if(!B||!N){if(!D||!V)return new U(M/0);if(!D[0]||!V[0])return V[0]?_:new U(D[0]?j:0*M)}if(B=S(B),N=S(N),D=D.slice(),M=B-N){for((I=0<M?(N=B,V):(M=-M,D)).reverse();M--;I.push(0));I.reverse()}for((M=D.length)-(T=V.length)<0&&(I=V,V=D,D=I,T=M),M=0;T;)M=(D[--T]=D[T]+V[T]+M)/h|0,D[T]=h===D[T]?0:D[T]%h;return M&&(D=[M].concat(D),++N),ke(_,D,N)},p.precision=p.sd=function(_,T){var I,j,M;if(_!=null&&_!==!!_)return O(_,1,w),T==null?T=R:O(T,0,8),Ie(new U(this),_,T);if(!(I=this.c))return null;if(j=(M=I.length-1)*d+1,M=I[M]){for(;M%10==0;M/=10,j--);for(M=I[0];10<=M;M/=10,j++);}return _&&this.e+1>j&&(j=this.e+1),j},p.shiftedBy=function(_){return O(_,-v,v),this.times("1e"+_)},p.squareRoot=p.sqrt=function(){var _,T,I,j,M,B=this,N=B.c,D=B.s,V=B.e,L=E+4,z=new U("0.5");if(D!==1||!N||!N[0])return new U(!D||D<0&&(!N||N[0])?NaN:N?B:1/0);if((I=(D=Math.sqrt(+Ae(B)))==0||D==1/0?(((T=C(N)).length+V)%2==0&&(T+="0"),D=Math.sqrt(+T),V=S((V+1)/2)-(V<0||V%2),new U(T=D==1/0?"1e"+V:(T=D.toExponential()).slice(0,T.indexOf("e")+1)+V)):new U(D+"")).c[0]){for((D=(V=I.e)+L)<3&&(D=0);;)if(M=I,I=z.times(M.plus(Q(B,M,L,1))),C(M.c).slice(0,D)===(T=C(I.c)).slice(0,D)){if(I.e<V&&--D,(T=T.slice(D-3,D+1))!="9999"&&(j||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(Ie(I,I.e+E+2,1),_=!I.times(I).eq(B));break}if(!j&&(Ie(M,M.e+E+2,0),M.times(M).eq(B))){I=M;break}L+=4,D+=4,j=1}}return Ie(I,I.e+E+1,R,_)},p.toExponential=function(_,T){return _!=null&&(O(_,0,w),_++),Ne(this,_,T,1)},p.toFixed=function(_,T){return _!=null&&(O(_,0,w),_=_+this.e+1),Ne(this,_,T)},p.toFormat=function(_,T,I){var j;if(I==null)_!=null&&T&&typeof T=="object"?(I=T,T=null):_&&typeof _=="object"?(I=_,_=T=null):I=_e;else if(typeof I!="object")throw Error(f+"Argument not an object: "+I);if(j=this.toFixed(_,T),this.c){var M,B=j.split("."),N=+I.groupSize,D=+I.secondaryGroupSize,V=I.groupSeparator||"",L=B[0],z=B[1],le=this.s<0,pe=le?L.slice(1):L,Re=pe.length;if(D&&(M=N,N=D,Re-=D=M),0<N&&0<Re){for(M=Re%N||N,L=pe.substr(0,M);M<Re;M+=N)L+=V+pe.substr(M,N);0<D&&(L+=V+pe.slice(M)),le&&(L="-"+L)}j=z?L+(I.decimalSeparator||"")+((D=+I.fractionGroupSize)?z.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):z):L}return(I.prefix||"")+j+(I.suffix||"")},p.toFraction=function(_){var T,I,j,M,B,N,D,V,L,z,le,pe,Re=this,He=Re.c;if(_!=null&&(!(D=new U(_)).isInteger()&&(D.c||D.s!==1)||D.lt(b)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Ae(D));if(!He)return new U(Re);for(T=new U(b),L=I=new U(b),j=V=new U(b),pe=C(He),B=T.e=pe.length-Re.e-1,T.c[0]=y[(N=B%d)<0?d+N:N],_=!_||0<D.comparedTo(T)?0<B?T:L:D,N=Z,Z=1/0,D=new U(pe),V.c[0]=0;z=Q(D,T,0,1),(M=I.plus(z.times(j))).comparedTo(_)!=1;)I=j,j=M,L=V.plus(z.times(M=L)),V=M,T=D.minus(z.times(M=T)),D=M;return M=Q(_.minus(I),j,0,1),V=V.plus(M.times(L)),I=I.plus(M.times(j)),V.s=L.s=Re.s,le=Q(L,j,B*=2,R).minus(Re).abs().comparedTo(Q(V,I,B,R).minus(Re).abs())<1?[L,j]:[V,I],Z=N,le},p.toNumber=function(){return+Ae(this)},p.toPrecision=function(_,T){return _!=null&&O(_,1,w),Ne(this,_,T,2)},p.toString=function(_){var T,I=this,j=I.s,M=I.e;return M===null?j?(T="Infinity",j<0&&(T="-"+T)):T="NaN":(T=_==null?M<=F||x<=M?Y(C(I.c),M):q(C(I.c),M,"0"):_===10?q(C((I=Ie(new U(I),E+M+1,R)).c),I.e,"0"):(O(_,2,Se.length,"Base"),oe(q(C(I.c),M,"0"),10,_,j,!0)),j<0&&I.c[0]&&(T="-"+T)),T},p.valueOf=p.toJSON=function(){return Ae(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),X!=null&&U.set(X),U}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(k){if(Array.isArray(k))return k}(S)||function(k,O){var W=[],Y=!0,q=!1,G=void 0;try{for(var X,Q=k[Symbol.iterator]();!(Y=(X=Q.next()).done)&&(W.push(X.value),!O||W.length!==O);Y=!0);}catch(oe){q=!0,G=oe}finally{try{Y||Q.return==null||Q.return()}finally{if(q)throw G}}return W}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},k=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var O=C.prefix||"",W=C.postfix||"",Y=function(q,G,X){switch(G.output){case"currency":return G=w(G,a.currentCurrencyDefaultFormat()),function(Se,U,Ne){var Be=Ne.currentCurrency(),ke=Object.assign({},c,U),Ie=void 0,Ae="",_=!!ke.totalLength||!!ke.forceAverage||ke.average,T=U.currencyPosition||Be.position,I=U.currencySymbol||Be.symbol;ke.spaceSeparated&&(Ae=" "),T==="infix"&&(Ie=Ae+I+Ae);var j=m({instance:Se,providedFormat:U,state:Ne,decimalSeparator:Ie});return T==="prefix"&&(j=Se._value<0&&ke.negative==="sign"?"-".concat(Ae).concat(I).concat(j.slice(1)):I+Ae+j),T&&T!=="postfix"||(j=j+(Ae=_?"":Ae)+I),j}(q,G,a);case"percent":return G=w(G,a.currentPercentageDefaultFormat()),function(Se,U,Ne,Be){var ke=U.prefixSymbol,Ie=m({instance:Be(100*Se._value),providedFormat:U,state:Ne}),Ae=Object.assign({},c,U);return ke?"%".concat(Ae.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Ae.spaceSeparated?" ":"","%")}(q,G,a,X);case"byte":return G=w(G,a.currentByteDefaultFormat()),b=q,R=a,F=X,x=(E=G).base||"binary",K=f[x],Z=d(b._value,K.suffixes,K.scale),re=Z.value,ie=Z.suffix,se=m({instance:F(re),providedFormat:E,state:R,defaults:R.currentByteDefaultFormat()}),_e=R.currentAbbreviations(),"".concat(se).concat(_e.spaced?" ":"").concat(ie);case"time":return G=w(G,a.currentTimeDefaultFormat()),$=q,P=Math.floor($._value/60/60),g=Math.floor(($._value-60*P*60)/60),p=Math.round($._value-60*P*60-60*g),"".concat(P,":").concat(g<10?"0":"").concat(g,":").concat(p<10?"0":"").concat(p);case"ordinal":return G=w(G,a.currentOrdinalDefaultFormat()),Q=q,oe=G,ue=(J=a).currentOrdinal(),he=Object.assign({},c,oe),Oe=m({instance:Q,providedFormat:oe,state:J}),we=ue(Q._value),"".concat(Oe).concat(he.spaceSeparated?" ":"").concat(we);case"number":default:return m({instance:q,providedFormat:G,numbro:X})}var Q,oe,J,ue,he,Oe,we,$,P,g,p,b,E,R,F,x,K,Z,re,ie,se,_e}(S,C,k);return Y=(Y=O+Y)+W}function d(S,C,k){var O=C[0],W=Math.abs(S);if(k<=W){for(var Y=1;Y<C.length;++Y){var q=Math.pow(k,Y),G=Math.pow(k,Y+1);if(q<=W&&W<G){O=C[Y],S/=q;break}}O===C[0]&&(S/=Math.pow(k,C.length-1),O=C[C.length-1])}return{value:S,suffix:O}}function v(S){for(var C="",k=0;k<S;k++)C+="0";return C}function y(S,C){return S.toString().indexOf("e")!==-1?function(k,O){var W=k.toString(),Y=i(W.split("e"),2),q=Y[0],G=Y[1],X=i(q.split("."),2),Q=X[0],oe=X[1],J=oe===void 0?"":oe;if(0<+G)W=Q+J+v(G-J.length);else{var ue=".";ue=+Q<0?"-0".concat(ue):"0".concat(ue);var he=(v(-G-1)+Math.abs(Q)+J).substr(0,O);he.length<O&&(he+=v(O-he.length)),W=ue+he}return 0<+G&&0<O&&(W+=".".concat(v(O))),W}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function m(S){var C=S.instance,k=S.providedFormat,O=S.state,W=O===void 0?a:O,Y=S.decimalSeparator,q=S.defaults,G=q===void 0?W.currentDefaults():q,X=C._value;if(X===0&&W.hasZeroFormat())return W.getZeroFormat();if(!isFinite(X))return X.toString();var Q,oe,J,ue,he,Oe,we,$,P=Object.assign({},c,G,k),g=P.totalLength,p=g?0:P.characteristic,b=P.optionalCharacteristic,E=P.forceAverage,R=!!g||!!E||P.average,F=g?-1:R&&k.mantissa===void 0?0:P.mantissa,x=!g&&(k.optionalMantissa===void 0?F===-1:P.optionalMantissa),K=P.trimMantissa,Z=P.thousandSeparated,re=P.spaceSeparated,ie=P.negative,se=P.forceSign,_e=P.exponential,Se="";if(R){var U=function(_){var T=_.value,I=_.forceAverage,j=_.abbreviations,M=_.spaceSeparated,B=M!==void 0&&M,N=_.totalLength,D=N===void 0?0:N,V="",L=Math.abs(T),z=-1;if(L>=Math.pow(10,12)&&!I||I==="trillion"?(V=j.trillion,T/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!I||I==="billion"?(V=j.billion,T/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!I||I==="million"?(V=j.million,T/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!I||I==="thousand")&&(V=j.thousand,T/=Math.pow(10,3)),V&&(V=(B?" ":"")+V),D){var le=T.toString().split(".")[0];z=Math.max(D-le.length,0)}return{value:T,abbreviation:V,mantissaPrecision:z}}({value:X,forceAverage:E,abbreviations:W.currentAbbreviations(),spaceSeparated:re,totalLength:g});X=U.value,Se+=U.abbreviation,g&&(F=U.mantissaPrecision)}if(_e){var Ne=(oe=(Q={value:X,characteristicPrecision:p}).value,J=Q.characteristicPrecision,ue=J===void 0?0:J,he=i(oe.toExponential().split("e"),2),Oe=he[0],we=he[1],$=+Oe,ue&&1<ue&&($*=Math.pow(10,ue-1),we=0<=(we=+we-(ue-1))?"+".concat(we):we),{value:$,abbreviation:"e".concat(we)});X=Ne.value,Se=Ne.abbreviation+Se}var Be,ke,Ie,Ae=function(_,T,I,j,M){if(j===-1)return _;var B=y(T,j),N=i(B.toString().split("."),2),D=N[0],V=N[1],L=V===void 0?"":V;if(L.match(/^0+$/)&&(I||M))return D;var z=L.match(/0+$/);return M&&z?"".concat(D,".").concat(L.toString().slice(0,z.index)):B.toString()}(X.toString(),X,x,F,K);return Ae=function(_,T,I,j,M){var B=j.currentDelimiters(),N=B.thousands;M=M||B.decimal;var D=B.thousandsSize||3,V=_.toString(),L=V.split(".")[0],z=V.split(".")[1];return I&&(T<0&&(L=L.slice(1)),function(le,pe){for(var Re=[],He=0,Ze=le;0<Ze;Ze--)He===pe&&(Re.unshift(Ze),He=0),He++;return Re}(L.length,D).forEach(function(le,pe){L=L.slice(0,le+pe)+N+L.slice(le+pe)}),T<0&&(L="-".concat(L))),V=z?L+M+z:L}(Ae=function(_,T,I,j){var M=_,B=i(M.toString().split("."),2),N=B[0],D=B[1];if(N.match(/^-?0$/)&&I)return D?"".concat(N.replace("0",""),".").concat(D):N.replace("0","");if(N.length<j)for(var V=j-N.length,L=0;L<V;L++)M="0".concat(M);return M.toString()}(Ae,0,b,p),X,Z,W,Y),(R||_e)&&(Ae=Ae+Se),(se||X<0)&&(Be=Ae,Ie=ie,Ae=(ke=X)===0?Be:+Be==0?Be.replace("-",""):0<ke?"+".concat(Be):Ie==="sign"?Be:"(".concat(Be.replace("-",""),")")),Ae}function w(S,C){if(!S)return C;var k=Object.keys(S);return k.length===1&&k[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return h.apply(void 0,k.concat([S]))},getByteUnit:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return function(W){var Y=f.general;return d(W._value,Y.suffixes,Y.scale).suffix}.apply(void 0,k.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return function(W){var Y=f.binary;return d(W._value,Y.suffixes,Y.scale).suffix}.apply(void 0,k.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return function(W){var Y=f.decimal;return d(W._value,Y.suffixes,Y.scale).suffix}.apply(void 0,k.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(y){u=y}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(y){y=l.parseFormat(y),a.validateFormat(y)&&(h=y)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(y){return c=typeof y=="string"?y:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(y){if(y){if(f[y])return f[y];throw new Error('Unknown tag "'.concat(y,'"'))}return v()},s.registerLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(y))throw new Error("Invalid language data");f[y.languageTag]=y,m&&d(y.languageTag)},s.setLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[y]){var w=y.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===w});return f[S]?void d(S):void d(m)}d(y)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(m,w){for(var S=0;S<w.length;S++){var C=w[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(m,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(y),u=r("./unformatting"),f=r("./formatting")(y),c=r("./manipulating")(y),h=r("./parsing"),d=function(){function m(C){(function(k,O){if(!(k instanceof O))throw new TypeError("Cannot call a class as a function")})(this,m),this._value=C}var w,S;return w=m,(S=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),m}();function v(m){var w=m;return y.isNumbro(m)?w=m._value:typeof m=="string"?w=y.unformat(m):isNaN(m)&&(w=NaN),w}function y(m){return new d(v(m))}y.version="2.1.2",y.isNumbro=function(m){return m instanceof d},y.language=a.currentLanguage,y.registerLanguage=a.registerLanguage,y.setLanguage=a.setLanguage,y.languages=a.languages,y.languageData=a.languageData,y.zeroFormat=a.setZeroFormat,y.defaultFormat=a.currentDefaults,y.setDefaults=a.setDefaults,y.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=s.loadLanguagesInNode,y.unformat=u.unformat,n.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,y,m,w,S,C,k,O,W,Y,q,G,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=X,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=X,function(Q,oe){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):Q.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):Q.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,X),h=X,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=X,(y=i.split(".")[0].match(/0+/))&&(v.characteristic=y[0].length),function(Q,oe){if(Q.indexOf(".")!==-1){var J=Q.split(".")[0];oe.optionalCharacteristic=J.indexOf("0")===-1}}(i,X),m=X,i.indexOf("a")!==-1&&(m.average=!0),S=X,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Q,oe){var J=Q.split(".")[1];if(J){var ue=J.match(/0+/);ue&&(oe.mantissa=ue[0].length)}}(i,X),k=X,(C=i).match(/\[\.]/)?k.optionalMantissa=!0:C.match(/\./)&&(k.optionalMantissa=!1),O=X,i.indexOf(",")!==-1&&(O.thousandSeparated=!0),W=X,i.indexOf(" ")!==-1&&(W.spaceSeparated=!0),q=X,(Y=i).match(/^\+?\([^)]*\)$/)&&(q.negative="parenthesis"),Y.match(/^\+?-/)&&(q.negative="sign"),G=X,i.match(/^\+/)&&(G.forceSign=!0),X)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function y(m,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,k=4<arguments.length?arguments[4]:void 0,O=5<arguments.length?arguments[5]:void 0,W=6<arguments.length?arguments[6]:void 0;if(!isNaN(+m))return+m;var Y="",q=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(q!==m)return-1*y(q,w,S,C,k,O,W);for(var G=0;G<i.length;G++){var X=i[G];if((Y=m.replace(X.key,""))!==m)return y(Y,w,S,C,k,O,W)*X.factor}if((Y=m.replace("%",""))!==m)return y(Y,w,S,C,k,O,W)/100;var Q=parseFloat(m);if(!isNaN(Q)){var oe=C(Q);if(oe&&oe!=="."&&(Y=m.replace(new RegExp("".concat(a(oe),"$")),""))!==m)return y(Y,w,S,C,k,O,W);var J={};Object.keys(O).forEach(function(g){J[O[g]]=g});for(var ue=Object.keys(J).sort().reverse(),he=ue.length,Oe=0;Oe<he;Oe++){var we=ue[Oe],$=J[we];if((Y=m.replace(we,""))!==m){var P=void 0;switch($){case"thousand":P=Math.pow(10,3);break;case"million":P=Math.pow(10,6);break;case"billion":P=Math.pow(10,9);break;case"trillion":P=Math.pow(10,12)}return y(Y,w,S,C,k,O,W)*P}}}}(function(y,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=y.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(m.thousands),"([0-9])"),"g"),"$1$2")).replace(m.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),y=d.currentCurrency().symbol,m=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(k,O){if(!k.indexOf(":")||O.thousands===":")return!1;var W=k.split(":");if(W.length!==3)return!1;var Y=+W[0],q=+W[1],G=+W[2];return!isNaN(Y)&&!isNaN(q)&&!isNaN(G)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,y,m,w,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(y){if(Array.isArray(y)){for(var m=0,w=new Array(y.length);m<y.length;m++)w[m]=y[m];return w}}(v)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,y,m){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!y[C])return console.error("".concat(m," Invalid key: ").concat(C)),!1;var k=v[C],O=y[C];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!h(k,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(k)!==O.type)return console.error("".concat(m," ").concat(C,' type mismatched: "').concat(O.type,'" expected, "').concat(a(k),'" provided')),!1;if(O.restrictions&&O.restrictions.length)for(var W=O.restrictions.length,Y=0;Y<W;Y++){var q=O.restrictions[Y],G=q.restriction,X=q.message;if(!G(k,v))return console.error("".concat(m," ").concat(C," invalid value: ").concat(X)),!1}return O.restriction&&!O.restriction(k,v)?(console.error("".concat(m," ").concat(C," invalid value: ").concat(O.message)),!1):O.validValues&&O.validValues.indexOf(k)===-1?(console.error("".concat(m," ").concat(C," invalid value: must be among ").concat(JSON.stringify(O.validValues),', "').concat(k,'" provided')),!1):!(O.children&&!h(k,O.children,"[Validate ".concat(C,"]")))});return w||S.push.apply(S,i(Object.keys(y).map(function(C){var k=y[C];if(typeof k=="string"&&(k={type:k}),k.mandatory){var O=k.mandatory;if(typeof O=="function"&&(O=O(v)),O&&v[C]===void 0)return console.error("".concat(m,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,k){return C&&k},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,y){var m=c(v),w=d(y);return m&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(PW);var Ufe=PW.exports;const Ui=lj(Ufe);var zfe="numeric";function YE(e,t,r,n,o,i,a){var l=i;if(wr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Ui.languages()[u]){var d=u.replace("-",""),v=Ui.allLanguages?Ui.allLanguages[u]:Ui[d];v&&Ui.registerLanguage(v)}Ui.setLanguage(u),l=Ui(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Ni(e,t,r,n,o,l,a)}YE.RENDERER_TYPE=zfe;var Yfe="password";function GE(e,t,r,n,o,i,a){Ni.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Ce(l-1,function(){u+=s}),ll(t,u)}GE.RENDERER_TYPE=Yfe;var Gfe="time";function KE(e,t,r,n,o,i,a){Ni.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}KE.RENDERER_TYPE=Gfe;var Tv=on("renderers"),Kfe=Tv.register,qfe=Tv.getItem,kW=Tv.hasItem,Xfe=Tv.getNames;Tv.getValues;function ap(e){if(typeof e=="function")return e;if(!kW(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return qfe(e)}function Nn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),Kfe(e,t)}function Zfe(){Nn(If),Nn(Af),Nn(UE),Nn(WE),Nn(YE),Nn(GE),Nn(Ni),Nn(KE)}var Qfe="autocomplete";function Um(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,JA(r,t)):JA(r,t)(this.source):t(!0)}Um.VALIDATOR_TYPE=Qfe;function JA(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var Jfe=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},ece=Xt,tce=vm,rce=Lt,nce=Cn,oce=Ar,eI=Jfe,tI=Gt,ice=el,ace=ym;tce("search",function(e,t,r){return[function(o){var i=oce(this),a=nce(o)?void 0:ice(o,e);return a?ece(a,o,i):new RegExp(o)[e](tI(i))},function(n){var o=rce(this),i=tI(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;eI(l,0)||(o.lastIndex=0);var s=ace(o,i);return eI(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function $W(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const lce=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:$W},Symbol.toStringTag,{value:"Module"}));var sce="date";function qE(e,t){var r=yW(CW,this.instance),n=e,o=!0;n==null&&(n="");var i=ee(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=ee(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=uce(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}qE.VALIDATOR_TYPE=sce;function uce(e,t){var r=ee($W(e)),n=ee(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var fce="numeric";function XE(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:wr(e))}XE.VALIDATOR_TYPE=fce;var cce=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],hce="time";function ZE(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=ee(o,cce,!0).isValid()?ee(o):ee(o,r),l=a.isValid(),s=ee(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}ZE.VALIDATOR_TYPE=hce;var Pv=on("validators"),dce=Pv.register,vce=Pv.getItem,AW=Pv.hasItem,yce=Pv.getNames;Pv.getValues;function QE(e){if(typeof e=="function")return e;if(!AW(e))throw Error('No registered validator found under "'.concat(e,'" name'));return vce(e)}function ql(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),dce(e,t)}function gce(){ql(Um),ql(qE),ql(XE),ql(ZE)}var pce="autocomplete",mce={CELL_TYPE:pce,editor:BE,renderer:If,validator:Um},bce="checkbox",wce={CELL_TYPE:bce,editor:wW,renderer:UE},Sce="date",Cce={CELL_TYPE:Sce,editor:_W,renderer:If,validator:qE},_ce="dropdown",Oce={CELL_TYPE:_ce,editor:VE,renderer:If,validator:Um},Rce="handsontable",Ece={CELL_TYPE:Rce,editor:FE,renderer:If},Tce="numeric",Pce={CELL_TYPE:Tce,editor:OW,renderer:YE,validator:XE,dataType:"number"},kce="password",$ce={CELL_TYPE:kce,editor:RW,renderer:GE,copyable:!1},Ace="text",IW={CELL_TYPE:Ace,editor:sl,renderer:Ni},Ice="time",Mce={CELL_TYPE:Ice,editor:EW,renderer:KE,validator:ZE},kv=on("cellTypes"),xce=kv.register,Dce=kv.getItem,MW=kv.hasItem,Nce=kv.getNames;kv.getValues;function JE(e){if(!MW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Dce(e)}function fn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Pr(e,n),o&&Nn(e,o),i&&ql(e,i),xce(e,t)}function Hce(){fn(mce),fn(wce),fn(Cce),fn(Oce),fn(Ece),fn(Pce),fn($ce),fn(IW),fn(Mce)}var Lce=fm,jce=fF;Lce("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},jce);function Fce(e){return Wce(e)||Vce(e)||xW(e)||Bce()}function Bce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wce(e){if(Array.isArray(e))return w_(e)}function Uce(e,t){return Gce(e)||Yce(e,t)||xW(e,t)||zce()}function zce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xW(e,t){if(e){if(typeof e=="string")return w_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w_(e,t)}}function w_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Gce(e){if(Array.isArray(e))return e}var S_="asc",Kce="desc",rI=new Map([[S_,[-1,1]],[Kce,[1,-1]]]),qce=function(t){return"The priority '".concat(t,"' is already declared in a map.")},Xce=function(t){return"The priority '".concat(t,"' is not a number.")};function Zce(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=pt(t)?t:qce,r=pt(r)?r:Xce;function o(a,l){if(!wr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:S_,l=rI.get(a)||rI.get(S_),s=Uce(l,2),u=s[0],f=s[1];return Fce(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}function Qce(e){return the(e)||ehe(e)||DW(e)||Jce()}function Jce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ehe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function the(e){if(Array.isArray(e))return C_(e)}function nI(e,t){return ohe(e)||nhe(e,t)||DW(e,t)||rhe()}function rhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DW(e,t){if(e){if(typeof e=="string")return C_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C_(e,t)}}function C_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ohe(e){if(Array.isArray(e))return e}var ihe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function zm(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=pt(t)?t:ihe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var y=nI(v,2),m=y[0],w=y[1];return f===w?m:!1})||[null],h=nI(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return Qce(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function ahe(e){return fhe(e)||uhe(e)||she(e)||lhe()}function lhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function she(e,t){if(e){if(typeof e=="string")return __(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return __(e,t)}}function uhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fhe(e){if(Array.isArray(e))return __(e)}function __(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var che=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function hhe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=pt(t)?t:che;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return ahe(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function dhe(e,t){return ghe(e)||yhe(e,t)||NW(e,t)||vhe()}function vhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ghe(e){if(Array.isArray(e))return e}function oI(e){return bhe(e)||mhe(e)||NW(e)||phe()}function phe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NW(e,t){if(e){if(typeof e=="string")return O_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O_(e,t)}}function mhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bhe(e){if(Array.isArray(e))return O_(e)}function O_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var eT=function(t){return'There is already registered "'.concat(t,'" plugin.')},whe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},She=function(t){return'The priority "'.concat(t,'" is not a number.')},HW=Zce({errorPriorityExists:whe,errorPriorityNaN:She}),LW=hhe({errorItemExists:eT}),R_=zm({errorIdExists:eT});function tT(){return[].concat(oI(HW.getItems()),oI(LW.getItems()))}function $v(e){var t=ur(e);return R_.getItem(t)}function Che(e){return!!$v(e)}function tt(e,t,r){var n=Ohe(e,t,r),o=dhe(n,3);e=o[0],t=o[1],r=o[2],$v(e)===void 0&&_he(e,t,r)}function _he(e,t,r){var n=ur(e);if(R_.hasItem(n))throw new Error(eT(n));r===void 0?LW.addItem(n):HW.addItem(r,n),R_.addItem(n,t)}function Ohe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function Rhe(e,t){return khe(e)||Phe(e,t)||The(e,t)||Ehe()}function Ehe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function The(e,t){if(e){if(typeof e=="string")return iI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iI(e,t)}}function iI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Phe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function khe(e){if(Array.isArray(e))return e}function $he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ihe(n.key),n)}}function Ahe(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ihe(e){var t=Mhe(e,"string");return th(t)==="symbol"?t:String(t)}function Mhe(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xhe(e,t){Dhe(e,t),t.add(e)}function Dhe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var lI=new Map([["plugin",Che],["cell-type",MW],["editor",vW],["renderer",kW],["validator",AW]]),Hhe="base",zi=new WeakMap,Iw=[],Rn=null,sI=new WeakSet,ot=function(){function e(t){var r=this;$he(this,e),xhe(this,sI),Gn(this,"hot",t,{writable:!1}),zi.set(this,{hooks:{}}),Rn=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Ahe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=Rhe(f,2),h=c[0],d=c[1];if(!lI.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));lI.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Iw.push(a)}}Rn||(Rn=tT()),Rn.indexOf("UndoRedo")>=0&&Rn.splice(Rn.indexOf("UndoRedo"),1),Rn.indexOf(this.pluginName)>=0&&Rn.splice(Rn.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=Rn.length===0;if(l){if(Iw.length>0){var s=["".concat(Iw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){zi.get(this).hooks[r]=zi.get(this).hooks[r]||[];var o=zi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),zi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;A(zi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=zi.get(this).hooks;ze(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){A(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=Nhe(this,sI,Lhe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ze(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Hhe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function Lhe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function jhe(e,t){return Whe(e)||Vhe(e,t)||Bhe(e,t)||Fhe()}function Fhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bhe(e,t){if(e){if(typeof e=="string")return uI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uI(e,t)}}function uI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Whe(e){if(Array.isArray(e))return e}function Uhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yhe(n.key),n)}}function zhe(e,t,r){return t&&fI(e.prototype,t),r&&fI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yhe(e){var t=Ghe(e,"string");return rh(t)==="symbol"?t:String(t)}function Ghe(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Khe=function(){function e(t){Uhe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return zhe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),A(this.rows,function(n){r(n.row,Tt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),A(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){A(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),A(i,function(l){var s=jhe(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){A(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),te(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return te(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const rT=Khe;function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function qhe(e,t,r){return t=jW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jW(n.key),n)}}function Zhe(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jW(e){var t=Qhe(e,"string");return nh(t)==="symbol"?t:String(t)}function Qhe(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jhe=function(){function e(t){Xhe(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return Zhe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return Ce(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return Ce(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ue(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(xt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var y=a.get(v);if(y.needed){var m=s.indexOf(c)>-1;(!m||i.allowDuplicates||d)&&(y.strings.push(qhe({value:c},l,u)),s.push(c),y.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const FW=Jhe;var la=1,lr=2;function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function ede(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rde(n.key),n)}}function tde(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rde(e){var t=nde(e,"string");return oh(t)==="symbol"?t:String(t)}function nde(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ml=new WeakMap,ode=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;ede(this,e),ml.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return tde(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=ml.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,y=h>0?v+1:v,m=0;m<d;m++)if(i=this._getColumnWidth(m),r<=h&&u!==lr&&(this.startColumn=m,a=i),r>=h&&r+(u===lr?i:0)<=h+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,a=i),this.endColumn=m),o.push(r),r+=i,l=i,u!==lr&&(this.endColumn=m),r>=h+v){n=!1;break}var w=c+v-y,S=u===lr?0:l,C=u===lr?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var k=o[this.endColumn]+i-o[this.startColumn-1];if((k<=v||u!==lr)&&(this.startColumn-=1),k>v)break}u===la&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=ml.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=ml.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=ml.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=ml.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const nT=ode;function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function ide(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lde(n.key),n)}}function ade(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lde(e){var t=sde(e,"string");return ih(t)==="symbol"?t:String(t)}function sde(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vI=new WeakMap,ude=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;ide(this,e),vI.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return ade(e,[{key:"calculate",value:function(){for(var r=vI.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,y=0,m=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==lr&&(this.startRow=w,y=v),c>=l&&c+(n===lr?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,y=v),this.endRow=w),d.push(c),c+=v,m=v,n!==lr&&(this.endRow=w),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===lr?y:0,k=n===lr?0:m;if(S<C||a>d.at(-1)+k?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var O=d[this.endRow]+v-d[this.startRow-1];if((O<=u-f||n!==lr)&&(this.startRow-=1),O>=u-f)break}n===la&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const BW=ude;function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function fde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VW(n.key),n)}}function cde(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hde(e,t,r){dde(e,t),t.set(e,r)}function dde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gI(e,t,r){return t=VW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VW(e){var t=vde(e,"string");return ah(t)==="symbol"?t:String(t)}function vde(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xf(e,t){var r=WW(e,t,"get");return yde(e,r)}function yde(e,t){return t.get?t.get.call(e):t.value}function gde(e,t,r){var n=WW(e,t,"set");return pde(e,n,r),r}function WW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function pde(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Yi=new WeakMap,mde=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;fde(this,e),gI(this,"row",null),gI(this,"col",null),hde(this,Yi,{writable:!0,value:!1}),gde(this,Yi,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return cde(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Xf(this,Yi)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Xf(this,Yi)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Xf(this,Yi)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Xf(this,Yi)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Xf(this,Yi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const lp=mde;function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function bde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UW(n.key),n)}}function wde(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sde(e,t,r){Cde(e,t),t.set(e,r)}function Cde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mw(e,t,r){return t=UW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UW(e){var t=_de(e,"string");return lh(t)==="symbol"?t:String(t)}function _de(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function En(e,t){var r=zW(e,t,"get");return Ode(e,r)}function Ode(e,t){return t.get?t.get.call(e):t.value}function Rde(e,t,r){var n=zW(e,t,"set");return Ede(e,n,r),r}function zW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ede(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gr=new WeakMap,Tde=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;bde(this,e),Mw(this,"highlight",null),Mw(this,"from",null),Mw(this,"to",null),Sde(this,Gr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Rde(this,Gr,o)}return wde(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return En(this,Gr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return En(this,Gr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return En(this,Gr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return En(this,Gr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return En(this,Gr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return En(this,Gr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return En(this,Gr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return En(this,Gr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof lp))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,En(this,Gr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new lp(r,n,En(this,Gr))}}]),e}();const oT=Tde;function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function Pde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$de(n.key),n)}}function kde(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $de(e){var t=Ade(e,"string");return sh(t)==="symbol"?t:String(t)}function Ade(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bl=new WeakMap,Ide=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Pde(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,bl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return kde(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};gn()?n():(TE()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=bl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=bc(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=bl.get(this),o=this.domBindings.rootDocument.activeElement,i=LE(XV,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=bc(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&pi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=bc(r.target,["TD","TH"],n),i=bc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&pi(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=bl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=bl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ve(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];_E()&&(AV()||IV())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=bl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const YW=Ide;function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function Mde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dde(n.key),n)}}function xde(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dde(e){var t=Nde(e,"string");return uh(t)==="symbol"?t:String(t)}function Nde(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hde=function(){function e(t,r,n){Mde(this,e),this.offset=t,this.total=r,this.countTH=n}return xde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Lde=Hde;function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function jde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bde(n.key),n)}}function Fde(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bde(e){var t=Vde(e,"string");return fh(t)==="symbol"?t:String(t)}function Vde(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wde=function(){function e(t,r,n){jde(this,e),this.offset=t,this.total=r,this.countTH=n}return Fde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Ude=Wde;var zde=0,sp=1,up=2;function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function Yde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kde(n.key),n)}}function Gde(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kde(e){var t=qde(e,"string");return ch(t)==="symbol"?t:String(t)}function qde(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CI=function(){function e(){Yde(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Gde(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function Xde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qde(n.key),n)}}function Zde(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qde(e){var t=Jde(e,"string");return hh(t)==="symbol"?t:String(t)}function Jde(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eve=function(){function e(){Xde(this,e),this.size=new CI,this.workingSpace=zde,this.sharedSize=null}return Zde(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof CI}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=sp,r.workingSpace=up,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=up,r.workingSpace=sp,this.sharedSize=r.getViewSize()}}]),e}();function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function tve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nve(n.key),n)}}function rve(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nve(e){var t=ove(e,"string");return dh(t)==="symbol"?t:String(t)}function ove(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GW=function(){function e(t,r,n){tve(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new eve,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return rve(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(sp))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(up)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(sp);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(up)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Ds(e){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(e)}function ive(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lve(n.key),n)}}function ave(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lve(e){var t=sve(e,"string");return Ds(t)==="symbol"?t:String(t)}function sve(e,t){if(Ds(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ds(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E_(e,t)}function E_(e,t){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},E_(e,t)}function fve(e){var t=dve();return function(){var n=fp(e),o;if(t){var i=fp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cve(this,o)}}function cve(e,t){if(t&&(Ds(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hve(e)}function hve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fp(e){return fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fp(e)}var KW=function(e){uve(r,e);var t=fve(r);function r(){return ive(this,r),t.apply(this,arguments)}return ave(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(GW);function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function vve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gve(n.key),n)}}function yve(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gve(e){var t=pve(e,"string");return vh(t)==="symbol"?t:String(t)}function pve(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mve=function(){function e(t){vve(this,e),this.nodeType=t.toUpperCase()}return yve(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function bve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sve(n.key),n)}}function wve(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sve(e){var t=Cve(e,"string");return yh(t)==="symbol"?t:String(t)}function Cve(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Av=function(){function e(t,r){bve(this,e),this.nodesPool=typeof t=="string"?new mve(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return wve(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function _ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rve(n.key),n)}}function Ove(e,t,r){return t&&PI(e.prototype,t),r&&PI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rve(e){var t=Eve(e,"string");return Ns(t)==="symbol"?t:String(t)}function Eve(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T_(e,t)}function T_(e,t){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T_(e,t)}function Pve(e){var t=Ave();return function(){var n=cp(e),o;if(t){var i=cp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kve(this,o)}}function kve(e,t){if(t&&(Ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $ve(e)}function $ve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ave(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cp(e){return cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cp(e)}var Ive=function(e){Tve(r,e);var t=Pve(r);function r(){var n;return _ve(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Ove(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new KW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<l;y++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),a[y](c,m,y)}d.end()}}}]),r}(Av);function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function Mve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dve(n.key),n)}}function xve(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dve(e){var t=Nve(e,"string");return Hs(t)==="symbol"?t:String(t)}function Nve(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P_(e,t)}function P_(e,t){return P_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},P_(e,t)}function Lve(e){var t=Bve();return function(){var n=hp(e),o;if(t){var i=hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jve(this,o)}}function jve(e,t){if(t&&(Hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fve(e)}function Fve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hp(e){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hp(e)}var Vve=function(e){Hve(r,e);var t=Lve(r);function r(n){return Mve(this,r),t.call(this,null,n)}return xve(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Sn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(Av);function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function Wve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zve(n.key),n)}}function Uve(e,t,r){return t&&$I(e.prototype,t),r&&$I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zve(e){var t=Yve(e,"string");return Ls(t)==="symbol"?t:String(t)}function Yve(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k_(e,t)}function k_(e,t){return k_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},k_(e,t)}function Kve(e){var t=Zve();return function(){var n=dp(e),o;if(t){var i=dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qve(this,o)}}function qve(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xve(e)}function Xve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dp(e){return dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dp(e)}var Qve=function(e){Gve(r,e);var t=Kve(r);function r(n){return Wve(this,r),t.call(this,null,n)}return Uve(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&te(d,"rowHeader")}}]),r}(Av);function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}var AI;function Jve(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function eye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function II(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rye(n.key),n)}}function tye(e,t,r){return t&&II(e.prototype,t),r&&II(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rye(e){var t=nye(e,"string");return js(t)==="symbol"?t:String(t)}function nye(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}function $_(e,t){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$_(e,t)}function iye(e){var t=sye();return function(){var n=vp(e),o;if(t){var i=vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aye(this,o)}}function aye(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lye(e)}function lye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vp(e)}var MI=!1,uye=function(e){oye(r,e);var t=iye(r);function r(n){var o;return eye(this,r),o=t.call(this,"TR",n),o.orderView=new GW(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return tye(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!MI&&o>1e3&&(MI=!0,bt(dt(AI||(AI=Jve([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Av);function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function fye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hye(n.key),n)}}function cye(e,t,r){return t&&xI(e.prototype,t),r&&xI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hye(e){var t=dye(e,"string");return Fs(t)==="symbol"?t:String(t)}function dye(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function A_(e,t){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},A_(e,t)}function yye(e){var t=mye();return function(){var n=yp(e),o;if(t){var i=yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gye(this,o)}}function gye(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pye(e)}function pye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yp(e){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yp(e)}var bye=function(e){vye(r,e);var t=yye(r);function r(){var n;return fye(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return cye(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new KW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var y=h.getCurrentNode(),m=this.table.renderedColumnToSource(v);xe(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(f,m,y)}h.end()}}}]),r}(Av);function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function wye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cye(n.key),n)}}function Sye(e,t,r){return t&&DI(e.prototype,t),r&&DI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cye(e){var t=_ye(e,"string");return gh(t)==="symbol"?t:String(t)}function _ye(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oye=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;wye(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Sye(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Rye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tye(n.key),n)}}function Eye(e,t,r){return t&&NI(e.prototype,t),r&&NI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tye(e){var t=Pye(e,"string");return ph(t)==="symbol"?t:String(t)}function Pye(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kye=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;Rye(this,e),this.renderer=new Oye(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Ive,columnHeaders:new Vve(n),colGroup:new Qve(o),rows:new uye(i),cells:new bye}),this.renderer.setAxisUtils(a,l)}return Eye(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function $ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iye(n.key),n)}}function Aye(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iye(e){var t=Mye(e,"string");return mh(t)==="symbol"?t:String(t)}function Mye(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xye=function(){function e(t,r){$ye(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Aye(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Jt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function Dye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hye(n.key),n)}}function Nye(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hye(e){var t=Lye(e,"string");return bh(t)==="symbol"?t:String(t)}function Lye(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jye=function(){function e(t,r){Dye(this,e),this.dataAccessObject=t,this.wtSettings=r}return Nye(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Fye(e){return Wye(e)||Vye(e)||qW(e)||Bye()}function Bye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wye(e){if(Array.isArray(e))return I_(e)}function Uye(e,t){return Gye(e)||Yye(e,t)||qW(e,t)||zye()}function zye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qW(e,t){if(e){if(typeof e=="string")return I_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I_(e,t)}}function I_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Gye(e){if(Array.isArray(e))return e}function Kye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XW(n.key),n)}}function qye(e,t,r){return t&&jI(e.prototype,t),r&&jI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tn(e,t,r){return t=XW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XW(e){var t=Xye(e,"string");return wh(t)==="symbol"?t:String(t)}function Xye(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zye=function(){function e(t,r,n,o,i){var a=this;Kye(this,e),Tn(this,"wtSettings",null),Tn(this,"domBindings",void 0),Tn(this,"TBODY",null),Tn(this,"THEAD",null),Tn(this,"COLGROUP",null),Tn(this,"hasTableHeight",!0),Tn(this,"hasTableWidth",!0),Tn(this,"isTableVisible",!1),Tn(this,"tableOffset",0),Tn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,IE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new jye(this.dataAccessObject,this.wtSettings),this.columnUtils=new xye(this.dataAccessObject,this.wtSettings),this.tableRenderer=new kye({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return qye(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Wt(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var y=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,m!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Wt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Ude(w,l,h),this.columnFilter=new Lde(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var k={};this.wtSettings.getSetting("beforeDraw",!0,k),C=k.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Fn)||this.is(mi))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var O;if(this.isMaster&&(O=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Fn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var W=ct(this.hider),Y=ct(this.TABLE);W!==0&&Y!==W&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),O!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Fn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var q=!1;return this.isMaster&&(q=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(q=i.bottomOverlay.resetFixedPosition()||q),q=i.inlineStartOverlay.resetFixedPosition()||q,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),q?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=co(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Fn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Le(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,y=0;y<v;y++)l.includes(d[y])||l.push(d[y]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var m=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var w=0;w<m.length;w++)l.push(m[w]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var k=0;k<a;k++)i[k].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=Uye(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=gi(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=QV(o),l=n.cellIndex;if(ai(Ya,n,this.wtRootElement)||ai(Ua,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(ai(mi,n,this.wtRootElement)||ai(Fn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return ai(Ya,n,this.wtRootElement)||ai(za,n,this.wtRootElement)||ai(mi,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=co(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=co(u):a=co(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ct(this.TABLE)}},{key:"getHeight",value:function(){return Tt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ct(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Tt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return gs(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=pt(r)?r():null;return Array.isArray(n)?(n=Fye(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Mf=Zye;var Qye="stickyRowsBottom",ZW={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Gn(ZW,"MIXIN_NAME",Qye,{writable:!1,enumerable:!1});const QW=ZW;var Jye="stickyColumnsStart",JW={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Gn(JW,"MIXIN_NAME",Jye,{writable:!1,enumerable:!1});const iT=JW;function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function FI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tge(n.key),n)}}function ege(e,t,r){return t&&FI(e.prototype,t),r&&FI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tge(e){var t=rge(e,"string");return Bs(t)==="symbol"?t:String(t)}function rge(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M_(e,t)}function M_(e,t){return M_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},M_(e,t)}function ige(e){var t=sge();return function(){var n=gp(e),o;if(t){var i=gp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return age(this,o)}}function age(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lge(e)}function lge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gp(e){return gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gp(e)}var aT=function(e){oge(r,e);var t=ige(r);function r(n,o,i,a){return nge(this,r),t.call(this,n,o,i,a,mi)}return ege(r)}(Mf);gt(aT,QW);gt(aT,iT);const uge=aT;var Ua="top",Fn="bottom",za="inline_start",Ya="top_inline_start_corner",mi="bottom_inline_start_corner",fge=[Ua,Fn,za,Ya,mi],cge=new Map([[Ua,"ht_clone_".concat(Ua)],[Fn,"ht_clone_".concat(Fn)],[za,"ht_clone_".concat(za," ht_clone_left")],[Ya,"ht_clone_".concat(Ya," ht_clone_top_left_corner")],[mi,"ht_clone_".concat(mi," ht_clone_bottom_left_corner")]]),hge=zt,dge=Math.floor,vge=Number.isInteger||function(t){return!hge(t)&&isFinite(t)&&dge(t)===t},yge=$e,gge=vge;yge({target:"Number",stat:!0},{isInteger:gge});function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function pge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e2(n.key),n)}}function mge(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xw(e,t,r){return t=e2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e2(e){var t=bge(e,"string");return Sh(t)==="symbol"?t:String(t)}function bge(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wge=function(){function e(t){pge(this,e),xw(this,"dataAccessObject",void 0),xw(this,"lastScrolledColumnPos",-1),xw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return mge(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var y=!1;return s===-1?y=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(y=v.scrollTo(r,f?r>u:o)),y&&(this.lastScrolledRowPos=r),y}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Wt(o.wtRootElement),c=co(o.hider),h=co(s),d=qc(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var y=a;y>0;y--)if(v+=n.sumCellSizes(y-1,y),f.top+c-v<=d){u=y;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Wt(o.wtRootElement),f=qc(l,l);if(u.top>f){for(var c=co(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Wt(o.wtRootElement),f=kc(o.hider),c=kc(l),h=Math.abs(Jg(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var y=Wt(i.wtRootElement);c=y.left}var m=Math.abs(Jg(s,s));if(c>m){for(var w=kc(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-m>=w){u=C-2;break}}}return u}}]),e}();const Sge=wge;function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}function Cge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t2(n.key),n)}}function _ge(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ln(e,t,r){return t=t2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t2(e){var t=Oge(e,"string");return Ch(t)==="symbol"?t:String(t)}function Oge(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lT=function(){function e(t,r){Cge(this,e),ln(this,"wtTable",void 0),ln(this,"wtScroll",void 0),ln(this,"wtViewport",void 0),ln(this,"wtOverlays",void 0),ln(this,"selections",void 0),ln(this,"wtEvent",void 0),ln(this,"guid","wt_".concat(kE())),ln(this,"drawInterrupted",!1),ln(this,"drawn",!1),ln(this,"domBindings",void 0),ln(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Sge(this.createScrollDao())}return _ge(e,[{key:"eventManager",get:function(){return new Pt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){$i(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new lp(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new oT(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r2(n.key),n)}}function Rge(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ege(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function Pge(e){var t=$ge();return function(){var n=pp(e),o;if(t){var i=pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kge(this,o)}}function kge(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gg(e)}function gg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $ge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pp(e){return pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pp(e)}function UI(e,t,r){return t=r2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r2(e){var t=Age(e,"string");return Vs(t)==="symbol"?t:String(t)}function Age(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ige=function(e){Tge(r,e);var t=Pge(r);function r(n,o,i){var a;Ege(this,r),a=t.call(this,n,o),UI(gg(a),"cloneSource",void 0),UI(gg(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",gg(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new YW(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Rge(r)}(lT);function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function Mge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n2(n.key),n)}}function xge(e,t,r){return t&&zI(e.prototype,t),r&&zI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dge(e,t,r){return t=n2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n2(e){var t=Nge(e,"string");return _h(t)==="symbol"?t:String(t)}function Nge(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iv=function(){function e(t,r,n,o,i){Mge(this,e),Dge(this,"wtSettings",null),Gn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=Ba(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return xge(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Ba(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Xc(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){bt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Jt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(fge.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(cge.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ua||u==="vertical"&&this.type===za?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Xc(r.TABLE),new Ige(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;A([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function pg(e,t,r){return o2()?pg=Reflect.construct.bind():pg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&mp(u,a.prototype),u},pg.apply(null,arguments)}function Hge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jge(n.key),n)}}function Lge(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jge(e){var t=Fge(e,"string");return Ws(t)==="symbol"?t:String(t)}function Fge(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mp(e,t)}function mp(e,t){return mp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mp(e,t)}function Vge(e){var t=o2();return function(){var n=bp(e),o;if(t){var i=bp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wge(this,o)}}function Wge(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uge(e)}function Uge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bp(e){return bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bp(e)}var zge=function(e){Bge(r,e);var t=Vge(r);function r(n,o,i,a,l,s){var u;return Hge(this,r),u=t.call(this,n,o,mi,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return Lge(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return pg(uge,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else Rv(i),this.repositionOverlay();var s=Tt(this.clone.wtTable.TABLE),u=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}}]),r}(Iv),Yge="calculatedColumns",i2={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Gn(i2,"MIXIN_NAME",Yge,{writable:!1,enumerable:!1});const sT=i2;function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kge(n.key),n)}}function Gge(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kge(e){var t=qge(e,"string");return Us(t)==="symbol"?t:String(t)}function qge(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D_(e,t)}function D_(e,t){return D_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},D_(e,t)}function Qge(e){var t=tpe();return function(){var n=wp(e),o;if(t){var i=wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jge(this,o)}}function Jge(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return epe(e)}function epe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wp(e){return wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wp(e)}var uT=function(e){Zge(r,e);var t=Qge(r);function r(n,o,i,a){return Xge(this,r),t.call(this,n,o,i,a,Fn)}return Gge(r)}(Mf);gt(uT,QW);gt(uT,sT);const rpe=uT;function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function mg(e,t,r){return l2()?mg=Reflect.construct.bind():mg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Sp(u,a.prototype),u},mg.apply(null,arguments)}function npe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s2(n.key),n)}}function ope(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ipe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sp(e,t)}function Sp(e,t){return Sp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Sp(e,t)}function ape(e){var t=l2();return function(){var n=Cp(e),o;if(t){var i=Cp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lpe(this,o)}}function lpe(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a2(e)}function a2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cp(e){return Cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cp(e)}function spe(e,t,r){return t=s2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s2(e){var t=upe(e,"string");return zs(t)==="symbol"?t:String(t)}function upe(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fpe=function(e){ipe(r,e);var t=ape(r);function r(n,o,i,a){var l;return npe(this,r),l=t.call(this,n,o,Fn,i,a),spe(a2(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return ope(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return mg(rpe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Fa(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Jt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var y=Tt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),h.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return qc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(te(u,"innerBorderBottom"),s=!f):(Le(u,"innerBorderBottom"),s=f)}return s}}]),r}(Iv),cpe="calculatedRows",u2={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Gn(u2,"MIXIN_NAME",cpe,{writable:!1,enumerable:!1});const f2=u2;function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dpe(n.key),n)}}function hpe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dpe(e){var t=vpe(e,"string");return Ys(t)==="symbol"?t:String(t)}function vpe(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ype(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N_(e,t)}function N_(e,t){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N_(e,t)}function ppe(e){var t=wpe();return function(){var n=_p(e),o;if(t){var i=_p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mpe(this,o)}}function mpe(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bpe(e)}function bpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _p(e){return _p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_p(e)}var fT=function(e){gpe(r,e);var t=ppe(r);function r(n,o,i,a){return ype(this,r),t.call(this,n,o,i,a,za)}return hpe(r)}(Mf);gt(fT,f2);gt(fT,iT);const Spe=fT;function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function bg(e,t,r){return c2()?bg=Reflect.construct.bind():bg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Op(u,a.prototype),u},bg.apply(null,arguments)}function Cpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ope(n.key),n)}}function _pe(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ope(e){var t=Rpe(e,"string");return Gs(t)==="symbol"?t:String(t)}function Rpe(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Epe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Op(e,t)}function Op(e,t){return Op=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Op(e,t)}function Tpe(e){var t=c2();return function(){var n=Rp(e),o;if(t){var i=Rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ppe(this,o)}}function Ppe(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kpe(e)}function kpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rp(e){return Rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rp(e)}var $pe=function(e){Epe(r,e);var t=Tpe(r);function r(n,o,i,a){return Cpe(this,r),t.call(this,n,o,za,i,a)}return _pe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return bg(Spe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Bm(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),Rv(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,ps(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=ct(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(Jg(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Le(i,"emptyRows"):te(i,"emptyRows");var u=!1;if(l&&!a.length)te(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(te(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(Le(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(Iv),Ape="stickyRowsTop",h2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Gn(h2,"MIXIN_NAME",Ape,{writable:!1,enumerable:!1});const d2=h2;function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mpe(n.key),n)}}function Ipe(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mpe(e){var t=xpe(e,"string");return Ks(t)==="symbol"?t:String(t)}function xpe(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Npe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H_(e,t)}function H_(e,t){return H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},H_(e,t)}function Hpe(e){var t=Fpe();return function(){var n=Ep(e),o;if(t){var i=Ep(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lpe(this,o)}}function Lpe(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jpe(e)}function jpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ep(e)}var cT=function(e){Npe(r,e);var t=Hpe(r);function r(n,o,i,a){return Dpe(this,r),t.call(this,n,o,i,a,Ya)}return Ipe(r)}(Mf);gt(cT,d2);gt(cT,iT);const Bpe=cT;function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function wg(e,t,r){return v2()?wg=Reflect.construct.bind():wg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Tp(u,a.prototype),u},wg.apply(null,arguments)}function Vpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y2(n.key),n)}}function Wpe(e,t,r){return t&&QI(e.prototype,t),r&&QI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Upe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tp(e,t)}function Tp(e,t){return Tp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Tp(e,t)}function zpe(e){var t=v2();return function(){var n=Pp(e),o;if(t){var i=Pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ype(this,o)}}function Ype(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L_(e)}function L_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pp(e){return Pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pp(e)}function JI(e,t,r){return t=y2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y2(e){var t=Gpe(e,"string");return qs(t)==="symbol"?t:String(t)}function Gpe(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kpe=function(e){Upe(r,e);var t=zpe(r);function r(n,o,i,a,l,s){var u;return Vpe(this,r),u=t.call(this,n,o,Ya,i,a),JI(L_(u),"topOverlay",void 0),JI(L_(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return Wpe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return wg(Bpe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();Bm(o,"".concat(i,"px"),"".concat(a,"px"))}else Rv(o);var l=Tt(this.clone.wtTable.TABLE),s=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(Iv);function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xpe(n.key),n)}}function qpe(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xpe(e){var t=Zpe(e,"string");return Xs(t)==="symbol"?t:String(t)}function Zpe(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j_(e,t)}function j_(e,t){return j_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},j_(e,t)}function eme(e){var t=nme();return function(){var n=kp(e),o;if(t){var i=kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tme(this,o)}}function tme(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rme(e)}function rme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kp(e){return kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kp(e)}var hT=function(e){Jpe(r,e);var t=eme(r);function r(n,o,i,a){return Qpe(this,r),t.call(this,n,o,i,a,Ua)}return qpe(r)}(Mf);gt(hT,d2);gt(hT,sT);const ome=hT;function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function Sg(e,t,r){return p2()?Sg=Reflect.construct.bind():Sg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&$p(u,a.prototype),u},Sg.apply(null,arguments)}function ime(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m2(n.key),n)}}function ame(e,t,r){return t&&tM(e.prototype,t),r&&tM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$p(e,t)}function $p(e,t){return $p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$p(e,t)}function sme(e){var t=p2();return function(){var n=Ap(e),o;if(t){var i=Ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ume(this,o)}}function ume(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g2(e)}function g2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ap(e){return Ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ap(e)}function fme(e,t,r){return t=m2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m2(e){var t=cme(e,"string");return Zs(t)==="symbol"?t:String(t)}function cme(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hme=function(e){lme(r,e);var t=sme(r);function r(n,o,i,a){var l;return ime(this,r),l=t.call(this,n,o,Ua,i,a),fme(g2(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return ame(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Sg(ome,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),Bm(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),Rv(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Fa(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Tt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Jt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return qc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Le(a,"emptyColumns"):te(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(te(a,"innerBorderTop"),s=!h):(Le(a,"innerBorderTop"),s=h)}}return s}}]),r}(Iv);function Oh(e){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}function ui(e,t,r){return dme()?ui=Reflect.construct.bind():ui=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&F_(u,a.prototype),u},ui.apply(null,arguments)}function dme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F_(e,t){return F_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},F_(e,t)}function vme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b2(n.key),n)}}function yme(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zn(e,t,r){return t=b2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b2(e){var t=gme(e,"string");return Oh(t)==="symbol"?t:String(t)}function gme(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pme=function(){function e(t,r,n,o,i,a){var l=this;vme(this,e),Zn(this,"wot",null),Zn(this,"topOverlay",null),Zn(this,"bottomOverlay",null),Zn(this,"inlineStartOverlay",null),Zn(this,"topInlineStartCornerOverlay",null),Zn(this,"bottomInlineStartCornerOverlay",null),Zn(this,"browserLineHeight",void 0),Zn(this,"wtSettings",null),Zn(this,"resizeObserver",new ResizeObserver(function(h){jm(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Jt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Xc(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return yme(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ui(hme,r),this.bottomOverlay=ui(fpe,r),this.inlineStartOverlay=ui($pe,r),this.topInlineStartCornerOverlay=ui(Kpe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ui(zge,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!CE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var y=v.clone.wtTable.holder;r.eventManager.addEventListener(y,"wheel",function(m){return r.onCloneWheel(m,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=ys(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Xc(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,y=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<y,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return A(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const mme=pme;function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function bme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w2(n.key),n)}}function wme(e,t,r){return t&&nM(e.prototype,t),r&&nM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oM(e,t,r){return t=w2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w2(e){var t=Sme(e,"string");return Rh(t)==="symbol"?t:String(t)}function Sme(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cme=function(){function e(t){var r=this;bme(this,e),oM(this,"settings",{}),oM(this,"defaults",Object.freeze(this.getDefaults())),ze(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return wme(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);$i(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?ze(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function _me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rme(n.key),n)}}function Ome(e,t,r){return t&&iM(e.prototype,t),r&&iM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rme(e){var t=Eme(e,"string");return Qs(t)==="symbol"?t:String(t)}function Eme(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B_(e,t)}function B_(e,t){return B_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},B_(e,t)}function Pme(e){var t=Ame();return function(){var n=Ip(e),o;if(t){var i=Ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kme(this,o)}}function kme(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $me(e)}function $me(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ame(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}var dT=function(e){Tme(r,e);var t=Pme(r);function r(n,o,i,a){return _me(this,r),t.call(this,n,o,i,a,"master")}return Ome(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Ba(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=ms(o,"height",i),u=ms(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,y=d.height,m=["auto","hidden","scroll"];if(l&&m.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Ai(w,i).height,10);l.removeChild(w),S===0&&(y=0)}y=Math.min(y,h),f.height=s==="auto"?"auto":"".concat(y,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:y>0,this.hasTableWidth=v>0}this.isTableVisible=gs(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Mf);gt(dT,f2);gt(dT,sT);const Ime=dT;function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function Mme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dme(n.key),n)}}function xme(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dme(e){var t=Nme(e,"string");return Eh(t)==="symbol"?t:String(t)}function Nme(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hme=function(){function e(t,r,n,o,i){var a=this;Mme(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return xme(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Tt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,y;if(u)return ct(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(y=ms(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,a.clientWidth);var m=r.getSetting("stretchH");return m==="none"||!m?Math.max(v,ct(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Wt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Tt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=ct(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:la,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===la?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Jt(this.domBindings.rootDocument),new BW({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:la,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new nT({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(lr),i=this.createColumnsCalculator(lr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(la),this.columnsRenderCalculator=this.createColumnsCalculator(la)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(lr),this.columnsVisibleCalculator=this.createColumnsCalculator(lr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){ze(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const Lme=Hme;function Js(e){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Js(e)}function jme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bme(n.key),n)}}function Fme(e,t,r){return t&&lM(e.prototype,t),r&&lM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bme(e){var t=Vme(e,"string");return Js(t)==="symbol"?t:String(t)}function Vme(e,t){if(Js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V_(e,t)}function V_(e,t){return V_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},V_(e,t)}function Ume(e){var t=Yme();return function(){var n=Mp(e),o;if(t){var i=Mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zme(this,o)}}function zme(e,t){if(t&&(Js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W_(e)}function W_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}var Gme=function(e){Wme(r,e);var t=Ume(r);function r(n,o){var i;jme(this,r),i=t.call(this,n,new Cme(o));var a=i.wtSettings.getSetting("facade",W_(i));return i.wtTable=new Ime(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new Lme(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new YW(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new mme(W_(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return Fme(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];ze(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Le(this.wtTable.wtRootElement.parentNode,a),te(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(lT);function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function Kme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xme(n.key),n)}}function qme(e,t,r){return t&&sM(e.prototype,t),r&&sM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xme(e){var t=Zme(e,"string");return Th(t)==="symbol"?t:String(t)}function Zme(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qme=function(){function e(t){Kme(this,e),t instanceof lT?this._wot=t:this._initFromSettings(t)}return qme(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new Gme(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),S2=Yt,Jme=je,C2=Ye,ebe=sv,tbe=ev,rbe=zr,nbe=ov.f,_2=C2(nbe),obe=C2([].push),ibe=S2&&Jme(function(){var e=Object.create(null);return e[2]=2,!_2(e,2)}),uM=function(e){return function(t){for(var r=rbe(t),n=tbe(r),o=ibe&&ebe(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!S2||(o?s in r:_2(r,s)))&&obe(l,e?[s,r[s]]:r[s]);return l}},abe={entries:uM(!0),values:uM(!1)},lbe=$e,sbe=abe.values;lbe({target:"Object",stat:!0},{values:function(t){return sbe(t)}});function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function Dw(e,t){return hbe(e)||cbe(e,t)||fbe(e,t)||ube()}function ube(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fbe(e,t){if(e){if(typeof e=="string")return fM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fM(e,t)}}function fM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hbe(e){if(Array.isArray(e))return e}function dbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ybe(n.key),n)}}function vbe(e,t,r){return t&&cM(e.prototype,t),r&&cM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ybe(e){var t=gbe(e,"string");return Ph(t)==="symbol"?t:String(t)}function gbe(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pbe=function(){function e(t,r){dbe(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return vbe(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),bn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),gn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};ze(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};ze(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,y=parseInt(c.borderWidth,10),m=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-m-1,10),"px"),c[u]="".concat(parseInt(i-m-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var k=Math.min(parseInt(i+a,10),S-m-y*2),O=Math.min(parseInt(i+a-w/4,10),S-w-y*2);d[u]="".concat(k,"px"),v[u]="".concat(O,"px");var W=Math.min(parseInt(o+l,10),C-m-y*2),Y=Math.min(parseInt(o+l-w/4,10),C-w-y*2);d.top="".concat(W,"px"),v.top="".concat(Y,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var y=o.rowFilter.renderedToSource(v);if(y>=r[0]&&y<=r[2]){l=y,c=r[0];break}}for(var m=d-1;m>=0;m-=1){var w=o.rowFilter.renderedToSource(m);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var k=o.columnFilter.renderedToSource(C);if(k>=r[1]&&k<=r[3]){u=k,h=r[1];break}}for(var O=S-1;O>=0;O-=1){var W=o.columnFilter.renderedToSource(O);if(W>=r[1]&&W<=r[3]){f=W;break}}if(l===void 0||u===void 0){this.disappear();return}var Y=o.getCell(this.wot.createCellCoords(l,u)),q=l!==s||u!==f,G=q?o.getCell(this.wot.createCellCoords(s,f)):Y,X=Wt(Y),Q=q?Wt(G):X,oe=Wt(o.TABLE),J=ct(o.TABLE),ue=X.top,he=X.left,Oe=this.wot.wtSettings.getSetting("rtlMode"),we=0,$=0;if(Oe){var P=ct(Y),g=a.innerWidth-oe.left-J;$=he+P-Q.left,we=a.innerWidth-he-P-g-1}else $=Q.left+ct(G)-he,we=he-oe.left-1;if(this.isEntireColumnSelected(l,s)){var p=this.getDimensionsFromHeader("columns",u,f,c,oe),b=null;if(p){var E=Dw(p,3);b=E[0],we=E[1],$=E[2]}b&&(Y=b)}var R=ue-oe.top-1,F=Q.top+Tt(G)-ue;if(this.isEntireRowSelected(u,f)){var x=this.getDimensionsFromHeader("rows",l,s,h,oe),K=null;if(x){var Z=Dw(x,3);K=Z[0],R=Z[1],F=Z[2]}K&&(Y=K)}var re=Ai(Y,a);parseInt(re.borderTopWidth,10)>0&&(R+=1,F=F>0?F-1:0),parseInt(re[Oe?"borderRightWidth":"borderLeftWidth"],10)>0&&(we+=1,$=$>0?$-1:0);var ie=Oe?"right":"left";this.topStyle.top="".concat(R,"px"),this.topStyle[ie]="".concat(we,"px"),this.topStyle.width="".concat($,"px"),this.topStyle.display="block",this.startStyle.top="".concat(R,"px"),this.startStyle[ie]="".concat(we,"px"),this.startStyle.height="".concat(F,"px"),this.startStyle.display="block";var se=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(R+F-se,"px"),this.bottomStyle[ie]="".concat(we,"px"),this.bottomStyle.width="".concat($,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(R,"px"),this.endStyle[ie]="".concat(we+$-se,"px"),this.endStyle.height="".concat(F+1,"px"),this.endStyle.display="block";var _e=this.settings.border.cornerVisible;_e=typeof _e=="function"?_e(this.settings.layerLevel):_e;var Se=this.wot.getSetting("onModifyGetCellCoords",s,f),U=s,Ne=f;if(Se&&Array.isArray(Se)){var Be=Dw(Se,4);U=Be[2],Ne=Be[3]}if(gn()||!_e||this.isPartRange(U,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(R+F+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ie]="".concat(we+$+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ke=Ba(o.TABLE),Ie=ke===a;Ie&&(ke=i.documentElement);var Ae=parseInt(this.cornerDefaultStyle.width,10)/2,_=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var T=Ie?G.getBoundingClientRect().left:G.offsetLeft,I=!1,j=0;Oe?(j=T-parseInt(this.cornerDefaultStyle.width,10)/2,I=j<0):(j=T+ct(G)+parseInt(this.cornerDefaultStyle.width,10)/2,I=j>=kc(ke)),I&&(this.cornerStyle[ie]="".concat(Math.floor(we+$+this.cornerCenterPointOffset-Ae),"px"),this.cornerStyle[Oe?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ie?G.getBoundingClientRect().top:G.offsetTop,B=M+Tt(G)+parseInt(this.cornerDefaultStyle.height,10)/2,N=B>=co(ke);N&&(this.cornerStyle.top="".concat(Math.floor(R+F+this.cornerCenterPointOffset-_),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}gn()&&this.updateMultipleSelectionHandlesPosition(s,f,R,we,$,F)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,y=null,m=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Tt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return ct.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(y=u(n,w-i),m=u(o,w-i),!y||!m)return!1;var S=Wt(y),C=Wt(m);return y&&m&&(h=S[v]-a[v]-1,d=C[v]+f(m)-S[v]),[y,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?te(this[r],"hidden"):(xe(this[r],"hidden")&&Le(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?te(this[r],"hidden"):Le(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",gn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const mbe=pbe;function bbe(e,t){return _be(e)||Cbe(e,t)||Sbe(e,t)||wbe()}function wbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sbe(e,t){if(e){if(typeof e=="string")return hM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hM(e,t)}}function hM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _be(e){if(Array.isArray(e))return e}function eu(e){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function Obe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ebe(n.key),n)}}function Rbe(e,t,r){return t&&dM(e.prototype,t),r&&dM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ebe(e){var t=Tbe(e,"string");return eu(t)==="symbol"?t:String(t)}function Tbe(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pbe=function(){function e(t,r){Obe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Rbe(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new mbe(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(eu(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),te(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=bbe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,m=c.selectionType,w=m===void 0||["active-header","header"].includes(m);if(w&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var k=r.wtTable.columnFilter.renderedToSource(C);if(k>=s&&k<=f){var O=r.wtTable.getColumnHeaders(k),W=O.length-1;y&&O.length>1&&(O=[O[W]]);for(var Y=0;Y<O.length;Y+=1){var q=[],G=O[Y];h&&q.push(h),d&&q.push(d),Y=y?W:Y;var X=r.getSetting("onBeforeHighlightingColumnHeader",k,Y,{selectionType:m,columnCursor:S,selectionWidth:f-s+1,classNames:q});X!==k&&(G=r.wtTable.getColumnHeader(X,Y)),te(G,q)}S+=1}}if(l!==null&&u!==null)for(var Q=0,oe=0;oe<n;oe+=1){var J=r.wtTable.rowFilter.renderedToSource(oe);if(w&&J>=l&&J<=u){var ue=r.wtTable.getRowHeaders(J),he=ue.length-1;y&&ue.length>1&&(ue=[ue[he]]);for(var Oe=0;Oe<ue.length;Oe+=1){var we=[],$=ue[Oe];h&&we.push(h),v&&we.push(v),Oe=y?he:Oe;var P=r.getSetting("onBeforeHighlightingRowHeader",J,Oe,{selectionType:m,rowCursor:Q,selectionHeight:u-l+1,classNames:we});P!==J&&($=r.wtTable.getRowHeader(P,Oe)),te($,we)}Q+=1}if(s!==null&&f!==null)for(var g=0;g<o;g+=1){var p=r.wtTable.columnFilter.renderedToSource(g);J>=l&&J<=u&&p>=s&&p<=f?this.settings.className&&this.addClassAtCoords(r,J,p,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,p,v):p>=s&&p<=f&&d&&this.addClassAtCoords(r,J,p,d);var b=r.getSetting("onAfterDrawSelection",J,p,this.settings.layerLevel);typeof b=="string"&&this.addClassAtCoords(r,J,p,b)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const kbe=Pbe;var $be=$e,Abe=ol.findIndex,Ibe=tv,U_="findIndex",O2=!0;U_ in[]&&Array(1)[U_](function(){O2=!1});$be({target:"Array",proto:!0,forced:O2},{findIndex:function(t){return Abe(this,t,arguments.length>1?arguments[1]:void 0)}});Ibe(U_);var Mbe="localHooks",R2={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)ep(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Gn(R2,"MIXIN_NAME",Mbe,{writable:!1,enumerable:!1});const Mr=R2;function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function xbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nbe(n.key),n)}}function Dbe(e,t,r){return t&&vM(e.prototype,t),r&&vM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nbe(e){var t=Hbe(e,"string");return kh(t)==="symbol"?t:String(t)}function Hbe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ul=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;xbe(this,e),this.indexedValues=[],this.initValueOrFn=t}return Dbe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,pt(this.initValueOrFn)?Ce(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Ce(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();gt(ul,Mr);function Nw(e){return Bbe(e)||Fbe(e)||jbe(e)||Lbe()}function Lbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jbe(e,t){if(e){if(typeof e=="string")return z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z_(e,t)}}function Fbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bbe(e){if(Array.isArray(e))return z_(e)}function z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vT(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Nw(e.slice(0,o)),Nw(r.map(function(i,a){return pt(n)?n(i,a):n})),Nw(o===void 0?[]:e.slice(o)))}function yT(e,t){return Wr(e,function(r,n){return t.includes(n)===!1})}function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function Vbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ube(n.key),n)}}function Wbe(e,t,r){return t&&yM(e.prototype,t),r&&yM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ube(e){var t=zbe(e,"string");return tu(t)==="symbol"?t:String(t)}function zbe(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ic(){return typeof Reflect<"u"&&Reflect.get?Ic=Reflect.get.bind():Ic=function(t,r,n){var o=Ybe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ic.apply(this,arguments)}function Ybe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ga(e),e!==null););return e}function Gbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y_(e,t)}function Y_(e,t){return Y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Y_(e,t)}function Kbe(e){var t=Zbe();return function(){var n=Ga(e),o;if(t){var i=Ga(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qbe(this,o)}}function qbe(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xbe(e)}function Xbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ga(e){return Ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ga(e)}var Hi=function(e){Gbe(r,e);var t=Kbe(r);function r(){return Vbe(this,r),t.apply(this,arguments)}return Wbe(r,[{key:"insert",value:function(o,i){this.indexedValues=vT(this.indexedValues,o,i,this.initValueOrFn),Ic(Ga(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=yT(this.indexedValues,o),Ic(Ga(r.prototype),"remove",this).call(this,o)}}]),r}(ul);function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function Qbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ewe(n.key),n)}}function Jbe(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ewe(e){var t=twe(e,"string");return ru(t)==="symbol"?t:String(t)}function twe(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G_(e,t)}function G_(e,t){return G_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},G_(e,t)}function nwe(e){var t=awe();return function(){var n=xp(e),o;if(t){var i=xp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return owe(this,o)}}function owe(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iwe(e)}function iwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function awe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xp(e){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xp(e)}var Ym=function(e){rwe(r,e);var t=nwe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Qbe(this,r),t.call(this,n)}return Jbe(r,[{key:"getHiddenIndexes",value:function(){return jt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Hi);function Hw(e){return fwe(e)||uwe(e)||swe(e)||lwe()}function lwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function swe(e,t){if(e){if(typeof e=="string")return K_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K_(e,t)}}function uwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fwe(e){if(Array.isArray(e))return K_(e)}function K_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gT(e,t,r){return[].concat(Hw(e.slice(0,t)),Hw(r),Hw(e.slice(t)))}function $h(e,t){return Wr(e,function(r){return t.includes(r)===!1})}function pT(e,t){return We(e,function(r){return r-t.filter(function(n){return n<r}).length})}function mT(e,t){var r=t[0],n=t.length;return We(e,function(o){return o>=r?o+n:o})}function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function cwe(e){return ywe(e)||vwe(e)||dwe(e)||hwe()}function hwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dwe(e,t){if(e){if(typeof e=="string")return q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q_(e,t)}}function vwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ywe(e){if(Array.isArray(e))return q_(e)}function q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T2(n.key),n)}}function pwe(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function so(){return typeof Reflect<"u"&&Reflect.get?so=Reflect.get.bind():so=function(t,r,n){var o=mwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},so.apply(this,arguments)}function mwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vn(e),e!==null););return e}function bwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X_(e,t)}function X_(e,t){return X_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},X_(e,t)}function wwe(e){var t=Cwe();return function(){var n=vn(e),o;if(t){var i=vn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Swe(this,o)}}function Swe(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E2(e)}function E2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vn(e){return vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vn(e)}function _we(e,t,r){return t=T2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T2(e){var t=Owe(e,"string");return nu(t)==="symbol"?t:String(t)}function Owe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gm=function(e){bwe(r,e);var t=wwe(r);function r(){var n;gwe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),_we(E2(n),"orderOfIndexes",[]),n}return pwe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=cwe(Array(o.length).keys()),so(vn(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=$h(this.orderOfIndexes,[o]),pt(this.initValueOrFn)?so(vn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):so(vn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,so(vn(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=vT(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=mT(this.orderOfIndexes,i),so(vn(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=yT(this.indexedValues,o),this.orderOfIndexes=$h(this.orderOfIndexes,o),this.orderOfIndexes=pT(this.orderOfIndexes,o),so(vn(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(ul);function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function Rwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Twe(n.key),n)}}function Ewe(e,t,r){return t&&mM(e.prototype,t),r&&mM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Twe(e){var t=Pwe(e,"string");return ou(t)==="symbol"?t:String(t)}function Pwe(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z_(e,t)}function Z_(e,t){return Z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Z_(e,t)}function $we(e){var t=Mwe();return function(){var n=Dp(e),o;if(t){var i=Dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Awe(this,o)}}function Awe(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iwe(e)}function Iwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dp(e){return Dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dp(e)}var Mv=function(e){kwe(r,e);var t=$we(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Rwe(this,r),t.call(this,n)}return Ewe(r,[{key:"getTrimmedIndexes",value:function(){return jt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Hi),bM=new Map([["indexesSequence",{getListWithInsertedItems:gT,getListWithRemovedItems:$h}],["physicallyIndexed",{getListWithInsertedItems:vT,getListWithRemovedItems:yT}]]),P2=function(t){if(bM.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return bM.get(t)};function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function xwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nwe(n.key),n)}}function Dwe(e,t,r){return t&&wM(e.prototype,t),r&&wM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nwe(e){var t=Hwe(e,"string");return iu(t)==="symbol"?t:String(t)}function Hwe(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mc(){return typeof Reflect<"u"&&Reflect.get?Mc=Reflect.get.bind():Mc=function(t,r,n){var o=Lwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mc.apply(this,arguments)}function Lwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ka(e),e!==null););return e}function jwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q_(e,t)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q_(e,t)}function Fwe(e){var t=Wwe();return function(){var n=Ka(e),o;if(t){var i=Ka(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bwe(this,o)}}function Bwe(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vwe(e)}function Vwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ka(e){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ka(e)}var k2=function(e){jwe(r,e);var t=Fwe(r);function r(){return xwe(this,r),t.call(this,function(n){return n})}return Dwe(r,[{key:"insert",value:function(o,i){var a=mT(this.indexedValues,i);this.indexedValues=gT(a,o,i),Mc(Ka(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=$h(this.indexedValues,o);this.indexedValues=pT(i,o),Mc(Ka(r.prototype),"remove",this).call(this,o)}}]),r}(ul),SM=new Map([["hiding",Ym],["index",ul],["linkedPhysicalIndexToValue",Gm],["physicalIndexToValue",Hi],["trimming",Mv]]);function Uwe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!SM.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(SM.get(e))(t)}function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function zwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gwe(n.key),n)}}function Ywe(e,t,r){return t&&CM(e.prototype,t),r&&CM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gwe(e){var t=Kwe(e,"string");return Ah(t)==="symbol"?t:String(t)}function Kwe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J_=0,bT=function(){function e(){zwe(this,e),this.collection=new Map}return Ywe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),J_+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);ve(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),J_-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return mt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();gt(bT,Mr);function qwe(){return J_}function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function Xwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qwe(n.key),n)}}function Zwe(e,t,r){return t&&_M(e.prototype,t),r&&_M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qwe(e){var t=Jwe(e,"string");return au(t)==="symbol"?t:String(t)}function Jwe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function tSe(e){var t=oSe();return function(){var n=Np(e),o;if(t){var i=Np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rSe(this,o)}}function rSe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nSe(e)}function nSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Np(e)}var OM=function(e){eSe(r,e);var t=tSe(r);function r(n,o){var i;return Xwe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return Zwe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=We(this.get(),function(c){return c.getValues()}),a=[],l=ve(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return We(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ve(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(bT);function Ih(e){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}function iSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lSe(n.key),n)}}function aSe(e,t,r){return t&&RM(e.prototype,t),r&&RM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lSe(e){var t=sSe(e,"string");return Ih(t)==="symbol"?t:String(t)}function sSe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uSe(e,t,r){fSe(e,t),t.set(e,r)}function fSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cSe(e,t,r){var n=$2(e,t,"set");return hSe(e,n,r),r}function hSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function dSe(e,t){var r=$2(e,t,"get");return vSe(e,r)}function $2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vSe(e,t){return t.get?t.get.call(e):t.value}var Lw=new WeakMap,A2=function(){function e(){iSe(this,e),uSe(this,Lw,{writable:!0,value:[]})}return aSe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(dSe(this,Lw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){cSe(this,Lw,r)}}]),e}();gt(A2,Mr);function EM(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function ySe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pSe(n.key),n)}}function gSe(e,t,r){return t&&TM(e.prototype,t),r&&TM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pSe(e){var t=mSe(e,"string");return Mh(t)==="symbol"?t:String(t)}function mSe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zf(e,t,r){bSe(e,t),t.set(e,r)}function bSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(e,t){var r=I2(e,t,"get");return wSe(e,r)}function wSe(e,t){return t.get?t.get.call(e):t.value}function dy(e,t,r){var n=I2(e,t,"set");return SSe(e,n,r),r}function I2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function SSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var vy=new WeakMap,Qf=new WeakMap,yy=new WeakMap,gy=new WeakMap,py=new WeakMap,CSe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;ySe(this,e),Zf(this,vy,{writable:!0,value:new Set}),Zf(this,Qf,{writable:!0,value:[]}),Zf(this,yy,{writable:!0,value:[]}),Zf(this,gy,{writable:!0,value:!1}),Zf(this,py,{writable:!0,value:!1}),dy(this,py,r??!1)}return gSe(e,[{key:"createObserver",value:function(){var r=this,n=new A2;return Kr(this,vy).add(n),n.addLocalHook("unsubscribe",function(){Kr(r,vy).delete(n)}),n._writeInitialChanges(EM(Kr(this,Qf),Kr(this,yy))),n}},{key:"emit",value:function(r){var n=Kr(this,yy);(!Kr(this,gy)||Kr(this,Qf).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Kr(this,py)):dy(this,Qf,new Array(r.length).fill(Kr(this,py))),Kr(this,gy)||(dy(this,gy,!0),n=Kr(this,Qf)));var o=EM(n,r);Kr(this,vy).forEach(function(i){return i._write(o)}),dy(this,yy,r)}}]),e}();function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function jw(e){return ESe(e)||RSe(e)||OSe(e)||_Se()}function _Se(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OSe(e,t){if(e){if(typeof e=="string")return tO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tO(e,t)}}function RSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ESe(e){if(Array.isArray(e))return tO(e)}function tO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kSe(n.key),n)}}function PSe(e,t,r){return t&&PM(e.prototype,t),r&&PM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kSe(e){var t=$Se(e,"string");return xh(t)==="symbol"?t:String(t)}function $Se(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rO=function(){function e(){var t=this;TSe(this,e),this.indexesSequence=new k2,this.trimmingMapsCollection=new OM(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new OM(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new bT,this.hidingChangesObservable=new CSe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return PSe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,Uwe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof Mv?this.trimmingMapsCollection.register(r,n):n instanceof Ym?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ve(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ve(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ve(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ve(n)?n:null}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=jw(new Array(r).keys()),this.notHiddenIndexesCache=jw(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=jw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=We(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=$h(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(gT(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ve(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=We(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();gt(rO,Mr);function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function kM(e,t){return xSe(e)||MSe(e,t)||ISe(e,t)||ASe()}function ASe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ISe(e,t){if(e){if(typeof e=="string")return $M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $M(e,t)}}function $M(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xSe(e){if(Array.isArray(e))return e}function DSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HSe(n.key),n)}}function NSe(e,t,r){return t&&AM(e.prototype,t),r&&AM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HSe(e){var t=LSe(e,"string");return lu(t)==="symbol"?t:String(t)}function LSe(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,r,n){var o=jSe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function jSe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function FSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function BSe(e){var t=WSe();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VSe(this,o)}}function VSe(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M2(e)}function M2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}ge.getSingleton().register("modifyAutoColumnSizeSeed");var Jf="autoColumnSize",USe=10,Fw=new WeakMap,zSe="autoColumnSize",YSe=function(e){FSe(r,e);var t=BSe(r);function r(n){var o;return DSe(this,r),o=t.call(this,n),Fw.set(M2(o),{cachedColumnHeaders:[]}),o.ghostTable=new rT(o.hot),o.samplesGenerator=new FW(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Hi,o.hot.columnIndexMapper.registerMap(zSe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return NSe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Jf]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Jf];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),fa(vo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),fa(vo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;fa(vo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Ce(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);A(h,function(d){var v=kM(d,2),y=v[0],m=v[1];return o.ghostTable.addColumn(y,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Gc(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=jm(c):(Gc(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Jf],i=o&&Mt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&Mt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Jf],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ue(o)&&(i=o.syncLimit,$E(i)?i=jE(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,nT.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=Fw.get(this),a=i.cachedColumnHeaders,l=jt(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){A(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=We(o,function(l){var s=kM(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){Fw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Wr(o,function(l){var s;return ve((s=l.address)===null||s===void 0?void 0:s.col)}),a=We(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),fa(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Jf}},{key:"PLUGIN_PRIORITY",get:function(){return USe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ot),ca={horizontal:"horizontal",vertical:"vertical"};function GSe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function KSe(e){var t={};return e===!0?(t.directions=Object.keys(ca),t.autoInsertRow=!0):Ue(e)?(ve(e.autoInsertRow)?e.direction===ca.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ve(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(ca)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function qSe(e){return QSe(e)||ZSe(e)||x2(e)||XSe()}function XSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QSe(e){if(Array.isArray(e))return oO(e)}function JSe(e,t){return rCe(e)||tCe(e,t)||x2(e,t)||eCe()}function eCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x2(e,t){if(e){if(typeof e=="string")return oO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oO(e,t)}}function oO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rCe(e){if(Array.isArray(e))return e}function nCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iCe(n.key),n)}}function oCe(e,t,r){return t&&IM(e.prototype,t),r&&IM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iCe(e){var t=aCe(e,"string");return su(t)==="symbol"?t:String(t)}function aCe(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=lCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function lCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function sCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iO(e,t)}function iO(e,t){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iO(e,t)}function uCe(e){var t=cCe();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fCe(this,o)}}function fCe(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D2(e)}function D2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");var MM="autofill",hCe=20,dCe=["fillHandle"],vCe="insert_row_below",yCe=200,gCe=function(e){sCe(r,e);var t=uCe(r);function r(n){var o;return nCe(this,r),o=t.call(this,n),o.eventManager=new Pt(D2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return oCe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),ha(yo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ha(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),ha(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],y=[];return A(h,function(m){for(var w=m.startRow;w<=m.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=m.startCol;S<=m.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),A(d,function(m){var w=[];A(v,function(S){w.push(o.hot.getCopyableData(m,S))}),y.push(w)}),y}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=JSe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),m=GSe(v,y,function(we,$){return o.hot._createCellCoords(we,$)}),w=m.directionOfDrag,S=m.startOfDragCoords,C=m.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var k=this.getSelectionData(),O=c.clone(),W=this.hot._createCellRange(S,S,C),Y=this.hot.runHooks("beforeAutofill",k,O,W,w);if(Y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var q=Y,G=Y;if(["up","left"].indexOf(w)>-1&&!(G.length===1&&G[0].length===0))if(q=[],w==="up")for(var X=C.row-S.row+1,Q=X%G.length,oe=0;oe<X;oe++)q.push(G[(oe+(G.length-Q))%G.length]);else for(var J=C.col-S.col+1,ue=J%G[0].length,he=0;he<G.length;he++){q.push([]);for(var Oe=0;Oe<J;Oe++)q[he].push(G[he][(Oe+(G[he].length-ue))%G[he].length])}this.hot.populateFromArray(S.row,S.col,q,C.row,C.col,"".concat(this.pluginName,".fill"),null),this.setSelection(y),this.hot.runHooks("afterAutofill",q,O,W,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(ca.vertical)&&this.directions.includes(ca.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(ca.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(ca.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(vCe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},yCe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,qSe(We(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Wt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Tt(this.hot.table),l=Wt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+ct(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=KSe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){ha(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MM}},{key:"PLUGIN_PRIORITY",get:function(){return hCe}},{key:"SETTING_KEYS",get:function(){return[MM].concat(dCe)}}]),r}(ot);function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function pCe(e,t){return SCe(e)||wCe(e,t)||bCe(e,t)||mCe()}function mCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bCe(e,t){if(e){if(typeof e=="string")return xM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xM(e,t)}}function xM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SCe(e){if(Array.isArray(e))return e}function CCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OCe(n.key),n)}}function _Ce(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OCe(e){var t=RCe(e,"string");return uu(t)==="symbol"?t:String(t)}function RCe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rs(){return typeof Reflect<"u"&&Reflect.get?rs=Reflect.get.bind():rs=function(t,r,n){var o=ECe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},rs.apply(this,arguments)}function ECe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bi(e),e!==null););return e}function TCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function PCe(e){var t=ACe();return function(){var n=bi(e),o;if(t){var i=bi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kCe(this,o)}}function kCe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ce(e)}function $Ce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ACe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bi(e){return bi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bi(e)}var my="autoRowSize",ICe=40,MCe="autoRowSize",xCe=function(e){TCe(r,e);var t=PCe(r);function r(n){var o;return CCe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new rT(o.hot),o.samplesGenerator=new FW(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Hi,o.hot.rowIndexMapper.registerMap(MCe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return _Ce(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[my];return o===!0||Ue(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),rs(bi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,rs(bi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Ce(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);A(h,function(d){var v=pCe(d,2),y=v[0],m=v[1];return o.ghostTable.addRow(y,m)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Gc(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=jm(c):(Gc(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[my],i=o&&Mt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&Mt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){gs(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[my],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ue(o)&&(i=o.syncLimit,$E(i)?i=jE(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){Ce(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),rs(bi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return my}},{key:"PLUGIN_PRIORITY",get:function(){return ICe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ot);function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function DCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HCe(n.key),n)}}function NCe(e,t,r){return t&&NM(e.prototype,t),r&&NM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HCe(e){var t=LCe(e,"string");return fu(t)==="symbol"?t:String(t)}function LCe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xc(){return typeof Reflect<"u"&&Reflect.get?xc=Reflect.get.bind():xc=function(t,r,n){var o=jCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xc.apply(this,arguments)}function jCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qa(e),e!==null););return e}function FCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function BCe(e){var t=UCe();return function(){var n=qa(e),o;if(t){var i=qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VCe(this,o)}}function VCe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WCe(e)}function WCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qa(e){return qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qa(e)}var N2=P2("physicallyIndexed"),zCe=N2.getListWithInsertedItems,YCe=N2.getListWithRemovedItems,GCe=function(e){FCe(r,e);var t=BCe(r);function r(){return DCe(this,r),t.call(this,function(n){return n})}return NCe(r,[{key:"insert",value:function(o,i){var a=mT(this.indexedValues,i);this.indexedValues=zCe(a,o,i,this.initValueOrFn),xc(qa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=YCe(this.indexedValues,o);this.indexedValues=pT(i,o),xc(qa(r.prototype),"remove",this).call(this,o)}}]),r}(ul);const KCe=GCe;function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function qCe(e){return JCe(e)||QCe(e)||ZCe(e)||XCe()}function XCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZCe(e,t){if(e){if(typeof e=="string")return sO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sO(e,t)}}function QCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JCe(e){if(Array.isArray(e))return sO(e)}function sO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r_e(n.key),n)}}function t_e(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r_e(e){var t=n_e(e,"string");return cu(t)==="symbol"?t:String(t)}function n_e(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dc(){return typeof Reflect<"u"&&Reflect.get?Dc=Reflect.get.bind():Dc=function(t,r,n){var o=o_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dc.apply(this,arguments)}function o_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xa(e),e!==null););return e}function i_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function a_e(e){var t=u_e();return function(){var n=Xa(e),o;if(t){var i=Xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return l_e(this,o)}}function l_e(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s_e(e)}function s_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xa(e){return Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xa(e)}var H2=P2("physicallyIndexed"),f_e=H2.getListWithInsertedItems,c_e=H2.getListWithRemovedItems,h_e=function(e){i_e(r,e);var t=a_e(r);function r(){return e_e(this,r),t.call(this,function(n){return n})}return t_e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=f_e(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),Dc(Xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=c_e(this.indexedValues,o),Dc(Xa(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,qCe(this.getValues()))+1+o}}]),r}(ul);const d_e=h_e;function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function v_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g_e(n.key),n)}}function y_e(e,t,r){return t&&LM(e.prototype,t),r&&LM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g_e(e){var t=p_e(e,"string");return hu(t)==="symbol"?t:String(t)}function p_e(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return typeof Reflect<"u"&&Reflect.get?ns=Reflect.get.bind():ns=function(t,r,n){var o=m_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ns.apply(this,arguments)}function m_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function b_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function w_e(e){var t=__e();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return S_e(this,o)}}function S_e(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C_e(e)}function C_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function __e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}var Bw="bindRowsWithHeaders",O_e=210,R_e="loose",E_e=new Map([["loose",KCe],["strict",d_e]]),T_e=function(e){b_e(r,e);var t=w_e(r);function r(n){var o;return v_e(this,r),o=t.call(this,n),o.headerIndexes=null,o}return y_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Bw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Bw];typeof i!="string"&&(i=R_e);var a=E_e.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),ns(wi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),ns(wi(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){ns(wi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Bw}},{key:"PLUGIN_PRIORITY",get:function(){return O_e}}]),r}(ot);function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function jM(e){return A_e(e)||$_e(e)||k_e(e)||P_e()}function P_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k_e(e,t){if(e){if(typeof e=="string")return cO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cO(e,t)}}function $_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function A_e(e){if(Array.isArray(e))return cO(e)}function cO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L2(n.key),n)}}function M_e(e,t,r){return t&&FM(e.prototype,t),r&&FM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=x_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function x_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function D_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hO(e,t)}function hO(e,t){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hO(e,t)}function N_e(e){var t=L_e();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return H_e(this,o)}}function H_e(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ul(e)}function Ul(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}function j_e(e,t,r){F_e(e,t),t.set(e,r)}function F_e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vw(e,t,r){return t=L2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L2(e){var t=B_e(e,"string");return du(t)==="symbol"?t:String(t)}function B_e(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BM(e,t){var r=j2(e,t,"get");return V_e(e,r)}function V_e(e,t){return t.get?t.get.call(e):t.value}function Ww(e,t,r){var n=j2(e,t,"set");return W_e(e,n,r),r}function j2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function W_e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Uw="collapsibleColumns",U_e=290,z_e=["nestedHeaders"],wl="collapsibleIndicator",VM=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Sl=new WeakMap,Y_e=function(e){D_e(r,e);var t=N_e(r);function r(){var n;I_e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Vw(Ul(n),"nestedHeadersPlugin",null),Vw(Ul(n),"eventManager",new Pt(Ul(n))),Vw(Ul(n),"headerStateManager",null),j_e(Ul(n),Sl,{writable:!0,value:null}),n}return M_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Uw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||bt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Ww(this,Sl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),da(go(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}da(go(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ww(this,Sl,null),this.nestedHeadersPlugin=null,this.clearButtons(),da(go(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};Ce(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;Ce(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(wl));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(wl)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(wl)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!VM.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Wr(o,function(m){var w=m.row;return w<0}),s=l.length>0;A(l,function(m){var w,S=m.row,C=m.col,k=(w=a.headerStateManager.getHeaderSettings(S,C))!==null&&w!==void 0?w:{},O=k.collapsible,W=k.isCollapsed;if(!O||W&&i==="collapse"||!W&&i==="expand")return s=!1,!1});var u=[],f=[];s&&A(l,function(m){var w=m.row,S=m.col,C=a.headerStateManager.triggerNodeModification(i,w,S),k=C.colspanCompensation,O=C.affectedColumns,W=C.rollbackModification;k>0&&(f.push.apply(f,jM(O)),u.push(W))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=SE([].concat(jM(c),f)):i==="expand"&&(h=Wr(c,function(m){return!f.includes(m)}));var d=VM.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){A(u,function(m){m()});return}this.hot.batchExecution(function(){A(f,function(m){BM(a,Sl).setValueAtIndex(a.hot.toPhysicalColumn(m),d.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return BM(this,Sl).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(wl));if(h)d||(d=this.hot.rootDocument.createElement("div"),te(d,wl),i.querySelector("div:first-child").appendChild(d)),Le(d,["collapsed","expanded"]),c?(te(d,"collapsed"),$i(d,"+")):(te(d,"expanded"),$i(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,wl)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),bn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ww(this,Sl,null),da(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Uw}},{key:"PLUGIN_PRIORITY",get:function(){return U_e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Uw].concat(z_e)}}]),r}(ot),G_e=$e,K_e=Yt,q_e=Dj,X_e=zr,Z_e=Un,Q_e=Of;G_e({target:"Object",stat:!0,sham:!K_e},{getOwnPropertyDescriptors:function(t){for(var r=X_e(t),n=Z_e.f,o=q_e(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&Q_e(i,l,s);return i}});var WM=Yt,J_e=Ye,eOe=Xt,tOe=je,zw=ev,rOe=av,nOe=ov,oOe=Ir,iOe=qd,Cl=Object.assign,UM=Object.defineProperty,aOe=J_e([].concat),lOe=!Cl||tOe(function(){if(WM&&Cl({b:1},Cl(UM({},"a",{enumerable:!0,get:function(){UM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),Cl({},e)[r]!=7||zw(Cl({},t)).join("")!=n})?function(t,r){for(var n=oOe(t),o=arguments.length,i=1,a=rOe.f,l=nOe.f;o>i;)for(var s=iOe(arguments[i++]),u=a?aOe(zw(s),a(s)):zw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!WM||eOe(l,s,h))&&(n[h]=s[h]);return n}:Cl,sOe=$e,zM=lOe;sOe({target:"Object",stat:!0,arity:2,forced:Object.assign!==zM},{assign:zM});function Dh(e){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function YM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uOe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YM(Object(r),!0).forEach(function(n){fOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fOe(e,t,r){return t=F2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GM(e,t){return vOe(e)||dOe(e,t)||hOe(e,t)||cOe()}function cOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hOe(e,t){if(e){if(typeof e=="string")return KM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KM(e,t)}}function KM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function vOe(e){if(Array.isArray(e))return e}function yOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F2(n.key),n)}}function gOe(e,t,r){return t&&qM(e.prototype,t),r&&qM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F2(e){var t=pOe(e,"string");return Dh(t)==="symbol"?t:String(t)}function pOe(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mOe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],bOe=!1,wOe=!0,SOe=!0,COe=function(){function e(t,r){yOe(this,e),this.hot=t,this.sortingStates=new Gm,this.sortEmptyCells=bOe,this.indicator=wOe,this.headerAction=SOe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return gOe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ue(r)&&ze(r,function(o,i){mOe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=GM(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ue(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=GM(o,2),a=i[0],l=i[1];return uOe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ve(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Hp="asc",Lp="desc",_Oe="colHeader";function OOe(e){if(Ue(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Hp,Lp].includes(r)}function ROe(e){if(e.some(function(r){return OOe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function XM(e){if(e!==Lp)return e===Hp?Lp:Hp}function ZM(e){var t=e.querySelector(".".concat(_Oe));return t}function QM(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function dO(e,t,r){return e===-1&&t>=0&&ki(r)===!1}var EOe="ascending",TOe="descending",B2="indicatorDisabled",V2="columnSorting",W2="sortAction",U2=new Map([[Hp,EOe],[Lp,TOe]]);function POe(e,t,r,n){var o=[V2];if(n&&o.push(W2),r===!1)return o.push(B2),o;var i=e.getSortOrderOfColumn(t);return ve(i)&&o.push(U2.get(i)),o}function kOe(){return Array.from(U2.values()).concat(W2,B2,V2)}function z2(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Bn:qt(o)?qt(i)?Bn:a&&e==="asc"?At:It:qt(i)?a&&e==="asc"?It:At:isNaN(o)&&!isNaN(i)?e==="asc"?It:At:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?At:It:o>i?e==="asc"?It:At:Bn}}var Y2="default";function $Oe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Bn;if(l){if(qt(n))return e==="asc"?At:It;if(qt(o))return e==="asc"?It:At}return isNaN(i)?It:isNaN(a)?At:i<a?e==="asc"?At:It:i>a?e==="asc"?It:At:Bn}}var AOe="numeric";function IOe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=qt(a),u=qt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return It;if(s===!1&&u)return At}return h===!1&&d?e==="asc"?At:It:h&&d===!1?e==="asc"?It:At:h===!1&&d===!1?z2(e,t,r)(a,l):f===o&&c===n?e==="asc"?At:It:f===n&&c===o?e==="asc"?It:At:Bn}}var MOe="checkbox";function xOe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Bn;if(qt(n))return qt(o)?Bn:i&&e==="asc"?At:It;if(qt(o))return i&&e==="asc"?It:At;var a=t.dateFormat,l=ee(n,a),s=ee(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?At:It:s.isBefore(l)?e==="asc"?It:At:Bn:At:It}}var DOe="date",wT=on("sorting.compareFunctionFactory"),Km=wT.register,JM=wT.getItem,NOe=wT.hasItem,G2=on("sorting.mainSortComparator"),K2=G2.register,HOe=G2.getItem;function q2(e){return NOe(e)?JM(e):JM(Y2)}Km(AOe,$Oe);Km(MOe,IOe);Km(DOe,xOe);Km(Y2,z2);var Bn=0,At=-1,It=1;function LOe(e,t){for(var r=HOe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function ex(e){return VOe(e)||BOe(e)||FOe(e)||jOe()}function jOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FOe(e,t){if(e){if(typeof e=="string")return tx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tx(e,t)}}function tx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VOe(e){if(Array.isArray(e))return e}function WOe(e,t){return function(r,n){var o=ex(r),i=o.slice(1),a=ex(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:q2(c.type),m=y(f,c,v)(h,d);return m}(0)}}function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}var UOe=["column"],zOe=["column"];function _l(e){return qOe(e)||KOe(e)||GOe(e)||YOe()}function YOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GOe(e,t){if(e){if(typeof e=="string")return vO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vO(e,t)}}function KOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qOe(e){if(Array.isArray(e))return vO(e)}function vO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rx(Object(r),!0).forEach(function(n){XOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XOe(e,t,r){return t=X2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ox(e,t){if(e==null)return{};var r=ZOe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZOe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function QOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X2(n.key),n)}}function JOe(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X2(e){var t=eRe(e,"string");return vu(t)==="symbol"?t:String(t)}function eRe(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,r,n){var o=tRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function tRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function rRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yO(e,t)}function nRe(e){var t=aRe();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oRe(this,o)}}function oRe(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iRe(e)}function iRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}var gO="columnSorting",lRe=50,ax="append",sRe="replace";K2(gO,WOe);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var Z2=function(e){rRe(r,e);var t=nRe(r);function r(n){var o;return QOe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=gO,o.indexesSequenceCache=null,o}return JOe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new COe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Hi(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),va(po(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=ZM(s);QM(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,va(po(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new k2),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ve(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return ROe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=ox(u,UOe);return nx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=We(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=ox(u,zOe);return nx({column:o.hot.toVisualColumn(f)},c)};return ve(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=We(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ve(i)){var a=XM(i);return ve(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:XM()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ax,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(mt(u))return[].concat(_l(s.slice(0,a)),_l(s.slice(a+1)));if(i===ax)return[].concat(_l(s.slice(0,a)),_l(s.slice(a+1)),[u]);if(i===sRe)return[].concat(_l(s.slice(0,a)),[u],_l(s.slice(a+1)))}return ve(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ue(o)){var i=o[this.pluginKey];if(Ue(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):pt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(m){return We(o,function(w){return i.hot.getDataAtCell(m,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=We(a,function(y){return y[0]});LOe(a,this.pluginKey,We(o,function(y){return y.sortOrder}),We(o,function(y){return i.getFirstCellSettings(y.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=We(a,function(y){return y[0]}),d=new Map(We(f,function(y,m){return[y,h[m]]})),v=We(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return d.has(y)?d.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ue(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ue(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ue(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=ZM(i);if(!(QM(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(Le(o,kOe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];te(o,POe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){va(po(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ve(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){dO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){dO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),va(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gO}},{key:"PLUGIN_PRIORITY",get:function(){return lRe}}]),r}(ot),uRe=$e,ST=Ye,fRe=Di,cRe=eB,hRe=X0,lx=je,dRe=RangeError,Q2=String,J2=Math.floor,pO=ST(hRe),sx=ST("".slice),ec=ST(1 .toFixed),Xl=function(e,t,r){return t===0?r:t%2===1?Xl(e,t-1,r*e):Xl(e*e,t/2,r)},vRe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},Ol=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=J2(o/1e7)},Yw=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=J2(n/t),n=n%t*1e7},ux=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=Q2(e[t]);r=r===""?n:r+pO("0",7-n.length)+n}return r},yRe=lx(function(){return ec(8e-5,3)!=="0.000"||ec(.9,0)!=="1"||ec(1.255,2)!=="1.25"||ec(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!lx(function(){ec({})});uRe({target:"Number",proto:!0,forced:yRe},{toFixed:function(t){var r=cRe(this),n=fRe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw dRe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return Q2(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=vRe(r*Xl(2,69,1))-69,s=l<0?r*Xl(2,-l,1):r/Xl(2,l,1),s*=4503599627370496,l=52-l,l>0){for(Ol(o,0,s),u=n;u>=7;)Ol(o,1e7,0),u-=7;for(Ol(o,Xl(10,u,1),0),u=l-1;u>=23;)Yw(o,1<<23),u-=23;Yw(o,1<<u),Ol(o,1,1),Yw(o,2),a=ux(o)}else Ol(o,0,s),Ol(o,1<<-l,0),a=ux(o)+pO("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+pO("0",n-f)+a:sx(a,0,f-n)+"."+sx(a,f-n))):a=i+a,a}});function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function gRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mRe(n.key),n)}}function pRe(e,t,r){return t&&fx(e.prototype,t),r&&fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mRe(e){var t=bRe(e,"string");return Nh(t)==="symbol"?t:String(t)}function bRe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wRe=function(){function e(t,r){gRe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return pRe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),A(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();A(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function y(){return l.hot.removeHook("beforeViewRender",y),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;A(h,function(y){f==="row"&&y.destinationRow>=v&&(y.alterRowOffset=c*o),f==="col"&&y.destinationColumn>=v&&(y.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?A(h,function(y){l.extendEndpointRanges(y,v,i[0],i.length),l.recreatePhysicalRanges(y),l.clearOffsetInformation(y)}):A(h,function(y){l.shiftEndpointCoordinates(y,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){A(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];A(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),A(a,function(l){var s=[];A(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,A(r.ranges,function(o){A(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],A(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],A(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],A(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&A(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),A(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){bt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const SRe=wRe;function Gw(e){return e==null||isNaN(e)}function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}var cx;function CRe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RRe(n.key),n)}}function ORe(e,t,r){return t&&hx(e.prototype,t),r&&hx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RRe(e){var t=ERe(e,"string");return yu(t)==="symbol"?t:String(t)}function ERe(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cg(){return typeof Reflect<"u"&&Reflect.get?Cg=Reflect.get.bind():Cg=function(t,r,n){var o=TRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cg.apply(this,arguments)}function TRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gu(e),e!==null););return e}function PRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mO(e,t)}function mO(e,t){return mO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mO(e,t)}function kRe(e){var t=IRe();return function(){var n=gu(e),o;if(t){var i=gu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $Re(this,o)}}function $Re(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ARe(e)}function ARe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gu(e){return gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gu(e)}var Kw="columnSummary",MRe=220,xRe=function(e){PRe(r,e);var t=kRe(r);function r(n){var o;return _Re(this,r),o=t.call(this,n),o.endpoints=null,o}return ORe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Kw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[Kw],this.endpoints=new SRe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),Cg(gu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return ze(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Gw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return ze(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Gw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Gw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return ze(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(dt(cx||(cx=CRe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return Kw}},{key:"PLUGIN_PRIORITY",get:function(){return MRe}}]),r}(ot);function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function DRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HRe(n.key),n)}}function NRe(e,t,r){return t&&dx(e.prototype,t),r&&dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HRe(e){var t=LRe(e,"string");return Hh(t)==="symbol"?t:String(t)}function LRe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jRe=function(){function e(t,r){DRe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return NRe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ct(this.getInputElement()),height:Tt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(r,e.CLASS_EDITOR),te(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const FRe=jRe;var qe="---------";function BRe(){return{name:qe}}function VRe(e){return We(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function by(e){return xe(e,"htSeparator")}function WRe(e){return xe(e,"htSubmenu")}function wy(e){return xe(e,"htDisabled")}function Sy(e){return xe(e,"htSelectionDisabled")}function fl(e){var t=e.getSelected();return!t||t[0]<0?null:t}function URe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function zRe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Gi(e,t){var r={};return A(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function li(e,t,r,n,o){A(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&YRe(a,l,t,r,n,o)})})}function YRe(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=URe(a.className,n):l=zRe(a.className,n)),i(e,t,"className",l)}function Ln(e,t){var r=!1;return Array.isArray(e)&&A(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function ao(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function GRe(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function eU(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function KRe(e,t){var r=e.slice(0);return r.reverse(),r=eU(r,t),r.reverse(),r}function qRe(e){var t=[];return A(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function XRe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,r=e.slice(0);return r=eU(r,t),r=KRe(r,t),r=qRe(r),r}function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function ZRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JRe(n.key),n)}}function QRe(e,t,r){return t&&vx(e.prototype,t),r&&vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JRe(e){var t=e0e(e,"string");return Lh(t)==="symbol"?t:String(t)}function e0e(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t0e=250,r0e=250,tU=function(){function e(t){ZRe(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return QRe(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},r0e)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t0e;this.showDebounced=HE(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();gt(tU,Mr);const n0e=tU;var rU="ContextMenu:items",Fe=rU,CT="".concat(Fe,".noItems"),_T="".concat(Fe,".insertRowAbove"),OT="".concat(Fe,".insertRowBelow"),RT="".concat(Fe,".insertColumnOnTheLeft"),ET="".concat(Fe,".insertColumnOnTheRight"),TT="".concat(Fe,".removeRow"),PT="".concat(Fe,".removeColumn"),kT="".concat(Fe,".undo"),$T="".concat(Fe,".redo"),AT="".concat(Fe,".readOnly"),IT="".concat(Fe,".clearColumn"),MT="".concat(Fe,".copy"),xT="".concat(Fe,".copyWithHeaders"),DT="".concat(Fe,".copyWithGroupHeaders"),NT="".concat(Fe,".copyHeadersOnly"),HT="".concat(Fe,".cut"),LT="".concat(Fe,".freezeColumn"),jT="".concat(Fe,".unfreezeColumn"),FT="".concat(Fe,".mergeCells"),BT="".concat(Fe,".unmergeCells"),VT="".concat(Fe,".addComment"),WT="".concat(Fe,".editComment"),UT="".concat(Fe,".removeComment"),zT="".concat(Fe,".readOnlyComment"),YT="".concat(Fe,".align"),GT="".concat(Fe,".align.left"),KT="".concat(Fe,".align.center"),qT="".concat(Fe,".align.right"),XT="".concat(Fe,".align.justify"),ZT="".concat(Fe,".align.top"),QT="".concat(Fe,".align.middle"),JT="".concat(Fe,".align.bottom"),eP="".concat(Fe,".borders"),tP="".concat(Fe,".borders.top"),rP="".concat(Fe,".borders.right"),nP="".concat(Fe,".borders.bottom"),oP="".concat(Fe,".borders.left"),iP="".concat(Fe,".borders.remove"),aP="".concat(Fe,".nestedHeaders.insertChildRow"),lP="".concat(Fe,".nestedHeaders.detachFromParent"),sP="".concat(Fe,".hideColumn"),uP="".concat(Fe,".showColumn"),fP="".concat(Fe,".hideRow"),cP="".concat(Fe,".showRow"),Or="Filters:",Nt="".concat(Or,"conditions"),qm="".concat(Nt,".none"),hP="".concat(Nt,".isEmpty"),dP="".concat(Nt,".isNotEmpty"),vP="".concat(Nt,".isEqualTo"),yP="".concat(Nt,".isNotEqualTo"),gP="".concat(Nt,".beginsWith"),pP="".concat(Nt,".endsWith"),mP="".concat(Nt,".contains"),bP="".concat(Nt,".doesNotContain"),o0e="".concat(Nt,".byValue"),wP="".concat(Nt,".greaterThan"),SP="".concat(Nt,".greaterThanOrEqualTo"),CP="".concat(Nt,".lessThan"),_P="".concat(Nt,".lessThanOrEqualTo"),OP="".concat(Nt,".isBetween"),RP="".concat(Nt,".isNotBetween"),EP="".concat(Nt,".after"),TP="".concat(Nt,".before"),PP="".concat(Nt,".today"),kP="".concat(Nt,".tomorrow"),$P="".concat(Nt,".yesterday"),AP="".concat(Or,"labels.filterByCondition"),IP="".concat(Or,"labels.filterByValue"),MP="".concat(Or,"labels.conjunction"),Xm="".concat(Or,"labels.disjunction"),jp="".concat(Or,"values.blankCells"),xP="".concat(Or,"buttons.selectAll"),DP="".concat(Or,"buttons.clear"),NP="".concat(Or,"buttons.ok"),HP="".concat(Or,"buttons.cancel"),LP="".concat(Or,"buttons.placeholder.search"),jP="".concat(Or,"buttons.placeholder.value"),FP="".concat(Or,"buttons.placeholder.secondValue");const i0e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:VT,CONTEXTMENU_ITEMS_ALIGNMENT:YT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:JT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:KT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:XT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:GT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:QT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:qT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ZT,CONTEXTMENU_ITEMS_BORDERS:eP,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:nP,CONTEXTMENU_ITEMS_BORDERS_LEFT:oP,CONTEXTMENU_ITEMS_BORDERS_RIGHT:rP,CONTEXTMENU_ITEMS_BORDERS_TOP:tP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:IT,CONTEXTMENU_ITEMS_COPY:MT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:NT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:DT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:xT,CONTEXTMENU_ITEMS_CUT:HT,CONTEXTMENU_ITEMS_EDIT_COMMENT:WT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:LT,CONTEXTMENU_ITEMS_HIDE_COLUMN:sP,CONTEXTMENU_ITEMS_HIDE_ROW:fP,CONTEXTMENU_ITEMS_INSERT_LEFT:RT,CONTEXTMENU_ITEMS_INSERT_RIGHT:ET,CONTEXTMENU_ITEMS_MERGE_CELLS:FT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:lP,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:aP,CONTEXTMENU_ITEMS_NO_ITEMS:CT,CONTEXTMENU_ITEMS_READ_ONLY:AT,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:zT,CONTEXTMENU_ITEMS_REDO:$T,CONTEXTMENU_ITEMS_REMOVE_BORDERS:iP,CONTEXTMENU_ITEMS_REMOVE_COLUMN:PT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:UT,CONTEXTMENU_ITEMS_REMOVE_ROW:TT,CONTEXTMENU_ITEMS_ROW_ABOVE:_T,CONTEXTMENU_ITEMS_ROW_BELOW:OT,CONTEXTMENU_ITEMS_SHOW_COLUMN:uP,CONTEXTMENU_ITEMS_SHOW_ROW:cP,CONTEXTMENU_ITEMS_UNDO:kT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:jT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:BT,CONTEXT_MENU_ITEMS_NAMESPACE:rU,FILTERS_BUTTONS_CANCEL:HP,FILTERS_BUTTONS_CLEAR:DP,FILTERS_BUTTONS_OK:NP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:LP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:FP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:jP,FILTERS_BUTTONS_SELECT_ALL:xP,FILTERS_CONDITIONS_AFTER:EP,FILTERS_CONDITIONS_BEFORE:TP,FILTERS_CONDITIONS_BEGINS_WITH:gP,FILTERS_CONDITIONS_BETWEEN:OP,FILTERS_CONDITIONS_BY_VALUE:o0e,FILTERS_CONDITIONS_CONTAINS:mP,FILTERS_CONDITIONS_EMPTY:hP,FILTERS_CONDITIONS_ENDS_WITH:pP,FILTERS_CONDITIONS_EQUAL:vP,FILTERS_CONDITIONS_GREATER_THAN:wP,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:SP,FILTERS_CONDITIONS_LESS_THAN:CP,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:_P,FILTERS_CONDITIONS_NAMESPACE:Nt,FILTERS_CONDITIONS_NONE:qm,FILTERS_CONDITIONS_NOT_BETWEEN:RP,FILTERS_CONDITIONS_NOT_CONTAIN:bP,FILTERS_CONDITIONS_NOT_EMPTY:dP,FILTERS_CONDITIONS_NOT_EQUAL:yP,FILTERS_CONDITIONS_TODAY:PP,FILTERS_CONDITIONS_TOMORROW:kP,FILTERS_CONDITIONS_YESTERDAY:$P,FILTERS_DIVS_FILTER_BY_CONDITION:AP,FILTERS_DIVS_FILTER_BY_VALUE:IP,FILTERS_LABELS_CONJUNCTION:MP,FILTERS_LABELS_DISJUNCTION:Xm,FILTERS_NAMESPACE:Or,FILTERS_VALUES_BLANK_CELLS:jp},Symbol.toStringTag,{value:"Module"}));function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}function qw(e,t,r){return t=nU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nU(n.key),n)}}function l0e(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nU(e){var t=s0e(e,"string");return pu(t)==="symbol"?t:String(t)}function s0e(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=u0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function u0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function f0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bO(e,t)}function bO(e,t){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bO(e,t)}function c0e(e){var t=d0e();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return h0e(this,o)}}function h0e(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oU(e)}function oU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}var Xw="comments",v0e=60,Cy=new WeakMap,Pn="comment",Rl="value",gx="style",_y="readOnly",y0e=function(e){f0e(r,e);var t=c0e(r);function r(n){var o;return a0e(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,Cy.set(oU(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return l0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Xw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new FRe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Pt(this)),this.displaySwitch||(this.displaySwitch=new n0e(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),ya(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(mo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ya(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=gi(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&gi(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,qw({},Rl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Pn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,Rl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,Rl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[Pn]?l[Pn][Rl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),y=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var m=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,k=S.view._wt,O=k.wtTable,W=k.getCell({row:d,col:v},!0),Y=this.getCommentMeta(c,h,gx);Y?this.editor.setSize(Y.width,Y.height):this.editor.resetSize();var q=w?0:O.getStretchedColumnWidth(v),G=y&&!m?Tt(W):0,X=W.getBoundingClientRect(),Q=X.left,oe=X.top,J=X.width,ue=X.height,he=this.editor.getSize(),Oe=he.width,we=he.height,$=this.hot.rootWindow,P=$.innerWidth,g=$.innerHeight,p=this.hot.rootDocument.documentElement,b=Q+C.scrollX+q,E=oe+C.scrollY+G;this.hot.isRtl()&&(b-=Oe+q),this.hot.isLtr()&&Q+J+Oe>P?b=Q+C.scrollX-Oe-1:this.hot.isRtl()&&b<-(p.scrollWidth-p.clientWidth)&&(b=Q+C.scrollX+q+1),oe+we>g&&(E-=we-ue+1),this.editor.setPosition(b,E),this.editor.setReadOnlyState(this.getCommentMeta(c,h,_y))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Rl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[Pn],s;l?(s=fr(l),Cv(s,a)):s=a,this.hot.setCellMeta(o,i,Pn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[Pn])return l[Pn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=gi(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=Cy.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else pi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[Pn]&&i[Pn][Rl]&&te(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=Cy.get(this);i.tempEditorDimensions={width:ct(o.target),height:Tt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=Cy.get(this),a=ct(o.target),l=Tt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,qw({},gx,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,_y);o.updateCommentMeta(a,l,qw({},_y,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(WT):i.hot.getTranslatedPhrase(VT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(UT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(zT),f=Ln(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[Pn];if(d&&(d=d[_y]),d)return!0});return f&&(u=ao(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[Xw];if(Ue(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ya(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Xw}},{key:"PLUGIN_PRIORITY",get:function(){return v0e}}]),r}(ot);function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function g0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function px(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m0e(n.key),n)}}function p0e(e,t,r){return t&&px(e.prototype,t),r&&px(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m0e(e){var t=b0e(e,"string");return jh(t)==="symbol"?t:String(t)}function b0e(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w0e=function(){function e(t){g0e(this,e),this.hot=t,this.commands={},this.commonCallback=null}return p0e(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=S0e(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!Mt(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),A(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function S0e(e,t){var r;return A(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const iU=w0e;var Xr="alignment";function C0e(){return{key:Xr,name:function(){return this.getTranslatedPhrase(YT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Xr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(GT),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Gi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),li(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(KT),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Gi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),li(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(qT),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Gi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),li(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(XT),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Gi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),li(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:qe},{key:"".concat(Xr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(ZT),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Gi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),li(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(QT),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Gi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),li(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(JT),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Gi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),li(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var Zm="clear_column";function _0e(){return{key:Zm,name:function(){return this.getTranslatedPhrase(IT)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=fl(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var xv="col_left";function O0e(){return{key:xv,name:function(){return this.getTranslatedPhrase(RT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=fl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Dv="col_right";function R0e(){return{key:Dv,name:function(){return this.getTranslatedPhrase(ET)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=fl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Nv="make_read_only";function E0e(){return{key:Nv,name:function(){var t=this,r=this.getTranslatedPhrase(AT),n=Ln(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=ao(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ln(r,function(o,i){return t.getCellMeta(o,i).readOnly});A(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Qm="redo";function T0e(){return{key:Qm,name:function(){return this.getTranslatedPhrase($T)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function aU(e,t){return A0e(e)||$0e(e,t)||k0e(e,t)||P0e()}function P0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k0e(e,t){if(e){if(typeof e=="string")return mx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mx(e,t)}}function mx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function A0e(e){if(Array.isArray(e))return e}function wO(e){"@babel/helpers - typeof";return wO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wO(e)}var Jm=0,eb=1,lU=2,BP=3,I0e=[BP,lU],M0e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Zw=Symbol("root"),bx=Symbol("child");function mu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zw;if(t!==Zw&&t!==bx)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Zw,o=Jm;if(r){var i=e[0];if(e.length===0)o=eb;else if(n&&i instanceof oT)o=BP;else if(n&&Array.isArray(i))o=mu(i,bx);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!M0e[s].includes(wO(l))});a&&(o=lU)}}return o}function Fh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!I0e.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===BP,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),mt(u)&&(u=l),mt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function x0e(e){var t=mu(e);if(t===Jm||t===eb)return[];var r=Fh(t),n=new Set;A(e,function(a){var l=r(a),s=aU(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=jt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function D0e(e){var t=mu(e);if(t===Jm||t===eb)return[];var r=Fh(t),n=new Set;A(e,function(a){var l=r(a),s=aU(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=jt(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Xo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function N0e(e,t){return F0e(e)||j0e(e,t)||L0e(e,t)||H0e()}function H0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L0e(e,t){if(e){if(typeof e=="string")return wx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wx(e,t)}}function wx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function F0e(e){if(Array.isArray(e))return e}var Hv="remove_col";function B0e(){return{key:Hv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=N0e(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(PT,r)},callback:function(){this.alter("remove_col",x0e(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=fl(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function V0e(e,t){return Y0e(e)||z0e(e,t)||U0e(e,t)||W0e()}function W0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U0e(e,t){if(e){if(typeof e=="string")return Sx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sx(e,t)}}function Sx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Y0e(e){if(Array.isArray(e))return e}var tb="remove_row";function G0e(){return{key:tb,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=V0e(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(TT,r)},callback:function(){this.alter("remove_row",D0e(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=fl(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var rb="row_above";function K0e(){return{key:rb,name:function(){return this.getTranslatedPhrase(_T)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=fl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var nb="row_below";function q0e(){return{key:nb,name:function(){return this.getTranslatedPhrase(OT)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=fl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Bh="no_items";function X0e(){return{key:Bh,name:function(){return this.getTranslatedPhrase(CT)},disabled:!0,isCommand:!1}}var ob="undo";function Z0e(){return{key:ob,name:function(){return this.getTranslatedPhrase(kT)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}var yr;function xr(e,t,r){return t=Q0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q0e(e){var t=J0e(e,"string");return Vh(t)==="symbol"?t:String(t)}function J0e(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eEe=[rb,nb,xv,Dv,Zm,tb,Hv,ob,Qm,Nv,Xr,qe,Bh],tEe=(yr={},xr(yr,qe,BRe),xr(yr,Bh,X0e),xr(yr,rb,K0e),xr(yr,nb,q0e),xr(yr,xv,O0e),xr(yr,Dv,R0e),xr(yr,Zm,_0e),xr(yr,tb,G0e),xr(yr,Hv,B0e),xr(yr,ob,Z0e),xr(yr,Qm,T0e),xr(yr,Nv,E0e),xr(yr,Xr,C0e),yr);function sU(){var e={};return ze(tEe,function(t,r){e[r]=t()}),e}function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function rEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oEe(n.key),n)}}function nEe(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oEe(e){var t=iEe(e,"string");return Wh(t)==="symbol"?t:String(t)}function iEe(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aEe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;rEe(this,e),this.hot=t,this.predefinedItems=sU(),this.defaultOrderPattern=r}return nEe(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,ze(r,function(i,a){var l="";i.name===qe?(o[qe]=i,l=qe):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return lEe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function lEe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ue(o)?ze(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ue(i)?Ut(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):A(o,function(i,a){var l=r[i];!l&&eEe.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ue(i)&&Ut(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const uU=aEe;function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function sEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fEe(n.key),n)}}function uEe(e,t,r){return t&&_x(e.prototype,t),r&&_x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fEe(e){var t=cEe(e,"string");return Uh(t)==="symbol"?t:String(t)}function cEe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hEe=function(){function e(t,r){sEe(this,e);var n=ps(r),o=Fa(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return uEe(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const dEe=hEe;var vEe=Qa,yEe=/(?:ipad|iphone|ipod).*applewebkit/i.test(vEe),gEe=Wn,fU=typeof process<"u"&&gEe(process)=="process",Vr=vt,pEe=il,mEe=cv,Ox=Ot,bEe=Dt,cU=je,Rx=_j,wEe=gv,Ex=nm,SEe=aW,CEe=yEe,_Ee=fU,SO=Vr.setImmediate,CO=Vr.clearImmediate,OEe=Vr.process,Qw=Vr.Dispatch,REe=Vr.Function,Tx=Vr.MessageChannel,EEe=Vr.String,Jw=0,Nc={},Px="onreadystatechange",zh,Ki,eS,tS;cU(function(){zh=Vr.location});var VP=function(e){if(bEe(Nc,e)){var t=Nc[e];delete Nc[e],t()}},rS=function(e){return function(){VP(e)}},kx=function(e){VP(e.data)},$x=function(e){Vr.postMessage(EEe(e),zh.protocol+"//"+zh.host)};(!SO||!CO)&&(SO=function(t){SEe(arguments.length,1);var r=Ox(t)?t:REe(t),n=wEe(arguments,1);return Nc[++Jw]=function(){pEe(r,void 0,n)},Ki(Jw),Jw},CO=function(t){delete Nc[t]},_Ee?Ki=function(e){OEe.nextTick(rS(e))}:Qw&&Qw.now?Ki=function(e){Qw.now(rS(e))}:Tx&&!CEe?(eS=new Tx,tS=eS.port2,eS.port1.onmessage=kx,Ki=mEe(tS.postMessage,tS)):Vr.addEventListener&&Ox(Vr.postMessage)&&!Vr.importScripts&&zh&&zh.protocol!=="file:"&&!cU($x)?(Ki=$x,Vr.addEventListener("message",kx,!1)):Px in Ex("script")?Ki=function(e){Rx.appendChild(Ex("script"))[Px]=function(){Rx.removeChild(this),VP(e)}}:Ki=function(e){setTimeout(rS(e),0)});var hU={set:SO,clear:CO},TEe=$e,PEe=vt,Ax=hU.clear;TEe({global:!0,bind:!0,enumerable:!0,forced:PEe.clearImmediate!==Ax},{clearImmediate:Ax});var kEe=$e,dU=vt,Ix=hU.set,$Ee=NE,Mx=dU.setImmediate?$Ee(Ix,!1):Ix;kEe({global:!0,bind:!0,enumerable:!0,forced:dU.setImmediate!==Mx},{setImmediate:Mx});var AEe=$e,IEe=X0;AEe({target:"String",proto:!0},{repeat:IEe});var MEe=Xt,xEe=vm,DEe=Lt,NEe=Cn,HEe=tl,nS=Gt,LEe=Ar,jEe=el,FEe=H0,xx=ym;xEe("match",function(e,t,r){return[function(o){var i=LEe(this),a=NEe(o)?void 0:jEe(o,e);return a?MEe(a,o,i):new RegExp(o)[e](nS(i))},function(n){var o=DEe(this),i=nS(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return xx(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=xx(o,i))!==null;){var c=nS(f[0]);s[u]=c,c===""&&(o.lastIndex=FEe(i,HEe(o.lastIndex),l)),u++}return u===0?null:s}]});var BEe=il,VEe=zr,WEe=Di,UEe=en,zEe=Ef,YEe=Math.min,_O=[].lastIndexOf,vU=!!_O&&1/[1].lastIndexOf(1,-0)<0,GEe=zEe("lastIndexOf"),KEe=vU||!GEe,qEe=KEe?function(t){if(vU)return BEe(_O,this,arguments)||0;var r=VEe(this),n=UEe(r),o=n-1;for(arguments.length>1&&(o=YEe(o,WEe(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:_O,XEe=$e,Dx=qEe;XEe({target:"Array",proto:!0,forced:Dx!==[].lastIndexOf},{lastIndexOf:Dx});var ZEe=Ja,QEe=Ir,JEe=qd,eTe=en,tTe=TypeError,Nx=function(e){return function(t,r,n,o){ZEe(r);var i=QEe(t),a=JEe(i),l=eTe(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw tTe("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},rTe={left:Nx(!1),right:Nx(!0)},nTe=$e,oTe=rTe.left,iTe=Ef,Hx=Xd,aTe=fU,lTe=!aTe&&Hx>79&&Hx<83,sTe=lTe||!iTe("reduce");nTe({target:"Array",proto:!0,forced:sTe},{reduce:function(t){var r=arguments.length;return oTe(this,t,r,r>1?arguments[1]:void 0)}});function oS(e){return hTe(e)||cTe(e)||fTe(e)||uTe()}function uTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fTe(e,t){if(e){if(typeof e=="string")return OO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OO(e,t)}}function cTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hTe(e){if(Array.isArray(e))return OO(e)}function OO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},dTe=new RegExp(Object.keys(yU).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function vTe(e){return(e&&e.nodeName||"")==="TABLE"}function RO(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],y=0;y<a;y+=1){var m=!d&&r&&y===0,w="";if(d)w="<th>".concat(e.getColHeader(y-f),"</th>");else if(m)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][y],C=e.getCellMeta(h-c,y-f),k=C.hidden,O=C.rowspan,W=C.colspan;if(!k){var Y=[];if(O&&Y.push('rowspan="'.concat(O,'"')),W&&Y.push('colspan="'.concat(W,'"')),qt(S))w="<td ".concat(Y.join(" "),"></td>");else{var q=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(Y.join(" "),">").concat(q,"</td>")}}}v.push(w)}var G=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,G):u.splice(-1,0,G)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function EO(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=qt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function gU(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(b){var E=b.match(/<td\b[^>]*?>/g)[0],R=b.substring(E.length,b.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),F="</td>";return"".concat(E).concat(R).concat(F)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!vTe(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(b,E){return b+E.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,y=0;if(i.tHead){var m=Array.from(i.tHead.rows).filter(function(b){var E=b.querySelector("td")!==null;return E&&h.push(b),!E});v=m.length,d=v>0,v>1?r.nestedHeaders=Array.from(m).reduce(function(b,E){var R=Array.from(E.cells).reduce(function(F,x,K){if(s&&K===0)return F;var Z=x.colSpan,re=x.innerHTML,ie=Z>1?{label:re,colspan:Z}:re;return F.push(ie),F},[]);return b.push(R),b},[]):d&&(r.colHeaders=Array.from(m[0].children).reduce(function(b,E,R){return s&&R===0||b.push(E.innerHTML),b},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,oS(Array.from(i.tBodies).reduce(function(b,E){return b.push.apply(b,oS(Array.from(E.rows))),b},[])),oS(c));y=w.length;for(var S=new Array(y),C=0;C<y;C++)S[C]=new Array(f);for(var k=[],O=[],W=0;W<y;W++)for(var Y=w[W],q=Array.from(Y.cells),G=q.length,X=0;X<G;X++){var Q=q[X],oe=Q.nodeName,J=Q.innerHTML,ue=Q.rowSpan,he=Q.colSpan,Oe=S[W].findIndex(function(b){return b===void 0});if(oe==="TD"){if(ue>1||he>1){for(var we=W;we<W+ue;we++)if(we<y)for(var $=Oe;$<Oe+he;$++)S[we][$]=null;var P=Q.getAttribute("style"),g=P&&P.includes("mso-ignore:colspan");g||k.push({col:Oe,row:W,rowspan:ue,colspan:he})}var p="";l&&/excel/gi.test(l.content)?p=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):p=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[W][Oe]=p.replace(dTe,function(b){return yU[b]})}else O.push(J)}return k.length&&(r.mergeCells=k),O.length&&(r.rowHeaders=O),S.length&&(r.data=S),r}}const yTe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:EO,htmlToGridSettings:gU,instanceToHTML:RO},Symbol.toStringTag,{value:"Module"}));function Lx(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function gTe(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var pTe=new Map([["mousedown",Lx],["mouseover",gTe],["touchstart",Lx]]);function jx(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;pTe.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Lm(e)||e.type==="touchstart",isRightClick:ki(e)})}var pU=new WeakMap,WP=Symbol("rootInstance");function mTe(e){pU.set(e,!0)}function bTe(e){return e===WP}function TO(e){return pU.has(e)}function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function tc(e,t){return CTe(e)||STe(e,t)||mU(e,t)||wTe()}function wTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function STe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function CTe(e){if(Array.isArray(e))return e}function Fx(e){return RTe(e)||OTe(e)||mU(e)||_Te()}function _Te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mU(e,t){if(e){if(typeof e=="string")return PO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PO(e,t)}}function OTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RTe(e){if(Array.isArray(e))return PO(e)}function PO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ETe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bU(n.key),n)}}function TTe(e,t,r){return t&&Bx(e.prototype,t),r&&Bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vx(e,t,r){PTe(e,t),t.set(e,r)}function PTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zo(e,t,r){return t=bU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bU(e){var t=kTe(e,"string");return Yh(t)==="symbol"?t:String(t)}function kTe(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wx(e,t){var r=wU(e,t,"get");return $Te(e,r)}function $Te(e,t){return t.get?t.get.call(e):t.value}function Ux(e,t,r){var n=wU(e,t,"set");return ATe(e,n,r),r}function wU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ATe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var qi=new WeakMap,iS=new WeakMap,aS=new WeakMap,ITe=function(){function e(t){ETe(this,e),Zo(this,"instance",void 0),Zo(this,"eventManager",void 0),Zo(this,"settings",void 0),Zo(this,"THEAD",void 0),Zo(this,"TBODY",void 0),Zo(this,"_wt",void 0),Zo(this,"activeWt",void 0),Vx(this,iS,{writable:!0,value:0}),Vx(this,aS,{writable:!0,value:0}),Zo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Pt(this.instance),this.settings=this.instance.getSettings(),qi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return TTe(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=qi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),te(o,"handsontable"),r.table=i.createElement("TABLE"),te(r.table,"htCore"),this.instance.getSettings().tableClassName&&te(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=qi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;t_(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&t_(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&Lm(u)&&l.finish(),n.mouseDown=!1,(Vm(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!ki(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&ki(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var y=Jt(a);if(a.elementFromPoint(c+y,h)!==v||a.elementFromPoint(c,h+y)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var m=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;m?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Zc(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,Fx(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=qi.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return TO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,Fx(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),Ux(r,aS,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),Ux(r,iS,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=tc(d,2),y=v[0],m=v[1],w=r.instance.runHooks("modifyGetCellCoords",y,m),S=y,C=m;if(Array.isArray(w)){var k=tc(w,2);S=k[0],C=k[1]}var O=r.instance.getCellMeta(S,C),W=r.instance.colToProp(C),Y=r.instance.getDataAtRowProp(S,W);r.instance.hasHook("beforeValueRender")&&(Y=r.instance.runHooks("beforeValueRender",Y,O)),r.instance.runHooks("beforeRenderer",h,y,m,W,Y,O),r.instance.getCellRenderer(O)(r.instance,h,y,m,W,Y,O),r.instance.runHooks("afterRenderer",h,y,m,W,Y,O)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,y),!aa(f)&&(jx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!aa(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!aa(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,y),!aa(f)&&(n.mouseDown&&jx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(aa(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),y=tc(v,2),m=y[0],w=y[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var k=(h??0)+1-C,O=S.peekByIndex(k);d=[O.from.row,O.from.col,O.to.row,O.to.col]}return r.instance.runHooks("afterDrawSelection",m,w,d,h)},onBeforeDrawBorders:function(f,c){var h=tc(f,4),d=h[0],v=h[1],y=h[2],m=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(y),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,y=c>=0?v.getVisualFromRenderableIndex(c):c,m=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",m,y,h);if(Array.isArray(w)){var S=tc(w,4),C=S[0],k=S[1],O=S[2],W=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,k>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(k,1)):k,O>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(O,-1)):O,W>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(W,-1)):W]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var y=Math.ceil(v/h*12);f.startRow=Math.max(d-y,0),f.endRow=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var y=Math.ceil(v/h*6);f.startColumn=Math.max(d-y,0),f.endColumn=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new Qme(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Zc(r))return!0;var n=pi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return qi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){Sn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(Sn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?ll(r,o(n,i)):($i(r,String.fromCharCode(160)),te(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=qi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=qi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Wx(this,iS)}},{key:"getRowHeadersCount",value:function(){return Wx(this,aS)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const MTe=ITe;function kO(e){"@babel/helpers - typeof";return kO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kO(e)}var SU="ABCDEFGHIJKLMNOPQRSTUVWXYZ",$O=SU.length;function ib(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%$O,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/$O,10);return r}function xTe(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow($O,n)*(SU.indexOf(e[r])+1);return t-=1,t}function DTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(ib(o)+(n+1));r.push(i)}return r}function NTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=ib(o)+(n+1);r.push(i)}return r}function HTe(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function AO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function UP(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ue(e[0])&&(t=Hm(e[0]))),t}function CU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function _U(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return kO(t)==="object"&&!Array.isArray(t)&&t!==null}))}const LTe=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:UP,createEmptySpreadsheetData:HTe,createSpreadsheetData:DTe,createSpreadsheetObjectData:NTe,dataRowToChangesArray:AO,isArrayOfArrays:CU,isArrayOfObjects:_U,spreadsheetColumnIndex:xTe,spreadsheetColumnLabel:ib},Symbol.toStringTag,{value:"Module"}));function Gh(e){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function jTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BTe(n.key),n)}}function FTe(e,t,r){return t&&zx(e.prototype,t),r&&zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BTe(e){var t=VTe(e,"string");return Gh(t)==="symbol"?t:String(t)}function VTe(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WTe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];jTe(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return FTe(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return A(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):Ce(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ue(s)||pt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;Ce(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):lg(u,d,v)}})}else ze(s,function(h,d){lg(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=ja(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:lg(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=PV(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=ja(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Ce(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return UP(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const UTe=WTe;var Yx;function zTe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YTe(e,t){return ze(t,function(r,n){mt(e[n])&&(e[n]=r)}),e}function OU(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function RU(e){ve(e)&&DE(dt(Yx||(Yx=zTe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function GTe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var EU=on("phraseFormatters"),KTe=EU.register,qTe=EU.getValues;function XTe(e,t){KTe(e,t)}function ZTe(){return qTe()}XTe("pluralize",GTe);function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}var fe;function ce(e,t,r){return t=QTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QTe(e){var t=JTe(e,"string");return Kh(t)==="symbol"?t:String(t)}function JTe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ePe=(fe={languageCode:"en-US"},ce(fe,CT,"No available options"),ce(fe,_T,"Insert row above"),ce(fe,OT,"Insert row below"),ce(fe,RT,"Insert column left"),ce(fe,ET,"Insert column right"),ce(fe,TT,["Remove row","Remove rows"]),ce(fe,PT,["Remove column","Remove columns"]),ce(fe,kT,"Undo"),ce(fe,$T,"Redo"),ce(fe,AT,"Read only"),ce(fe,IT,"Clear column"),ce(fe,YT,"Alignment"),ce(fe,GT,"Left"),ce(fe,KT,"Center"),ce(fe,qT,"Right"),ce(fe,XT,"Justify"),ce(fe,ZT,"Top"),ce(fe,QT,"Middle"),ce(fe,JT,"Bottom"),ce(fe,LT,"Freeze column"),ce(fe,jT,"Unfreeze column"),ce(fe,eP,"Borders"),ce(fe,tP,"Top"),ce(fe,rP,"Right"),ce(fe,nP,"Bottom"),ce(fe,oP,"Left"),ce(fe,iP,"Remove border(s)"),ce(fe,VT,"Add comment"),ce(fe,WT,"Edit comment"),ce(fe,UT,"Delete comment"),ce(fe,zT,"Read-only comment"),ce(fe,FT,"Merge cells"),ce(fe,BT,"Unmerge cells"),ce(fe,MT,"Copy"),ce(fe,xT,["Copy with header","Copy with headers"]),ce(fe,DT,["Copy with group header","Copy with group headers"]),ce(fe,NT,["Copy header only","Copy headers only"]),ce(fe,HT,"Cut"),ce(fe,aP,"Insert child row"),ce(fe,lP,"Detach from parent"),ce(fe,sP,["Hide column","Hide columns"]),ce(fe,uP,["Show column","Show columns"]),ce(fe,fP,["Hide row","Hide rows"]),ce(fe,cP,["Show row","Show rows"]),ce(fe,qm,"None"),ce(fe,hP,"Is empty"),ce(fe,dP,"Is not empty"),ce(fe,vP,"Is equal to"),ce(fe,yP,"Is not equal to"),ce(fe,gP,"Begins with"),ce(fe,pP,"Ends with"),ce(fe,mP,"Contains"),ce(fe,bP,"Does not contain"),ce(fe,wP,"Greater than"),ce(fe,SP,"Greater than or equal to"),ce(fe,CP,"Less than"),ce(fe,_P,"Less than or equal to"),ce(fe,OP,"Is between"),ce(fe,RP,"Is not between"),ce(fe,EP,"After"),ce(fe,TP,"Before"),ce(fe,PP,"Today"),ce(fe,kP,"Tomorrow"),ce(fe,$P,"Yesterday"),ce(fe,jp,"Blank cells"),ce(fe,AP,"Filter by condition"),ce(fe,IP,"Filter by value"),ce(fe,MP,"And"),ce(fe,Xm,"Or"),ce(fe,xP,"Select all"),ce(fe,DP,"Clear"),ce(fe,NP,"OK"),ce(fe,HP,"Cancel"),ce(fe,LP,"Search"),ce(fe,jP,"Value"),ce(fe,FP,"Second value"),fe);const TU=ePe;var IO=TU.languageCode,ab=on("languagesDictionaries"),tPe=ab.register,PU=ab.getItem,rPe=ab.hasItem,nPe=ab.getValues;kU(TU);function kU(e,t){var r=e,n=t;return Ue(e)&&(n=e,r=n.languageCode),oPe(r,n),tPe(r,fr(n)),fr(n)}function oPe(e,t){e!==IO&&YTe(t,PU(IO))}function $U(e){return zP(e)?fr(PU(e)):null}function zP(e){return rPe(e)}function iPe(){return nPe()}function AU(e,t,r){var n=$U(e);if(n===null)return null;var o=n[t];if(mt(o))return null;var i=aPe(o,r);return Array.isArray(i)?i[0]:i}function aPe(e,t){var r=e;return A(ZTe(),function(n){r=n(e,t)}),r}function lPe(e){var t=OU(e);return zP(t)||(t=IO,RU(e)),t}var lb="active-header",sb="area",qh="cell",YP="fill",Lv="header",GP="custom-selection";function bu(e){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function sPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MU(n.key),n)}}function uPe(e,t,r){return t&&Gx(e.prototype,t),r&&Gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _g(){return typeof Reflect<"u"&&Reflect.get?_g=Reflect.get.bind():_g=function(t,r,n){var o=fPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_g.apply(this,arguments)}function fPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wu(e),e!==null););return e}function cPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MO(e,t)}function hPe(e){var t=vPe();return function(){var n=wu(e),o;if(t){var i=wu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dPe(this,o)}}function dPe(e,t){if(t&&(bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IU(e)}function IU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wu(e){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wu(e)}function yPe(e,t,r){return t=MU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MU(e){var t=gPe(e,"string");return bu(t)==="symbol"?t:String(t)}function gPe(e,t){if(bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pPe=function(e){cPe(r,e);var t=hPe(r);function r(n,o){var i;return sPe(this,r),i=t.call(this,n,null),yPe(IU(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return uPe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,_g(wu(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(kbe);const xf=pPe;function Xh(e){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}var mPe=["activeHeaderClassName"];function Kx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kx(Object(r),!0).forEach(function(n){bPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bPe(e,t,r){return t=wPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wPe(e){var t=SPe(e,"string");return Xh(t)==="symbol"?t:String(t)}function SPe(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CPe(e,t){if(e==null)return{};var r=_Pe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Pe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function OPe(e){var t=e.activeHeaderClassName,r=CPe(e,mPe),n=new xf(qx(qx({highlightHeaderClassName:t},r),{},{selectionType:lb}));return n}function Zh(e){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}var RPe=["layerLevel","areaCornerVisible"];function Xx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Zx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xx(Object(r),!0).forEach(function(n){EPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EPe(e,t,r){return t=TPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TPe(e){var t=PPe(e,"string");return Zh(t)==="symbol"?t:String(t)}function PPe(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kPe(e,t){if(e==null)return{};var r=$Pe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Pe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function APe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=kPe(e,RPe),o=new xf(Zx(Zx({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:sb}));return o}function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}var IPe=["cellCornerVisible"];function Qx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Jx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qx(Object(r),!0).forEach(function(n){MPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MPe(e,t,r){return t=xPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xPe(e){var t=DPe(e,"string");return Qh(t)==="symbol"?t:String(t)}function DPe(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NPe(e,t){if(e==null)return{};var r=HPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function LPe(e){var t=e.cellCornerVisible,r=NPe(e,IPe),n=new xf(Jx(Jx({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:qh}));return n}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var jPe=["border","visualCellRange"];function eD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eD(Object(r),!0).forEach(function(n){FPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FPe(e,t,r){return t=BPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BPe(e){var t=VPe(e,"string");return Jh(t)==="symbol"?t:String(t)}function VPe(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WPe(e,t){if(e==null)return{};var r=UPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function zPe(e){var t=e.border,r=e.visualCellRange,n=WPe(e,jPe),o=new xf(lS(lS(lS({},t),n),{},{selectionType:GP}),r);return o}function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function tD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tD(Object(r),!0).forEach(function(n){YPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YPe(e,t,r){return t=GPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GPe(e){var t=KPe(e,"string");return ed(t)==="symbol"?t:String(t)}function KPe(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qPe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function XPe(e){var t=Object.assign({},(qPe(e),e)),r=new xf(rD(rD({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:YP}));return r}function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}var ZPe=["headerClassName","rowClassName","columnClassName"];function nD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function oD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nD(Object(r),!0).forEach(function(n){QPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QPe(e,t,r){return t=JPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JPe(e){var t=eke(e,"string");return td(t)==="symbol"?t:String(t)}function eke(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tke(e,t){if(e==null)return{};var r=rke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function nke(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=tke(e,ZPe),i=new xf(oD(oD({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:Lv}));return i}function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function iD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function oke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iD(Object(r),!0).forEach(function(n){ike(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ike(e,t,r){return t=ake(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ake(e){var t=lke(e,"string");return rd(t)==="symbol"?t:String(t)}function lke(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xU=on("highlight/types"),Df=xU.register,ske=xU.getItem;Df(lb,OPe);Df(sb,APe);Df(qh,LPe);Df(GP,zPe);Df(YP,XPe);Df(Lv,nke);function El(e,t){return ske(e)(oke({type:e},t))}function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function Qo(e){return hke(e)||cke(e)||fke(e)||uke()}function uke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fke(e,t){if(e){if(typeof e=="string")return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}}function cke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hke(e){if(Array.isArray(e))return xO(e)}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aD(Object(r),!0).forEach(function(n){dke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dke(e,t,r){return t=DU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DU(n.key),n)}}function yke(e,t,r){return t&&lD(e.prototype,t),r&&lD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DU(e){var t=gke(e,"string");return nd(t)==="symbol"?t:String(t)}function gke(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pke=function(e){function t(r){vke(this,t),this.options=r,this.layerLevel=0,this.cell=El(qh,r),this.fill=El(YP,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return yke(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===qh&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=El(sb,rc({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Qo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=El(Lv,rc({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Qo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=El(lb,rc({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Qo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Qo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(El(GP,rc(rc({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),A(this.areas.values(),function(n){return void n.clear()}),A(this.headers.values(),function(n){return void n.clear()}),A(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Qo(this.areas.values()),Qo(this.headers.values()),Qo(this.activeHeaders.values()),Qo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const mke=pke;function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function bke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ske(n.key),n)}}function wke(e,t,r){return t&&sD(e.prototype,t),r&&sD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ske(e){var t=Cke(e,"string");return od(t)==="symbol"?t:String(t)}function Cke(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _ke=function(e){function t(r){bke(this,t),this.ranges=[],this.createCellRange=r}return wke(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Oke=_ke;function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function Rke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tke(n.key),n)}}function Eke(e,t,r){return t&&uD(e.prototype,t),r&&uD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tke(e){var t=Pke(e,"string");return id(t)==="symbol"?t:String(t)}function Pke(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NU=function(){function e(t,r){Rke(this,e),this.range=t,this.options=r}return Eke(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),y=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&m>0&&!(y&&s>=d-y-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var k=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,k.row<0?(c=-1,k.row=0):k.row>0&&k.row>=d&&(c=1,k.row=d-1),k.col<0?(h=-1,k.col=0):k.col>0&&k.col>=v&&(h=1,k.col=v-1),f=this.options.renderableToVisualCoords(k)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),y=v.row,m=v.col,w=this.options.createCellCoords(y+o.row,m+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();gt(NU,Mr);const kke=NU;function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}var fD;function cD(e,t){return Mke(e)||Ike(e,t)||Ake(e,t)||$ke()}function $ke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ake(e,t){if(e){if(typeof e=="string")return hD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(e,t)}}function hD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ike(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Mke(e){if(Array.isArray(e))return e}function xke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Dke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hke(n.key),n)}}function Nke(e,t,r){return t&&dD(e.prototype,t),r&&dD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hke(e){var t=Lke(e,"string");return ad(t)==="symbol"?t:String(t)}function Lke(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HU=function(){function e(t,r){var n=this;Dke(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Oke(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new mke({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new kke(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Nke(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&mt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(qh,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(A(this.highlight.getAreas(),function(y){return void y.clear()}),A(this.highlight.getHeaders(),function(y){return void y.clear()}),A(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(sb,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Lv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=ja(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=mu(r);if(o===eb)return!1;if(o===Jm)throw new Error(dt(fD||(fD=xke([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Fh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=cD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=Xo(h,a)&&Xo(d,l)&&Xo(v,a)&&Xo(y,l);return!m});return s&&(this.clear(),A(r,function(u){var f=i(u),c=cD(f,4),h=c[0],d=c[1],v=c[2],y=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,y)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Xo(i,l)&&Xo(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Xo(r,i)&&Xo(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();gt(HU,Mr);const jke=HU;var Fke=$e,LU=fv,Bke=Un.f,Vke=tl,vD=Gt,Wke=mE,Uke=Ar,zke=bE,yD=LU("".startsWith),Yke=LU("".slice),Gke=Math.min,jU=zke("startsWith"),Kke=!jU&&!!function(){var e=Bke(String.prototype,"startsWith");return e&&!e.writable}();Fke({target:"String",proto:!0,forced:!Kke&&!jU},{startsWith:function(t){var r=vD(Uke(this));Wke(t);var n=Vke(Gke(arguments.length>1?arguments[1]:void 0,r.length)),o=vD(t);return yD?yD(r,o,n):Yke(r,n,n+o.length)===o}});var gD=/^(\r\n|\n\r|\r|\n)/,qke=/^[^\t\r\n]+/,pD=/^\t/;function Xke(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(pD))e=e.replace(pD,""),r+=1,t[n][r]="";else if(e.match(gD))e=e.replace(gD,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(qke);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function Hc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function sS(e){return e$e(e)||Jke(e)||Qke(e)||Zke()}function Zke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qke(e,t){if(e){if(typeof e=="string")return DO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DO(e,t)}}function Jke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function e$e(e){if(Array.isArray(e))return DO(e)}function DO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Su(e){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function t$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n$e(n.key),n)}}function r$e(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n$e(e){var t=o$e(e,"string");return Su(t)==="symbol"?t:String(t)}function o$e(e,t){if(Su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i$e=function(){function e(t,r,n){t$e(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return r$e(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=Hm(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ue(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return UP(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Su(r)==="object"&&!Array.isArray(r)&&ze(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ve(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ve(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?vs(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,y=this.getSchema().length,m=[],w=function(){var k=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?k=fr(n.getSchema()):(k=[],Ce(y-1,function(){return k.push(null)})):n.instance.dataType==="function"?k=n.tableMeta.dataSchema(h+c):(k={},Cv(k,n.getSchema())),m.push(k),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,m);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),y=this.instance.countCols(),m=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;m<n&&y<u;){if(typeof c!="number"||c>=y)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var k=0;k<v;k++)s[k].splice(w,0,null);m+=1,w+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,m),m>0&&(r==null?this.metaManager.createColumn(null,m):i!=="auto"&&this.metaManager.createColumn(S,n));var O=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",O,m,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ve(this.tableMeta.columns)||ve(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var y=0,m=this.instance.countSourceRows();y<m;y++)for(var w=0;w<f;w++)c[y].splice(l[w],1),y===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];jC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return SV(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];jC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(sS(this.dataSource.slice(0,r)),sS(o),sS(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&Mt(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=ja(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=ja(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&Mt(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return Hc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Hc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const a$e=i$e;function l$e(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Mt(t,e)}function ub(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?JE(t.type):t.type;if(e._automaticallyAssignedMetaProps&&ze(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ue(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};ze(n,function(i,a){if(l$e(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),Ut(e,o)}}function s$e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Go(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Og(e){return Number.isInteger(e)&&e>=0}function Rg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Oy(e){return e==null}function NO(e){"@babel/helpers - typeof";return NO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NO(e)}const FU=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),qt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),qt(o)===!1)return NO(o)==="object"?(i=this.getCellMeta(t,r),Nm(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function bD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bD(Object(r),!0).forEach(function(n){u$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u$e(e,t,r){return t=VU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VU(n.key),n)}}function BU(e,t,r){return t&&SD(e.prototype,t),r&&SD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VU(e){var t=f$e(e,"string");return ld(t)==="symbol"?t:String(t)}function f$e(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c$e(){return BU(function e(){WU(this,e)})}var h$e=function(){function e(t){WU(this,e),this.metaCtor=c$e(),this.meta=this.metaCtor.prototype,Ut(this.meta,FU()),this.meta.instance=t}return BU(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;Ut(this.meta,r),ub(this.meta,wD(wD({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function d$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y$e(n.key),n)}}function v$e(e,t,r){return t&&CD(e.prototype,t),r&&CD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y$e(e){var t=g$e(e,"string");return sd(t)==="symbol"?t:String(t)}function g$e(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p$e=function(){function e(t){d$e(this,e);var r=t.getMetaConstructor();this.meta=new r}return v$e(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){Ut(this.meta,r),ub(this.meta,r,r)}}]),e}();function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function _D(e){return S$e(e)||w$e(e)||b$e(e)||m$e()}function m$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b$e(e,t){if(e){if(typeof e=="string")return HO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HO(e,t)}}function w$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function S$e(e){if(Array.isArray(e))return HO(e)}function HO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O$e(n.key),n)}}function _$e(e,t,r){return t&&OD(e.prototype,t),r&&OD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O$e(e){var t=R$e(e,"string");return ud(t)==="symbol"?t:String(t)}function R$e(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LO=function(e){function t(r){C$e(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return _$e(t,[{key:"obtain",value:function(n){Rg(function(){return Og(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Rg(function(){return Og(n)||Oy(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=Oy(n)?this.index.length:n;this.index=[].concat(_D(this.index.slice(0,s)),i,_D(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Rg(function(){return Og(n)||Oy(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(Oy(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Wr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function E$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P$e(n.key),n)}}function T$e(e,t,r){return t&&RD(e.prototype,t),r&&RD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P$e(e){var t=k$e(e,"string");return fd(t)==="symbol"?t:String(t)}function k$e(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $$e=["data","width"],A$e=function(){function e(t){var r=this;E$e(this,e),this.globalMeta=t,this.metas=new LO(function(){return r._createMeta()})}return T$e(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);Ut(o,n),ub(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return s$e(this.globalMeta.getMetaConstructor(),$$e).prototype}}]),e}();function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function I$e(e){return N$e(e)||D$e(e)||x$e(e)||M$e()}function M$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x$e(e,t){if(e){if(typeof e=="string")return jO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jO(e,t)}}function D$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function N$e(e){if(Array.isArray(e))return jO(e)}function jO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function H$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ED(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j$e(n.key),n)}}function L$e(e,t,r){return t&&ED(e.prototype,t),r&&ED(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j$e(e){var t=F$e(e,"string");return cd(t)==="symbol"?t:String(t)}function F$e(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B$e=function(){function e(t){var r=this;H$e(this,e),this.columnMeta=t,this.metas=new LO(function(){return r._createRow()})}return L$e(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);Ut(i,o),ub(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,I$e(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){Rg(function(){return Og(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new LO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function V$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U$e(n.key),n)}}function W$e(e,t,r){return t&&TD(e.prototype,t),r&&TD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U$e(e){var t=z$e(e,"string");return hd(t)==="symbol"?t:String(t)}function z$e(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UU=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];V$e(this,e),this.hot=t,this.globalMeta=new h$e(t),this.tableMeta=new p$e(this.globalMeta),this.columnMeta=new A$e(this.globalMeta),this.cellMeta=new B$e(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return W$e(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();gt(UU,Mr);function Fp(e){"@babel/helpers - typeof";return Fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fp(e)}function PD(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=ur(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":pt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new a$e(o,e,u);if(t(d),Fp(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var y,m=0,w=0;for(m=0,w=h.startRows;m<w;m++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)y=fr(v),e.push(y);else if(o.dataType==="array")y=fr(v[0]),e.push(y);else{y=[];for(var S=0,C=h.startCols;S<C;S++)y.push(null);e.push(y)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Fp(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function Y$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K$e(n.key),n)}}function G$e(e,t,r){return t&&kD(e.prototype,t),r&&kD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K$e(e){var t=q$e(e,"string");return dd(t)==="symbol"?t:String(t)}function q$e(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X$e=function(){function e(t){var r=this;Y$e(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ge.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return G$e(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=Mt(r,"type")?r.type:null,c=pt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function Z$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J$e(n.key),n)}}function Q$e(e,t,r){return t&&$D(e.prototype,t),r&&$D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J$e(e){var t=e1e(e,"string");return vd(t)==="symbol"?t:String(t)}function e1e(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t1e=function(){function e(t){Z$e(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return Q$e(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),AD=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ry=function(t){return t.map(function(r){var n=r.toLowerCase();return AD.has(n)?AD.get(n):n}).sort().join("+")},r1e=function(t){return t.split("+")},ID=function(t){return t.toLowerCase()},MD;function n1e(e){return a1e(e)||i1e(e)||zU(e)||o1e()}function o1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function a1e(e){if(Array.isArray(e))return FO(e)}function l1e(e,t){return f1e(e)||u1e(e,t)||zU(e,t)||s1e()}function s1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zU(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function f1e(e){if(Array.isArray(e))return e}function c1e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var h1e=function(t){var r=zm({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,y=v===void 0?function(){return!0}:v,m=f.captureCtrl,w=m===void 0?!1:m,S=f.preventDefault,C=S===void 0?!0:S,k=f.stopPropagation,O=k===void 0?!1:k,W=f.relativeToGroup,Y=f.position;if(mt(d))throw new Error("You need to define the shortcut's group.");if(pt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(dt(MD||(MD=c1e([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var q={callback:h,group:d,runOnlyIf:y,captureCtrl:w,preventDefault:C,stopPropagation:O};if(ve(W)){var G=[W,Y];q.relativeToGroup=G[0],q.position=G[1]}c.forEach(function(X){var Q=Ry(X),oe=r.hasItem(Q);if(oe){var J=r.getItem(Q),ue=J.findIndex(function(he){return he.group===W});ue!==-1?Y==="before"?ue-=1:ue+=1:ue=J.length,J.splice(ue,0,q)}else r.addItem(Q,[q])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){ze(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=Ry(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=l1e(h,2),v=d[0],y=d[1],m=y.filter(function(w){return w.group!==f});m.length===0?i(r1e(v)):(y.length=0,y.push.apply(y,n1e(m)))})},l=function(f){var c=Ry(f),h=r.getItem(c);return ve(h)?h.slice():[]},s=function(f){var c=Ry(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function d1e(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var v1e=["meta","alt","shift","control"],nc=d1e();function y1e(e,t,r,n,o){var i=function(d){return v1e.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return d.altKey&&y.push("alt"),v&&(d.ctrlKey||d.metaKey)?y.push("control/meta"):(d.ctrlKey&&y.push("control"),d.metaKey&&y.push("meta")),d.shiftKey&&y.push("shift"),y},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||aa(d))){var y=ID(d.key),m=[];i(y)?nc.press(y):m=a(d);var w=[y].concat(m),S=o(d,w);!S&&(Xg()&&m.includes("meta")||!Xg()&&m.includes("control"))&&o(d,[y].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=ID(d.key);i(v)!==!1&&nc.release(v)}},u=function(){nc.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Kc(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Kc(d)};return{mount:f,unmount:c,isPressed:function(d){return nc.isPressed(d)},releasePressedKeys:function(){return nc.releaseAll()}}}var g1e=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=zm({errorIdExists:function(y){return'The "'.concat(y,'" context name is already registered.')}}),l="grid",s=function(y){var m=h1e(y);return a.addItem(y,m),m},u=function(){return l},f=function(y){return a.getItem(y)},c=function(y){l=y},h=!1,d=y1e(r,n,o,i,function(v,y){var m=f(u()),w=!1;if(!m.hasShortcut(y))return w;for(var S=m.getShortcuts(y),C=0;C<S.length;C++){var k=S[C],O=k.callback,W=k.runOnlyIf,Y=k.preventDefault,q=k.stopPropagation,G=k.captureCtrl;if(W(v)!==!1&&(h=G,w=O(v,y)===!1,h=!1,Y&&v.preventDefault(),q&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}};function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(e)}function kn(e,t){return b1e(e)||m1e(e,t)||YU(e,t)||p1e()}function p1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function b1e(e){if(Array.isArray(e))return e}function Tl(e){return C1e(e)||S1e(e)||YU(e)||w1e()}function w1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YU(e,t){if(e){if(typeof e=="string")return BO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(e,t)}}function S1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function C1e(e){if(Array.isArray(e))return BO(e)}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _1e="gridDefault",uS=null;function KP(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new Pt(a),s,u,f,c,h=!0;bTe(o)&&mTe(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=lPe(t.language);var y=new UU(a,t,[X$e,t1e]),m=y.getTableMeta(),w=y.getGlobalMeta(),S=zm();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),TO(this)&&RV(t.licenseKey,e),this.guid="ht_".concat(kE()),this.columnIndexMapper=new rO,this.rowIndexMapper=new rO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterRowSequenceChange",g)}),u=new UTe(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(p){var b=p.row,E=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,E>=0?a.columnIndexMapper.getRenderableFromVisualIndex(E):E)},k=function(p){var b=p.row,E=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,E>=0?a.columnIndexMapper.getVisualFromRenderableIndex(E):E)},O=new jke(m,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(p){return s.propToCol(p)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(p,b){return a._createCellCoords(p,b)},createCellRange:function(p,b,E){return a._createCellRange(p,b,E)},visualToRenderableCoords:C,renderableToVisualCoords:k,isDisabledCellSelection:function(p,b){return a.getCellMeta(p,b).disableVisualSelection}});this.selection=O;var W=function(p){var b=p.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",W),this.rowIndexMapper.addLocalHook("cacheUpdated",W),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var p=ja(!1),b=n.selection.getSelectedRange(),E=b.current(),R=E.from,F=E.to,x=b.size()-1;n.runHooks("afterSelection",R.row,R.col,F.row,F.col,p,x),n.runHooks("afterSelectionByProp",R.row,a.colToProp(R.col),F.row,a.colToProp(F.col),p,x);var K=n.selection.isSelectedByAnyHeader(),Z=n.selection.selectedRange.current(),re=!0;i&&(re=!1),p.isTouched()&&(re=!p.value);var ie=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();re!==!1&&(K?ie?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):Z&&!n.selection.isMultiple()?n.view.scrollViewport(C(Z.from)):n.view.scrollViewport(C(g))),ie&&se?te(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ie?(Le(n.rootElement,"ht__selection--columns"),te(n.rootElement,"ht__selection--rows")):se?(Le(n.rootElement,"ht__selection--rows"),te(n.rootElement,"ht__selection--columns")):Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var p=g.length-1,b=g[p],E=b.from,R=b.to;n.runHooks("afterSelectionEnd",E.row,E.col,R.row,R.col,p),n.runHooks("afterSelectionEndByProp",E.row,a.colToProp(E.col),R.row,a.colToProp(R.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var p=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,p,b){n.runHooks("afterModifyTransformStart",g,p,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,p,b){n.runHooks("afterModifyTransformEnd",g,p,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),f={alter:function(p,b){var E,R,F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0,Z=function(Me){if(Me.length===0)return[];var De=Tl(Me);De.sort(function(Ft,Ve){var Je=kn(Ft,1),St=Je[0],ut=kn(Ve,1),ft=ut[0];return St===ft?0:St>ft?1:-1});var dr=jt(De,function(Ft,Ve){var Je=kn(Ve,2),St=Je[0],ut=Je[1],ft=Ft[Ft.length-1],et=kn(ft,2),Ko=et[0],db=et[1],Li=Ko+db;if(St<=Li){var Nf=Math.max(ut-(Li-St),0);ft[1]+=Nf}else Ft.push([St,ut]);return Ft},[De[0]]);return dr};switch(p){case"insert_row_below":case"insert_row_above":var re=a.countSourceRows();if(m.maxRows===re)return;var ie=p==="insert_row_below"?"below":"above";b=(E=b)!==null&&E!==void 0?E:ie==="below"?re:0;var se=s.createRow(b,F,{source:x,mode:ie}),_e=se.delta,Se=se.startPhysicalIndex;if(_e){var U=O.selectedRange.current(),Ne=U==null?void 0:U.from,Be=Ne==null?void 0:Ne.row,ke=a.toVisualRow(Se);if(O.isSelectedByCorner())a.selectAll();else if(ve(Be)&&Be>=ke){var Ie=U.to,Ae=Ie.row,_=Ie.col,T=Ne.col;O.isSelectedByRowHeader()&&(T=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(a._createCellCoords(Be+_e,T),!0),O.setRangeEnd(a._createCellCoords(Ae+_e,_))}else a._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var I=p==="insert_col_end"?"end":"start";b=(R=b)!==null&&R!==void 0?R:I==="end"?a.countSourceCols():0;var j=s.createCol(b,F,{source:x,mode:I}),M=j.delta,B=j.startPhysicalIndex;if(M){if(Array.isArray(m.colHeaders)){var N=[a.toVisualColumn(B),0];N.length+=M,Array.prototype.splice.apply(m.colHeaders,N)}var D=O.selectedRange.current(),V=D==null?void 0:D.from,L=V==null?void 0:V.col,z=a.toVisualColumn(B);if(O.isSelectedByCorner())a.selectAll();else if(ve(L)&&L>=z){var le=D.to,pe=le.row,Re=le.col,He=V.row;O.isSelectedByColumnHeader()&&(He=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(a._createCellCoords(He,L+M),!0),O.setRangeEnd(a._createCellCoords(pe,Re+M))}else a._refreshBorders()}break;case"remove_row":var Ze=function(Me){var De=0;A(Me,function(dr){var Ft=kn(dr,2),Ve=Ft[0],Je=Ft[1],St=qt(Ve)?a.countRows()-1:Math.max(Ve-De,0);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ut=s.removeRow(Ve,Je,x);if(ut){var ft=a.countRows(),et=m.fixedRowsTop;et>=St+1&&(m.fixedRowsTop-=Math.min(Je,et-St));var Ko=m.fixedRowsBottom;Ko&&St>=ft-Ko&&(m.fixedRowsBottom-=Math.min(Je,Ko)),De+=Je}})};Array.isArray(b)?Ze(Z(b)):Ze([[b,F]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var st=function(Me){var De=0;A(Me,function(dr){var Ft=kn(dr,2),Ve=Ft[0],Je=Ft[1],St=qt(Ve)?a.countCols()-1:Math.max(Ve-De,0),ut=a.toPhysicalColumn(St);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ft=s.removeCol(Ve,Je,x);if(ft){var et=m.fixedColumnsStart;et>=St+1&&(m.fixedColumnsStart-=Math.min(Je,et-St)),Array.isArray(m.colHeaders)&&(typeof ut>"u"&&(ut=-1),m.colHeaders.splice(ut,Je)),De+=Je}})};Array.isArray(b)?st(Z(b)):st([[b,F]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(p,'"'))}K||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var p=m.minRows,b=m.minSpareRows,E=m.minCols,R=m.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&O.deselect(),p){var F=a.countRows();F<p&&s.createRow(F,p-F,{source:"auto"})}if(b){var x=a.countEmptyRows(!0);if(x<b){var K=b-x,Z=Math.min(K,m.maxRows-a.countSourceRows());s.createRow(a.countRows(),Z,{source:"auto"})}}{var re;(E||R)&&(re=a.countEmptyCols(!0));var ie=a.countCols();if(E&&!m.columns&&ie<E){var se=E-ie;re+=se,s.createCol(ie,se,{source:"auto"})}if(R&&!m.columns&&a.dataType==="array"&&re<R){ie=a.countCols();var _e=R-re,Se=Math.min(_e,m.maxCols-ie);s.createCol(ie,Se,{source:"auto"})}}if(O.isSelected()){var U=a.countRows(),Ne=a.countCols();A(O.selectedRange,function(Be){var ke=!1,Ie=Be.from.row,Ae=Be.from.col,_=Be.to.row,T=Be.to.col;Ie>U-1?(Ie=U-1,ke=!0,_>Ie&&(_=Ie)):_>U-1&&(_=U-1,ke=!0,Ie>_&&(Ie=_)),Ae>Ne-1?(Ae=Ne-1,ke=!0,T>Ae&&(T=Ae)):T>Ne-1&&(T=Ne-1,ke=!0,Ae>T&&(Ae=T)),ke&&a.selectCell(Ie,Ae,_,T)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(p,b,E,R,F){var x,K,Z,re,ie=[],se={},_e=[],Se=p.row,U=p.col;if(K=b.length,K===0)return!1;var Ne=0,Be=0;switch(Ue(E)&&(Ne=E.col-U+1,Be=E.row-Se+1),F){case"shift_down":var ke=Ec(b),Ie=ke.length,Ae=Math.max(Ie,Ne),_=a.getData().slice(Se),T=Ec(_).slice(U,U+Ae);for(Z=0;Z<Ae;Z+=1)if(Z<Ie){for(x=0,K=ke[Z].length;x<Be-K;x+=1)ke[Z].push(ke[Z][x%K]);Z<T.length?_e.push(ke[Z].concat(T[Z])):_e.push(ke[Z].concat(new Array(_.length).fill(null)))}else _e.push(ke[Z%Ie].concat(T[Z]));a.populateFromArray(Se,U,Ec(_e));break;case"shift_right":var I=b.length,j=Math.max(I,Be),M=a.getData().slice(Se).map(function(Ve){return Ve.slice(U)});for(x=0;x<j;x+=1)if(x<I){for(Z=0,re=b[x].length;Z<Ne-re;Z+=1)b[x].push(b[x][Z%re]);if(x<M.length)for(var B=0;B<M[x].length;B+=1)b[x].push(M[x][B]);else{var N;(N=b[x]).push.apply(N,Tl(new Array(M[0].length).fill(null)))}}else b.push(b[x%K].slice(0,j).concat(M[x]));a.populateFromArray(Se,U,b);break;case"overwrite":default:se.row=p.row,se.col=p.col;var D=0,V=0,L=!0,z,le=function(Je){var St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ut=b[Je%b.length];return St!==null?ut[St%ut.length]:ut},pe=b.length,Re=E?E.row-p.row+1:0;for(E?K=Re:K=Math.max(pe,Re),x=0;x<K&&!(E&&se.row>E.row&&Re>pe||!m.allowInsertRow&&se.row>a.countRows()-1||se.row>=m.maxRows);x++){var He=x-D,Ze=le(He).length,st=E?E.col-p.col+1:0;if(E?re=st:re=Math.max(Ze,st),se.col=p.col,z=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&z.skipRowOnPaste){D+=1,se.row+=1,K+=1;continue}for(V=0,Z=0;Z<re&&!(E&&se.col>E.col&&st>Ze||!m.allowInsertColumn&&se.col>a.countCols()-1||se.col>=m.maxCols);Z++){if(z=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&z.skipColumnOnPaste){V+=1,se.col+=1,re+=1;continue}if(z.readOnly&&R!=="UndoRedo.undo"){se.col+=1;continue}var Ge=Z-V,Me=le(He,Ge),De=a.getDataAtCell(se.row,se.col);if(Me!==null&&Er(Me)==="object")if(Array.isArray(Me)&&De===null&&(De=[]),De===null||Er(De)!=="object")L=!1;else{var dr=vs(Array.isArray(De)?De:De[0]||De),Ft=vs(Array.isArray(Me)?Me:Me[0]||Me);Nm(dr,Ft)||Array.isArray(dr)&&Array.isArray(Ft)?Me=fr(Me):L=!1}else De!==null&&Er(De)==="object"&&(L=!1);L&&ie.push([se.row,se.col,Me]),L=!0,se.col+=1}se.row+=1}a.setDataAtCell(ie,null,null,R||"populateFromArray");break}}};function Y(g){var p=OU(g);zP(p)?(a.runHooks("beforeLanguageChange",p),w.language=p,a.runHooks("afterLanguageChange",p)):RU(g)}function q(g,p){var b=g==="className"?a.rootElement:a.table;if(h)te(b,p);else{var E=[],R=[];w[g]&&(E=Array.isArray(w[g])?w[g]:BC(w[g])),p&&(R=Array.isArray(p)?p:BC(p));var F=FC(E,R),x=FC(R,E);F.length&&Le(b,F),x.length&&te(b,x)}w[g]=p}this.init=function(){u.setData(m.data),a.runHooks("beforeInit"),(gn()||OE())&&te(a.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new MTe(this),c=Jle.getInstance(a,m,O),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&iW(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Er(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function G(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function X(g){var p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function Q(g,p,b){if(g.length){var E=a.getActiveEditor(),R=new G,F=!0;R.onQueueEmpty=function(Se){E&&F&&E.cancelChanges(),b(Se)};for(var x=g.length-1;x>=0;x--){var K=kn(g[x],4),Z=K[0],re=K[1],ie=K[3],se=s.propToCol(re),_e=a.getCellMeta(Z,se);_e.type==="numeric"&&typeof ie=="string"&&pW(ie)&&(g[x][3]=X(ie)),a.getCellValidator(_e)&&(R.addValidatorToQueue(),a.validateCell(g[x][3],_e,function(Se,U){return function(Ne){if(typeof Ne!="boolean")throw new Error("Validation error: result is not boolean");if(Ne===!1&&U.allowInvalid===!1){F=!1,g.splice(Se,1),U.valid=!0;var Be=a.getCell(U.visualRow,U.visualCol);Be!==null&&Le(Be,m.invalidCellClassName)}R.removeValidatorFormQueue()}}(x,_e),p))}R.checkIfQueueIsEmpty()}}function oe(g,p){var b=g.length-1;if(!(b<0)){for(;b>=0;b--){var E=!1;if(g[b]===null){g.splice(b,1);continue}if(!((g[b][2]===null||g[b][2]===void 0)&&(g[b][3]===null||g[b][3]===void 0))){if(m.allowInsertRow)for(;g[b][0]>a.countRows()-1;){var R=s.createRow(void 0,void 0,{source:p}),F=R.delta;if(F===0){E=!0;break}}if(a.dataType==="array"&&(!m.columns||m.columns.length===0)&&m.allowInsertColumn)for(;s.propToCol(g[b][1])>a.countCols()-1;){var x=s.createCol(void 0,void 0,{source:p}),K=x.delta;if(K===0){E=!0;break}}E||s.set(g[b][0],g[b][1],g[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,p),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,p||"edit");var Z=a.getActiveEditor();Z&&ve(Z.refreshValue)&&Z.refreshValue()}}this._createCellCoords=function(g,p){return a.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,b){return a.view._wt.createCellRange(g,p,b)},this.validateCell=function(g,p,b,E){var R=a.getCellValidator(p);function F(x){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!K||p.hidden===!0){b(x);return}var Z=p.visualCol,re=p.visualRow,ie=a.getCell(re,Z,!0);if(ie&&ie.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(re),_e=a.columnIndexMapper.getRenderableFromVisualIndex(Z);a.view._wt.getSetting("cellRenderer",se,_e,ie)}b(x)}OV(R)&&(R=function(x){return function(K,Z){Z(x.test(K))}}(R)),pt(R)?(g=a.runHooks("beforeValidate",g,p.visualRow,p.prop,E),a._registerImmediate(function(){R.call(p,g,function(x){a&&(x=a.runHooks("afterValidate",x,g,p.visualRow,p.prop,E),p.valid=x,F(x),a.runHooks("postAfterValidate",x,g,p.visualRow,p.prop,E))})})):a._registerImmediate(function(){p.valid=!0,F(p.valid,!1)})};function J(g,p,b){return Array.isArray(g)?g:[[g,p,b]]}function ue(g,p){var b=a.getActiveEditor(),E=a.runHooks("beforeChange",g,p||"edit"),R=g.filter(function(F){return F!==null});return E===!1||R.length===0?(b&&b.cancelChanges(),[]):R}this.setDataAtCell=function(g,p,b,E){var R=J(g,p,b),F=[],x=E,K,Z,re;for(K=0,Z=R.length;K<Z;K++){if(Er(R[K])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[K][1]>=this.countCols()?re=R[K][1]:re=s.colToProp(R[K][1]),F.push([R[K][0],re,u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]])}!x&&Er(g)==="object"&&(x=p);var ie=ue(F,E);a.runHooks("afterSetDataAtCell",ie,x),Q(ie,x,function(){oe(ie,x)})},this.setDataAtRowProp=function(g,p,b,E){var R=J(g,p,b),F=[],x=E,K,Z;for(K=0,Z=R.length;K<Z;K++)F.push([R[K][0],R[K][1],u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]]);!x&&Er(g)==="object"&&(x=p);var re=ue(F,E);a.runHooks("afterSetDataAtRowProp",re,x),Q(re,x,function(){oe(re,x)})},this.listen=function(){a&&!a.isListening()&&(uS=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(uS=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return uS===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,p)},this.populateFromArray=function(g,p,b,E,R,F,x){if(!(Er(b)==="object"&&Er(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var K=typeof E=="number"?a._createCellCoords(E,R):null;return f.populateFromArray(a._createCellCoords(g,p),b,K,F,x)},this.spliceCol=function(g,p,b){for(var E,R=arguments.length,F=new Array(R>3?R-3:0),x=3;x<R;x++)F[x-3]=arguments[x];return(E=s).spliceCol.apply(E,[g,p,b].concat(F))},this.spliceRow=function(g,p,b){for(var E,R=arguments.length,F=new Array(R>3?R-3:0),x=3;x<R;x++)F[x-3]=arguments[x];return(E=s).spliceRow.apply(E,[g,p,b].concat(F))},this.getSelected=function(){if(O.isSelected())return We(O.getSelectedRange(),function(g){var p=g.from,b=g.to;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){var g=this.getSelected(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){var p=this;if(!(!O.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];A(O.getSelectedRange(),function(E){var R=E.getTopStartCorner(),F=E.getBottomEndCorner();Ce(R.row,F.row,function(x){Ce(R.col,F.col,function(K){p.getCellMeta(x,K).readOnly||b.push([x,K,null])})})}),b.length>0&&this.setDataAtCell(b,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=g();return this.resumeExecution(p),b},this.batch=function(g){this.suspendRender(),this.suspendExecution();var p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),p=g.width,b=g.height,E=a.rootElement.getBoundingClientRect(),R=E.width,F=E.height,x=R!==p||F!==b,K=a.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:R,height:F},x)===!1;K||((x||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(R,F),a.render()),a.runHooks("afterRefreshDimensions",{width:p,height:b},{width:R,height:F},x))}},this.updateData=function(g,p){var b=this;PD(g,function(E){s=E},function(E){s=E,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:p,metaManager:y,firstRun:h})},this.loadData=function(g,p){PD(g,function(b){s=b},function(){y.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:p,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var g=m.columns,p=0;if(Array.isArray(g))p=g.length;else if(pt(g))if(a.dataType==="array")for(var b=this.countSourceCols(),E=0;E<b;E+=1)g(E)&&(p+=1);else(a.dataType==="object"||a.dataType==="function")&&(p=s.colToPropCache.length);else if(ve(m.dataSchema)){var R=s.getSchema();p=Array.isArray(R)?R.length:Hm(R)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,b,E){return mt(g)?s.getAll():s.getRange(a._createCellCoords(g,p),a._createCellCoords(b,E),s.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,b,E){return s.getCopyableText(a._createCellCoords(g,p),a._createCellCoords(b,E))},this.getCopyableData=function(g,p){return s.getCopyable(g,s.colToProp(p))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),E=!1,R,F;if(ve(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ve(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ve(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in g)R==="data"||(R==="language"?Y(g.language):R==="className"?q("className",g.className):R==="tableClassName"&&a.table?(q("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(R)||ge.getSingleton().isDeprecated(R)?(pt(g[R])||Array.isArray(g[R]))&&(g[R].initialHook=!0,a.addHook(R,g[R])):!p&&Mt(g,R)&&(w[R]=g[R]));g.data===void 0&&m.data===void 0?b(null,"updateSettings"):g.data!==void 0?b(g.data,"updateSettings"):g.columns!==void 0&&(s.createMap(),a.initIndexMappers());var x=a.countCols(),K=m.columns;if(K&&pt(K)&&(E=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),x>0)for(R=0,F=0;R<x;R++){if(K){var Z=E?K(R):K[F];Z&&y.updateColumnMeta(F,Z)}F+=1}ve(g.cell)&&ze(g.cell,function(U){a.setCellMetaObject(U.row,U.col,U)}),a.runHooks("afterCellMetaReset");var re=a.rootElement.style.height;re!==""&&(re=parseInt(a.rootElement.style.height,10));var ie=g.height;if(pt(ie)&&(ie=ie()),p){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ie===null){var _e=a.rootElement.getAttribute("data-initialstyle");_e&&(_e.indexOf("height")>-1||_e.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",_e):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ie!==void 0&&(a.rootElement.style.height=isNaN(ie)?"".concat(ie):"".concat(ie,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var Se=g.width;pt(Se)&&(Se=Se()),a.rootElement.style.width=isNaN(Se)?"".concat(Se):"".concat(Se,"px")}p||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!p&&a.view&&(re===""||ie===""||ie===void 0)&&re!==ie&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(m.getValue){if(pt(m.getValue))return m.getValue.call(a);if(g)return a.getData()[g[0][0]][m.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return m},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,b,E,R){f.alter(g,p,b,E,R)},this.getCell=function(g,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=p,R=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return R===null||E===null?null:a.view.getCellAtCoords(a._createCellCoords(R,E),b)},this.getCoords=function(g){var p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;var b=p.row,E=p.col,R=b,F=E;return b>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(b)),E>=0&&(F=this.columnIndexMapper.getVisualFromRenderableIndex(E)),a._createCellCoords(R,F)},this.colToProp=function(g){return s.colToProp(g)},this.propToCol=function(g){return s.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,p){return s.get(g,s.colToProp(p))},this.getDataAtRowProp=function(g,p){return s.get(g,p)},this.getDataAtCol=function(g){for(var p=[],b=s.getRange(a._createCellCoords(0,g),a._createCellCoords(m.data.length-1,g),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var R=0;R<b[E].length;R+=1)p.push(b[E][R]);return p},this.getDataAtProp=function(g){for(var p=[],b=s.getRange(a._createCellCoords(0,s.propToCol(g)),a._createCellCoords(m.data.length-1,s.propToCol(g)),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var R=0;R<b[E].length;R+=1)p.push(b[E][R]);return p},this.getSourceData=function(g,p,b,E){var R;return g===void 0?R=u.getData():R=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(b,E)),R},this.getSourceDataArray=function(g,p,b,E){var R;return g===void 0?R=u.getData(!0):R=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(b,E),!0),R},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,b,E){var R=J(g,p,b),F=this.hasHook("afterSetSourceDataAtCell"),x=[];F&&A(R,function(Z){var re=kn(Z,3),ie=re[0],se=re[1],_e=re[2];x.push([ie,se,u.getAtCell(ie,se),_e])}),A(R,function(Z){var re=kn(Z,3),ie=re[0],se=re[1],_e=re[2];u.setAtCell(ie,se,_e)}),F&&this.runHooks("afterSetSourceDataAtCell",x,E),this.render();var K=a.getActiveEditor();K&&ve(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return u.getAtCell(g,p)},this.getDataAtRow=function(g){var p=s.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),s.DESTINATION_RENDERER);return p[0]||[]},this.getDataType=function(g,p,b,E){var R=this,F=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,b,E],x=F[0],K=F[1],Z=F[2],re=F[3],ie=null,se=null;Z===void 0&&(Z=x),re===void 0&&(re=K);var _e="mixed";return Ce(Math.max(Math.min(x,Z),0),Math.max(x,Z),function(Se){var U=!0;return Ce(Math.max(Math.min(K,re),0),Math.max(K,re),function(Ne){var Be=R.getCellMeta(Se,Ne);return se=Be.type,ie?U=ie===se:ie=se,U}),_e=U?se:"mixed",U}),_e},this.removeCellMeta=function(g,p,b){var E=[this.toPhysicalRow(g),this.toPhysicalColumn(p)],R=E[0],F=E[1],x=y.getCellMetaKeyValue(R,F,b),K=a.runHooks("beforeRemoveCellMeta",g,p,b,x);K!==!1&&(y.removeCellMeta(R,F,b),a.runHooks("afterRemoveCellMeta",g,p,b,x)),x=null},this.spliceCellsMeta=function(g){for(var p=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=arguments.length,R=new Array(E>2?E-2:0),F=2;F<E;F++)R[F-2]=arguments[F];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&y.removeRow(this.toPhysicalRow(g),b),R.length>0&&A(R.reverse(),function(x){y.createRow(p.toPhysicalRow(g)),A(x,function(K,Z){return p.setCellMetaObject(g,Z,K)})}),a.render()},this.setCellMetaObject=function(g,p,b){var E=this;Er(b)==="object"&&ze(b,function(R,F){E.setCellMeta(g,p,F,R)})},this.setCellMeta=function(g,p,b,E){var R=a.runHooks("beforeSetCellMeta",g,p,b,E);if(R!==!1){var F=g,x=p;g<this.countRows()&&(F=this.toPhysicalRow(g)),p<this.countCols()&&(x=this.toPhysicalColumn(p)),y.setCellMeta(F,x,b,E),a.runHooks("afterSetCellMeta",g,p,b,E)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,p){var b=this.toPhysicalRow(g),E=this.toPhysicalColumn(p);return b===null&&(b=g),E===null&&(E=p),y.getCellMeta(b,E,{visualRow:g,visualColumn:p})},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||m.columns)},this.getCellRenderer=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).renderer:g.renderer;return typeof b=="string"?ap(b):mt(b)?ap("text"):b},this.getCellEditor=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).editor:g.editor;return typeof b=="string"?tp(b):mt(b)?tp("text"):b},this.getCellValidator=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).validator:g.validator;return typeof b=="string"?QE(b):b},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,b){var E=new G;g&&(E.onQueueEmpty=g);for(var R=a.countRows()-1;R>=0;){if(p!==void 0&&p.indexOf(R)===-1){R-=1;continue}for(var F=a.countCols()-1;F>=0;){if(b!==void 0&&b.indexOf(F)===-1){F-=1;continue}E.addValidatorToQueue(),a.validateCell(a.getDataAtCell(R,F),a.getCellMeta(R,F),function(x){if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),F-=1}R-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var p=m.rowHeaders,b=g;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(p=[],Ce(a.countRows()-1,function(E){p.push(a.getRowHeader(E))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:pt(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!m.rowHeaders},this.hasColHeaders=function(){if(m.colHeaders!==void 0&&m.colHeaders!==null)return!!m.colHeaders;for(var g=0,p=a.countCols();g<p;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",g);if(b===void 0){for(var E=[],R=a.countCols(),F=0;F<R;F++)E.push(a.getColHeader(F));return E}var x=m.colHeaders,K=function(se){for(var _e=[],Se=a.countCols(),U=0;U<Se;U++)pt(m.columns)&&m.columns(U)&&_e.push(U);return _e[se]},Z=a.toPhysicalColumn(b),re=K(Z);return m.colHeaders===!1?x=null:m.columns&&pt(m.columns)&&m.columns(re)&&m.columns(re).title?x=m.columns(re).title:m.columns&&m.columns[Z]&&m.columns[Z].title?x=m.columns[Z].title:Array.isArray(m.colHeaders)&&m.colHeaders[Z]!==void 0?x=m.colHeaders[Z]:pt(m.colHeaders)?x=m.colHeaders(Z):m.colHeaders&&typeof m.colHeaders!="string"&&typeof m.colHeaders!="number"&&(x=ib(b)),x=a.runHooks("modifyColumnHeaderValue",x,g,p),x},this._getColWidthFromSettings=function(g){var p;if(g>=0){var b=a.getCellMeta(0,g);p=b.width}if((p===void 0||p===m.width)&&(p=m.colWidths),p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g){var p=a._getColWidthFromSettings(g);return p=a.runHooks("modifyColWidth",p,g),p===void 0&&(p=nT.DEFAULT_WIDTH),p},this._getRowHeightFromSettings=function(g){var p=m.rowHeights;if(p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(g){var p=a._getRowHeightFromSettings(g);return p=a.runHooks("modifyRowHeight",p,g),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var g=m.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return np(a.countRows()-1,function(b){if(a.isEmptyRow(b))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return np(a.countCols()-1,function(b){if(a.isEmptyCol(b))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return m.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return m.isEmptyCol.call(a,g)},this.selectCell=function(g,p,b,E){var R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mt(g)||mt(p)?!1:this.selectCells([[g,p,b,E]],R,F)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&(i=!0);var E=O.selectCells(g);return E&&b&&a.listen(),i=!1,E},this.selectColumns=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return O.selectColumns(g,p)},this.selectRows=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return O.selectRows(g,p)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=g&&this.hasRowHeaders(),b=g&&this.hasColHeaders();i=!0,O.selectAll(p,b),i=!1};var he=function(p,b){return p.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(g,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=!b,x=!E,K=g,Z=p;if(R){var re=Number.isInteger(g),ie=Number.isInteger(p),se=re?he(this.rowIndexMapper,g):void 0,_e=ie?he(this.columnIndexMapper,p):void 0;if(se===null||_e===null)return!1;K=re?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,Z=ie?a.columnIndexMapper.getRenderableFromVisualIndex(_e):void 0}var Se=Number.isInteger(K),U=Number.isInteger(Z);return Se&&U?a.view.scrollViewport(a._createCellCoords(K,Z),F,E,b,x):Se&&U===!1?a.view.scrollViewportVertically(K,F,b):U&&Se===!1?a.view.scrollViewportHorizontally(Z,E,x):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),TO(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Sn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(p){var b=kn(p,2),E=b[1];E.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(a),ze(a,function(p,b,E){pt(p)?E[b]=Oe(b):b!=="guid"&&(E[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,O=null,c=null,a=null};function Oe(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){var p=ur(g);return p==="UndoRedo"?this.undoRedo:S.getItem(p)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,p){ge.getSingleton().add(g,p,a)},this.hasHook=function(g){return ge.getSingleton().has(g,a)||ge.getSingleton().has(g)},this.addHookOnce=function(g,p){ge.getSingleton().once(g,p,a)},this.removeHook=function(g,p){ge.getSingleton().remove(g,p,a)},this.runHooks=function(g,p,b,E,R,F,x){return ge.getSingleton().run(a,g,p,b,E,R,F,x)},this.getTranslatedPhrase=function(g,p){return AU(m.language,g,p)},this.toHTML=function(){return RO(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",RO(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=g;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){A(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){A(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(g),a.view.render(),p&&O.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var we=g1e({handleEvent:function(p){var b=a.isListening(),E=(p==null?void 0:p.key)!==void 0;return b&&E},beforeKeyDown:function(p){return n.runHooks("beforeKeyDown",p)},afterKeyDown:function(p){n.isDestroyed||a.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we};var $=we.addContext("grid"),P={runOnlyIf:function(){return ve(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:_1e};we.setActiveContextName("grid"),$.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var p=a.getSelectedRange(),b=p[p.length-1].highlight,E=b.row,R=b.col,F=a.getDataAtCell(E,R),x=new Map,K=0;K<p.length;K++)p[K].forAll(function(Z,re){if(Z>=0&&re>=0&&(Z!==E||re!==R)){var ie=a.getCellMeta(Z,re),se=ie.readOnly;se||x.set("".concat(Z,"x").concat(re),[Z,re,F])}});a.setDataAtCell(Array.from(x.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){O.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){O.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,E=p.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);O.setRangeStart(b.clone()),O.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){O.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){O.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,E=p.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);O.setRangeStart(b.clone()),O.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){O.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,E=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Tl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));O.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowLeft","Shift"]],callback:function(){O.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),E=b.from,R=b.to,F=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Tl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));O.setRangeStart(E.clone()),O.setRangeEnd(a._createCellCoords(R.row,F))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){O.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,E=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Tl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));O.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowRight","Shift"]],callback:function(){O.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),E=b.from,R=b.to,F=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Tl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));O.setRangeStart(E.clone()),O.setRangeEnd(a._createCellCoords(R.row,F))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,E=a.columnIndexMapper.getNearestNotHiddenIndex(p,1);O.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){O.setRangeEnd(a._createCellCoords(O.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),E=a.rowIndexMapper.getNearestNotHiddenIndex(p,1),R=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);O.setRangeStart(a._createCellCoords(E,R))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){O.setRangeEnd(a._createCellCoords(O.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-p-1,-1),E=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);O.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){O.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,E=Math.max(b.row-a.countVisibleRows(),0),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,1);if(R!==null){var F=a._createCellCoords(R,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.max(F.row-x,0);O.setRangeEnd(F),a.scrollViewportTo(K)}}},{keys:[["PageDown"]],callback:function(){O.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,E=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,-1);if(R!==null){var F=a._createCellCoords(R,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.min(F.row-x,a.countRows()-1);O.setRangeEnd(F),a.scrollViewportTo(K)}}},{keys:[["Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;O.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;O.transformStart(-b.row,-b.col)}}],P),tT().forEach(function(g){var p=$v(g);S.addItem(g,new p(n))}),ge.getSingleton().run(a,"construct")}function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function xD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function DD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xD(Object(r),!0).forEach(function(n){O1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O1e(e,t,r){return t=GU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ND(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GU(n.key),n)}}function E1e(e,t,r){return t&&ND(e.prototype,t),r&&ND(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GU(e){var t=T1e(e,"string");return yd(t)==="symbol"?t:String(t)}function T1e(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HD=215,KU="menu",P1e=KU,qU=function(){function e(t,r){R1e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:HD,container:this.hot.rootDocument.documentElement},this.eventManager=new Pt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return E1e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Kc(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=HE(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||HD,i=!1,a=Wr(this.menuItems,function(d){return d.key===Bh&&(i=!0),GRe(d,r.hot)});if(a.length<1&&!i)a.push(sU()[Bh]);else if(a.length===0)return;a=XRe(a,qe);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ve(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,y,m,w,S,C){return r.menuItemRenderer(v,y,m,w,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,y){r.isAllSubMenusClosed()?n(y.row):r.openSubMenu(y.row)},rowHeights:function(v){return a[v].name===qe?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),UC()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!UC()||!ki(v))&&l&&r.hasSelectedItem()&&(gn()||OE()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new KP(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(P1e),c={group:KU},h=DD(DD({},c),{},{runOnlyIf:function(v){return Zc(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var y=r.openSubMenu(v[0]);y&&y.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(y[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!WRe(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;A(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?VRe(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===qe||l===!0||a}},{key:"setPosition",value:function(r){var n=new dEe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);by(r)||wy(r)||Sy(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);by(n)||wy(n)||Sy(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(by(i)||wy(i)||Sy(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(by(i)||wy(i)||Sy(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return Mt(w,"submenu")},h=function(w){return new RegExp(qe,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},y=l;typeof y=="function"&&(y=y.call(this.hot)),Sn(n),te(f,"htItemWrapper"),n.appendChild(f),h(u)?te(n,"htSeparator"):typeof u.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,y))):ll(f,y),d(u)?(te(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(te(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(te(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Le(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(pt(o)&&(o=o.call(this.hot),o===null||mt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),te(i,"htMenu ".concat(this.options.className)),o&&te(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=jt(n,function(s,u){return s+(u.name===qe?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!pi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!pi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&pi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();gt(qU,Mr);const qP=qU;function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function k1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A1e(n.key),n)}}function $1e(e,t,r){return t&&LD(e.prototype,t),r&&LD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A1e(e){var t=I1e(e,"string");return Cu(t)==="symbol"?t:String(t)}function I1e(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=M1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function M1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function x1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VO(e,t)}function VO(e,t){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},VO(e,t)}function D1e(e){var t=H1e();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return N1e(this,o)}}function N1e(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XU(e)}function XU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var Ey="contextMenu",L1e=70;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var ZU=function(e){x1e(r,e);var t=D1e(r);function r(n){var o;return k1e(this,r),o=t.call(this,n),o.eventManager=new Pt(XU(o)),o.commandExecutor=new iU(o.hot),o.itemsFactory=null,o.menu=null,o}return $1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ey]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Ey];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new qP(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),ga(bo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ga(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),ga(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-ps(o.view),a=f-Fa(o.view)}else i=-1*ps(this.menu.hotMenu.rootWindow),a=-1*Fa(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new uU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Ey],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ga(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ey}},{key:"PLUGIN_PRIORITY",get:function(){return L1e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[rb,nb,qe,xv,Dv,qe,tb,Hv,qe,ob,Qm,qe,Nv,qe,Xr]}}]),r}(ot);ZU.SEPARATOR={name:qe};function j1e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(MT)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function F1e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(NT,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function B1e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(DT,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function V1e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(xT,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function W1e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(HT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function U1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y1e(n.key),n)}}function z1e(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y1e(e){var t=G1e(e,"string");return gd(t)==="symbol"?t:String(t)}function G1e(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K1e=function(){function e(){U1e(this,e),this.data={}}return z1e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X1e(n.key),n)}}function q1e(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X1e(e){var t=Z1e(e,"string");return pd(t)==="symbol"?t:String(t)}function Z1e(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var J1e=q1e(function e(){Q1e(this,e),this.clipboardData=new K1e});function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function eAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rAe(n.key),n)}}function tAe(e,t,r){return t&&BD(e.prototype,t),r&&BD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rAe(e){var t=nAe(e,"string");return md(t)==="symbol"?t:String(t)}function nAe(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XP=function(){function e(t){eAe(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Pt(this),this.listenersCount=new WeakSet,this.container=t}return tAe(e,[{key:"useSecondaryElement",value:function(){var r=aAe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),VD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),VD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",gn()||oW(this.mainElement)}}]),e}();gt(XP,Mr);var Bp=new WeakMap;function oAe(e){var t=new XP(e),r=Bp.get(e);return r=isNaN(r)?0:r,Bp.set(e,r+1),t}function iAe(e){e.eventManager.clear()}var fS=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function VD(e,t,r){e.addEventListener(t,"copy",fS("copy",r)),e.addEventListener(t,"cut",fS("cut",r)),e.addEventListener(t,"paste",fS("paste",r))}var Vp=new WeakMap;function aAe(e){var t=Vp.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Vp.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function WD(e){if(e instanceof XP){var t=Bp.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),iAe(e),t<=0){t=0;var r=Vp.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Vp.delete(e.container)),e.mainElement=null}Bp.set(e.container,t)}}function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function lAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uAe(n.key),n)}}function sAe(e,t,r){return t&&UD(e.prototype,t),r&&UD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uAe(e){var t=fAe(e,"string");return bd(t)==="symbol"?t:String(t)}function fAe(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zD(e,t){QU(e,t),t.add(e)}function Pl(e,t,r){QU(e,t),t.set(e,r)}function QU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ty(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function mr(e,t){var r=JU(e,t,"get");return cAe(e,r)}function cAe(e,t){return t.get?t.get.call(e):t.value}function kl(e,t,r){var n=JU(e,t,"set");return hAe(e,n,r),r}function JU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Jo=new WeakMap,cS=new WeakMap,oc=new WeakMap,WO=new WeakMap,UO=new WeakMap,ic=new WeakMap,Py=new WeakSet,YD=new WeakSet,dAe=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;lAe(this,e),zD(this,YD),zD(this,Py),Pl(this,Jo,{writable:!0,value:void 0}),Pl(this,cS,{writable:!0,value:void 0}),Pl(this,oc,{writable:!0,value:void 0}),Pl(this,WO,{writable:!0,value:void 0}),Pl(this,UO,{writable:!0,value:void 0}),Pl(this,ic,{writable:!0,value:void 0}),kl(this,cS,r),kl(this,oc,n),kl(this,WO,o),kl(this,UO,i),kl(this,ic,a)}return sAe(e,[{key:"setSelectedRange",value:function(r){kl(this,Jo,r)}},{key:"getCellsRange",value:function(){if(mr(this,cS).call(this)===0||mr(this,oc).call(this)===0)return null;var r=mr(this,Jo).getTopStartCorner(),n=r.row,o=r.col,i=mr(this,Jo).getBottomEndCorner(),a=i.row,l=i.col,s=Ty(this,YD,vAe).call(this,n,a),u=Ty(this,Py,hS).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(mr(this,oc).call(this)===0||mr(this,ic).call(this)===0)return null;var r=mr(this,Jo).getTopStartCorner(),n=r.col,o=mr(this,Jo).getBottomEndCorner(),i=o.col,a=Ty(this,Py,hS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(mr(this,oc).call(this)===0||mr(this,ic).call(this)===0)return null;var r=mr(this,Jo).getTopStartCorner(),n=r.col,o=mr(this,Jo).getBottomEndCorner(),i=o.col,a=Ty(this,Py,hS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-mr(this,ic).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function hS(e,t){return Math.min(t,Math.max(e+mr(this,UO).call(this)-1,e))}function vAe(e,t){return Math.min(t,Math.max(e+mr(this,WO).call(this)-1,e))}function ez(e){var t=[],r=[];return A(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Ce(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);Ce(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function yAe(e,t){return bAe(e)||mAe(e,t)||pAe(e,t)||gAe()}function gAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pAe(e,t){if(e){if(typeof e=="string")return GD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GD(e,t)}}function GD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bAe(e){if(Array.isArray(e))return e}function Za(e){"@babel/helpers - typeof";return Za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Za(e)}function wAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rz(n.key),n)}}function SAe(e,t,r){return t&&KD(e.prototype,t),r&&KD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=CAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function CAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function _Ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function OAe(e){var t=EAe();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return RAe(this,o)}}function RAe(e,t){if(t&&(Za(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pr(e)}function pr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}function TAe(e,t){tz(e,t),t.add(e)}function Xi(e,t,r){tz(e,t),t.set(e,r)}function tz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $l(e,t,r){return t=rz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rz(e){var t=PAe(e,"string");return Za(t)==="symbol"?t:String(t)}function PAe(e,t){if(Za(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Za(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kAe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Dr(e,t){var r=nz(e,t,"get");return $Ae(e,r)}function $Ae(e,t){return t.get?t.get.call(e):t.value}function Qn(e,t,r){var n=nz(e,t,"set");return AAe(e,n,r),r}function nz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function AAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");var ky="copyPaste",IAe=80,MAe=["fragmentSelection"],qD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),dS=new WeakMap,vS=new WeakMap,yS=new WeakMap,Al=new WeakMap,$y=new WeakMap,Ay=new WeakMap,Il=new WeakMap,XD=new WeakSet,xAe=function(e){_Ae(r,e);var t=OAe(r);function r(){var n;wAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),TAe(pr(n),XD),$l(pr(n),"columnsLimit",1/0),$l(pr(n),"rowsLimit",1/0),$l(pr(n),"pasteMode","overwrite"),$l(pr(n),"uiContainer",n.hot.rootDocument.body),Xi(pr(n),dS,{writable:!0,value:!1}),Xi(pr(n),vS,{writable:!0,value:!1}),Xi(pr(n),yS,{writable:!0,value:!1}),Xi(pr(n),Al,{writable:!0,value:"cells-only"}),Xi(pr(n),$y,{writable:!0,value:!1}),Xi(pr(n),Ay,{writable:!0,value:!1}),Xi(pr(n),Il,{writable:!0,value:new dAe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),$l(pr(n),"copyableRanges",[]),$l(pr(n),"focusableElement",void 0),n}return SAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ky]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[ky];if(Za(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Qn(this,dS,!!a.copyColumnHeaders),Qn(this,vS,!!a.copyColumnGroupHeaders),Qn(this,yS,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=oAe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),pa(wo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),pa(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&WD(this.focusableElement),pa(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Qn(this,Al,o),Qn(this,$y,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Qn(this,Ay,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return Hc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=ez(o),s=l.rows,u=l.columns;return A(s,function(f){var c=[];A(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new J1e;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){Dr(this,Il).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);Dr(this,Al)==="column-headers-only"?i.set("headers",Dr(this,Il).getMostBottomColumnHeadersRange()):(Dr(this,Al)==="with-column-headers"?i.set("headers",Dr(this,Il).getMostBottomColumnHeadersRange()):Dr(this,Al)==="with-column-group-headers"&&i.set("headers",Dr(this,Il).getAllColumnHeadersRange()),i.set("cells",Dr(this,Il).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,y=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,y=f,m=c,w=f,S=c;s.length<a||y<=d;){var C=this.hot.getCellMeta(y,c),k=C.skipRowOnPaste,O=C.visualRow;if(y=O+1,k!==!0){w=O,m=c;for(var W=[],Y=s.length%a;W.length<l||m<=v;){var q=this.hot.getCellMeta(f,m),G=q.skipColumnOnPaste,X=q.visualCol;if(m=X+1,G!==!0){S=X;var Q=W.length%l;W.push(o[Y][Q])}}s.push(W)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,$y)||this.isEditorOpened())){this.setCopyableText(),Qn(this,$y,!1);var i=this.getRangedData(this.copyableRanges),a=kAe(this,XD,DAe).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=Hc(i);if(o&&o.clipboardData){var u=EO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[qD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Qn(this,Al,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,Ay)||this.isEditorOpened())){this.setCopyableText(),Qn(this,Ay,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=Hc(i);if(o&&o.clipboardData){var s=EO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[qD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=Fm(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=gU(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=Xke(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=yAe(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},j1e(this)),Dr(this,dS)&&o.items.push(V1e(this)),Dr(this,vS)&&o.items.push(B1e(this)),Dr(this,yS)&&o.items.push(F1e(this)),o.items.push(W1e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&tW())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(WD(this.focusableElement),this.focusableElement=null),pa(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ky}},{key:"SETTING_KEYS",get:function(){return[ky].concat(MAe)}},{key:"PLUGIN_PRIORITY",get:function(){return IAe}}]),r}(ot);function DAe(e){for(var t=ez(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function oz(e,t){return"border_row".concat(e,"col").concat(t)}function wc(){return{width:1,color:"#000"}}function So(){return{hide:!0}}function NAe(){return{width:1,color:"#000",cornerVisible:!1}}function gS(e){if(ve(e.start)||ve(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ve(e.end)||ve(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function ac(e){return ve(e.start)&&(e.left=e.start),ve(e.end)&&(e.right=e.end),e}function pS(e,t){return{id:oz(e,t),border:NAe(),row:e,col:t,top:So(),bottom:So(),start:So(),end:So()}}function HAe(e,t){return Mt(t,"border")&&t.border&&(e.border=t.border),Mt(t,"top")&&ve(t.top)&&(t.top?(Ue(t.top)||(t.top=wc()),e.top=t.top):(t.top=So(),e.top=t.top)),Mt(t,"bottom")&&ve(t.bottom)&&(t.bottom?(Ue(t.bottom)||(t.bottom=wc()),e.bottom=t.bottom):(t.bottom=So(),e.bottom=t.bottom)),Mt(t,"start")&&ve(t.start)&&(t.start?(Ue(t.start)||(t.start=wc()),e.start=t.start):(t.start=So(),e.start=t.start)),Mt(t,"end")&&ve(t.end)&&(t.end?(Ue(t.end)||(t.end=wc()),e.end=t.end):(t.end=So(),e.end=t.end)),e}function Vo(e,t){var r=!1;return A(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!Mt(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function fb(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function LAe(e){return e.some(function(t){return ve(t.left)||ve(t.right)})}function jAe(e){return e.some(function(t){return ve(t.start)||ve(t.end)})}var FAe=new Map([["left","start"],["right","end"]]);function BAe(e){var t;return(t=FAe.get(e))!==null&&t!==void 0?t:e}function VAe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(nP),n=Vo(this,"bottom");return n&&(r=fb(r)),r},callback:function(r,n){var o=Vo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function WAe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(oP),o=Vo(this,t);return o&&(n=fb(n)),n},callback:function(n,o){var i=Vo(this,t);e.prepareBorder(o,t,i)}}}function UAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(iP)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Vo(this)}}}function zAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(rP),o=Vo(this,t);return o&&(n=fb(n)),n},callback:function(n,o){var i=Vo(this,t);e.prepareBorder(o,t,i)}}}function YAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(tP),n=Vo(this,"top");return n&&(r=fb(r)),r},callback:function(r,n){var o=Vo(this,"top");e.prepareBorder(n,"top",o)}}}function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function ZD(e,t){return XAe(e)||qAe(e,t)||KAe(e,t)||GAe()}function GAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KAe(e,t){if(e){if(typeof e=="string")return QD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QD(e,t)}}function QD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XAe(e){if(Array.isArray(e))return e}function ZAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,az(n.key),n)}}function QAe(e,t,r){return t&&JD(e.prototype,t),r&&JD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=JAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function JAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function eIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YO(e,t)}function tIe(e){var t=nIe();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rIe(this,o)}}function rIe(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iz(e)}function iz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}function oIe(e,t,r){return t=az(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function az(e){var t=iIe(e,"string");return _u(t)==="symbol"?t:String(t)}function iIe(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iy="customBorders",aIe=90,lIe=function(e){eIe(r,e);var t=tIe(r);function r(){var n;ZAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),oIe(iz(n),"savedBorders",[]),n}return QAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Iy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),ma(Co(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),ma(Co(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),ma(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=gS(i));var u=mu(o),f=Fh(u);A(o,function(c){for(var h=f(c),d=ZD(h,4),v=d[0],y=d[1],m=d[2],w=d[3],S=function(O){for(var W=function(G){A(l,function(X){a.prepareBorderFromCustomAdded(O,G,s,BAe(X))})},Y=y;Y<=w;Y+=1)W(Y)},C=v;C<=m;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=mu(o),l=Fh(a),s=[];return A(o,function(u){for(var f=l(u),c=ZD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=function(C){for(var k=function(Y){A(i.savedBorders,function(q){q.row===C&&q.col===Y&&s.push(ac(q))})},O=d;O<=y;O+=1)k(O)},w=h;w<=v;w+=1)m(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(A(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=pS(o,i);a&&(f=HAe(f,a),A(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",ac(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);Ce(o.from.row,l,function(u){Ce(o.from.col,s,function(f){var c=pS(u,f),h=0;u===o.from.row&&Mt(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&Mt(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&Mt(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&Mt(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",ac(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=oz(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=pS(o,i):s=gS(s),l){s[a]=So();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",ac(s))}}else{s[a]=wc();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",ac(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;A(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Ce(u.col,f.col,function(c){Ce(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":Ce(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":Ce(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":Ce(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":Ce(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;A(o,function(a){var l=gS(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return jt(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=We(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;A(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;A(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=We(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):A(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return A(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return ze(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):A(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&ze(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[Iy];if(Array.isArray(o)){var i=fr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=LAe(o),a=jAe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[Iy]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(eP)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[YAe(this),zAe(this),VAe(this),WAe(this),UAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){ma(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Iy}},{key:"PLUGIN_PRIORITY",get:function(){return aIe}}]),r}(ot);function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function sIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fIe(n.key),n)}}function uIe(e,t,r){return t&&eN(e.prototype,t),r&&eN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fIe(e){var t=cIe(e,"string");return Ou(t)==="symbol"?t:String(t)}function cIe(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=hIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function hIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function dIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function vIe(e){var t=gIe();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yIe(this,o)}}function yIe(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lz(e)}function lz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}var tN="dragToScroll",pIe=100,mIe=function(e){dIe(r,e);var t=vIe(r);function r(n){var o;return sIe(this,r),o=t.call(this,n),o.eventManager=new Pt(lz(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return uIe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),ba(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),ba(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Kc(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!ki(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){ba(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tN}},{key:"PLUGIN_PRIORITY",get:function(){return pIe}}]),r}(ot);function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function bIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SIe(n.key),n)}}function wIe(e,t,r){return t&&rN(e.prototype,t),r&&rN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SIe(e){var t=CIe(e,"string");return Ru(t)==="symbol"?t:String(t)}function CIe(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=_Ie(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function _Ie(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function OIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KO(e,t)}function RIe(e){var t=TIe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return EIe(this,o)}}function EIe(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sz(e)}function sz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");var mS="dropdownMenu",PIe=230,bS="changeType",uz=function(e){OIe(r,e);var t=RIe(r);function r(n){var o;return bIe(this,r),o=t.call(this,n),o.eventManager=new Pt(sz(o)),o.commandExecutor=new iU(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return wIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[mS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new uU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[mS],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),wa(Oo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new qP(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),wa(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,bS)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(bS));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=bS,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),wa(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return mS}},{key:"PLUGIN_PRIORITY",get:function(){return PIe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[xv,Dv,qe,Hv,qe,Zm,qe,Nv,qe,Xr]}}]),r}(ot);uz.SEPARATOR={name:qe};function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function kIe(e,t){return MIe(e)||IIe(e,t)||AIe(e,t)||$Ie()}function $Ie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AIe(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function MIe(e){if(Array.isArray(e))return e}function xIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NIe(n.key),n)}}function DIe(e,t,r){return t&&oN(e.prototype,t),r&&oN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NIe(e){var t=HIe(e,"string");return wd(t)==="symbol"?t:String(t)}function HIe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LIe=function(){function e(t){xIe(this,e),this.hot=t,this.options={}}return DIe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return Ce(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(Ce(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();Ce(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();Ce(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=kIe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const jIe=LIe;function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function FIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VIe(n.key),n)}}function BIe(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VIe(e){var t=WIe(e,"string");return Sd(t)==="symbol"?t:String(t)}function WIe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UIe=function(){function e(t,r){FIe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return BIe(e,[{key:"_mergeOptions",value:function(r){var n=Sr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=Ut(Sr(e.DEFAULT_OPTIONS),n),n=Ut(n,r),n.filename=AE(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const zIe=UIe;function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function YIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KIe(n.key),n)}}function GIe(e,t,r){return t&&aN(e.prototype,t),r&&aN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KIe(e){var t=qIe(e,"string");return Eu(t)==="symbol"?t:String(t)}function qIe(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qO(e,t)}function ZIe(e){var t=eMe();return function(){var n=Wp(e),o;if(t){var i=Wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return QIe(this,o)}}function QIe(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JIe(e)}function JIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wp(e){return Wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wp(e)}var tMe=String.fromCharCode(13),rMe=String.fromCharCode(34),nMe=String.fromCharCode(10),oMe=function(e){XIe(r,e);var t=ZIe(r);function r(){return YIe(this,r),t.apply(this,arguments)}return GIe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=We(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),A(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=xt(o);return a!==""&&(i||a.indexOf(tMe)>=0||a.indexOf(rMe)>=0||a.indexOf(nMe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(zIe);const iMe=oMe;function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function aMe(e,t,r){return t=lMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lMe(e){var t=sMe(e,"string");return Cd(t)==="symbol"?t:String(t)}function sMe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uMe="csv",XO=aMe({},uMe,iMe);function fMe(e,t,r){return typeof XO[e]=="function"?new XO[e](t,r):null}function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function cMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dMe(n.key),n)}}function hMe(e,t,r){return t&&lN(e.prototype,t),r&&lN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dMe(e){var t=vMe(e,"string");return Tu(t)==="symbol"?t:String(t)}function vMe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function gMe(e){var t=bMe();return function(){var n=Up(e),o;if(t){var i=Up(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pMe(this,o)}}function pMe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mMe(e)}function mMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Up(e){return Up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Up(e)}var wMe="exportFile",SMe=240,CMe=function(e){yMe(r,e);var t=gMe(r);function r(){return cMe(this,r),t.apply(this,arguments)}return hMe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!XO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return fMe(o,new jIe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return wMe}},{key:"PLUGIN_PRIORITY",get:function(){return SMe}}]),r}(ot);function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function _Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RMe(n.key),n)}}function OMe(e,t,r){return t&&sN(e.prototype,t),r&&sN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RMe(e){var t=EMe(e,"string");return _d(t)==="symbol"?t:String(t)}function EMe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fz=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;_Me(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Gm)}return OMe(e,[{key:"reset",value:function(){A(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();gt(fz,Mr);const cb=fz;var Od={};function Ii(e,t){if(!Od[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Od[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function Sa(e){if(!Od[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Od[e].descriptor}function Kt(e,t,r){r.key=e,Od[e]={condition:t,descriptor:r}}var rr="none";function TMe(){return!0}Kt(rr,TMe,{name:qm,inputsCount:0,showOperators:!1});var Lc="empty";function PMe(e){return qt(e.value)}Kt(Lc,PMe,{name:hP,inputsCount:0,showOperators:!0});var Eg="not_empty";function kMe(e,t){return!Ii(Lc,t)(e)}Kt(Eg,kMe,{name:dP,inputsCount:0,showOperators:!0});function $Me(e,t){return xMe(e)||MMe(e,t)||IMe(e,t)||AMe()}function AMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IMe(e,t){if(e){if(typeof e=="string")return uN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uN(e,t)}}function uN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xMe(e){if(Array.isArray(e))return e}var jc="eq";function DMe(e,t){var r=$Me(t,1),n=r[0];return xt(e.value).toLocaleLowerCase(e.meta.locale)===xt(n)}Kt(jc,DMe,{name:vP,inputsCount:1,showOperators:!0});var Tg="neq";function NMe(e,t){return!Ii(jc,t)(e)}Kt(Tg,NMe,{name:yP,inputsCount:1,showOperators:!0});function HMe(e,t){return BMe(e)||FMe(e,t)||jMe(e,t)||LMe()}function LMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jMe(e,t){if(e){if(typeof e=="string")return fN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fN(e,t)}}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function BMe(e){if(Array.isArray(e))return e}var cz="gt";function VMe(e,t){var r=HMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Kt(cz,VMe,{name:wP,inputsCount:1,showOperators:!0});function WMe(e,t){return GMe(e)||YMe(e,t)||zMe(e,t)||UMe()}function UMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zMe(e,t){if(e){if(typeof e=="string")return cN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cN(e,t)}}function cN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function GMe(e){if(Array.isArray(e))return e}var hz="gte";function KMe(e,t){var r=WMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Kt(hz,KMe,{name:SP,inputsCount:1,showOperators:!0});function qMe(e,t){return JMe(e)||QMe(e,t)||ZMe(e,t)||XMe()}function XMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZMe(e,t){if(e){if(typeof e=="string")return hN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hN(e,t)}}function hN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function JMe(e){if(Array.isArray(e))return e}var dz="lt";function exe(e,t){var r=qMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Kt(dz,exe,{name:CP,inputsCount:1,showOperators:!0});function txe(e,t){return ixe(e)||oxe(e,t)||nxe(e,t)||rxe()}function rxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nxe(e,t){if(e){if(typeof e=="string")return dN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dN(e,t)}}function dN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ixe(e){if(Array.isArray(e))return e}var vz="lte";function axe(e,t){var r=txe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Kt(vz,axe,{name:_P,inputsCount:1,showOperators:!0});function lxe(e,t){return cxe(e)||fxe(e,t)||uxe(e,t)||sxe()}function sxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uxe(e,t){if(e){if(typeof e=="string")return vN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vN(e,t)}}function vN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cxe(e){if(Array.isArray(e))return e}var ZP="date_after";function hxe(e,t){var r=lxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Kt(ZP,hxe,{name:EP,inputsCount:1,showOperators:!0});function dxe(e,t){return pxe(e)||gxe(e,t)||yxe(e,t)||vxe()}function vxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yxe(e,t){if(e){if(typeof e=="string")return yN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yN(e,t)}}function yN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function pxe(e){if(Array.isArray(e))return e}var QP="date_before";function mxe(e,t){var r=dxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Kt(QP,mxe,{name:TP,inputsCount:1,showOperators:!0});function bxe(e,t){return _xe(e)||Cxe(e,t)||Sxe(e,t)||wxe()}function wxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sxe(e,t){if(e){if(typeof e=="string")return gN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gN(e,t)}}function gN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _xe(e){if(Array.isArray(e))return e}var zp="between";function Oxe(e,t){var r=bxe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=Ii(QP,[a]),f=Ii(ZP,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}Kt(zp,Oxe,{name:OP,inputsCount:2,showOperators:!0});var yz="not_between";function Rxe(e,t){return!Ii(zp,t)(e)}Kt(yz,Rxe,{name:RP,inputsCount:2,showOperators:!0});function Exe(e,t){return $xe(e)||kxe(e,t)||Pxe(e,t)||Txe()}function Txe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pxe(e,t){if(e){if(typeof e=="string")return pN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pN(e,t)}}function pN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $xe(e){if(Array.isArray(e))return e}var gz="begins_with";function Axe(e,t){var r=Exe(t,1),n=r[0];return xt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(xt(n))}Kt(gz,Axe,{name:gP,inputsCount:1,showOperators:!0});var Ixe=$e,pz=fv,Mxe=Un.f,xxe=tl,mN=Gt,Dxe=mE,Nxe=Ar,Hxe=bE,bN=pz("".endsWith),Lxe=pz("".slice),jxe=Math.min,mz=Hxe("endsWith"),Fxe=!mz&&!!function(){var e=Mxe(String.prototype,"endsWith");return e&&!e.writable}();Ixe({target:"String",proto:!0,forced:!Fxe&&!mz},{endsWith:function(t){var r=mN(Nxe(this));Dxe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:jxe(xxe(n),o),a=mN(t);return bN?bN(r,a,i):Lxe(r,i-a.length,i)===a}});function Bxe(e,t){return zxe(e)||Uxe(e,t)||Wxe(e,t)||Vxe()}function Vxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wxe(e,t){if(e){if(typeof e=="string")return wN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wN(e,t)}}function wN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function zxe(e){if(Array.isArray(e))return e}var bz="ends_with";function Yxe(e,t){var r=Bxe(t,1),n=r[0];return xt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(xt(n))}Kt(bz,Yxe,{name:pP,inputsCount:1,showOperators:!0});function Gxe(e,t){return Zxe(e)||Xxe(e,t)||qxe(e,t)||Kxe()}function Kxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qxe(e,t){if(e){if(typeof e=="string")return SN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SN(e,t)}}function SN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Zxe(e){if(Array.isArray(e))return e}var JP="contains";function Qxe(e,t){var r=Gxe(t,1),n=r[0];return xt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(xt(n))>=0}Kt(JP,Qxe,{name:mP,inputsCount:1,showOperators:!0});var wz="not_contains";function Jxe(e,t){return!Ii(JP,t)(e)}Kt(wz,Jxe,{name:bP,inputsCount:1,showOperators:!0});var Sz="date_tomorrow";function eDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}Kt(Sz,eDe,{name:kP,inputsCount:0});var Cz="date_today";function tDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().startOf("day"),"d"):!1}Kt(Cz,tDe,{name:PP,inputsCount:0});var _z="date_yesterday";function rDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}Kt(_z,rDe,{name:$P,inputsCount:0});YV();function nDe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var QO=new Set([1]).has(1),oDe=QO&&typeof Array.from=="function";function jv(e){var t=e;return QO&&(t=new Set(t)),function(r){var n;return QO?n=t.has(r):n=!!~t.indexOf(r),n}}function Oz(e){return e??""}function JO(e){var t=e;return oDe?t=Array.from(new Set(t)):t=SE(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function CN(e,t,r,n){var o=[],i=e===t,a;return i||(a=jv(t)),A(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:nDe(l,r)};n&&n(u),o.push(u)}),o}function Rz(e,t){return sDe(e)||lDe(e,t)||aDe(e,t)||iDe()}function iDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aDe(e,t){if(e){if(typeof e=="string")return _N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _N(e,t)}}function _N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function sDe(e){if(Array.isArray(e))return e}var Ca="by_value";function uDe(e,t){var r=Rz(t,1),n=r[0];return n(e.value)}Kt(Ca,uDe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=Rz(t,1),n=r[0];return[jv(n)]},showOperators:!1});var Rd={};function fDe(e){if(!Rd[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Rd[e].func;return function(r,n){return t(r,n)}}function cDe(e){return Rd[e].name}function ek(e,t,r){Rd[e]={name:t,func:r}}var Si="conjunction",hDe=MP;function dDe(e,t){return e.every(function(r){return r.func(t)})}ek(Si,hDe,dDe);var Yp="disjunction",vDe=Xm;function yDe(e,t){return e.some(function(r){return r.func(t)})}ek(Yp,vDe,yDe);var tk="disjunctionWithExtraCondition",gDe=Xm;function pDe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}ek(tk,gDe,pDe);function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}var lc;function wS(e,t,r){return t=mDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mDe(e){var t=bDe(e,"string");return Ed(t)==="symbol"?t:String(t)}function bDe(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wDe="numeric",Ez="text",SDe="date",ON=(lc={},wS(lc,wDe,[rr,qe,Lc,Eg,qe,jc,Tg,qe,cz,hz,dz,vz,zp,yz]),wS(lc,Ez,[rr,qe,Lc,Eg,qe,jc,Tg,qe,gz,bz,qe,JP,wz]),wS(lc,SDe,[rr,qe,Lc,Eg,qe,jc,Tg,qe,QP,ZP,zp,qe,Sz,Cz,_z]),lc);function CDe(e){var t=[],r=e;return ON[r]||(r=Ez),A(ON[r],function(n){var o;n===qe?o={name:qe}:o=Sr(Sa(n)),t.push(o)}),t}function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}function _De(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RDe(n.key),n)}}function ODe(e,t,r){return t&&RN(e.prototype,t),r&&RN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RDe(e){var t=EDe(e,"string");return Td(t)==="symbol"?t:String(t)}function EDe(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SS="built",CS="building",EN=["click","input","keydown","keypress","keyup","focus","blur","change"],Tz=function(){function e(t,r){_De(this,e),this.hot=t,this.eventManager=new Pt(this),this.options=Ut(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return ODe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===CS?this._element:this.buildState===SS?(this.update(),this._element):(this.buildState=CS,this.build(),this.buildState=SS,this._element)}},{key:"isBuilt",value:function(){return this.buildState===SS}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Or)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=CS),this.options.className&&te(this._element,this.options.className),this.options.children.length)A(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);ze(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),A(EN,function(i){return n(o,i)})}else A(EN,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Sr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();gt(Tz,Mr);const Ci=Tz;function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function TDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kDe(n.key),n)}}function PDe(e,t,r){return t&&TN(e.prototype,t),r&&TN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kDe(e){var t=$De(e,"string");return Pu(t)==="symbol"?t:String(t)}function $De(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pg(){return typeof Reflect<"u"&&Reflect.get?Pg=Reflect.get.bind():Pg=function(t,r,n){var o=ADe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pg.apply(this,arguments)}function ADe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ku(e),e!==null););return e}function IDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eR(e,t)}function eR(e,t){return eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eR(e,t)}function MDe(e){var t=DDe();return function(){var n=ku(e),o;if(t){var i=ku(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xDe(this,o)}}function xDe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pz(e)}function Pz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ku(e){return ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ku(e)}var My=new WeakMap,NDe=function(e){IDe(r,e);var t=MDe(r);function r(n,o){var i;return TDe(this,r),i=t.call(this,n,Ut(r.DEFAULTS,o)),My.set(Pz(i),{}),i.registerHooks(),i}return PDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){Pg(ku(r.prototype),"build",this).call(this);var o=My.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,te(this._element,"htUIInput"),te(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=My.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&My.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return Sr({placeholder:"",type:"text",tagName:"input"})}}]),r}(Ci);const os=NDe;function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function HDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jDe(n.key),n)}}function LDe(e,t,r){return t&&PN(e.prototype,t),r&&PN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jDe(e){var t=FDe(e,"string");return $u(t)==="symbol"?t:String(t)}function FDe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function is(){return typeof Reflect<"u"&&Reflect.get?is=Reflect.get.bind():is=function(t,r,n){var o=BDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},is.apply(this,arguments)}function BDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_i(e),e!==null););return e}function VDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function WDe(e){var t=zDe();return function(){var n=_i(e),o;if(t){var i=_i(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return UDe(this,o)}}function UDe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kz(e)}function kz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _i(e){return _i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_i(e)}var xy=new WeakMap,YDe=function(e){VDe(r,e);var t=WDe(r);function r(n,o){var i;return HDe(this,r),i=t.call(this,n,Ut(r.DEFAULTS,o)),xy.set(kz(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return LDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return A(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;is(_i(r.prototype),"build",this).call(this),this.menu=new qP(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new Ci(this.hot,{className:"htUISelectCaption"}),a=new Ci(this.hot,{className:"htUISelectDropdown"}),l=xy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,A([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(qm),xy.get(this).captionElement.textContent=o,is(_i(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==qe&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=xy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),is(_i(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUISelect",wrapIt:!1})}}]),r}(Ci);const kN=YDe;function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function GDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qDe(n.key),n)}}function KDe(e,t,r){return t&&$N(e.prototype,t),r&&$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qDe(e){var t=XDe(e,"string");return Au(t)==="symbol"?t:String(t)}function XDe(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kg(){return typeof Reflect<"u"&&Reflect.get?kg=Reflect.get.bind():kg=function(t,r,n){var o=ZDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},kg.apply(this,arguments)}function ZDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Iu(e),e!==null););return e}function QDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rR(e,t)}function JDe(e){var t=rNe();return function(){var n=Iu(e),o;if(t){var i=Iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eNe(this,o)}}function eNe(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tNe(e)}function tNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(e){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iu(e)}var nNe=function(e){QDe(r,e);var t=JDe(r);function r(n,o){var i;return GDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new kN(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new os(i.hot,{placeholder:jP})),i.elements.push(new os(i.hot,{placeholder:FP})),i.registerHooks(),i}return KDe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),A(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=Sr(o.command);a.name.startsWith(Nt)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),A(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||Sa(rr),i=[];return A(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=Sa(o?o.name:rr);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||A(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof kN})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof os})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&te(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[Sa(rr)];if(o!==null){var a=o.visualIndex;i=CDe(this.hot.getDataType(0,a,this.hot.countRows(),a))}A(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),kg(Iu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){A(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){ys(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),bn(o)):ys(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),bn(o))}}]),r}(cb);const _S=nNe;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function oNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aNe(n.key),n)}}function iNe(e,t,r){return t&&AN(e.prototype,t),r&&AN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aNe(e){var t=lNe(e,"string");return Mu(t)==="symbol"?t:String(t)}function lNe(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $g(){return typeof Reflect<"u"&&Reflect.get?$g=Reflect.get.bind():$g=function(t,r,n){var o=sNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$g.apply(this,arguments)}function sNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function uNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nR(e,t)}function fNe(e){var t=hNe();return function(){var n=xu(e),o;if(t){var i=xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cNe(this,o)}}function cNe(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $z(e)}function $z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}var Dy=new WeakMap,dNe=function(e){uNe(r,e);var t=fNe(r);function r(n,o){var i;return oNe(this,r),i=t.call(this,n,Ut(r.DEFAULTS,o)),Dy.set($z(i),{}),i}return iNe(r,[{key:"build",value:function(){$g(xu(r.prototype),"build",this).call(this);var o=Dy.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Dy.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Dy.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Sr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(Ci);const IN=dNe;function Du(e){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}var MN;function vNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function yNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pNe(n.key),n)}}function gNe(e,t,r){return t&&xN(e.prototype,t),r&&xN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pNe(e){var t=mNe(e,"string");return Du(t)==="symbol"?t:String(t)}function mNe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function wNe(e){var t=_Ne();return function(){var n=Gp(e),o;if(t){var i=Gp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SNe(this,o)}}function SNe(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CNe(e)}function CNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gp(e){return Gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gp(e)}var DN=0,ONe=function(e){bNe(r,e);var t=wNe(r);function r(n,o){var i;return yNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return gNe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[Si,Yp];A(i,function(a){var l=new IN(o.hot,{name:"operator",label:{htmlFor:a,textContent:cDe(a)},value:a,checked:a===i[DN],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(dt(MN||(MN=vNe(["Radio button with index "," doesn't exist."])),o));A(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof IN&&i.isChecked()});return o?o.getValue():Si}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&A(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Si,i=arguments.length>1?arguments[1]:void 0,a=o;a===tk&&(a=Yp),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(DN)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(cb);const RNe=ONe;var ENe=Ye,TNe=Ar,NN=Gt,PNe=/"/g,kNe=ENe("".replace),$Ne=function(e,t,r,n){var o=NN(TNe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+kNe(NN(n),PNe,"&quot;")+'"'),i+">"+o+"</"+t+">"},ANe=je,INe=function(e){return ANe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},MNe=$e,xNe=$Ne,DNe=INe;MNe({target:"String",proto:!0,forced:DNe("link")},{link:function(t){return xNe(this,"a","href",t)}});function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function NNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LNe(n.key),n)}}function HNe(e,t,r){return t&&HN(e.prototype,t),r&&HN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LNe(e){var t=jNe(e,"string");return Nu(t)==="symbol"?t:String(t)}function jNe(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ag(){return typeof Reflect<"u"&&Reflect.get?Ag=Reflect.get.bind():Ag=function(t,r,n){var o=FNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ag.apply(this,arguments)}function FNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hu(e),e!==null););return e}function BNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iR(e,t)}function iR(e,t){return iR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iR(e,t)}function VNe(e){var t=UNe();return function(){var n=Hu(e),o;if(t){var i=Hu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WNe(this,o)}}function WNe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Az(e)}function Az(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hu(e){return Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hu(e)}var OS=new WeakMap,zNe=function(e){BNe(r,e);var t=VNe(r);function r(n,o){var i;return NNe(this,r),i=t.call(this,n,Ut(r.DEFAULTS,o)),OS.set(Az(i),{}),i}return HNe(r,[{key:"build",value:function(){Ag(Hu(r.prototype),"build",this).call(this);var o=OS.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(OS.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Sr({href:"#",tagName:"a"})}}]),r}(Ci);const LN=zNe;function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function jN(e){return qNe(e)||KNe(e)||GNe(e)||YNe()}function YNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GNe(e,t){if(e){if(typeof e=="string")return aR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aR(e,t)}}function KNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qNe(e){if(Array.isArray(e))return aR(e)}function aR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QNe(n.key),n)}}function ZNe(e,t,r){return t&&FN(e.prototype,t),r&&FN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QNe(e){var t=JNe(e,"string");return Lu(t)==="symbol"?t:String(t)}function JNe(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function as(){return typeof Reflect<"u"&&Reflect.get?as=Reflect.get.bind():as=function(t,r,n){var o=eHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},as.apply(this,arguments)}function eHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oi(e),e!==null););return e}function tHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lR(e,t)}function rHe(e){var t=oHe();return function(){var n=Oi(e),o;if(t){var i=Oi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nHe(this,o)}}function nHe(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iz(e)}function Iz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oi(e){return Oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oi(e)}var iHe=new WeakMap,aHe="multipleSelect.itemBox",lHe=function(e){tHe(r,e);var t=rHe(r);function r(n,o){var i;return XNe(this,r),i=t.call(this,n,Ut(r.DEFAULTS,o)),iHe.set(Iz(i),{}),i.searchInput=new os(i.hot,{placeholder:LP,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new LN(i.hot,{textContent:xP,className:"htUISelectAll"}),i.clearAllUI=new LN(i.hot,{textContent:DP,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return ZNe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return jN(this.items)}},{key:"getValue",value:function(){return uHe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;as(Oi(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new Ci(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),te(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,y,m,w,S,C){v.title=C.instance.getDataAtRowProp(y,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Jt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:aHe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(sHe(this.items,this.options.value)),as(Oi(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,as(Oi(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=jN(this.items):l=Wr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=LE(ys,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(bn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(AO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(AO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUIMultipleSelect",value:[]})}}]),r}(Ci);const BN=lHe;function sHe(e,t){var r=jv(t);return We(e,function(n){return n.checked=r(n.value),n})}function uHe(e){var t=[];return A(e,function(r){r.checked&&t.push(r.value)}),t}function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function fHe(e,t){return vHe(e)||dHe(e,t)||hHe(e,t)||cHe()}function cHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hHe(e,t){if(e){if(typeof e=="string")return VN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VN(e,t)}}function VN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function vHe(e){if(Array.isArray(e))return e}function yHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pHe(n.key),n)}}function gHe(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pHe(e){var t=mHe(e,"string");return ju(t)==="symbol"?t:String(t)}function mHe(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ig(){return typeof Reflect<"u"&&Reflect.get?Ig=Reflect.get.bind():Ig=function(t,r,n){var o=bHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ig.apply(this,arguments)}function bHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fu(e),e!==null););return e}function wHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function SHe(e){var t=OHe();return function(){var n=Fu(e),o;if(t){var i=Fu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CHe(this,o)}}function CHe(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _He(e)}function _He(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fu(e){return Fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fu(e)}var RHe=function(e){wHe(r,e);var t=SHe(r);function r(n,o){var i;return yHe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new BN(i.hot)),i.registerHooks(),i}return gHe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===Ca){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?rr:Ca},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Wr(u,function(W){return W.name===Ca}),v=fHe(d,1),y=v[0],m={},w=i.hot.getTranslatedPhrase(jp);if(y){var S=JO(We(c(s,h),function(W){return W.value}));f&&(y.args[0]=f);var C=[],k=CN(S,y.args[0],w,function(W){W.checked&&C.push(W.value)}),O=o.editedConditionStack.column;m.locale=i.hot.getCellMeta(0,O).locale,m.args=[C],m.command=Sa(Ca),m.itemsSnapshot=k}else m.args=[],m.command=Sa(rr);i.state.setValueAtIndex(s,m)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof BN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(jp),i=JO(this._getColumnVisibleValues()),a=CN(i,i,o);this.getMultipleSelectElement().setItems(a),Ig(Fu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){ys(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),bn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:We(this.hot.getDataAtCol(o.visualIndex),function(i){return Oz(i)})}}]),r}(cb);const EHe=RHe;function Bu(e){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}function THe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kHe(n.key),n)}}function PHe(e,t,r){return t&&UN(e.prototype,t),r&&UN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kHe(e){var t=$He(e,"string");return Bu(t)==="symbol"?t:String(t)}function $He(e,t){if(Bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function IHe(e){var t=DHe();return function(){var n=Kp(e),o;if(t){var i=Kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MHe(this,o)}}function MHe(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xHe(e)}function xHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kp(e){return Kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kp(e)}var NHe=function(e){AHe(r,e);var t=IHe(r);function r(n,o){var i;return THe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new os(i.hot,{type:"button",value:NP,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new os(i.hot,{type:"button",value:HP,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return PHe(r,[{key:"registerHooks",value:function(){var o=this;A(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(cb);const HHe=NHe;function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}var zN,YN;function GN(e,t){return BHe(e)||FHe(e,t)||jHe(e,t)||LHe()}function LHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jHe(e,t){if(e){if(typeof e=="string")return KN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KN(e,t)}}function KN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function BHe(e){if(Array.isArray(e))return e}function qN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function VHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UHe(n.key),n)}}function WHe(e,t,r){return t&&XN(e.prototype,t),r&&XN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UHe(e){var t=zHe(e,"string");return Pd(t)==="symbol"?t:String(t)}function zHe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZN="ConditionCollection.filteringStates",Mz=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;VHe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Gm,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(ZN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return WHe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Si;return r.length?fDe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Si,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=We(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(dt(zN||(zN=qN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(mt(Rd[o]))throw new Error(dt(YN||(YN=qN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:Ii(s,l)}]},i):f.push({name:s,args:l,func:Ii(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=GN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return jt(this.filteringStates.getEntries(),function(r,n){var o=GN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:We(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),A(r,function(o){A(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(ZN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();gt(Mz,Mr);const xz=Mz;function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function YHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KHe(n.key),n)}}function GHe(e,t,r){return t&&QN(e.prototype,t),r&&QN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KHe(e){var t=qHe(e,"string");return kd(t)==="symbol"?t:String(t)}function qHe(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XHe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};YHe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return GHe(e,[{key:"filter",value:function(){var r=this,n=[];return A(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return A(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return A(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const Dz=XHe;function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function ZHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JHe(n.key),n)}}function QHe(e,t,r){return t&&JN(e.prototype,t),r&&JN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JHe(e){var t=eLe(e,"string");return $d(t)==="symbol"?t:String(t)}function eLe(e,t){if($d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nz=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};ZHe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return QHe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,A(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=cW(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new xz(o.hot,!1),y=[].concat(c,d);v.importAllConditions(y);var m=o.columnDataFactory(h),w;v.isEmpty()?w=m:w=new Dz(v,function(C){return o.columnDataFactory(C)}).filter(),w=We(w,function(C){return C.meta.visualRow});var S=jv(w);return v.destroy(),Wr(m,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;A(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),ze(this,function(n,o){r[o]=null})}}]),e}();gt(Nz,Mr);const tLe=Nz;function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}var eH;function rLe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function nLe(e,t){return lLe(e)||aLe(e,t)||iLe(e,t)||oLe()}function oLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iLe(e,t){if(e){if(typeof e=="string")return tH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tH(e,t)}}function tH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lLe(e){if(Array.isArray(e))return e}function sLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fLe(n.key),n)}}function uLe(e,t,r){return t&&rH(e.prototype,t),r&&rH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fLe(e){var t=cLe(e,"string");return Vu(t)==="symbol"?t:String(t)}function cLe(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ls(){return typeof Reflect<"u"&&Reflect.get?ls=Reflect.get.bind():ls=function(t,r,n){var o=hLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ls.apply(this,arguments)}function hLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ri(e),e!==null););return e}function dLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fR(e,t)}function fR(e,t){return fR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fR(e,t)}function vLe(e){var t=gLe();return function(){var n=Ri(e),o;if(t){var i=Ri(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yLe(this,o)}}function yLe(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hz(e)}function Hz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ri(e){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ri(e)}var nH="filters",pLe=250,mLe=function(e){dLe(r,e);var t=vLe(r);function r(n){var o;return sLe(this,r),o=t.call(this,n),o.eventManager=new Pt(Hz(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return uLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Mv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(AP),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(IP),":")};if(!this.components.get("filter_by_condition")){var f=new _S(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new RNe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new _S(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new EHe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new HHe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new xz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new tLe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),ls(Ri(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}ls(Ri(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Si,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=We(i.filter(),function(h){return h.meta.visualRow});var c=jv(l);Ce(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),A(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return A(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,y=c.visualRow,m=c.type,w=c.instance,S=c.dateFormat,C=c.locale,k=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:y,type:m,instance:w,dateFormat:S,locale:C},value:Oz(k)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&A(o,function(a){var l=nLe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=JO(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:qe}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Yp&&i.command.key!==rr&&a.command.key!==rr&&l.command.key!==rr?s=tk:l.command.key!==rr&&(i.command.key===rr||a.command.key===rr)&&(s=Si),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==rr&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==rr&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==rr&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===_S&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?te(i,"htFiltersActive"):Le(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Dz(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===Ca}),f=l.filter(function(h){return h.name!==Ca});if(u.length>=2||f.length>=3)bt(dt(eH||(eH=rLe([`The filter conditions have been applied properly, but couldnât be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnât be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return A(l,function(u){A(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),ls(Ri(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nH}},{key:"PLUGIN_PRIORITY",get:function(){return pLe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ot);function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function oH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Fc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oH(Object(r),!0).forEach(function(n){bLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bLe(e,t,r){return t=wLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wLe(e){var t=SLe(e,"string");return Ad(t)==="symbol"?t:String(t)}function SLe(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lz="internal-use-in-handsontable",cR={licenseKey:Lz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function jz(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[ar])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Fz(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function CLe(e){var t,r=e[ar],n=Fz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=jz(e);return Fc(Fc(Fc({},cR),n),o)}function _Le(e){var t,r=e[ar],n=Fz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=jz(e);return Fc(Fc({},n),o)}function OLe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var iH;function RLe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hR(e){"@babel/helpers - typeof";return hR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hR(e)}function hb(){var e="engine_relationship",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function rk(){var e="shared_engine_usage",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function ELe(e){var t=e.getSettings(),r=t[ar],n=r==null?void 0:r.engine;if(r===!0||mt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return TLe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(hR(n)==="object"&&mt(n.hyperformula)){var i=hb(),a=rk().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Lz}),(n.getConfig().leapYear1900!==cR.leapYear1900||Nm(n.getConfig().nullDate,cR.nullDate)===!1)&&bt(dt(iH||(iH=RLe(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function TLe(e,t,r){var n=t[ar],o=CLe(t),i=hb(),a=rk();PLe(e,n.functions),kLe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),$Le(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function aH(e){var t,r=hb(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function lH(e,t){if(e){var r=hb(),n=r.get(e),o=rk(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function PLe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){bt(a.message)}})}function kLe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){bt(n.message)}}}function $Le(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){bt(l.message)}}),e.resumeEvaluation())}function ALe(e,t){return(mt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var Bz="DD/MM/YYYY";function Vz(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function ILe(e){return Vz(e)?e.substr(1):e}function MLe(e){return typeof e=="string"&&e.startsWith("=")}function RS(e,t){return typeof e=="string"&&t==="date"}function sH(e,t){return ee(e,t,!0).isValid()}function uH(e,t){return ee(e,t,!0).format(Bz)}function xLe(e,t){return ee(e,Bz,!0).format(t)}function fH(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return ee(n).format(t)}function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function DLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HLe(n.key),n)}}function NLe(e,t,r){return t&&cH(e.prototype,t),r&&cH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HLe(e){var t=LLe(e,"string");return Id(t)==="symbol"?t:String(t)}function LLe(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zi(e,t,r){jLe(e,t),t.set(e,r)}function jLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(e,t){var r=Wz(e,t,"get");return FLe(e,r)}function FLe(e,t){return t.get?t.get.call(e):t.value}function ei(e,t,r){var n=Wz(e,t,"set");return BLe(e,n,r),r}function Wz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function BLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var sc=new WeakMap,ti=new WeakMap,Nr=new WeakMap,Ny=new WeakMap,ES=new WeakMap,TS=new WeakMap,Hy=new WeakMap,VLe=function(){function e(t,r,n){DLe(this,e),Zi(this,sc,{writable:!0,value:void 0}),Zi(this,ti,{writable:!0,value:void 0}),Zi(this,Nr,{writable:!0,value:void 0}),Zi(this,Ny,{writable:!0,value:[]}),Zi(this,ES,{writable:!0,value:[]}),Zi(this,TS,{writable:!0,value:void 0}),Zi(this,Hy,{writable:!0,value:[]}),ei(this,sc,t),ei(this,ti,r),ei(this,Nr,n)}return NLe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return ei(this,Hy,r.map(function(o){var i=Ct(n,ti).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),Ct(this,Hy)}},{key:"getRemovedHfIndexes",value:function(){return Ct(this,Hy)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=Ct(this,ti).getIndexesSequence(),o=Ct(this,ti).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(ur(Ct(this,sc)),"s");Ct(this,Nr).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&Ct(n,Nr).getEngine()[i](Ct(n,Nr).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(ei(this,ES,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),ei(this,TS,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=Ct(this,ti).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!Ct(this,Nr).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Ct(this,ES),Ct(this,TS)));Ct(this,Nr).getSheetId()===null?Ct(this,Nr).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(ur(Ct(this,sc)),"Order");return function(o){if(!Ct(r,Nr).isPerformingUndoRedo()){var i=Ct(r,ti).getIndexesSequence();if(o==="update"){var a=Ct(r,Ny).map(function(c){return i.indexOf(c)}),l=Ct(r,Nr).getEngine().getSheetDimensions(Ct(r,Nr).getSheetId()),s;Ct(r,sc)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);Ct(r,Nr).getEngine()[n](Ct(r,Nr).getSheetId(),a)}ei(r,Ny,i)}}}},{key:"init",value:function(){ei(this,Ny,Ct(this,ti).getIndexesSequence())}}]),e}();const hH=VLe;function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function WLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zLe(n.key),n)}}function ULe(e,t,r){return t&&dH(e.prototype,t),r&&dH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zLe(e){var t=YLe(e,"string");return Md(t)==="symbol"?t:String(t)}function YLe(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qi(e,t,r){GLe(e,t),t.set(e,r)}function GLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jn(e,t){var r=Uz(e,t,"get");return KLe(e,r)}function KLe(e,t){return t.get?t.get.call(e):t.value}function Ji(e,t,r){var n=Uz(e,t,"set");return qLe(e,n,r),r}function Uz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function qLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ly=new WeakMap,jy=new WeakMap,PS=new WeakMap,kS=new WeakMap,$S=new WeakMap,AS=new WeakMap,IS=new WeakMap,XLe=function(){function e(t,r,n){WLe(this,e),Qi(this,Ly,{writable:!0,value:void 0}),Qi(this,jy,{writable:!0,value:void 0}),Qi(this,PS,{writable:!0,value:void 0}),Qi(this,kS,{writable:!0,value:!1}),Qi(this,$S,{writable:!0,value:!1}),Qi(this,AS,{writable:!0,value:null}),Qi(this,IS,{writable:!0,value:null}),Ji(this,Ly,new hH("row",t,this)),Ji(this,jy,new hH("column",r,this)),Ji(this,PS,n)}return ULe(e,[{key:"getForAxis",value:function(r){return r==="row"?Jn(this,Ly):Jn(this,jy)}},{key:"setPerformUndo",value:function(r){Ji(this,kS,r)}},{key:"setPerformRedo",value:function(r){Ji(this,$S,r)}},{key:"isPerformingUndoRedo",value:function(){return Jn(this,kS)||Jn(this,$S)}},{key:"getSheetId",value:function(){return Jn(this,IS)}},{key:"getEngine",value:function(){return Jn(this,AS)}},{key:"getPostponeAction",value:function(){return Jn(this,PS)}},{key:"setupSyncEndpoint",value:function(r,n){Ji(this,AS,r),Ji(this,IS,n),Jn(this,Ly).init(),Jn(this,jy).init()}}]),e}();const ZLe=XLe;function QLe(e){return tje(e)||eje(e)||zz(e)||JLe()}function JLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tje(e){if(Array.isArray(e))return dR(e)}function Mi(e){"@babel/helpers - typeof";return Mi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mi(e)}function Ml(e,t){return oje(e)||nje(e,t)||zz(e,t)||rje()}function rje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zz(e,t){if(e){if(typeof e=="string")return dR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dR(e,t)}}function dR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function oje(e){if(Array.isArray(e))return e}function ije(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yz(n.key),n)}}function aje(e,t,r){return t&&vH(e.prototype,t),r&&vH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _a(){return typeof Reflect<"u"&&Reflect.get?_a=Reflect.get.bind():_a=function(t,r,n){var o=lje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_a.apply(this,arguments)}function lje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function sje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vR(e,t)}function vR(e,t){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vR(e,t)}function uje(e){var t=cje();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fje(this,o)}}function fje(e,t){if(t&&(Mi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dn(e)}function Dn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}function xl(e,t,r){return t=Yz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yz(e){var t=hje(e,"string");return Mi(t)==="symbol"?t:String(t)}function hje(e,t){if(Mi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MS(e,t,r){dje(e,t),t.set(e,r)}function dje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(e,t,r){var n=Gz(e,t,"set");return vje(e,n,r),r}function vje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Dl(e,t){var r=Gz(e,t,"get");return yje(e,r)}function Gz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function yje(e,t){return t.get?t.get.call(e):t.value}var ar="formulas",gje=["maxRows","maxColumns","language"],pje=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");var Nl=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},eo=new WeakMap,xS=new WeakMap,uc=new WeakMap,mje=function(e){sje(r,e);var t=uje(r);function r(){var n;ije(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),MS(Dn(n),eo,{writable:!0,value:!1}),MS(Dn(n),xS,{writable:!0,value:!1}),MS(Dn(n),uc,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),xl(Dn(n),"staticRegister",on("formulas")),xl(Dn(n),"engine",null),xl(Dn(n),"sheetName",null),xl(Dn(n),"indexSyncer",null),xl(Dn(n),"rowAxisSyncer",null),xl(Dn(n),"columnAxisSyncer",null),n}return aje(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ar]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=ELe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){bt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new ZLe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),Dl(this,uc).forEach(function(l){var s=Ml(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),_a(Ro(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;Dl(this,uc).forEach(function(i){var a=Ml(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),lH(this.engine,this.hot),this.engine=null,_a(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=_Le(this.hot.getSettings());OLe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[ar];if(ve(a)&&ve(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[ar].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}_a(Ro(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;Dl(this,uc).forEach(function(i){var a,l=Ml(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),ri(this,uc,null),lH(this.engine,this.hot),this.engine=null,_a(Ro(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ve(i)&&!CU(i))return bt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return bt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return bt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){DE("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(ur(ar),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),aH(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,y=h.sheet;return ve(y)?"".concat(y,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ve(d)===!1||ve(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=l(u);if(y!==void 0&&!s.has(m)){var w=aH(i.engine).get(y);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){bt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return RS(a,s.type)&&(sH(a,s.dateFormat)?a=uH(a,s.dateFormat):MLe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&wr(f)&&(f=fH(f,u.dateFormat)),Mi(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,y=d.col,m=a.getBottomEndCorner(),w=m.row,S=m.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},k={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(k)===!1)return!1;for(var O=this.engine.getFillRangeData(C,k),W=C.start,Y=W.row,q=W.col,G=C.end,X=G.row,Q=G.col,oe=X-Y+1,J=Q-q+1,ue=0;ue<O.length;ue+=1)for(var he=0;he<O[ue].length;he+=1){var Oe=O[ue][he],we=ue%oe,$=he%J,P=this.hot.getCellMeta(we,$);RS(Oe,P.type)&&(Oe.startsWith("'")?O[ue][he]=Oe.slice(1):this.isFormulaCellType(we,$,this.sheetId)===!1&&(O[ue][he]=xLe(Oe,P.dateFormat)))}return O}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ur(ar))||ri(this,xS,mt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;RS(u,c.type)&&(a=!0,sH(u,h)?i[s][f]=uH(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(ri(this,eo,!0),this.engine.setSheetContent(this.sheetId,i),ri(this,eo,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ur(ar)))if(this.sheetName=ALe(this.engine,this.hot.getSettings()[ar].sheetName),Dl(this,xS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){ri(this,eo,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),ri(this,eo,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||Dl(this,eo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){Vz(a.value)&&(a.value=ILe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&wr(h)&&(h=fH(h,d.dateFormat));var v=Mi(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||Dl(this,eo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!Nl(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Ml(f,4),h=c[0],d=c[1],v=c[3],y=a.hot.propToCol(d),m=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(y),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:a.sheetId};m!==null&&w!==null?a.syncChangeWithEngine(h,y,v):l.push([h,y,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Ml(c,3),d=h[0],v=h[1],y=h[2];a.syncChangeWithEngine(d,v,y)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!Nl(i)){var l=[],s=[];o.forEach(function(u){var f=Ml(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(wr(v)){var y={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(y)){bt("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),l.push.apply(l,QLe(a.engine.setCellContents(y,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!Nl(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!Nl(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!Nl(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!Nl(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;ri(this,eo,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());ri(this,eo,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return ar}},{key:"PLUGIN_PRIORITY",get:function(){return pje}},{key:"SETTING_KEYS",get:function(){return[ar].concat(gje)}}]),r}(ot);function bje(e,t){return _je(e)||Cje(e,t)||Sje(e,t)||wje()}function wje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sje(e,t){if(e){if(typeof e=="string")return yH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yH(e,t)}}function yH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _je(e){if(Array.isArray(e))return e}function Oje(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=bje(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(sP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Fy(e){return Pje(e)||Tje(e)||Eje(e)||Rje()}function Rje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eje(e,t){if(e){if(typeof e=="string")return yR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yR(e,t)}}function Tje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pje(e){if(Array.isArray(e))return yR(e)}function yR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kje(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(uP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Fy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Fy(c.slice(0,a)));else if(u===null)h.push.apply(h,Fy(c.slice(0,this.countCols())));else{var m=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,Fy(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function Wu(e){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function $je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ije(n.key),n)}}function Aje(e,t,r){return t&&gH(e.prototype,t),r&&gH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ije(e){var t=Mje(e,"string");return Wu(t)==="symbol"?t:String(t)}function Mje(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oa(){return typeof Reflect<"u"&&Reflect.get?Oa=Reflect.get.bind():Oa=function(t,r,n){var o=xje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oa.apply(this,arguments)}function xje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function Dje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gR(e,t)}function gR(e,t){return gR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gR(e,t)}function Nje(e){var t=Lje();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hje(this,o)}}function Hje(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pR(e)}function pR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}function pH(e,t,r){jje(e,t),t.set(e,r)}function jje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(e,t){var r=Kz(e,t,"get");return Fje(e,r)}function Fje(e,t){return t.get?t.get.call(e):t.value}function fc(e,t,r){var n=Kz(e,t,"set");return Bje(e,n,r),r}function Kz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Bje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");var DS="hiddenColumns",Vje=310,$n=new WeakMap,An=new WeakMap,Wje=function(e){Dje(r,e);var t=Nje(r);function r(){var n;$je(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),pH(pR(n),$n,{writable:!0,value:{}}),pH(pR(n),An,{writable:!0,value:null}),n}return Aje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[DS];Ue(i)&&(fc(this,$n,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),fc(this,An,new Ym),Hr(this,An).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Hr(this,An)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Oa(Eo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Oa(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),fc(this,$n,{}),Oa(Eo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Hr(this,An).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});A(c,function(d){u[d]=!1}),s=jt(u,function(d,v,y){return v&&d.push(i.hot.toVisualColumn(y)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Hr(this,An).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){Hr(i,An).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return We(Hr(this,An).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Hr(this,An).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Hr(this,$n).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Hr(this,$n).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Hr(this,$n).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Hr(this,$n).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},Oje(this),kje(this))}},{key:"onMapInit",value:function(){Array.isArray(Hr(this,$n).columns)&&this.hideColumns(Hr(this,$n).columns)}},{key:"destroy",value:function(){fc(this,$n,null),fc(this,An,null),Oa(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DS}},{key:"PLUGIN_PRIORITY",get:function(){return Vje}}]),r}(ot);function Uje(e,t){return Kje(e)||Gje(e,t)||Yje(e,t)||zje()}function zje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yje(e,t){if(e){if(typeof e=="string")return mH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mH(e,t)}}function mH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Kje(e){if(Array.isArray(e))return e}function qje(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=Uje(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(fP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function By(e){return Jje(e)||Qje(e)||Zje(e)||Xje()}function Xje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zje(e,t){if(e){if(typeof e=="string")return mR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mR(e,t)}}function Qje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jje(e){if(Array.isArray(e))return mR(e)}function mR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eFe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(cP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,By(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,By(c.slice(0,a)));else if(u===null)h.push.apply(h,By(c.slice(0,this.countRows())));else{var m=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,By(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function tFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nFe(n.key),n)}}function rFe(e,t,r){return t&&bH(e.prototype,t),r&&bH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nFe(e){var t=oFe(e,"string");return Uu(t)==="symbol"?t:String(t)}function oFe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ra(){return typeof Reflect<"u"&&Reflect.get?Ra=Reflect.get.bind():Ra=function(t,r,n){var o=iFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ra.apply(this,arguments)}function iFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function aFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bR(e,t)}function bR(e,t){return bR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bR(e,t)}function lFe(e){var t=uFe();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sFe(this,o)}}function sFe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wR(e)}function wR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}function wH(e,t,r){fFe(e,t),t.set(e,r)}function fFe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(e,t){var r=qz(e,t,"get");return cFe(e,r)}function cFe(e,t){return t.get?t.get.call(e):t.value}function cc(e,t,r){var n=qz(e,t,"set");return hFe(e,n,r),r}function qz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hFe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");var NS="hiddenRows",dFe=320,to=new WeakMap,In=new WeakMap,vFe=function(e){aFe(r,e);var t=lFe(r);function r(){var n;tFe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),wH(wR(n),to,{writable:!0,value:{}}),wH(wR(n),In,{writable:!0,value:null}),n}return rFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[NS];Ue(i)&&(cc(this,to,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),cc(this,In,new Ym),qr(this,In).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,qr(this,In)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Ra(To(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ra(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),cc(this,to,{}),Ra(To(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=qr(this,In).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});A(c,function(d){u[d]=!1}),s=jt(u,function(d,v,y){return v&&d.push(i.hot.toVisualRow(y)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&qr(this,In).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){qr(i,In).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return We(qr(this,In).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return qr(this,In).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(qr(this,to).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(qr(this,to).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!qr(this,to).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},qje(this),eFe(this))}},{key:"onMapInit",value:function(){Array.isArray(qr(this,to).rows)&&this.hideRows(qr(this,to).rows)}},{key:"destroy",value:function(){cc(this,to,null),cc(this,In,null),Ra(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NS}},{key:"PLUGIN_PRIORITY",get:function(){return dFe}}]),r}(ot);function yFe(e,t){return bFe(e)||mFe(e,t)||pFe(e,t)||gFe()}function gFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pFe(e,t){if(e){if(typeof e=="string")return SH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(e,t)}}function SH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bFe(e){if(Array.isArray(e))return e}function wFe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(LT)},callback:function(r,n){var o=yFe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function SFe(e,t){return RFe(e)||OFe(e,t)||_Fe(e,t)||CFe()}function CFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Fe(e,t){if(e){if(typeof e=="string")return CH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CH(e,t)}}function CH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function RFe(e){if(Array.isArray(e))return e}function EFe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(jT)},callback:function(r,n){var o=SFe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function TFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kFe(n.key),n)}}function PFe(e,t,r){return t&&_H(e.prototype,t),r&&_H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kFe(e){var t=$Fe(e,"string");return zu(t)==="symbol"?t:String(t)}function $Fe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ss(){return typeof Reflect<"u"&&Reflect.get?ss=Reflect.get.bind():ss=function(t,r,n){var o=AFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ss.apply(this,arguments)}function AFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ei(e),e!==null););return e}function IFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SR(e,t)}function SR(e,t){return SR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},SR(e,t)}function MFe(e){var t=DFe();return function(){var n=Ei(e),o;if(t){var i=Ei(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xFe(this,o)}}function xFe(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xz(e)}function Xz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ei(e)}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");var OH="manualColumnFreeze",NFe=110,hc=new WeakMap,HFe=function(e){IFe(r,e);var t=MFe(r);function r(n){var o;return TFe(this,r),o=t.call(this,n),hc.set(Xz(o),{afterFirstUse:!1}),o}return PFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[OH]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),ss(Ei(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=hc.get(this);o.afterFirstUse=!1,ss(Ei(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ss(Ei(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=hc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=hc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},wFe(this),EFe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=hc.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return OH}},{key:"PLUGIN_PRIORITY",get:function(){return NFe}}]),r}(ot);function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function LFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FFe(n.key),n)}}function jFe(e,t,r){return t&&RH(e.prototype,t),r&&RH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FFe(e){var t=BFe(e,"string");return xd(t)==="symbol"?t:String(t)}function BFe(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HS=0,EH=1,TH=2,Hl="px",VFe=function(){function e(t){LFe(this,e),this.hot=t,this._element=null,this.state=HS,this.inlineProperty=t.isRtl()?"right":"left"}return jFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=TH}},{key:"build",value:function(){this.state===HS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=EH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=HS}},{key:"isAppended",value:function(){return this.state===TH}},{key:"isBuilt",value:function(){return this.state>=EH}},{key:"setPosition",value:function(r,n){wr(r)&&(this._element.style.top=r+Hl),wr(n)&&(this._element.style[this.inlineProperty]=n+Hl)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){wr(r)&&(this._element.style.width=r+Hl),wr(n)&&(this._element.style.height=n+Hl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){wr(r)&&(this._element.style.marginTop=r+Hl),wr(n)&&(this._element.style["margin".concat(ur(this.inlineProperty))]=n+Hl)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ur(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const Zz=VFe;function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function WFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zFe(n.key),n)}}function UFe(e,t,r){return t&&PH(e.prototype,t),r&&PH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zFe(e){var t=YFe(e,"string");return Yu(t)==="symbol"?t:String(t)}function YFe(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mg(){return typeof Reflect<"u"&&Reflect.get?Mg=Reflect.get.bind():Mg=function(t,r,n){var o=GFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mg.apply(this,arguments)}function GFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gu(e),e!==null););return e}function KFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CR(e,t)}function CR(e,t){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CR(e,t)}function qFe(e){var t=QFe();return function(){var n=Gu(e),o;if(t){var i=Gu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XFe(this,o)}}function XFe(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZFe(e)}function ZFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gu(e){return Gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gu(e)}var JFe="ht__manualColumnMove--backlight",eBe=function(e){KFe(r,e);var t=qFe(r);function r(){return WFe(this,r),t.apply(this,arguments)}return UFe(r,[{key:"build",value:function(){Mg(Gu(r.prototype),"build",this).call(this),te(this._element,JFe)}}]),r}(Zz);const tBe=eBe;function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function rBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oBe(n.key),n)}}function nBe(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oBe(e){var t=iBe(e,"string");return Ku(t)==="symbol"?t:String(t)}function iBe(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xg(){return typeof Reflect<"u"&&Reflect.get?xg=Reflect.get.bind():xg=function(t,r,n){var o=aBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xg.apply(this,arguments)}function aBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qu(e),e!==null););return e}function lBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_R(e,t)}function _R(e,t){return _R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_R(e,t)}function sBe(e){var t=cBe();return function(){var n=qu(e),o;if(t){var i=qu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uBe(this,o)}}function uBe(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fBe(e)}function fBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qu(e){return qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qu(e)}var hBe="ht__manualColumnMove--guideline",dBe=function(e){lBe(r,e);var t=sBe(r);function r(){return rBe(this,r),t.apply(this,arguments)}return nBe(r,[{key:"build",value:function(){xg(qu(r.prototype),"build",this).call(this),te(this._element,hBe)}}]),r}(Zz);const vBe=dBe;function Xu(e){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function yBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pBe(n.key),n)}}function gBe(e,t,r){return t&&$H(e.prototype,t),r&&$H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pBe(e){var t=mBe(e,"string");return Xu(t)==="symbol"?t:String(t)}function mBe(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ea(){return typeof Reflect<"u"&&Reflect.get?Ea=Reflect.get.bind():Ea=function(t,r,n){var o=bBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ea.apply(this,arguments)}function bBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function wBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OR(e,t)}function OR(e,t){return OR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},OR(e,t)}function SBe(e){var t=_Be();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CBe(this,o)}}function CBe(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RR(e)}function RR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Be(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");var LS="manualColumnMove",OBe=120,ni=new WeakMap,AH="ht__manualColumnMove",Vy="show-ui",jS="on-moving--columns",FS="after-selection--columns",RBe=function(e){wBe(r,e);var t=SBe(r);function r(n){var o;return yBe(this,r),o=t.call(this,n),ni.set(RR(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new Pt(RR(o)),o.backlight=new tBe(n),o.guideline=new vBe(n),o}return gBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[LS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,AH),Ea(Po(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Ea(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,AH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Ea(Po(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=ni.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=ni.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=jt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[LS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Ce(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=ni.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,y=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,w=ct(this.hot.rootElement),S=m.innerWidth-o.rootElementOffset-w;y=m.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else y=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=y){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var k=y,O=u;y+d+h>=f?k=f-d-h:y+h<c+v&&(k=c+v+Math.abs(h)),u>=f-1?O=f-1:O===0?O=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(O-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,k),this.guideline.setPosition(null,O)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=ni.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Le(this.hot.rootElement,[jS,Vy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=f.from,m=f.to,w=Math.min(y.col,m.col),S=Math.max(y.col,m.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Wt(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,k=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,O=i.col<c.fixedColumnsStart,W=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),Y=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),q=this.getColumnsWidth(w,i.col-1)+Y,G=this.getColumnsWidth(C,w-1)+(O?W:0)+q;this.backlight.setPosition(k,G),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-k),this.backlight.setOffset(null,-q),te(this.hot.rootElement,jS)}else Le(this.hot.rootElement,FS),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ni.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ni.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Le(this.hot.rootElement,Vy):te(this.hot.rootElement,Vy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ni.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,Le(this.hot.rootElement,[jS,Vy,FS]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,FS),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Ea(Po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LS}},{key:"PLUGIN_PRIORITY",get:function(){return OBe}}]),r}(ot);function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function EBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PBe(n.key),n)}}function TBe(e,t,r){return t&&IH(e.prototype,t),r&&IH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PBe(e){var t=kBe(e,"string");return Zu(t)==="symbol"?t:String(t)}function kBe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ta(){return typeof Reflect<"u"&&Reflect.get?Ta=Reflect.get.bind():Ta=function(t,r,n){var o=$Be(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ta.apply(this,arguments)}function $Be(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function ABe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ER(e,t)}function ER(e,t){return ER=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ER(e,t)}function IBe(e){var t=xBe();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MBe(this,o)}}function MBe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TR(e)}function TR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}var Wy="manualColumnResize",DBe=130,MH="manualColumnWidths",BS=new WeakMap,NBe=function(e){ABe(r,e);var t=IBe(r);function r(n){var o;EBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Pt(TR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,BS.set(TR(o),{config:void 0}),te(o.handle,"manualColumnResizer"),te(o.guide,"manualColumnResizerGuide"),o}return TBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Wy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Hi,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),Ta(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ta(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=BS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ta(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",MH,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",MH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=BS.get(this),a=this.hot.getSettings()[Wy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Tt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();A(v,function(y){var m=y.getTopStartCorner().col,w=y.getBottomEndCorner().col;Ce(m,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Tt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!gi(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!xE(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,A(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[Wy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Ta(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Wy}},{key:"PLUGIN_PRIORITY",get:function(){return DBe}}]),r}(ot);function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function HBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jBe(n.key),n)}}function LBe(e,t,r){return t&&xH(e.prototype,t),r&&xH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jBe(e){var t=FBe(e,"string");return Dd(t)==="symbol"?t:String(t)}function FBe(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VS=0,DH=1,NH=2,Ll="px",BBe=function(){function e(t){HBe(this,e),this.hot=t,this._element=null,this.state=VS}return LBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=NH}},{key:"build",value:function(){this.state===VS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=DH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=VS}},{key:"isAppended",value:function(){return this.state===NH}},{key:"isBuilt",value:function(){return this.state>=DH}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Ll),n!==void 0&&(this._element.style.left=n+Ll)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Ll),n&&(this._element.style.height=n+Ll)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Ll),n&&(this._element.style.marginLeft=n+Ll)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const Qz=BBe;function Qu(e){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}function VBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UBe(n.key),n)}}function WBe(e,t,r){return t&&HH(e.prototype,t),r&&HH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UBe(e){var t=zBe(e,"string");return Qu(t)==="symbol"?t:String(t)}function zBe(e,t){if(Qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dg(){return typeof Reflect<"u"&&Reflect.get?Dg=Reflect.get.bind():Dg=function(t,r,n){var o=YBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dg.apply(this,arguments)}function YBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ju(e),e!==null););return e}function GBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PR(e,t)}function PR(e,t){return PR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PR(e,t)}function KBe(e){var t=ZBe();return function(){var n=Ju(e),o;if(t){var i=Ju(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qBe(this,o)}}function qBe(e,t){if(t&&(Qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XBe(e)}function XBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ju(e){return Ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ju(e)}var QBe="ht__manualRowMove--backlight",JBe=function(e){GBe(r,e);var t=KBe(r);function r(){return VBe(this,r),t.apply(this,arguments)}return WBe(r,[{key:"build",value:function(){Dg(Ju(r.prototype),"build",this).call(this),te(this._element,QBe)}}]),r}(Qz);const eVe=JBe;function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function tVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nVe(n.key),n)}}function rVe(e,t,r){return t&&LH(e.prototype,t),r&&LH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nVe(e){var t=oVe(e,"string");return ef(t)==="symbol"?t:String(t)}function oVe(e,t){if(ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ng(){return typeof Reflect<"u"&&Reflect.get?Ng=Reflect.get.bind():Ng=function(t,r,n){var o=iVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ng.apply(this,arguments)}function iVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tf(e),e!==null););return e}function aVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kR(e,t)}function kR(e,t){return kR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kR(e,t)}function lVe(e){var t=fVe();return function(){var n=tf(e),o;if(t){var i=tf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sVe(this,o)}}function sVe(e,t){if(t&&(ef(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uVe(e)}function uVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tf(e){return tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tf(e)}var cVe="ht__manualRowMove--guideline",hVe=function(e){aVe(r,e);var t=lVe(r);function r(){return tVe(this,r),t.apply(this,arguments)}return rVe(r,[{key:"build",value:function(){Ng(tf(r.prototype),"build",this).call(this),te(this._element,cVe)}}]),r}(Qz);const dVe=hVe;function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function vVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gVe(n.key),n)}}function yVe(e,t,r){return t&&jH(e.prototype,t),r&&jH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gVe(e){var t=pVe(e,"string");return rf(t)==="symbol"?t:String(t)}function pVe(e,t){if(rf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pa(){return typeof Reflect<"u"&&Reflect.get?Pa=Reflect.get.bind():Pa=function(t,r,n){var o=mVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pa.apply(this,arguments)}function mVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function bVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$R(e,t)}function $R(e,t){return $R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$R(e,t)}function wVe(e){var t=CVe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SVe(this,o)}}function SVe(e,t){if(t&&(rf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AR(e)}function AR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");var WS="manualRowMove",_Ve=140,oi=new WeakMap,FH="ht__manualRowMove",Uy="show-ui",US="on-moving--rows",zS="after-selection--rows",OVe=function(e){bVe(r,e);var t=wVe(r);function r(n){var o;return vVe(this,r),o=t.call(this,n),oi.set(AR(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new Pt(AR(o)),o.backlight=new eVe(n),o.guideline=new dVe(n),o}return yVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[WS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,FH),Pa($o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Pa($o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,FH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Pa($o(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=oi.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=oi.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=jt(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[WS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return Ce(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=oi.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Wt(c),d=Ba(c),v=u.holder.scrollTop,y;this.hot.rootWindow===d?y=d.scrollY:y=d.scrollTop;var m=h.top-y,w=o.target.eventPageY-m+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,k=this.backlight.getOffset().top,O=this.backlight.getSize().height,W=f.offsetHeight/2,Y=f.offsetHeight,q=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),G=w>=q+W;this.isFixedRowTop(i.row)&&(q+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:G?(o.target.row=i.row+1,q+=i.row===0?Y-1:Y):o.target.row=i.row;var X=w,Q=q;w+O+k>=S?X=S-O-k:w+k<C&&(X=C+Math.abs(k)),q>=S-1&&(Q=S-1),this.backlight.setPosition(X),this.guideline.setPosition(Q)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=oi.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Le(this.hot.rootElement,[US,Uy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&y&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var m=h.from,w=h.to,S=Math.min(m.row,w.row),C=Math.max(m.row,w.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var k=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,k),this.backlight.setSize(u.hider.offsetWidth-k,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),te(this.hot.rootElement,US),this.refreshPositions()}else Le(this.hot.rootElement,zS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=oi.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=oi.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Le(this.hot.rootElement,Uy):te(this.hot.rootElement,Uy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=oi.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Le(this.hot.rootElement,[US,Uy,zS]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,zS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Pa($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return WS}},{key:"PLUGIN_PRIORITY",get:function(){return _Ve}}]),r}(ot);function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function RVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TVe(n.key),n)}}function EVe(e,t,r){return t&&BH(e.prototype,t),r&&BH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TVe(e){var t=PVe(e,"string");return nf(t)==="symbol"?t:String(t)}function PVe(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(){return typeof Reflect<"u"&&Reflect.get?ka=Reflect.get.bind():ka=function(t,r,n){var o=kVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ka.apply(this,arguments)}function kVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function $Ve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IR(e,t)}function IR(e,t){return IR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IR(e,t)}function AVe(e){var t=MVe();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return IVe(this,o)}}function IVe(e,t){if(t&&(nf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MR(e)}function MR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}var zy="manualRowResize",xVe=30,VH="manualRowHeights",YS=new WeakMap,DVe=function(e){$Ve(r,e);var t=AVe(r);function r(n){var o;RVe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Pt(MR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,YS.set(MR(o),{config:void 0}),te(o.handle,"manualRowResizer"),te(o.guide,"manualRowResizerGuide"),o}return EVe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[zy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Hi,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),ka(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ka(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=YS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ka(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",VH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",VH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,BW.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=ct(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var m=this.hot.getSelectedRange();A(m,function(w){var S=w.getTopStartCorner().row,C=w.getBottomStartCorner().row;Ce(S,C,function(k){i.selectedRows.includes(k)||i.selectedRows.push(k)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(ct(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=gi(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!xE(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),A(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[zy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=YS.get(this),a=this.hot.getSettings()[zy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){ka(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zy}},{key:"PLUGIN_PRIORITY",get:function(){return xVe}}]),r}(ot);function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}var WH,UH,zH,YH;function Yy(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function NVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LVe(n.key),n)}}function HVe(e,t,r){return t&&GH(e.prototype,t),r&&GH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LVe(e){var t=jVe(e,"string");return Nd(t)==="symbol"?t:String(t)}function jVe(e,t){if(Nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FVe=function(){function e(t,r,n,o,i,a){NVe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return HVe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return dt(WH||(WH=Yy(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return dt(UH||(UH=Yy(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return dt(zH||(zH=Yy(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return dt(YH||(YH=Yy(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const Hn=FVe;function xR(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}var KH;function BVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qH(e){return zVe(e)||UVe(e)||WVe(e)||VVe()}function VVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WVe(e,t){if(e){if(typeof e=="string")return DR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DR(e,t)}}function UVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zVe(e){if(Array.isArray(e))return DR(e)}function DR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KVe(n.key),n)}}function GVe(e,t,r){return t&&XH(e.prototype,t),r&&XH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KVe(e){var t=qVe(e,"string");return Hd(t)==="symbol"?t:String(t)}function qVe(e,t){if(Hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XVe=function(){function e(t){YVe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return GVe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return A(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return A(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return A(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new Hn(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(bt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];A(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,A(o,function(a,l){Ce(0,a.rowspan-1,function(s){Ce(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),A(o,function(a){xR.apply(void 0,qH(a))}),A(i,function(a){xR.apply(void 0,qH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return A(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}A(this.mergedCells,function(l){l.shift(a,n)}),np(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return dt(KH||(KH=BVe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const ZVe=XVe;function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}function ea(e,t){return tWe(e)||eWe(e,t)||JVe(e,t)||QVe()}function QVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JVe(e,t){if(e){if(typeof e=="string")return ZH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZH(e,t)}}function ZH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tWe(e){if(Array.isArray(e))return e}function rWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oWe(n.key),n)}}function nWe(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oWe(e){var t=iWe(e,"string");return Ld(t)==="symbol"?t:String(t)}function iWe(e,t){if(Ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aWe=function(){function e(t){rWe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return nWe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=ea(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,y=Math.floor(l/v)*v,m=l-y,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-m,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=m:a[2]+=m?S:0}else if(o==="right"){var k=w.col+w.colspan-f-m,O=a[3]+k;O>=this.plugin.hot.countCols()?a[3]-=m:a[3]+=m?k:0}else if(o==="up"){var W=c-m-w.row+1,Y=a[0]+W;Y<0?a[0]+=m:a[0]-=m?W:0}else if(o==="left"){var q=h-m-w.col+1,G=a[1]+q;G<0?a[1]+=m:a[1]-=m?q:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),Ut(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=ea(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ea(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=ea(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ea(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=ea(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),y=c?u-l+1:f-s+1,m=Math.floor(v/y)*y,w=v-m,S=null,C=null,k=null;switch(o){case"up":S="includesVertically",k=h-w+1;break;case"left":S="includesHorizontally",k=h-w+1;break;case"down":S="includesVertically",k=d+w-1;break;case"right":S="includesHorizontally",k=d+w-1;break}return A(i,function(O){O[S](k)&&O.isFarther(C,o)&&(C=O)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return A(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=ea(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const lWe=aWe;function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}function sWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fWe(n.key),n)}}function uWe(e,t,r){return t&&JH(e.prototype,t),r&&JH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fWe(e){var t=cWe(e,"string");return jd(t)==="symbol"?t:String(t)}function cWe(e,t){if(jd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hWe=function(){function e(t){sWe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return uWe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const dWe=hWe;function vWe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(BT)}return this.getTranslatedPhrase(FT)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Hn.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function yWe(e,t){return mWe(e)||pWe(e,t)||Jz(e,t)||gWe()}function gWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function mWe(e){if(Array.isArray(e))return e}function bWe(e){return CWe(e)||SWe(e)||Jz(e)||wWe()}function wWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jz(e,t){if(e){if(typeof e=="string")return NR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NR(e,t)}}function SWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CWe(e){if(Array.isArray(e))return NR(e)}function NR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RWe(n.key),n)}}function OWe(e,t,r){return t&&eL(e.prototype,t),r&&eL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RWe(e){var t=EWe(e,"string");return of(t)==="symbol"?t:String(t)}function EWe(e,t){if(of(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function us(){return typeof Reflect<"u"&&Reflect.get?us=Reflect.get.bind():us=function(t,r,n){var o=TWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},us.apply(this,arguments)}function TWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ti(e),e!==null););return e}function PWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HR(e,t)}function HR(e,t){return HR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HR(e,t)}function kWe(e){var t=AWe();return function(){var n=Ti(e),o;if(t){var i=Ti(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $We(this,o)}}function $We(e,t){if(t&&(of(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eY(e)}function eY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ti(e){return Ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ti(e)}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");var Sc="mergeCells",IWe=150,tL=new WeakMap,rL=Sc,MWe=function(e){PWe(r,e);var t=kWe(r);function r(n){var o;return _We(this,r),o=t.call(this,n),tL.set(eY(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return OWe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Sc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new ZVe(this),this.autofillCalculations=new lWe(this),this.selectionCalculations=new dWe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),us(Ti(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),us(Ti(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[Sc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),us(Ti(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(CE()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=bWe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=ms(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=ms(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(Hn.containsNegativeValues(o)?(bt(Hn.NEGATIVE_VALUES_WARNING(o)),i=!1):Hn.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(bt(Hn.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Hn.isSingleCell(o)?(bt(Hn.IS_SINGLE_CELL(o)),i=!1):Hn.containsZeroSpan(o)&&(bt(Hn.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(A(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),Ce(l.row,l.row+l.rowspan-1,function(c){Ce(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Ce(0,f.rowspan-1,function(v){Ce(0,f.colspan-1,function(y){var m=null;c[v]||(c[v]=[]),v===0&&y===0?m=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+y,"hidden",!0),c[v][y]=m})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),A(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),Ce(0,s.rowspan-1,function(u){Ce(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Sc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:rL})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(rL)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=tL.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var y=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:y.row-u.row,col:y.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=Sr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=Sr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=Sr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),A(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},vWe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ue(l)?Sr(l):void 0;if(Ue(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,y=s.rowspan,m=this.translateMergedCellToRenderable(h,y,d,v),w=yWe(m,2),S=w[0],C=w[1],k=f.getRenderableFromVisualIndex(i),O=c.getRenderableFromVisualIndex(a),W=S-k+1,Y=C-O+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,W),s.colspan=Math.min(s.colspan,Y)}xR(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);A(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,y=l.col===0;(s&&h||u&&d||c&&v||f&&y)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Sc}},{key:"PLUGIN_PRIORITY",get:function(){return IWe}}]),r}(ot);function nL(e){return HWe(e)||NWe(e)||DWe(e)||xWe()}function xWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DWe(e,t){if(e){if(typeof e=="string")return oL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oL(e,t)}}function oL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HWe(e){if(Array.isArray(e))return e}function LWe(e,t){return function(r,n){var o=nL(r),i=o.slice(1),a=nL(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:q2(c.type),m=y(f,c,v)(h,d);if(m===Bn){var w=u+1;if(typeof t[w]<"u")return s(w)}return m}(0)}}var iL;function jWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aL(){bt(dt(iL||(iL=jWe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var tY="sort";function FWe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(tY,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function BWe(e){var t=e.className.split(" "),r=new RegExp("^".concat(tY,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function VWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UWe(n.key),n)}}function WWe(e,t,r){return t&&lL(e.prototype,t),r&&lL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UWe(e){var t=zWe(e,"string");return af(t)==="symbol"?t:String(t)}function zWe(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jr(){return typeof Reflect<"u"&&Reflect.get?jr=Reflect.get.bind():jr=function(t,r,n){var o=YWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jr.apply(this,arguments)}function YWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=br(e),e!==null););return e}function GWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LR(e,t)}function LR(e,t){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LR(e,t)}function KWe(e){var t=ZWe();return function(){var n=br(e),o;if(t){var i=br(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qWe(this,o)}}function qWe(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XWe(e)}function XWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},br(e)}var jR="multiColumnSorting",QWe=170,JWe="append",sL="columnSorting";K2(jR,LWe);var e2e=function(e){GWe(r,e);var t=KWe(r);function r(n){var o;return VWe(this,r),o=t.call(this,n),o.pluginKey=jR,o}return WWe(r,[{key:"isEnabled",value:function(){return jr(br(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sL]&&aL(),jr(br(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){jr(br(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){jr(br(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){jr(br(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return jr(br(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return jr(br(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){jr(br(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=jr(br(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),Le(o,BWe(o)),this.enabled!==!1&&te(o,FWe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sL]&&aL(),jr(br(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){dO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,JWe))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return jR}},{key:"PLUGIN_PRIORITY",get:function(){return QWe}}]),r}(Z2);function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function t2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n2e(n.key),n)}}function r2e(e,t,r){return t&&uL(e.prototype,t),r&&uL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n2e(e){var t=o2e(e,"string");return lf(t)==="symbol"?t:String(t)}function o2e(e,t){if(lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hg(){return typeof Reflect<"u"&&Reflect.get?Hg=Reflect.get.bind():Hg=function(t,r,n){var o=i2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hg.apply(this,arguments)}function i2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sf(e),e!==null););return e}function a2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FR(e,t)}function FR(e,t){return FR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FR(e,t)}function l2e(e){var t=f2e();return function(){var n=sf(e),o;if(t){var i=sf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return s2e(this,o)}}function s2e(e,t){if(t&&(lf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u2e(e)}function u2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sf(e){return sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sf(e)}var c2e="multipleSelectionHandles",h2e=160,d2e=function(e){a2e(r,e);var t=l2e(r);function r(n){var o;return t2e(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return r2e(r,[{key:"isEnabled",value:function(){return gn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Pt(this)),this.registerListeners(),Hg(sf(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,y;if(i.dragged.length!==0){var m=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!m||m===i.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(f=i.hot.getCoords(m),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),y=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),y.start!==null&&i.hot.selection.setRangeStart(y.start),i.hot.selection.setRangeEnd(y.end),i.lastSetCell=m),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return c2e}},{key:"PLUGIN_PRIORITY",get:function(){return h2e}}]),r}(ot);function BR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,y=e.isRoot,m=y===void 0?!1:y,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:m,isPlaceholder:S}}function rY(){return{label:"",isPlaceholder:!0}}function fL(e){return p2e(e)||g2e(e)||y2e(e)||v2e()}function v2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y2e(e,t){if(e){if(typeof e=="string")return VR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VR(e,t)}}function g2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function p2e(e){if(Array.isArray(e))return VR(e)}function VR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m2e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;A(e,function(o){var i=[],a=0;r.push(i),A(o,function(l){var s=BR();if(Ue(l)){var u=l.label,f=l.colspan;s.label=xt(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=xt(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(rY());return!c})});var n=Math.max.apply(Math,fL(We(r,function(o){return o.length})));return A(r,function(o){if(o.length<n){var i=We(new Array(n-o.length),function(){return BR()});o.splice.apply(o,[o.length,0].concat(fL(i)))}}),r}function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}var b2e=["row","col"];function cL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function w2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cL(Object(r),!0).forEach(function(n){S2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S2e(e,t,r){return t=nY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C2e(e,t){if(e==null)return{};var r=_2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function O2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nY(n.key),n)}}function R2e(e,t,r){return t&&hL(e.prototype,t),r&&hL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nY(e){var t=E2e(e,"string");return Fd(t)==="symbol"?t:String(t)}function E2e(e,t){if(Fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GS(e,t,r){T2e(e,t),t.set(e,r)}function T2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sn(e,t){var r=oY(e,t,"get");return P2e(e,r)}function P2e(e,t){return t.get?t.get.call(e):t.value}function dc(e,t,r){var n=oY(e,t,"set");return k2e(e,n,r),r}function oY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function k2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var dL=["label","collapsible"],ro=new WeakMap,ta=new WeakMap,KS=new WeakMap,$2e=function(){function e(){O2e(this,e),GS(this,ro,{writable:!0,value:[]}),GS(this,ta,{writable:!0,value:0}),GS(this,KS,{writable:!0,value:1/0})}return R2e(e,[{key:"setColumnsLimit",value:function(r){dc(this,KS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];dc(this,ro,m2e(r,sn(this,KS))),dc(this,ta,sn(this,ro).length)}},{key:"getData",value:function(){return sn(this,ro)}},{key:"mergeWith",value:function(r){var n=this;A(r,function(o){var i=o.row,a=o.col,l=C2e(o,b2e),s=n.getHeaderSettings(i,a);s!==null&&Ut(s,l,dL)})}},{key:"map",value:function(r){A(sn(this,ro),function(n){A(n,function(o){var i=r(w2e({},o));Ue(i)&&Ut(o,i,dL)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=sn(this,ta)||r<0)return null;var i=sn(this,ro)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=sn(this,ta)||r<0)return i;for(var a=sn(this,ro)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return sn(this,ta)}},{key:"getColumnsCount",value:function(){return sn(this,ta)>0?sn(this,ro)[0].length:0}},{key:"clear",value:function(){dc(this,ro,[]),dc(this,ta,0)}}]),e}();function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function vL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vL(Object(r),!0).forEach(function(n){Lg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function A2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iY(n.key),n)}}function I2e(e,t,r){return t&&gL(e.prototype,t),r&&gL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lg(e,t,r){return t=iY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iY(e){var t=M2e(e,"string");return Bd(t)==="symbol"?t:String(t)}function M2e(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function x2e(e){return L2e(e)||H2e(e)||N2e(e)||D2e()}function D2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N2e(e,t){if(e){if(typeof e=="string")return WR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WR(e,t)}}function H2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function L2e(e){if(Array.isArray(e))return WR(e)}function WR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var j2e="DF-pre-order";function aY(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=aY.call(this.childs[n],e,t)}return r}var F2e="DF-post-order";function lY(e,t){for(var r=0;r<this.childs.length;r++){var n=lY.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var sY="BF";function B2e(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,x2e(o.childs)),e.call(t,o)!==!1&&n()}}n()}var V2e=sY,pL=new Map([[j2e,aY],[F2e,lY],[sY,B2e]]),mL=function(){function e(t){A2e(this,e),Lg(this,"data",{}),Lg(this,"parent",null),Lg(this,"childs",[]),this.data=t}return I2e(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(yL({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=yL({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:V2e;if(!pL.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));pL.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vd(e)}function bL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bL(Object(r),!0).forEach(function(n){W2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W2e(e,t,r){return t=uY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U2e(e,t){return K2e(e)||G2e(e,t)||Y2e(e,t)||z2e()}function z2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y2e(e,t){if(e){if(typeof e=="string")return SL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SL(e,t)}}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function G2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function K2e(e){if(Array.isArray(e))return e}function q2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uY(n.key),n)}}function X2e(e,t,r){return t&&CL(e.prototype,t),r&&CL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uY(e){var t=Z2e(e,"string");return Vd(t)==="symbol"?t:String(t)}function Z2e(e,t){if(Vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qS(e,t,r){Q2e(e,t),t.set(e,r)}function Q2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(e,t){var r=fY(e,t,"get");return J2e(e,r)}function J2e(e,t){return t.get?t.get.call(e):t.value}function eUe(e,t,r){var n=fY(e,t,"set");return tUe(e,n,r),r}function fY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function tUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var jl=new WeakMap,ra=new WeakMap,Fl=new WeakMap,rUe=function(){function e(t){q2e(this,e),qS(this,jl,{writable:!0,value:new Map}),qS(this,ra,{writable:!0,value:new Map}),qS(this,Fl,{writable:!0,value:null}),eUe(this,Fl,t)}return X2e(e,[{key:"getRoots",value:function(){return Array.from(gr(this,jl).values())}},{key:"getRootByColumn",value:function(r){var n;return gr(this,ra).has(r)&&(n=gr(this,jl).get(gr(this,ra).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-gr(this,ra).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;gr(this,ra).clear(),A(gr(this,jl),function(o){for(var i=U2e(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)gr(r,ra).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=gr(this,Fl).getColumnsCount(),n=0;n<r;){var o=gr(this,Fl).getHeaderSettings(0,n),i=new mL;gr(this,jl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=gr(this,Fl).getHeadersSettings(o,n,a);o+=1,A(l,function(s){var u=wL(wL({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new mL(u),r.addChild(f)),o<gr(i,Fl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){gr(this,jl).clear(),gr(this,ra).clear()}}]),e}();function cY(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function qp(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function Xp(e){return qp(e,"origColspan")===e.data.origColspan}function nk(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Xp(e);if(n)return nk(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)A(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,cY(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Xp(c)&&(h.isCollapsed=qp(c,"isCollapsed"))}),{rollbackModification:function(){return ok(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function ok(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Xp(e);if(o)return ok(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)A(i,function(h){cY(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=qp(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):Xp(h)&&(d.isCollapsed=qp(h,"isCollapsed"))}),{rollbackModification:function(){return nk(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var _L;function nUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function oUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(_L||(_L=nUe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var OL;function iUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(OL||(OL=iUe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var RL=new Map([["collapse",ok],["expand",nk],["hide-column",oUe],["show-column",aUe]]);function lUe(e,t,r){if(!RL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return RL.get(e)(t,r)}var sUe=["crossHiddenColumns"];function uUe(e,t){if(e==null)return{};var r=fUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Gy(e){var t=[];return A(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=hUe(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(rY());else{var d=cUe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function cUe(e){var t=BR(e);t.crossHiddenColumns;var r=uUe(t,sUe);return r}function hUe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function Wd(e){"@babel/helpers - typeof";return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wd(e)}var dUe=["row"];function EL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function TL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EL(Object(r),!0).forEach(function(n){vUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vUe(e,t,r){return t=hY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yUe(e,t){if(e==null)return{};var r=gUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function pUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hY(n.key),n)}}function mUe(e,t,r){return t&&PL(e.prototype,t),r&&PL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hY(e){var t=bUe(e,"string");return Wd(t)==="symbol"?t:String(t)}function bUe(e,t){if(Wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XS(e,t,r){wUe(e,t),t.set(e,r)}function wUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vc(e,t,r){var n=dY(e,t,"set");return SUe(e,n,r),r}function SUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ht(e,t){var r=dY(e,t,"get");return CUe(e,r)}function dY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function CUe(e,t){return t.get?t.get.call(e):t.value}var Mn=new WeakMap,Lr=new WeakMap,na=new WeakMap,_Ue=function(){function e(){pUe(this,e),XS(this,Mn,{writable:!0,value:new $2e}),XS(this,Lr,{writable:!0,value:new rUe(Ht(this,Mn))}),XS(this,na,{writable:!0,value:[[]]})}return mUe(e,[{key:"setState",value:function(r){Ht(this,Mn).setData(r);var n=!1;try{Ht(this,Lr).buildTree()}catch{Ht(this,Lr).clear(),Ht(this,Mn).clear(),n=!0}return vc(this,na,Gy(Ht(this,Lr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Ht(this,Mn).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=We(r,function(i){var a=i.row,l=yUe(i,dUe);return TL({row:a<0?n.rowCoordsToLevel(a):a},l)});Ht(this,Mn).mergeWith(o),Ht(this,Lr).buildTree(),vc(this,na,Gy(Ht(this,Lr).getRoots()))}},{key:"mapState",value:function(r){Ht(this,Mn).map(r),Ht(this,Lr).buildTree(),vc(this,na,Gy(Ht(this,Lr).getRoots()))}},{key:"mapNodes",value:function(r){return jt(Ht(this,Lr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Ht(this,Lr).getNode(n,o),a;return i&&(a=lUe(r,i,o),vc(this,na,Gy(Ht(this,Lr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Ht(this,na)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Ht(this,Lr).getNode(r,n);return o?TL({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Ht(this,Mn).getLayersCount()}},{key:"getColumnsCount",value:function(){return Ht(this,Mn).getColumnsCount()}},{key:"clear",value:function(){vc(this,na,[]),Ht(this,Mn).clear(),Ht(this,Lr).clear()}}]),e}();function Ud(e){"@babel/helpers - typeof";return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}function OUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vY(n.key),n)}}function RUe(e,t,r){return t&&kL(e.prototype,t),r&&kL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yc(e,t,r){return t=vY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vY(e){var t=EUe(e,"string");return Ud(t)==="symbol"?t:String(t)}function EUe(e,t){if(Ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TUe=function(){function e(t,r){OUe(this,e),yc(this,"hot",void 0),yc(this,"nestedHeaderSettingsGetter",void 0),yc(this,"layersCount",0),yc(this,"container",void 0),yc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return RUe(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),y=this.nestedHeaderSettingsGetter(f,d);if(y&&(!y.isPlaceholder||y.isHidden)){var m=y.label;s&&(m+='<button class="changeType"></button>'),ll(v,m),v.colSpan=y.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const PUe=TUe;function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}var $L,AL;function IL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function kUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ML(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yY(n.key),n)}}function $Ue(e,t,r){return t&&ML(e.prototype,t),r&&ML(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $a(){return typeof Reflect<"u"&&Reflect.get?$a=Reflect.get.bind():$a=function(t,r,n){var o=AUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$a.apply(this,arguments)}function AUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function IUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UR(e,t)}function UR(e,t){return UR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UR(e,t)}function MUe(e){var t=DUe();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xUe(this,o)}}function xUe(e,t){if(t&&(uf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cc(e)}function Cc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}function xL(e,t,r){return t=yY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yY(e){var t=NUe(e,"string");return uf(t)==="symbol"?t:String(t)}function NUe(e,t){if(uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DL(e,t,r){HUe(e,t),t.set(e,r)}function HUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ky(e,t,r){var n=gY(e,t,"set");return LUe(e,n,r),r}function LUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function kt(e,t){var r=gY(e,t,"get");return jUe(e,r)}function gY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function jUe(e,t){return t.get?t.get.call(e):t.value}var NL="nestedHeaders",FUe=280,Bt=new WeakMap,ii=new WeakMap,BUe=function(e){IUe(r,e);var t=MUe(r);function r(){var n;kUe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),DL(Cc(n),Bt,{writable:!0,value:new _Ue}),DL(Cc(n),ii,{writable:!0,value:null}),xL(Cc(n),"ghostTable",new PUe(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),xL(Cc(n),"detectedOverlappedHeaders",!1),n}return $Ue(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NL]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&bt(dt($L||($L=IL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),$a(Io(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;kt(this,Bt).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=kt(this,Bt).setState(a)),this.detectedOverlappedHeaders&&bt(dt(AL||(AL=IL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";kt(o,Bt).triggerColumnModification(u,s)}),!kt(this,ii)&&this.enabled&&Ky(this,ii,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";kt(o,Bt).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),$a(Io(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),kt(this,Bt).clear(),kt(this,ii).unsubscribe(),Ky(this,ii,null),this.ghostTable.clear(),$a(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return kt(this,Bt)}},{key:"getLayersCount",value:function(){return kt(this,Bt).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return kt(this,Bt).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Le(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Le(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Le(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),Le(s,"hiddenHeader");var v=(u=kt(i,Bt).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},y=v.colspan,m=v.isHidden,w=v.isPlaceholder;if(w||m)te(s,"hiddenHeader");else if(y>1){var S,C,k=h._wt.wtOverlays,O=(S=k.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),W=(C=k.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),Y=O||W?Math.min(y,a-l):y;Y>1&&s.setAttribute("colspan",Y)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=kt(this,Bt).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=kt(this,Bt).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=kt(this,Bt).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===Lv){if(!d)return l.columnIndex}else f===lb&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,y=c-d+1;if(f>=0||y===1)break;for(var m=c;m<=d;m++)for(var w=f;w<=h;w++){var S,C=v+w,k=m-c;if(k!==0){var O=(S=kt(this,Bt).getHeaderTreeNodeData(w,m))===null||S===void 0?void 0:S.isRoot;O===!1&&(o[C][k]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(Lm(o)||ki(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),y=h.from;l.column=!0,l.cell=!0;var m=[];i.col<y.col?m.push(v.col,f):i.col>y.col?m.push(d.col,f+c-1):m.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<kt(this,Bt).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=kt(this,Bt).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=kt(this,Bt).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),wr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?kt(this,Bt).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=kt(this,Bt).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ky(this,Bt,null),kt(this,ii)!==null&&(kt(this,ii).unsubscribe(),Ky(this,ii,null)),$a(Io(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return kt(this,Bt).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return NL}},{key:"PLUGIN_PRIORITY",get:function(){return FUe}}]),r}(ot);function HL(e){return zUe(e)||UUe(e)||WUe(e)||VUe()}function VUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WUe(e,t){if(e){if(typeof e=="string")return zR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zR(e,t)}}function UUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zUe(e){if(Array.isArray(e))return zR(e)}function zR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function YUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KUe(n.key),n)}}function GUe(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KUe(e){var t=qUe(e,"string");return ff(t)==="symbol"?t:String(t)}function qUe(e,t){if(ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XUe=function(){function e(t,r){YUe(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return GUe(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&A(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&A(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return ze(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(A(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||ff(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Ce(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),Ce(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];A(o,function(l){a.push(i.getDataObject(l))}),A(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(HL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(HL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const ZUe=XUe;function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}function jL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JUe(n.key),n)}}function QUe(e,t,r){return t&&jL(e.prototype,t),r&&jL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JUe(e){var t=eze(e,"string");return zd(t)==="symbol"?t:String(t)}function eze(e,t){if(zd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var rze=QUe(function e(t,r){tze(this,e),this.hot=r,this.plugin=t});const ik=rze;function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function nze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ize(n.key),n)}}function oze(e,t,r){return t&&FL(e.prototype,t),r&&FL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ize(e){var t=aze(e,"string");return cf(t)==="symbol"?t:String(t)}function aze(e,t){if(cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YR(e,t)}function YR(e,t){return YR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YR(e,t)}function sze(e){var t=cze();return function(){var n=Zp(e),o;if(t){var i=Zp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uze(this,o)}}function uze(e,t){if(t&&(cf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fze(e)}function fze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zp(e){return Zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zp(e)}var hze=function(e){lze(r,e);var t=sze(r);function r(n,o){var i;return nze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return oze(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(A(c,function(y){y&&u.removeChild(y)}),te(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Ce(0,l-1,function(){var y=h.createElement("SPAN");te(y,r.CSS_CLASSES.emptyIndicator),u.appendChild(y)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");te(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(ik);const pY=hze;function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function BL(e){return gze(e)||yze(e)||vze(e)||dze()}function dze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vze(e,t){if(e){if(typeof e=="string")return GR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GR(e,t)}}function yze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gze(e){if(Array.isArray(e))return GR(e)}function GR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bze(n.key),n)}}function mze(e,t,r){return t&&VL(e.prototype,t),r&&VL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bze(e){var t=wze(e,"string");return hf(t)==="symbol"?t:String(t)}function wze(e,t){if(hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KR(e,t)}function KR(e,t){return KR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KR(e,t)}function Cze(e){var t=Rze();return function(){var n=Qp(e),o;if(t){var i=Qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _ze(this,o)}}function _ze(e,t){if(t&&(hf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oze(e)}function Oze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qp(e)}var Eze=function(e){Sze(r,e);var t=Cze(r);function r(n,o){var i;return pze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),A(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){Ce(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return mze(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&A(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,BL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&A(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,BL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&A(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,pY.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),bn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(ik);const Tze=Eze;function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function Pze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$ze(n.key),n)}}function kze(e,t,r){return t&&WL(e.prototype,t),r&&WL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ze(e){var t=Aze(e,"string");return df(t)==="symbol"?t:String(t)}function Aze(e,t){if(df(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ize(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qR(e,t)}function qR(e,t){return qR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qR(e,t)}function Mze(e){var t=Dze();return function(){var n=Jp(e),o;if(t){var i=Jp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xze(this,o)}}function xze(e,t){if(t&&(df(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mY(e)}function mY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jp(e){return Jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jp(e)}var UL=new WeakMap,Nze=function(e){Ize(r,e);var t=Mze(r);function r(n,o){var i;return Pze(this,r),i=t.call(this,n,o),UL.set(mY(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return kze(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(aP)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(lP)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,o.items.length-1,function(l){if(l===0)return A(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=UL.get(this);return Ce(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(ik);const Hze=Nze;function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}var zL;function YL(e){return Bze(e)||Fze(e)||jze(e)||Lze()}function Lze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jze(e,t){if(e){if(typeof e=="string")return XR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XR(e,t)}}function Fze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bze(e){if(Array.isArray(e))return XR(e)}function XR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vze(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Wze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zze(n.key),n)}}function Uze(e,t,r){return t&&GL(e.prototype,t),r&&GL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zze(e){var t=Yze(e,"string");return Yd(t)==="symbol"?t:String(t)}function Yze(e,t){if(Yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gze=function(){function e(t){Wze(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return Uze(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(m){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(m);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),y=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,y),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return mt(i)&&(bt(dt(zL||(zL=Vze([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,YL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,YL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function Kze(e){return Qze(e)||Zze(e)||Xze(e)||qze()}function qze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xze(e,t){if(e){if(typeof e=="string")return ZR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZR(e,t)}}function Zze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qze(e){if(Array.isArray(e))return ZR(e)}function ZR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tYe(n.key),n)}}function eYe(e,t,r){return t&&KL(e.prototype,t),r&&KL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tYe(e){var t=rYe(e,"string");return vf(t)==="symbol"?t:String(t)}function rYe(e,t){if(vf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aa(){return typeof Reflect<"u"&&Reflect.get?Aa=Reflect.get.bind():Aa=function(t,r,n){var o=nYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Aa.apply(this,arguments)}function nYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mo(e),e!==null););return e}function oYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QR(e,t)}function QR(e,t){return QR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QR(e,t)}function iYe(e){var t=lYe();return function(){var n=Mo(e),o;if(t){var i=Mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aYe(this,o)}}function aYe(e,t){if(t&&(vf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bY(e)}function bY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mo(e)}var ZS="nestedRows",sYe=300,no=new WeakMap,uYe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",fYe=function(e){oYe(r,e);var t=iYe(r);function r(n){var o;return Jze(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,no.set(bY(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return eYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ZS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Mv),this.dataManager=new ZUe(this,this.hot),this.collapsingUI=new Tze(this,this.hot),this.headersUI=new pY(this,this.hot),this.contextMenuUI=new Hze(this,this.hot),this.rowMoveController=new Gze(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),Aa(Mo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Aa(Mo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),Aa(Mo(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=no.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=no.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=no.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=no.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=no.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=no.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=no.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,Kze(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=no.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){Aa(Mo(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!_U(o)){DE(uYe),this.hot.getSettings()[ZS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return ZS}},{key:"PLUGIN_PRIORITY",get:function(){return sYe}}]),r}(ot);function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}function cYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dYe(n.key),n)}}function hYe(e,t,r){return t&&qL(e.prototype,t),r&&qL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dYe(e){var t=vYe(e,"string");return Gd(t)==="symbol"?t:String(t)}function vYe(e,t){if(Gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yYe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;cYe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return hYe(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;A(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const gYe=yYe;function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function pYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bYe(n.key),n)}}function mYe(e,t,r){return t&&XL(e.prototype,t),r&&XL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bYe(e){var t=wYe(e,"string");return yf(t)==="symbol"?t:String(t)}function wYe(e,t){if(yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ia(){return typeof Reflect<"u"&&Reflect.get?Ia=Reflect.get.bind():Ia=function(t,r,n){var o=SYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ia.apply(this,arguments)}function SYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xo(e),e!==null););return e}function CYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JR(e,t)}function JR(e,t){return JR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JR(e,t)}function _Ye(e){var t=EYe();return function(){var n=xo(e),o;if(t){var i=xo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return OYe(this,o)}}function OYe(e,t){if(t&&(yf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RYe(e)}function RYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xo(e){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xo(e)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");var ZL="persistentState",TYe=0,PYe=function(e){CYe(r,e);var t=_Ye(r);function r(n){var o;return pYe(this,r),o=t.call(this,n),o.storage=void 0,o}return mYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ZL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new gYe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Ia(xo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Ia(xo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ia(xo(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Ia(xo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ZL}},{key:"PLUGIN_PRIORITY",get:function(){return TYe}}]),r}(ot);function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function kYe(e){return MYe(e)||IYe(e)||AYe(e)||$Ye()}function $Ye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AYe(e,t){if(e){if(typeof e=="string")return e0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e0(e,t)}}function IYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MYe(e){if(Array.isArray(e))return e0(e)}function e0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NYe(n.key),n)}}function DYe(e,t,r){return t&&QL(e.prototype,t),r&&QL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NYe(e){var t=HYe(e,"string");return gf(t)==="symbol"?t:String(t)}function HYe(e,t){if(gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ma(){return typeof Reflect<"u"&&Reflect.get?Ma=Reflect.get.bind():Ma=function(t,r,n){var o=LYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ma.apply(this,arguments)}function LYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Do(e),e!==null););return e}function jYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t0(e,t)}function t0(e,t){return t0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},t0(e,t)}function FYe(e){var t=WYe();return function(){var n=Do(e),o;if(t){var i=Do(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BYe(this,o)}}function BYe(e,t){if(t&&(gf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VYe(e)}function VYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Do(e){return Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Do(e)}var QS="search",UYe=190,zYe="htSearchResult",YYe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},GYe=function(t,r,n){return mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||mt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},KYe=function(e){jYe(r,e);var t=FYe(r);function r(n){var o;return xYe(this,r),o=t.call(this,n),o.callback=YYe,o.queryMethod=GYe,o.searchResultClass=zYe,o}return DYe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[QS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[QS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),Ma(Do(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),Ma(Do(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ma(Do(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Ce(0,s-1,function(h){Ce(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),y=i.hot.getCellMeta(h,d),m=y.search.callback||a,w=y.search.queryMethod||l,S=w(o,v,y);if(S){var C={row:h,col:d,data:v};f.push(C)}m&&m(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ue(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,kYe(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){Ma(Do(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return QS}},{key:"PLUGIN_PRIORITY",get:function(){return UYe}}]),r}(ot);function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function qYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZYe(n.key),n)}}function XYe(e,t,r){return t&&JL(e.prototype,t),r&&JL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZYe(e){var t=QYe(e,"string");return pf(t)==="symbol"?t:String(t)}function QYe(e,t){if(pf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fs(){return typeof Reflect<"u"&&Reflect.get?fs=Reflect.get.bind():fs=function(t,r,n){var o=JYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fs.apply(this,arguments)}function JYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pi(e),e!==null););return e}function eGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r0(e,t)}function r0(e,t){return r0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},r0(e,t)}function tGe(e){var t=oGe();return function(){var n=Pi(e),o;if(t){var i=Pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rGe(this,o)}}function rGe(e,t){if(t&&(pf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nGe(e)}function nGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pi(e)}var iGe="touchScroll",aGe=200,lGe=function(e){eGe(r,e);var t=tGe(r);function r(n){var o;return qYe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return XYe(r,[{key:"isEnabled",value:function(){return TE()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),fs(Pi(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,fs(Pi(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){fs(Pi(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,A(this.clones,function(o){te(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,A(this.clones,function(i){Le(i,"hide-tween"),te(i,"show-tween")}),this.hot._registerTimeout(function(){A(o.clones,function(i){Le(i,"show-tween")})},400),A(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return iGe}},{key:"PLUGIN_PRIORITY",get:function(){return aGe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ot);function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function sGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ej(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fGe(n.key),n)}}function uGe(e,t,r){return t&&ej(e.prototype,t),r&&ej(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fGe(e){var t=cGe(e,"string");return mf(t)==="symbol"?t:String(t)}function cGe(e,t){if(mf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xa(){return typeof Reflect<"u"&&Reflect.get?xa=Reflect.get.bind():xa=function(t,r,n){var o=hGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xa.apply(this,arguments)}function hGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=No(e),e!==null););return e}function dGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n0(e,t)}function n0(e,t){return n0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},n0(e,t)}function vGe(e){var t=pGe();return function(){var n=No(e),o;if(t){var i=No(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yGe(this,o)}}function yGe(e,t){if(t&&(mf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gGe(e)}function gGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function No(e){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},No(e)}var qy="trimRows",mGe=330,bGe=function(e){dGe(r,e);var t=vGe(r);function r(n){var o;return sGe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return uGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Mv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),xa(No(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[qy];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),xa(No(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),xa(No(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(A(o,function(c){s[c]=!1}),l=jt(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[qy];Array.isArray(i)&&this.hot.batchExecution(function(){A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){xa(No(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return qy}},{key:"PLUGIN_PRIORITY",get:function(){return mGe}}]),r}(ot);function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function wY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wGe(n.key),n)}}function SY(e,t,r){return t&&tj(e.prototype,t),r&&tj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wGe(e){var t=SGe(e,"string");return bf(t)==="symbol"?t:String(t)}function SGe(e,t){if(bf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o0(e,t)}function o0(e,t){return o0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o0(e,t)}function _Y(e){var t=OGe();return function(){var n=em(e),o;if(t){var i=em(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CGe(this,o)}}function CGe(e,t){if(t&&(bf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ge(e)}function _Ge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function em(e){return em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},em(e)}function RGe(e){return PGe(e)||TGe(e)||RY(e)||EGe()}function EGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PGe(e){if(Array.isArray(e))return i0(e)}function OY(e,t){return AGe(e)||$Ge(e,t)||RY(e,t)||kGe()}function kGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RY(e,t){if(e){if(typeof e=="string")return i0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i0(e,t)}}function i0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Ge(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function AGe(e){if(Array.isArray(e))return e}var EY="undoRedo",IGe="undoRedo";function ye(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=OY(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(RGe(h)),c},[]);A(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ye.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ye.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=fr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ye.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ye.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Ce(s.length-1,function(y){var m=[],w=s[y];Ce(u,u+(n-1),function(S){m.push(w[e.toPhysicalColumn(S)])}),f.push(m)}),Ce(n-1,function(y){h.push(e.toPhysicalColumn(u+y))}),Array.isArray(e.getSettings().colHeaders)&&Ce(n-1,function(y){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+y)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ye.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ye.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ye.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ye.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ye.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ye.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ye.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ye.prototype.isEnabled=function(){return this.enabled};ye.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,DGe(e),this.registerShortcuts(),e.addHook("afterChange",TY)}};ye.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,NGe(e),this.unregisterShortcuts(),e.removeHook("afterChange",TY)}};ye.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ye.Action=function(){};ye.Action.prototype.undo=function(){};ye.Action.prototype.redo=function(){};ye.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Go(ye.ChangeAction,ye.Action);ye.ChangeAction.prototype.undo=function(e,t){for(var r=fr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=OY(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ye.ChangeAction.prototype.redo=function(e,t){for(var r=fr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ye.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Go(ye.CreateRowAction,ye.Action);ye.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ye.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ye.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Go(ye.RemoveRowAction,ye.Action);ye.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ye.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ye.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Go(ye.CreateColumnAction,ye.Action);ye.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ye.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ye.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Go(ye.RemoveColumnAction,ye.Action);ye.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(We(this.data[s],i));var u=We(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(e.getSourceDataArray(),function(c,h){A(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&A(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ye.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ye.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ye.CellAlignmentAction.prototype.undo=function(e,t){var r=this;A(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ye.CellAlignmentAction.prototype.redo=function(e,t){li(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Go(ye.FiltersAction,ye.Action);ye.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ye.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var MGe=function(e){CY(r,e);var t=_Y(r);function r(n,o){var i;wY(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return SY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ye.Action);ye.MergeCellsAction=MGe;var xGe=function(e){CY(r,e);var t=_Y(r);function r(n,o){var i;return wY(this,r),i=t.call(this),i.cellRange=o,i}return SY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ye.Action);ye.UnmergeCellsAction=xGe;ye.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Go(ye.RowMoveAction,ye.Action);ye.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ye.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ye.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ye.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:EY};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ye.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(EY)};function TY(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function DGe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function NGe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Fv=ge.getSingleton();Fv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Fv.register("beforeUndo");Fv.register("afterUndo");Fv.register("beforeRedo");Fv.register("afterRedo");ye.PLUGIN_KEY=IGe;ye.SETTING_KEYS=!0;function HGe(){tt(YSe),tt(gCe),tt(xCe),tt(T_e),tt(Y_e),tt(Z2),tt(xRe),tt(y0e),tt(ZU),tt(xAe),tt(lIe),tt(mIe),tt(uz),tt(CMe),tt(mLe),tt(mje),tt(Wje),tt(vFe),tt(HFe),tt(RBe),tt(NBe),tt(OVe),tt(DVe),tt(MWe),tt(e2e),tt(d2e),tt(BUe),tt(fYe),tt(PYe),tt(KYe),tt(lGe),tt(bGe),tt(ye)}function PY(){Mfe(),Zfe(),gce(),Hce(),HGe()}var LGe=$e,jGe=je,FGe=um.f,BGe=jGe(function(){return!Object.getOwnPropertyNames(1)});LGe({target:"Object",stat:!0,forced:BGe},{getOwnPropertyNames:FGe});fn(IW);Te.editors={BaseEditor:$f};function Te(e,t){var r=new KP(e,t||{},WP);return r.init(),r}Te.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new KP(e,t,WP)};Te.DefaultSettings=FU();Te.hooks=ge.getSingleton();Te.CellCoords=lp;Te.CellRange=oT;Te.packageName="handsontable";Te.buildDate="22/06/2023 12:51:08";Te.version="13.0.0";Te.languages={dictionaryKeys:i0e,getLanguageDictionary:$U,getLanguagesDictionaries:iPe,registerLanguageDictionary:kU,getTranslatedPhrase:AU};function VGe(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var l,s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];a=(l=o[r]).call.apply(l,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var JS,eC,tC,rC,nC;PY();VGe(Te);Te.__GhostTable=rT;Te._getListenersCounter=Wle;Te._getRegisteredMapsCounter=qwe;Te.EventManager=Pt;var WGe=[Aoe,oie,LTe,lce,Uie,Sle,Doe,Ose,eie,Sae,lie,yTe],UGe=[Iae,sie];Te.helper={};Te.dom={};A(WGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.helper[t]=e[t])})});A(UGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.dom[t]=e[t])})});Te.cellTypes=(JS=Te.cellTypes)!==null&&JS!==void 0?JS:{};A(Nce(),function(e){Te.cellTypes[e]=JE(e)});Te.cellTypes.registerCellType=fn;Te.cellTypes.getCellType=JE;Te.editors=(eC=Te.editors)!==null&&eC!==void 0?eC:{};A(Dle(),function(e){Te.editors["".concat(ur(e),"Editor")]=tp(e)});Te.editors.registerEditor=Pr;Te.editors.getEditor=tp;Te.renderers=(tC=Te.renderers)!==null&&tC!==void 0?tC:{};A(Xfe(),function(e){var t=ap(e);e==="base"&&(Te.renderers.cellDecorator=t),Te.renderers["".concat(ur(e),"Renderer")]=t});Te.renderers.registerRenderer=Nn;Te.renderers.getRenderer=ap;Te.validators=(rC=Te.validators)!==null&&rC!==void 0?rC:{};A(yce(),function(e){Te.validators["".concat(ur(e),"Validator")]=QE(e)});Te.validators.registerValidator=ql;Te.validators.getValidator=QE;Te.plugins=(nC=Te.plugins)!==null&&nC!==void 0?nC:{};A(tT(),function(e){Te.plugins[e]=$v(e)});Te.plugins["".concat(ur(ot.PLUGIN_KEY),"Plugin")]=ot;Te.plugins.registerPlugin=tt;Te.plugins.getPlugin=$v;const rj="selected",nj="odd",zGe=(e,t,r,n,o,i)=>{if(r!==0)return;const a=e.parentElement;if(a===null)return;i.instance.getSourceDataAtRow(t).checked?Te.dom.addClass(a,rj):Te.dom.removeClass(a,rj),t%2===0?Te.dom.addClass(a,nj):Te.dom.removeClass(a,nj)},YGe=function(t,r){const n=document.createElement("input"),o=this.getSourceDataAtRow(t);n.type="checkbox",n.checked=!!o.checked,Te.dom.empty(r),r.appendChild(n)};function GGe(e,t,r){if(t<0||!r.firstChild)return;const n=e.isRtl()?"htRight":"htLeft";Te.dom.addClass(r.firstChild,n)}const KGe=function(t,r){const n=t.target;r.col===-1&&t.target&&n.nodeName==="INPUT"&&(t.preventDefault(),this.setSourceDataAtCell(r.row,"checked",!n.checked))},qGe=(...e)=>{const[t,r,n,o,i,a,l]=e;Af(...e),a?r.innerHTML='<div class="circle critical"></div>':r.innerHTML='<div class="circle"></div>'};var cs=Symbol("unassigned"),XGe="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function tm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function kY(e){var t=Te.hooks.getRegistered(),r={};Object.assign(r,Te.DefaultSettings);for(var n in r)r[n]={default:cs};for(var o=0;o<t.length;o++)r[t[o]]={default:cs};return r.settings={default:cs},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function $Y(e){var t={},r=e.settings;if(r!==cs)for(var n in r)tm(r,n)&&r[n]!==cs&&(t[n]=r[n]);for(var o in e)tm(e,o)&&o!=="settings"&&e[o]!==cs&&(t[o]=e[o]);return t}function oj(e,t){var r=$Y(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)tm(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!ij(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)tm(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!ij(t[l],o[l]))&&(i[l]=o[l]);return i}function ij(e,t){return JSON.stringify(e)===JSON.stringify(t)}var ZGe="13.0.0",ak=sj({name:"HotTable",props:kY("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=oj(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(XGe),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=oj(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=NY(new Te.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:ZGe}),QGe=["id"];function JGe(e,t,r,n,o,i){return zl(),_c("div",{id:e.id},[HY(e.$slots,"default")],8,QGe)}ak.render=JGe;ak.__file="src/HotTable.vue";function aj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function e3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aj(Object(r),!0).forEach(function(n){t3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function t3e(e,t,r){return t=n3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r3e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function n3e(e){var t=r3e(e,"string");return typeof t=="symbol"?t:String(t)}var $t=sj({name:"HotColumn",props:kY("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=$Y(this.$props),r=e3e({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});$t.__file="src/HotColumn.vue";const oC={__name:"Table",props:["tableOptions"],setup(e){const t=e;PY();const r=oa(()=>GGe),n=oa(()=>zGe),o=oa(()=>YGe),i=oa(()=>KGe),a=oa(()=>t.tableOptions.data),l=oa(()=>qGe);return(s,u)=>(zl(),LY(ht(ak),{data:a.value,style:{width:"100%"},height:400,colWidths:e.tableOptions.colWidths,colHeaders:e.tableOptions.colHeaders,dropdownMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:r.value,beforeRenderer:n.value,afterGetRowHeader:o.value,afterOnCellMouseDown:i.value,manualRowMove:!0,readOnly:!0,licenseKey:"non-commercial-and-evaluation"},{default:xn(()=>[e.tableOptions.tableName=="one"?(zl(),_c(gb,{key:0},[rt(ht($t),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),rt(ht($t),{data:"Code"}),rt(ht($t),{data:"Name"}),rt(ht($t),{data:"Duration(Baseline)"}),rt(ht($t),{data:"Duration(New)"}),rt(ht($t),{data:"Ratio"})],64)):pb("",!0),e.tableOptions.tableName=="two"?(zl(),_c(gb,{key:1},[rt(ht($t),{data:"ID",style:{display:"flex","justify-content":"center"}}),rt(ht($t),{data:"Code"}),rt(ht($t),{data:"Type"}),rt(ht($t),{data:"Name"}),rt(ht($t),{data:"Distribution"}),rt(ht($t),{data:"Max"}),rt(ht($t),{data:"Span"})],64)):pb("",!0),e.tableOptions.tableName=="three"?(zl(),_c(gb,{key:2},[rt(ht($t),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),rt(ht($t),{data:"Task Code"}),rt(ht($t),{data:"Resource Name"}),rt(ht($t),{data:"Task Name"}),rt(ht($t),{data:"Duration(Old)"}),rt(ht($t),{data:"Duration(New)"}),rt(ht($t),{data:"Units(Old)"}),rt(ht($t),{data:"Units(New)"}),rt(ht($t),{data:"Total Planned Units"})],64)):pb("",!0)]),_:1},8,["data","colWidths","colHeaders","afterGetColHeader","beforeRenderer","afterGetRowHeader","afterOnCellMouseDown"]))}};const AY=e=>(UY("data-v-ba0c69ec"),e=e(),zY(),e),o3e={class:"optimize-content"},i3e={class:"content-row"},a3e={style:{"text-transform":"capitalize",color:"rgba(130, 181, 199, 0.9)"}},l3e={class:"chip primary"},s3e={class:"chip primary"},u3e={class:"content-box"},f3e={class:"sub-content"},c3e=WY('<div class="content-row" data-v-ba0c69ec><h3 data-v-ba0c69ec>Changed Tasks (Overview)</h3></div><div class="legend" data-v-ba0c69ec><div style="display:flex;justify-content:flex-start;align-items:center;margin-right:10px;" data-v-ba0c69ec><div class="circle critical" data-v-ba0c69ec></div> Critical </div><div style="display:flex;justify-content:flex-start;align-items:center;" data-v-ba0c69ec><div class="circle" data-v-ba0c69ec></div> Non-Critical </div></div>',2),h3e={class:"table"},d3e={class:"sub-content"},v3e=AY(()=>Zt("div",{class:"content-row"},[Zt("h3",null,"All Resources")],-1)),y3e={class:"table"},g3e={class:"sub-content"},p3e=AY(()=>Zt("div",{class:"content-row"},[Zt("h3",null,"Task-Resources")],-1)),m3e={class:"table"},b3e={class:"content-row"},w3e={__name:"index",setup(e){let t=mb(!1);const r=FY();function n(){let v=`${l.SummaryData.group}-${l.file.name.split(".")[0]}_FrontlineExport.${l.file.name.split(".")[1]}`;vk.getProjectReport(v,l.truefile)}function o(){let v=`${l.SummaryData.group}-${l.file.name.split(".")[0]}_FrontlineExport.${l.file.name.split(".")[1]}`;vk.getExcelReport(v,l.truefile)}function i(){r.push({name:"optimizedSummary"}),l.active=2}BY((v,y)=>{v.name=="InputData"&&a()});function a(){l.taskData=[],Object.keys(l.dataArray).forEach(v=>{l.dataArray[v].all=[],l.dataArray[v].data=[]})}const l=VY();let s=l.selectedData.tasks.map(v=>(v.critical?v.critical=!0:v.critical=!1,{Critical:v.critical,Code:v.ID,Name:v.name,"Duration(Baseline)":v.remainingDuration,"Duration(New)":v.newDuration,Ratio:v.durationRatio.toFixed(2)})),u=l.selectedData.newResources.map(v=>({ID:v.id,Code:v.ID,Type:v.type,Name:v.name,Distribution:v.distribution.min,Max:v.distribution.max,Span:v.distribution.span})),f=oa(()=>l.selectedData.tasks.filter(m=>Object.keys(m.resources).length!==0).flatMap(m=>{let w=Object.values(m.resources),S=l.selectedData.tasks.find(C=>C.id==m.id);return w.map(C=>{var k;return{Critical:S.critical,"Task Code":S.ID,"Resource Name":(k=l.selectedData.newResources.find(O=>O.id==C.resourceId))==null?void 0:k.name,"Task Name":S.name,"Duration(Old)":S.plannedDuration,"Duration(New)":S.newDuration,"Units(Old)":C.plannedUnitsPerHour.toFixed(2),"Units(New)":Number(C.newUnitsPerHour).toFixed(2),"Total Planned Units":C.remainingUnits}})}));mb(null),mb({one:[{title:{text:"Duration (days)"},xAxis:{name:"asfdfsda"},yAxis:{},series:[{type:"scatter",data:[[10,5],[0,8],[6,10],[2,12],[8,9]]}]},{xAxis:{},yAxis:{},series:[{type:"scatter",data:[[10,5],[0,8],[6,10],[2,12],[8,9]]}]}],two:[{xAxis:{axisLabel:{text:"Optimization steps"}},yAxis:{},series:[{type:"scatter",data:[[10,5],[0,8],[6,10],[2,12],[8,9]]}]},{xAxis:{},yAxis:{},series:[{type:"scatter",data:[[10,5],[0,8],[6,10],[2,12],[8,9]]}]}]});const c=bb({data:s,colWidths:[100,245,250,150,170,170],colHeaders:["Critical","Code","Name","Duration(Baseline)","Duration(New)","Ratio"],tableName:"one"}),h=bb({data:u,colWidths:[100,245,250,250,100,200,100,100],colHeaders:["ID","Code","Type","Name","Distribution","Max","Span"],tableName:"two"}),d=bb({data:f.value,colWidths:[100,245,250,150,110,110,110,110,150],colHeaders:["Critical","Task Code","Resource Name","Task Name","Duration(Old)","Duration(New)","Units(Old)","Units(New)","Total Planned Units"],tableName:"three"});return(v,y)=>{const m=YY,w=Lf("v-card-text"),S=Lf("v-btn"),C=Lf("v-card-actions"),k=Lf("v-card"),O=Lf("v-dialog");return zl(),_c("div",o3e,[Zt("div",i3e,[Zt("h2",null,[ji(" Detailed ReportÂ  "),Zt("span",a3e,wb(ht(l).SummaryData.group),1),Zt("div",l3e,[Zt("small",null,wb(ht(l).setting.Steps)+" steps",1)]),Zt("div",s3e,[Zt("small",null,wb(`${ht(l).setting.Ratio[0]*100}% - ${ht(l).setting.Ratio[1]*100}% ratio`),1)])]),rt(m,{onClick:y[0]||(y[0]=()=>{Sb(t)?t.value=!0:t=!0}),class:"row-btn"},{default:xn(()=>[ji("Export Report")]),_:1})]),Zt("div",u3e,[Zt("div",f3e,[c3e,Zt("div",h3e,[rt(oC,{tableOptions:c},null,8,["tableOptions"])])]),Zt("div",d3e,[v3e,Zt("div",y3e,[rt(oC,{tableOptions:h},null,8,["tableOptions"])])]),Zt("div",g3e,[p3e,Zt("div",m3e,[rt(oC,{tableOptions:d},null,8,["tableOptions"])])])]),Zt("div",b3e,[rt(m,{onClick:i,class:"back"},{default:xn(()=>[ji("BACK")]),_:1}),rt(m,{onClick:y[1]||(y[1]=()=>{Sb(t)?t.value=!0:t=!0}),class:"report"},{default:xn(()=>[ji("Export Report")]),_:1})]),rt(O,{modelValue:ht(t),"onUpdate:modelValue":y[4]||(y[4]=W=>Sb(t)?t.value=W:t=W),width:"auto"},{default:xn(()=>[rt(k,{style:{"border-radius":"50px",width:"400px"}},{default:xn(()=>[rt(w,{style:{"text-align":"center"}},{default:xn(()=>[ji(" Export Optimized File ")]),_:1}),rt(C,{style:{"justify-content":"center"}},{default:xn(()=>[rt(S,{color:"rgb(64, 170, 151)",onClick:y[2]||(y[2]=()=>{n()})},{default:xn(()=>[ji("Original Format")]),_:1}),rt(S,{color:"rgb(64, 170, 151)",onClick:y[3]||(y[3]=()=>{o()})},{default:xn(()=>[ji("EXCEL")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},E3e=jY(w3e,[["__scopeId","data-v-ba0c69ec"]]);export{E3e as default};
