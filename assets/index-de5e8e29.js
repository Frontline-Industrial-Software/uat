import{$ as z,s as C,v as F,B as te,C as V,x as o,Z as v,A as r,aW as ae,aQ as ne,aZ as ie,b4 as re,b5 as se,Q as L,ap as oe,w as M,aU as N,D as $,b1 as le,ar as P,as as W,bb as de,z as ue}from"./index-2f9623ee.js";import{a as ce,E as me}from"./el-overlay-a51abdfe.js";import{C as O}from"./index-a76f5aa3.js";import{e as pe,c as fe}from"./index-f7adadce.js";import"./index-840e8203.js";import{V as he}from"./index.min-71e4b107.js";const ye=o("span",{class:"dialog-footer"},null,-1),ve={__name:"dialog",props:["dialogVisible","data"],emits:["closeDialog"],setup(Z,{emit:i}){const m=Z;let I=z();async function B(){he.preview(I.value,`

`+U.value)}function _(u){if(!u)return"0.00";var u=Math.round(parseFloat(u)*100)/100,c=u.toString().split(".");if(c.length==1)return u=u.toString()+".00",u;if(c.length>1)return c[1].length<2&&(u=u.toString()+"0"),u}C(()=>m.dialogVisible);function A(S,u=0){let c=`
`;const b=g=>"  ".repeat(g);for(const[g,w]of Object.entries(S))typeof w=="object"&&w!==null?(c+=`${b(u)}- **${g}**
`,c+=A(w,u+1)):c+=`${b(u)}- ${g}: ${w}
`;return c}function y(S){return new Date(S).toISOString()}let U=C(()=>{let S=()=>{let c="";for(const b in m.data.resources){const g=m.data.resources[b];c+=`The resource with ID ${g.resourceId} was originally planned to have ${_(g.plannedUnits)} units. The initial planned usage rate was ${_(g.plannedUnitsPerHour)} units per hour, and it currently remains at ${_(g.Units)} units per hour. However, after optimization, the new usage rate is ${_(g.newUnitsPerHour)} units per hour, and the new daily usage is ${_(g.newUnitsPerDay)} units per day.
`}return c};return`This is a task named '${m.data.name}' categorized as '${m.data.type}', and it is ${m.data.critical==!0?"":"not"} a Critical Task.
   Before optimization,
   it is scheduled to start on ${y(m.data.plannedStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${y(m.data.plannedFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${m.data.remainingDuration} hours. 
  After optimization,
   it is scheduled to start on ${y(m.data.newStart).replace("T"," ").replace("Z","").slice(0,16)} (date) and finish on ${y(m.data.newFinish).replace("T"," ").replace("Z","").slice(0,16)} (date), with an estimated duration of ${m.data.newDuration} hours. 
Resources:
${S()}As of now, the task has not commenced and is labeled as '${m.data.status}.' The task's duration ratio is ${_(m.data.durationRatio)}.`+A(m.data)});const E=()=>{i("closeDialog")};return(S,u)=>{const c=ce;return F(),te(c,{onOpen:B,onClose:E,modelValue:m.dialogVisible,"onUpdate:modelValue":u[0]||(u[0]=b=>m.dialogVisible=b),title:"Detailed content",width:"50%",draggable:""},{footer:V(()=>[ye]),default:V(()=>[o("span",null,v(r(U).id),1),o("div",{ref_key:"editorRef",ref:I},null,512)]),_:1},8,["modelValue"])}}};const ge={class:"contain"},be={class:"box"},we={class:"sp"},Se={class:"step"},De={class:"step"},xe={class:"maintop"},$e={class:"mainEchar1"},_e={class:"Echar1top"},Ce=de('<div class="choosebox" data-v-09e9fd51><div class="choose" data-v-09e9fd51><div style="background-color:#b0e054;" class="item" data-v-09e9fd51></div><div data-v-09e9fd51>Optimized</div></div><div class="choose" data-v-09e9fd51><div style="background-color:#5474c4;" class="item" data-v-09e9fd51></div><div data-v-09e9fd51>Baseline</div></div><div class="choose" data-v-09e9fd51><div style="background-color:red;" class="item" data-v-09e9fd51></div><div data-v-09e9fd51>Critical Path</div></div><div class="choose" data-v-09e9fd51><div style="background-color:pink;" class="item" data-v-09e9fd51></div><div data-v-09e9fd51>Critical Path(baseline)</div></div></div><div id="main" data-v-09e9fd51></div>',2),Ie={ref:"main",style:{width:"1350px",height:"610px"},id:"myEcharts"},Re={class:"mainEchar2"},ke={class:"Echar2top"},ze={class:"resources-title"},Fe={class:"types"},Ae={ref:"main01",style:{width:"1350px",height:"610px"},id:"myEcharts01"},Ue={class:"button"},Me={__name:"index",setup(Z){const i=ne(),m=ie();let I=z(!1),B=z("");const _=()=>{I.value=!1};re((t,a,n)=>{t.name=="InputData",n()}),se(()=>{i.selectChange&&(D.value="",g(),T(),i.selectChange=!1)});function A(t,a){return Math.round(t/a*1e4)/100+"%"}function y(t){return new Date(t).toISOString()}function U(t){const a=new Date(t);return`${a.getUTCFullYear()}/${a.getUTCMonth()+1}/${a.getUTCDate()} ${("0"+a.getUTCHours()).slice(-2)}:${("0"+a.getUTCMinutes()).slice(-2)}:${("0"+a.getUTCSeconds()).slice(-2)}`}const E=t=>t[0]===void 0||t[0].length===0?[]:t[0].xy.map(a=>{const[n,f]=Object.entries(a)[0];return{value:[y(parseInt(n)),f],name:y(parseInt(n))+f+t[1]}});let S=pe,u=z(2),c;C(()=>i.selectedData?i.selectedData.baselineTasks.filter(a=>a.critical):void 0);function b(t){return`<span >${t}</span>`}function g(){let t=[],a=i.selectedData.baselineTasks.map((e,d)=>{let p=i.selectedData.tasks.find(s=>s.id===e.id);p.old=e,t.push(p);function h(s){return s===1?1:s+(s-1)*4}return d=h(i.selectedData.baselineTasks.length-d),{name:e.name,value:[d,y(e.newStart),y(e.newFinish),e,{baseNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration},changeNew:{start:p.newStart,finish:p.newFinish,duration:p.newDuration}}],itemStyle:{color:e.critical?"pink":void 0}}});t=t.map((e,d)=>{function p(h){return h===2?2:h+(h-2)*4}return d=p(t.length-d+1),{id:e.id,name:e.name,value:[d,y(e.newStart),y(e.newFinish),e,{baseNew:{start:e.old.newStart,finish:e.old.newFinish,duration:e.old.newDuration},changeNew:{start:e.newStart,finish:e.newFinish,duration:e.newDuration}}],itemStyle:{color:e.critical?"red":void 0}}});let n=S.init(document.getElementById("myEcharts"),"purple-passion");n.on("click",function(e){B.value=e.data.value[3],I.value=!0});var f;let l=(e,d)=>{let p=d.coord([d.value(1),d.value(0)]),h=d.coord([d.value(2),d.value(0)]),s=d.size([0,1])[1];return{type:"rect",shape:fe({x:p[0],y:p[1]-s/2,width:Math.max(h[0]-p[0],1),height:s},e.coordSys),style:d.style(),focus:"self",blurScope:"coordinateSystem",emphasis:{}}},x;t.length<30?x=!0:x=!1,f={toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"weakFilter",xAxisIndex:[0],labelFormatter:function(e){return U(e)},moveHandleSize:15,height:15,moveHandleStyle:{}},{type:"slider",filterMode:"weakFilter",yAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",xAxisIndex:[0]},{type:"inside",filterMode:"weakFilter",yAxisIndex:[0]}],legend:{data:["baseline","new"]},xAxis:{name:"date",type:"time",boundaryGap:[0,0],axisTick:{show:!0,alignWithLabel:!0},minInterval:24*3600,max:function(e){return e.max+(e.max-e.min)*.01},min:function(e){return e.min-(e.max-e.min)*.01},axisLabel:{showMaxLabel:"true",showMinLabel:"true",formatter:function(e,d){return U(e)}}},yAxis:{name:"tasks"},selectedMode:"single",series:[{name:"baseline",type:"custom",data:a,large:!0,renderItem:l,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:x,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}},{name:"new",type:"custom",data:t,large:!0,renderItem:l,encode:{x:[1,2],y:0},label:{normal:{show:x,color:"black",position:"inside",formatter:function(e){return e.data.name},fontSize:12}}}],tooltip:{axisPointer:{},formatter:e=>{let d="Resources: <br/>";if(e.value[3].resources)for(const h in e.value[3].resources){let s=e.value[3].resources,k=i.selectedData.newResources.find(ee=>ee.id==h);k||(k=""),d+=` &nbsp&nbspResource &nbsp  ${k==null?void 0:k.name} &nbsp id: ${h}  <br/>&nbsp&nbsp&nbsp&nbspunits/hour:${H(s[h].plannedUnitsPerHour)}=> ${H(s[h].newUnitsPerHour)}<br/>`}function p(h){let s;switch(h){case"New":e.value[3].critical?s="red":s="#b0e054";break;case"Old":e.value[3].critical?s="pink":s="#5474c4"}return`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:${s};"></span>`}return`${e.name}<br/>
        <div style='margin-top:20px'>
         ${p("New")} New: ${b(y(e.value[4].changeNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${b(y(e.value[4].changeNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
         (${e.value[4].changeNew.duration})
        <br/>
         ${p("Old")} Old: ${b(y(e.value[4].baseNew.start).replace("T"," ").replace("Z","").slice(0,16))} -> ${b(y(e.value[4].baseNew.finish).replace("T"," ").replace("Z","").slice(0,16))}
       (${e.value[4].baseNew.duration})
         <br/>
         ${d}
        </div>`}}},f&&n.setOption(f);function R(e,d,p,h){h||(e.batch[0].end-e.batch[0].start<30/p.length*100?n.setOption({series:[{name:"baseline",type:"custom",data:d,large:!0,renderItem:l,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"new",type:"custom",data:p,large:!0,renderItem:l,encode:{x:[1,2],y:0},label:{normal:{show:!0,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}):n.setOption({series:[{name:"baseline",type:"custom",data:d,large:!0,renderItem:l,encode:{x:[1,2],y:0,labal:11},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}},{name:"new",type:"custom",data:p,large:!0,renderItem:l,encode:{x:[1,2],y:0},label:{normal:{show:!1,color:"black",position:"inside",formatter:function(s){return s.data.name},fontSize:12}}}]}))}n.off("datazoom"),n.on("datazoom",function(e){R(e,a,t,x)}),n.on("mousemove",function(e){n.dispatchAction({type:"highlight",dataIndex:e.dataIndex})}),c=S.init(document.getElementById("myEcharts01"),"purple-passion"),c.on("mousemove",function(e){c.dispatchAction({type:"highlight",name:e.name})}),c.on("click",function(e){c.dispatchAction({type:"select",name:e.name})})}let w=z("");function H(a){if(!a)return"0.00";var a=Math.round(parseFloat(a)*100)/100,n=a.toString().split(".");if(n.length==1)return a=a.toString()+".00",a;if(n.length>1)return n[1].length<2&&(a=a.toString()+"0"),a}function j(t,a){return t.reduce(function(n,f){let l=f[a];return n[l]||(n[l]=[]),n[l].push(f),n},{})}let Q=C(()=>{let t=i.selectedData.baselineResources.map(n=>({id:n.id,name:n.name,type:n.type})),a=j(t,"type");if(w.value){const n=new RegExp(w.value,"i");let f={};for(let l in a)f[l]=a[l].filter(x=>n.test(x.name));return f}else return a}),G=C(()=>{var n;const t=i.selectedData.baselineResources;let a="base";return D.value?[t.filter(l=>l.id&&l.id===D.value)[0].distribution,a]:t.length==0?[]:(D.value=t[0].id,[(n=t[0])==null?void 0:n.distribution,a])}),K=C(()=>{var n;const t=i.selectedData.newResources;let a="new";return D.value?[t.filter(l=>l.id&&l.id===D.value)[0].distribution,a]:t.length==0?[]:[(n=t[0])==null?void 0:n.distribution,a]}),Y=C(()=>({toolbox:{feature:{dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",filterMode:"none"},{type:"slider",filterMode:"none"},{type:"inside",filterMode:"none"},{type:"inside",filterMode:"none"}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},animation:!1,legend:{data:["baseline","new"]},xAxis:{name:"date",type:"time",axisLabel:{formatter:"{yyyy}-{MM}-{dd}"}},yAxis:{name:"units / day"},series:[{name:"baseline",type:"bar",data:E(G.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"self",blurScope:"coordinateSystem"}},{name:"new",type:"bar",data:E(K.value),large:!0,selectedMode:"single",select:{itemStyle:{color:"red",borderWidth:"5px"}},emphasis:{focus:"series",blurScope:"coordinateSystem"}}]}));function T(){c.setOption(Y.value)}L(u,()=>{T()});async function q(){m.push({name:"OptimizedReport"}),i.active=3}let D=z("");function J(){m.push({name:"BaselineSummary"}),i.active=1}function X(t){D.value=t}return L(D,()=>{T()}),(t,a)=>{const n=me,f=oe("v-btn");return F(),M(P,null,[o("div",ge,[o("div",be,[o("h2",null,[N(v(t.$t("optimizedSummary.title[0]"))+" ",1),o("span",we,v(r(i).SummaryData.group),1),o("div",Se,[o("span",null,v(r(i).setting.Steps)+" "+v(t.$t("optimizedSummary.title[1]")),1)]),o("div",De,[o("span",null,v(`${r(i).setting.Ratio[0]*100}% - ${r(i).setting.Ratio[1]*100}% ${t.$t("optimizedSummary.title[2]")}`),1)])]),o("div",xe,[$(O,{title:t.$t("optimizedSummary.header[0]"),height:180,precent:A(r(i).SummaryData.changedDuration-r(i).SummaryData.baseDuration,r(i).SummaryData.baseDuration),isPositive:!0,body:[r(i).SummaryData.changedDuration+" days",r(i).SummaryData.baseDuration+" days",r(i).SummaryData.planDurationDays+" days"]},null,8,["title","precent","body"]),$(O,{title:t.$t("baselineSummary.Tsidebar[1]"),height:180,precent:A(r(i).SummaryData.maxResourceUnit-r(i).SummaryData.BasemaxResourceUnit,r(i).SummaryData.BasemaxResourceUnit),isPositive:!1,body:[r(i).SummaryData.maxResourceUnit,r(i).SummaryData.BasemaxResourceUnit]},null,8,["title","precent","body"]),$(O,{title:t.$t("optimizedSummary.header[2]"),height:180,body:[r(i).SummaryData.changgedTasks,r(i).SummaryData.TotalTasks]},null,8,["title","body"]),$(O,{title:t.$t("optimizedSummary.header[3]"),height:180,body:[r(i).SummaryData.changedCriticalPath,r(i).SummaryData.changedCriticalPath,r(i).SummaryData.baseCriticalPath]},null,8,["title","body"])]),o("div",$e,[o("div",_e,[o("div",null,v(t.$t("optimizedSummary.chartName[0]")),1)]),o("span",null,v(t.$t("optimizedSummary.chartName[1]")),1),Ce,o("div",Ie,null,512)]),o("div",Re,[o("div",ke,[o("div",null,v(t.$t("optimizedSummary.chartName[2]")),1)]),o("span",null,v(t.$t("optimizedSummary.chartName[3]")),1),$(n,{modelValue:r(w),"onUpdate:modelValue":a[0]||(a[0]=l=>le(w)?w.value=l:w=l),placeholder:"Search Resources"},null,8,["modelValue"]),(F(!0),M(P,null,W(r(Q),(l,x)=>(F(),M("div",null,[o("div",ze,v(x)+" Resources",1),o("div",Fe,[(F(!0),M(P,null,W(l,(R,e)=>(F(),M("div",{key:e,class:"type"},[$(f,{variant:"text",value:e,class:ue({activeType:r(D)==R.id}),onClick:()=>{X(R.id)}},{default:V(()=>[N(v(R.name)+" "+v(R.type),1)]),_:2},1032,["value","class","onClick"])]))),128))])]))),256)),o("div",Ae,null,512)]),o("div",Ue,[$(f,{onClick:J,class:"btnback"},{default:V(()=>[N("BACK")]),_:1}),$(f,{onClick:q,class:"btngo"},{default:V(()=>[N(v(t.$t("optimizedSummary.btn[1]")),1)]),_:1})])])]),$(ve,{onCloseDialog:_,data:r(B),dialogVisible:r(I)},null,8,["data","dialogVisible"])],64)}}},Pe=ae(Me,[["__scopeId","data-v-09e9fd51"]]);export{Pe as default};
