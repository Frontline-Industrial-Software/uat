import{r as fo,T as Sc,bv as eY,b5 as tY,q as h0,bw as rY,X as Bf,w as cn,aJ as mj,b as Je,aK as pj,bx as nY,by as Yg,l as oY,a0 as bj,a3 as wj,bz as Vf,bA as Sk,al as Sj,i as Cj,bB as iY,bC as rg,bD as aY,bE as _j,bF as lY,o as fa,c as Jl,x as sY,t as aa,bt as uY,g as fY,F as ng,u as ft,y as Rb,_ as Oj,aO as Rj,$ as Ej,V as cY,a as mt,d as og,p as Tj,h as Pj,aI as hY,aP as dY,bs as vY,aQ as Wf,e as Bi,H as an,b9 as yY,bG as gY,j as mY}from"./index-7f975134.js";import{c as Yv,L as pY,i as bY}from"./luckyexcel.umd-8859fb64.js";import"./index-f7adadce.js";import"./index.min-93f0d79c.js";function wY(e){let t;const r=fo(!1),n=Sc({...e,originalPosition:"",originalOverflow:"",visible:!1});function o(h){n.text=h}function i(){const h=n.parent,d=c.ns;if(!h.vLoadingAddClassList){let v=h.getAttribute("loading-number");v=Number.parseInt(v)-1,v?h.setAttribute("loading-number",v.toString()):(Yg(h,d.bm("parent","relative")),h.removeAttribute("loading-number")),Yg(h,d.bm("parent","hidden"))}a(),f.unmount()}function a(){var h,d;(d=(h=c.$el)==null?void 0:h.parentNode)==null||d.removeChild(c.$el)}function l(){var h;e.beforeClose&&!e.beforeClose()||(r.value=!0,clearTimeout(t),t=window.setTimeout(s,400),n.visible=!1,(h=e.closed)==null||h.call(e))}function s(){if(!r.value)return;const h=n.parent;r.value=!1,h.vLoadingAddClassList=void 0,i()}const u=h0({name:"ElLoading",setup(h,{expose:d}){const{ns:v,zIndex:y}=rY("loading");return d({ns:v,zIndex:y}),()=>{const p=n.spinner||n.svg,w=Bf("svg",{class:"circular",viewBox:n.svgViewBox?n.svgViewBox:"0 0 50 50",...p?{innerHTML:p}:{}},[Bf("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),S=n.text?Bf("p",{class:v.b("text")},[n.text]):void 0;return Bf(nY,{name:v.b("fade"),onAfterLeave:s},{default:cn(()=>[mj(Je("div",{style:{backgroundColor:n.background||""},class:[v.b("mask"),n.customClass,n.fullscreen?"is-fullscreen":""]},[Bf("div",{class:v.b("spinner")},[w,S])]),[[pj,n.visible]])])})}}}),f=eY(u),c=f.mount(document.createElement("div"));return{...tY(n),setText:o,removeElLoadingChild:a,close:l,handleAfterLeave:s,vm:c,get $el(){return c.$el}}}let Kv;const uC=function(e={}){if(!oY)return;const t=SY(e);if(t.fullscreen&&Kv)return Kv;const r=wY({...t,closed:()=>{var o;(o=t.closed)==null||o.call(t),t.fullscreen&&(Kv=void 0)}});CY(t,t.parent,r),Ck(t,t.parent,r),t.parent.vLoadingAddClassList=()=>Ck(t,t.parent,r);let n=t.parent.getAttribute("loading-number");return n?n=`${Number.parseInt(n)+1}`:n="1",t.parent.setAttribute("loading-number",n),t.parent.appendChild(r.$el),bj(()=>r.visible.value=t.visible),t.fullscreen&&(Kv=r),r},SY=e=>{var t,r,n,o;let i;return wj(e.target)?i=(t=document.querySelector(e.target))!=null?t:document.body:i=e.target||document.body,{parent:i===document.body||e.body?document.body:i,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:i===document.body&&((r=e.fullscreen)!=null?r:!0),lock:(n=e.lock)!=null?n:!1,customClass:e.customClass||"",visible:(o=e.visible)!=null?o:!0,target:i}},CY=async(e,t,r)=>{const{nextZIndex:n}=r.vm.zIndex||r.vm._.exposed.zIndex,o={};if(e.fullscreen)r.originalPosition.value=Vf(document.body,"position"),r.originalOverflow.value=Vf(document.body,"overflow"),o.zIndex=n();else if(e.parent===document.body){r.originalPosition.value=Vf(document.body,"position"),await bj();for(const i of["top","left"]){const a=i==="top"?"scrollTop":"scrollLeft";o[i]=`${e.target.getBoundingClientRect()[i]+document.body[a]+document.documentElement[a]-Number.parseInt(Vf(document.body,`margin-${i}`),10)}px`}for(const i of["height","width"])o[i]=`${e.target.getBoundingClientRect()[i]}px`}else r.originalPosition.value=Vf(t,"position");for(const[i,a]of Object.entries(o))r.$el.style[i]=a},Ck=(e,t,r)=>{const n=r.vm.ns||r.vm._.exposed.ns;["absolute","fixed","sticky"].includes(r.originalPosition.value)?Yg(t,n.bm("parent","relative")):Sk(t,n.bm("parent","relative")),e.fullscreen&&e.lock?Sk(t,n.bm("parent","hidden")):Yg(t,n.bm("parent","hidden"))},fC=Symbol("ElLoading"),_k=(e,t)=>{var r,n,o,i;const a=t.instance,l=h=>Sj(t.value)?t.value[h]:void 0,s=h=>{const d=wj(h)&&(a==null?void 0:a[h])||h;return d&&fo(d)},u=h=>s(l(h)||e.getAttribute(`element-loading-${iY(h)}`)),f=(r=l("fullscreen"))!=null?r:t.modifiers.fullscreen,c={text:u("text"),svg:u("svg"),svgViewBox:u("svgViewBox"),spinner:u("spinner"),background:u("background"),customClass:u("customClass"),fullscreen:f,target:(n=l("target"))!=null?n:f?void 0:e,body:(o=l("body"))!=null?o:t.modifiers.body,lock:(i=l("lock"))!=null?i:t.modifiers.lock};e[fC]={options:c,instance:uC(c)}},_Y=(e,t)=>{for(const r of Object.keys(t))Cj(t[r])&&(t[r].value=e[r])},Ok={mounted(e,t){t.value&&_k(e,t)},updated(e,t){const r=e[fC];t.oldValue!==t.value&&(t.value&&!t.oldValue?_k(e,t):t.value&&t.oldValue?Sj(t.value)&&_Y(t.value,r.options):r==null||r.instance.close())},unmounted(e){var t;(t=e[fC])==null||t.instance.close()}},OY={install(e){e.directive("loading",Ok),e.config.globalProperties.$loading=uC},directive:Ok,service:uC};var je=function(e){try{return!!e()}catch{return!0}},RY=je,Jd=!RY(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),kj=Jd,$j=Function.prototype,cC=$j.call,EY=kj&&$j.bind.bind(cC,cC),Ge=kj?EY:function(e){return function(){return cC.apply(e,arguments)}},Aj=Ge,TY=Aj({}.toString),PY=Aj("".slice),Un=function(e){return PY(TY(e),8,-1)},kY=Ge,$Y=je,AY=Un,Eb=Object,IY=kY("".split),ev=$Y(function(){return!Eb("z").propertyIsEnumerable(0)})?function(e){return AY(e)=="String"?IY(e,""):Eb(e)}:Eb,On=function(e){return e==null},MY=On,xY=TypeError,Ar=function(e){if(MY(e))throw xY("Can't call method on "+e);return e},DY=ev,NY=Ar,zr=function(e){return DY(NY(e))},qv=function(e){return e&&e.Math==Math&&e},vt=qv(typeof globalThis=="object"&&globalThis)||qv(typeof window=="object"&&window)||qv(typeof self=="object"&&self)||qv(typeof rg=="object"&&rg)||function(){return this}()||rg||Function("return this")(),Ij={exports:{}},HY=!1,Rk=vt,LY=Object.defineProperty,d0=function(e,t){try{LY(Rk,e,{value:t,configurable:!0,writable:!0})}catch{Rk[e]=t}return t},jY=vt,FY=d0,Ek="__core-js_shared__",BY=jY[Ek]||FY(Ek,{}),v0=BY,Tk=v0;(Ij.exports=function(e,t){return Tk[e]||(Tk[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"});var _f=Ij.exports,VY=Ar,WY=Object,Ir=function(e){return WY(VY(e))},UY=Ge,zY=Ir,GY=UY({}.hasOwnProperty),Nt=Object.hasOwn||function(t,r){return GY(zY(t),r)},YY=Ge,KY=0,qY=Math.random(),XY=YY(1 .toString),cp=function(e){return"Symbol("+(e===void 0?"":e)+")_"+XY(++KY+qY,36)},tl=typeof navigator<"u"&&String(navigator.userAgent)||"",Mj=vt,Tb=tl,Pk=Mj.process,kk=Mj.Deno,$k=Pk&&Pk.versions||kk&&kk.version,Ak=$k&&$k.v8,vn,Kg;Ak&&(vn=Ak.split("."),Kg=vn[0]>0&&vn[0]<4?1:+(vn[0]+vn[1]));!Kg&&Tb&&(vn=Tb.match(/Edge\/(\d+)/),(!vn||vn[1]>=74)&&(vn=Tb.match(/Chrome\/(\d+)/),vn&&(Kg=+vn[1])));var tv=Kg,Ik=tv,ZY=je,QY=vt,JY=QY.String,Of=!!Object.getOwnPropertySymbols&&!ZY(function(){var e=Symbol();return!JY(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ik&&Ik<41}),e3=Of,xj=e3&&!Symbol.sham&&typeof Symbol.iterator=="symbol",t3=vt,r3=_f,Mk=Nt,n3=cp,o3=Of,i3=xj,Kl=t3.Symbol,Pb=r3("wks"),a3=i3?Kl.for||Kl:Kl&&Kl.withoutSetter||n3,St=function(e){return Mk(Pb,e)||(Pb[e]=o3&&Mk(Kl,e)?Kl[e]:a3("Symbol."+e)),Pb[e]},hC=typeof document=="object"&&document.all,l3=typeof hC>"u"&&hC!==void 0,Dj={all:hC,IS_HTMLDDA:l3},Nj=Dj,s3=Nj.all,Rt=Nj.IS_HTMLDDA?function(e){return typeof e=="function"||e===s3}:function(e){return typeof e=="function"},xk=Rt,Hj=Dj,u3=Hj.all,Gt=Hj.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:xk(e)||e===u3}:function(e){return typeof e=="object"?e!==null:xk(e)},f3=Gt,c3=String,h3=TypeError,jt=function(e){if(f3(e))return e;throw h3(c3(e)+" is not an object")},y0={},d3=je,Yt=!d3(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),v3=Yt,y3=je,Lj=v3&&y3(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),_r={},g3=vt,Dk=Gt,dC=g3.document,m3=Dk(dC)&&Dk(dC.createElement),hp=function(e){return m3?dC.createElement(e):{}},p3=Yt,b3=je,w3=hp,jj=!p3&&!b3(function(){return Object.defineProperty(w3("div"),"a",{get:function(){return 7}}).a!=7}),S3=Jd,Xv=Function.prototype.call,Zt=S3?Xv.bind(Xv):function(){return Xv.apply(Xv,arguments)},kb=vt,C3=Rt,_3=function(e){return C3(e)?e:void 0},zo=function(e,t){return arguments.length<2?_3(kb[e]):kb[e]&&kb[e][t]},O3=Ge,Ni=O3({}.isPrototypeOf),R3=zo,E3=Rt,T3=Ni,P3=xj,k3=Object,rv=P3?function(e){return typeof e=="symbol"}:function(e){var t=R3("Symbol");return E3(t)&&T3(t.prototype,k3(e))},$3=String,Rf=function(e){try{return $3(e)}catch{return"Object"}},A3=Rt,I3=Rf,M3=TypeError,rl=function(e){if(A3(e))return e;throw M3(I3(e)+" is not a function")},x3=rl,D3=On,nl=function(e,t){var r=e[t];return D3(r)?void 0:x3(r)},$b=Zt,Ab=Rt,Ib=Gt,N3=TypeError,Fj=function(e,t){var r,n;if(t==="string"&&Ab(r=e.toString)&&!Ib(n=$b(r,e))||Ab(r=e.valueOf)&&!Ib(n=$b(r,e))||t!=="string"&&Ab(r=e.toString)&&!Ib(n=$b(r,e)))return n;throw N3("Can't convert object to primitive value")},H3=Zt,Nk=Gt,Hk=rv,L3=nl,j3=Fj,F3=St,B3=TypeError,V3=F3("toPrimitive"),Bj=function(e,t){if(!Nk(e)||Hk(e))return e;var r=L3(e,V3),n;if(r){if(t===void 0&&(t="default"),n=H3(r,e,t),!Nk(n)||Hk(n))return n;throw B3("Can't convert object to primitive value")}return t===void 0&&(t="number"),j3(e,t)},W3=Bj,U3=rv,dp=function(e){var t=W3(e,"string");return U3(t)?t:t+""},z3=Yt,G3=jj,Y3=Lj,Zv=jt,Lk=dp,K3=TypeError,Mb=Object.defineProperty,q3=Object.getOwnPropertyDescriptor,xb="enumerable",Db="configurable",Nb="writable";_r.f=z3?Y3?function(t,r,n){if(Zv(t),r=Lk(r),Zv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Nb in n&&!n[Nb]){var o=q3(t,r);o&&o[Nb]&&(t[r]=n.value,n={configurable:Db in n?n[Db]:o[Db],enumerable:xb in n?n[xb]:o[xb],writable:!1})}return Mb(t,r,n)}:Mb:function(t,r,n){if(Zv(t),r=Lk(r),Zv(n),G3)try{return Mb(t,r,n)}catch{}if("get"in n||"set"in n)throw K3("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var X3=Math.ceil,Z3=Math.floor,Q3=Math.trunc||function(t){var r=+t;return(r>0?Z3:X3)(r)},J3=Q3,Hi=function(e){var t=+e;return t!==t||t===0?0:J3(t)},eK=Hi,tK=Math.max,rK=Math.min,nv=function(e,t){var r=eK(e);return r<0?tK(r+t,0):rK(r,t)},nK=Hi,oK=Math.min,ol=function(e){return e>0?oK(nK(e),9007199254740991):0},iK=ol,en=function(e){return iK(e.length)},aK=zr,lK=nv,sK=en,jk=function(e){return function(t,r,n){var o=aK(t),i=sK(o),a=lK(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},g0={includes:jk(!0),indexOf:jk(!1)},ov={},uK=Ge,Hb=Nt,fK=zr,cK=g0.indexOf,hK=ov,Fk=uK([].push),Vj=function(e,t){var r=fK(e),n=0,o=[],i;for(i in r)!Hb(hK,i)&&Hb(r,i)&&Fk(o,i);for(;t.length>n;)Hb(r,i=t[n++])&&(~cK(o,i)||Fk(o,i));return o},m0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],dK=Vj,vK=m0,iv=Object.keys||function(t){return dK(t,vK)},yK=Yt,gK=Lj,mK=_r,pK=jt,bK=zr,wK=iv;y0.f=yK&&!gK?Object.defineProperties:function(t,r){pK(t);for(var n=bK(r),o=wK(r),i=o.length,a=0,l;i>a;)mK.f(t,l=o[a++],n[l]);return t};var SK=zo,Wj=SK("document","documentElement"),CK=_f,_K=cp,Bk=CK("keys"),vp=function(e){return Bk[e]||(Bk[e]=_K(e))},OK=jt,RK=y0,Vk=m0,EK=ov,TK=Wj,PK=hp,kK=vp,Wk=">",Uk="<",vC="prototype",yC="script",Uj=kK("IE_PROTO"),Lb=function(){},zj=function(e){return Uk+yC+Wk+e+Uk+"/"+yC+Wk},zk=function(e){e.write(zj("")),e.close();var t=e.parentWindow.Object;return e=null,t},$K=function(){var e=PK("iframe"),t="java"+yC+":",r;return e.style.display="none",TK.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(zj("document.F=Object")),r.close(),r.F},Qv,ig=function(){try{Qv=new ActiveXObject("htmlfile")}catch{}ig=typeof document<"u"?document.domain&&Qv?zk(Qv):$K():zk(Qv);for(var e=Vk.length;e--;)delete ig[vC][Vk[e]];return ig()};EK[Uj]=!0;var Ef=Object.create||function(t,r){var n;return t!==null?(Lb[vC]=OK(t),n=new Lb,Lb[vC]=null,n[Uj]=t):n=ig(),r===void 0?n:RK.f(n,r)},AK=St,IK=Ef,MK=_r.f,gC=AK("unscopables"),mC=Array.prototype;mC[gC]==null&&MK(mC,gC,{configurable:!0,value:IK(null)});var av=function(e){mC[gC][e]=!0},lv={},xK=vt,DK=Rt,Gk=xK.WeakMap,Gj=DK(Gk)&&/native code/.test(String(Gk)),sv=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},NK=Yt,HK=_r,LK=sv,il=NK?function(e,t,r){return HK.f(e,t,LK(1,r))}:function(e,t,r){return e[t]=r,e},jK=Gj,Yj=vt,FK=Gt,BK=il,jb=Nt,Fb=v0,VK=vp,WK=ov,Yk="Object already initialized",pC=Yj.TypeError,UK=Yj.WeakMap,qg,Gc,Xg,zK=function(e){return Xg(e)?Gc(e):qg(e,{})},GK=function(e){return function(t){var r;if(!FK(t)||(r=Gc(t)).type!==e)throw pC("Incompatible receiver, "+e+" required");return r}};if(jK||Fb.state){var En=Fb.state||(Fb.state=new UK);En.get=En.get,En.has=En.has,En.set=En.set,qg=function(e,t){if(En.has(e))throw pC(Yk);return t.facade=e,En.set(e,t),t},Gc=function(e){return En.get(e)||{}},Xg=function(e){return En.has(e)}}else{var vl=VK("state");WK[vl]=!0,qg=function(e,t){if(jb(e,vl))throw pC(Yk);return t.facade=e,BK(e,vl,t),t},Gc=function(e){return jb(e,vl)?e[vl]:{}},Xg=function(e){return jb(e,vl)}}var Go={set:qg,get:Gc,has:Xg,enforce:zK,getterFor:GK},zn={},uv={},Kj={}.propertyIsEnumerable,qj=Object.getOwnPropertyDescriptor,YK=qj&&!Kj.call({1:2},1);uv.f=YK?function(t){var r=qj(this,t);return!!r&&r.enumerable}:Kj;var KK=Yt,qK=Zt,XK=uv,ZK=sv,QK=zr,JK=dp,e4=Nt,t4=jj,Kk=Object.getOwnPropertyDescriptor;zn.f=KK?Kk:function(t,r){if(t=QK(t),r=JK(r),t4)try{return Kk(t,r)}catch{}if(e4(t,r))return ZK(!qK(XK.f,t,r),t[r])};var Xj={exports:{}},bC=Yt,r4=Nt,Zj=Function.prototype,n4=bC&&Object.getOwnPropertyDescriptor,p0=r4(Zj,"name"),o4=p0&&function(){}.name==="something",i4=p0&&(!bC||bC&&n4(Zj,"name").configurable),fv={EXISTS:p0,PROPER:o4,CONFIGURABLE:i4},a4=Ge,l4=Rt,wC=v0,s4=a4(Function.toString);l4(wC.inspectSource)||(wC.inspectSource=function(e){return s4(e)});var Qj=wC.inspectSource,b0=Ge,u4=je,f4=Rt,Jv=Nt,SC=Yt,c4=fv.CONFIGURABLE,h4=Qj,Jj=Go,d4=Jj.enforce,v4=Jj.get,qk=String,ag=Object.defineProperty,y4=b0("".slice),g4=b0("".replace),m4=b0([].join),p4=SC&&!u4(function(){return ag(function(){},"length",{value:8}).length!==8}),b4=String(String).split("String"),w4=Xj.exports=function(e,t,r){y4(qk(t),0,7)==="Symbol("&&(t="["+g4(qk(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Jv(e,"name")||c4&&e.name!==t)&&(SC?ag(e,"name",{value:t,configurable:!0}):e.name=t),p4&&r&&Jv(r,"arity")&&e.length!==r.arity&&ag(e,"length",{value:r.arity});try{r&&Jv(r,"constructor")&&r.constructor?SC&&ag(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=d4(e);return Jv(n,"source")||(n.source=m4(b4,typeof t=="string"?t:"")),e};Function.prototype.toString=w4(function(){return f4(this)&&v4(this).source||h4(this)},"toString");var eF=Xj.exports,S4=Rt,C4=_r,_4=eF,O4=d0,tn=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(S4(r)&&_4(r,i,n),n.global)o?e[t]=r:O4(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:C4.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},al={},R4=Vj,E4=m0,T4=E4.concat("length","prototype");al.f=Object.getOwnPropertyNames||function(t){return R4(t,T4)};var cv={};cv.f=Object.getOwnPropertySymbols;var P4=zo,k4=Ge,$4=al,A4=cv,I4=jt,M4=k4([].concat),tF=P4("Reflect","ownKeys")||function(t){var r=$4.f(I4(t)),n=A4.f;return n?M4(r,n(t)):r},Xk=Nt,x4=tF,D4=zn,N4=_r,rF=function(e,t,r){for(var n=x4(t),o=N4.f,i=D4.f,a=0;a<n.length;a++){var l=n[a];!Xk(e,l)&&!(r&&Xk(r,l))&&o(e,l,i(t,l))}},H4=je,L4=Rt,j4=/#|\.prototype\./,hv=function(e,t){var r=B4[F4(e)];return r==W4?!0:r==V4?!1:L4(t)?H4(t):!!t},F4=hv.normalize=function(e){return String(e).replace(j4,".").toLowerCase()},B4=hv.data={},V4=hv.NATIVE="N",W4=hv.POLYFILL="P",yp=hv,Bb=vt,U4=zn.f,z4=il,G4=tn,Y4=d0,K4=rF,q4=yp,$e=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Bb:o?a=Bb[r]||Y4(r,{}):a=(Bb[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=U4(a,l),s=f&&f.value):s=a[l],i=q4(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;K4(u,s)}(e.sham||s&&s.sham)&&z4(u,"sham",!0),G4(a,l,u,e)}},X4=je,nF=!X4(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Z4=Nt,Q4=Rt,J4=Ir,e6=vp,t6=nF,Zk=e6("IE_PROTO"),CC=Object,r6=CC.prototype,dv=t6?CC.getPrototypeOf:function(e){var t=J4(e);if(Z4(t,Zk))return t[Zk];var r=t.constructor;return Q4(r)&&t instanceof r?r.prototype:t instanceof CC?r6:null},n6=je,o6=Rt,i6=Gt,Qk=dv,a6=tn,l6=St,_C=l6("iterator"),oF=!1,Ba,Vb,Wb;[].keys&&(Wb=[].keys(),"next"in Wb?(Vb=Qk(Qk(Wb)),Vb!==Object.prototype&&(Ba=Vb)):oF=!0);var s6=!i6(Ba)||n6(function(){var e={};return Ba[_C].call(e)!==e});s6&&(Ba={});o6(Ba[_C])||a6(Ba,_C,function(){return this});var iF={IteratorPrototype:Ba,BUGGY_SAFARI_ITERATORS:oF},u6=_r.f,f6=Nt,c6=St,Jk=c6("toStringTag"),gp=function(e,t,r){e&&!r&&(e=e.prototype),e&&!f6(e,Jk)&&u6(e,Jk,{configurable:!0,value:t})},h6=iF.IteratorPrototype,d6=Ef,v6=sv,y6=gp,g6=lv,m6=function(){return this},p6=function(e,t,r,n){var o=t+" Iterator";return e.prototype=d6(h6,{next:v6(+!n,r)}),y6(e,o,!1),g6[o]=m6,e},b6=Ge,w6=rl,S6=function(e,t,r){try{return b6(w6(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},C6=Rt,_6=String,O6=TypeError,R6=function(e){if(typeof e=="object"||C6(e))return e;throw O6("Can't set "+_6(e)+" as a prototype")},E6=S6,T6=jt,P6=R6,w0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=E6(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return T6(o),P6(i),e?r(o,i):o.__proto__=i,o}}():void 0),k6=$e,$6=Zt,aF=fv,A6=Rt,I6=p6,e$=dv,t$=w0,M6=gp,x6=il,Ub=tn,D6=St,N6=lv,lF=iF,H6=aF.PROPER,L6=aF.CONFIGURABLE,r$=lF.IteratorPrototype,ey=lF.BUGGY_SAFARI_ITERATORS,Uf=D6("iterator"),n$="keys",zf="values",o$="entries",j6=function(){return this},S0=function(e,t,r,n,o,i,a){I6(r,t,n);var l=function(w){if(w===o&&h)return h;if(!ey&&w in f)return f[w];switch(w){case n$:return function(){return new r(this,w)};case zf:return function(){return new r(this,w)};case o$:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Uf]||f["@@iterator"]||o&&f[o],h=!ey&&c||l(o),d=t=="Array"&&f.entries||c,v,y,p;if(d&&(v=e$(d.call(new e)),v!==Object.prototype&&v.next&&(e$(v)!==r$&&(t$?t$(v,r$):A6(v[Uf])||Ub(v,Uf,j6)),M6(v,s,!0))),H6&&o==zf&&c&&c.name!==zf&&(L6?x6(f,"name",zf):(u=!0,h=function(){return $6(c,this)})),o)if(y={values:l(zf),keys:i?h:l(n$),entries:l(o$)},a)for(p in y)(ey||u||!(p in f))&&Ub(f,p,y[p]);else k6({target:t,proto:!0,forced:ey||u},y);return f[Uf]!==h&&Ub(f,Uf,h,{name:o}),N6[t]=h,y},C0=function(e,t){return{value:e,done:t}},F6=zr,_0=av,i$=lv,sF=Go,B6=_r.f,V6=S0,ty=C0,W6=Yt,uF="Array Iterator",U6=sF.set,z6=sF.getterFor(uF),G6=V6(Array,"Array",function(e,t){U6(this,{type:uF,target:F6(e),index:0,kind:t})},function(){var e=z6(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,ty(void 0,!0)):r=="keys"?ty(n,!1):r=="values"?ty(t[n],!1):ty([n,t[n]],!1)},"values"),a$=i$.Arguments=i$.Array;_0("keys");_0("values");_0("entries");if(W6&&a$.name!=="values")try{B6(a$,"name",{value:"values"})}catch{}var Y6=St,K6=Y6("toStringTag"),fF={};fF[K6]="z";var O0=String(fF)==="[object z]",q6=O0,X6=Rt,lg=Un,Z6=St,Q6=Z6("toStringTag"),J6=Object,e8=lg(function(){return arguments}())=="Arguments",t8=function(e,t){try{return e[t]}catch{}},mp=q6?lg:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=t8(t=J6(e),Q6))=="string"?r:e8?lg(t):(n=lg(t))=="Object"&&X6(t.callee)?"Arguments":n},r8=O0,n8=mp,o8=r8?{}.toString:function(){return"[object "+n8(this)+"]"},i8=O0,a8=tn,l8=o8;i8||a8(Object.prototype,"toString",l8,{unsafe:!0});var s8=mp,u8=String,Kt=function(e){if(s8(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return u8(e)},R0=Ge,f8=Hi,c8=Kt,h8=Ar,d8=R0("".charAt),l$=R0("".charCodeAt),v8=R0("".slice),s$=function(e){return function(t,r){var n=c8(h8(t)),o=f8(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=l$(n,o),a<55296||a>56319||o+1===i||(l=l$(n,o+1))<56320||l>57343?e?d8(n,o):a:e?v8(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},E0={codeAt:s$(!1),charAt:s$(!0)},y8=E0.charAt,g8=Kt,cF=Go,m8=S0,u$=C0,hF="String Iterator",p8=cF.set,b8=cF.getterFor(hF);m8(String,"String",function(e){p8(this,{type:hF,string:g8(e),index:0})},function(){var t=b8(this),r=t.string,n=t.index,o;return n>=r.length?u$(void 0,!0):(o=y8(r,n),t.index+=o.length,u$(o,!1))});var w8=je,T0=!w8(function(){return Object.isExtensible(Object.preventExtensions({}))}),S8=tn,P0=function(e,t,r){for(var n in t)S8(e,n,t[n],r);return e},dF={exports:{}},pp={},C8=dp,_8=_r,O8=sv,Tf=function(e,t,r){var n=C8(t);n in e?_8.f(e,n,O8(0,r)):e[n]=r},f$=nv,R8=en,E8=Tf,T8=Array,P8=Math.max,k0=function(e,t,r){for(var n=R8(e),o=f$(t,n),i=f$(r===void 0?n:r,n),a=T8(P8(i-o,0)),l=0;o<i;o++,l++)E8(a,l,e[o]);return a.length=l,a},k8=Un,$8=zr,vF=al.f,A8=k0,yF=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],I8=function(e){try{return vF(e)}catch{return A8(yF)}};pp.f=function(t){return yF&&k8(t)=="Window"?I8(t):vF($8(t))};var M8=je,x8=M8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),D8=je,N8=Gt,H8=Un,c$=x8,sg=Object.isExtensible,L8=D8(function(){sg(1)}),j8=L8||c$?function(t){return!N8(t)||c$&&H8(t)=="ArrayBuffer"?!1:sg?sg(t):!0}:sg,F8=$e,B8=Ge,V8=ov,W8=Gt,$0=Nt,U8=_r.f,h$=al,z8=pp,A0=j8,G8=cp,Y8=T0,gF=!1,Fo=G8("meta"),K8=0,I0=function(e){U8(e,Fo,{value:{objectID:"O"+K8++,weakData:{}}})},q8=function(e,t){if(!W8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!$0(e,Fo)){if(!A0(e))return"F";if(!t)return"E";I0(e)}return e[Fo].objectID},X8=function(e,t){if(!$0(e,Fo)){if(!A0(e))return!0;if(!t)return!1;I0(e)}return e[Fo].weakData},Z8=function(e){return Y8&&gF&&A0(e)&&!$0(e,Fo)&&I0(e),e},Q8=function(){J8.enable=function(){},gF=!0;var e=h$.f,t=B8([].splice),r={};r[Fo]=1,e(r).length&&(h$.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Fo){t(o,i,1);break}return o},F8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:z8.f}))},J8=dF.exports={enable:Q8,fastKey:q8,getWeakData:X8,onFreeze:Z8};V8[Fo]=!0;var vv=dF.exports,e5=Un,t5=Ge,yv=function(e){if(e5(e)==="Function")return t5(e)},d$=yv,r5=rl,n5=Jd,o5=d$(d$.bind),gv=function(e,t){return r5(e),t===void 0?e:n5?o5(e,t):function(){return e.apply(t,arguments)}},i5=St,a5=lv,l5=i5("iterator"),s5=Array.prototype,mF=function(e){return e!==void 0&&(a5.Array===e||s5[l5]===e)},u5=mp,v$=nl,f5=On,c5=lv,h5=St,d5=h5("iterator"),M0=function(e){if(!f5(e))return v$(e,d5)||v$(e,"@@iterator")||c5[u5(e)]},v5=Zt,y5=rl,g5=jt,m5=Rf,p5=M0,b5=TypeError,pF=function(e,t){var r=arguments.length<2?p5(e):t;if(y5(r))return g5(v5(r,e));throw b5(m5(e)+" is not iterable")},w5=Zt,y$=jt,S5=nl,bF=function(e,t,r){var n,o;y$(e);try{if(n=S5(e,"return"),!n){if(t==="throw")throw r;return r}n=w5(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return y$(n),r},C5=gv,_5=Zt,O5=jt,R5=Rf,E5=mF,T5=en,g$=Ni,P5=pF,k5=M0,m$=bF,$5=TypeError,ug=function(e,t){this.stopped=e,this.result=t},p$=ug.prototype,x0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=C5(t,n),u,f,c,h,d,v,y,p=function(S){return u&&m$(u,"normal",S),new ug(!0,S)},w=function(S){return o?(O5(S),l?s(S[0],S[1],p):s(S[0],S[1])):l?s(S,p):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=k5(e),!f)throw $5(R5(e)+" is not iterable");if(E5(f)){for(c=0,h=T5(e);h>c;c++)if(d=w(e[c]),d&&g$(p$,d))return d;return new ug(!1)}u=P5(e,f)}for(v=i?e.next:u.next;!(y=_5(v,u)).done;){try{d=w(y.value)}catch(S){m$(u,"throw",S)}if(typeof d=="object"&&d&&g$(p$,d))return d}return new ug(!1)},A5=Ni,I5=TypeError,D0=function(e,t){if(A5(t,e))return e;throw I5("Incorrect invocation")},M5=St,wF=M5("iterator"),SF=!1;try{var x5=0,b$={next:function(){return{done:!!x5++}},return:function(){SF=!0}};b$[wF]=function(){return this},Array.from(b$,function(){throw 2})}catch{}var CF=function(e,t){if(!t&&!SF)return!1;var r=!1;try{var n={};n[wF]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},D5=Rt,N5=Gt,w$=w0,N0=function(e,t,r){var n,o;return w$&&D5(n=t.constructor)&&n!==r&&N5(o=n.prototype)&&o!==r.prototype&&w$(e,o),e},H5=$e,L5=vt,j5=Ge,S$=yp,F5=tn,B5=vv,V5=x0,W5=D0,U5=Rt,z5=On,zb=Gt,Gb=je,G5=CF,Y5=gp,K5=N0,bp=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=L5[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=j5(l[w]);F5(l,w,w=="add"?function(k){return S(this,k===0?0:k),this}:w=="delete"?function(C){return o&&!zb(C)?!1:S(this,C===0?0:C)}:w=="get"?function(k){return o&&!zb(k)?void 0:S(this,k===0?0:k)}:w=="has"?function(k){return o&&!zb(k)?!1:S(this,k===0?0:k)}:function(k,_){return S(this,k===0?0:k,_),this})},c=S$(e,!U5(a)||!(o||l.forEach&&!Gb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),B5.enable();else if(S$(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=Gb(function(){h.has(1)}),y=G5(function(w){new a(w)}),p=!o&&Gb(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});y||(s=t(function(w,S){W5(w,l);var C=K5(new a,w,s);return z5(S)||V5(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||p)&&(f("delete"),f("has"),n&&f("get")),(p||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,H5({global:!0,constructor:!0,forced:s!=a},u),Y5(s,e),o||r.setStrong(s,e,n),s},q5=Un,Pf=Array.isArray||function(t){return q5(t)=="Array"},X5=Ge,Z5=je,_F=Rt,Q5=mp,J5=zo,e7=Qj,OF=function(){},t7=[],RF=J5("Reflect","construct"),H0=/^\s*(?:class|function)\b/,r7=X5(H0.exec),n7=!H0.exec(OF),Gf=function(t){if(!_F(t))return!1;try{return RF(OF,t7,t),!0}catch{return!1}},EF=function(t){if(!_F(t))return!1;switch(Q5(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return n7||!!r7(H0,e7(t))}catch{return!0}};EF.sham=!0;var wp=!RF||Z5(function(){var e;return Gf(Gf.call)||!Gf(Object)||!Gf(function(){e=!0})||e})?EF:Gf,C$=Pf,o7=wp,i7=Gt,a7=St,l7=a7("species"),_$=Array,s7=function(e){var t;return C$(e)&&(t=e.constructor,o7(t)&&(t===_$||C$(t.prototype))?t=void 0:i7(t)&&(t=t[l7],t===null&&(t=void 0))),t===void 0?_$:t},u7=s7,L0=function(e,t){return new(u7(e))(t===0?0:t)},f7=gv,c7=Ge,h7=ev,d7=Ir,v7=en,y7=L0,O$=c7([].push),Zo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,f,c){for(var h=d7(s),d=h7(h),v=f7(u,f),y=v7(d),p=0,w=c||y7,S=t?w(s,y):r||a?w(s,0):void 0,C,k;y>p;p++)if((l||p in d)&&(C=d[p],k=v(C,p,h),e))if(t)S[p]=k;else if(k)switch(e){case 3:return!0;case 5:return C;case 6:return p;case 2:O$(S,C)}else switch(e){case 4:return!1;case 7:O$(S,C)}return i?-1:n||o?o:S}},ll={forEach:Zo(0),map:Zo(1),filter:Zo(2),some:Zo(3),every:Zo(4),find:Zo(5),findIndex:Zo(6),filterReject:Zo(7)},g7=Ge,R$=P0,ry=vv.getWeakData,m7=D0,p7=jt,b7=On,Yb=Gt,w7=x0,TF=ll,E$=Nt,PF=Go,S7=PF.set,C7=PF.getterFor,_7=TF.find,O7=TF.findIndex,R7=g7([].splice),E7=0,ny=function(e){return e.frozen||(e.frozen=new kF)},kF=function(){this.entries=[]},Kb=function(e,t){return _7(e.entries,function(r){return r[0]===t})};kF.prototype={get:function(e){var t=Kb(this,e);if(t)return t[1]},has:function(e){return!!Kb(this,e)},set:function(e,t){var r=Kb(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=O7(this.entries,function(r){return r[0]===e});return~t&&R7(this.entries,t,1),!!~t}};var $F={getConstructor:function(e,t,r,n){var o=e(function(s,u){m7(s,i),S7(s,{type:t,id:E7++,frozen:void 0}),b7(u)||w7(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=C7(t),l=function(s,u,f){var c=a(s),h=ry(p7(u),!0);return h===!0?ny(c).set(u,f):h[c.id]=f,s};return R$(i,{delete:function(s){var u=a(this);if(!Yb(s))return!1;var f=ry(s);return f===!0?ny(u).delete(s):f&&E$(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!Yb(u))return!1;var c=ry(u);return c===!0?ny(f).has(u):c&&E$(c,f.id)}}),R$(i,r?{get:function(u){var f=a(this);if(Yb(u)){var c=ry(u);return c===!0?ny(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},T7=T0,T$=vt,fg=Ge,P$=P0,P7=vv,k7=bp,AF=$F,oy=Gt,iy=Go.enforce,$7=je,A7=Gj,mv=Object,I7=Array.isArray,ay=mv.isExtensible,IF=mv.isFrozen,M7=mv.isSealed,MF=mv.freeze,x7=mv.seal,k$={},$$={},D7=!T$.ActiveXObject&&"ActiveXObject"in T$,Yf,xF=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},DF=k7("WeakMap",xF,AF),Ul=DF.prototype,cg=fg(Ul.set),N7=function(){return T7&&$7(function(){var e=MF([]);return cg(new DF,e,1),!IF(e)})};if(A7)if(D7){Yf=AF.getConstructor(xF,"WeakMap",!0),P7.enable();var A$=fg(Ul.delete),ly=fg(Ul.has),I$=fg(Ul.get);P$(Ul,{delete:function(e){if(oy(e)&&!ay(e)){var t=iy(this);return t.frozen||(t.frozen=new Yf),A$(this,e)||t.frozen.delete(e)}return A$(this,e)},has:function(t){if(oy(t)&&!ay(t)){var r=iy(this);return r.frozen||(r.frozen=new Yf),ly(this,t)||r.frozen.has(t)}return ly(this,t)},get:function(t){if(oy(t)&&!ay(t)){var r=iy(this);return r.frozen||(r.frozen=new Yf),ly(this,t)?I$(this,t):r.frozen.get(t)}return I$(this,t)},set:function(t,r){if(oy(t)&&!ay(t)){var n=iy(this);n.frozen||(n.frozen=new Yf),ly(this,t)?cg(this,t,r):n.frozen.set(t,r)}else cg(this,t,r);return this}})}else N7()&&P$(Ul,{set:function(t,r){var n;return I7(t)&&(IF(t)?n=k$:M7(t)&&(n=$$)),cg(this,t,r),n==k$&&MF(t),n==$$&&x7(t),this}});var NF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},H7=hp,qb=H7("span").classList,M$=qb&&qb.constructor&&qb.constructor.prototype,HF=M$===Object.prototype?void 0:M$,x$=vt,LF=NF,L7=HF,Cc=G6,Xb=il,jF=St,Zb=jF("iterator"),D$=jF("toStringTag"),Qb=Cc.values,FF=function(e,t){if(e){if(e[Zb]!==Qb)try{Xb(e,Zb,Qb)}catch{e[Zb]=Qb}if(e[D$]||Xb(e,D$,t),LF[t]){for(var r in Cc)if(e[r]!==Cc[r])try{Xb(e,r,Cc[r])}catch{e[r]=Cc[r]}}}};for(var Jb in LF)FF(x$[Jb]&&x$[Jb].prototype,Jb);FF(L7,"DOMTokenList");var j7=je,kf=function(e,t){var r=[][e];return!!r&&j7(function(){r.call(null,t||function(){return 1},1)})},F7=$e,B7=yv,V7=g0.indexOf,W7=kf,OC=B7([].indexOf),BF=!!OC&&1/OC([1],1,-0)<0,U7=BF||!W7("indexOf");F7({target:"Array",proto:!0,forced:U7},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return BF?OC(this,t,r)||0:V7(this,t,r)}});var N$=Rf,z7=TypeError,VF=function(e,t){if(!delete e[t])throw z7("Cannot delete property "+N$(t)+" of "+N$(e))},H$=k0,G7=Math.floor,RC=function(e,t){var r=e.length,n=G7(r/2);return r<8?Y7(e,t):K7(e,RC(H$(e,0,n),t),RC(H$(e,n),t),t)},Y7=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},K7=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},q7=RC,X7=tl,L$=X7.match(/firefox\/(\d+)/i),Z7=!!L$&&+L$[1],Q7=tl,J7=/MSIE|Trident/.test(Q7),e9=tl,j$=e9.match(/AppleWebKit\/(\d+)\./),t9=!!j$&&+j$[1],r9=$e,WF=Ge,n9=rl,o9=Ir,F$=en,i9=VF,B$=Kt,j0=je,a9=q7,l9=kf,V$=Z7,s9=J7,W$=tv,U$=t9,hi=[],z$=WF(hi.sort),u9=WF(hi.push),f9=j0(function(){hi.sort(void 0)}),c9=j0(function(){hi.sort(null)}),h9=l9("sort"),UF=!j0(function(){if(W$)return W$<70;if(!(V$&&V$>3)){if(s9)return!0;if(U$)return U$<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)hi.push({k:r+o,v:n})}for(hi.sort(function(i,a){return a.v-i.v}),o=0;o<hi.length;o++)r=hi[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),d9=f9||!c9||!h9||!UF,v9=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:B$(t)>B$(r)?1:-1}};r9({target:"Array",proto:!0,forced:d9},{sort:function(t){t!==void 0&&n9(t);var r=o9(this);if(UF)return t===void 0?z$(r):z$(r,t);var n=[],o=F$(r),i,a;for(a=0;a<o;a++)a in r&&u9(n,r[a]);for(a9(n,v9(t)),i=F$(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)i9(r,a++);return r}});var y9=$e,g9=ll.find,m9=av,EC="find",zF=!0;EC in[]&&Array(1)[EC](function(){zF=!1});y9({target:"Array",proto:!0,forced:zF},{find:function(t){return g9(this,t,arguments.length>1?arguments[1]:void 0)}});m9(EC);var p9=jt,GF=function(){var e=p9(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},F0=je,b9=vt,B0=b9.RegExp,V0=F0(function(){var e=B0("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),w9=V0||F0(function(){return!B0("a","y").sticky}),S9=V0||F0(function(){var e=B0("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),W0={BROKEN_CARET:S9,MISSED_STICKY:w9,UNSUPPORTED_Y:V0},C9=je,_9=vt,O9=_9.RegExp,YF=C9(function(){var e=O9(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),R9=je,E9=vt,T9=E9.RegExp,KF=R9(function(){var e=T9("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),ql=Zt,Sp=Ge,P9=Kt,k9=GF,$9=W0,A9=_f,I9=Ef,M9=Go.get,x9=YF,D9=KF,N9=A9("native-string-replace",String.prototype.replace),Zg=RegExp.prototype.exec,TC=Zg,H9=Sp("".charAt),L9=Sp("".indexOf),j9=Sp("".replace),ew=Sp("".slice),PC=function(){var e=/a/,t=/b*/g;return ql(Zg,e,"a"),ql(Zg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),qF=$9.BROKEN_CARET,kC=/()??/.exec("")[1]!==void 0,F9=PC||kC||qF||x9||D9;F9&&(TC=function(t){var r=this,n=M9(r),o=P9(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=ql(TC,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=qF&&r.sticky,y=ql(k9,r),p=r.source,w=0,S=o;if(v&&(y=j9(y,"y",""),L9(y,"g")===-1&&(y+="g"),S=ew(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&H9(o,r.lastIndex-1)!==`
`)&&(p="(?: "+p+")",S=" "+S,w++),l=new RegExp("^(?:"+p+")",y)),kC&&(l=new RegExp("^"+p+"$(?!\\s)",y)),PC&&(s=r.lastIndex),u=ql(Zg,v?l:r,S),v?u?(u.input=ew(u.input,w),u[0]=ew(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:PC&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),kC&&u&&u.length>1&&ql(N9,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=I9(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var Cp=TC,B9=$e,G$=Cp;B9({target:"RegExp",proto:!0,forced:/./.exec!==G$},{exec:G$});var V9=Jd,XF=Function.prototype,Y$=XF.apply,K$=XF.call,sl=typeof Reflect=="object"&&Reflect.apply||(V9?K$.bind(Y$):function(){return K$.apply(Y$,arguments)}),q$=yv,X$=tn,W9=Cp,Z$=je,ZF=St,U9=il,z9=ZF("species"),tw=RegExp.prototype,_p=function(e,t,r,n){var o=ZF(e),i=!Z$(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!Z$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[z9]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=q$(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=q$(u),y=f.exec;return y===W9||y===tw.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});X$(String.prototype,e,s[0]),X$(tw,o,s[1])}n&&U9(tw[o],"sham",!0)},G9=E0.charAt,U0=function(e,t,r){return t+(r?G9(e,t).length:1)},z0=Ge,Y9=Ir,K9=Math.floor,rw=z0("".charAt),q9=z0("".replace),nw=z0("".slice),X9=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Z9=/\$([$&'`]|\d{1,2})/g,Q9=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=Z9;return o!==void 0&&(o=Y9(o),s=X9),q9(i,s,function(u,f){var c;switch(rw(f,0)){case"$":return"$";case"&":return e;case"`":return nw(t,0,r);case"'":return nw(t,a);case"<":c=o[nw(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=K9(h/10);return d===0?u:d<=l?n[d-1]===void 0?rw(f,1):n[d-1]+rw(f,1):u}c=n[h-1]}return c===void 0?"":c})},Q$=Zt,J9=jt,eq=Rt,tq=Un,rq=Cp,nq=TypeError,Op=function(e,t){var r=e.exec;if(eq(r)){var n=Q$(r,e,t);return n!==null&&J9(n),n}if(tq(e)==="RegExp")return Q$(rq,e,t);throw nq("RegExp#exec called on incompatible receiver")},oq=sl,J$=Zt,Rp=Ge,iq=_p,aq=je,lq=jt,sq=Rt,uq=On,fq=Hi,cq=ol,yl=Kt,hq=Ar,dq=U0,vq=nl,yq=Q9,gq=Op,mq=St,$C=mq("replace"),pq=Math.max,bq=Math.min,wq=Rp([].concat),ow=Rp([].push),e1=Rp("".indexOf),t1=Rp("".slice),Sq=function(e){return e===void 0?e:String(e)},Cq=function(){return"a".replace(/./,"$0")==="$0"}(),r1=function(){return/./[$C]?/./[$C]("a","$0")==="":!1}(),_q=!aq(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});iq("replace",function(e,t,r){var n=r1?"$":"$0";return[function(i,a){var l=hq(this),s=uq(i)?void 0:vq(i,$C);return s?J$(s,i,l,a):J$(t,yl(l),i,a)},function(o,i){var a=lq(this),l=yl(o);if(typeof i=="string"&&e1(i,n)===-1&&e1(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=sq(i);u||(i=yl(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=gq(a,l);if(d===null||(ow(h,d),!f))break;var v=yl(d[0]);v===""&&(a.lastIndex=dq(l,cq(a.lastIndex),c))}for(var y="",p=0,w=0;w<h.length;w++){d=h[w];for(var S=yl(d[0]),C=pq(bq(fq(d.index),l.length),0),k=[],_=1;_<d.length;_++)ow(k,Sq(d[_]));var D=d.groups;if(u){var V=wq([S],k,C,l);D!==void 0&&ow(V,D);var X=yl(oq(i,void 0,V))}else X=yq(S,l,C,k,D,i);C>=p&&(y+=t1(l,p,C)+X,p=C+S.length)}return y+t1(l,p)}]},!_q||!Cq||r1);var Oq=je,Rq=St,Eq=tv,Tq=Rq("species"),pv=function(e){return Eq>=51||!Oq(function(){var t=[],r=t.constructor={};return r[Tq]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Pq=$e,kq=ll.filter,$q=pv,Aq=$q("filter");Pq({target:"Array",proto:!0,forced:!Aq},{filter:function(t){return kq(this,t,arguments.length>1?arguments[1]:void 0)}});var Iq=vt,QF=Iq,G0={},Mq=St;G0.f=Mq;var n1=QF,xq=Nt,Dq=G0,Nq=_r.f,Y0=function(e){var t=n1.Symbol||(n1.Symbol={});xq(t,e)||Nq(t,e,{value:Dq.f(e)})},Hq=Zt,Lq=zo,jq=St,Fq=tn,JF=function(){var e=Lq("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=jq("toPrimitive");t&&!t[n]&&Fq(t,n,function(o){return Hq(r,this)},{arity:1})},Bq=Y0,Vq=JF;Bq("toPrimitive");Vq();var Wq=jt,Uq=Fj,zq=TypeError,Gq=function(e){if(Wq(this),e==="string"||e==="default")e="string";else if(e!=="number")throw zq("Incorrect hint");return Uq(this,e)},Yq=Nt,Kq=tn,qq=Gq,Xq=St,o1=Xq("toPrimitive"),i1=Date.prototype;Yq(i1,o1)||Kq(i1,o1,qq);var a1=eF,Zq=_r,bv=function(e,t,r){return r.get&&a1(r.get,t,{getter:!0}),r.set&&a1(r.set,t,{setter:!0}),Zq.f(e,t,r)},Ep=$e,K0=vt,q0=Zt,Qq=Ge,ys=Yt,gs=Of,Jq=je,nr=Nt,eX=Ni,AC=jt,Tp=zr,X0=dp,tX=Kt,IC=sv,Yc=Ef,eB=iv,rX=al,tB=pp,nX=cv,rB=zn,nB=_r,oX=y0,oB=uv,iw=tn,iX=bv,Z0=_f,aX=vp,iB=ov,l1=cp,lX=St,sX=G0,uX=Y0,fX=JF,cX=gp,aB=Go,Pp=ll.forEach,$r=aX("hidden"),kp="Symbol",Kc="prototype",hX=aB.set,s1=aB.getterFor(kp),Qr=Object[Kc],La=K0.Symbol,_c=La&&La[Kc],dX=K0.TypeError,aw=K0.QObject,lB=rB.f,la=nB.f,sB=tB.f,vX=oB.f,uB=Qq([].push),Bo=Z0("symbols"),wv=Z0("op-symbols"),yX=Z0("wks"),MC=!aw||!aw[Kc]||!aw[Kc].findChild,xC=ys&&Jq(function(){return Yc(la({},"a",{get:function(){return la(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=lB(Qr,t);n&&delete Qr[t],la(e,t,r),n&&e!==Qr&&la(Qr,t,n)}:la,lw=function(e,t){var r=Bo[e]=Yc(_c);return hX(r,{type:kp,tag:e,description:t}),ys||(r.description=t),r},$p=function(t,r,n){t===Qr&&$p(wv,r,n),AC(t);var o=X0(r);return AC(n),nr(Bo,o)?(n.enumerable?(nr(t,$r)&&t[$r][o]&&(t[$r][o]=!1),n=Yc(n,{enumerable:IC(0,!1)})):(nr(t,$r)||la(t,$r,IC(1,{})),t[$r][o]=!0),xC(t,o,n)):la(t,o,n)},Q0=function(t,r){AC(t);var n=Tp(r),o=eB(n).concat(hB(n));return Pp(o,function(i){(!ys||q0(DC,n,i))&&$p(t,i,n[i])}),t},gX=function(t,r){return r===void 0?Yc(t):Q0(Yc(t),r)},DC=function(t){var r=X0(t),n=q0(vX,this,r);return this===Qr&&nr(Bo,r)&&!nr(wv,r)?!1:n||!nr(this,r)||!nr(Bo,r)||nr(this,$r)&&this[$r][r]?n:!0},fB=function(t,r){var n=Tp(t),o=X0(r);if(!(n===Qr&&nr(Bo,o)&&!nr(wv,o))){var i=lB(n,o);return i&&nr(Bo,o)&&!(nr(n,$r)&&n[$r][o])&&(i.enumerable=!0),i}},cB=function(t){var r=sB(Tp(t)),n=[];return Pp(r,function(o){!nr(Bo,o)&&!nr(iB,o)&&uB(n,o)}),n},hB=function(e){var t=e===Qr,r=sB(t?wv:Tp(e)),n=[];return Pp(r,function(o){nr(Bo,o)&&(!t||nr(Qr,o))&&uB(n,Bo[o])}),n};gs||(La=function(){if(eX(_c,this))throw dX("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:tX(arguments[0]),r=l1(t),n=function(o){this===Qr&&q0(n,wv,o),nr(this,$r)&&nr(this[$r],r)&&(this[$r][r]=!1),xC(this,r,IC(1,o))};return ys&&MC&&xC(Qr,r,{configurable:!0,set:n}),lw(r,t)},_c=La[Kc],iw(_c,"toString",function(){return s1(this).tag}),iw(La,"withoutSetter",function(e){return lw(l1(e),e)}),oB.f=DC,nB.f=$p,oX.f=Q0,rB.f=fB,rX.f=tB.f=cB,nX.f=hB,sX.f=function(e){return lw(lX(e),e)},ys&&(iX(_c,"description",{configurable:!0,get:function(){return s1(this).description}}),iw(Qr,"propertyIsEnumerable",DC,{unsafe:!0})));Ep({global:!0,constructor:!0,wrap:!0,forced:!gs,sham:!gs},{Symbol:La});Pp(eB(yX),function(e){uX(e)});Ep({target:kp,stat:!0,forced:!gs},{useSetter:function(){MC=!0},useSimple:function(){MC=!1}});Ep({target:"Object",stat:!0,forced:!gs,sham:!ys},{create:gX,defineProperty:$p,defineProperties:Q0,getOwnPropertyDescriptor:fB});Ep({target:"Object",stat:!0,forced:!gs},{getOwnPropertyNames:cB});fX();cX(La,kp);iB[$r]=!0;var mX=Of,dB=mX&&!!Symbol.for&&!!Symbol.keyFor,pX=$e,bX=zo,wX=Nt,SX=Kt,vB=_f,CX=dB,sw=vB("string-to-symbol-registry"),_X=vB("symbol-to-string-registry");pX({target:"Symbol",stat:!0,forced:!CX},{for:function(e){var t=SX(e);if(wX(sw,t))return sw[t];var r=bX("Symbol")(t);return sw[t]=r,_X[r]=t,r}});var OX=$e,RX=Nt,EX=rv,TX=Rf,PX=_f,kX=dB,u1=PX("symbol-to-string-registry");OX({target:"Symbol",stat:!0,forced:!kX},{keyFor:function(t){if(!EX(t))throw TypeError(TX(t)+" is not a symbol");if(RX(u1,t))return u1[t]}});var $X=Ge,Sv=$X([].slice),AX=Ge,f1=Pf,IX=Rt,c1=Un,MX=Kt,h1=AX([].push),xX=function(e){if(IX(e))return e;if(f1(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?h1(r,o):(typeof o=="number"||c1(o)=="Number"||c1(o)=="String")&&h1(r,MX(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(f1(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},DX=$e,yB=zo,gB=sl,NX=Zt,Cv=Ge,mB=je,d1=Rt,v1=rv,pB=Sv,HX=xX,LX=Of,jX=String,yi=yB("JSON","stringify"),sy=Cv(/./.exec),y1=Cv("".charAt),FX=Cv("".charCodeAt),BX=Cv("".replace),VX=Cv(1 .toString),WX=/[\uD800-\uDFFF]/g,g1=/^[\uD800-\uDBFF]$/,m1=/^[\uDC00-\uDFFF]$/,p1=!LX||mB(function(){var e=yB("Symbol")();return yi([e])!="[null]"||yi({a:e})!="{}"||yi(Object(e))!="{}"}),b1=mB(function(){return yi("\uDF06\uD834")!=='"\\udf06\\ud834"'||yi("\uDEAD")!=='"\\udead"'}),UX=function(e,t){var r=pB(arguments),n=HX(t);if(!(!d1(n)&&(e===void 0||v1(e))))return r[1]=function(o,i){if(d1(n)&&(i=NX(n,this,jX(o),i)),!v1(i))return i},gB(yi,null,r)},zX=function(e,t,r){var n=y1(r,t-1),o=y1(r,t+1);return sy(g1,e)&&!sy(m1,o)||sy(m1,e)&&!sy(g1,n)?"\\u"+VX(FX(e,0),16):e};yi&&DX({target:"JSON",stat:!0,arity:3,forced:p1||b1},{stringify:function(t,r,n){var o=pB(arguments),i=gB(p1?UX:yi,null,o);return b1&&typeof i=="string"?BX(i,WX,zX):i}});var GX=$e,YX=Of,KX=je,bB=cv,qX=Ir,XX=!YX||KX(function(){bB.f(1)});GX({target:"Object",stat:!0,forced:XX},{getOwnPropertySymbols:function(t){var r=bB.f;return r?r(qX(t)):[]}});var ZX=$e,QX=Yt,JX=vt,uy=Ge,eZ=Nt,tZ=Rt,rZ=Ni,nZ=Kt,oZ=bv,iZ=rF,io=JX.Symbol,Vi=io&&io.prototype;if(QX&&tZ(io)&&(!("description"in Vi)||io().description!==void 0)){var w1={},fy=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:nZ(arguments[0]),r=rZ(Vi,this)?new io(t):t===void 0?io():io(t);return t===""&&(w1[r]=!0),r};iZ(fy,io),fy.prototype=Vi,Vi.constructor=fy;var aZ=String(io("test"))=="Symbol(test)",lZ=uy(Vi.valueOf),sZ=uy(Vi.toString),uZ=/^Symbol\((.*)\)[^)]+$/,fZ=uy("".replace),cZ=uy("".slice);oZ(Vi,"description",{configurable:!0,get:function(){var t=lZ(this);if(eZ(w1,t))return"";var r=sZ(t),n=aZ?cZ(r,7,-1):fZ(r,uZ,"$1");return n===""?void 0:n}}),ZX({global:!0,constructor:!0,forced:!0},{Symbol:fy})}var hZ=Ge,wB=hZ(1 .valueOf),SB=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,dZ=Ge,vZ=Ar,yZ=Kt,NC=SB,S1=dZ("".replace),gZ=RegExp("^["+NC+"]+"),mZ=RegExp("(^|[^"+NC+"])["+NC+"]+$"),uw=function(e){return function(t){var r=yZ(vZ(t));return e&1&&(r=S1(r,gZ,"")),e&2&&(r=S1(r,mZ,"$1")),r}},CB={start:uw(1),end:uw(2),trim:uw(3)},pZ=$e,_B=HY,bZ=Yt,OB=vt,RB=QF,EB=Ge,wZ=yp,C1=Nt,SZ=N0,CZ=Ni,_Z=rv,TB=Bj,OZ=je,RZ=al.f,EZ=zn.f,TZ=_r.f,PZ=wB,kZ=CB.trim,Ap="Number",es=OB[Ap];RB[Ap];var J0=es.prototype,$Z=OB.TypeError,AZ=EB("".slice),cy=EB("".charCodeAt),IZ=function(e){var t=TB(e,"number");return typeof t=="bigint"?t:MZ(t)},MZ=function(e){var t=TB(e,"number"),r,n,o,i,a,l,s,u;if(_Z(t))throw $Z("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=kZ(t),r=cy(t,0),r===43||r===45){if(n=cy(t,2),n===88||n===120)return NaN}else if(r===48){switch(cy(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=AZ(t,2),l=a.length,s=0;s<l;s++)if(u=cy(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},eE=wZ(Ap,!es(" 0o1")||!es("0b1")||es("+0x1")),xZ=function(e){return CZ(J0,e)&&OZ(function(){PZ(e)})},Ip=function(t){var r=arguments.length<1?0:es(IZ(t));return xZ(this)?SZ(Object(r),this,Ip):r};Ip.prototype=J0;eE&&!_B&&(J0.constructor=Ip);pZ({global:!0,constructor:!0,wrap:!0,forced:eE},{Number:Ip});var DZ=function(e,t){for(var r=bZ?RZ(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)C1(t,o=r[n])&&!C1(e,o)&&TZ(e,o,EZ(t,o))};(eE||_B)&&DZ(RB[Ap],es);var NZ=$e,HZ=w0;NZ({target:"Object",stat:!0},{setPrototypeOf:HZ});var LZ=$e,jZ=je,FZ=Ir,PB=dv,BZ=nF,VZ=jZ(function(){PB(1)});LZ({target:"Object",stat:!0,forced:VZ,sham:!BZ},{getPrototypeOf:function(t){return PB(FZ(t))}});var kB=Ge,WZ=rl,UZ=Gt,zZ=Nt,_1=Sv,GZ=Jd,$B=Function,YZ=kB([].concat),KZ=kB([].join),fw={},qZ=function(e,t,r){if(!zZ(fw,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";fw[t]=$B("C,a","return new C("+KZ(n,",")+")")}return fw[t](e,r)},XZ=GZ?$B.bind:function(t){var r=WZ(this),n=r.prototype,o=_1(arguments,1),i=function(){var l=YZ(o,_1(arguments));return this instanceof i?qZ(r,l.length,l):r.apply(t,l)};return UZ(n)&&(i.prototype=n),i},ZZ=wp,QZ=Rf,JZ=TypeError,AB=function(e){if(ZZ(e))return e;throw JZ(QZ(e)+" is not a constructor")},eQ=$e,tQ=zo,cw=sl,rQ=XZ,O1=AB,nQ=jt,R1=Gt,oQ=Ef,IB=je,tE=tQ("Reflect","construct"),iQ=Object.prototype,aQ=[].push,MB=IB(function(){function e(){}return!(tE(function(){},[],e)instanceof e)}),xB=!IB(function(){tE(function(){})}),E1=MB||xB;eQ({target:"Reflect",stat:!0,forced:E1,sham:E1},{construct:function(t,r){O1(t),nQ(r);var n=arguments.length<3?t:O1(arguments[2]);if(xB&&!MB)return tE(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return cw(aQ,o,r),new(cw(rQ,t,o))}var i=n.prototype,a=oQ(R1(i)?i:iQ),l=cw(t,a,r);return R1(l)?l:a}});var T1=Nt,lQ=function(e){return e!==void 0&&(T1(e,"value")||T1(e,"writable"))},sQ=$e,uQ=Zt,fQ=Gt,cQ=jt,hQ=lQ,dQ=zn,vQ=dv;function DB(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(cQ(e)===r)return e[t];if(n=dQ.f(e,t),n)return hQ(n)?n.value:n.get===void 0?void 0:uQ(n.get,r);if(fQ(o=vQ(e)))return DB(o,t,r)}sQ({target:"Reflect",stat:!0},{get:DB});var yQ=$e,gQ=je,mQ=zr,NB=zn.f,HB=Yt,pQ=!HB||gQ(function(){NB(1)});yQ({target:"Object",stat:!0,forced:pQ,sham:!HB},{getOwnPropertyDescriptor:function(t,r){return NB(mQ(t),r)}});var bQ=Y0;bQ("iterator");var wQ=$e,P1=Pf,SQ=wp,CQ=Gt,k1=nv,_Q=en,OQ=zr,RQ=Tf,EQ=St,TQ=pv,PQ=Sv,kQ=TQ("slice"),$Q=EQ("species"),hw=Array,AQ=Math.max;wQ({target:"Array",proto:!0,forced:!kQ},{slice:function(t,r){var n=OQ(this),o=_Q(n),i=k1(t,o),a=k1(r===void 0?o:r,o),l,s,u;if(P1(n)&&(l=n.constructor,SQ(l)&&(l===hw||P1(l.prototype))?l=void 0:CQ(l)&&(l=l[$Q],l===null&&(l=void 0)),l===hw||l===void 0))return PQ(n,i,a);for(s=new(l===void 0?hw:l)(AQ(a-i,0)),u=0;i<a;i++,u++)i in n&&RQ(s,u,n[i]);return s.length=u,s}});var IQ=Zt,MQ=Nt,xQ=Ni,DQ=GF,$1=RegExp.prototype,LB=function(e){var t=e.flags;return t===void 0&&!("flags"in $1)&&!MQ(e,"flags")&&xQ($1,e)?IQ(DQ,e):t},NQ=fv.PROPER,HQ=tn,LQ=jt,A1=Kt,jQ=je,FQ=LB,rE="toString",BQ=RegExp.prototype,jB=BQ[rE],VQ=jQ(function(){return jB.call({source:"a",flags:"b"})!="/a/b"}),WQ=NQ&&jB.name!=rE;(VQ||WQ)&&HQ(RegExp.prototype,rE,function(){var t=LQ(this),r=A1(t.source),n=A1(FQ(t));return"/"+r+"/"+n},{unsafe:!0});var UQ=Yt,zQ=fv.EXISTS,FB=Ge,GQ=bv,BB=Function.prototype,YQ=FB(BB.toString),VB=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,KQ=FB(VB.exec),qQ="name";UQ&&!zQ&&GQ(BB,qQ,{configurable:!0,get:function(){try{return KQ(VB,YQ(this))[1]}catch{return""}}});var XQ=jt,ZQ=bF,QQ=function(e,t,r,n){try{return n?t(XQ(r)[0],r[1]):t(r)}catch(o){ZQ(e,"throw",o)}},JQ=gv,eJ=Zt,tJ=Ir,rJ=QQ,nJ=mF,oJ=wp,iJ=en,I1=Tf,aJ=pF,lJ=M0,M1=Array,sJ=function(t){var r=tJ(t),n=oJ(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=JQ(i,o>2?arguments[2]:void 0));var l=lJ(r),s=0,u,f,c,h,d,v;if(l&&!(this===M1&&nJ(l)))for(h=aJ(r,l),d=h.next,f=n?new this:[];!(c=eJ(d,h)).done;s++)v=a?rJ(h,i,[c.value,s],!0):c.value,I1(f,s,v);else for(u=iJ(r),f=n?new this(u):M1(u);u>s;s++)v=a?i(r[s],s):r[s],I1(f,s,v);return f.length=s,f},uJ=$e,fJ=sJ,cJ=CF,hJ=!cJ(function(e){Array.from(e)});uJ({target:"Array",stat:!0,forced:hJ},{from:fJ});var dJ=$e,vJ=T0,yJ=je,gJ=Gt,mJ=vv.onFreeze,HC=Object.freeze,pJ=yJ(function(){HC(1)});dJ({target:"Object",stat:!0,forced:pJ,sham:!vJ},{freeze:function(t){return HC&&gJ(t)?HC(mJ(t)):t}});var bJ=fv.PROPER,wJ=je,x1=SB,D1="âÂá ",SJ=function(e){return wJ(function(){return!!x1[e]()||D1[e]()!==D1||bJ&&x1[e].name!==e})},CJ=$e,_J=CB.trim,OJ=SJ;CJ({target:"String",proto:!0,forced:OJ("trim")},{trim:function(){return _J(this)}});var RJ=$e,EJ=g0.includes,TJ=je,PJ=av,kJ=TJ(function(){return!Array(1).includes()});RJ({target:"Array",proto:!0,forced:kJ},{includes:function(t){return EJ(this,t,arguments.length>1?arguments[1]:void 0)}});PJ("includes");var $J=$e,AJ=E0.codeAt;$J({target:"String",proto:!0},{codePointAt:function(t){return AJ(this,t)}});var IJ=Hi,MJ=Kt,xJ=Ar,DJ=RangeError,nE=function(t){var r=MJ(xJ(this)),n="",o=IJ(t);if(o<0||o==1/0)throw DJ("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},WB=Ge,NJ=ol,N1=Kt,HJ=nE,LJ=Ar,jJ=WB(HJ),FJ=WB("".slice),BJ=Math.ceil,H1=function(e){return function(t,r,n){var o=N1(LJ(t)),i=NJ(r),a=o.length,l=n===void 0?" ":N1(n),s,u;return i<=a||l==""?o:(s=i-a,u=jJ(l,BJ(s/l.length)),u.length>s&&(u=FJ(u,0,s)),e?o+u:u+o)}},VJ={start:H1(!1),end:H1(!0)},WJ=tl,UJ=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(WJ),zJ=$e,GJ=VJ.start,YJ=UJ;zJ({target:"String",proto:!0,forced:YJ},{padStart:function(t){return GJ(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var UB;function ee(){return UB.apply(null,arguments)}function KJ(e){UB=e}function bn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function ja(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function oE(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(it(e,t))return!1;return!0}function Tr(e){return e===void 0}function Vo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function _v(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function zB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function di(e,t){for(var r in t)it(t,r)&&(e[r]=t[r]);return it(t,"toString")&&(e.toString=t.toString),it(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Gn(e,t,r,n){return yV(e,t,r,n,!0).utc()}function qJ(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ke(e){return e._pf==null&&(e._pf=qJ()),e._pf}var LC;Array.prototype.some?LC=Array.prototype.some:LC=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function iE(e){if(e._isValid==null){var t=Ke(e),r=LC.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Mp(e){var t=Gn(NaN);return e!=null?di(Ke(t),e):Ke(t).userInvalidated=!0,t}var L1=ee.momentProperties=[],dw=!1;function aE(e,t){var r,n,o,i=L1.length;if(Tr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Tr(t._i)||(e._i=t._i),Tr(t._f)||(e._f=t._f),Tr(t._l)||(e._l=t._l),Tr(t._strict)||(e._strict=t._strict),Tr(t._tzm)||(e._tzm=t._tzm),Tr(t._isUTC)||(e._isUTC=t._isUTC),Tr(t._offset)||(e._offset=t._offset),Tr(t._pf)||(e._pf=Ke(t)),Tr(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=L1[r],o=t[n],Tr(o)||(e[n]=o);return e}function Ov(e){aE(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),dw===!1&&(dw=!0,ee.updateOffset(this),dw=!1)}function wn(e){return e instanceof Ov||e!=null&&e._isAMomentObject!=null}function GB(e){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function rn(e,t){var r=!0;return di(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])it(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}GB(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var j1={};function YB(e,t){ee.deprecationHandler!=null&&ee.deprecationHandler(e,t),j1[e]||(GB(t),j1[e]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Yn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function XJ(e){var t,r;for(r in e)it(e,r)&&(t=e[r],Yn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function jC(e,t){var r=di({},e),n;for(n in t)it(t,n)&&(ja(e[n])&&ja(t[n])?(r[n]={},di(r[n],e[n]),di(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)it(e,n)&&!it(t,n)&&ja(e[n])&&(r[n]=di({},r[n]));return r}function lE(e){e!=null&&this.set(e)}var FC;Object.keys?FC=Object.keys:FC=function(e){var t,r=[];for(t in e)it(e,t)&&r.push(t);return r};var ZJ={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function QJ(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Yn(n)?n.call(t,r):n}function Wn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var sE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,hy=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,vw={},ts={};function Pe(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(ts[e]=o),t&&(ts[t[0]]=function(){return Wn(o.apply(this,arguments),t[1],t[2])}),r&&(ts[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function JJ(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function eee(e){var t=e.match(sE),r,n;for(r=0,n=t.length;r<n;r++)ts[t[r]]?t[r]=ts[t[r]]:t[r]=JJ(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Yn(t[a])?t[a].call(o,e):t[a];return i}}function hg(e,t){return e.isValid()?(t=KB(t,e.localeData()),vw[t]=vw[t]||eee(t),vw[t](e)):e.localeData().invalidDate()}function KB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(hy.lastIndex=0;r>=0&&hy.test(e);)e=e.replace(hy,n),hy.lastIndex=0,r-=1;return e}var tee={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ree(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(sE).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var nee="Invalid date";function oee(){return this._invalidDate}var iee="%d",aee=/\d{1,2}/;function lee(e){return this._ordinal.replace("%d",e)}var see={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function uee(e,t,r,n){var o=this._relativeTime[r];return Yn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function fee(e,t){var r=this._relativeTime[e>0?"future":"past"];return Yn(r)?r(t):r.replace(/%s/i,t)}var kc={};function cr(e,t){var r=e.toLowerCase();kc[r]=kc[r+"s"]=kc[t]=e}function nn(e){return typeof e=="string"?kc[e]||kc[e.toLowerCase()]:void 0}function uE(e){var t={},r,n;for(n in e)it(e,n)&&(r=nn(n),r&&(t[r]=e[n]));return t}var qB={};function hr(e,t){qB[e]=t}function cee(e){var t=[],r;for(r in e)it(e,r)&&t.push({unit:r,priority:qB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function xp(e){return e%4===0&&e%100!==0||e%400===0}function Zr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Qe(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Zr(t)),r}function $f(e,t){return function(r){return r!=null?(XB(this,e,r),ee.updateOffset(this,t),this):Qg(this,e)}}function Qg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function XB(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&xp(e.year())&&e.month()===1&&e.date()===29?(r=Qe(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Fp(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function hee(e){return e=nn(e),Yn(this[e])?this[e]():this}function dee(e,t){if(typeof e=="object"){e=uE(e);var r=cee(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=nn(e),Yn(this[e]))return this[e](t);return this}var ZB=/\d/,Gr=/\d\d/,QB=/\d{3}/,fE=/\d{4}/,Dp=/[+-]?\d{6}/,Et=/\d\d?/,JB=/\d\d\d\d?/,eV=/\d\d\d\d\d\d?/,Np=/\d{1,3}/,cE=/\d{1,4}/,Hp=/[+-]?\d{1,6}/,Af=/\d+/,Lp=/[+-]?\d+/,vee=/Z|[+-]\d\d:?\d\d/gi,jp=/Z|[+-]\d\d(?::?\d\d)?/gi,yee=/[+-]?\d+(\.\d{1,3})?/,Rv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Jg;Jg={};function be(e,t,r){Jg[e]=Yn(t)?t:function(n,o){return n&&r?r:t}}function gee(e,t){return it(Jg,e)?Jg[e](t._strict,t._locale):new RegExp(mee(e))}function mee(e){return Br(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Br(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var BC={};function yt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Vo(t)&&(n=function(i,a){a[t]=Qe(i)}),o=e.length,r=0;r<o;r++)BC[e[r]]=n}function Ev(e,t){yt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function pee(e,t,r){t!=null&&it(BC,e)&&BC[e](t,r._a,r,e)}var sr=0,co=1,Fn=2,Qt=3,mn=4,ho=5,ca=6,bee=7,wee=8;function See(e,t){return(e%t+t)%t}var Wt;Array.prototype.indexOf?Wt=Array.prototype.indexOf:Wt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Fp(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=See(t,12);return e+=(t-r)/12,r===1?xp(e)?29:28:31-r%7%2}Pe("M",["MM",2],"Mo",function(){return this.month()+1});Pe("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Pe("MMMM",0,0,function(e){return this.localeData().months(this,e)});cr("month","M");hr("month",8);be("M",Et);be("MM",Et,Gr);be("MMM",function(e,t){return t.monthsShortRegex(e)});be("MMMM",function(e,t){return t.monthsRegex(e)});yt(["M","MM"],function(e,t){t[co]=Qe(e)-1});yt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[co]=o:Ke(r).invalidMonth=e});var Cee="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),tV="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),rV=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,_ee=Rv,Oee=Rv;function Ree(e,t){return e?bn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||rV).test(t)?"format":"standalone"][e.month()]:bn(this._months)?this._months:this._months.standalone}function Eee(e,t){return e?bn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[rV.test(t)?"format":"standalone"][e.month()]:bn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Tee(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Gn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null))}function Pee(e,t,r){var n,o,i;if(this._monthsParseExact)return Tee.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Gn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function nV(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Qe(t);else if(t=e.localeData().monthsParse(t),!Vo(t))return e}return r=Math.min(e.date(),Fp(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function oV(e){return e!=null?(nV(this,e),ee.updateOffset(this,!0),this):Qg(this,"Month")}function kee(){return Fp(this.year(),this.month())}function $ee(e){return this._monthsParseExact?(it(this,"_monthsRegex")||iV.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=_ee),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Aee(e){return this._monthsParseExact?(it(this,"_monthsRegex")||iV.call(this),e?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=Oee),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function iV(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Gn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Br(t[o]),r[o]=Br(r[o]);for(o=0;o<24;o++)n[o]=Br(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Pe("Y",0,0,function(){var e=this.year();return e<=9999?Wn(e,4):"+"+e});Pe(0,["YY",2],0,function(){return this.year()%100});Pe(0,["YYYY",4],0,"year");Pe(0,["YYYYY",5],0,"year");Pe(0,["YYYYYY",6,!0],0,"year");cr("year","y");hr("year",1);be("Y",Lp);be("YY",Et,Gr);be("YYYY",cE,fE);be("YYYYY",Hp,Dp);be("YYYYYY",Hp,Dp);yt(["YYYYY","YYYYYY"],sr);yt("YYYY",function(e,t){t[sr]=e.length===2?ee.parseTwoDigitYear(e):Qe(e)});yt("YY",function(e,t){t[sr]=ee.parseTwoDigitYear(e)});yt("Y",function(e,t){t[sr]=parseInt(e,10)});function $c(e){return xp(e)?366:365}ee.parseTwoDigitYear=function(e){return Qe(e)+(Qe(e)>68?1900:2e3)};var aV=$f("FullYear",!0);function Iee(){return xp(this.year())}function Mee(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function qc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function em(e,t,r){var n=7+t-r,o=(7+qc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function lV(e,t,r,n,o){var i=(7+r-n)%7,a=em(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=$c(s)+l):l>$c(e)?(s=e+1,u=l-$c(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Xc(e,t,r){var n=em(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+jo(a,t,r)):o>jo(e.year(),t,r)?(i=o-jo(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function jo(e,t,r){var n=em(e,t,r),o=em(e+1,t,r);return($c(e)-n+o)/7}Pe("w",["ww",2],"wo","week");Pe("W",["WW",2],"Wo","isoWeek");cr("week","w");cr("isoWeek","W");hr("week",5);hr("isoWeek",5);be("w",Et);be("ww",Et,Gr);be("W",Et);be("WW",Et,Gr);Ev(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Qe(e)});function xee(e){return Xc(e,this._week.dow,this._week.doy).week}var Dee={dow:0,doy:6};function Nee(){return this._week.dow}function Hee(){return this._week.doy}function Lee(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function jee(e){var t=Xc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Pe("d",0,"do","day");Pe("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Pe("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Pe("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Pe("e",0,0,"weekday");Pe("E",0,0,"isoWeekday");cr("day","d");cr("weekday","e");cr("isoWeekday","E");hr("day",11);hr("weekday",11);hr("isoWeekday",11);be("d",Et);be("e",Et);be("E",Et);be("dd",function(e,t){return t.weekdaysMinRegex(e)});be("ddd",function(e,t){return t.weekdaysShortRegex(e)});be("dddd",function(e,t){return t.weekdaysRegex(e)});Ev(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Ke(r).invalidWeekday=e});Ev(["d","e","E"],function(e,t,r,n){t[n]=Qe(e)});function Fee(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Bee(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function hE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Vee="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),sV="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Wee="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Uee=Rv,zee=Rv,Gee=Rv;function Yee(e,t){var r=bn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?hE(r,this._week.dow):e?r[e.day()]:r}function Kee(e){return e===!0?hE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function qee(e){return e===!0?hE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Xee(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Gn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1||(o=Wt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Wt.call(this._minWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function Zee(e,t,r){var n,o,i;if(this._weekdaysParseExact)return Xee.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Gn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Qee(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Fee(e,this.localeData()),this.add(e-t,"d")):t}function Jee(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function ete(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Bee(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function tte(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||dE.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=Uee),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function rte(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||dE.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=zee),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function nte(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||dE.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Gee),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function dE(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Gn([2e3,1]).day(i),l=Br(this.weekdaysMin(a,"")),s=Br(this.weekdaysShort(a,"")),u=Br(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function vE(){return this.hours()%12||12}function ote(){return this.hours()||24}Pe("H",["HH",2],0,"hour");Pe("h",["hh",2],0,vE);Pe("k",["kk",2],0,ote);Pe("hmm",0,0,function(){return""+vE.apply(this)+Wn(this.minutes(),2)});Pe("hmmss",0,0,function(){return""+vE.apply(this)+Wn(this.minutes(),2)+Wn(this.seconds(),2)});Pe("Hmm",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)});Pe("Hmmss",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)+Wn(this.seconds(),2)});function uV(e,t){Pe(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}uV("a",!0);uV("A",!1);cr("hour","h");hr("hour",13);function fV(e,t){return t._meridiemParse}be("a",fV);be("A",fV);be("H",Et);be("h",Et);be("k",Et);be("HH",Et,Gr);be("hh",Et,Gr);be("kk",Et,Gr);be("hmm",JB);be("hmmss",eV);be("Hmm",JB);be("Hmmss",eV);yt(["H","HH"],Qt);yt(["k","kk"],function(e,t,r){var n=Qe(e);t[Qt]=n===24?0:n});yt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});yt(["h","hh"],function(e,t,r){t[Qt]=Qe(e),Ke(r).bigHour=!0});yt("hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[mn]=Qe(e.substr(n)),Ke(r).bigHour=!0});yt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[mn]=Qe(e.substr(n,2)),t[ho]=Qe(e.substr(o)),Ke(r).bigHour=!0});yt("Hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[mn]=Qe(e.substr(n))});yt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[mn]=Qe(e.substr(n,2)),t[ho]=Qe(e.substr(o))});function ite(e){return(e+"").toLowerCase().charAt(0)==="p"}var ate=/[ap]\.?m?\.?/i,lte=$f("Hours",!0);function ste(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var cV={calendar:ZJ,longDateFormat:tee,invalidDate:nee,ordinal:iee,dayOfMonthOrdinalParse:aee,relativeTime:see,months:Cee,monthsShort:tV,week:Dee,weekdays:Vee,weekdaysMin:Wee,weekdaysShort:sV,meridiemParse:ate},Tt={},Kf={},Zc;function ute(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function F1(e){return e&&e.toLowerCase().replace("_","-")}function fte(e){for(var t=0,r,n,o,i;t<e.length;){for(i=F1(e[t]).split("-"),r=i.length,n=F1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=Bp(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&ute(i,n)>=r-1)break;r--}t++}return Zc}function cte(e){return e.match("^[^/\\\\]*$")!=null}function Bp(e){var t=null,r;if(Tt[e]===void 0&&typeof module<"u"&&module&&module.exports&&cte(e))try{t=Zc._abbr,r=require,r("./locale/"+e),gi(t)}catch{Tt[e]=null}return Tt[e]}function gi(e,t){var r;return e&&(Tr(t)?r=Yo(e):r=yE(e,t),r?Zc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Zc._abbr}function yE(e,t){if(t!==null){var r,n=cV;if(t.abbr=e,Tt[e]!=null)YB("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Tt[e]._config;else if(t.parentLocale!=null)if(Tt[t.parentLocale]!=null)n=Tt[t.parentLocale]._config;else if(r=Bp(t.parentLocale),r!=null)n=r._config;else return Kf[t.parentLocale]||(Kf[t.parentLocale]=[]),Kf[t.parentLocale].push({name:e,config:t}),null;return Tt[e]=new lE(jC(n,t)),Kf[e]&&Kf[e].forEach(function(o){yE(o.name,o.config)}),gi(e),Tt[e]}else return delete Tt[e],null}function hte(e,t){if(t!=null){var r,n,o=cV;Tt[e]!=null&&Tt[e].parentLocale!=null?Tt[e].set(jC(Tt[e]._config,t)):(n=Bp(e),n!=null&&(o=n._config),t=jC(o,t),n==null&&(t.abbr=e),r=new lE(t),r.parentLocale=Tt[e],Tt[e]=r),gi(e)}else Tt[e]!=null&&(Tt[e].parentLocale!=null?(Tt[e]=Tt[e].parentLocale,e===gi()&&gi(e)):Tt[e]!=null&&delete Tt[e]);return Tt[e]}function Yo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Zc;if(!bn(e)){if(t=Bp(e),t)return t;e=[e]}return fte(e)}function dte(){return FC(Tt)}function gE(e){var t,r=e._a;return r&&Ke(e).overflow===-2&&(t=r[co]<0||r[co]>11?co:r[Fn]<1||r[Fn]>Fp(r[sr],r[co])?Fn:r[Qt]<0||r[Qt]>24||r[Qt]===24&&(r[mn]!==0||r[ho]!==0||r[ca]!==0)?Qt:r[mn]<0||r[mn]>59?mn:r[ho]<0||r[ho]>59?ho:r[ca]<0||r[ca]>999?ca:-1,Ke(e)._overflowDayOfYear&&(t<sr||t>Fn)&&(t=Fn),Ke(e)._overflowWeeks&&t===-1&&(t=bee),Ke(e)._overflowWeekday&&t===-1&&(t=wee),Ke(e).overflow=t),e}var vte=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yte=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gte=/Z|[+-]\d\d(?::?\d\d)?/,dy=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],yw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],mte=/^\/?Date\((-?\d+)/i,pte=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,bte={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function hV(e){var t,r,n=e._i,o=vte.exec(n)||yte.exec(n),i,a,l,s,u=dy.length,f=yw.length;if(o){for(Ke(e).iso=!0,t=0,r=u;t<r;t++)if(dy[t][1].exec(o[1])){a=dy[t][0],i=dy[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(yw[t][1].exec(o[3])){l=(o[2]||" ")+yw[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(gte.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),pE(e)}else e._isValid=!1}function wte(e,t,r,n,o,i){var a=[Ste(e),tV.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Ste(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Cte(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function _te(e,t,r){if(e){var n=sV.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Ke(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Ote(e,t,r){if(e)return bte[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function dV(e){var t=pte.exec(Cte(e._i)),r;if(t){if(r=wte(t[4],t[3],t[2],t[5],t[6],t[7]),!_te(t[1],r,e))return;e._a=r,e._tzm=Ote(t[8],t[9],t[10]),e._d=qc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Ke(e).rfc2822=!0}else e._isValid=!1}function Rte(e){var t=mte.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(hV(e),e._isValid===!1)delete e._isValid;else return;if(dV(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ee.createFromInputFallback(e)}ee.createFromInputFallback=rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function zl(e,t,r){return e??t??r}function Ete(e){var t=new Date(ee.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function mE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=Ete(e),e._w&&e._a[Fn]==null&&e._a[co]==null&&Tte(e),e._dayOfYear!=null&&(a=zl(e._a[sr],o[sr]),(e._dayOfYear>$c(a)||e._dayOfYear===0)&&(Ke(e)._overflowDayOfYear=!0),r=qc(a,0,e._dayOfYear),e._a[co]=r.getUTCMonth(),e._a[Fn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Qt]===24&&e._a[mn]===0&&e._a[ho]===0&&e._a[ca]===0&&(e._nextDay=!0,e._a[Qt]=0),e._d=(e._useUTC?qc:Mee).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Qt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Ke(e).weekdayMismatch=!0)}}function Tte(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=zl(t.GG,e._a[sr],Xc(Ot(),1,4).year),n=zl(t.W,1),o=zl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Xc(Ot(),i,a),r=zl(t.gg,e._a[sr],u.year),n=zl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>jo(r,i,a)?Ke(e)._overflowWeeks=!0:s!=null?Ke(e)._overflowWeekday=!0:(l=lV(r,n,o,i,a),e._a[sr]=l.year,e._dayOfYear=l.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function pE(e){if(e._f===ee.ISO_8601){hV(e);return}if(e._f===ee.RFC_2822){dV(e);return}e._a=[],Ke(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=KB(e._f,e._locale).match(sE)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(gee(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Ke(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),ts[i]?(n?Ke(e).empty=!1:Ke(e).unusedTokens.push(i),pee(i,n,e)):e._strict&&!n&&Ke(e).unusedTokens.push(i);Ke(e).charsLeftOver=l-s,t.length>0&&Ke(e).unusedInput.push(t),e._a[Qt]<=12&&Ke(e).bigHour===!0&&e._a[Qt]>0&&(Ke(e).bigHour=void 0),Ke(e).parsedDateParts=e._a.slice(0),Ke(e).meridiem=e._meridiem,e._a[Qt]=Pte(e._locale,e._a[Qt],e._meridiem),u=Ke(e).era,u!==null&&(e._a[sr]=e._locale.erasConvertYear(u,e._a[sr])),mE(e),gE(e)}function Pte(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function kte(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){Ke(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=aE({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],pE(t),iE(t)&&(a=!0),i+=Ke(t).charsLeftOver,i+=Ke(t).unusedTokens.length*10,Ke(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));di(e,r||t)}function $te(e){if(!e._d){var t=uE(e._i),r=t.day===void 0?t.date:t.day;e._a=zB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),mE(e)}}function Ate(e){var t=new Ov(gE(vV(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function vV(e){var t=e._i,r=e._f;return e._locale=e._locale||Yo(e._l),t===null||r===void 0&&t===""?Mp({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),wn(t)?new Ov(gE(t)):(_v(t)?e._d=t:bn(r)?kte(e):r?pE(e):Ite(e),iE(e)||(e._d=null),e))}function Ite(e){var t=e._i;Tr(t)?e._d=new Date(ee.now()):_v(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Rte(e):bn(t)?(e._a=zB(t.slice(0),function(r){return parseInt(r,10)}),mE(e)):ja(t)?$te(e):Vo(t)?e._d=new Date(t):ee.createFromInputFallback(e)}function yV(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(ja(e)&&oE(e)||bn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,Ate(i)}function Ot(e,t,r,n){return yV(e,t,r,n,!1)}var Mte=rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Mp()}),xte=rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Mp()});function gV(e,t){var r,n;if(t.length===1&&bn(t[0])&&(t=t[0]),!t.length)return Ot();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function Dte(){var e=[].slice.call(arguments,0);return gV("isBefore",e)}function Nte(){var e=[].slice.call(arguments,0);return gV("isAfter",e)}var Hte=function(){return Date.now?Date.now():+new Date},qf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Lte(e){var t,r=!1,n,o=qf.length;for(t in e)if(it(e,t)&&!(Wt.call(qf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[qf[n]]){if(r)return!1;parseFloat(e[qf[n]])!==Qe(e[qf[n]])&&(r=!0)}return!0}function jte(){return this._isValid}function Fte(){return Rn(NaN)}function Vp(e){var t=uE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=Lte(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Yo(),this._bubble()}function dg(e){return e instanceof Vp}function VC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Bte(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Qe(e[a])!==Qe(t[a]))&&i++;return i+o}function mV(e,t){Pe(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Wn(~~(r/60),2)+t+Wn(~~r%60,2)})}mV("Z",":");mV("ZZ","");be("Z",jp);be("ZZ",jp);yt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=bE(jp,e)});var Vte=/([\+\-]|\d\d)/gi;function bE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(Vte)||["-",0,0],i=+(o[1]*60)+Qe(o[2]),i===0?0:o[0]==="+"?i:-i)}function wE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(wn(e)||_v(e)?e.valueOf():Ot(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ee.updateOffset(r,!1),r):Ot(e).local()}function WC(e){return-Math.round(e._d.getTimezoneOffset())}ee.updateOffset=function(){};function Wte(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=bE(jp,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=WC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?wV(this,Rn(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:WC(this)}function Ute(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function zte(e){return this.utcOffset(0,e)}function Gte(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(WC(this),"m")),this}function Yte(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=bE(vee,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Kte(e){return this.isValid()?(e=e?Ot(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function qte(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Xte(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var e={},t;return aE(e,this),e=vV(e),e._a?(t=e._isUTC?Gn(e._a):Ot(e._a),this._isDSTShifted=this.isValid()&&Bte(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Zte(){return this.isValid()?!this._isUTC:!1}function Qte(){return this.isValid()?this._isUTC:!1}function pV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Jte=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,ere=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Rn(e,t){var r=e,n=null,o,i,a;return dg(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Vo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Jte.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Qe(n[Fn])*o,h:Qe(n[Qt])*o,m:Qe(n[mn])*o,s:Qe(n[ho])*o,ms:Qe(VC(n[ca]*1e3))*o}):(n=ere.exec(e))?(o=n[1]==="-"?-1:1,r={y:Wi(n[2],o),M:Wi(n[3],o),w:Wi(n[4],o),d:Wi(n[5],o),h:Wi(n[6],o),m:Wi(n[7],o),s:Wi(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=tre(Ot(r.from),Ot(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Vp(r),dg(e)&&it(e,"_locale")&&(i._locale=e._locale),dg(e)&&it(e,"_isValid")&&(i._isValid=e._isValid),i}Rn.fn=Vp.prototype;Rn.invalid=Fte;function Wi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function B1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function tre(e,t){var r;return e.isValid()&&t.isValid()?(t=wE(t,e),e.isBefore(t)?r=B1(e,t):(r=B1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function bV(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(YB(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=Rn(r,n),wV(this,o,e),this}}function wV(e,t,r,n){var o=t._milliseconds,i=VC(t._days),a=VC(t._months);e.isValid()&&(n=n??!0,a&&nV(e,Qg(e,"Month")+a*r),i&&XB(e,"Date",Qg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&ee.updateOffset(e,i||a))}var rre=bV(1,"add"),nre=bV(-1,"subtract");function SV(e){return typeof e=="string"||e instanceof String}function ore(e){return wn(e)||_v(e)||SV(e)||Vo(e)||are(e)||ire(e)||e===null||e===void 0}function ire(e){var t=ja(e)&&!oE(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||it(e,i);return t&&r}function are(e){var t=bn(e),r=!1;return t&&(r=e.filter(function(n){return!Vo(n)&&SV(e)}).length===0),t&&r}function lre(e){var t=ja(e)&&!oE(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||it(e,i);return t&&r}function sre(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function ure(e,t){arguments.length===1&&(arguments[0]?ore(arguments[0])?(e=arguments[0],t=void 0):lre(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ot(),n=wE(r,this).startOf("day"),o=ee.calendarFormat(this,n)||"sameElse",i=t&&(Yn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,Ot(r)))}function fre(){return new Ov(this)}function cre(e,t){var r=wn(e)?e:Ot(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function hre(e,t){var r=wn(e)?e:Ot(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function dre(e,t,r,n){var o=wn(e)?e:Ot(e),i=wn(t)?t:Ot(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function vre(e,t){var r=wn(e)?e:Ot(e),n;return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function yre(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function gre(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function mre(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=wE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=nn(t),t){case"year":i=vg(this,n)/12;break;case"month":i=vg(this,n);break;case"quarter":i=vg(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Zr(i)}function vg(e,t){if(e.date()<t.date())return-vg(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function pre(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function bre(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?hg(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Yn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",hg(r,"Z")):hg(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function wre(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Sre(e){e||(e=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var t=hg(this,e);return this.localeData().postformat(t)}function Cre(e,t){return this.isValid()&&(wn(e)&&e.isValid()||Ot(e).isValid())?Rn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function _re(e){return this.from(Ot(),e)}function Ore(e,t){return this.isValid()&&(wn(e)&&e.isValid()||Ot(e).isValid())?Rn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Rre(e){return this.to(Ot(),e)}function CV(e){var t;return e===void 0?this._locale._abbr:(t=Yo(e),t!=null&&(this._locale=t),this)}var _V=rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function OV(){return this._locale}var tm=1e3,rs=60*tm,rm=60*rs,RV=(365*400+97)*24*rm;function ns(e,t){return(e%t+t)%t}function EV(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-RV:new Date(e,t,r).valueOf()}function TV(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-RV:Date.UTC(e,t,r)}function Ere(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?TV:EV,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ns(t+(this._isUTC?0:this.utcOffset()*rs),rm);break;case"minute":t=this._d.valueOf(),t-=ns(t,rs);break;case"second":t=this._d.valueOf(),t-=ns(t,tm);break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function Tre(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?TV:EV,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=rm-ns(t+(this._isUTC?0:this.utcOffset()*rs),rm)-1;break;case"minute":t=this._d.valueOf(),t+=rs-ns(t,rs)-1;break;case"second":t=this._d.valueOf(),t+=tm-ns(t,tm)-1;break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function Pre(){return this._d.valueOf()-(this._offset||0)*6e4}function kre(){return Math.floor(this.valueOf()/1e3)}function $re(){return new Date(this.valueOf())}function Are(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ire(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Mre(){return this.isValid()?this.toISOString():null}function xre(){return iE(this)}function Dre(){return di({},Ke(this))}function Nre(){return Ke(this).overflow}function Hre(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pe("N",0,0,"eraAbbr");Pe("NN",0,0,"eraAbbr");Pe("NNN",0,0,"eraAbbr");Pe("NNNN",0,0,"eraName");Pe("NNNNN",0,0,"eraNarrow");Pe("y",["y",1],"yo","eraYear");Pe("y",["yy",2],0,"eraYear");Pe("y",["yyy",3],0,"eraYear");Pe("y",["yyyy",4],0,"eraYear");be("N",SE);be("NN",SE);be("NNN",SE);be("NNNN",Kre);be("NNNNN",qre);yt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Ke(r).era=o:Ke(r).invalidEra=e});be("y",Af);be("yy",Af);be("yyy",Af);be("yyyy",Af);be("yo",Xre);yt(["y","yy","yyy","yyyy"],sr);yt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[sr]=r._locale.eraYearOrdinalParse(e,o):t[sr]=parseInt(e,10)});function Lre(e,t){var r,n,o,i=this._eras||Yo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=ee(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=ee(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function jre(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function Fre(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ee(e.since).year():ee(e.since).year()+(t-e.offset)*r}function Bre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function Vre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function Wre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function Ure(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-ee(o[e].since).year())*r+o[e].offset;return this.year()}function zre(e){return it(this,"_erasNameRegex")||CE.call(this),e?this._erasNameRegex:this._erasRegex}function Gre(e){return it(this,"_erasAbbrRegex")||CE.call(this),e?this._erasAbbrRegex:this._erasRegex}function Yre(e){return it(this,"_erasNarrowRegex")||CE.call(this),e?this._erasNarrowRegex:this._erasRegex}function SE(e,t){return t.erasAbbrRegex(e)}function Kre(e,t){return t.erasNameRegex(e)}function qre(e,t){return t.erasNarrowRegex(e)}function Xre(e,t){return t._eraYearOrdinalRegex||Af}function CE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Br(a[o].name)),e.push(Br(a[o].abbr)),r.push(Br(a[o].narrow)),n.push(Br(a[o].name)),n.push(Br(a[o].abbr)),n.push(Br(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pe(0,["gg",2],0,function(){return this.weekYear()%100});Pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Wp(e,t){Pe(0,[e,e.length],0,t)}Wp("gggg","weekYear");Wp("ggggg","weekYear");Wp("GGGG","isoWeekYear");Wp("GGGGG","isoWeekYear");cr("weekYear","gg");cr("isoWeekYear","GG");hr("weekYear",1);hr("isoWeekYear",1);be("G",Lp);be("g",Lp);be("GG",Et,Gr);be("gg",Et,Gr);be("GGGG",cE,fE);be("gggg",cE,fE);be("GGGGG",Hp,Dp);be("ggggg",Hp,Dp);Ev(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Qe(e)});Ev(["gg","GG"],function(e,t,r,n){t[n]=ee.parseTwoDigitYear(e)});function Zre(e){return PV.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Qre(e){return PV.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Jre(){return jo(this.year(),1,4)}function ene(){return jo(this.isoWeekYear(),1,4)}function tne(){var e=this.localeData()._week;return jo(this.year(),e.dow,e.doy)}function rne(){var e=this.localeData()._week;return jo(this.weekYear(),e.dow,e.doy)}function PV(e,t,r,n,o){var i;return e==null?Xc(this,n,o).year:(i=jo(e,n,o),t>i&&(t=i),nne.call(this,e,t,r,n,o))}function nne(e,t,r,n,o){var i=lV(e,t,r,n,o),a=qc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Pe("Q",0,"Qo","quarter");cr("quarter","Q");hr("quarter",7);be("Q",ZB);yt("Q",function(e,t){t[co]=(Qe(e)-1)*3});function one(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Pe("D",["DD",2],"Do","date");cr("date","D");hr("date",9);be("D",Et);be("DD",Et,Gr);be("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Fn);yt("Do",function(e,t){t[Fn]=Qe(e.match(Et)[0])});var kV=$f("Date",!0);Pe("DDD",["DDDD",3],"DDDo","dayOfYear");cr("dayOfYear","DDD");hr("dayOfYear",4);be("DDD",Np);be("DDDD",QB);yt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Qe(e)});function ine(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Pe("m",["mm",2],0,"minute");cr("minute","m");hr("minute",14);be("m",Et);be("mm",Et,Gr);yt(["m","mm"],mn);var ane=$f("Minutes",!1);Pe("s",["ss",2],0,"second");cr("second","s");hr("second",15);be("s",Et);be("ss",Et,Gr);yt(["s","ss"],ho);var lne=$f("Seconds",!1);Pe("S",0,0,function(){return~~(this.millisecond()/100)});Pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pe(0,["SSS",3],0,"millisecond");Pe(0,["SSSS",4],0,function(){return this.millisecond()*10});Pe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});cr("millisecond","ms");hr("millisecond",16);be("S",Np,ZB);be("SS",Np,Gr);be("SSS",Np,QB);var vi,$V;for(vi="SSSS";vi.length<=9;vi+="S")be(vi,Af);function sne(e,t){t[ca]=Qe(("0."+e)*1e3)}for(vi="S";vi.length<=9;vi+="S")yt(vi,sne);$V=$f("Milliseconds",!1);Pe("z",0,0,"zoneAbbr");Pe("zz",0,0,"zoneName");function une(){return this._isUTC?"UTC":""}function fne(){return this._isUTC?"Coordinated Universal Time":""}var oe=Ov.prototype;oe.add=rre;oe.calendar=ure;oe.clone=fre;oe.diff=mre;oe.endOf=Tre;oe.format=Sre;oe.from=Cre;oe.fromNow=_re;oe.to=Ore;oe.toNow=Rre;oe.get=hee;oe.invalidAt=Nre;oe.isAfter=cre;oe.isBefore=hre;oe.isBetween=dre;oe.isSame=vre;oe.isSameOrAfter=yre;oe.isSameOrBefore=gre;oe.isValid=xre;oe.lang=_V;oe.locale=CV;oe.localeData=OV;oe.max=xte;oe.min=Mte;oe.parsingFlags=Dre;oe.set=dee;oe.startOf=Ere;oe.subtract=nre;oe.toArray=Are;oe.toObject=Ire;oe.toDate=$re;oe.toISOString=bre;oe.inspect=wre;typeof Symbol<"u"&&Symbol.for!=null&&(oe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});oe.toJSON=Mre;oe.toString=pre;oe.unix=kre;oe.valueOf=Pre;oe.creationData=Hre;oe.eraName=Bre;oe.eraNarrow=Vre;oe.eraAbbr=Wre;oe.eraYear=Ure;oe.year=aV;oe.isLeapYear=Iee;oe.weekYear=Zre;oe.isoWeekYear=Qre;oe.quarter=oe.quarters=one;oe.month=oV;oe.daysInMonth=kee;oe.week=oe.weeks=Lee;oe.isoWeek=oe.isoWeeks=jee;oe.weeksInYear=tne;oe.weeksInWeekYear=rne;oe.isoWeeksInYear=Jre;oe.isoWeeksInISOWeekYear=ene;oe.date=kV;oe.day=oe.days=Qee;oe.weekday=Jee;oe.isoWeekday=ete;oe.dayOfYear=ine;oe.hour=oe.hours=lte;oe.minute=oe.minutes=ane;oe.second=oe.seconds=lne;oe.millisecond=oe.milliseconds=$V;oe.utcOffset=Wte;oe.utc=zte;oe.local=Gte;oe.parseZone=Yte;oe.hasAlignedHourOffset=Kte;oe.isDST=qte;oe.isLocal=Zte;oe.isUtcOffset=Qte;oe.isUtc=pV;oe.isUTC=pV;oe.zoneAbbr=une;oe.zoneName=fne;oe.dates=rn("dates accessor is deprecated. Use date instead.",kV);oe.months=rn("months accessor is deprecated. Use month instead",oV);oe.years=rn("years accessor is deprecated. Use year instead",aV);oe.zone=rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Ute);oe.isDSTShifted=rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Xte);function cne(e){return Ot(e*1e3)}function hne(){return Ot.apply(null,arguments).parseZone()}function AV(e){return e}var at=lE.prototype;at.calendar=QJ;at.longDateFormat=ree;at.invalidDate=oee;at.ordinal=lee;at.preparse=AV;at.postformat=AV;at.relativeTime=uee;at.pastFuture=fee;at.set=XJ;at.eras=Lre;at.erasParse=jre;at.erasConvertYear=Fre;at.erasAbbrRegex=Gre;at.erasNameRegex=zre;at.erasNarrowRegex=Yre;at.months=Ree;at.monthsShort=Eee;at.monthsParse=Pee;at.monthsRegex=Aee;at.monthsShortRegex=$ee;at.week=xee;at.firstDayOfYear=Hee;at.firstDayOfWeek=Nee;at.weekdays=Yee;at.weekdaysMin=qee;at.weekdaysShort=Kee;at.weekdaysParse=Zee;at.weekdaysRegex=tte;at.weekdaysShortRegex=rte;at.weekdaysMinRegex=nte;at.isPM=ite;at.meridiem=ste;function nm(e,t,r,n){var o=Yo(),i=Gn().set(n,t);return o[r](i,e)}function IV(e,t,r){if(Vo(e)&&(t=e,e=void 0),e=e||"",t!=null)return nm(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=nm(e,n,r,"month");return o}function _E(e,t,r,n){typeof e=="boolean"?(Vo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Vo(t)&&(r=t,t=void 0),t=t||"");var o=Yo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return nm(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=nm(t,(a+i)%7,n,"day");return l}function dne(e,t){return IV(e,t,"months")}function vne(e,t){return IV(e,t,"monthsShort")}function yne(e,t,r){return _E(e,t,r,"weekdays")}function gne(e,t,r){return _E(e,t,r,"weekdaysShort")}function mne(e,t,r){return _E(e,t,r,"weekdaysMin")}gi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Qe(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ee.lang=rn("moment.lang is deprecated. Use moment.locale instead.",gi);ee.langData=rn("moment.langData is deprecated. Use moment.localeData instead.",Yo);var Zn=Math.abs;function pne(){var e=this._data;return this._milliseconds=Zn(this._milliseconds),this._days=Zn(this._days),this._months=Zn(this._months),e.milliseconds=Zn(e.milliseconds),e.seconds=Zn(e.seconds),e.minutes=Zn(e.minutes),e.hours=Zn(e.hours),e.months=Zn(e.months),e.years=Zn(e.years),this}function MV(e,t,r,n){var o=Rn(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function bne(e,t){return MV(this,e,t,1)}function wne(e,t){return MV(this,e,t,-1)}function V1(e){return e<0?Math.floor(e):Math.ceil(e)}function Sne(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=V1(UC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Zr(e/1e3),n.seconds=o%60,i=Zr(o/60),n.minutes=i%60,a=Zr(i/60),n.hours=a%24,t+=Zr(a/24),s=Zr(xV(t)),r+=s,t-=V1(UC(s)),l=Zr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function xV(e){return e*4800/146097}function UC(e){return e*146097/4800}function Cne(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=nn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+xV(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(UC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function _ne(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function Ko(e){return function(){return this.as(e)}}var One=Ko("ms"),Rne=Ko("s"),Ene=Ko("m"),Tne=Ko("h"),Pne=Ko("d"),kne=Ko("w"),$ne=Ko("M"),Ane=Ko("Q"),Ine=Ko("y");function Mne(){return Rn(this)}function xne(e){return e=nn(e),this.isValid()?this[e+"s"]():NaN}function ul(e){return function(){return this.isValid()?this._data[e]:NaN}}var Dne=ul("milliseconds"),Nne=ul("seconds"),Hne=ul("minutes"),Lne=ul("hours"),jne=ul("days"),Fne=ul("months"),Bne=ul("years");function Vne(){return Zr(this.days()/7)}var ao=Math.round,Xl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Wne(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function Une(e,t,r,n){var o=Rn(e).abs(),i=ao(o.as("s")),a=ao(o.as("m")),l=ao(o.as("h")),s=ao(o.as("d")),u=ao(o.as("M")),f=ao(o.as("w")),c=ao(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,Wne.apply(null,h)}function zne(e){return e===void 0?ao:typeof e=="function"?(ao=e,!0):!1}function Gne(e,t){return Xl[e]===void 0?!1:t===void 0?Xl[e]:(Xl[e]=t,e==="s"&&(Xl.ss=t-1),!0)}function Yne(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Xl,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Xl,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=Une(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var gw=Math.abs;function gl(e){return(e>0)-(e<0)||+e}function Up(){if(!this.isValid())return this.localeData().invalidDate();var e=gw(this._milliseconds)/1e3,t=gw(this._days),r=gw(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Zr(e/60),o=Zr(n/60),e%=60,n%=60,i=Zr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=gl(this._months)!==gl(l)?"-":"",f=gl(this._days)!==gl(l)?"-":"",c=gl(this._milliseconds)!==gl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var nt=Vp.prototype;nt.isValid=jte;nt.abs=pne;nt.add=bne;nt.subtract=wne;nt.as=Cne;nt.asMilliseconds=One;nt.asSeconds=Rne;nt.asMinutes=Ene;nt.asHours=Tne;nt.asDays=Pne;nt.asWeeks=kne;nt.asMonths=$ne;nt.asQuarters=Ane;nt.asYears=Ine;nt.valueOf=_ne;nt._bubble=Sne;nt.clone=Mne;nt.get=xne;nt.milliseconds=Dne;nt.seconds=Nne;nt.minutes=Hne;nt.hours=Lne;nt.days=jne;nt.weeks=Vne;nt.months=Fne;nt.years=Bne;nt.humanize=Yne;nt.toISOString=Up;nt.toString=Up;nt.toJSON=Up;nt.locale=CV;nt.localeData=OV;nt.toIsoString=rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Up);nt.lang=_V;Pe("X",0,0,"unix");Pe("x",0,0,"valueOf");be("x",Lp);be("X",yee);yt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});yt("x",function(e,t,r){r._d=new Date(Qe(e))});//! moment.js
ee.version="2.29.4";KJ(Ot);ee.fn=oe;ee.min=Dte;ee.max=Nte;ee.now=Hte;ee.utc=Gn;ee.unix=cne;ee.months=dne;ee.isDate=_v;ee.locale=gi;ee.invalid=Mp;ee.duration=Rn;ee.isMoment=wn;ee.weekdays=yne;ee.parseZone=hne;ee.localeData=Yo;ee.isDuration=dg;ee.monthsShort=vne;ee.weekdaysMin=mne;ee.defineLocale=yE;ee.updateLocale=hte;ee.locales=dte;ee.weekdaysShort=gne;ee.normalizeUnits=nn;ee.relativeTimeRounding=zne;ee.relativeTimeThreshold=Gne;ee.calendarFormat=sre;ee.prototype=oe;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Kne=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));var qne=TypeError,Xne=9007199254740991,DV=function(e){if(e>Xne)throw qne("Maximum allowed index exceeded");return e},Zne=$e,Qne=je,Jne=Pf,eoe=Gt,toe=Ir,roe=en,W1=DV,U1=Tf,noe=L0,ooe=pv,ioe=St,aoe=tv,NV=ioe("isConcatSpreadable"),loe=aoe>=51||!Qne(function(){var e=[];return e[NV]=!1,e.concat()[0]!==e}),soe=function(e){if(!eoe(e))return!1;var t=e[NV];return t!==void 0?!!t:Jne(e)},uoe=!loe||!ooe("concat");Zne({target:"Array",proto:!0,arity:1,forced:uoe},{concat:function(t){var r=toe(this),n=noe(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],soe(u))for(s=roe(u),W1(o+s),a=0;a<s;a++,o++)a in u&&U1(n,o,u[a]);else W1(o+1),U1(n,o++,u);return n.length=o,n}});var foe=Gt,coe=Un,hoe=St,doe=hoe("match"),OE=function(e){var t;return foe(e)&&((t=e[doe])!==void 0?!!t:coe(e)=="RegExp")},voe=OE,yoe=TypeError,RE=function(e){if(voe(e))throw yoe("The method doesn't accept regular expressions");return e},goe=St,moe=goe("match"),EE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[moe]=!1,"/./"[e](t)}catch{}}return!1},poe=$e,boe=Ge,woe=RE,Soe=Ar,z1=Kt,Coe=EE,_oe=boe("".indexOf);poe({target:"String",proto:!0,forced:!Coe("includes")},{includes:function(t){return!!~_oe(z1(Soe(this)),z1(woe(t)),arguments.length>1?arguments[1]:void 0)}});var Ooe=zo,Roe=bv,Eoe=St,Toe=Yt,G1=Eoe("species"),HV=function(e){var t=Ooe(e);Toe&&t&&!t[G1]&&Roe(t,G1,{configurable:!0,get:function(){return this}})},Poe=Ef,koe=bv,Y1=P0,$oe=gv,Aoe=D0,Ioe=On,Moe=x0,xoe=S0,vy=C0,Doe=HV,Xf=Yt,K1=vv.fastKey,LV=Go,q1=LV.set,mw=LV.getterFor,jV={getConstructor:function(e,t,r,n){var o=e(function(u,f){Aoe(u,i),q1(u,{type:t,index:Poe(null),first:void 0,last:void 0,size:0}),Xf||(u.size=0),Ioe(f)||Moe(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=mw(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,y;return d?d.value=c:(h.last=d={index:y=K1(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),Xf?h.size++:u.size++,y!=="F"&&(h.index[y]=d)),u},s=function(u,f){var c=a(u),h=K1(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return Y1(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,Xf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),Xf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=$oe(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),Y1(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),Xf&&koe(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=mw(t),i=mw(n);xoe(e,t,function(a,l){q1(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,vy(void 0,!0)):l=="keys"?vy(s.key,!1):l=="values"?vy(s.value,!1):vy([s.key,s.value],!1)},r?"entries":"values",!r,!0),Doe(t)}},Noe=bp,Hoe=jV;Noe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Hoe);var X1=jt,Loe=AB,joe=On,Foe=St,Boe=Foe("species"),Voe=function(e,t){var r=X1(e).constructor,n;return r===void 0||joe(n=X1(r)[Boe])?t:Loe(n)},Woe=sl,Zf=Zt,TE=Ge,Uoe=_p,zoe=jt,Goe=On,Yoe=OE,Z1=Ar,Koe=Voe,qoe=U0,Xoe=ol,pw=Kt,Zoe=nl,Q1=k0,J1=Op,Qoe=Cp,Joe=W0,eie=je,ml=Joe.UNSUPPORTED_Y,eA=4294967295,tie=Math.min,FV=[].push,rie=TE(/./.exec),pl=TE(FV),Qf=TE("".slice),nie=!eie(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});Uoe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=pw(Z1(this)),l=i===void 0?eA:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!Yoe(o))return Zf(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=Zf(Qoe,c,a))&&(d=c.lastIndex,!(d>f&&(pl(s,Qf(a,f,h.index)),h.length>1&&h.index<a.length&&Woe(FV,s,Q1(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!rie(c,""))&&pl(s,""):pl(s,Qf(a,f)),s.length>l?Q1(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Zf(t,this,o,i)}:n=t,[function(i,a){var l=Z1(this),s=Goe(i)?void 0:Zoe(i,e);return s?Zf(s,i,l,a):Zf(n,pw(l),i,a)},function(o,i){var a=zoe(this),l=pw(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=Koe(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ml?"g":"y"),h=new u(ml?"^(?:"+a.source+")":a,c),d=i===void 0?eA:i>>>0;if(d===0)return[];if(l.length===0)return J1(h,l)===null?[l]:[];for(var v=0,y=0,p=[];y<l.length;){h.lastIndex=ml?0:y;var w=J1(h,ml?Qf(l,y):l),S;if(w===null||(S=tie(Xoe(h.lastIndex+(ml?y:0)),l.length))===v)y=qoe(l,y,f);else{if(pl(p,Qf(l,v,y)),p.length===d)return p;for(var C=1;C<=w.length-1;C++)if(pl(p,w[C]),p.length===d)return p;y=v=S}}return pl(p,Qf(l,v)),p}]},!nie,ml);function BV(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function zC(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Ac(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function Ft(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Wr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function We(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function A(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function VV(e){return Ft(e,function(t,r){return t+r},0)}function oie(e){return Ft(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function iie(e){return Ft(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function aie(e){return e.length?VV(e)/e.length:0}function WV(e){return Ft(e,function(t,r){return t.concat(Array.isArray(r)?WV(r):r)},[])}function PE(e){var t=[];return A(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function GC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function lie(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return l.includes(s)})}),a}function sie(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return A(i,function(l){A(l,function(s){a.has(s)||a.add(s)})}),Array.from(a)}function YC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const uie=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:aie,arrayEach:A,arrayFilter:Wr,arrayFlatten:WV,arrayMap:We,arrayMax:oie,arrayMin:iie,arrayReduce:Ft,arraySum:VV,arrayUnique:PE,extendArray:zC,getDifferenceOfArrays:GC,getIntersectionOfArrays:lie,getUnionOfArrays:sie,pivot:Ac,stringToArray:YC,to2dArray:BV},Symbol.toStringTag,{value:"Module"}));function dt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=Ft(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var tA,rA,nA,oA,iA,aA;function os(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function KC(e){"@babel/helpers - typeof";return KC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KC(e)}function Dt(e){var t;switch(KC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ve(e){return typeof e<"u"}function bt(e){return typeof e>"u"}function Xt(e){return e===null||e===""||bt(e)}function UV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var Oc="length",Ic=function(t){return parseInt(t,16)},lA=function(t){return parseInt(t,10)},om=function(t,r,n){return t.substr(r,n)},Mc=function(t){return t.codePointAt(0)-65},qC=function(t){return"".concat(t).replace(/\-/g,"")},fie=function(t){return Ic(om(qC(t),Ic("12"),Mc("F")))/(Ic(om(qC(t),Mc("B"),~~![][Oc]))||9)},cie=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},sA=!1,uA={invalid:function(){return dt(tA||(tA=os([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(rA||(rA=os([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return dt(nA||(nA=os([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},fA={invalid:function(){return dt(oA||(oA=os([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(iA||(iA=os([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return dt(aA||(aA=os([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function zV(e,t){var r=!Xt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="13.0.0",i,a="invalid",l="invalid";e=qC(e||"");var s=hie(e);if(r||n||s)if(s){var u=ee("22/06/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=fie(e);i=ee((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(cie()&&(a="valid",l="valid"),!sA&&a!=="valid"){var h=uA[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](uA[a]({keyValidityDate:i,hotVersion:o})),sA=!0}if(l!=="valid"&&t.parentNode){var d=fA[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=fA[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function hie(e){var t=[][Oc],r=t;if(e[Oc]!==Mc("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=Mc(o.shift());i;i=Mc(o.shift()||"A"))--i<""[Oc]?r=r|(lA("".concat(lA(Ic(n)+(Ic(om(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=om(e,i,i?o[Oc]===1?9:8:6);return r===t}const die=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:zV,isDefined:ve,isEmpty:Xt,isRegExp:UV,isUndefined:bt,stringify:Dt},Symbol.toStringTag,{value:"Module"}));var vie=Ir,cA=nv,yie=en,gie=function(t){for(var r=vie(this),n=yie(r),o=arguments.length,i=cA(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:cA(a,n);l>i;)r[i++]=t;return r},mie=$e,pie=gie,bie=av;mie({target:"Array",proto:!0},{fill:pie});bie("fill");var wie=$e,Sie=Ir,GV=iv,Cie=je,_ie=Cie(function(){GV(1)});wie({target:"Object",stat:!0,forced:_ie},{keys:function(t){return GV(Sie(t))}});var Oie=ll.forEach,Rie=kf,Eie=Rie("forEach"),Tie=Eie?[].forEach:function(t){return Oie(this,t,arguments.length>1?arguments[1]:void 0)},hA=vt,dA=NF,Pie=HF,bw=Tie,kie=il,YV=function(e){if(e&&e.forEach!==bw)try{kie(e,"forEach",bw)}catch{e.forEach=bw}};for(var ww in dA)dA[ww]&&YV(hA[ww]&&hA[ww].prototype);YV(Pie);function vA(e,t,r){return t=$ie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ie(e){var t=Aie(e,"string");return Wo(t)==="symbol"?t:String(t)}function Aie(e,t){if(Wo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wo(e){"@babel/helpers - typeof";return Wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wo(e)}function ms(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},ze(e,function(r,n){n!=="__children"&&(r&&Wo(r)==="object"&&!Array.isArray(r)?t[n]=ms(r):Array.isArray(r)?r.length&&Wo(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[ms(r[0])]:t[n]=[]:t[n]=null)})),t}function qo(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function zt(e,t,r){var n=Array.isArray(r);return ze(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function Tv(e,t){ze(t,function(r,n){t[n]&&Wo(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Tv(e[n],t[n])):e[n]=t[n]})}function fr(e){return Wo(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Sr(e){var t={};return ze(e,function(r,n){t[n]=r}),t}function gt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return A(r,function(o){e.MIXINS.push(o.MIXIN_NAME),ze(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(y){var p=y;return(Array.isArray(p)||Ue(p))&&(p=fr(p)),p};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function zp(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function Kn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function ze(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function KV(e,t){var r=t.split("."),n=e;return ze(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function yg(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(xt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function Gp(e){if(!Ue(e))return 0;var t=function r(n){var o=0;return Ue(n)?ze(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Va(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},vA(t,n,e),vA(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Iie=Object.freeze(Object.defineProperty({__proto__:null,clone:Sr,createObjectPropListener:Va,deepClone:fr,deepExtend:Tv,deepObjectSize:Gp,defineGetter:Kn,duckSchema:ms,extend:zt,getProperty:KV,hasOwnProperty:xt,inherit:qo,isObject:Ue,isObjectEqual:zp,mixin:gt,objectEach:ze,setProperty:yg},Symbol.toStringTag,{value:"Module"}));var kr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Ur={chrome:kr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:kr(function(e){return/CriOS/.test(e)}),edge:kr(function(e){return/Edge/.test(e)}),edgeWebKit:kr(function(e){return/EdgiOS/.test(e)}),firefox:kr(function(e){return/Firefox/.test(e)}),firefoxWebKit:kr(function(e){return/FxiOS/.test(e)}),ie:kr(function(e){return/Trident/.test(e)}),ie9:kr(function(){return!!document.documentMode}),mobile:kr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:kr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},If={mac:kr(function(e){return/^Mac/.test(e)}),win:kr(function(e){return/^Win/.test(e)}),linux:kr(function(e){return/^Linux/.test(e)}),ios:kr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function qV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;ze(Ur,function(i){var a=i.test;return void a(r,o)})}function XV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;ze(If,function(n){var o=n.test;return void o(r)})}qV();XV();function kE(){return Ur.chrome.value}function ZV(){return Ur.chromeWebKit.value}function gg(){return Ur.firefox.value}function QV(){return Ur.firefoxWebKit.value}function JV(){return Ur.safari.value}function eW(){return Ur.edge.value}function Mie(){return Ur.edgeWebKit.value}function tW(){return Ur.ie.value}function rW(){return Ur.ie9.value}function xie(){return Ur.ie.value||Ur.edge.value}function pn(){return Ur.mobile.value}function $E(){return If.ios.value}function AE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&If.mac.value}function XC(){return If.win.value}function im(){return If.mac.value}function Die(){return If.linux.value}const Nie=Object.freeze(Object.defineProperty({__proto__:null,isChrome:kE,isChromeWebKit:ZV,isEdge:eW,isEdgeWebKit:Mie,isFirefox:gg,isFirefoxWebKit:QV,isIE:tW,isIE9:rW,isIOS:$E,isIpadOS:AE,isLinuxOS:Die,isMSBrowser:xie,isMacOS:im,isMobileBrowser:pn,isSafari:JV,isWindowsOS:XC,setBrowserMeta:qV,setPlatformMeta:XV},Symbol.toStringTag,{value:"Module"}));var pe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:gg()?182:174,AUDIO_MUTE:gg()?181:173,AUDIO_UP:gg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Hie=[pe.ALT,pe.ARROW_DOWN,pe.ARROW_LEFT,pe.ARROW_RIGHT,pe.ARROW_UP,pe.AUDIO_DOWN,pe.AUDIO_MUTE,pe.AUDIO_UP,pe.BACKSPACE,pe.CAPS_LOCK,pe.DELETE,pe.END,pe.ENTER,pe.ESCAPE,pe.F1,pe.F2,pe.F3,pe.F4,pe.F5,pe.F6,pe.F7,pe.F8,pe.F9,pe.F10,pe.F11,pe.F12,pe.F13,pe.F14,pe.F15,pe.F16,pe.F17,pe.F18,pe.F19,pe.HOME,pe.INSERT,pe.MEDIA_NEXT,pe.MEDIA_PLAY_PAUSE,pe.MEDIA_PREV,pe.MEDIA_STOP,pe.NULL,pe.NUM_LOCK,pe.PAGE_DOWN,pe.PAGE_UP,pe.PAUSE,pe.SCROLL_LOCK,pe.SHIFT,pe.TAB];function nW(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function IE(e){return Hie.includes(e)}function Lie(e){var t=[];return im()?t.push(pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX):t.push(pe.CONTROL),t.includes(e)}function oW(e){return[pe.CONTROL,pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX].includes(e)}function ps(e,t){var r=t.split("|"),n=!1;return A(r,function(o){if(e===pe[o])return n=!0,!1}),n}const jie=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:pe,isCtrlKey:Lie,isCtrlMetaKey:oW,isFunctionKey:IE,isKey:ps,isPrintableChar:nW},Symbol.toStringTag,{value:"Module"}));function Sn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function sa(e){return e.isImmediatePropagationEnabled===!1}function Ai(e){return e.button===2}function Yp(e){return e.button===0}const Fie=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:sa,isLeftClick:Yp,isRightClick:Ai,stopImmediatePropagation:Sn},Symbol.toStringTag,{value:"Module"}));var Bie=_r.f,Vie=function(e,t,r){r in e||Bie(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},Wie=Yt,ME=vt,Pv=Ge,Uie=yp,zie=N0,Gie=il,Yie=al.f,yA=Ni,Kie=OE,gA=Kt,qie=LB,iW=W0,Xie=Vie,Zie=tn,Qie=je,Jie=Nt,eae=Go.enforce,tae=HV,rae=St,aW=YF,lW=KF,nae=rae("match"),mi=ME.RegExp,Gl=mi.prototype,oae=ME.SyntaxError,iae=Pv(Gl.exec),am=Pv("".charAt),mA=Pv("".replace),pA=Pv("".indexOf),aae=Pv("".slice),lae=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Fa=/a/g,Sw=/a/g,sae=new mi(Fa)!==Fa,sW=iW.MISSED_STICKY,uae=iW.UNSUPPORTED_Y,fae=Wie&&(!sae||sW||aW||lW||Qie(function(){return Sw[nae]=!1,mi(Fa)!=Fa||mi(Sw)==Sw||mi(Fa,"i")!="/a/i"})),cae=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=am(e,r),i==="\\"){n+=i+am(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},hae=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=am(e,r),f==="\\")f=f+am(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":iae(lae,aae(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||Jie(i,u))throw new oae("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(Uie("RegExp",fae)){for(var Ui=function(t,r){var n=yA(Gl,this),o=Kie(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Ui)return t;if((o||yA(Gl,t))&&(t=t.source,i&&(r=qie(l))),t=t===void 0?"":gA(t),r=r===void 0?"":gA(r),l=t,aW&&"dotAll"in Fa&&(u=!!r&&pA(r,"s")>-1,u&&(r=mA(r,/s/g,""))),s=r,sW&&"sticky"in Fa&&(f=!!r&&pA(r,"y")>-1,f&&uae&&(r=mA(r,/y/g,""))),lW&&(c=hae(t),t=c[0],a=c[1]),h=zie(mi(t,r),n?this:Gl,Ui),(u||f||a.length)&&(d=eae(h),u&&(d.dotAll=!0,d.raw=Ui(cae(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{Gie(h,"source",l===""?"(?:)":l)}catch{}return h},bA=Yie(mi),wA=0;bA.length>wA;)Xie(Ui,mi,bA[wA++]);Gl.constructor=Ui,Ui.prototype=Gl,Zie(ME,"RegExp",Ui,{constructor:!0})}tae("RegExp");var dae=$e,vae=Ge,yae=ev,gae=zr,mae=kf,pae=vae([].join),bae=yae!=Object,wae=bae||!mae("join",",");dae({target:"Array",proto:!0,forced:wae},{join:function(t){return pae(gae(this),t===void 0?",":t)}});function ZC(e){"@babel/helpers - typeof";return ZC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZC(e)}function Kp(e){return window.requestAnimationFrame(e)}function uW(){return!!document.documentElement.classList}function fW(){return!!document.createTextNode("test").textContent}function cW(){return!!window.getComputedStyle}function Qc(e){window.cancelAnimationFrame(e)}function xE(){return"ontouchstart"in window}var QC;function Sae(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),QC=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function DE(){return QC===void 0&&Sae(),QC}var bl;function hW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return bl||((typeof Intl>"u"?"undefined":ZC(Intl))==="object"?bl=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?bl=function(n,o){return"".concat(n).localeCompare(o)}:bl=function(n,o){return n===o?0:n>o?-1:1},bl)}var Jf;function dW(){if(Jf!==void 0)return Jf;try{var e={get passive(){Jf=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Jf=!1}return Jf}const Cae=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Qc,getComparisonFunction:hW,hasCaptionProblem:DE,isClassListSupported:uW,isGetComputedStyleSupported:cW,isPassiveEventSupported:dW,isTextContentSupported:fW,isTouchSupported:xE,requestAnimationFrame:Kp},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function fi(e){"@babel/helpers - typeof";return fi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fi(e)}function JC(e,t){return JC=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},JC(e,t)}function _ae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mg(e,t,r){return _ae()?mg=Reflect.construct:mg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&JC(u,a.prototype),u},mg.apply(null,arguments)}function fn(e){return Oae(e)||Rae(e)||Eae(e)||Tae()}function Oae(e){if(Array.isArray(e))return e_(e)}function Rae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Eae(e,t){if(e){if(typeof e=="string")return e_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e_(e,t)}}function e_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Pae=Object.hasOwnProperty,SA=Object.setPrototypeOf,kae=Object.isFrozen,$ae=Object.getPrototypeOf,Aae=Object.getOwnPropertyDescriptor,Cr=Object.freeze,Cn=Object.seal,Iae=Object.create,vW=typeof Reflect<"u"&&Reflect,lm=vW.apply,t_=vW.construct;lm||(lm=function(t,r,n){return t.apply(r,n)});Cr||(Cr=function(t){return t});Cn||(Cn=function(t){return t});t_||(t_=function(t,r){return mg(t,fn(r))});var Mae=Jr(Array.prototype.forEach),CA=Jr(Array.prototype.pop),ec=Jr(Array.prototype.push),pg=Jr(String.prototype.toLowerCase),Cw=Jr(String.prototype.toString),xae=Jr(String.prototype.match),ln=Jr(String.prototype.replace),Dae=Jr(String.prototype.indexOf),Nae=Jr(String.prototype.trim),vr=Jr(RegExp.prototype.test),_w=Hae(TypeError);function Jr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return lm(e,t,n)}}function Hae(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return t_(e,r)}}function Xe(e,t,r){r=r||pg,SA&&SA(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(kae(t)||(t[n]=i),o=i)}e[o]=!0}return e}function zi(e){var t=Iae(null),r;for(r in e)lm(Pae,e,[r])===!0&&(t[r]=e[r]);return t}function yy(e,t){for(;e!==null;){var r=Aae(e,t);if(r){if(r.get)return Jr(r.get);if(typeof r.value=="function")return Jr(r.value)}e=$ae(e)}function n(o){return console.warn("fallback value for",o),null}return n}var _A=Cr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ow=Cr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Rw=Cr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Lae=Cr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ew=Cr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),jae=Cr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),OA=Cr(["#text"]),RA=Cr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Tw=Cr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),EA=Cr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),gy=Cr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Fae=Cn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Bae=Cn(/<%[\w\W]*|[\w\W]*%>/gm),Vae=Cn(/\${[\w\W]*}/gm),Wae=Cn(/^data-[\-\w.\u00B7-\uFFFF]/),Uae=Cn(/^aria-[\-\w]+$/),zae=Cn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Gae=Cn(/^(?:\w+script|data):/i),Yae=Cn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Kae=Cn(/^html$/i),qae=function(){return typeof window>"u"?null:window},Xae=function(t,r){if(fi(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function yW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qae(),t=function(L){return yW(L)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,y=yy(v,"cloneNode"),p=yy(v,"nextSibling"),w=yy(v,"childNodes"),S=yy(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var k=Xae(d,r),_=k?k.createHTML(""):"",D=n,V=D.implementation,X=D.createNodeIterator,G=D.createDocumentFragment,q=D.getElementsByTagName,Q=r.importNode,ne={};try{ne=zi(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof S=="function"&&V&&typeof V.createHTMLDocument<"u"&&ne!==9;var ue=Fae,he=Bae,Oe=Vae,we=Wae,$=Uae,P=Gae,g=Yae,m=zae,b=null,E=Xe({},[].concat(fn(_A),fn(Ow),fn(Rw),fn(Ew),fn(OA))),R=null,B=Xe({},[].concat(fn(RA),fn(Tw),fn(EA),fn(gy))),x=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Z=null,re=!0,ie=!0,se=!1,_e=!0,Se=!1,z=!1,Ne=!1,Be=!1,ke=!1,Ie=!1,Ae=!1,O=!0,T=!1,I="user-content-",F=!0,M=!1,W={},H=null,N=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),U=null,j=Xe({},["audio","video","img","source","image","track"]),Y=null,le=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",He="http://www.w3.org/1999/xhtml",Ze=He,st=!1,Ye=null,Me=Xe({},[me,Re,He],Cw),De,dr=["application/xhtml+xml","text/html"],Bt="text/html",Ve,et=null,Ct=n.createElement("form"),ut=function(L){return L instanceof RegExp||L instanceof Function},ct=function(L){et&&et===L||((!L||fi(L)!=="object")&&(L={}),L=zi(L),De=dr.indexOf(L.PARSER_MEDIA_TYPE)===-1?De=Bt:De=L.PARSER_MEDIA_TYPE,Ve=De==="application/xhtml+xml"?Cw:pg,b="ALLOWED_TAGS"in L?Xe({},L.ALLOWED_TAGS,Ve):E,R="ALLOWED_ATTR"in L?Xe({},L.ALLOWED_ATTR,Ve):B,Ye="ALLOWED_NAMESPACES"in L?Xe({},L.ALLOWED_NAMESPACES,Cw):Me,Y="ADD_URI_SAFE_ATTR"in L?Xe(zi(le),L.ADD_URI_SAFE_ATTR,Ve):le,U="ADD_DATA_URI_TAGS"in L?Xe(zi(j),L.ADD_DATA_URI_TAGS,Ve):j,H="FORBID_CONTENTS"in L?Xe({},L.FORBID_CONTENTS,Ve):N,K="FORBID_TAGS"in L?Xe({},L.FORBID_TAGS,Ve):{},Z="FORBID_ATTR"in L?Xe({},L.FORBID_ATTR,Ve):{},W="USE_PROFILES"in L?L.USE_PROFILES:!1,re=L.ALLOW_ARIA_ATTR!==!1,ie=L.ALLOW_DATA_ATTR!==!1,se=L.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=L.SAFE_FOR_TEMPLATES||!1,z=L.WHOLE_DOCUMENT||!1,ke=L.RETURN_DOM||!1,Ie=L.RETURN_DOM_FRAGMENT||!1,Ae=L.RETURN_TRUSTED_TYPE||!1,Be=L.FORCE_BODY||!1,O=L.SANITIZE_DOM!==!1,T=L.SANITIZE_NAMED_PROPS||!1,F=L.KEEP_CONTENT!==!1,M=L.IN_PLACE||!1,m=L.ALLOWED_URI_REGEXP||m,Ze=L.NAMESPACE||He,x=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&ut(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck),L.CUSTOM_ELEMENT_HANDLING&&ut(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(ie=!1),Ie&&(ke=!0),W&&(b=Xe({},fn(OA)),R=[],W.html===!0&&(Xe(b,_A),Xe(R,RA)),W.svg===!0&&(Xe(b,Ow),Xe(R,Tw),Xe(R,gy)),W.svgFilters===!0&&(Xe(b,Rw),Xe(R,Tw),Xe(R,gy)),W.mathMl===!0&&(Xe(b,Ew),Xe(R,EA),Xe(R,gy))),L.ADD_TAGS&&(b===E&&(b=zi(b)),Xe(b,L.ADD_TAGS,Ve)),L.ADD_ATTR&&(R===B&&(R=zi(R)),Xe(R,L.ADD_ATTR,Ve)),L.ADD_URI_SAFE_ATTR&&Xe(Y,L.ADD_URI_SAFE_ATTR,Ve),L.FORBID_CONTENTS&&(H===N&&(H=zi(H)),Xe(H,L.FORBID_CONTENTS,Ve)),F&&(b["#text"]=!0),z&&Xe(b,["html","head","body"]),b.table&&(Xe(b,["tbody"]),delete K.tbody),Cr&&Cr(L),et=L)},tt=Xe({},["mi","mo","mn","ms","mtext"]),Xo=Xe({},["foreignobject","desc","title","annotation-xml"]),Cb=Xe({},["title","style","font","a","script"]),Fi=Xe({},Ow);Xe(Fi,Rw),Xe(Fi,Lae);var jf=Xe({},Ew);Xe(jf,jae);var ZG=function(L){var ae=S(L);(!ae||!ae.tagName)&&(ae={namespaceURI:Ze,tagName:"template"});var de=pg(L.tagName),lt=pg(ae.tagName);return Ye[L.namespaceURI]?L.namespaceURI===Re?ae.namespaceURI===He?de==="svg":ae.namespaceURI===me?de==="svg"&&(lt==="annotation-xml"||tt[lt]):!!Fi[de]:L.namespaceURI===me?ae.namespaceURI===He?de==="math":ae.namespaceURI===Re?de==="math"&&Xo[lt]:!!jf[de]:L.namespaceURI===He?ae.namespaceURI===Re&&!Xo[lt]||ae.namespaceURI===me&&!tt[lt]?!1:!jf[de]&&(Cb[de]||!Fi[de]):!!(De==="application/xhtml+xml"&&Ye[L.namespaceURI]):!1},qn=function(L){ec(t.removed,{element:L});try{L.parentNode.removeChild(L)}catch{try{L.outerHTML=_}catch{L.remove()}}},_b=function(L,ae){try{ec(t.removed,{attribute:ae.getAttributeNode(L),from:ae})}catch{ec(t.removed,{attribute:null,from:ae})}if(ae.removeAttribute(L),L==="is"&&!R[L])if(ke||Ie)try{qn(ae)}catch{}else try{ae.setAttribute(L,"")}catch{}},vk=function(L){var ae,de;if(Be)L="<remove></remove>"+L;else{var lt=xae(L,/^[\r\n\t ]+/);de=lt&&lt[0]}De==="application/xhtml+xml"&&Ze===He&&(L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>");var Rr=k?k.createHTML(L):L;if(Ze===He)try{ae=new h().parseFromString(Rr,De)}catch{}if(!ae||!ae.documentElement){ae=V.createDocument(Ze,"template",null);try{ae.documentElement.innerHTML=st?_:Rr}catch{}}var ir=ae.body||ae.documentElement;return L&&de&&ir.insertBefore(n.createTextNode(de),ir.childNodes[0]||null),Ze===He?q.call(ae,z?"html":"body")[0]:z?ae.documentElement:ir},yk=function(L){return X.call(L.ownerDocument||L,L,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},QG=function(L){return L instanceof c&&(typeof L.nodeName!="string"||typeof L.textContent!="string"||typeof L.removeChild!="function"||!(L.attributes instanceof f)||typeof L.removeAttribute!="function"||typeof L.setAttribute!="function"||typeof L.namespaceURI!="string"||typeof L.insertBefore!="function"||typeof L.hasChildNodes!="function")},Ff=function(L){return fi(a)==="object"?L instanceof a:L&&fi(L)==="object"&&typeof L.nodeType=="number"&&typeof L.nodeName=="string"},Xn=function(L,ae,de){J[L]&&Mae(J[L],function(lt){lt.call(t,ae,de,et)})},gk=function(L){var ae;if(Xn("beforeSanitizeElements",L,null),QG(L)||vr(/[\u0080-\uFFFF]/,L.nodeName))return qn(L),!0;var de=Ve(L.nodeName);if(Xn("uponSanitizeElement",L,{tagName:de,allowedTags:b}),L.hasChildNodes()&&!Ff(L.firstElementChild)&&(!Ff(L.content)||!Ff(L.content.firstElementChild))&&vr(/<[/\w]/g,L.innerHTML)&&vr(/<[/\w]/g,L.textContent)||de==="select"&&vr(/<template/i,L.innerHTML))return qn(L),!0;if(!b[de]||K[de]){if(!K[de]&&pk(de)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de)))return!1;if(F&&!H[de]){var lt=S(L)||L.parentNode,Rr=w(L)||L.childNodes;if(Rr&&lt)for(var ir=Rr.length,or=ir-1;or>=0;--or)lt.insertBefore(y(Rr[or],!0),p(L))}return qn(L),!0}return L instanceof l&&!ZG(L)||(de==="noscript"||de==="noembed")&&vr(/<\/no(script|embed)/i,L.innerHTML)?(qn(L),!0):(Se&&L.nodeType===3&&(ae=L.textContent,ae=ln(ae,ue," "),ae=ln(ae,he," "),ae=ln(ae,Oe," "),L.textContent!==ae&&(ec(t.removed,{element:L.cloneNode()}),L.textContent=ae)),Xn("afterSanitizeElements",L,null),!1)},mk=function(L,ae,de){if(O&&(ae==="id"||ae==="name")&&(de in n||de in Ct))return!1;if(!(ie&&!Z[ae]&&vr(we,ae))){if(!(re&&vr($,ae))){if(!R[ae]||Z[ae]){if(!(pk(L)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,L)||x.tagNameCheck instanceof Function&&x.tagNameCheck(L))&&(x.attributeNameCheck instanceof RegExp&&vr(x.attributeNameCheck,ae)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(ae))||ae==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de))))return!1}else if(!Y[ae]){if(!vr(m,ln(de,g,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&L!=="script"&&Dae(de,"data:")===0&&U[L])){if(!(se&&!vr(P,ln(de,g,"")))){if(de)return!1}}}}}}return!0},pk=function(L){return L.indexOf("-")>0},bk=function(L){var ae,de,lt,Rr;Xn("beforeSanitizeAttributes",L,null);var ir=L.attributes;if(ir){var or={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};for(Rr=ir.length;Rr--;){ae=ir[Rr];var Gv=ae,er=Gv.name,Ob=Gv.namespaceURI;if(de=er==="value"?ae.value:Nae(ae.value),lt=Ve(er),or.attrName=lt,or.attrValue=de,or.keepAttr=!0,or.forceKeepAttr=void 0,Xn("uponSanitizeAttribute",L,or),de=or.attrValue,!or.forceKeepAttr&&(_b(er,L),!!or.keepAttr)){if(!_e&&vr(/\/>/i,de)){_b(er,L);continue}Se&&(de=ln(de,ue," "),de=ln(de,he," "),de=ln(de,Oe," "));var wk=Ve(L.nodeName);if(mk(wk,lt,de)){if(T&&(lt==="id"||lt==="name")&&(_b(er,L),de=I+de),k&&fi(d)==="object"&&typeof d.getAttributeType=="function"&&!Ob)switch(d.getAttributeType(wk,lt)){case"TrustedHTML":de=k.createHTML(de);break;case"TrustedScriptURL":de=k.createScriptURL(de);break}try{Ob?L.setAttributeNS(Ob,er,de):L.setAttribute(er,de),CA(t.removed)}catch{}}}}Xn("afterSanitizeAttributes",L,null)}},JG=function Ee(L){var ae,de=yk(L);for(Xn("beforeSanitizeShadowDOM",L,null);ae=de.nextNode();)Xn("uponSanitizeShadowNode",ae,null),!gk(ae)&&(ae.content instanceof o&&Ee(ae.content),bk(ae));Xn("afterSanitizeShadowDOM",L,null)};return t.sanitize=function(Ee){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,de,lt,Rr,ir;if(st=!Ee,st&&(Ee="<!-->"),typeof Ee!="string"&&!Ff(Ee)){if(typeof Ee.toString!="function")throw _w("toString is not a function");if(Ee=Ee.toString(),typeof Ee!="string")throw _w("dirty is not a string, aborting")}if(!t.isSupported){if(fi(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(Ff(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Ne||ct(L),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var or=Ve(Ee.nodeName);if(!b[or]||K[or])throw _w("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)ae=vk("<!---->"),de=ae.ownerDocument.importNode(Ee,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?ae=de:ae.appendChild(de);else{if(!ke&&!Se&&!z&&Ee.indexOf("<")===-1)return k&&Ae?k.createHTML(Ee):Ee;if(ae=vk(Ee),!ae)return ke?null:Ae?_:""}ae&&Be&&qn(ae.firstChild);for(var Gv=yk(M?Ee:ae);lt=Gv.nextNode();)lt.nodeType===3&&lt===Rr||gk(lt)||(lt.content instanceof o&&JG(lt.content),bk(lt),Rr=lt);if(Rr=null,M)return Ee;if(ke){if(Ie)for(ir=G.call(ae.ownerDocument);ae.firstChild;)ir.appendChild(ae.firstChild);else ir=ae;return(R.shadowroot||R.shadowrootmod)&&(ir=Q.call(r,ir,!0)),ir}var er=z?ae.outerHTML:ae.innerHTML;return z&&b["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&vr(Kae,ae.ownerDocument.doctype.name)&&(er="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+er),Se&&(er=ln(er,ue," "),er=ln(er,he," "),er=ln(er,Oe," ")),k&&Ae?k.createHTML(er):er},t.setConfig=function(Ee){ct(Ee),Ne=!0},t.clearConfig=function(){et=null,Ne=!1},t.isValidAttribute=function(Ee,L,ae){et||ct({});var de=Ve(Ee),lt=Ve(L);return mk(de,lt,ae)},t.addHook=function(Ee,L){typeof L=="function"&&(J[Ee]=J[Ee]||[],ec(J[Ee],L))},t.removeHook=function(Ee){if(J[Ee])return CA(J[Ee])},t.removeHooks=function(Ee){J[Ee]&&(J[Ee]=[])},t.removeAllHooks=function(){J={}},t}var Zae=yW();function ur(e){return e[0].toUpperCase()+e.substr(1)}function Qae(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=Dt(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function NE(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function HE(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function LE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function r_(e){return qp("".concat(e),{ALLOWED_TAGS:[]})}function qp(e,t){return Zae.sanitize(e,t)}const Jae=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Qae,isPercentValue:HE,randomString:NE,sanitize:qp,stripTags:r_,substitute:LE,toUpperCaseFirst:ur},Symbol.toStringTag,{value:"Module"}));function TA(e){return nle(e)||rle(e)||tle(e)||ele()}function ele(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tle(e,t){if(e){if(typeof e=="string")return n_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n_(e,t)}}function rle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nle(e){if(Array.isArray(e))return n_(e)}function n_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gW(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function mW(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Jc(e){return mW(e)&&e.parent}function ole(e){return!!Object.getPrototypeOf(e.parent)}function pi(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function Rc(e,t,r){for(var n=[],o=e;o&&(o=pi(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function bi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function pW(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function si(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var o_,i_,a_;function my(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(uW()){var PA=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};o_=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},i_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=my(o),o.length>0)if(PA(n)){var i;(i=t.classList).add.apply(i,TA(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},a_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=my(o),o.length>0)if(PA(n)){var i;(i=t.classList).remove.apply(i,TA(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var Pw=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};o_=function(t,r){return t.className!==void 0&&Pw(r).test(t.className)},i_=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=my(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!Pw(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},a_=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=my(i);i[n];)o=o.replace(Pw(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return o_(e,t)}function te(e,t){i_(e,t)}function Le(e,t){a_(e,t)}function jE(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)jE(t[r])}function _n(e){for(var t;t=e.lastChild;)e.removeChild(t)}var bW=/(<(.*)>|&(.*);)/;function fl(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;bW.test(t)?e.innerHTML=r?qp(t):t:Ii(e,t)}function Ii(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?fW?r.textContent=t:r.data=t:(_n(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function bs(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return bs(r.host.impl);if(r.host)return bs(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Ut(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(DE()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function ws(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Wa(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function eh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?ws(t):e.scrollTop}function sm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Wa(t):e.scrollLeft}function th(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=cW(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function Ua(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Mi(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function Ss(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Mi(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function ile(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Mi(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ht(e){return e.offsetWidth}function Pt(e){return DE()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function vo(e){return e.clientHeight||e.innerHeight}function xc(e){return e.clientWidth||e.innerWidth}function ale(e,t,r){e.addEventListener(t,r,!1)}function lle(e,t,r){e.removeEventListener(t,r,!1)}function FE(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function wW(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function SW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function l_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function kv(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var kw;function sle(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Jt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return kw===void 0&&(kw=sle(e)),kw}function CW(e){return e.offsetWidth!==e.clientWidth}function _W(e){return e.offsetHeight!==e.clientHeight}function Xp(e,t,r){rW()?(e.style.top=r,e.style.left=t):JV()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function ule(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function $v(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function rh(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Zp(e){return rh(e)&&e.hasAttribute("data-hot-input")===!1}function OW(e){var t=e.ownerDocument.activeElement;Zp(t)||e.select()}function BE(e){return!e.parentNode}function RW(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const fle=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:bW,addClass:te,addEvent:ale,clearTextSelection:l_,closest:pi,closestDown:Rc,empty:_n,fastInnerHTML:fl,fastInnerText:Ii,getCaretPosition:FE,getComputedStyle:Mi,getCssTransform:ule,getFrameElement:mW,getParent:gW,getParentWindow:Jc,getScrollLeft:sm,getScrollTop:eh,getScrollableElement:th,getScrollbarWidth:Jt,getSelectionEndPosition:wW,getSelectionText:SW,getStyle:Ss,getTrimmingContainer:Ua,getWindowScrollLeft:Wa,getWindowScrollTop:ws,hasAccessToParentWindow:ole,hasClass:xe,hasHorizontalScrollbar:_W,hasVerticalScrollbar:CW,index:pW,innerHeight:vo,innerWidth:xc,isChildOf:bi,isDetached:BE,isInput:rh,isOutsideInput:Zp,isVisible:bs,matchesCSSRules:ile,observeVisibilityChangeOnce:RW,offset:Ut,outerHeight:Pt,outerWidth:ht,overlayContainsElement:si,removeClass:Le,removeEvent:lle,removeTextNodes:jE,resetCssTransform:$v,selectElementIfAllowed:OW,setCaretPosition:kv,setOverlayPosition:Xp},Symbol.toStringTag,{value:"Module"}));var cle=bp,hle=jV;cle("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},hle);var dle=Yt,vle=Pf,yle=TypeError,gle=Object.getOwnPropertyDescriptor,mle=dle&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),ple=mle?function(e,t){if(vle(e)&&!gle(e,"length").writable)throw yle("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},ble=$e,wle=Ir,Sle=nv,Cle=Hi,_le=en,Ole=ple,Rle=DV,Ele=L0,Tle=Tf,$w=VF,Ple=pv,kle=Ple("splice"),$le=Math.max,Ale=Math.min;ble({target:"Array",proto:!0,forced:!kle},{splice:function(t,r){var n=wle(this),o=_le(n),i=Sle(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=Ale($le(Cle(r),0),o-i)),Rle(o+l-s),u=Ele(n,s),f=0;f<s;f++)c=i+f,c in n&&Tle(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:$w(n,h);for(f=o;f>o-s+l;f--)$w(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:$w(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return Ole(n,o-s+l),u}});function wt(){if(ve(console)){var e;(e=console).warn.apply(e,arguments)}}function VE(){if(ve(console)){var e;(e=console).error.apply(e,arguments)}}var Ile=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",Mle=TypeError,EW=function(e,t){if(e<t)throw Mle("Not enough arguments");return e},TW=vt,xle=sl,Dle=Rt,Nle=Ile,Hle=tl,Lle=Sv,jle=EW,Fle=TW.Function,Ble=/MSIE .\./.test(Hle)||Nle&&function(){var e=TW.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),WE=function(e,t){var r=t?2:1;return Ble?function(n,o){var i=jle(arguments.length,1)>r,a=Dle(n)?n:Fle(n),l=i?Lle(arguments,r):[],s=i?function(){xle(a,this,l)}:a;return t?e(s,o):e(s)}:e},Vle=$e,PW=vt,Wle=WE,kA=Wle(PW.setInterval,!0);Vle({global:!0,bind:!0,forced:PW.setInterval!==kA},{setInterval:kA});var Ule=$e,kW=vt,zle=WE,$A=zle(kW.setTimeout,!0);Ule({global:!0,bind:!0,forced:kW.setTimeout!==$A},{setTimeout:$A});var Gle=$e,Yle=Ge,Kle=Pf,qle=Yle([].reverse),AA=[1,2];Gle({target:"Array",proto:!0,forced:String(AA)===String(AA.reverse())},{reverse:function(){return Kle(this)&&(this.length=this.length),qle(this)}});function pt(e){return typeof e=="function"}function $W(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,s),r=0,o=void 0},h)),n}return i}function Xle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=$W(e,t),o=r;function i(){o=r}function a(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return o?(o-=1,e.apply(this,s)):n.apply(this,s)}return a.clearHits=i,a}function UE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function Zle(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return Ft(o,function(u,f){return f(u)},n.apply(this,l))}}function zE(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function AW(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function Qle(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a.reverse()),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function um(e,t,r,n,o,i,a,l){return ve(l)?e.call(t,r,n,o,i,a,l):ve(a)?e.call(t,r,n,o,i,a):ve(i)?e.call(t,r,n,o,i):ve(o)?e.call(t,r,n,o):ve(n)?e.call(t,r,n):ve(r)?e.call(t,r):e.call(t)}const Jle=Object.freeze(Object.defineProperty({__proto__:null,curry:AW,curryRight:Qle,debounce:UE,fastCall:um,isFunction:pt,partial:zE,pipe:Zle,throttle:$W,throttleAfterHits:Xle},Symbol.toStringTag,{value:"Module"}));function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}var IA;function ese(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rse(n.key),n)}}function tse(e,t,r){return t&&MA(e.prototype,t),r&&MA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rse(e){var t=nse(e,"string");return nh(t)==="symbol"?t:String(t)}function nse(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ose(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var wl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],ise=dt(IA||(IA=ose([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Aw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Iw=new Map([]),IW=function(){function e(){ese(this,e),this.globalBucket=this.createEmptyBucket()}return tse(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return A(wl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))A(n,function(s){return o.add(r,s,i)});else{Aw.has(r)&&wt(LE(ise,{hookName:r,removedInVersion:Aw.get(r)})),Iw.has(r)&&wt(Iw.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&A(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?A(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=um(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],y=v?v.length:0,p=0;if(y)for(;p<y;){if(!v[p]||v[p].skip){p+=1;continue}var w=um(v[p],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[p]&&v[p].runOnce&&this.remove(n,v[p],r),p+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ze(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||wl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&wl.splice(wl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Iw.has(r)||Aw.has(r)}},{key:"isRegistered",value:function(r){return wl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return wl}}],[{key:"getSingleton",value:function(){return lse()}}]),e}(),ase=new IW;function lse(){return ase}const ge=IW;function xA(e){return cse(e)||fse(e)||use(e)||sse()}function sse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function use(e,t){if(e){if(typeof e=="string")return s_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s_(e,t)}}function fse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cse(e){if(Array.isArray(e))return s_(e)}function s_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Mw=new Map;function on(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Mw.has(e)||Mw.set(e,new Map);var t=Mw.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return xA(t.keys())}function a(){return xA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var u_=new WeakMap,Av=on("editors"),hse=Av.register,MW=Av.getItem,xW=Av.hasItem,dse=Av.getNames;Av.getValues;function vse(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ge.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function DW(e,t){var r;if(typeof e=="function")u_.get(e)||Pr(null,e),r=u_.get(e);else if(typeof e=="string")r=MW(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function fm(e){if(typeof e=="function")return e;if(!xW(e))throw Error('No registered editor found under "'.concat(e,'" name'));return MW(e).getConstructor()}function Pr(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new vse(t);typeof e=="string"&&hse(e,r),u_.set(t,r)}function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function yse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mse(n.key),n)}}function gse(e,t,r){return t&&DA(e.prototype,t),r&&DA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mse(e){var t=pse(e,"string");return oh(t)==="symbol"?t:String(t)}function pse(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bg=0,bse=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;yse(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return gse(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,wse(s))}return typeof a!="boolean"&&!dW()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),bg+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),bg-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),bg-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function wse(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Sn(this)},e}const kt=bse;function Sse(){return bg}function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function Cse(e,t){return Ese(e)||Rse(e,t)||Ose(e,t)||_se()}function _se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ose(e,t){if(e){if(typeof e=="string")return NA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NA(e,t)}}function NA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Ese(e){if(Array.isArray(e))return e}function Tse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kse(n.key),n)}}function Pse(e,t,r){return t&&HA(e.prototype,t),r&&HA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kse(e){var t=$se(e,"string");return ih(t)==="symbol"?t:String(t)}function $se(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qp="editorManager.navigation",Dc="editorManager.handlingEditor",f_=function(){function e(t,r,n){var o=this;Tse(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new kt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return Pse(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:Dc};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),Sn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=Cse(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&Zp(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=DW(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!IE(o)&&!oW(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ve(n.instance.getSelected())},group:Qp};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),LA=new WeakMap;f_.getInstance=function(e,t,r){var n=LA.get(e);return n||(n=new f_(e,t,r),LA.set(e,n)),n};const Ase=f_;var Ise="hooksRefRegisterer",NW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;A(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;ze(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Kn(NW,"MIXIN_NAME",Ise,{writable:!1,enumerable:!1});const Mse=NW;function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function xse(e,t){return Lse(e)||Hse(e,t)||Nse(e,t)||Dse()}function Dse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nse(e,t){if(e){if(typeof e=="string")return jA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jA(e,t)}}function jA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Lse(e){if(Array.isArray(e))return e}function jse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c_(e,t)}function c_(e,t){return c_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},c_(e,t)}function Fse(e){var t=Wse();return function(){var n=cm(e),o;if(t){var i=cm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bse(this,o)}}function Bse(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vse(e)}function Vse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cm(e){return cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cm(e)}function FA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Use(n.key),n)}}function VA(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Use(e){var t=zse(e,"string");return Cs(t)==="symbol"?t:String(t)}function zse(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gse="base",tr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),h_="baseEditor",Mf=function(){function e(t){FA(this,e),this.hot=t,this.instance=t,this.state=tr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return VA(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=tr.VIRGIN}},{key:"extend",value:function(){return function(r){jse(o,r);var n=Fse(o);function o(){return FA(this,o),n.apply(this,arguments)}return VA(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=xse(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),y={runOnlyIf:function(){return ve(o.hot.getSelected())},group:h_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===tr.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=tr.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:Dt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(h_),u.removeShortcutsByGroup(Qp),this.state===tr.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===tr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=tr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=tr.FINISHED,i.discardEditor(c)}):(this.state=tr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=tr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===tr.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=tr.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=tr.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===tr.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Ut(n),u=ht(n),f=Ut(this.hot.rootElement),c=ht(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,y=d!==l?d.scrollLeft:0,p=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,C=S.name,k=["master","inline_start"].includes(C)?v:0,_=["master","top","bottom"].includes(C)?y:0,D=s.top===f.top?0:1,V=s.top-f.top-D-k,X=0;this.hot.isRtl()?X=l.innerWidth-s.left-u-p-1+_:X=s.left-f.left-1-_,["top","top_inline_start_corner"].includes(C)&&(V+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(X+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var G=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ne=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=ne-this.hot.view._wt.getSetting("fixedRowsBottom");(G&&q<=0||q===J)&&(V+=1),Q<=0&&(X+=1);var ue=a.rowsRenderCalculator.startPosition,he=a.columnsRenderCalculator.startPosition,Oe=Math.abs(i.inlineStartOverlay.getScrollPosition()),we=i.topOverlay.getScrollPosition(),$=Jt(this.hot.rootDocument),P=n.offsetTop+ue-we,g=0;if(this.hot.isRtl()){var m=n.offsetLeft;m>=0?g=S.getWidth()-n.offsetLeft:g=Math.abs(m),g+=he-Oe-u}else g=n.offsetLeft+he-Oe;var b=Mi(this.TD,this.hot.rootWindow),E=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",R=parseInt(b[E],10)>0?0:1,B=parseInt(b.borderTopWidth,10)>0?0:1,x=ht(n)+R,K=Pt(n)+B,Z=CW(h)?$:0,re=_W(d)?$:0,ie=this.hot.view.maximumVisibleElementWidth(g)-Z+R,se=Math.max(this.hot.view.maximumVisibleElementHeight(P)-re+B,23);return{top:V,start:X,height:K,maxHeight:se,width:x,maxWidth:ie}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return Gse}}]),e}();gt(Mf,Mse);var Yse=$e,Kse=ll.map,qse=pv,Xse=qse("map");Yse({target:"Array",proto:!0,forced:!Xse},{map:function(t){return Kse(this,t,arguments.length>1?arguments[1]:void 0)}});function Zse(e){return tue(e)||eue(e)||Jse(e)||Qse()}function Qse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jse(e,t){if(e){if(typeof e=="string")return d_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d_(e,t)}}function eue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tue(e){if(Array.isArray(e))return d_(e)}function d_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v_(e){"@babel/helpers - typeof";return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}function wr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=v_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(Zse(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function HW(e){return wr(e,[","])}function Ce(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function hm(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function GE(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const rue=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:wr,isNumericLike:HW,rangeEach:Ce,rangeEachReverse:hm,valueAccordingPercent:GE},Symbol.toStringTag,{value:"Module"}));function nue(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,y){d.addEventListener(v,y,!1)},a=function(d,v,y){d.removeEventListener(v,y,!1)},l=function(d){var v,y;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(d.maxHeight);isNaN(y)||(e.maxHeight=y)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var p=parseInt(d.minWidth);isNaN(p)||(e.minWidth=p)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,y){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,y){f(d,v,y)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function WA(e,t){for(var r=FE(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}kv(t,o)}function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function UA(e,t){return lue(e)||aue(e,t)||iue(e,t)||oue()}function oue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iue(e,t){if(e){if(typeof e=="string")return zA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zA(e,t)}}function zA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aue(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lue(e){if(Array.isArray(e))return e}function sue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fue(n.key),n)}}function uue(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fue(e){var t=cue(e,"string");return _s(t)==="symbol"?t:String(t)}function cue(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nc(){return typeof Reflect<"u"&&Reflect.get?Nc=Reflect.get.bind():Nc=function(t,r,n){var o=hue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Nc.apply(this,arguments)}function hue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=za(e),e!==null););return e}function due(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},y_(e,t)}function vue(e){var t=gue();return function(){var n=za(e),o;if(t){var i=za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yue(this,o)}}function yue(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LW(e)}function LW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function za(e){return za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},za(e)}var mue="ht_editor_visible",py="ht_editor_hidden",YA="textEditor",pue="text",cl=function(e){due(r,e);var t=vue(r);function r(n){var o;return sue(this,r),o=t.call(this,n),o.eventManager=new kt(LW(o)),o.autoResize=nue(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return uue(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(Nc(za(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==tr.FINISHED&&this.hideEditableElement();var d=!h;d&&!pn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===tr.VIRGIN&&(this.TEXTAREA.value="",Nc(za(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),kv(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,py),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(tW()||eW())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,py)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Ce(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,py)&&Le(this.TEXTAREA_PARENT,py),i?(this.layerClass=mue,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==tr.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Mi(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Mi(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),y=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),p=s-v,w=f-y,S=u-v,C=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(p,S),minHeight:Math.min(w,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),$E()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ve(o.hot.getSelected())},group:YA},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:Dc,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:Dc,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:Dc,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=UA(c,1),d=h[0];WA(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=UA(c,1),d=h[0];WA(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Qp),i.removeShortcutsByGroup(YA),i.removeShortcutsByGroup(h_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[pe.ARROW_UP,pe.ARROW_RIGHT,pe.ARROW_DOWN,pe.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return pue}}]),r}(Mf);function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function bue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sue(n.key),n)}}function wue(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sue(e){var t=Cue(e,"string");return Os(t)==="symbol"?t:String(t)}function Cue(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dn(){return typeof Reflect<"u"&&Reflect.get?dn=Reflect.get.bind():dn=function(t,r,n){var o=_ue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dn.apply(this,arguments)}function _ue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fr(e),e!==null););return e}function Oue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g_(e,t)}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},g_(e,t)}function Rue(e){var t=Pue();return function(){var n=Fr(e),o;if(t){var i=Fr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Eue(this,o)}}function Eue(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tue(e)}function Tue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fr(e)}var qA="handsontableEditor",kue="handsontable",YE=function(e){Oue(r,e);var t=Rue(r);function r(){return bue(this,r),t.apply(this,arguments)}return wue(r,[{key:"open",value:function(){dn(Fr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),kv(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),dn(Fr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){dn(Fr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var y=this.getSourceData(v.row,v.col);y!==void 0&&f.setValue(y),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&zt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||dn(Fr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){dn(Fr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}dn(Fr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");dn(Fr(r.prototype),"registerShortcuts",this).call(this);var l={group:qA,relativeToGroup:Qp,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),Sn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){dn(Fr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(qA)}}],[{key:"EDITOR_TYPE",get:function(){return kue}}]),r}(cl),$ue="base";function xf(e,t,r,n,o,i,a){var l=[],s=[];a.className&&te(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Le(t,s),te(t,l)}xf.RENDERER_TYPE=$ue;var Aue="text";function Li(e,t,r,n,o,i,a){xf.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Dt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){_n(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ii(t,l)}Li.RENDERER_TYPE=Aue;function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function Iue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jW(n.key),n)}}function Mue(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=xue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function xue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function Due(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function Nue(e){var t=Lue();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Hue(this,o)}}function Hue(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p_(e)}function p_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}function jue(e,t,r){return t=jW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jW(e){var t=Fue(e,"string");return Rs(t)==="symbol"?t:String(t)}function Fue(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xw=new WeakMap,Bue="autocomplete",KE=function(e){Due(r,e);var t=Nue(r);function r(n){var o;return Iue(this,r),o=t.call(this,n),jue(p_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,y;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=r_(Dt(a[v])),l)y=d.indexOf(i);else{var p=this.cellProperties.locale;y=d.toLocaleLowerCase(p).indexOf(i.toLocaleLowerCase(p))}y!==-1&&(h=d.length-y-f,s.push({baseIndex:v,index:y,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],xw.set(p_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return Mue(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ve(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){ha(yo(r.prototype),"createElements",this).call(this),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=xw.get(this);ha(yo(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Jt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[ht(this.TEXTAREA)-2]:void 0,width:l?ht(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,y,p){Li(f,c,h,d,v,y,p);var w=o.cellProperties,S=w.filteringCaseSensitive,C=w.allowHtml,k=w.locale,_=o.query,D=Dt(y),V,X;D&&!C&&(V=S===!0?D.indexOf(_):D.toLocaleLowerCase(k).indexOf(_.toLocaleLowerCase(k)),V!==-1&&(X=D.substr(V,_.length),D=D.replace(X,"<strong>".concat(X,"</strong>")))),c.innerHTML=D},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),ha(yo(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){ha(yo(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=FE(this.TEXTAREA),a=wW(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,y=c.length;v<y&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Ac([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),kv(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Ua(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Ut(this.TEXTAREA),s=Pt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Pt(this.hot.view._wt.wtTable.THEAD),h=Ut(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,y=u>v&&d>v;return y?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(y?d:v,u),y}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=We(o,function(s){return Dt(s)}),l=We(a,function(s){return i?s:r_(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===pe.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===pe.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=xw.get(this);if(a.skipOne=!1,nW(o.keyCode)||o.keyCode===pe.BACKSPACE||o.keyCode===pe.DELETE||o.keyCode===pe.INSERT){var l=10;if(o.keyCode===pe.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return Bue}}]),r}(YE);function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function Vue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uue(n.key),n)}}function Wue(e,t,r){return t&&ZA(e.prototype,t),r&&ZA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uue(e){var t=zue(e,"string");return Es(t)==="symbol"?t:String(t)}function zue(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b_(e,t)}function b_(e,t){return b_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},b_(e,t)}function Yue(e){var t=Xue();return function(){var n=dm(e),o;if(t){var i=dm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kue(this,o)}}function Kue(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return que(e)}function que(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dm(e){return dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dm(e)}var Zue="checkbox",FW=function(e){Gue(r,e);var t=Yue(r);function r(){return Vue(this,r),t.apply(this,arguments)}return Wue(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return Zue}}]),r}(Mf),BW={exports:{}};const Que=aY(Kne);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=Que}catch{}e.exports=n(o)}})(rg,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function($,P,g,m){o?$.addEventListener(P,g,!!m):$.attachEvent("on"+P,g)},s=function($,P,g,m){o?$.removeEventListener(P,g,!!m):$.detachEvent("on"+P,g)},u=function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},f=function($,P){return(" "+$.className+" ").indexOf(" "+P+" ")!==-1},c=function($,P){f($,P)||($.className=$.className===""?P:$.className+" "+P)},h=function($,P){$.className=u((" "+$.className+" ").replace(" "+P+" "," "))},d=function($){return/Array/.test(Object.prototype.toString.call($))},v=function($){return/Date/.test(Object.prototype.toString.call($))&&!isNaN($.getTime())},y=function($){var P=$.getDay();return P===0||P===6},p=function($){return $%4===0&&$%100!==0||$%400===0},w=function($,P){return[31,p($)?29:28,31,30,31,30,31,31,30,31,30,31][P]},S=function($){v($)&&$.setHours(0,0,0,0)},C=function($,P){return $.getTime()===P.getTime()},k=function($,P,g){var m,b;for(m in P)b=$[m]!==void 0,b&&typeof P[m]=="object"&&P[m]!==null&&P[m].nodeName===void 0?v(P[m])?g&&($[m]=new Date(P[m].getTime())):d(P[m])?g&&($[m]=P[m].slice(0)):$[m]=k({},P[m],g):(g||!b)&&($[m]=P[m]);return $},_=function($,P,g){var m;i.createEvent?(m=i.createEvent("HTMLEvents"),m.initEvent(P,!0,!1),m=k(m,g),$.dispatchEvent(m)):i.createEventObject&&(m=i.createEventObject(),m=k(m,g),$.fireEvent("on"+P,m))},D=function($){return $.month<0&&($.year-=Math.ceil(Math.abs($.month)/12),$.month+=12),$.month>11&&($.year+=Math.floor(Math.abs($.month)/12),$.month-=12),$},V={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},X=function($,P,g){for(P+=$.firstDay;P>=7;)P-=7;return g?$.i18n.weekdaysShort[P]:$.i18n.weekdays[P]},G=function($){var P=[],g="false";if($.isEmpty)if($.showDaysInNextAndPreviousMonths)P.push("is-outside-current-month"),$.enableSelectionDaysInNextAndPreviousMonths||P.push("is-selection-disabled");else return'<td class="is-empty"></td>';return $.isDisabled&&P.push("is-disabled"),$.isToday&&P.push("is-today"),$.isSelected&&(P.push("is-selected"),g="true"),$.hasEvent&&P.push("has-event"),$.isInRange&&P.push("is-inrange"),$.isStartRange&&P.push("is-startrange"),$.isEndRange&&P.push("is-endrange"),'<td data-day="'+$.day+'" class="'+P.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+$.year+'" data-pika-month="'+$.month+'" data-pika-day="'+$.day+'">'+$.day+"</button></td>"},q=function($,P){$.setHours(0,0,0,0);var g=$.getDate(),m=$.getDay(),b=P,E=b-1,R=7,B=function(ie){return(ie+R-1)%R};$.setDate(g+E-B(m));var x=new Date($.getFullYear(),0,b),K=24*60*60*1e3,Z=($.getTime()-x.getTime())/K,re=1+Math.round((Z-E+B(x.getDay()))/R);return re},Q=function($,P,g,m){var b=new Date(g,P,$),E=n?r(b).isoWeek():q(b,m);return'<td class="pika-week">'+E+"</td>"},ne=function($,P,g,m){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(P?$.reverse():$).join("")+"</tr>"},J=function($){return"<tbody>"+$.join("")+"</tbody>"},ue=function($){var P,g=[];for($.showWeekNumber&&g.push("<th></th>"),P=0;P<7;P++)g.push('<th scope="col"><abbr title="'+X($,P)+'">'+X($,P,!0)+"</abbr></th>");return"<thead><tr>"+($.isRTL?g.reverse():g).join("")+"</tr></thead>"},he=function($,P,g,m,b,E){var R,B,x,K=$._o,Z=g===K.minYear,re=g===K.maxYear,ie='<div id="'+E+'" class="pika-title" role="heading" aria-live="assertive">',se,_e,Se=!0,z=!0;for(x=[],R=0;R<12;R++)x.push('<option value="'+(g===b?R-P:12+R-P)+'"'+(R===m?' selected="selected"':"")+(Z&&R<K.minMonth||re&&R>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[R]+"</option>");for(se='<div class="pika-label">'+K.i18n.months[m]+'<select class="pika-select pika-select-month" tabindex="-1">'+x.join("")+"</select></div>",d(K.yearRange)?(R=K.yearRange[0],B=K.yearRange[1]+1):(R=g-K.yearRange,B=1+g+K.yearRange),x=[];R<B&&R<=K.maxYear;R++)R>=K.minYear&&x.push('<option value="'+R+'"'+(R===g?' selected="selected"':"")+">"+R+"</option>");return _e='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+x.join("")+"</select></div>",K.showMonthAfterYear?ie+=_e+se:ie+=se+_e,Z&&(m===0||K.minMonth>=m)&&(Se=!1),re&&(m===11||K.maxMonth<=m)&&(z=!1),P===0&&(ie+='<button class="pika-prev'+(Se?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),P===$._o.numberOfMonths-1&&(ie+='<button class="pika-next'+(z?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),ie+="</div>"},Oe=function($,P,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ue($)+J(P)+"</table>"},we=function($){var P=this,g=P.config($);P._onMouseDown=function(b){if(P._v){b=b||window.event;var E=b.target||b.srcElement;if(E)if(f(E,"is-disabled")||(f(E,"pika-button")&&!f(E,"is-empty")&&!f(E.parentNode,"is-disabled")?(P.setDate(new Date(E.getAttribute("data-pika-year"),E.getAttribute("data-pika-month"),E.getAttribute("data-pika-day"))),g.bound&&a(function(){P.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):f(E,"pika-prev")?P.prevMonth():f(E,"pika-next")&&P.nextMonth()),f(E,"pika-select"))P._c=!0;else if(b.preventDefault)b.preventDefault();else return b.returnValue=!1,!1}},P._onChange=function(b){b=b||window.event;var E=b.target||b.srcElement;E&&(f(E,"pika-select-month")?P.gotoMonth(E.value):f(E,"pika-select-year")&&P.gotoYear(E.value))},P._onKeyChange=function(b){if(b=b||window.event,P.isVisible())switch(b.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:P.adjustDate("subtract",1);break;case 38:P.adjustDate("subtract",7);break;case 39:P.adjustDate("add",1);break;case 40:P.adjustDate("add",7);break;case 8:case 46:P.setDate(null);break}},P._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var b=r(g.field.value,g.format,g.formatStrict);return b&&b.isValid()?b.toDate():null}else return new Date(Date.parse(g.field.value))},P._onInputChange=function(b){var E;b.firedBy!==P&&(E=P._parseFieldValue(),v(E)&&P.setDate(E),P._v||P.show())},P._onInputFocus=function(){P.show()},P._onInputClick=function(){P.show()},P._onInputBlur=function(){var b=i.activeElement;do if(f(b,"pika-single"))return;while(b=b.parentNode);P._c||(P._b=a(function(){P.hide()},50)),P._c=!1},P._onClick=function(b){b=b||window.event;var E=b.target||b.srcElement,R=E;if(E){!o&&f(E,"pika-select")&&(E.onchange||(E.setAttribute("onchange","return;"),l(E,"change",P._onChange)));do if(f(R,"pika-single")||R===g.trigger)return;while(R=R.parentNode);P._v&&E!==g.trigger&&R!==g.trigger&&P.hide()}},P.el=i.createElement("div"),P.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),l(P.el,"mousedown",P._onMouseDown,!0),l(P.el,"touchend",P._onMouseDown,!0),l(P.el,"change",P._onChange),g.keyboardInput&&l(i,"keydown",P._onKeyChange),g.field&&(g.container?g.container.appendChild(P.el):g.bound?i.body.appendChild(P.el):g.field.parentNode.insertBefore(P.el,g.field.nextSibling),l(g.field,"change",P._onInputChange),g.defaultDate||(g.defaultDate=P._parseFieldValue(),g.setDefaultDate=!0));var m=g.defaultDate;v(m)?g.setDefaultDate?P.setDate(m,!0):P.gotoDate(m):P.gotoDate(new Date),g.bound?(this.hide(),P.el.className+=" is-bound",l(g.trigger,"click",P._onInputClick),l(g.trigger,"focus",P._onInputFocus),l(g.trigger,"blur",P._onInputBlur)):this.show()};return we.prototype={config:function($){this._o||(this._o=k({},V,!0));var P=k(this._o,$,!0);P.isRTL=!!P.isRTL,P.field=P.field&&P.field.nodeName?P.field:null,P.theme=typeof P.theme=="string"&&P.theme?P.theme:null,P.bound=!!(P.bound!==void 0?P.field&&P.bound:P.field),P.trigger=P.trigger&&P.trigger.nodeName?P.trigger:P.field,P.disableWeekends=!!P.disableWeekends,P.disableDayFn=typeof P.disableDayFn=="function"?P.disableDayFn:null;var g=parseInt(P.numberOfMonths,10)||1;if(P.numberOfMonths=g>4?4:g,v(P.minDate)||(P.minDate=!1),v(P.maxDate)||(P.maxDate=!1),P.minDate&&P.maxDate&&P.maxDate<P.minDate&&(P.maxDate=P.minDate=!1),P.minDate&&this.setMinDate(P.minDate),P.maxDate&&this.setMaxDate(P.maxDate),d(P.yearRange)){var m=new Date().getFullYear()-10;P.yearRange[0]=parseInt(P.yearRange[0],10)||m,P.yearRange[1]=parseInt(P.yearRange[1],10)||m}else P.yearRange=Math.abs(parseInt(P.yearRange,10))||V.yearRange,P.yearRange>100&&(P.yearRange=100);return P},toString:function($){return $=$||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,$):n?r(this._d).format($):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function($,P){n&&r.isMoment($)&&this.setDate($.toDate(),P)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function($,P){if(!$)return this._d=null,this._o.field&&(this._o.field.value="",_(this._o.field,"change",{firedBy:this})),this.draw();if(typeof $=="string"&&($=new Date(Date.parse($))),!!v($)){var g=this._o.minDate,m=this._o.maxDate;v(g)&&$<g?$=g:v(m)&&$>m&&($=m),this._d=new Date($.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),_(this._o.field,"change",{firedBy:this})),!P&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function($){var P=!0;if(v($)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),m=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),b=$.getTime();m.setMonth(m.getMonth()+1),m.setDate(m.getDate()-1),P=b<g.getTime()||m.getTime()<b}P&&(this.calendars=[{month:$.getMonth(),year:$.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function($,P){var g=this.getDate()||new Date,m=parseInt(P)*24*60*60*1e3,b;$==="add"?b=new Date(g.valueOf()+m):$==="subtract"&&(b=new Date(g.valueOf()-m)),this.setDate(b)},adjustCalendars:function(){this.calendars[0]=D(this.calendars[0]);for(var $=1;$<this._o.numberOfMonths;$++)this.calendars[$]=D({month:this.calendars[0].month+$,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function($){isNaN($)||(this.calendars[0].month=parseInt($,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function($){isNaN($)||(this.calendars[0].year=parseInt($,10),this.adjustCalendars())},setMinDate:function($){$ instanceof Date?(S($),this._o.minDate=$,this._o.minYear=$.getFullYear(),this._o.minMonth=$.getMonth()):(this._o.minDate=V.minDate,this._o.minYear=V.minYear,this._o.minMonth=V.minMonth,this._o.startRange=V.startRange),this.draw()},setMaxDate:function($){$ instanceof Date?(S($),this._o.maxDate=$,this._o.maxYear=$.getFullYear(),this._o.maxMonth=$.getMonth()):(this._o.maxDate=V.maxDate,this._o.maxYear=V.maxYear,this._o.maxMonth=V.maxMonth,this._o.endRange=V.endRange),this.draw()},setStartRange:function($){this._o.startRange=$},setEndRange:function($){this._o.endRange=$},draw:function($){if(!(!this._v&&!$)){var P=this._o,g=P.minYear,m=P.maxYear,b=P.minMonth,E=P.maxMonth,R="",B;this._y<=g&&(this._y=g,!isNaN(b)&&this._m<b&&(this._m=b)),this._y>=m&&(this._y=m,!isNaN(E)&&this._m>E&&(this._m=E));for(var x=0;x<P.numberOfMonths;x++)B="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),R+='<div class="pika-lendar">'+he(this,x,this.calendars[x].year,this.calendars[x].month,this.calendars[0].year,B)+this.render(this.calendars[x].year,this.calendars[x].month,B)+"</div>";this.el.innerHTML=R,P.bound&&P.field.type!=="hidden"&&a(function(){P.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),P.bound&&P.field.setAttribute("aria-label",P.ariaLabel)}},adjustPosition:function(){var $,P,g,m,b,E,R,B,x,K,Z,re;if(!this._o.container){if(this.el.style.position="absolute",$=this._o.trigger,P=$,g=this.el.offsetWidth,m=this.el.offsetHeight,b=window.innerWidth||i.documentElement.clientWidth,E=window.innerHeight||i.documentElement.clientHeight,R=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Z=!0,re=!0,typeof $.getBoundingClientRect=="function")K=$.getBoundingClientRect(),B=K.left+window.pageXOffset,x=K.bottom+window.pageYOffset;else for(B=P.offsetLeft,x=P.offsetTop+P.offsetHeight;P=P.offsetParent;)B+=P.offsetLeft,x+=P.offsetTop;(this._o.reposition&&B+g>b||this._o.position.indexOf("right")>-1&&B-g+$.offsetWidth>0)&&(B=B-g+$.offsetWidth,Z=!1),(this._o.reposition&&x+m>E+R||this._o.position.indexOf("top")>-1&&x-m-$.offsetHeight>0)&&(x=x-m-$.offsetHeight,re=!1),this.el.style.left=B+"px",this.el.style.top=x+"px",c(this.el,Z?"left-aligned":"right-aligned"),c(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,Z?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function($,P,g){var m=this._o,b=new Date,E=w($,P),R=new Date($,P,1).getDay(),B=[],x=[];S(b),m.firstDay>0&&(R-=m.firstDay,R<0&&(R+=7));for(var K=P===0?11:P-1,Z=P===11?0:P+1,re=P===0?$-1:$,ie=P===11?$+1:$,se=w(re,K),_e=E+R,Se=_e;Se>7;)Se-=7;_e+=7-Se;for(var z=!1,Ne=0,Be=0;Ne<_e;Ne++){var ke=new Date($,P,1+(Ne-R)),Ie=v(this._d)?C(ke,this._d):!1,Ae=C(ke,b),O=m.events.indexOf(ke.toDateString())!==-1,T=Ne<R||Ne>=E+R,I=1+(Ne-R),F=P,M=$,W=m.startRange&&C(m.startRange,ke),H=m.endRange&&C(m.endRange,ke),N=m.startRange&&m.endRange&&m.startRange<ke&&ke<m.endRange,U=m.minDate&&ke<m.minDate||m.maxDate&&ke>m.maxDate||m.disableWeekends&&y(ke)||m.disableDayFn&&m.disableDayFn(ke);T&&(Ne<R?(I=se+I,F=K,M=re):(I=I-E,F=Z,M=ie));var j={day:I,month:F,year:M,hasEvent:O,isSelected:Ie,isToday:Ae,isDisabled:U,isEmpty:T,isStartRange:W,isEndRange:H,isInRange:N,showDaysInNextAndPreviousMonths:m.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:m.enableSelectionDaysInNextAndPreviousMonths};m.pickWholeWeek&&Ie&&(z=!0),x.push(G(j)),++Be===7&&(m.showWeekNumber&&x.unshift(Q(Ne-R,P,$,m.firstWeekOfYearMinDays)),B.push(ne(x,m.isRTL,m.pickWholeWeek,z)),x=[],Be=0,z=!1)}return Oe(m,B,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var $=this._v;$!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,$!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var $=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),$.keyboardInput&&s(i,"keydown",this._onKeyChange),$.field&&(s($.field,"change",this._onInputChange),$.bound&&(s($.trigger,"click",this._onInputClick),s($.trigger,"focus",this._onInputFocus),s($.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},we})})(BW);var Jue=BW.exports;const QA=_j(Jue);function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function efe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rfe(n.key),n)}}function tfe(e,t,r){return t&&JA(e.prototype,t),r&&JA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rfe(e){var t=nfe(e,"string");return Ts(t)==="symbol"?t:String(t)}function nfe(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function so(){return typeof Reflect<"u"&&Reflect.get?so=Reflect.get.bind():so=function(t,r,n){var o=ofe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},so.apply(this,arguments)}function ofe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yn(e),e!==null););return e}function ife(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w_(e,t)}function w_(e,t){return w_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},w_(e,t)}function afe(e){var t=ufe();return function(){var n=yn(e),o;if(t){var i=yn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lfe(this,o)}}function lfe(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sfe(e)}function sfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ufe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yn(e){return yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yn(e)}var VW="date",eI="dateEditor",WW=function(e){ife(r,e);var t=afe(r);function r(n){var o;return efe(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return tfe(r,[{key:"init",value:function(){var o=this;if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof QA!="function")throw new Error("You need to include Pikaday to your project.");so(yn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){so(yn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new kt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){so(yn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");so(yn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:eI})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(eI),so(yn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}so(yn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?IE(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new QA(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Pt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-ht(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Tv(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ee(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return VW}}]),r}(cl);function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function ffe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hfe(n.key),n)}}function cfe(e,t,r){return t&&tI(e.prototype,t),r&&tI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hfe(e){var t=dfe(e,"string");return Ps(t)==="symbol"?t:String(t)}function dfe(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wg(){return typeof Reflect<"u"&&Reflect.get?wg=Reflect.get.bind():wg=function(t,r,n){var o=vfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wg.apply(this,arguments)}function vfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ks(e),e!==null););return e}function yfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S_(e,t)}function S_(e,t){return S_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},S_(e,t)}function gfe(e){var t=bfe();return function(){var n=ks(e),o;if(t){var i=ks(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mfe(this,o)}}function mfe(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pfe(e)}function pfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ks(e){return ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ks(e)}var wfe="dropdown",qE=function(e){yfe(r,e);var t=gfe(r);function r(){return ffe(this,r),t.apply(this,arguments)}return cfe(r,[{key:"prepare",value:function(o,i,a,l,s,u){wg(ks(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return wfe}}]),r}(KE);ge.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===qE&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function Sfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_fe(n.key),n)}}function Cfe(e,t,r){return t&&rI(e.prototype,t),r&&rI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _fe(e){var t=Ofe(e,"string");return $s(t)==="symbol"?t:String(t)}function Ofe(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C_(e,t)}function C_(e,t){return C_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},C_(e,t)}function Efe(e){var t=kfe();return function(){var n=vm(e),o;if(t){var i=vm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tfe(this,o)}}function Tfe(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pfe(e)}function Pfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vm(e){return vm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vm(e)}var $fe="numeric",UW=function(e){Rfe(r,e);var t=Efe(r);function r(){return Sfe(this,r),t.apply(this,arguments)}return Cfe(r,null,[{key:"EDITOR_TYPE",get:function(){return $fe}}]),r}(cl);function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function Afe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mfe(n.key),n)}}function Ife(e,t,r){return t&&nI(e.prototype,t),r&&nI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mfe(e){var t=xfe(e,"string");return As(t)==="symbol"?t:String(t)}function xfe(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sg(){return typeof Reflect<"u"&&Reflect.get?Sg=Reflect.get.bind():Sg=function(t,r,n){var o=Dfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sg.apply(this,arguments)}function Dfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Is(e),e!==null););return e}function Nfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&__(e,t)}function __(e,t){return __=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},__(e,t)}function Hfe(e){var t=Ffe();return function(){var n=Is(e),o;if(t){var i=Is(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lfe(this,o)}}function Lfe(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jfe(e)}function jfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ffe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Is(e){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Is(e)}var Bfe="password",zW=function(e){Nfe(r,e);var t=Hfe(r);function r(){return Afe(this,r),t.apply(this,arguments)}return Ife(r,[{key:"createElements",value:function(){Sg(Is(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,_n(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return Bfe}}]),r}(cl);function Ga(e){"@babel/helpers - typeof";return Ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ga(e)}function Vfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ufe(n.key),n)}}function Wfe(e,t,r){return t&&oI(e.prototype,t),r&&oI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ufe(e){var t=zfe(e,"string");return Ga(t)==="symbol"?t:String(t)}function zfe(e,t){if(Ga(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ga(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cg(){return typeof Reflect<"u"&&Reflect.get?Cg=Reflect.get.bind():Cg=function(t,r,n){var o=Gfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cg.apply(this,arguments)}function Gfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ms(e),e!==null););return e}function Yfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O_(e,t)}function O_(e,t){return O_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},O_(e,t)}function Kfe(e){var t=Zfe();return function(){var n=Ms(e),o;if(t){var i=Ms(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qfe(this,o)}}function qfe(e,t){if(t&&(Ga(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xfe(e)}function Xfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ms(e){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ms(e)}var Dw="ht_editor_visible",iI="selectEditor",Qfe="select",Jfe=function(e){Yfe(r,e);var t=Kfe(r);function r(){return Vfe(this,r),t.apply(this,arguments)}return Wfe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,Dw)&&Le(this.select,Dw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;Cg(Ms(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),_n(this.select),ze(h,function(d,v){var y=f.hot.rootDocument.createElement("OPTION");y.value=v,fl(y,d),f.select.appendChild(y)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Ga(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===tr.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",te(this.select,Dw)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:iI};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(iI)}}],[{key:"EDITOR_TYPE",get:function(){return Qfe}}]),r}(Mf);function xs(e){"@babel/helpers - typeof";return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function ece(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rce(n.key),n)}}function tce(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rce(e){var t=nce(e,"string");return xs(t)==="symbol"?t:String(t)}function nce(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _g(){return typeof Reflect<"u"&&Reflect.get?_g=Reflect.get.bind():_g=function(t,r,n){var o=oce(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_g.apply(this,arguments)}function oce(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ds(e),e!==null););return e}function ice(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R_(e,t)}function R_(e,t){return R_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},R_(e,t)}function ace(e){var t=uce();return function(){var n=Ds(e),o;if(t){var i=Ds(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lce(this,o)}}function lce(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sce(e)}function sce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ds(e){return Ds=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ds(e)}var fce="time",GW=function(e){ice(r,e);var t=ace(r);function r(){return ece(this,r),t.apply(this,arguments)}return tce(r,[{key:"prepare",value:function(o,i,a,l,s,u){_g(Ds(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return fce}}]),r}(cl);function cce(){Pr(Mf),Pr(KE),Pr(FW),Pr(WW),Pr(qE),Pr(YE),Pr(UW),Pr(zW),Pr(Jfe),Pr(cl),Pr(GW)}var hce="html";function XE(e,t,r,n,o,i,a){xf.apply(this,[e,t,r,n,o,i,a]),fl(t,i??"",!1)}XE.RENDERER_TYPE=hce;var dce="autocomplete";function Df(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?XE:Li,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),te(t,"htAutocomplete"),!e.acArrowListener){var f=new kt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Df.RENDERER_TYPE=dce;var lI=new WeakMap,sI=new WeakMap,vce="htBadValue",Ns="data-row",Hs="data-col",yce="checkboxRenderer",YW="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===YW){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function ZE(e,t,r,n,o,i,a){var l=e.rootDocument;xf.apply(this,[e,t,r,n,o,i,a]),gce(e);var s=mce(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),_n(t),i===a.checkedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Xt(i)?te(s,"noValue"):(s.style.display="none",te(s,vce),f=!0),s.setAttribute(Ns,r),s.setAttribute(Hs,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=pce(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),lI.has(e)||(lI.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),C={group:yce};S.addShortcuts([{keys:[["space"]],callback:function(){return y(),!p()}},{keys:[["enter"]],callback:function(){return y(),!p()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!p()},relativeToGroup:Dc,position:"before"}],C)}function y(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var k=S[C].getTopStartCorner(),_=k.row,D=k.col,V=S[C].getBottomEndCorner(),X=V.row,G=V.col,q=[],Q=_;Q<=X;Q+=1)for(var ne=D;ne<=G;ne+=1){var J=e.getCellMeta(Q,ne);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var ue=e.getDataAtCell(Q,ne);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ue)?q.push([Q,ne,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ue)&&q.push([Q,ne,J.checkedTemplate]):q.push([Q,ne,J.uncheckedTemplate])}}q.length>0&&e.setDataAtCell(q)}}function p(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var C=w[S].getTopStartCorner(),k=w[S].getBottomEndCorner(),_=C.row;_<=k.row;_++)for(var D=C.col;D<=k.col;D++){var V=e.getCellMeta(_,D);if(V.type!=="checkbox")return!1;var X=e.getCell(_,D);if(X==null)return!0;var G=X.querySelectorAll("input[type=checkbox]");if(G.length>0&&!V.readOnly)return!0}return!1}}}ZE.RENDERER_TYPE=YW;function gce(e){var t=sI.get(e);if(!t){var r=e.rootElement;t=new kt(e),t.addEventListener(r,"click",function(n){return wce(n,e)}),t.addEventListener(r,"mouseup",function(n){return bce(n,e)}),t.addEventListener(r,"change",function(n){return Sce(n,e)}),sI.set(e,t)}return t}function mce(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function pce(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function bce(e,t){var r=e.target;QE(r)&&(!r.hasAttribute(Ns)||!r.hasAttribute(Hs)||setTimeout(t.listen,10))}function wce(e,t){var r=e.target;if(QE(r)&&!(!r.hasAttribute(Ns)||!r.hasAttribute(Hs))){var n=parseInt(r.getAttribute(Ns),10),o=parseInt(r.getAttribute(Hs),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function Sce(e,t){var r=e.target;if(QE(r)&&!(!r.hasAttribute(Ns)||!r.hasAttribute(Hs))){var n=parseInt(r.getAttribute(Ns),10),o=parseInt(r.getAttribute(Hs),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function QE(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var KW={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof Yv=="function"&&Yv;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof Yv=="function"&&Yv,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,w=1e9;function S(G){var q=0|G;return 0<G||G===q?q:q-1}function C(G){for(var q,Q,ne=1,J=G.length,ue=G[0]+"";ne<J;){for(q=G[ne++]+"",Q=d-q.length;Q--;q="0"+q);ue+=q}for(J=ue.length;ue.charCodeAt(--J)===48;);return ue.slice(0,J+1||1)}function k(G,q){var Q,ne,J=G.c,ue=q.c,he=G.s,Oe=q.s,we=G.e,$=q.e;if(!he||!Oe)return null;if(Q=J&&!J[0],ne=ue&&!ue[0],Q||ne)return Q?ne?0:-Oe:he;if(he!=Oe)return he;if(Q=he<0,ne=we==$,!J||!ue)return ne?0:!J^Q?1:-1;if(!ne)return $<we^Q?1:-1;for(Oe=(we=J.length)<($=ue.length)?we:$,he=0;he<Oe;he++)if(J[he]!=ue[he])return J[he]>ue[he]^Q?1:-1;return we==$?0:$<we^Q?1:-1}function _(G,q,Q,ne){if(G<q||Q<G||G!==(G<0?s(G):u(G)))throw Error(f+(ne||"Argument")+(typeof G=="number"?G<q||Q<G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(G))}function D(G){var q=G.c.length-1;return S(G.e/d)==q&&G.c[q]%2!=0}function V(G,q){return(1<G.length?G.charAt(0)+"."+G.slice(1):G)+(q<0?"e":"e+")+q}function X(G,q,Q){var ne,J;if(q<0){for(J=Q+".";++q;J+=Q);G=J+G}else if(++q>(ne=G.length)){for(J=Q,q-=ne;--q;J+=Q);G+=J}else q<ne&&(G=G.slice(0,q)+"."+G.slice(q));return G}(a=function G(q){var Q,ne,J,ue,he,Oe,we,$,P,g,m=z.prototype={constructor:z,toString:null,valueOf:null},b=new z(1),E=20,R=4,B=-7,x=21,K=-1e7,Z=1e7,re=!1,ie=1,se=0,_e={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Se="0123456789abcdefghijklmnopqrstuvwxyz";function z(O,T){var I,F,M,W,H,N,U,j,Y=this;if(!(Y instanceof z))return new z(O,T);if(T==null){if(O instanceof z)return Y.s=O.s,Y.e=O.e,void(Y.c=(O=O.c)?O.slice():O);if((N=typeof O=="number")&&0*O==0){if(Y.s=1/O<0?(O=-O,-1):1,O===~~O){for(W=0,H=O;10<=H;H/=10,W++);return Y.e=W,void(Y.c=[O])}j=String(O)}else{if(j=String(O),!l.test(j))return J(Y,j,N);Y.s=j.charCodeAt(0)==45?(j=j.slice(1),-1):1}-1<(W=j.indexOf("."))&&(j=j.replace(".","")),0<(H=j.search(/e/i))?(W<0&&(W=H),W+=+j.slice(H+1),j=j.substring(0,H)):W<0&&(W=j.length)}else{if(_(T,2,Se.length,"Base"),j=String(O),T==10)return Ie(Y=new z(O instanceof z?O:j),E+Y.e+1,R);if(N=typeof O=="number"){if(0*O!=0)return J(Y,j,N,T);if(Y.s=1/O<0?(j=j.slice(1),-1):1,z.DEBUG&&15<j.replace(/^0\.0*|\./,"").length)throw Error(c+O);N=!1}else Y.s=j.charCodeAt(0)===45?(j=j.slice(1),-1):1;for(I=Se.slice(0,T),W=H=0,U=j.length;H<U;H++)if(I.indexOf(F=j.charAt(H))<0){if(F=="."){if(W<H){W=U;continue}}else if(!M&&(j==j.toUpperCase()&&(j=j.toLowerCase())||j==j.toLowerCase()&&(j=j.toUpperCase()))){M=!0,H=-1,W=0;continue}return J(Y,String(O),N,T)}-1<(W=(j=ne(j,T,10,Y.s)).indexOf("."))?j=j.replace(".",""):W=j.length}for(H=0;j.charCodeAt(H)===48;H++);for(U=j.length;j.charCodeAt(--U)===48;);if(j=j.slice(H,++U)){if(U-=H,N&&z.DEBUG&&15<U&&(v<O||O!==u(O)))throw Error(c+Y.s*O);if(Z<(W=W-H-1))Y.c=Y.e=null;else if(W<K)Y.c=[Y.e=0];else{if(Y.e=W,Y.c=[],H=(W+1)%d,W<0&&(H+=d),H<U){for(H&&Y.c.push(+j.slice(0,H)),U-=d;H<U;)Y.c.push(+j.slice(H,H+=d));j=j.slice(H),H=d-j.length}else H-=U;for(;H--;j+="0");Y.c.push(+j)}}else Y.c=[Y.e=0]}function Ne(O,T,I,F){var M,W,H,N,U;if(I==null?I=R:_(I,0,8),!O.c)return O.toString();if(M=O.c[0],H=O.e,T==null)U=C(O.c),U=F==1||F==2&&(H<=B||x<=H)?V(U,H):X(U,H,"0");else if(W=(O=Ie(new z(O),T,I)).e,N=(U=C(O.c)).length,F==1||F==2&&(T<=W||W<=B)){for(;N<T;U+="0",N++);U=V(U,W)}else if(T-=H,U=X(U,W,"0"),N<W+1){if(0<--T)for(U+=".";T--;U+="0");}else if(0<(T+=W-N))for(W+1==N&&(U+=".");T--;U+="0");return O.s<0&&M?"-"+U:U}function Be(O,T){for(var I,F=1,M=new z(O[0]);F<O.length;F++){if(!(I=new z(O[F])).s){M=I;break}T.call(M,I)&&(M=I)}return M}function ke(O,T,I){for(var F=1,M=T.length;!T[--M];T.pop());for(M=T[0];10<=M;M/=10,F++);return(I=F+I*d-1)>Z?O.c=O.e=null:O.c=I<K?[O.e=0]:(O.e=I,T),O}function Ie(O,T,I,F){var M,W,H,N,U,j,Y,le=O.c,me=y;if(le){e:{for(M=1,N=le[0];10<=N;N/=10,M++);if((W=T-M)<0)W+=d,H=T,Y=(U=le[j=0])/me[M-H-1]%10|0;else if((j=s((W+1)/d))>=le.length){if(!F)break e;for(;le.length<=j;le.push(0));U=Y=0,H=(W%=d)-d+(M=1)}else{for(U=N=le[j],M=1;10<=N;N/=10,M++);Y=(H=(W%=d)-d+M)<0?0:U/me[M-H-1]%10|0}if(F=F||T<0||le[j+1]!=null||(H<0?U:U%me[M-H-1]),F=I<4?(Y||F)&&(I==0||I==(O.s<0?3:2)):5<Y||Y==5&&(I==4||F||I==6&&(0<W?0<H?U/me[M-H]:0:le[j-1])%10&1||I==(O.s<0?8:7)),T<1||!le[0])return le.length=0,F?(T-=O.e+1,le[0]=me[(d-T%d)%d],O.e=-T||0):le[0]=O.e=0,O;if(W==0?(le.length=j,N=1,j--):(le.length=j+1,N=me[d-W],le[j]=0<H?u(U/me[M-H]%me[H])*N:0),F)for(;;){if(j==0){for(W=1,H=le[0];10<=H;H/=10,W++);for(H=le[0]+=N,N=1;10<=H;H/=10,N++);W!=N&&(O.e++,le[0]==h&&(le[0]=1));break}if(le[j]+=N,le[j]!=h)break;le[j--]=0,N=1}for(W=le.length;le[--W]===0;le.pop());}O.e>Z?O.c=O.e=null:O.e<K&&(O.c=[O.e=0])}return O}function Ae(O){var T,I=O.e;return I===null?O.toString():(T=C(O.c),T=I<=B||x<=I?V(T,I):X(T,I,"0"),O.s<0?"-"+T:T)}return z.clone=G,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(O){var T,I;if(O!=null){if(typeof O!="object")throw Error(f+"Object expected: "+O);if(O.hasOwnProperty(T="DECIMAL_PLACES")&&(_(I=O[T],0,w,T),E=I),O.hasOwnProperty(T="ROUNDING_MODE")&&(_(I=O[T],0,8,T),R=I),O.hasOwnProperty(T="EXPONENTIAL_AT")&&((I=O[T])&&I.pop?(_(I[0],-w,0,T),_(I[1],0,w,T),B=I[0],x=I[1]):(_(I,-w,w,T),B=-(x=I<0?-I:I))),O.hasOwnProperty(T="RANGE"))if((I=O[T])&&I.pop)_(I[0],-w,-1,T),_(I[1],1,w,T),K=I[0],Z=I[1];else{if(_(I,-w,w,T),!I)throw Error(f+T+" cannot be zero: "+I);K=-(Z=I<0?-I:I)}if(O.hasOwnProperty(T="CRYPTO")){if((I=O[T])!==!!I)throw Error(f+T+" not true or false: "+I);if(I){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!I,Error(f+"crypto unavailable");re=I}else re=I}if(O.hasOwnProperty(T="MODULO_MODE")&&(_(I=O[T],0,9,T),ie=I),O.hasOwnProperty(T="POW_PRECISION")&&(_(I=O[T],0,w,T),se=I),O.hasOwnProperty(T="FORMAT")){if(typeof(I=O[T])!="object")throw Error(f+T+" not an object: "+I);_e=I}if(O.hasOwnProperty(T="ALPHABET")){if(typeof(I=O[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(I))throw Error(f+T+" invalid: "+I);Se=I}}return{DECIMAL_PLACES:E,ROUNDING_MODE:R,EXPONENTIAL_AT:[B,x],RANGE:[K,Z],CRYPTO:re,MODULO_MODE:ie,POW_PRECISION:se,FORMAT:_e,ALPHABET:Se}},z.isBigNumber=function(O){return O instanceof z||O&&O._isBigNumber===!0||!1},z.maximum=z.max=function(){return Be(arguments,m.lt)},z.minimum=z.min=function(){return Be(arguments,m.gt)},z.random=(ue=9007199254740992,he=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(O){var T,I,F,M,W,H=0,N=[],U=new z(b);if(O==null?O=E:_(O,0,w),M=s(O/d),re)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(M*=2));H<M;)9e15<=(W=131072*T[H]+(T[H+1]>>>11))?(I=crypto.getRandomValues(new Uint32Array(2)),T[H]=I[0],T[H+1]=I[1]):(N.push(W%1e14),H+=2);H=M/2}else{if(!crypto.randomBytes)throw re=!1,Error(f+"crypto unavailable");for(T=crypto.randomBytes(M*=7);H<M;)9e15<=(W=281474976710656*(31&T[H])+1099511627776*T[H+1]+4294967296*T[H+2]+16777216*T[H+3]+(T[H+4]<<16)+(T[H+5]<<8)+T[H+6])?crypto.randomBytes(7).copy(T,H):(N.push(W%1e14),H+=7);H=M/7}if(!re)for(;H<M;)(W=he())<9e15&&(N[H++]=W%1e14);for(M=N[--H],O%=d,M&&O&&(W=y[d-O],N[H]=u(M/W)*W);N[H]===0;N.pop(),H--);if(H<0)N=[F=0];else{for(F=-1;N[0]===0;N.splice(0,1),F-=d);for(H=1,W=N[0];10<=W;W/=10,H++);H<d&&(F-=d-H)}return U.e=F,U.c=N,U}),z.sum=function(){for(var O=1,T=arguments,I=new z(T[0]);O<T.length;)I=I.plus(T[O++]);return I},ne=function(){var O="0123456789";function T(I,F,M,W){for(var H,N,U=[0],j=0,Y=I.length;j<Y;){for(N=U.length;N--;U[N]*=F);for(U[0]+=W.indexOf(I.charAt(j++)),H=0;H<U.length;H++)U[H]>M-1&&(U[H+1]==null&&(U[H+1]=0),U[H+1]+=U[H]/M|0,U[H]%=M)}return U.reverse()}return function(I,F,M,W,H){var N,U,j,Y,le,me,Re,He,Ze=I.indexOf("."),st=E,Ye=R;for(0<=Ze&&(Y=se,se=0,I=I.replace(".",""),me=(He=new z(F)).pow(I.length-Ze),se=Y,He.c=T(X(C(me.c),me.e,"0"),10,M,O),He.e=He.c.length),j=Y=(Re=T(I,F,M,H?(N=Se,O):(N=O,Se))).length;Re[--Y]==0;Re.pop());if(!Re[0])return N.charAt(0);if(Ze<0?--j:(me.c=Re,me.e=j,me.s=W,Re=(me=Q(me,He,st,Ye,M)).c,le=me.r,j=me.e),Ze=Re[U=j+st+1],Y=M/2,le=le||U<0||Re[U+1]!=null,le=Ye<4?(Ze!=null||le)&&(Ye==0||Ye==(me.s<0?3:2)):Y<Ze||Ze==Y&&(Ye==4||le||Ye==6&&1&Re[U-1]||Ye==(me.s<0?8:7)),U<1||!Re[0])I=le?X(N.charAt(1),-st,N.charAt(0)):N.charAt(0);else{if(Re.length=U,le)for(--M;++Re[--U]>M;)Re[U]=0,U||(++j,Re=[1].concat(Re));for(Y=Re.length;!Re[--Y];);for(Ze=0,I="";Ze<=Y;I+=N.charAt(Re[Ze++]));I=X(I,j,N.charAt(0))}return I}}(),Q=function(){function O(F,M,W){var H,N,U,j,Y=0,le=F.length,me=M%p,Re=M/p|0;for(F=F.slice();le--;)Y=((N=me*(U=F[le]%p)+(H=Re*U+(j=F[le]/p|0)*me)%p*p+Y)/W|0)+(H/p|0)+Re*j,F[le]=N%W;return Y&&(F=[Y].concat(F)),F}function T(F,M,W,H){var N,U;if(W!=H)U=H<W?1:-1;else for(N=U=0;N<W;N++)if(F[N]!=M[N]){U=F[N]>M[N]?1:-1;break}return U}function I(F,M,W,H){for(var N=0;W--;)F[W]-=N,N=F[W]<M[W]?1:0,F[W]=N*H+F[W]-M[W];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,M,W,H,N){var U,j,Y,le,me,Re,He,Ze,st,Ye,Me,De,dr,Bt,Ve,et,Ct,ut=F.s==M.s?1:-1,ct=F.c,tt=M.c;if(!(ct&&ct[0]&&tt&&tt[0]))return new z(F.s&&M.s&&(ct?!tt||ct[0]!=tt[0]:tt)?ct&&ct[0]==0||!tt?0*ut:ut/0:NaN);for(st=(Ze=new z(ut)).c=[],ut=W+(j=F.e-M.e)+1,N||(N=h,j=S(F.e/d)-S(M.e/d),ut=ut/d|0),Y=0;tt[Y]==(ct[Y]||0);Y++);if(tt[Y]>(ct[Y]||0)&&j--,ut<0)st.push(1),le=!0;else{for(Bt=ct.length,et=tt.length,ut+=2,1<(me=u(N/(tt[Y=0]+1)))&&(tt=O(tt,me,N),ct=O(ct,me,N),et=tt.length,Bt=ct.length),dr=et,Me=(Ye=ct.slice(0,et)).length;Me<et;Ye[Me++]=0);Ct=tt.slice(),Ct=[0].concat(Ct),Ve=tt[0],tt[1]>=N/2&&Ve++;do{if(me=0,(U=T(tt,Ye,et,Me))<0){if(De=Ye[0],et!=Me&&(De=De*N+(Ye[1]||0)),1<(me=u(De/Ve)))for(N<=me&&(me=N-1),He=(Re=O(tt,me,N)).length,Me=Ye.length;T(Re,Ye,He,Me)==1;)me--,I(Re,et<He?Ct:tt,He,N),He=Re.length,U=1;else me==0&&(U=me=1),He=(Re=tt.slice()).length;if(He<Me&&(Re=[0].concat(Re)),I(Ye,Re,Me,N),Me=Ye.length,U==-1)for(;T(tt,Ye,et,Me)<1;)me++,I(Ye,et<Me?Ct:tt,Me,N),Me=Ye.length}else U===0&&(me++,Ye=[0]);st[Y++]=me,Ye[0]?Ye[Me++]=ct[dr]||0:(Ye=[ct[dr]],Me=1)}while((dr++<Bt||Ye[0]!=null)&&ut--);le=Ye[0]!=null,st[0]||st.splice(0,1)}if(N==h){for(Y=1,ut=st[0];10<=ut;ut/=10,Y++);Ie(Ze,W+(Ze.e=Y+j*d-1)+1,H,le)}else Ze.e=j,Ze.r=+le;return Ze}}(),Oe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,we=/^([^.]+)\.$/,$=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(O,T,I,F){var M,W=I?T:T.replace(g,"");if(P.test(W))O.s=isNaN(W)?null:W<0?-1:1,O.c=O.e=null;else{if(!I&&(W=W.replace(Oe,function(H,N,U){return M=(U=U.toLowerCase())=="x"?16:U=="b"?2:8,F&&F!=M?H:N}),F&&(M=F,W=W.replace(we,"$1").replace($,"0.$1")),T!=W))return new z(W,M);if(z.DEBUG)throw Error(f+"Not a"+(F?" base "+F:"")+" number: "+T);O.c=O.e=O.s=null}},m.absoluteValue=m.abs=function(){var O=new z(this);return O.s<0&&(O.s=1),O},m.comparedTo=function(O,T){return k(this,new z(O,T))},m.decimalPlaces=m.dp=function(O,T){var I,F,M;if(O!=null)return _(O,0,w),T==null?T=R:_(T,0,8),Ie(new z(this),O+this.e+1,T);if(!(I=this.c))return null;if(F=((M=I.length-1)-S(this.e/d))*d,M=I[M])for(;M%10==0;M/=10,F--);return F<0&&(F=0),F},m.dividedBy=m.div=function(O,T){return Q(this,new z(O,T),E,R)},m.dividedToIntegerBy=m.idiv=function(O,T){return Q(this,new z(O,T),0,1)},m.exponentiatedBy=m.pow=function(O,T){var I,F,M,W,H,N,U,j,Y=this;if((O=new z(O)).c&&!O.isInteger())throw Error(f+"Exponent not an integer: "+Ae(O));if(T!=null&&(T=new z(T)),H=14<O.e,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!O.c||!O.c[0])return j=new z(Math.pow(+Ae(Y),H?2-D(O):+Ae(O))),T?j.mod(T):j;if(N=O.s<0,T){if(T.c?!T.c[0]:!T.s)return new z(NaN);(F=!N&&Y.isInteger()&&T.isInteger())&&(Y=Y.mod(T))}else{if(9<O.e&&(0<Y.e||Y.e<-1||(Y.e==0?1<Y.c[0]||H&&24e7<=Y.c[1]:Y.c[0]<8e13||H&&Y.c[0]<=9999975e7)))return W=Y.s<0&&D(O)?-0:0,-1<Y.e&&(W=1/W),new z(N?1/W:W);se&&(W=s(se/d+2))}for(U=H?(I=new z(.5),N&&(O.s=1),D(O)):(M=Math.abs(+Ae(O)))%2,j=new z(b);;){if(U){if(!(j=j.times(Y)).c)break;W?j.c.length>W&&(j.c.length=W):F&&(j=j.mod(T))}if(M){if((M=u(M/2))===0)break;U=M%2}else if(Ie(O=O.times(I),O.e+1,1),14<O.e)U=D(O);else{if((M=+Ae(O))==0)break;U=M%2}Y=Y.times(Y),W?Y.c&&Y.c.length>W&&(Y.c.length=W):F&&(Y=Y.mod(T))}return F?j:(N&&(j=b.div(j)),T?j.mod(T):W?Ie(j,se,R,void 0):j)},m.integerValue=function(O){var T=new z(this);return O==null?O=R:_(O,0,8),Ie(T,T.e+1,O)},m.isEqualTo=m.eq=function(O,T){return k(this,new z(O,T))===0},m.isFinite=function(){return!!this.c},m.isGreaterThan=m.gt=function(O,T){return 0<k(this,new z(O,T))},m.isGreaterThanOrEqualTo=m.gte=function(O,T){return(T=k(this,new z(O,T)))===1||T===0},m.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},m.isLessThan=m.lt=function(O,T){return k(this,new z(O,T))<0},m.isLessThanOrEqualTo=m.lte=function(O,T){return(T=k(this,new z(O,T)))===-1||T===0},m.isNaN=function(){return!this.s},m.isNegative=function(){return this.s<0},m.isPositive=function(){return 0<this.s},m.isZero=function(){return!!this.c&&this.c[0]==0},m.minus=function(O,T){var I,F,M,W,H=this,N=H.s;if(T=(O=new z(O,T)).s,!N||!T)return new z(NaN);if(N!=T)return O.s=-T,H.plus(O);var U=H.e/d,j=O.e/d,Y=H.c,le=O.c;if(!U||!j){if(!Y||!le)return Y?(O.s=-T,O):new z(le?H:NaN);if(!Y[0]||!le[0])return le[0]?(O.s=-T,O):new z(Y[0]?H:R==3?-0:0)}if(U=S(U),j=S(j),Y=Y.slice(),N=U-j){for((M=(W=N<0)?(N=-N,Y):(j=U,le)).reverse(),T=N;T--;M.push(0));M.reverse()}else for(F=(W=(N=Y.length)<(T=le.length))?N:T,N=T=0;T<F;T++)if(Y[T]!=le[T]){W=Y[T]<le[T];break}if(W&&(M=Y,Y=le,le=M,O.s=-O.s),0<(T=(F=le.length)-(I=Y.length)))for(;T--;Y[I++]=0);for(T=h-1;N<F;){if(Y[--F]<le[F]){for(I=F;I&&!Y[--I];Y[I]=T);--Y[I],Y[F]+=h}Y[F]-=le[F]}for(;Y[0]==0;Y.splice(0,1),--j);return Y[0]?ke(O,Y,j):(O.s=R==3?-1:1,O.c=[O.e=0],O)},m.modulo=m.mod=function(O,T){var I,F,M=this;return O=new z(O,T),!M.c||!O.s||O.c&&!O.c[0]?new z(NaN):!O.c||M.c&&!M.c[0]?new z(M):(ie==9?(F=O.s,O.s=1,I=Q(M,O,0,3),O.s=F,I.s*=F):I=Q(M,O,0,ie),(O=M.minus(I.times(O))).c[0]||ie!=1||(O.s=M.s),O)},m.multipliedBy=m.times=function(O,T){var I,F,M,W,H,N,U,j,Y,le,me,Re,He,Ze,st,Ye=this,Me=Ye.c,De=(O=new z(O,T)).c;if(!(Me&&De&&Me[0]&&De[0]))return!Ye.s||!O.s||Me&&!Me[0]&&!De||De&&!De[0]&&!Me?O.c=O.e=O.s=null:(O.s*=Ye.s,Me&&De?(O.c=[0],O.e=0):O.c=O.e=null),O;for(F=S(Ye.e/d)+S(O.e/d),O.s*=Ye.s,(U=Me.length)<(le=De.length)&&(He=Me,Me=De,De=He,M=U,U=le,le=M),M=U+le,He=[];M--;He.push(0));for(Ze=h,st=p,M=le;0<=--M;){for(I=0,me=De[M]%st,Re=De[M]/st|0,W=M+(H=U);M<W;)I=((j=me*(j=Me[--H]%st)+(N=Re*j+(Y=Me[H]/st|0)*me)%st*st+He[W]+I)/Ze|0)+(N/st|0)+Re*Y,He[W--]=j%Ze;He[W]=I}return I?++F:He.splice(0,1),ke(O,He,F)},m.negated=function(){var O=new z(this);return O.s=-O.s||null,O},m.plus=function(O,T){var I,F=this,M=F.s;if(T=(O=new z(O,T)).s,!M||!T)return new z(NaN);if(M!=T)return O.s=-T,F.minus(O);var W=F.e/d,H=O.e/d,N=F.c,U=O.c;if(!W||!H){if(!N||!U)return new z(M/0);if(!N[0]||!U[0])return U[0]?O:new z(N[0]?F:0*M)}if(W=S(W),H=S(H),N=N.slice(),M=W-H){for((I=0<M?(H=W,U):(M=-M,N)).reverse();M--;I.push(0));I.reverse()}for((M=N.length)-(T=U.length)<0&&(I=U,U=N,N=I,T=M),M=0;T;)M=(N[--T]=N[T]+U[T]+M)/h|0,N[T]=h===N[T]?0:N[T]%h;return M&&(N=[M].concat(N),++H),ke(O,N,H)},m.precision=m.sd=function(O,T){var I,F,M;if(O!=null&&O!==!!O)return _(O,1,w),T==null?T=R:_(T,0,8),Ie(new z(this),O,T);if(!(I=this.c))return null;if(F=(M=I.length-1)*d+1,M=I[M]){for(;M%10==0;M/=10,F--);for(M=I[0];10<=M;M/=10,F++);}return O&&this.e+1>F&&(F=this.e+1),F},m.shiftedBy=function(O){return _(O,-v,v),this.times("1e"+O)},m.squareRoot=m.sqrt=function(){var O,T,I,F,M,W=this,H=W.c,N=W.s,U=W.e,j=E+4,Y=new z("0.5");if(N!==1||!H||!H[0])return new z(!N||N<0&&(!H||H[0])?NaN:H?W:1/0);if((I=(N=Math.sqrt(+Ae(W)))==0||N==1/0?(((T=C(H)).length+U)%2==0&&(T+="0"),N=Math.sqrt(+T),U=S((U+1)/2)-(U<0||U%2),new z(T=N==1/0?"1e"+U:(T=N.toExponential()).slice(0,T.indexOf("e")+1)+U)):new z(N+"")).c[0]){for((N=(U=I.e)+j)<3&&(N=0);;)if(M=I,I=Y.times(M.plus(Q(W,M,j,1))),C(M.c).slice(0,N)===(T=C(I.c)).slice(0,N)){if(I.e<U&&--N,(T=T.slice(N-3,N+1))!="9999"&&(F||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(Ie(I,I.e+E+2,1),O=!I.times(I).eq(W));break}if(!F&&(Ie(M,M.e+E+2,0),M.times(M).eq(W))){I=M;break}j+=4,N+=4,F=1}}return Ie(I,I.e+E+1,R,O)},m.toExponential=function(O,T){return O!=null&&(_(O,0,w),O++),Ne(this,O,T,1)},m.toFixed=function(O,T){return O!=null&&(_(O,0,w),O=O+this.e+1),Ne(this,O,T)},m.toFormat=function(O,T,I){var F;if(I==null)O!=null&&T&&typeof T=="object"?(I=T,T=null):O&&typeof O=="object"?(I=O,O=T=null):I=_e;else if(typeof I!="object")throw Error(f+"Argument not an object: "+I);if(F=this.toFixed(O,T),this.c){var M,W=F.split("."),H=+I.groupSize,N=+I.secondaryGroupSize,U=I.groupSeparator||"",j=W[0],Y=W[1],le=this.s<0,me=le?j.slice(1):j,Re=me.length;if(N&&(M=H,H=N,Re-=N=M),0<H&&0<Re){for(M=Re%H||H,j=me.substr(0,M);M<Re;M+=H)j+=U+me.substr(M,H);0<N&&(j+=U+me.slice(M)),le&&(j="-"+j)}F=Y?j+(I.decimalSeparator||"")+((N=+I.fractionGroupSize)?Y.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):Y):j}return(I.prefix||"")+F+(I.suffix||"")},m.toFraction=function(O){var T,I,F,M,W,H,N,U,j,Y,le,me,Re=this,He=Re.c;if(O!=null&&(!(N=new z(O)).isInteger()&&(N.c||N.s!==1)||N.lt(b)))throw Error(f+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+Ae(N));if(!He)return new z(Re);for(T=new z(b),j=I=new z(b),F=U=new z(b),me=C(He),W=T.e=me.length-Re.e-1,T.c[0]=y[(H=W%d)<0?d+H:H],O=!O||0<N.comparedTo(T)?0<W?T:j:N,H=Z,Z=1/0,N=new z(me),U.c[0]=0;Y=Q(N,T,0,1),(M=I.plus(Y.times(F))).comparedTo(O)!=1;)I=F,F=M,j=U.plus(Y.times(M=j)),U=M,T=N.minus(Y.times(M=T)),N=M;return M=Q(O.minus(I),F,0,1),U=U.plus(M.times(j)),I=I.plus(M.times(F)),U.s=j.s=Re.s,le=Q(j,F,W*=2,R).minus(Re).abs().comparedTo(Q(U,I,W,R).minus(Re).abs())<1?[j,F]:[U,I],Z=H,le},m.toNumber=function(){return+Ae(this)},m.toPrecision=function(O,T){return O!=null&&_(O,1,w),Ne(this,O,T,2)},m.toString=function(O){var T,I=this,F=I.s,M=I.e;return M===null?F?(T="Infinity",F<0&&(T="-"+T)):T="NaN":(T=O==null?M<=B||x<=M?V(C(I.c),M):X(C(I.c),M,"0"):O===10?X(C((I=Ie(new z(I),E+M+1,R)).c),I.e,"0"):(_(O,2,Se.length,"Base"),ne(X(C(I.c),M,"0"),10,O,F,!0)),F<0&&I.c[0]&&(T="-"+T)),T},m.valueOf=m.toJSON=function(){return Ae(this)},m._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(m[Symbol.toStringTag]="BigNumber",m[Symbol.for("nodejs.util.inspect.custom")]=m.valueOf),q!=null&&z.set(q),z}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(k){if(Array.isArray(k))return k}(S)||function(k,_){var D=[],V=!0,X=!1,G=void 0;try{for(var q,Q=k[Symbol.iterator]();!(V=(q=Q.next()).done)&&(D.push(q.value),!_||D.length!==_);V=!0);}catch(ne){X=!0,G=ne}finally{try{V||Q.return==null||Q.return()}finally{if(X)throw G}}return D}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},k=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var _=C.prefix||"",D=C.postfix||"",V=function(X,G,q){switch(G.output){case"currency":return G=w(G,a.currentCurrencyDefaultFormat()),function(Se,z,Ne){var Be=Ne.currentCurrency(),ke=Object.assign({},c,z),Ie=void 0,Ae="",O=!!ke.totalLength||!!ke.forceAverage||ke.average,T=z.currencyPosition||Be.position,I=z.currencySymbol||Be.symbol;ke.spaceSeparated&&(Ae=" "),T==="infix"&&(Ie=Ae+I+Ae);var F=p({instance:Se,providedFormat:z,state:Ne,decimalSeparator:Ie});return T==="prefix"&&(F=Se._value<0&&ke.negative==="sign"?"-".concat(Ae).concat(I).concat(F.slice(1)):I+Ae+F),T&&T!=="postfix"||(F=F+(Ae=O?"":Ae)+I),F}(X,G,a);case"percent":return G=w(G,a.currentPercentageDefaultFormat()),function(Se,z,Ne,Be){var ke=z.prefixSymbol,Ie=p({instance:Be(100*Se._value),providedFormat:z,state:Ne}),Ae=Object.assign({},c,z);return ke?"%".concat(Ae.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Ae.spaceSeparated?" ":"","%")}(X,G,a,q);case"byte":return G=w(G,a.currentByteDefaultFormat()),b=X,R=a,B=q,x=(E=G).base||"binary",K=f[x],Z=d(b._value,K.suffixes,K.scale),re=Z.value,ie=Z.suffix,se=p({instance:B(re),providedFormat:E,state:R,defaults:R.currentByteDefaultFormat()}),_e=R.currentAbbreviations(),"".concat(se).concat(_e.spaced?" ":"").concat(ie);case"time":return G=w(G,a.currentTimeDefaultFormat()),$=X,P=Math.floor($._value/60/60),g=Math.floor(($._value-60*P*60)/60),m=Math.round($._value-60*P*60-60*g),"".concat(P,":").concat(g<10?"0":"").concat(g,":").concat(m<10?"0":"").concat(m);case"ordinal":return G=w(G,a.currentOrdinalDefaultFormat()),Q=X,ne=G,ue=(J=a).currentOrdinal(),he=Object.assign({},c,ne),Oe=p({instance:Q,providedFormat:ne,state:J}),we=ue(Q._value),"".concat(Oe).concat(he.spaceSeparated?" ":"").concat(we);case"number":default:return p({instance:X,providedFormat:G,numbro:q})}var Q,ne,J,ue,he,Oe,we,$,P,g,m,b,E,R,B,x,K,Z,re,ie,se,_e}(S,C,k);return V=(V=_+V)+D}function d(S,C,k){var _=C[0],D=Math.abs(S);if(k<=D){for(var V=1;V<C.length;++V){var X=Math.pow(k,V),G=Math.pow(k,V+1);if(X<=D&&D<G){_=C[V],S/=X;break}}_===C[0]&&(S/=Math.pow(k,C.length-1),_=C[C.length-1])}return{value:S,suffix:_}}function v(S){for(var C="",k=0;k<S;k++)C+="0";return C}function y(S,C){return S.toString().indexOf("e")!==-1?function(k,_){var D=k.toString(),V=i(D.split("e"),2),X=V[0],G=V[1],q=i(X.split("."),2),Q=q[0],ne=q[1],J=ne===void 0?"":ne;if(0<+G)D=Q+J+v(G-J.length);else{var ue=".";ue=+Q<0?"-0".concat(ue):"0".concat(ue);var he=(v(-G-1)+Math.abs(Q)+J).substr(0,_);he.length<_&&(he+=v(_-he.length)),D=ue+he}return 0<+G&&0<_&&(D+=".".concat(v(_))),D}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function p(S){var C=S.instance,k=S.providedFormat,_=S.state,D=_===void 0?a:_,V=S.decimalSeparator,X=S.defaults,G=X===void 0?D.currentDefaults():X,q=C._value;if(q===0&&D.hasZeroFormat())return D.getZeroFormat();if(!isFinite(q))return q.toString();var Q,ne,J,ue,he,Oe,we,$,P=Object.assign({},c,G,k),g=P.totalLength,m=g?0:P.characteristic,b=P.optionalCharacteristic,E=P.forceAverage,R=!!g||!!E||P.average,B=g?-1:R&&k.mantissa===void 0?0:P.mantissa,x=!g&&(k.optionalMantissa===void 0?B===-1:P.optionalMantissa),K=P.trimMantissa,Z=P.thousandSeparated,re=P.spaceSeparated,ie=P.negative,se=P.forceSign,_e=P.exponential,Se="";if(R){var z=function(O){var T=O.value,I=O.forceAverage,F=O.abbreviations,M=O.spaceSeparated,W=M!==void 0&&M,H=O.totalLength,N=H===void 0?0:H,U="",j=Math.abs(T),Y=-1;if(j>=Math.pow(10,12)&&!I||I==="trillion"?(U=F.trillion,T/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!I||I==="billion"?(U=F.billion,T/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!I||I==="million"?(U=F.million,T/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!I||I==="thousand")&&(U=F.thousand,T/=Math.pow(10,3)),U&&(U=(W?" ":"")+U),N){var le=T.toString().split(".")[0];Y=Math.max(N-le.length,0)}return{value:T,abbreviation:U,mantissaPrecision:Y}}({value:q,forceAverage:E,abbreviations:D.currentAbbreviations(),spaceSeparated:re,totalLength:g});q=z.value,Se+=z.abbreviation,g&&(B=z.mantissaPrecision)}if(_e){var Ne=(ne=(Q={value:q,characteristicPrecision:m}).value,J=Q.characteristicPrecision,ue=J===void 0?0:J,he=i(ne.toExponential().split("e"),2),Oe=he[0],we=he[1],$=+Oe,ue&&1<ue&&($*=Math.pow(10,ue-1),we=0<=(we=+we-(ue-1))?"+".concat(we):we),{value:$,abbreviation:"e".concat(we)});q=Ne.value,Se=Ne.abbreviation+Se}var Be,ke,Ie,Ae=function(O,T,I,F,M){if(F===-1)return O;var W=y(T,F),H=i(W.toString().split("."),2),N=H[0],U=H[1],j=U===void 0?"":U;if(j.match(/^0+$/)&&(I||M))return N;var Y=j.match(/0+$/);return M&&Y?"".concat(N,".").concat(j.toString().slice(0,Y.index)):W.toString()}(q.toString(),q,x,B,K);return Ae=function(O,T,I,F,M){var W=F.currentDelimiters(),H=W.thousands;M=M||W.decimal;var N=W.thousandsSize||3,U=O.toString(),j=U.split(".")[0],Y=U.split(".")[1];return I&&(T<0&&(j=j.slice(1)),function(le,me){for(var Re=[],He=0,Ze=le;0<Ze;Ze--)He===me&&(Re.unshift(Ze),He=0),He++;return Re}(j.length,N).forEach(function(le,me){j=j.slice(0,le+me)+H+j.slice(le+me)}),T<0&&(j="-".concat(j))),U=Y?j+M+Y:j}(Ae=function(O,T,I,F){var M=O,W=i(M.toString().split("."),2),H=W[0],N=W[1];if(H.match(/^-?0$/)&&I)return N?"".concat(H.replace("0",""),".").concat(N):H.replace("0","");if(H.length<F)for(var U=F-H.length,j=0;j<U;j++)M="0".concat(M);return M.toString()}(Ae,0,b,m),q,Z,D,V),(R||_e)&&(Ae=Ae+Se),(se||q<0)&&(Be=Ae,Ie=ie,Ae=(ke=q)===0?Be:+Be==0?Be.replace("-",""):0<ke?"+".concat(Be):Ie==="sign"?Be:"(".concat(Be.replace("-",""),")")),Ae}function w(S,C){if(!S)return C;var k=Object.keys(S);return k.length===1&&k[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return h.apply(void 0,k.concat([S]))},getByteUnit:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return function(D){var V=f.general;return d(D._value,V.suffixes,V.scale).suffix}.apply(void 0,k.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return function(D){var V=f.binary;return d(D._value,V.suffixes,V.scale).suffix}.apply(void 0,k.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return function(D){var V=f.decimal;return d(D._value,V.suffixes,V.scale).suffix}.apply(void 0,k.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(y){u=y}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(y){y=l.parseFormat(y),a.validateFormat(y)&&(h=y)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(y){return c=typeof y=="string"?y:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(y){if(y){if(f[y])return f[y];throw new Error('Unknown tag "'.concat(y,'"'))}return v()},s.registerLanguage=function(y){var p=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(y))throw new Error("Invalid language data");f[y.languageTag]=y,p&&d(y.languageTag)},s.setLanguage=function(y){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[y]){var w=y.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===w});return f[S]?void d(S):void d(p)}d(y)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(p,w){for(var S=0;S<w.length;S++){var C=w[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(p,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(y),u=r("./unformatting"),f=r("./formatting")(y),c=r("./manipulating")(y),h=r("./parsing"),d=function(){function p(C){(function(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")})(this,p),this._value=C}var w,S;return w=p,(S=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),p}();function v(p){var w=p;return y.isNumbro(p)?w=p._value:typeof p=="string"?w=y.unformat(p):isNaN(p)&&(w=NaN),w}function y(p){return new d(v(p))}y.version="2.1.2",y.isNumbro=function(p){return p instanceof d},y.language=a.currentLanguage,y.registerLanguage=a.registerLanguage,y.setLanguage=a.setLanguage,y.languages=a.languages,y.languageData=a.languageData,y.zeroFormat=a.setZeroFormat,y.defaultFormat=a.currentDefaults,y.setDefaults=a.setDefaults,y.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=s.loadLanguagesInNode,y.unformat=u.unformat,n.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,y,p,w,S,C,k,_,D,V,X,G,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=q,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=q,function(Q,ne){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(ne.output="byte",ne.base="general"):Q.indexOf("b")!==-1?(ne.output="byte",ne.base="binary"):Q.indexOf("d")!==-1?(ne.output="byte",ne.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(ne.output="ordinal"):ne.output="time";ne.output="percent"}else ne.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,q),h=q,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=q,(y=i.split(".")[0].match(/0+/))&&(v.characteristic=y[0].length),function(Q,ne){if(Q.indexOf(".")!==-1){var J=Q.split(".")[0];ne.optionalCharacteristic=J.indexOf("0")===-1}}(i,q),p=q,i.indexOf("a")!==-1&&(p.average=!0),S=q,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Q,ne){var J=Q.split(".")[1];if(J){var ue=J.match(/0+/);ue&&(ne.mantissa=ue[0].length)}}(i,q),k=q,(C=i).match(/\[\.]/)?k.optionalMantissa=!0:C.match(/\./)&&(k.optionalMantissa=!1),_=q,i.indexOf(",")!==-1&&(_.thousandSeparated=!0),D=q,i.indexOf(" ")!==-1&&(D.spaceSeparated=!0),X=q,(V=i).match(/^\+?\([^)]*\)$/)&&(X.negative="parenthesis"),V.match(/^\+?-/)&&(X.negative="sign"),G=q,i.match(/^\+/)&&(G.forceSign=!0),q)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function y(p,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,k=4<arguments.length?arguments[4]:void 0,_=5<arguments.length?arguments[5]:void 0,D=6<arguments.length?arguments[6]:void 0;if(!isNaN(+p))return+p;var V="",X=p.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(X!==p)return-1*y(X,w,S,C,k,_,D);for(var G=0;G<i.length;G++){var q=i[G];if((V=p.replace(q.key,""))!==p)return y(V,w,S,C,k,_,D)*q.factor}if((V=p.replace("%",""))!==p)return y(V,w,S,C,k,_,D)/100;var Q=parseFloat(p);if(!isNaN(Q)){var ne=C(Q);if(ne&&ne!=="."&&(V=p.replace(new RegExp("".concat(a(ne),"$")),""))!==p)return y(V,w,S,C,k,_,D);var J={};Object.keys(_).forEach(function(g){J[_[g]]=g});for(var ue=Object.keys(J).sort().reverse(),he=ue.length,Oe=0;Oe<he;Oe++){var we=ue[Oe],$=J[we];if((V=p.replace(we,""))!==p){var P=void 0;switch($){case"thousand":P=Math.pow(10,3);break;case"million":P=Math.pow(10,6);break;case"billion":P=Math.pow(10,9);break;case"trillion":P=Math.pow(10,12)}return y(V,w,S,C,k,_,D)*P}}}}(function(y,p){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=y.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(p.thousands),"([0-9])"),"g"),"$1$2")).replace(p.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),y=d.currentCurrency().symbol,p=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(k,_){if(!k.indexOf(":")||_.thousands===":")return!1;var D=k.split(":");if(D.length!==3)return!1;var V=+D[0],X=+D[1],G=+D[2];return!isNaN(V)&&!isNaN(X)&&!isNaN(G)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,y,p,w,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(y){if(Array.isArray(y)){for(var p=0,w=new Array(y.length);p<y.length;p++)w[p]=y[p];return w}}(v)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,y,p){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!y[C])return console.error("".concat(p," Invalid key: ").concat(C)),!1;var k=v[C],_=y[C];if(typeof _=="string"&&(_={type:_}),_.type==="format"){if(!h(k,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(k)!==_.type)return console.error("".concat(p," ").concat(C,' type mismatched: "').concat(_.type,'" expected, "').concat(a(k),'" provided')),!1;if(_.restrictions&&_.restrictions.length)for(var D=_.restrictions.length,V=0;V<D;V++){var X=_.restrictions[V],G=X.restriction,q=X.message;if(!G(k,v))return console.error("".concat(p," ").concat(C," invalid value: ").concat(q)),!1}return _.restriction&&!_.restriction(k,v)?(console.error("".concat(p," ").concat(C," invalid value: ").concat(_.message)),!1):_.validValues&&_.validValues.indexOf(k)===-1?(console.error("".concat(p," ").concat(C," invalid value: must be among ").concat(JSON.stringify(_.validValues),', "').concat(k,'" provided')),!1):!(_.children&&!h(k,_.children,"[Validate ".concat(C,"]")))});return w||S.push.apply(S,i(Object.keys(y).map(function(C){var k=y[C];if(typeof k=="string"&&(k={type:k}),k.mandatory){var _=k.mandatory;if(typeof _=="function"&&(_=_(v)),_&&v[C]===void 0)return console.error("".concat(p,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,k){return C&&k},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,y){var p=c(v),w=d(y);return p&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(KW);var Cce=KW.exports;const Gi=_j(Cce);var _ce="numeric";function JE(e,t,r,n,o,i,a){var l=i;if(wr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Gi.languages()[u]){var d=u.replace("-",""),v=Gi.allLanguages?Gi.allLanguages[u]:Gi[d];v&&Gi.registerLanguage(v)}Gi.setLanguage(u),l=Gi(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Li(e,t,r,n,o,l,a)}JE.RENDERER_TYPE=_ce;var Oce="password";function eT(e,t,r,n,o,i,a){Li.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Ce(l-1,function(){u+=s}),fl(t,u)}eT.RENDERER_TYPE=Oce;var Rce="time";function tT(e,t,r,n,o,i,a){Li.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}tT.RENDERER_TYPE=Rce;var Iv=on("renderers"),Ece=Iv.register,Tce=Iv.getItem,qW=Iv.hasItem,Pce=Iv.getNames;Iv.getValues;function ym(e){if(typeof e=="function")return e;if(!qW(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Tce(e)}function Hn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),Ece(e,t)}function kce(){Hn(Df),Hn(xf),Hn(ZE),Hn(XE),Hn(JE),Hn(eT),Hn(Li),Hn(tT)}var $ce="autocomplete";function Jp(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,uI(r,t)):uI(r,t)(this.source):t(!0)}Jp.VALIDATOR_TYPE=$ce;function uI(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var Ace=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},Ice=Zt,Mce=_p,xce=jt,Dce=On,Nce=Ar,fI=Ace,cI=Kt,Hce=nl,Lce=Op;Mce("search",function(e,t,r){return[function(o){var i=Nce(this),a=Dce(o)?void 0:Hce(o,e);return a?Ice(a,o,i):new RegExp(o)[e](cI(i))},function(n){var o=xce(this),i=cI(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;fI(l,0)||(o.lastIndex=0);var s=Lce(o,i);return fI(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function XW(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const jce=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:XW},Symbol.toStringTag,{value:"Module"}));var Fce="date";function rT(e,t){var r=DW(VW,this.instance),n=e,o=!0;n==null&&(n="");var i=ee(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=ee(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=Bce(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}rT.VALIDATOR_TYPE=Fce;function Bce(e,t){var r=ee(XW(e)),n=ee(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var Vce="numeric";function nT(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:wr(e))}nT.VALIDATOR_TYPE=Vce;var Wce=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Uce="time";function oT(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=ee(o,Wce,!0).isValid()?ee(o):ee(o,r),l=a.isValid(),s=ee(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}oT.VALIDATOR_TYPE=Uce;var Mv=on("validators"),zce=Mv.register,Gce=Mv.getItem,ZW=Mv.hasItem,Yce=Mv.getNames;Mv.getValues;function iT(e){if(typeof e=="function")return e;if(!ZW(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Gce(e)}function Zl(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),zce(e,t)}function Kce(){Zl(Jp),Zl(rT),Zl(nT),Zl(oT)}var qce="autocomplete",Xce={CELL_TYPE:qce,editor:KE,renderer:Df,validator:Jp},Zce="checkbox",Qce={CELL_TYPE:Zce,editor:FW,renderer:ZE},Jce="date",ehe={CELL_TYPE:Jce,editor:WW,renderer:Df,validator:rT},the="dropdown",rhe={CELL_TYPE:the,editor:qE,renderer:Df,validator:Jp},nhe="handsontable",ohe={CELL_TYPE:nhe,editor:YE,renderer:Df},ihe="numeric",ahe={CELL_TYPE:ihe,editor:UW,renderer:JE,validator:nT,dataType:"number"},lhe="password",she={CELL_TYPE:lhe,editor:zW,renderer:eT,copyable:!1},uhe="text",QW={CELL_TYPE:uhe,editor:cl,renderer:Li},fhe="time",che={CELL_TYPE:fhe,editor:GW,renderer:tT,validator:oT},xv=on("cellTypes"),hhe=xv.register,dhe=xv.getItem,JW=xv.hasItem,vhe=xv.getNames;xv.getValues;function aT(e){if(!JW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return dhe(e)}function hn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Pr(e,n),o&&Hn(e,o),i&&Zl(e,i),hhe(e,t)}function yhe(){hn(Xce),hn(Qce),hn(ehe),hn(rhe),hn(ohe),hn(ahe),hn(she),hn(QW),hn(che)}var ghe=bp,mhe=$F;ghe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},mhe);function phe(e){return She(e)||whe(e)||e2(e)||bhe()}function bhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function whe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function She(e){if(Array.isArray(e))return E_(e)}function Che(e,t){return Rhe(e)||Ohe(e,t)||e2(e,t)||_he()}function _he(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e2(e,t){if(e){if(typeof e=="string")return E_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E_(e,t)}}function E_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ohe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Rhe(e){if(Array.isArray(e))return e}var T_="asc",Ehe="desc",hI=new Map([[T_,[-1,1]],[Ehe,[1,-1]]]),The=function(t){return"The priority '".concat(t,"' is already declared in a map.")},Phe=function(t){return"The priority '".concat(t,"' is not a number.")};function khe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=pt(t)?t:The,r=pt(r)?r:Phe;function o(a,l){if(!wr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:T_,l=hI.get(a)||hI.get(T_),s=Che(l,2),u=s[0],f=s[1];return phe(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}function $he(e){return Mhe(e)||Ihe(e)||t2(e)||Ahe()}function Ahe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ihe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mhe(e){if(Array.isArray(e))return P_(e)}function dI(e,t){return Nhe(e)||Dhe(e,t)||t2(e,t)||xhe()}function xhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t2(e,t){if(e){if(typeof e=="string")return P_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P_(e,t)}}function P_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Nhe(e){if(Array.isArray(e))return e}var Hhe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function eb(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=pt(t)?t:Hhe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var y=dI(v,2),p=y[0],w=y[1];return f===w?p:!1})||[null],h=dI(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return $he(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Lhe(e){return Vhe(e)||Bhe(e)||Fhe(e)||jhe()}function jhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fhe(e,t){if(e){if(typeof e=="string")return k_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k_(e,t)}}function Bhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vhe(e){if(Array.isArray(e))return k_(e)}function k_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Whe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function Uhe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=pt(t)?t:Whe;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return Lhe(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function zhe(e,t){return Khe(e)||Yhe(e,t)||r2(e,t)||Ghe()}function Ghe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Khe(e){if(Array.isArray(e))return e}function vI(e){return Zhe(e)||Xhe(e)||r2(e)||qhe()}function qhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r2(e,t){if(e){if(typeof e=="string")return $_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $_(e,t)}}function Xhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zhe(e){if(Array.isArray(e))return $_(e)}function $_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lT=function(t){return'There is already registered "'.concat(t,'" plugin.')},Qhe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Jhe=function(t){return'The priority "'.concat(t,'" is not a number.')},n2=khe({errorPriorityExists:Qhe,errorPriorityNaN:Jhe}),o2=Uhe({errorItemExists:lT}),A_=eb({errorIdExists:lT});function sT(){return[].concat(vI(n2.getItems()),vI(o2.getItems()))}function Dv(e){var t=ur(e);return A_.getItem(t)}function ede(e){return!!Dv(e)}function rt(e,t,r){var n=rde(e,t,r),o=zhe(n,3);e=o[0],t=o[1],r=o[2],Dv(e)===void 0&&tde(e,t,r)}function tde(e,t,r){var n=ur(e);if(A_.hasItem(n))throw new Error(lT(n));r===void 0?o2.addItem(n):n2.addItem(r,n),A_.addItem(n,t)}function rde(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function nde(e,t){return lde(e)||ade(e,t)||ide(e,t)||ode()}function ode(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ide(e,t){if(e){if(typeof e=="string")return yI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yI(e,t)}}function yI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ade(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lde(e){if(Array.isArray(e))return e}function sde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fde(n.key),n)}}function ude(e,t,r){return t&&gI(e.prototype,t),r&&gI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fde(e){var t=cde(e,"string");return ah(t)==="symbol"?t:String(t)}function cde(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hde(e,t){dde(e,t),t.add(e)}function dde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vde(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var mI=new Map([["plugin",ede],["cell-type",JW],["editor",xW],["renderer",qW],["validator",ZW]]),yde="base",Yi=new WeakMap,Nw=[],Tn=null,pI=new WeakSet,ot=function(){function e(t){var r=this;sde(this,e),hde(this,pI),Kn(this,"hot",t,{writable:!1}),Yi.set(this,{hooks:{}}),Tn=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return ude(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=nde(f,2),h=c[0],d=c[1];if(!mI.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));mI.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Nw.push(a)}}Tn||(Tn=sT()),Tn.indexOf("UndoRedo")>=0&&Tn.splice(Tn.indexOf("UndoRedo"),1),Tn.indexOf(this.pluginName)>=0&&Tn.splice(Tn.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=Tn.length===0;if(l){if(Nw.length>0){var s=["".concat(Nw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Yi.get(this).hooks[r]=Yi.get(this).hooks[r]||[];var o=Yi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Yi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;A(Yi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Yi.get(this).hooks;ze(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){A(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=vde(this,pI,gde).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ze(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return yde}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function gde(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function mde(e,t){return Sde(e)||wde(e,t)||bde(e,t)||pde()}function pde(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bde(e,t){if(e){if(typeof e=="string")return bI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bI(e,t)}}function bI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wde(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Sde(e){if(Array.isArray(e))return e}function Cde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ode(n.key),n)}}function _de(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ode(e){var t=Rde(e,"string");return lh(t)==="symbol"?t:String(t)}function Rde(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ede=function(){function e(t){Cde(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return _de(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),A(this.rows,function(n){r(n.row,Pt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),A(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){A(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),A(i,function(l){var s=mde(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){A(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),te(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return te(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const uT=Ede;function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function Tde(e,t,r){return t=i2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i2(n.key),n)}}function kde(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i2(e){var t=$de(e,"string");return sh(t)==="symbol"?t:String(t)}function $de(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ade=function(){function e(t){Pde(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return kde(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return Ce(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return Ce(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ue(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(Dt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var y=a.get(v);if(y.needed){var p=s.indexOf(c)>-1;(!p||i.allowDuplicates||d)&&(y.strings.push(Tde({value:c},l,u)),s.push(c),y.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const a2=Ade;var ua=1,lr=2;function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function Ide(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xde(n.key),n)}}function Mde(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xde(e){var t=Dde(e,"string");return uh(t)==="symbol"?t:String(t)}function Dde(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sl=new WeakMap,Nde=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;Ide(this,e),Sl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return Mde(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=Sl.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,y=h>0?v+1:v,p=0;p<d;p++)if(i=this._getColumnWidth(p),r<=h&&u!==lr&&(this.startColumn=p,a=i),r>=h&&r+(u===lr?i:0)<=h+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=p,a=i),this.endColumn=p),o.push(r),r+=i,l=i,u!==lr&&(this.endColumn=p),r>=h+v){n=!1;break}var w=c+v-y,S=u===lr?0:l,C=u===lr?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var k=o[this.endColumn]+i-o[this.startColumn-1];if((k<=v||u!==lr)&&(this.startColumn-=1),k>v)break}u===ua&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=Sl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=Sl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Sl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Sl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const fT=Nde;function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function Hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jde(n.key),n)}}function Lde(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jde(e){var t=Fde(e,"string");return fh(t)==="symbol"?t:String(t)}function Fde(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OI=new WeakMap,Bde=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;Hde(this,e),OI.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return Lde(e,[{key:"calculate",value:function(){for(var r=OI.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,y=0,p=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==lr&&(this.startRow=w,y=v),c>=l&&c+(n===lr?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,y=v),this.endRow=w),d.push(c),c+=v,p=v,n!==lr&&(this.endRow=w),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===lr?y:0,k=n===lr?0:p;if(S<C||a>d.at(-1)+k?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var _=d[this.endRow]+v-d[this.startRow-1];if((_<=u-f||n!==lr)&&(this.startRow-=1),_>=u-f)break}n===ua&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const l2=Bde;function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function Vde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s2(n.key),n)}}function Wde(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ude(e,t,r){zde(e,t),t.set(e,r)}function zde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EI(e,t,r){return t=s2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s2(e){var t=Gde(e,"string");return ch(t)==="symbol"?t:String(t)}function Gde(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tc(e,t){var r=u2(e,t,"get");return Yde(e,r)}function Yde(e,t){return t.get?t.get.call(e):t.value}function Kde(e,t,r){var n=u2(e,t,"set");return qde(e,n,r),r}function u2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function qde(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ki=new WeakMap,Xde=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Vde(this,e),EI(this,"row",null),EI(this,"col",null),Ude(this,Ki,{writable:!0,value:!1}),Kde(this,Ki,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return Wde(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(tc(this,Ki)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(tc(this,Ki)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(tc(this,Ki)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(tc(this,Ki)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,tc(this,Ki))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const gm=Xde;function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function Zde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f2(n.key),n)}}function Qde(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jde(e,t,r){eve(e,t),t.set(e,r)}function eve(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hw(e,t,r){return t=f2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f2(e){var t=tve(e,"string");return hh(t)==="symbol"?t:String(t)}function tve(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pn(e,t){var r=c2(e,t,"get");return rve(e,r)}function rve(e,t){return t.get?t.get.call(e):t.value}function nve(e,t,r){var n=c2(e,t,"set");return ove(e,n,r),r}function c2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ove(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Yr=new WeakMap,ive=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Zde(this,e),Hw(this,"highlight",null),Hw(this,"from",null),Hw(this,"to",null),Jde(this,Yr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),nve(this,Yr,o)}return Qde(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Pn(this,Yr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Pn(this,Yr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Pn(this,Yr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Pn(this,Yr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Pn(this,Yr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Pn(this,Yr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Pn(this,Yr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Pn(this,Yr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof gm))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Pn(this,Yr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new gm(r,n,Pn(this,Yr))}}]),e}();const cT=ive;function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function ave(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sve(n.key),n)}}function lve(e,t,r){return t&&PI(e.prototype,t),r&&PI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sve(e){var t=uve(e,"string");return dh(t)==="symbol"?t:String(t)}function uve(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cl=new WeakMap,fve=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ave(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,Cl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return lve(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};pn()?n():(xE()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=Cl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=Rc(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Cl.get(this),o=this.domBindings.rootDocument.activeElement,i=zE(gW,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=Rc(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&bi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=Rc(r.target,["TD","TH"],n),i=Rc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&bi(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=Cl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Cl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ve(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];$E()&&(ZV()||QV())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=Cl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const h2=fve;function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function cve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dve(n.key),n)}}function hve(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dve(e){var t=vve(e,"string");return vh(t)==="symbol"?t:String(t)}function vve(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yve=function(){function e(t,r,n){cve(this,e),this.offset=t,this.total=r,this.countTH=n}return hve(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const gve=yve;function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function mve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bve(n.key),n)}}function pve(e,t,r){return t&&$I(e.prototype,t),r&&$I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bve(e){var t=wve(e,"string");return yh(t)==="symbol"?t:String(t)}function wve(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sve=function(){function e(t,r,n){mve(this,e),this.offset=t,this.total=r,this.countTH=n}return pve(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Cve=Sve;var _ve=0,mm=1,pm=2;function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function Ove(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eve(n.key),n)}}function Rve(e,t,r){return t&&AI(e.prototype,t),r&&AI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eve(e){var t=Tve(e,"string");return gh(t)==="symbol"?t:String(t)}function Tve(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var II=function(){function e(){Ove(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Rve(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function Pve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$ve(n.key),n)}}function kve(e,t,r){return t&&MI(e.prototype,t),r&&MI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ve(e){var t=Ave(e,"string");return mh(t)==="symbol"?t:String(t)}function Ave(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ive=function(){function e(){Pve(this,e),this.size=new II,this.workingSpace=_ve,this.sharedSize=null}return kve(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof II}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=mm,r.workingSpace=pm,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=pm,r.workingSpace=mm,this.sharedSize=r.getViewSize()}}]),e}();function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Mve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dve(n.key),n)}}function xve(e,t,r){return t&&xI(e.prototype,t),r&&xI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dve(e){var t=Nve(e,"string");return ph(t)==="symbol"?t:String(t)}function Nve(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d2=function(){function e(t,r,n){Mve(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new Ive,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return xve(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(mm))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(pm)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(mm);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(pm)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function Hve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jve(n.key),n)}}function Lve(e,t,r){return t&&DI(e.prototype,t),r&&DI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jve(e){var t=Fve(e,"string");return Ls(t)==="symbol"?t:String(t)}function Fve(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I_(e,t)}function I_(e,t){return I_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},I_(e,t)}function Vve(e){var t=zve();return function(){var n=bm(e),o;if(t){var i=bm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wve(this,o)}}function Wve(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uve(e)}function Uve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bm(e){return bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bm(e)}var v2=function(e){Bve(r,e);var t=Vve(r);function r(){return Hve(this,r),t.apply(this,arguments)}return Lve(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(d2);function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function Gve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kve(n.key),n)}}function Yve(e,t,r){return t&&NI(e.prototype,t),r&&NI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kve(e){var t=qve(e,"string");return bh(t)==="symbol"?t:String(t)}function qve(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xve=function(){function e(t){Gve(this,e),this.nodeType=t.toUpperCase()}return Yve(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Zve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jve(n.key),n)}}function Qve(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jve(e){var t=eye(e,"string");return wh(t)==="symbol"?t:String(t)}function eye(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nv=function(){function e(t,r){Zve(this,e),this.nodesPool=typeof t=="string"?new Xve(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Qve(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function tye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nye(n.key),n)}}function rye(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nye(e){var t=oye(e,"string");return js(t)==="symbol"?t:String(t)}function oye(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M_(e,t)}function M_(e,t){return M_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},M_(e,t)}function aye(e){var t=uye();return function(){var n=wm(e),o;if(t){var i=wm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lye(this,o)}}function lye(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sye(e)}function sye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wm(e){return wm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wm(e)}var fye=function(e){iye(r,e);var t=aye(r);function r(){var n;return tye(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return rye(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new v2(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<l;y++){d.render();var p=d.getCurrentNode();p.className="",p.removeAttribute("style"),a[y](c,p,y)}d.end()}}}]),r}(Nv);function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function cye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dye(n.key),n)}}function hye(e,t,r){return t&&jI(e.prototype,t),r&&jI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dye(e){var t=vye(e,"string");return Fs(t)==="symbol"?t:String(t)}function vye(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function gye(e){var t=bye();return function(){var n=Sm(e),o;if(t){var i=Sm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mye(this,o)}}function mye(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pye(e)}function pye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sm(e){return Sm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sm(e)}var wye=function(e){yye(r,e);var t=gye(r);function r(n){return cye(this,r),t.call(this,null,n)}return hye(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&_n(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(Nv);function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function Sye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ye(n.key),n)}}function Cye(e,t,r){return t&&FI(e.prototype,t),r&&FI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ye(e){var t=Oye(e,"string");return Bs(t)==="symbol"?t:String(t)}function Oye(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D_(e,t)}function D_(e,t){return D_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},D_(e,t)}function Eye(e){var t=kye();return function(){var n=Cm(e),o;if(t){var i=Cm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tye(this,o)}}function Tye(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pye(e)}function Pye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cm(e){return Cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cm(e)}var $ye=function(e){Rye(r,e);var t=Eye(r);function r(n){return Sye(this,r),t.call(this,null,n)}return Cye(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&te(d,"rowHeader")}}]),r}(Nv);function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}var BI;function Aye(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Iye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xye(n.key),n)}}function Mye(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xye(e){var t=Dye(e,"string");return Vs(t)==="symbol"?t:String(t)}function Dye(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N_(e,t)}function N_(e,t){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N_(e,t)}function Hye(e){var t=Fye();return function(){var n=_m(e),o;if(t){var i=_m(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lye(this,o)}}function Lye(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jye(e)}function jye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _m(e){return _m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_m(e)}var WI=!1,Bye=function(e){Nye(r,e);var t=Hye(r);function r(n){var o;return Iye(this,r),o=t.call(this,"TR",n),o.orderView=new d2(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return Mye(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!WI&&o>1e3&&(WI=!0,wt(dt(BI||(BI=Aye([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Nv);function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function Vye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uye(n.key),n)}}function Wye(e,t,r){return t&&UI(e.prototype,t),r&&UI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uye(e){var t=zye(e,"string");return Ws(t)==="symbol"?t:String(t)}function zye(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H_(e,t)}function H_(e,t){return H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},H_(e,t)}function Yye(e){var t=Xye();return function(){var n=Om(e),o;if(t){var i=Om(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kye(this,o)}}function Kye(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qye(e)}function qye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Om(e){return Om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Om(e)}var Zye=function(e){Gye(r,e);var t=Yye(r);function r(){var n;return Vye(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Wye(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new v2(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var y=h.getCurrentNode(),p=this.table.renderedColumnToSource(v);xe(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(f,p,y)}h.end()}}}]),r}(Nv);function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function Qye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ege(n.key),n)}}function Jye(e,t,r){return t&&zI(e.prototype,t),r&&zI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ege(e){var t=tge(e,"string");return Sh(t)==="symbol"?t:String(t)}function tge(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rge=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Qye(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Jye(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}function nge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ige(n.key),n)}}function oge(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ige(e){var t=age(e,"string");return Ch(t)==="symbol"?t:String(t)}function age(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lge=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;nge(this,e),this.renderer=new rge(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new fye,columnHeaders:new wye(n),colGroup:new $ye(o),rows:new Bye(i),cells:new Zye}),this.renderer.setAxisUtils(a,l)}return oge(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function sge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fge(n.key),n)}}function uge(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fge(e){var t=cge(e,"string");return _h(t)==="symbol"?t:String(t)}function cge(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hge=function(){function e(t,r){sge(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return uge(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Jt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function Oh(e){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}function dge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yge(n.key),n)}}function vge(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yge(e){var t=gge(e,"string");return Oh(t)==="symbol"?t:String(t)}function gge(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mge=function(){function e(t,r){dge(this,e),this.dataAccessObject=t,this.wtSettings=r}return vge(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function pge(e){return Sge(e)||wge(e)||y2(e)||bge()}function bge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wge(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sge(e){if(Array.isArray(e))return L_(e)}function Cge(e,t){return Rge(e)||Oge(e,t)||y2(e,t)||_ge()}function _ge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y2(e,t){if(e){if(typeof e=="string")return L_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L_(e,t)}}function L_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oge(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Rge(e){if(Array.isArray(e))return e}function Ege(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g2(n.key),n)}}function Tge(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kn(e,t,r){return t=g2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g2(e){var t=Pge(e,"string");return Rh(t)==="symbol"?t:String(t)}function Pge(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kge=function(){function e(t,r,n,o,i){var a=this;Ege(this,e),kn(this,"wtSettings",null),kn(this,"domBindings",void 0),kn(this,"TBODY",null),kn(this,"THEAD",null),kn(this,"COLGROUP",null),kn(this,"hasTableHeight",!0),kn(this,"hasTableWidth",!0),kn(this,"isTableVisible",!1),kn(this,"tableOffset",0),kn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,jE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new mge(this.dataAccessObject,this.wtSettings),this.columnUtils=new hge(this.dataAccessObject,this.wtSettings),this.tableRenderer=new lge({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Tge(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Ut(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var y=i.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,p!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ut(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Cve(w,l,h),this.columnFilter=new gve(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var k={};this.wtSettings.getSetting("beforeDraw",!0,k),C=k.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Bn)||this.is(wi))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var _;if(this.isMaster&&(_=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Bn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var D=ht(this.hider),V=ht(this.TABLE);D!==0&&V!==D&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),_!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Bn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var X=!1;return this.isMaster&&(X=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(X=i.bottomOverlay.resetFixedPosition()||X),X=i.inlineStartOverlay.resetFixedPosition()||X,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),X?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=vo(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Bn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Le(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,y=0;y<v;y++)l.includes(d[y])||l.push(d[y]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var p=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var w=0;w<p.length;w++)l.push(p[w]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var k=0;k<a;k++)i[k].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=Cge(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=pi(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=pW(o),l=n.cellIndex;if(si(qa,n,this.wtRootElement)||si(Ya,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(si(wi,n,this.wtRootElement)||si(Bn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return si(qa,n,this.wtRootElement)||si(Ka,n,this.wtRootElement)||si(wi,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=vo(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=vo(u):a=vo(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ht(this.TABLE)}},{key:"getHeight",value:function(){return Pt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ht(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Pt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return bs(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=pt(r)?r():null;return Array.isArray(n)?(n=pge(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Nf=kge;var $ge="stickyRowsBottom",m2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(m2,"MIXIN_NAME",$ge,{writable:!1,enumerable:!1});const p2=m2;var Age="stickyColumnsStart",b2={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Kn(b2,"MIXIN_NAME",Age,{writable:!1,enumerable:!1});const hT=b2;function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mge(n.key),n)}}function Ige(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mge(e){var t=xge(e,"string");return Us(t)==="symbol"?t:String(t)}function xge(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j_(e,t)}function j_(e,t){return j_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},j_(e,t)}function Hge(e){var t=Fge();return function(){var n=Rm(e),o;if(t){var i=Rm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lge(this,o)}}function Lge(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jge(e)}function jge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rm(e){return Rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rm(e)}var dT=function(e){Nge(r,e);var t=Hge(r);function r(n,o,i,a){return Dge(this,r),t.call(this,n,o,i,a,wi)}return Ige(r)}(Nf);gt(dT,p2);gt(dT,hT);const Bge=dT;var Ya="top",Bn="bottom",Ka="inline_start",qa="top_inline_start_corner",wi="bottom_inline_start_corner",Vge=[Ya,Bn,Ka,qa,wi],Wge=new Map([[Ya,"ht_clone_".concat(Ya)],[Bn,"ht_clone_".concat(Bn)],[Ka,"ht_clone_".concat(Ka," ht_clone_left")],[qa,"ht_clone_".concat(qa," ht_clone_top_left_corner")],[wi,"ht_clone_".concat(wi," ht_clone_bottom_left_corner")]]),Uge=Gt,zge=Math.floor,Gge=Number.isInteger||function(t){return!Uge(t)&&isFinite(t)&&zge(t)===t},Yge=$e,Kge=Gge;Yge({target:"Number",stat:!0},{isInteger:Kge});function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function qge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w2(n.key),n)}}function Xge(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lw(e,t,r){return t=w2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w2(e){var t=Zge(e,"string");return Eh(t)==="symbol"?t:String(t)}function Zge(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qge=function(){function e(t){qge(this,e),Lw(this,"dataAccessObject",void 0),Lw(this,"lastScrolledColumnPos",-1),Lw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Xge(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var y=!1;return s===-1?y=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(y=v.scrollTo(r,f?r>u:o)),y&&(this.lastScrolledRowPos=r),y}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Ut(o.wtRootElement),c=vo(o.hider),h=vo(s),d=eh(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var y=a;y>0;y--)if(v+=n.sumCellSizes(y-1,y),f.top+c-v<=d){u=y;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=eh(l,l);if(u.top>f){for(var c=vo(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=xc(o.hider),c=xc(l),h=Math.abs(sm(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var y=Ut(i.wtRootElement);c=y.left}var p=Math.abs(sm(s,s));if(c>p){for(var w=xc(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-p>=w){u=C-2;break}}}return u}}]),e}();const Jge=Qge;function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function eme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S2(n.key),n)}}function tme(e,t,r){return t&&QI(e.prototype,t),r&&QI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sn(e,t,r){return t=S2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S2(e){var t=rme(e,"string");return Th(t)==="symbol"?t:String(t)}function rme(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vT=function(){function e(t,r){eme(this,e),sn(this,"wtTable",void 0),sn(this,"wtScroll",void 0),sn(this,"wtViewport",void 0),sn(this,"wtOverlays",void 0),sn(this,"selections",void 0),sn(this,"wtEvent",void 0),sn(this,"guid","wt_".concat(NE())),sn(this,"drawInterrupted",!1),sn(this,"drawn",!1),sn(this,"domBindings",void 0),sn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Jge(this.createScrollDao())}return tme(e,[{key:"eventManager",get:function(){return new kt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ii(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new gm(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new cT(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function JI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C2(n.key),n)}}function nme(e,t,r){return t&&JI(e.prototype,t),r&&JI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ome(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ime(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F_(e,t)}function F_(e,t){return F_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},F_(e,t)}function ame(e){var t=sme();return function(){var n=Em(e),o;if(t){var i=Em(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lme(this,o)}}function lme(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Og(e)}function Og(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Em(e){return Em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Em(e)}function eM(e,t,r){return t=C2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C2(e){var t=ume(e,"string");return zs(t)==="symbol"?t:String(t)}function ume(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fme=function(e){ime(r,e);var t=ame(r);function r(n,o,i){var a;ome(this,r),a=t.call(this,n,o),eM(Og(a),"cloneSource",void 0),eM(Og(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",Og(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new h2(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return nme(r)}(vT);function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function cme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_2(n.key),n)}}function hme(e,t,r){return t&&tM(e.prototype,t),r&&tM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dme(e,t,r){return t=_2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _2(e){var t=vme(e,"string");return Ph(t)==="symbol"?t:String(t)}function vme(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hv=function(){function e(t,r,n,o,i){cme(this,e),dme(this,"wtSettings",null),Kn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=Ua(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return hme(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Ua(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=th(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){wt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Jt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(Vge.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(Wge.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ya||u==="vertical"&&this.type===Ka?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=th(r.TABLE),new fme(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;A([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function Rg(e,t,r){return O2()?Rg=Reflect.construct.bind():Rg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Tm(u,a.prototype),u},Rg.apply(null,arguments)}function yme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mme(n.key),n)}}function gme(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mme(e){var t=pme(e,"string");return Gs(t)==="symbol"?t:String(t)}function pme(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tm(e,t)}function Tm(e,t){return Tm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Tm(e,t)}function wme(e){var t=O2();return function(){var n=Pm(e),o;if(t){var i=Pm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Sme(this,o)}}function Sme(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cme(e)}function Cme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pm(e){return Pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pm(e)}var _me=function(e){bme(r,e);var t=wme(r);function r(n,o,i,a,l,s){var u;return yme(this,r),u=t.call(this,n,o,wi,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return gme(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Rg(Bge,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else $v(i),this.repositionOverlay();var s=Pt(this.clone.wtTable.TABLE),u=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}}]),r}(Hv),Ome="calculatedColumns",R2={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Kn(R2,"MIXIN_NAME",Ome,{writable:!1,enumerable:!1});const yT=R2;function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function nM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eme(n.key),n)}}function Rme(e,t,r){return t&&nM(e.prototype,t),r&&nM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eme(e){var t=Tme(e,"string");return Ys(t)==="symbol"?t:String(t)}function Tme(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B_(e,t)}function B_(e,t){return B_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},B_(e,t)}function $me(e){var t=Mme();return function(){var n=km(e),o;if(t){var i=km(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ame(this,o)}}function Ame(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ime(e)}function Ime(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function km(e){return km=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},km(e)}var gT=function(e){kme(r,e);var t=$me(r);function r(n,o,i,a){return Pme(this,r),t.call(this,n,o,i,a,Bn)}return Rme(r)}(Nf);gt(gT,p2);gt(gT,yT);const xme=gT;function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function Eg(e,t,r){return T2()?Eg=Reflect.construct.bind():Eg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&$m(u,a.prototype),u},Eg.apply(null,arguments)}function Dme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P2(n.key),n)}}function Nme(e,t,r){return t&&oM(e.prototype,t),r&&oM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$m(e,t)}function $m(e,t){return $m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$m(e,t)}function Lme(e){var t=T2();return function(){var n=Am(e),o;if(t){var i=Am(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jme(this,o)}}function jme(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E2(e)}function E2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Am(e){return Am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Am(e)}function Fme(e,t,r){return t=P2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P2(e){var t=Bme(e,"string");return Ks(t)==="symbol"?t:String(t)}function Bme(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vme=function(e){Hme(r,e);var t=Lme(r);function r(n,o,i,a){var l;return Dme(this,r),l=t.call(this,n,o,Bn,i,a),Fme(E2(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return Nme(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Eg(xme,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Wa(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Jt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var y=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),h.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return eh(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(te(u,"innerBorderBottom"),s=!f):(Le(u,"innerBorderBottom"),s=f)}return s}}]),r}(Hv),Wme="calculatedRows",k2={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Kn(k2,"MIXIN_NAME",Wme,{writable:!1,enumerable:!1});const $2=k2;function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function iM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zme(n.key),n)}}function Ume(e,t,r){return t&&iM(e.prototype,t),r&&iM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zme(e){var t=Gme(e,"string");return qs(t)==="symbol"?t:String(t)}function Gme(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V_(e,t)}function V_(e,t){return V_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},V_(e,t)}function qme(e){var t=Qme();return function(){var n=Im(e),o;if(t){var i=Im(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Xme(this,o)}}function Xme(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zme(e)}function Zme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Im(e){return Im=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Im(e)}var mT=function(e){Kme(r,e);var t=qme(r);function r(n,o,i,a){return Yme(this,r),t.call(this,n,o,i,a,Ka)}return Ume(r)}(Nf);gt(mT,$2);gt(mT,hT);const Jme=mT;function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function Tg(e,t,r){return A2()?Tg=Reflect.construct.bind():Tg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Mm(u,a.prototype),u},Tg.apply(null,arguments)}function epe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rpe(n.key),n)}}function tpe(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rpe(e){var t=npe(e,"string");return Xs(t)==="symbol"?t:String(t)}function npe(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ope(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mm(e,t)}function Mm(e,t){return Mm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Mm(e,t)}function ipe(e){var t=A2();return function(){var n=xm(e),o;if(t){var i=xm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ape(this,o)}}function ape(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lpe(e)}function lpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xm(e){return xm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xm(e)}var spe=function(e){ope(r,e);var t=ipe(r);function r(n,o,i,a){return epe(this,r),t.call(this,n,o,Ka,i,a)}return tpe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Tg(Jme,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Xp(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),$v(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,ws(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=ht(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(sm(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Le(i,"emptyRows"):te(i,"emptyRows");var u=!1;if(l&&!a.length)te(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(te(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(Le(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(Hv),upe="stickyRowsTop",I2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(I2,"MIXIN_NAME",upe,{writable:!1,enumerable:!1});const M2=I2;function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function lM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cpe(n.key),n)}}function fpe(e,t,r){return t&&lM(e.prototype,t),r&&lM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cpe(e){var t=hpe(e,"string");return Zs(t)==="symbol"?t:String(t)}function hpe(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W_(e,t)}function W_(e,t){return W_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},W_(e,t)}function ype(e){var t=ppe();return function(){var n=Dm(e),o;if(t){var i=Dm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gpe(this,o)}}function gpe(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mpe(e)}function mpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ppe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dm(e){return Dm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dm(e)}var pT=function(e){vpe(r,e);var t=ype(r);function r(n,o,i,a){return dpe(this,r),t.call(this,n,o,i,a,qa)}return fpe(r)}(Nf);gt(pT,M2);gt(pT,hT);const bpe=pT;function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function Pg(e,t,r){return x2()?Pg=Reflect.construct.bind():Pg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Nm(u,a.prototype),u},Pg.apply(null,arguments)}function wpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D2(n.key),n)}}function Spe(e,t,r){return t&&sM(e.prototype,t),r&&sM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nm(e,t)}function Nm(e,t){return Nm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Nm(e,t)}function _pe(e){var t=x2();return function(){var n=Hm(e),o;if(t){var i=Hm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ope(this,o)}}function Ope(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U_(e)}function U_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hm(e){return Hm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hm(e)}function uM(e,t,r){return t=D2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D2(e){var t=Rpe(e,"string");return Qs(t)==="symbol"?t:String(t)}function Rpe(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Epe=function(e){Cpe(r,e);var t=_pe(r);function r(n,o,i,a,l,s){var u;return wpe(this,r),u=t.call(this,n,o,qa,i,a),uM(U_(u),"topOverlay",void 0),uM(U_(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return Spe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Pg(bpe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();Xp(o,"".concat(i,"px"),"".concat(a,"px"))}else $v(o);var l=Pt(this.clone.wtTable.TABLE),s=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(Hv);function Js(e){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Js(e)}function fM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ppe(n.key),n)}}function Tpe(e,t,r){return t&&fM(e.prototype,t),r&&fM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ppe(e){var t=kpe(e,"string");return Js(t)==="symbol"?t:String(t)}function kpe(e,t){if(Js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ape(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z_(e,t)}function z_(e,t){return z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},z_(e,t)}function Ipe(e){var t=Dpe();return function(){var n=Lm(e),o;if(t){var i=Lm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Mpe(this,o)}}function Mpe(e,t){if(t&&(Js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xpe(e)}function xpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lm(e){return Lm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lm(e)}var bT=function(e){Ape(r,e);var t=Ipe(r);function r(n,o,i,a){return $pe(this,r),t.call(this,n,o,i,a,Ya)}return Tpe(r)}(Nf);gt(bT,M2);gt(bT,yT);const Npe=bT;function eu(e){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function kg(e,t,r){return H2()?kg=Reflect.construct.bind():kg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&jm(u,a.prototype),u},kg.apply(null,arguments)}function Hpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L2(n.key),n)}}function Lpe(e,t,r){return t&&cM(e.prototype,t),r&&cM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jm(e,t)}function jm(e,t){return jm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jm(e,t)}function Fpe(e){var t=H2();return function(){var n=Fm(e),o;if(t){var i=Fm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bpe(this,o)}}function Bpe(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N2(e)}function N2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fm(e){return Fm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fm(e)}function Vpe(e,t,r){return t=L2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L2(e){var t=Wpe(e,"string");return eu(t)==="symbol"?t:String(t)}function Wpe(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Upe=function(e){jpe(r,e);var t=Fpe(r);function r(n,o,i,a){var l;return Hpe(this,r),l=t.call(this,n,o,Ya,i,a),Vpe(N2(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return Lpe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return kg(Npe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),Xp(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),$v(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Wa(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Jt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return eh(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Le(a,"emptyColumns"):te(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(te(a,"innerBorderTop"),s=!h):(Le(a,"innerBorderTop"),s=h)}}return s}}]),r}(Hv);function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function ci(e,t,r){return zpe()?ci=Reflect.construct.bind():ci=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&G_(u,a.prototype),u},ci.apply(null,arguments)}function zpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function G_(e,t){return G_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},G_(e,t)}function Gpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j2(n.key),n)}}function Ype(e,t,r){return t&&hM(e.prototype,t),r&&hM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qn(e,t,r){return t=j2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j2(e){var t=Kpe(e,"string");return kh(t)==="symbol"?t:String(t)}function Kpe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qpe=function(){function e(t,r,n,o,i,a){var l=this;Gpe(this,e),Qn(this,"wot",null),Qn(this,"topOverlay",null),Qn(this,"bottomOverlay",null),Qn(this,"inlineStartOverlay",null),Qn(this,"topInlineStartCornerOverlay",null),Qn(this,"bottomInlineStartCornerOverlay",null),Qn(this,"browserLineHeight",void 0),Qn(this,"wtSettings",null),Qn(this,"resizeObserver",new ResizeObserver(function(h){Kp(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Jt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:th(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return Ype(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ci(Upe,r),this.bottomOverlay=ci(Vme,r),this.inlineStartOverlay=ci(spe,r),this.topInlineStartCornerOverlay=ci(Epe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ci(_me,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!kE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var y=v.clone.wtTable.holder;r.eventManager.addEventListener(y,"wheel",function(p){return r.onCloneWheel(p,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=ps(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=th(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,y=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<y,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return A(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Xpe=qpe;function $h(e){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}function Zpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F2(n.key),n)}}function Qpe(e,t,r){return t&&dM(e.prototype,t),r&&dM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vM(e,t,r){return t=F2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F2(e){var t=Jpe(e,"string");return $h(t)==="symbol"?t:String(t)}function Jpe(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ebe=function(){function e(t){var r=this;Zpe(this,e),vM(this,"settings",{}),vM(this,"defaults",Object.freeze(this.getDefaults())),ze(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return Qpe(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ii(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?ze(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function tbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nbe(n.key),n)}}function rbe(e,t,r){return t&&yM(e.prototype,t),r&&yM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nbe(e){var t=obe(e,"string");return tu(t)==="symbol"?t:String(t)}function obe(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ibe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y_(e,t)}function Y_(e,t){return Y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Y_(e,t)}function abe(e){var t=ube();return function(){var n=Bm(e),o;if(t){var i=Bm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lbe(this,o)}}function lbe(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sbe(e)}function sbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ube(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bm(e){return Bm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bm(e)}var wT=function(e){ibe(r,e);var t=abe(r);function r(n,o,i,a){return tbe(this,r),t.call(this,n,o,i,a,"master")}return rbe(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Ua(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=Ss(o,"height",i),u=Ss(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,y=d.height,p=["auto","hidden","scroll"];if(l&&p.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Mi(w,i).height,10);l.removeChild(w),S===0&&(y=0)}y=Math.min(y,h),f.height=s==="auto"?"auto":"".concat(y,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:y>0,this.hasTableWidth=v>0}this.isTableVisible=bs(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Nf);gt(wT,$2);gt(wT,yT);const fbe=wT;function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function cbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dbe(n.key),n)}}function hbe(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dbe(e){var t=vbe(e,"string");return Ah(t)==="symbol"?t:String(t)}function vbe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ybe=function(){function e(t,r,n,o,i){var a=this;cbe(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return hbe(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Pt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,y;if(u)return ht(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(y=Ss(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,a.clientWidth);var p=r.getSetting("stretchH");return p==="none"||!p?Math.max(v,ht(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Ut(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Pt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=ht(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ua,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===ua?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Jt(this.domBindings.rootDocument),new l2({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ua,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new fT({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(lr),i=this.createColumnsCalculator(lr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(ua),this.columnsRenderCalculator=this.createColumnsCalculator(ua)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(lr),this.columnsVisibleCalculator=this.createColumnsCalculator(lr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){ze(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const gbe=ybe;function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function mbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bbe(n.key),n)}}function pbe(e,t,r){return t&&mM(e.prototype,t),r&&mM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bbe(e){var t=wbe(e,"string");return ru(t)==="symbol"?t:String(t)}function wbe(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K_(e,t)}function K_(e,t){return K_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},K_(e,t)}function Cbe(e){var t=Obe();return function(){var n=Vm(e),o;if(t){var i=Vm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _be(this,o)}}function _be(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q_(e)}function q_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Obe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vm(e){return Vm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vm(e)}var Rbe=function(e){Sbe(r,e);var t=Cbe(r);function r(n,o){var i;mbe(this,r),i=t.call(this,n,new ebe(o));var a=i.wtSettings.getSetting("facade",q_(i));return i.wtTable=new fbe(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new gbe(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new h2(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Xpe(q_(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return pbe(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];ze(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Le(this.wtTable.wtRootElement.parentNode,a),te(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(vT);function Ih(e){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}function Ebe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pbe(n.key),n)}}function Tbe(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pbe(e){var t=kbe(e,"string");return Ih(t)==="symbol"?t:String(t)}function kbe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $be=function(){function e(t){Ebe(this,e),t instanceof vT?this._wot=t:this._initFromSettings(t)}return Tbe(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new Rbe(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),B2=Yt,Abe=je,V2=Ge,Ibe=dv,Mbe=iv,xbe=zr,Dbe=uv.f,W2=V2(Dbe),Nbe=V2([].push),Hbe=B2&&Abe(function(){var e=Object.create(null);return e[2]=2,!W2(e,2)}),bM=function(e){return function(t){for(var r=xbe(t),n=Mbe(r),o=Hbe&&Ibe(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!B2||(o?s in r:W2(r,s)))&&Nbe(l,e?[s,r[s]]:r[s]);return l}},Lbe={entries:bM(!0),values:bM(!1)},jbe=$e,Fbe=Lbe.values;jbe({target:"Object",stat:!0},{values:function(t){return Fbe(t)}});function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function jw(e,t){return Ube(e)||Wbe(e,t)||Vbe(e,t)||Bbe()}function Bbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vbe(e,t){if(e){if(typeof e=="string")return wM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wM(e,t)}}function wM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Ube(e){if(Array.isArray(e))return e}function zbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ybe(n.key),n)}}function Gbe(e,t,r){return t&&SM(e.prototype,t),r&&SM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ybe(e){var t=Kbe(e,"string");return Mh(t)==="symbol"?t:String(t)}function Kbe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qbe=function(){function e(t,r){zbe(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Gbe(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Sn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),pn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};ze(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};ze(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,y=parseInt(c.borderWidth,10),p=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-p-1,10),"px"),c[u]="".concat(parseInt(i-p-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var k=Math.min(parseInt(i+a,10),S-p-y*2),_=Math.min(parseInt(i+a-w/4,10),S-w-y*2);d[u]="".concat(k,"px"),v[u]="".concat(_,"px");var D=Math.min(parseInt(o+l,10),C-p-y*2),V=Math.min(parseInt(o+l-w/4,10),C-w-y*2);d.top="".concat(D,"px"),v.top="".concat(V,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var y=o.rowFilter.renderedToSource(v);if(y>=r[0]&&y<=r[2]){l=y,c=r[0];break}}for(var p=d-1;p>=0;p-=1){var w=o.rowFilter.renderedToSource(p);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var k=o.columnFilter.renderedToSource(C);if(k>=r[1]&&k<=r[3]){u=k,h=r[1];break}}for(var _=S-1;_>=0;_-=1){var D=o.columnFilter.renderedToSource(_);if(D>=r[1]&&D<=r[3]){f=D;break}}if(l===void 0||u===void 0){this.disappear();return}var V=o.getCell(this.wot.createCellCoords(l,u)),X=l!==s||u!==f,G=X?o.getCell(this.wot.createCellCoords(s,f)):V,q=Ut(V),Q=X?Ut(G):q,ne=Ut(o.TABLE),J=ht(o.TABLE),ue=q.top,he=q.left,Oe=this.wot.wtSettings.getSetting("rtlMode"),we=0,$=0;if(Oe){var P=ht(V),g=a.innerWidth-ne.left-J;$=he+P-Q.left,we=a.innerWidth-he-P-g-1}else $=Q.left+ht(G)-he,we=he-ne.left-1;if(this.isEntireColumnSelected(l,s)){var m=this.getDimensionsFromHeader("columns",u,f,c,ne),b=null;if(m){var E=jw(m,3);b=E[0],we=E[1],$=E[2]}b&&(V=b)}var R=ue-ne.top-1,B=Q.top+Pt(G)-ue;if(this.isEntireRowSelected(u,f)){var x=this.getDimensionsFromHeader("rows",l,s,h,ne),K=null;if(x){var Z=jw(x,3);K=Z[0],R=Z[1],B=Z[2]}K&&(V=K)}var re=Mi(V,a);parseInt(re.borderTopWidth,10)>0&&(R+=1,B=B>0?B-1:0),parseInt(re[Oe?"borderRightWidth":"borderLeftWidth"],10)>0&&(we+=1,$=$>0?$-1:0);var ie=Oe?"right":"left";this.topStyle.top="".concat(R,"px"),this.topStyle[ie]="".concat(we,"px"),this.topStyle.width="".concat($,"px"),this.topStyle.display="block",this.startStyle.top="".concat(R,"px"),this.startStyle[ie]="".concat(we,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var se=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(R+B-se,"px"),this.bottomStyle[ie]="".concat(we,"px"),this.bottomStyle.width="".concat($,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(R,"px"),this.endStyle[ie]="".concat(we+$-se,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var _e=this.settings.border.cornerVisible;_e=typeof _e=="function"?_e(this.settings.layerLevel):_e;var Se=this.wot.getSetting("onModifyGetCellCoords",s,f),z=s,Ne=f;if(Se&&Array.isArray(Se)){var Be=jw(Se,4);z=Be[2],Ne=Be[3]}if(pn()||!_e||this.isPartRange(z,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(R+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ie]="".concat(we+$+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ke=Ua(o.TABLE),Ie=ke===a;Ie&&(ke=i.documentElement);var Ae=parseInt(this.cornerDefaultStyle.width,10)/2,O=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var T=Ie?G.getBoundingClientRect().left:G.offsetLeft,I=!1,F=0;Oe?(F=T-parseInt(this.cornerDefaultStyle.width,10)/2,I=F<0):(F=T+ht(G)+parseInt(this.cornerDefaultStyle.width,10)/2,I=F>=xc(ke)),I&&(this.cornerStyle[ie]="".concat(Math.floor(we+$+this.cornerCenterPointOffset-Ae),"px"),this.cornerStyle[Oe?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ie?G.getBoundingClientRect().top:G.offsetTop,W=M+Pt(G)+parseInt(this.cornerDefaultStyle.height,10)/2,H=W>=vo(ke);H&&(this.cornerStyle.top="".concat(Math.floor(R+B+this.cornerCenterPointOffset-O),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}pn()&&this.updateMultipleSelectionHandlesPosition(s,f,R,we,$,B)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,y=null,p=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Pt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return ht.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(y=u(n,w-i),p=u(o,w-i),!y||!p)return!1;var S=Ut(y),C=Ut(p);return y&&p&&(h=S[v]-a[v]-1,d=C[v]+f(p)-S[v]),[y,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?te(this[r],"hidden"):(xe(this[r],"hidden")&&Le(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?te(this[r],"hidden"):Le(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",pn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Xbe=qbe;function Zbe(e,t){return twe(e)||ewe(e,t)||Jbe(e,t)||Qbe()}function Qbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jbe(e,t){if(e){if(typeof e=="string")return CM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CM(e,t)}}function CM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ewe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function twe(e){if(Array.isArray(e))return e}function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function rwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,owe(n.key),n)}}function nwe(e,t,r){return t&&_M(e.prototype,t),r&&_M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function owe(e){var t=iwe(e,"string");return nu(t)==="symbol"?t:String(t)}function iwe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var awe=function(){function e(t,r){rwe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return nwe(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Xbe(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(nu(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),te(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Zbe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,p=c.selectionType,w=p===void 0||["active-header","header"].includes(p);if(w&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var k=r.wtTable.columnFilter.renderedToSource(C);if(k>=s&&k<=f){var _=r.wtTable.getColumnHeaders(k),D=_.length-1;y&&_.length>1&&(_=[_[D]]);for(var V=0;V<_.length;V+=1){var X=[],G=_[V];h&&X.push(h),d&&X.push(d),V=y?D:V;var q=r.getSetting("onBeforeHighlightingColumnHeader",k,V,{selectionType:p,columnCursor:S,selectionWidth:f-s+1,classNames:X});q!==k&&(G=r.wtTable.getColumnHeader(q,V)),te(G,X)}S+=1}}if(l!==null&&u!==null)for(var Q=0,ne=0;ne<n;ne+=1){var J=r.wtTable.rowFilter.renderedToSource(ne);if(w&&J>=l&&J<=u){var ue=r.wtTable.getRowHeaders(J),he=ue.length-1;y&&ue.length>1&&(ue=[ue[he]]);for(var Oe=0;Oe<ue.length;Oe+=1){var we=[],$=ue[Oe];h&&we.push(h),v&&we.push(v),Oe=y?he:Oe;var P=r.getSetting("onBeforeHighlightingRowHeader",J,Oe,{selectionType:p,rowCursor:Q,selectionHeight:u-l+1,classNames:we});P!==J&&($=r.wtTable.getRowHeader(P,Oe)),te($,we)}Q+=1}if(s!==null&&f!==null)for(var g=0;g<o;g+=1){var m=r.wtTable.columnFilter.renderedToSource(g);J>=l&&J<=u&&m>=s&&m<=f?this.settings.className&&this.addClassAtCoords(r,J,m,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,m,v):m>=s&&m<=f&&d&&this.addClassAtCoords(r,J,m,d);var b=r.getSetting("onAfterDrawSelection",J,m,this.settings.layerLevel);typeof b=="string"&&this.addClassAtCoords(r,J,m,b)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const lwe=awe;var swe=$e,uwe=ll.findIndex,fwe=av,X_="findIndex",U2=!0;X_ in[]&&Array(1)[X_](function(){U2=!1});swe({target:"Array",proto:!0,forced:U2},{findIndex:function(t){return uwe(this,t,arguments.length>1?arguments[1]:void 0)}});fwe(X_);var cwe="localHooks",z2={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)um(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Kn(z2,"MIXIN_NAME",cwe,{writable:!1,enumerable:!1});const Mr=z2;function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function hwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vwe(n.key),n)}}function dwe(e,t,r){return t&&OM(e.prototype,t),r&&OM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vwe(e){var t=ywe(e,"string");return xh(t)==="symbol"?t:String(t)}function ywe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hl=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;hwe(this,e),this.indexedValues=[],this.initValueOrFn=t}return dwe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,pt(this.initValueOrFn)?Ce(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Ce(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();gt(hl,Mr);function Fw(e){return bwe(e)||pwe(e)||mwe(e)||gwe()}function gwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mwe(e,t){if(e){if(typeof e=="string")return Z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z_(e,t)}}function pwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bwe(e){if(Array.isArray(e))return Z_(e)}function Z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ST(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Fw(e.slice(0,o)),Fw(r.map(function(i,a){return pt(n)?n(i,a):n})),Fw(o===void 0?[]:e.slice(o)))}function CT(e,t){return Wr(e,function(r,n){return t.includes(n)===!1})}function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function wwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cwe(n.key),n)}}function Swe(e,t,r){return t&&RM(e.prototype,t),r&&RM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cwe(e){var t=_we(e,"string");return ou(t)==="symbol"?t:String(t)}function _we(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hc(){return typeof Reflect<"u"&&Reflect.get?Hc=Reflect.get.bind():Hc=function(t,r,n){var o=Owe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hc.apply(this,arguments)}function Owe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xa(e),e!==null););return e}function Rwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q_(e,t)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q_(e,t)}function Ewe(e){var t=kwe();return function(){var n=Xa(e),o;if(t){var i=Xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Twe(this,o)}}function Twe(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pwe(e)}function Pwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xa(e){return Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xa(e)}var ji=function(e){Rwe(r,e);var t=Ewe(r);function r(){return wwe(this,r),t.apply(this,arguments)}return Swe(r,[{key:"insert",value:function(o,i){this.indexedValues=ST(this.indexedValues,o,i,this.initValueOrFn),Hc(Xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=CT(this.indexedValues,o),Hc(Xa(r.prototype),"remove",this).call(this,o)}}]),r}(hl);function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function $we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iwe(n.key),n)}}function Awe(e,t,r){return t&&EM(e.prototype,t),r&&EM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iwe(e){var t=Mwe(e,"string");return iu(t)==="symbol"?t:String(t)}function Mwe(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J_(e,t)}function J_(e,t){return J_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},J_(e,t)}function Dwe(e){var t=Lwe();return function(){var n=Wm(e),o;if(t){var i=Wm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nwe(this,o)}}function Nwe(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hwe(e)}function Hwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wm(e){return Wm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wm(e)}var tb=function(e){xwe(r,e);var t=Dwe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return $we(this,r),t.call(this,n)}return Awe(r,[{key:"getHiddenIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(ji);function Bw(e){return Vwe(e)||Bwe(e)||Fwe(e)||jwe()}function jwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fwe(e,t){if(e){if(typeof e=="string")return eO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eO(e,t)}}function Bwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vwe(e){if(Array.isArray(e))return eO(e)}function eO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _T(e,t,r){return[].concat(Bw(e.slice(0,t)),Bw(r),Bw(e.slice(t)))}function Dh(e,t){return Wr(e,function(r){return t.includes(r)===!1})}function OT(e,t){return We(e,function(r){return r-t.filter(function(n){return n<r}).length})}function RT(e,t){var r=t[0],n=t.length;return We(e,function(o){return o>=r?o+n:o})}function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function Wwe(e){return Ywe(e)||Gwe(e)||zwe(e)||Uwe()}function Uwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zwe(e,t){if(e){if(typeof e=="string")return tO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tO(e,t)}}function Gwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ywe(e){if(Array.isArray(e))return tO(e)}function tO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y2(n.key),n)}}function qwe(e,t,r){return t&&TM(e.prototype,t),r&&TM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uo(){return typeof Reflect<"u"&&Reflect.get?uo=Reflect.get.bind():uo=function(t,r,n){var o=Xwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},uo.apply(this,arguments)}function Xwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gn(e),e!==null););return e}function Zwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function Qwe(e){var t=eSe();return function(){var n=gn(e),o;if(t){var i=gn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jwe(this,o)}}function Jwe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G2(e)}function G2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gn(e){return gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gn(e)}function tSe(e,t,r){return t=Y2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y2(e){var t=rSe(e,"string");return au(t)==="symbol"?t:String(t)}function rSe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rb=function(e){Zwe(r,e);var t=Qwe(r);function r(){var n;Kwe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),tSe(G2(n),"orderOfIndexes",[]),n}return qwe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=Wwe(Array(o.length).keys()),uo(gn(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=Dh(this.orderOfIndexes,[o]),pt(this.initValueOrFn)?uo(gn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):uo(gn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,uo(gn(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=ST(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=RT(this.orderOfIndexes,i),uo(gn(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=CT(this.indexedValues,o),this.orderOfIndexes=Dh(this.orderOfIndexes,o),this.orderOfIndexes=OT(this.orderOfIndexes,o),uo(gn(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(hl);function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function nSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iSe(n.key),n)}}function oSe(e,t,r){return t&&PM(e.prototype,t),r&&PM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iSe(e){var t=aSe(e,"string");return lu(t)==="symbol"?t:String(t)}function aSe(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function sSe(e){var t=cSe();return function(){var n=Um(e),o;if(t){var i=Um(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uSe(this,o)}}function uSe(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fSe(e)}function fSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Um(e){return Um=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Um(e)}var Lv=function(e){lSe(r,e);var t=sSe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return nSe(this,r),t.call(this,n)}return oSe(r,[{key:"getTrimmedIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(ji),kM=new Map([["indexesSequence",{getListWithInsertedItems:_T,getListWithRemovedItems:Dh}],["physicallyIndexed",{getListWithInsertedItems:ST,getListWithRemovedItems:CT}]]),K2=function(t){if(kM.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return kM.get(t)};function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function hSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vSe(n.key),n)}}function dSe(e,t,r){return t&&$M(e.prototype,t),r&&$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vSe(e){var t=ySe(e,"string");return su(t)==="symbol"?t:String(t)}function ySe(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lc(){return typeof Reflect<"u"&&Reflect.get?Lc=Reflect.get.bind():Lc=function(t,r,n){var o=gSe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Lc.apply(this,arguments)}function gSe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Za(e),e!==null););return e}function mSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function pSe(e){var t=SSe();return function(){var n=Za(e),o;if(t){var i=Za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bSe(this,o)}}function bSe(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wSe(e)}function wSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Za(e){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Za(e)}var q2=function(e){mSe(r,e);var t=pSe(r);function r(){return hSe(this,r),t.call(this,function(n){return n})}return dSe(r,[{key:"insert",value:function(o,i){var a=RT(this.indexedValues,i);this.indexedValues=_T(a,o,i),Lc(Za(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Dh(this.indexedValues,o);this.indexedValues=OT(i,o),Lc(Za(r.prototype),"remove",this).call(this,o)}}]),r}(hl),AM=new Map([["hiding",tb],["index",hl],["linkedPhysicalIndexToValue",rb],["physicalIndexToValue",ji],["trimming",Lv]]);function CSe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!AM.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(AM.get(e))(t)}function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function _Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RSe(n.key),n)}}function OSe(e,t,r){return t&&IM(e.prototype,t),r&&IM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RSe(e){var t=ESe(e,"string");return Nh(t)==="symbol"?t:String(t)}function ESe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iO=0,ET=function(){function e(){_Se(this,e),this.collection=new Map}return OSe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),iO+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);ve(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),iO-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return bt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();gt(ET,Mr);function TSe(){return iO}function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function PSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Se(n.key),n)}}function kSe(e,t,r){return t&&MM(e.prototype,t),r&&MM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Se(e){var t=ASe(e,"string");return uu(t)==="symbol"?t:String(t)}function ASe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ISe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function MSe(e){var t=NSe();return function(){var n=zm(e),o;if(t){var i=zm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xSe(this,o)}}function xSe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DSe(e)}function DSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zm(e){return zm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zm(e)}var xM=function(e){ISe(r,e);var t=MSe(r);function r(n,o){var i;return PSe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return kSe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=We(this.get(),function(c){return c.getValues()}),a=[],l=ve(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return We(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ve(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(ET);function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function HSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jSe(n.key),n)}}function LSe(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jSe(e){var t=FSe(e,"string");return Hh(t)==="symbol"?t:String(t)}function FSe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BSe(e,t,r){VSe(e,t),t.set(e,r)}function VSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WSe(e,t,r){var n=X2(e,t,"set");return USe(e,n,r),r}function USe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function zSe(e,t){var r=X2(e,t,"get");return GSe(e,r)}function X2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function GSe(e,t){return t.get?t.get.call(e):t.value}var Vw=new WeakMap,Z2=function(){function e(){HSe(this,e),BSe(this,Vw,{writable:!0,value:[]})}return LSe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(zSe(this,Vw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){WSe(this,Vw,r)}}]),e}();gt(Z2,Mr);function NM(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function YSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qSe(n.key),n)}}function KSe(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qSe(e){var t=XSe(e,"string");return Lh(t)==="symbol"?t:String(t)}function XSe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rc(e,t,r){ZSe(e,t),t.set(e,r)}function ZSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(e,t){var r=Q2(e,t,"get");return QSe(e,r)}function QSe(e,t){return t.get?t.get.call(e):t.value}function by(e,t,r){var n=Q2(e,t,"set");return JSe(e,n,r),r}function Q2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function JSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var wy=new WeakMap,nc=new WeakMap,Sy=new WeakMap,Cy=new WeakMap,_y=new WeakMap,eCe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;YSe(this,e),rc(this,wy,{writable:!0,value:new Set}),rc(this,nc,{writable:!0,value:[]}),rc(this,Sy,{writable:!0,value:[]}),rc(this,Cy,{writable:!0,value:!1}),rc(this,_y,{writable:!0,value:!1}),by(this,_y,r??!1)}return KSe(e,[{key:"createObserver",value:function(){var r=this,n=new Z2;return Kr(this,wy).add(n),n.addLocalHook("unsubscribe",function(){Kr(r,wy).delete(n)}),n._writeInitialChanges(NM(Kr(this,nc),Kr(this,Sy))),n}},{key:"emit",value:function(r){var n=Kr(this,Sy);(!Kr(this,Cy)||Kr(this,nc).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Kr(this,_y)):by(this,nc,new Array(r.length).fill(Kr(this,_y))),Kr(this,Cy)||(by(this,Cy,!0),n=Kr(this,nc)));var o=NM(n,r);Kr(this,wy).forEach(function(i){return i._write(o)}),by(this,Sy,r)}}]),e}();function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function Ww(e){return oCe(e)||nCe(e)||rCe(e)||tCe()}function tCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rCe(e,t){if(e){if(typeof e=="string")return lO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lO(e,t)}}function nCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oCe(e){if(Array.isArray(e))return lO(e)}function lO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lCe(n.key),n)}}function aCe(e,t,r){return t&&LM(e.prototype,t),r&&LM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lCe(e){var t=sCe(e,"string");return jh(t)==="symbol"?t:String(t)}function sCe(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sO=function(){function e(){var t=this;iCe(this,e),this.indexesSequence=new q2,this.trimmingMapsCollection=new xM(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new xM(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new ET,this.hidingChangesObservable=new eCe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return aCe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,CSe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof Lv?this.trimmingMapsCollection.register(r,n):n instanceof tb?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ve(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ve(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ve(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ve(n)?n:null}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Ww(new Array(r).keys()),this.notHiddenIndexesCache=Ww(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=Ww(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=We(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=Dh(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(_T(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ve(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=We(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();gt(sO,Mr);function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function jM(e,t){return hCe(e)||cCe(e,t)||fCe(e,t)||uCe()}function uCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fCe(e,t){if(e){if(typeof e=="string")return FM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FM(e,t)}}function FM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hCe(e){if(Array.isArray(e))return e}function dCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yCe(n.key),n)}}function vCe(e,t,r){return t&&BM(e.prototype,t),r&&BM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yCe(e){var t=gCe(e,"string");return fu(t)==="symbol"?t:String(t)}function gCe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=mCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function mCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function pCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function bCe(e){var t=SCe();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wCe(this,o)}}function wCe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J2(e)}function J2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}ge.getSingleton().register("modifyAutoColumnSizeSeed");var oc="autoColumnSize",CCe=10,Uw=new WeakMap,_Ce="autoColumnSize",OCe=function(e){pCe(r,e);var t=bCe(r);function r(n){var o;return dCe(this,r),o=t.call(this,n),Uw.set(J2(o),{cachedColumnHeaders:[]}),o.ghostTable=new uT(o.hot),o.samplesGenerator=new a2(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new ji,o.hot.columnIndexMapper.registerMap(_Ce,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return vCe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[oc]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[oc];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),da(go(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),da(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;da(go(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Ce(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);A(h,function(d){var v=jM(d,2),y=v[0],p=v[1];return o.ghostTable.addColumn(y,p)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Qc(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Kp(c):(Qc(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[oc],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[oc],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ue(o)&&(i=o.syncLimit,HE(i)?i=GE(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,fT.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=Uw.get(this),a=i.cachedColumnHeaders,l=Ft(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){A(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=We(o,function(l){var s=jM(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){Uw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Wr(o,function(l){var s;return ve((s=l.address)===null||s===void 0?void 0:s.col)}),a=We(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),da(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return oc}},{key:"PLUGIN_PRIORITY",get:function(){return CCe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ot),va={horizontal:"horizontal",vertical:"vertical"};function RCe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function ECe(e){var t={};return e===!0?(t.directions=Object.keys(va),t.autoInsertRow=!0):Ue(e)?(ve(e.autoInsertRow)?e.direction===va.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ve(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(va)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function TCe(e){return $Ce(e)||kCe(e)||eU(e)||PCe()}function PCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Ce(e){if(Array.isArray(e))return fO(e)}function ACe(e,t){return xCe(e)||MCe(e,t)||eU(e,t)||ICe()}function ICe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eU(e,t){if(e){if(typeof e=="string")return fO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fO(e,t)}}function fO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xCe(e){if(Array.isArray(e))return e}function DCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HCe(n.key),n)}}function NCe(e,t,r){return t&&VM(e.prototype,t),r&&VM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HCe(e){var t=LCe(e,"string");return cu(t)==="symbol"?t:String(t)}function LCe(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=jCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function jCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function FCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function BCe(e){var t=WCe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VCe(this,o)}}function VCe(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tU(e)}function tU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");var WM="autofill",UCe=20,zCe=["fillHandle"],GCe="insert_row_below",YCe=200,KCe=function(e){FCe(r,e);var t=BCe(r);function r(n){var o;return DCe(this,r),o=t.call(this,n),o.eventManager=new kt(tU(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return NCe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),ya(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(mo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),ya(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],y=[];return A(h,function(p){for(var w=p.startRow;w<=p.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=p.startCol;S<=p.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),A(d,function(p){var w=[];A(v,function(S){w.push(o.hot.getCopyableData(p,S))}),y.push(w)}),y}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=ACe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),p=RCe(v,y,function(we,$){return o.hot._createCellCoords(we,$)}),w=p.directionOfDrag,S=p.startOfDragCoords,C=p.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var k=this.getSelectionData(),_=c.clone(),D=this.hot._createCellRange(S,S,C),V=this.hot.runHooks("beforeAutofill",k,_,D,w);if(V===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var X=V,G=V;if(["up","left"].indexOf(w)>-1&&!(G.length===1&&G[0].length===0))if(X=[],w==="up")for(var q=C.row-S.row+1,Q=q%G.length,ne=0;ne<q;ne++)X.push(G[(ne+(G.length-Q))%G.length]);else for(var J=C.col-S.col+1,ue=J%G[0].length,he=0;he<G.length;he++){X.push([]);for(var Oe=0;Oe<J;Oe++)X[he].push(G[he][(Oe+(G[he].length-ue))%G[he].length])}this.hot.populateFromArray(S.row,S.col,X,C.row,C.col,"".concat(this.pluginName,".fill"),null),this.setSelection(y),this.hot.runHooks("afterAutofill",X,_,D,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(va.vertical)&&this.directions.includes(va.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(va.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(va.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(GCe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},YCe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,TCe(We(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Ut(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Pt(this.hot.table),l=Ut(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+ht(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=ECe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){ya(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return WM}},{key:"PLUGIN_PRIORITY",get:function(){return UCe}},{key:"SETTING_KEYS",get:function(){return[WM].concat(zCe)}}]),r}(ot);function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function qCe(e,t){return JCe(e)||QCe(e,t)||ZCe(e,t)||XCe()}function XCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZCe(e,t){if(e){if(typeof e=="string")return UM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UM(e,t)}}function UM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function JCe(e){if(Array.isArray(e))return e}function e_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r_e(n.key),n)}}function t_e(e,t,r){return t&&zM(e.prototype,t),r&&zM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r_e(e){var t=n_e(e,"string");return hu(t)==="symbol"?t:String(t)}function n_e(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function is(){return typeof Reflect<"u"&&Reflect.get?is=Reflect.get.bind():is=function(t,r,n){var o=o_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},is.apply(this,arguments)}function o_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Si(e),e!==null););return e}function i_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hO(e,t)}function hO(e,t){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hO(e,t)}function a_e(e){var t=u_e();return function(){var n=Si(e),o;if(t){var i=Si(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return l_e(this,o)}}function l_e(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s_e(e)}function s_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Si(e)}var Oy="autoRowSize",f_e=40,c_e="autoRowSize",h_e=function(e){i_e(r,e);var t=a_e(r);function r(n){var o;return e_e(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new uT(o.hot),o.samplesGenerator=new a2(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new ji,o.hot.rowIndexMapper.registerMap(c_e,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return t_e(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[Oy];return o===!0||Ue(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),is(Si(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,is(Si(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Ce(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);A(h,function(d){var v=qCe(d,2),y=v[0],p=v[1];return o.ghostTable.addRow(y,p)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Qc(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Kp(c):(Qc(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Oy],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){bs(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Oy],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ue(o)&&(i=o.syncLimit,HE(i)?i=GE(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){Ce(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),is(Si(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Oy}},{key:"PLUGIN_PRIORITY",get:function(){return f_e}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ot);function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function d_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y_e(n.key),n)}}function v_e(e,t,r){return t&&GM(e.prototype,t),r&&GM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y_e(e){var t=g_e(e,"string");return du(t)==="symbol"?t:String(t)}function g_e(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jc(){return typeof Reflect<"u"&&Reflect.get?jc=Reflect.get.bind():jc=function(t,r,n){var o=m_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jc.apply(this,arguments)}function m_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qa(e),e!==null););return e}function p_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dO(e,t)}function b_e(e){var t=C_e();return function(){var n=Qa(e),o;if(t){var i=Qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return w_e(this,o)}}function w_e(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S_e(e)}function S_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qa(e){return Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qa(e)}var rU=K2("physicallyIndexed"),__e=rU.getListWithInsertedItems,O_e=rU.getListWithRemovedItems,R_e=function(e){p_e(r,e);var t=b_e(r);function r(){return d_e(this,r),t.call(this,function(n){return n})}return v_e(r,[{key:"insert",value:function(o,i){var a=RT(this.indexedValues,i);this.indexedValues=__e(a,o,i,this.initValueOrFn),jc(Qa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=O_e(this.indexedValues,o);this.indexedValues=OT(i,o),jc(Qa(r.prototype),"remove",this).call(this,o)}}]),r}(hl);const E_e=R_e;function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function T_e(e){return A_e(e)||$_e(e)||k_e(e)||P_e()}function P_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k_e(e,t){if(e){if(typeof e=="string")return vO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vO(e,t)}}function $_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function A_e(e){if(Array.isArray(e))return vO(e)}function vO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x_e(n.key),n)}}function M_e(e,t,r){return t&&YM(e.prototype,t),r&&YM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x_e(e){var t=D_e(e,"string");return vu(t)==="symbol"?t:String(t)}function D_e(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fc(){return typeof Reflect<"u"&&Reflect.get?Fc=Reflect.get.bind():Fc=function(t,r,n){var o=N_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fc.apply(this,arguments)}function N_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ja(e),e!==null););return e}function H_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yO(e,t)}function L_e(e){var t=B_e();return function(){var n=Ja(e),o;if(t){var i=Ja(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return j_e(this,o)}}function j_e(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F_e(e)}function F_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ja(e){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ja(e)}var nU=K2("physicallyIndexed"),V_e=nU.getListWithInsertedItems,W_e=nU.getListWithRemovedItems,U_e=function(e){H_e(r,e);var t=L_e(r);function r(){return I_e(this,r),t.call(this,function(n){return n})}return M_e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=V_e(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),Fc(Ja(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=W_e(this.indexedValues,o),Fc(Ja(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,T_e(this.getValues()))+1+o}}]),r}(hl);const z_e=U_e;function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function G_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K_e(n.key),n)}}function Y_e(e,t,r){return t&&KM(e.prototype,t),r&&KM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K_e(e){var t=q_e(e,"string");return yu(t)==="symbol"?t:String(t)}function q_e(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function as(){return typeof Reflect<"u"&&Reflect.get?as=Reflect.get.bind():as=function(t,r,n){var o=X_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},as.apply(this,arguments)}function X_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ci(e),e!==null););return e}function Z_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gO(e,t)}function gO(e,t){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gO(e,t)}function Q_e(e){var t=tOe();return function(){var n=Ci(e),o;if(t){var i=Ci(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return J_e(this,o)}}function J_e(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eOe(e)}function eOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ci(e){return Ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ci(e)}var zw="bindRowsWithHeaders",rOe=210,nOe="loose",oOe=new Map([["loose",E_e],["strict",z_e]]),iOe=function(e){Z_e(r,e);var t=Q_e(r);function r(n){var o;return G_e(this,r),o=t.call(this,n),o.headerIndexes=null,o}return Y_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[zw];typeof i!="string"&&(i=nOe);var a=oOe.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),as(Ci(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),as(Ci(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){as(Ci(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zw}},{key:"PLUGIN_PRIORITY",get:function(){return rOe}}]),r}(ot);function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function qM(e){return uOe(e)||sOe(e)||lOe(e)||aOe()}function aOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lOe(e,t){if(e){if(typeof e=="string")return mO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mO(e,t)}}function sOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uOe(e){if(Array.isArray(e))return mO(e)}function mO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oU(n.key),n)}}function cOe(e,t,r){return t&&XM(e.prototype,t),r&&XM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=hOe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function hOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function dOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pO(e,t)}function pO(e,t){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pO(e,t)}function vOe(e){var t=gOe();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yOe(this,o)}}function yOe(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yl(e)}function Yl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function mOe(e,t,r){pOe(e,t),t.set(e,r)}function pOe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gw(e,t,r){return t=oU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oU(e){var t=bOe(e,"string");return gu(t)==="symbol"?t:String(t)}function bOe(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZM(e,t){var r=iU(e,t,"get");return wOe(e,r)}function wOe(e,t){return t.get?t.get.call(e):t.value}function Yw(e,t,r){var n=iU(e,t,"set");return SOe(e,n,r),r}function iU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function SOe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Kw="collapsibleColumns",COe=290,_Oe=["nestedHeaders"],_l="collapsibleIndicator",QM=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Ol=new WeakMap,OOe=function(e){dOe(r,e);var t=vOe(r);function r(){var n;fOe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Gw(Yl(n),"nestedHeadersPlugin",null),Gw(Yl(n),"eventManager",new kt(Yl(n))),Gw(Yl(n),"headerStateManager",null),mOe(Yl(n),Ol,{writable:!0,value:null}),n}return cOe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Kw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||wt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Yw(this,Ol,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),ga(po(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}ga(po(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Yw(this,Ol,null),this.nestedHeadersPlugin=null,this.clearButtons(),ga(po(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};Ce(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;Ce(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(_l));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(_l)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(_l)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!QM.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Wr(o,function(p){var w=p.row;return w<0}),s=l.length>0;A(l,function(p){var w,S=p.row,C=p.col,k=(w=a.headerStateManager.getHeaderSettings(S,C))!==null&&w!==void 0?w:{},_=k.collapsible,D=k.isCollapsed;if(!_||D&&i==="collapse"||!D&&i==="expand")return s=!1,!1});var u=[],f=[];s&&A(l,function(p){var w=p.row,S=p.col,C=a.headerStateManager.triggerNodeModification(i,w,S),k=C.colspanCompensation,_=C.affectedColumns,D=C.rollbackModification;k>0&&(f.push.apply(f,qM(_)),u.push(D))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=PE([].concat(qM(c),f)):i==="expand"&&(h=Wr(c,function(p){return!f.includes(p)}));var d=QM.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){A(u,function(p){p()});return}this.hot.batchExecution(function(){A(f,function(p){ZM(a,Ol).setValueAtIndex(a.hot.toPhysicalColumn(p),d.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return ZM(this,Ol).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(_l));if(h)d||(d=this.hot.rootDocument.createElement("div"),te(d,_l),i.querySelector("div:first-child").appendChild(d)),Le(d,["collapsed","expanded"]),c?(te(d,"collapsed"),Ii(d,"+")):(te(d,"expanded"),Ii(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,_l)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),Sn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Yw(this,Ol,null),ga(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Kw}},{key:"PLUGIN_PRIORITY",get:function(){return COe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Kw].concat(_Oe)}}]),r}(ot),ROe=$e,EOe=Yt,TOe=tF,POe=zr,kOe=zn,$Oe=Tf;ROe({target:"Object",stat:!0,sham:!EOe},{getOwnPropertyDescriptors:function(t){for(var r=POe(t),n=kOe.f,o=TOe(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&$Oe(i,l,s);return i}});var JM=Yt,AOe=Ge,IOe=Zt,MOe=je,qw=iv,xOe=cv,DOe=uv,NOe=Ir,HOe=ev,Rl=Object.assign,ex=Object.defineProperty,LOe=AOe([].concat),jOe=!Rl||MOe(function(){if(JM&&Rl({b:1},Rl(ex({},"a",{enumerable:!0,get:function(){ex(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),Rl({},e)[r]!=7||qw(Rl({},t)).join("")!=n})?function(t,r){for(var n=NOe(t),o=arguments.length,i=1,a=xOe.f,l=DOe.f;o>i;)for(var s=HOe(arguments[i++]),u=a?LOe(qw(s),a(s)):qw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!JM||IOe(l,s,h))&&(n[h]=s[h]);return n}:Rl,FOe=$e,tx=jOe;FOe({target:"Object",stat:!0,arity:2,forced:Object.assign!==tx},{assign:tx});function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function rx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function BOe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rx(Object(r),!0).forEach(function(n){VOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VOe(e,t,r){return t=aU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nx(e,t){return GOe(e)||zOe(e,t)||UOe(e,t)||WOe()}function WOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UOe(e,t){if(e){if(typeof e=="string")return ox(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ox(e,t)}}function ox(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function GOe(e){if(Array.isArray(e))return e}function YOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aU(n.key),n)}}function KOe(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aU(e){var t=qOe(e,"string");return Fh(t)==="symbol"?t:String(t)}function qOe(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XOe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ZOe=!1,QOe=!0,JOe=!0,eRe=function(){function e(t,r){YOe(this,e),this.hot=t,this.sortingStates=new rb,this.sortEmptyCells=ZOe,this.indicator=QOe,this.headerAction=JOe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return KOe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ue(r)&&ze(r,function(o,i){XOe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=nx(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ue(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=nx(o,2),a=i[0],l=i[1];return BOe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ve(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Gm="asc",Ym="desc",tRe="colHeader";function rRe(e){if(Ue(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Gm,Ym].includes(r)}function nRe(e){if(e.some(function(r){return rRe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function ax(e){if(e!==Ym)return e===Gm?Ym:Gm}function lx(e){var t=e.querySelector(".".concat(tRe));return t}function sx(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function bO(e,t,r){return e===-1&&t>=0&&Ai(r)===!1}var oRe="ascending",iRe="descending",lU="indicatorDisabled",sU="columnSorting",uU="sortAction",fU=new Map([[Gm,oRe],[Ym,iRe]]);function aRe(e,t,r,n){var o=[sU];if(n&&o.push(uU),r===!1)return o.push(lU),o;var i=e.getSortOrderOfColumn(t);return ve(i)&&o.push(fU.get(i)),o}function lRe(){return Array.from(fU.values()).concat(uU,lU,sU)}function cU(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Vn:Xt(o)?Xt(i)?Vn:a&&e==="asc"?It:Mt:Xt(i)?a&&e==="asc"?Mt:It:isNaN(o)&&!isNaN(i)?e==="asc"?Mt:It:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?It:Mt:o>i?e==="asc"?Mt:It:Vn}}var hU="default";function sRe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Vn;if(l){if(Xt(n))return e==="asc"?It:Mt;if(Xt(o))return e==="asc"?Mt:It}return isNaN(i)?Mt:isNaN(a)?It:i<a?e==="asc"?It:Mt:i>a?e==="asc"?Mt:It:Vn}}var uRe="numeric";function fRe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=Xt(a),u=Xt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return Mt;if(s===!1&&u)return It}return h===!1&&d?e==="asc"?It:Mt:h&&d===!1?e==="asc"?Mt:It:h===!1&&d===!1?cU(e,t,r)(a,l):f===o&&c===n?e==="asc"?It:Mt:f===n&&c===o?e==="asc"?Mt:It:Vn}}var cRe="checkbox";function hRe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Vn;if(Xt(n))return Xt(o)?Vn:i&&e==="asc"?It:Mt;if(Xt(o))return i&&e==="asc"?Mt:It;var a=t.dateFormat,l=ee(n,a),s=ee(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?It:Mt:s.isBefore(l)?e==="asc"?Mt:It:Vn:It:Mt}}var dRe="date",TT=on("sorting.compareFunctionFactory"),nb=TT.register,ux=TT.getItem,vRe=TT.hasItem,dU=on("sorting.mainSortComparator"),vU=dU.register,yRe=dU.getItem;function yU(e){return vRe(e)?ux(e):ux(hU)}nb(uRe,sRe);nb(cRe,fRe);nb(dRe,hRe);nb(hU,cU);var Vn=0,It=-1,Mt=1;function gRe(e,t){for(var r=yRe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function fx(e){return wRe(e)||bRe(e)||pRe(e)||mRe()}function mRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pRe(e,t){if(e){if(typeof e=="string")return cx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cx(e,t)}}function cx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wRe(e){if(Array.isArray(e))return e}function SRe(e,t){return function(r,n){var o=fx(r),i=o.slice(1),a=fx(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:yU(c.type),p=y(f,c,v)(h,d);return p}(0)}}function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}var CRe=["column"],_Re=["column"];function El(e){return TRe(e)||ERe(e)||RRe(e)||ORe()}function ORe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RRe(e,t){if(e){if(typeof e=="string")return wO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wO(e,t)}}function ERe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TRe(e){if(Array.isArray(e))return wO(e)}function wO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hx(Object(r),!0).forEach(function(n){PRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PRe(e,t,r){return t=gU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vx(e,t){if(e==null)return{};var r=kRe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kRe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function $Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gU(n.key),n)}}function ARe(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gU(e){var t=IRe(e,"string");return mu(t)==="symbol"?t:String(t)}function IRe(e,t){if(mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=MRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function MRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function xRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SO(e,t)}function SO(e,t){return SO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},SO(e,t)}function DRe(e){var t=LRe();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return NRe(this,o)}}function NRe(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HRe(e)}function HRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var CO="columnSorting",jRe=50,gx="append",FRe="replace";vU(CO,SRe);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var mU=function(e){xRe(r,e);var t=DRe(r);function r(n){var o;return $Re(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=CO,o.indexesSequenceCache=null,o}return ARe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new eRe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new ji(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),ma(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=lx(s);sx(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,ma(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new q2),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ve(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return nRe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=vx(u,CRe);return dx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=We(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=vx(u,_Re);return dx({column:o.hot.toVisualColumn(f)},c)};return ve(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=We(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ve(i)){var a=ax(i);return ve(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:ax()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gx,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(bt(u))return[].concat(El(s.slice(0,a)),El(s.slice(a+1)));if(i===gx)return[].concat(El(s.slice(0,a)),El(s.slice(a+1)),[u]);if(i===FRe)return[].concat(El(s.slice(0,a)),[u],El(s.slice(a+1)))}return ve(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ue(o)){var i=o[this.pluginKey];if(Ue(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):pt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(p){return We(o,function(w){return i.hot.getDataAtCell(p,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=We(a,function(y){return y[0]});gRe(a,this.pluginKey,We(o,function(y){return y.sortOrder}),We(o,function(y){return i.getFirstCellSettings(y.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=We(a,function(y){return y[0]}),d=new Map(We(f,function(y,p){return[y,h[p]]})),v=We(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return d.has(y)?d.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ue(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ue(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ue(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=lx(i);if(!(sx(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(Le(o,lRe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];te(o,aRe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){ma(bo(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ve(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){bO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){bO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),ma(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return CO}},{key:"PLUGIN_PRIORITY",get:function(){return jRe}}]),r}(ot),BRe=$e,PT=Ge,VRe=Hi,WRe=wB,URe=nE,mx=je,zRe=RangeError,pU=String,bU=Math.floor,_O=PT(URe),px=PT("".slice),ic=PT(1 .toFixed),Ql=function(e,t,r){return t===0?r:t%2===1?Ql(e,t-1,r*e):Ql(e*e,t/2,r)},GRe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},Tl=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=bU(o/1e7)},Xw=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=bU(n/t),n=n%t*1e7},bx=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=pU(e[t]);r=r===""?n:r+_O("0",7-n.length)+n}return r},YRe=mx(function(){return ic(8e-5,3)!=="0.000"||ic(.9,0)!=="1"||ic(1.255,2)!=="1.25"||ic(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!mx(function(){ic({})});BRe({target:"Number",proto:!0,forced:YRe},{toFixed:function(t){var r=WRe(this),n=VRe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw zRe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return pU(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=GRe(r*Ql(2,69,1))-69,s=l<0?r*Ql(2,-l,1):r/Ql(2,l,1),s*=4503599627370496,l=52-l,l>0){for(Tl(o,0,s),u=n;u>=7;)Tl(o,1e7,0),u-=7;for(Tl(o,Ql(10,u,1),0),u=l-1;u>=23;)Xw(o,1<<23),u-=23;Xw(o,1<<u),Tl(o,1,1),Xw(o,2),a=bx(o)}else Tl(o,0,s),Tl(o,1<<-l,0),a=bx(o)+_O("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+_O("0",n-f)+a:px(a,0,f-n)+"."+px(a,f-n))):a=i+a,a}});function Bh(e){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}function KRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XRe(n.key),n)}}function qRe(e,t,r){return t&&wx(e.prototype,t),r&&wx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XRe(e){var t=ZRe(e,"string");return Bh(t)==="symbol"?t:String(t)}function ZRe(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QRe=function(){function e(t,r){KRe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return qRe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),A(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();A(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function y(){return l.hot.removeHook("beforeViewRender",y),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;A(h,function(y){f==="row"&&y.destinationRow>=v&&(y.alterRowOffset=c*o),f==="col"&&y.destinationColumn>=v&&(y.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?A(h,function(y){l.extendEndpointRanges(y,v,i[0],i.length),l.recreatePhysicalRanges(y),l.clearOffsetInformation(y)}):A(h,function(y){l.shiftEndpointCoordinates(y,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){A(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];A(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),A(a,function(l){var s=[];A(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,A(r.ranges,function(o){A(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],A(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],A(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],A(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&A(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),A(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){wt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const JRe=QRe;function Zw(e){return e==null||isNaN(e)}function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}var Sx;function e0e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function t0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n0e(n.key),n)}}function r0e(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n0e(e){var t=o0e(e,"string");return pu(t)==="symbol"?t:String(t)}function o0e(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $g(){return typeof Reflect<"u"&&Reflect.get?$g=Reflect.get.bind():$g=function(t,r,n){var o=i0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$g.apply(this,arguments)}function i0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function a0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OO(e,t)}function OO(e,t){return OO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},OO(e,t)}function l0e(e){var t=f0e();return function(){var n=bu(e),o;if(t){var i=bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return s0e(this,o)}}function s0e(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u0e(e)}function u0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var Qw="columnSummary",c0e=220,h0e=function(e){a0e(r,e);var t=l0e(r);function r(n){var o;return t0e(this,r),o=t.call(this,n),o.endpoints=null,o}return r0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Qw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[Qw],this.endpoints=new JRe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),$g(bu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return ze(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Zw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return ze(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Zw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Zw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return ze(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(dt(Sx||(Sx=e0e(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return Qw}},{key:"PLUGIN_PRIORITY",get:function(){return c0e}}]),r}(ot);function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}function d0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y0e(n.key),n)}}function v0e(e,t,r){return t&&_x(e.prototype,t),r&&_x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y0e(e){var t=g0e(e,"string");return Vh(t)==="symbol"?t:String(t)}function g0e(e,t){if(Vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m0e=function(){function e(t,r){d0e(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return v0e(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ht(this.getInputElement()),height:Pt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(r,e.CLASS_EDITOR),te(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const p0e=m0e;var qe="---------";function b0e(){return{name:qe}}function w0e(e){return We(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function Ry(e){return xe(e,"htSeparator")}function S0e(e){return xe(e,"htSubmenu")}function Ey(e){return xe(e,"htDisabled")}function Ty(e){return xe(e,"htSelectionDisabled")}function dl(e){var t=e.getSelected();return!t||t[0]<0?null:t}function C0e(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function _0e(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function qi(e,t){var r={};return A(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function ui(e,t,r,n,o){A(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&O0e(a,l,t,r,n,o)})})}function O0e(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=C0e(a.className,n):l=_0e(a.className,n)),i(e,t,"className",l)}function jn(e,t){var r=!1;return Array.isArray(e)&&A(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function lo(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function R0e(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function wU(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function E0e(e,t){var r=e.slice(0);return r.reverse(),r=wU(r,t),r.reverse(),r}function T0e(e){var t=[];return A(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function P0e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,r=e.slice(0);return r=wU(r,t),r=E0e(r,t),r=T0e(r),r}function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function k0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ox(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A0e(n.key),n)}}function $0e(e,t,r){return t&&Ox(e.prototype,t),r&&Ox(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A0e(e){var t=I0e(e,"string");return Wh(t)==="symbol"?t:String(t)}function I0e(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M0e=250,x0e=250,SU=function(){function e(t){k0e(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return $0e(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},x0e)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:M0e;this.showDebounced=UE(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();gt(SU,Mr);const D0e=SU;var CU="ContextMenu:items",Fe=CU,kT="".concat(Fe,".noItems"),$T="".concat(Fe,".insertRowAbove"),AT="".concat(Fe,".insertRowBelow"),IT="".concat(Fe,".insertColumnOnTheLeft"),MT="".concat(Fe,".insertColumnOnTheRight"),xT="".concat(Fe,".removeRow"),DT="".concat(Fe,".removeColumn"),NT="".concat(Fe,".undo"),HT="".concat(Fe,".redo"),LT="".concat(Fe,".readOnly"),jT="".concat(Fe,".clearColumn"),FT="".concat(Fe,".copy"),BT="".concat(Fe,".copyWithHeaders"),VT="".concat(Fe,".copyWithGroupHeaders"),WT="".concat(Fe,".copyHeadersOnly"),UT="".concat(Fe,".cut"),zT="".concat(Fe,".freezeColumn"),GT="".concat(Fe,".unfreezeColumn"),YT="".concat(Fe,".mergeCells"),KT="".concat(Fe,".unmergeCells"),qT="".concat(Fe,".addComment"),XT="".concat(Fe,".editComment"),ZT="".concat(Fe,".removeComment"),QT="".concat(Fe,".readOnlyComment"),JT="".concat(Fe,".align"),eP="".concat(Fe,".align.left"),tP="".concat(Fe,".align.center"),rP="".concat(Fe,".align.right"),nP="".concat(Fe,".align.justify"),oP="".concat(Fe,".align.top"),iP="".concat(Fe,".align.middle"),aP="".concat(Fe,".align.bottom"),lP="".concat(Fe,".borders"),sP="".concat(Fe,".borders.top"),uP="".concat(Fe,".borders.right"),fP="".concat(Fe,".borders.bottom"),cP="".concat(Fe,".borders.left"),hP="".concat(Fe,".borders.remove"),dP="".concat(Fe,".nestedHeaders.insertChildRow"),vP="".concat(Fe,".nestedHeaders.detachFromParent"),yP="".concat(Fe,".hideColumn"),gP="".concat(Fe,".showColumn"),mP="".concat(Fe,".hideRow"),pP="".concat(Fe,".showRow"),Or="Filters:",Ht="".concat(Or,"conditions"),ob="".concat(Ht,".none"),bP="".concat(Ht,".isEmpty"),wP="".concat(Ht,".isNotEmpty"),SP="".concat(Ht,".isEqualTo"),CP="".concat(Ht,".isNotEqualTo"),_P="".concat(Ht,".beginsWith"),OP="".concat(Ht,".endsWith"),RP="".concat(Ht,".contains"),EP="".concat(Ht,".doesNotContain"),N0e="".concat(Ht,".byValue"),TP="".concat(Ht,".greaterThan"),PP="".concat(Ht,".greaterThanOrEqualTo"),kP="".concat(Ht,".lessThan"),$P="".concat(Ht,".lessThanOrEqualTo"),AP="".concat(Ht,".isBetween"),IP="".concat(Ht,".isNotBetween"),MP="".concat(Ht,".after"),xP="".concat(Ht,".before"),DP="".concat(Ht,".today"),NP="".concat(Ht,".tomorrow"),HP="".concat(Ht,".yesterday"),LP="".concat(Or,"labels.filterByCondition"),jP="".concat(Or,"labels.filterByValue"),FP="".concat(Or,"labels.conjunction"),ib="".concat(Or,"labels.disjunction"),Km="".concat(Or,"values.blankCells"),BP="".concat(Or,"buttons.selectAll"),VP="".concat(Or,"buttons.clear"),WP="".concat(Or,"buttons.ok"),UP="".concat(Or,"buttons.cancel"),zP="".concat(Or,"buttons.placeholder.search"),GP="".concat(Or,"buttons.placeholder.value"),YP="".concat(Or,"buttons.placeholder.secondValue");const H0e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:qT,CONTEXTMENU_ITEMS_ALIGNMENT:JT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:aP,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:tP,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:nP,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:eP,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:iP,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:rP,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:oP,CONTEXTMENU_ITEMS_BORDERS:lP,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:fP,CONTEXTMENU_ITEMS_BORDERS_LEFT:cP,CONTEXTMENU_ITEMS_BORDERS_RIGHT:uP,CONTEXTMENU_ITEMS_BORDERS_TOP:sP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:jT,CONTEXTMENU_ITEMS_COPY:FT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:WT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:VT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:BT,CONTEXTMENU_ITEMS_CUT:UT,CONTEXTMENU_ITEMS_EDIT_COMMENT:XT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:zT,CONTEXTMENU_ITEMS_HIDE_COLUMN:yP,CONTEXTMENU_ITEMS_HIDE_ROW:mP,CONTEXTMENU_ITEMS_INSERT_LEFT:IT,CONTEXTMENU_ITEMS_INSERT_RIGHT:MT,CONTEXTMENU_ITEMS_MERGE_CELLS:YT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:vP,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:dP,CONTEXTMENU_ITEMS_NO_ITEMS:kT,CONTEXTMENU_ITEMS_READ_ONLY:LT,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:QT,CONTEXTMENU_ITEMS_REDO:HT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:hP,CONTEXTMENU_ITEMS_REMOVE_COLUMN:DT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:ZT,CONTEXTMENU_ITEMS_REMOVE_ROW:xT,CONTEXTMENU_ITEMS_ROW_ABOVE:$T,CONTEXTMENU_ITEMS_ROW_BELOW:AT,CONTEXTMENU_ITEMS_SHOW_COLUMN:gP,CONTEXTMENU_ITEMS_SHOW_ROW:pP,CONTEXTMENU_ITEMS_UNDO:NT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:GT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:KT,CONTEXT_MENU_ITEMS_NAMESPACE:CU,FILTERS_BUTTONS_CANCEL:UP,FILTERS_BUTTONS_CLEAR:VP,FILTERS_BUTTONS_OK:WP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:zP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:YP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:GP,FILTERS_BUTTONS_SELECT_ALL:BP,FILTERS_CONDITIONS_AFTER:MP,FILTERS_CONDITIONS_BEFORE:xP,FILTERS_CONDITIONS_BEGINS_WITH:_P,FILTERS_CONDITIONS_BETWEEN:AP,FILTERS_CONDITIONS_BY_VALUE:N0e,FILTERS_CONDITIONS_CONTAINS:RP,FILTERS_CONDITIONS_EMPTY:bP,FILTERS_CONDITIONS_ENDS_WITH:OP,FILTERS_CONDITIONS_EQUAL:SP,FILTERS_CONDITIONS_GREATER_THAN:TP,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:PP,FILTERS_CONDITIONS_LESS_THAN:kP,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:$P,FILTERS_CONDITIONS_NAMESPACE:Ht,FILTERS_CONDITIONS_NONE:ob,FILTERS_CONDITIONS_NOT_BETWEEN:IP,FILTERS_CONDITIONS_NOT_CONTAIN:EP,FILTERS_CONDITIONS_NOT_EMPTY:wP,FILTERS_CONDITIONS_NOT_EQUAL:CP,FILTERS_CONDITIONS_TODAY:DP,FILTERS_CONDITIONS_TOMORROW:NP,FILTERS_CONDITIONS_YESTERDAY:HP,FILTERS_DIVS_FILTER_BY_CONDITION:LP,FILTERS_DIVS_FILTER_BY_VALUE:jP,FILTERS_LABELS_CONJUNCTION:FP,FILTERS_LABELS_DISJUNCTION:ib,FILTERS_NAMESPACE:Or,FILTERS_VALUES_BLANK_CELLS:Km},Symbol.toStringTag,{value:"Module"}));function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function Jw(e,t,r){return t=_U(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_U(n.key),n)}}function j0e(e,t,r){return t&&Rx(e.prototype,t),r&&Rx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _U(e){var t=F0e(e,"string");return wu(t)==="symbol"?t:String(t)}function F0e(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=B0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function B0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function V0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RO(e,t)}function RO(e,t){return RO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RO(e,t)}function W0e(e){var t=z0e();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return U0e(this,o)}}function U0e(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OU(e)}function OU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}var eS="comments",G0e=60,Py=new WeakMap,$n="comment",Pl="value",Ex="style",ky="readOnly",Y0e=function(e){V0e(r,e);var t=W0e(r);function r(n){var o;return L0e(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,Py.set(OU(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return j0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[eS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new p0e(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new kt(this)),this.displaySwitch||(this.displaySwitch=new D0e(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),pa(wo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pa(wo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){pa(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=pi(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&pi(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,Jw({},Pl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,$n),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,Pl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,Pl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[$n]?l[$n][Pl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),y=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var p=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,k=S.view._wt,_=k.wtTable,D=k.getCell({row:d,col:v},!0),V=this.getCommentMeta(c,h,Ex);V?this.editor.setSize(V.width,V.height):this.editor.resetSize();var X=w?0:_.getStretchedColumnWidth(v),G=y&&!p?Pt(D):0,q=D.getBoundingClientRect(),Q=q.left,ne=q.top,J=q.width,ue=q.height,he=this.editor.getSize(),Oe=he.width,we=he.height,$=this.hot.rootWindow,P=$.innerWidth,g=$.innerHeight,m=this.hot.rootDocument.documentElement,b=Q+C.scrollX+X,E=ne+C.scrollY+G;this.hot.isRtl()&&(b-=Oe+X),this.hot.isLtr()&&Q+J+Oe>P?b=Q+C.scrollX-Oe-1:this.hot.isRtl()&&b<-(m.scrollWidth-m.clientWidth)&&(b=Q+C.scrollX+X+1),ne+we>g&&(E-=we-ue+1),this.editor.setPosition(b,E),this.editor.setReadOnlyState(this.getCommentMeta(c,h,ky))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Pl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[$n],s;l?(s=fr(l),Tv(s,a)):s=a,this.hot.setCellMeta(o,i,$n,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[$n])return l[$n][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=pi(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=Py.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else bi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[$n]&&i[$n][Pl]&&te(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=Py.get(this);i.tempEditorDimensions={width:ht(o.target),height:Pt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=Py.get(this),a=ht(o.target),l=Pt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Jw({},Ex,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,ky);o.updateCommentMeta(a,l,Jw({},ky,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(XT):i.hot.getTranslatedPhrase(qT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(ZT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(QT),f=jn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[$n];if(d&&(d=d[ky]),d)return!0});return f&&(u=lo(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[eS];if(Ue(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),pa(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return eS}},{key:"PLUGIN_PRIORITY",get:function(){return G0e}}]),r}(ot);function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function K0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X0e(n.key),n)}}function q0e(e,t,r){return t&&Tx(e.prototype,t),r&&Tx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X0e(e){var t=Z0e(e,"string");return Uh(t)==="symbol"?t:String(t)}function Z0e(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q0e=function(){function e(t){K0e(this,e),this.hot=t,this.commands={},this.commonCallback=null}return q0e(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=J0e(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!xt(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),A(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function J0e(e,t){var r;return A(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const RU=Q0e;var Xr="alignment";function eEe(){return{key:Xr,name:function(){return this.getTranslatedPhrase(JT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Xr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(eP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=qi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),ui(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(tP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=qi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),ui(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(rP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=qi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),ui(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(nP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=qi(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),ui(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:qe},{key:"".concat(Xr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(oP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=qi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),ui(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(iP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=qi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),ui(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(aP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=qi(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),ui(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var ab="clear_column";function tEe(){return{key:ab,name:function(){return this.getTranslatedPhrase(jT)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=dl(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var jv="col_left";function rEe(){return{key:jv,name:function(){return this.getTranslatedPhrase(IT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Fv="col_right";function nEe(){return{key:Fv,name:function(){return this.getTranslatedPhrase(MT)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Bv="make_read_only";function oEe(){return{key:Bv,name:function(){var t=this,r=this.getTranslatedPhrase(LT),n=jn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jn(r,function(o,i){return t.getCellMeta(o,i).readOnly});A(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var lb="redo";function iEe(){return{key:lb,name:function(){return this.getTranslatedPhrase(HT)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function EU(e,t){return uEe(e)||sEe(e,t)||lEe(e,t)||aEe()}function aEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lEe(e,t){if(e){if(typeof e=="string")return Px(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Px(e,t)}}function Px(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function uEe(e){if(Array.isArray(e))return e}function EO(e){"@babel/helpers - typeof";return EO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},EO(e)}var sb=0,ub=1,TU=2,KP=3,fEe=[KP,TU],cEe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],tS=Symbol("root"),kx=Symbol("child");function Su(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tS;if(t!==tS&&t!==kx)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===tS,o=sb;if(r){var i=e[0];if(e.length===0)o=ub;else if(n&&i instanceof cT)o=KP;else if(n&&Array.isArray(i))o=Su(i,kx);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!cEe[s].includes(EO(l))});a&&(o=TU)}}return o}function zh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!fEe.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===KP,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),bt(u)&&(u=l),bt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function hEe(e){var t=Su(e);if(t===sb||t===ub)return[];var r=zh(t),n=new Set;A(e,function(a){var l=r(a),s=EU(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function dEe(e){var t=Su(e);if(t===sb||t===ub)return[];var r=zh(t),n=new Set;A(e,function(a){var l=r(a),s=EU(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Qo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function vEe(e,t){return pEe(e)||mEe(e,t)||gEe(e,t)||yEe()}function yEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gEe(e,t){if(e){if(typeof e=="string")return $x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $x(e,t)}}function $x(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function pEe(e){if(Array.isArray(e))return e}var Vv="remove_col";function bEe(){return{key:Vv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=vEe(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(DT,r)},callback:function(){this.alter("remove_col",hEe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dl(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function wEe(e,t){return OEe(e)||_Ee(e,t)||CEe(e,t)||SEe()}function SEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CEe(e,t){if(e){if(typeof e=="string")return Ax(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ax(e,t)}}function Ax(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Ee(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function OEe(e){if(Array.isArray(e))return e}var fb="remove_row";function REe(){return{key:fb,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=wEe(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(xT,r)},callback:function(){this.alter("remove_row",dEe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=dl(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var cb="row_above";function EEe(){return{key:cb,name:function(){return this.getTranslatedPhrase($T)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=dl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var hb="row_below";function TEe(){return{key:hb,name:function(){return this.getTranslatedPhrase(AT)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=dl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Gh="no_items";function PEe(){return{key:Gh,name:function(){return this.getTranslatedPhrase(kT)},disabled:!0,isCommand:!1}}var db="undo";function kEe(){return{key:db,name:function(){return this.getTranslatedPhrase(NT)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}var yr;function xr(e,t,r){return t=$Ee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Ee(e){var t=AEe(e,"string");return Yh(t)==="symbol"?t:String(t)}function AEe(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IEe=[cb,hb,jv,Fv,ab,fb,Vv,db,lb,Bv,Xr,qe,Gh],MEe=(yr={},xr(yr,qe,b0e),xr(yr,Gh,PEe),xr(yr,cb,EEe),xr(yr,hb,TEe),xr(yr,jv,rEe),xr(yr,Fv,nEe),xr(yr,ab,tEe),xr(yr,fb,REe),xr(yr,Vv,bEe),xr(yr,db,kEe),xr(yr,lb,iEe),xr(yr,Bv,oEe),xr(yr,Xr,eEe),yr);function PU(){var e={};return ze(MEe,function(t,r){e[r]=t()}),e}function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function xEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NEe(n.key),n)}}function DEe(e,t,r){return t&&Ix(e.prototype,t),r&&Ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NEe(e){var t=HEe(e,"string");return Kh(t)==="symbol"?t:String(t)}function HEe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LEe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;xEe(this,e),this.hot=t,this.predefinedItems=PU(),this.defaultOrderPattern=r}return DEe(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,ze(r,function(i,a){var l="";i.name===qe?(o[qe]=i,l=qe):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return jEe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function jEe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ue(o)?ze(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ue(i)?zt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):A(o,function(i,a){var l=r[i];!l&&IEe.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ue(i)&&zt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const kU=LEe;function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function FEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VEe(n.key),n)}}function BEe(e,t,r){return t&&Mx(e.prototype,t),r&&Mx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VEe(e){var t=WEe(e,"string");return qh(t)==="symbol"?t:String(t)}function WEe(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UEe=function(){function e(t,r){FEe(this,e);var n=ws(r),o=Wa(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return BEe(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const zEe=UEe;var GEe=tl,YEe=/(?:ipad|iphone|ipod).*applewebkit/i.test(GEe),KEe=Un,$U=typeof process<"u"&&KEe(process)=="process",Vr=vt,qEe=sl,XEe=gv,xx=Rt,ZEe=Nt,AU=je,Dx=Wj,QEe=Sv,Nx=hp,JEe=EW,eTe=YEe,tTe=$U,TO=Vr.setImmediate,PO=Vr.clearImmediate,rTe=Vr.process,rS=Vr.Dispatch,nTe=Vr.Function,Hx=Vr.MessageChannel,oTe=Vr.String,nS=0,Bc={},Lx="onreadystatechange",Xh,Xi,oS,iS;AU(function(){Xh=Vr.location});var qP=function(e){if(ZEe(Bc,e)){var t=Bc[e];delete Bc[e],t()}},aS=function(e){return function(){qP(e)}},jx=function(e){qP(e.data)},Fx=function(e){Vr.postMessage(oTe(e),Xh.protocol+"//"+Xh.host)};(!TO||!PO)&&(TO=function(t){JEe(arguments.length,1);var r=xx(t)?t:nTe(t),n=QEe(arguments,1);return Bc[++nS]=function(){qEe(r,void 0,n)},Xi(nS),nS},PO=function(t){delete Bc[t]},tTe?Xi=function(e){rTe.nextTick(aS(e))}:rS&&rS.now?Xi=function(e){rS.now(aS(e))}:Hx&&!eTe?(oS=new Hx,iS=oS.port2,oS.port1.onmessage=jx,Xi=XEe(iS.postMessage,iS)):Vr.addEventListener&&xx(Vr.postMessage)&&!Vr.importScripts&&Xh&&Xh.protocol!=="file:"&&!AU(Fx)?(Xi=Fx,Vr.addEventListener("message",jx,!1)):Lx in Nx("script")?Xi=function(e){Dx.appendChild(Nx("script"))[Lx]=function(){Dx.removeChild(this),qP(e)}}:Xi=function(e){setTimeout(aS(e),0)});var IU={set:TO,clear:PO},iTe=$e,aTe=vt,Bx=IU.clear;iTe({global:!0,bind:!0,enumerable:!0,forced:aTe.clearImmediate!==Bx},{clearImmediate:Bx});var lTe=$e,MU=vt,Vx=IU.set,sTe=WE,Wx=MU.setImmediate?sTe(Vx,!1):Vx;lTe({global:!0,bind:!0,enumerable:!0,forced:MU.setImmediate!==Wx},{setImmediate:Wx});var uTe=$e,fTe=nE;uTe({target:"String",proto:!0},{repeat:fTe});var cTe=Zt,hTe=_p,dTe=jt,vTe=On,yTe=ol,lS=Kt,gTe=Ar,mTe=nl,pTe=U0,Ux=Op;hTe("match",function(e,t,r){return[function(o){var i=gTe(this),a=vTe(o)?void 0:mTe(o,e);return a?cTe(a,o,i):new RegExp(o)[e](lS(i))},function(n){var o=dTe(this),i=lS(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return Ux(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=Ux(o,i))!==null;){var c=lS(f[0]);s[u]=c,c===""&&(o.lastIndex=pTe(i,yTe(o.lastIndex),l)),u++}return u===0?null:s}]});var bTe=sl,wTe=zr,STe=Hi,CTe=en,_Te=kf,OTe=Math.min,kO=[].lastIndexOf,xU=!!kO&&1/[1].lastIndexOf(1,-0)<0,RTe=_Te("lastIndexOf"),ETe=xU||!RTe,TTe=ETe?function(t){if(xU)return bTe(kO,this,arguments)||0;var r=wTe(this),n=CTe(r),o=n-1;for(arguments.length>1&&(o=OTe(o,STe(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:kO,PTe=$e,zx=TTe;PTe({target:"Array",proto:!0,forced:zx!==[].lastIndexOf},{lastIndexOf:zx});var kTe=rl,$Te=Ir,ATe=ev,ITe=en,MTe=TypeError,Gx=function(e){return function(t,r,n,o){kTe(r);var i=$Te(t),a=ATe(i),l=ITe(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw MTe("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},xTe={left:Gx(!1),right:Gx(!0)},DTe=$e,NTe=xTe.left,HTe=kf,Yx=tv,LTe=$U,jTe=!LTe&&Yx>79&&Yx<83,FTe=jTe||!HTe("reduce");DTe({target:"Array",proto:!0,forced:FTe},{reduce:function(t){var r=arguments.length;return NTe(this,t,r,r>1?arguments[1]:void 0)}});function sS(e){return UTe(e)||WTe(e)||VTe(e)||BTe()}function BTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VTe(e,t){if(e){if(typeof e=="string")return $O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $O(e,t)}}function WTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UTe(e){if(Array.isArray(e))return $O(e)}function $O(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},zTe=new RegExp(Object.keys(DU).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function GTe(e){return(e&&e.nodeName||"")==="TABLE"}function AO(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],y=0;y<a;y+=1){var p=!d&&r&&y===0,w="";if(d)w="<th>".concat(e.getColHeader(y-f),"</th>");else if(p)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][y],C=e.getCellMeta(h-c,y-f),k=C.hidden,_=C.rowspan,D=C.colspan;if(!k){var V=[];if(_&&V.push('rowspan="'.concat(_,'"')),D&&V.push('colspan="'.concat(D,'"')),Xt(S))w="<td ".concat(V.join(" "),"></td>");else{var X=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(V.join(" "),">").concat(X,"</td>")}}}v.push(w)}var G=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,G):u.splice(-1,0,G)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function IO(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Xt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function NU(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(b){var E=b.match(/<td\b[^>]*?>/g)[0],R=b.substring(E.length,b.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),B="</td>";return"".concat(E).concat(R).concat(B)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!GTe(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(b,E){return b+E.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,y=0;if(i.tHead){var p=Array.from(i.tHead.rows).filter(function(b){var E=b.querySelector("td")!==null;return E&&h.push(b),!E});v=p.length,d=v>0,v>1?r.nestedHeaders=Array.from(p).reduce(function(b,E){var R=Array.from(E.cells).reduce(function(B,x,K){if(s&&K===0)return B;var Z=x.colSpan,re=x.innerHTML,ie=Z>1?{label:re,colspan:Z}:re;return B.push(ie),B},[]);return b.push(R),b},[]):d&&(r.colHeaders=Array.from(p[0].children).reduce(function(b,E,R){return s&&R===0||b.push(E.innerHTML),b},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,sS(Array.from(i.tBodies).reduce(function(b,E){return b.push.apply(b,sS(Array.from(E.rows))),b},[])),sS(c));y=w.length;for(var S=new Array(y),C=0;C<y;C++)S[C]=new Array(f);for(var k=[],_=[],D=0;D<y;D++)for(var V=w[D],X=Array.from(V.cells),G=X.length,q=0;q<G;q++){var Q=X[q],ne=Q.nodeName,J=Q.innerHTML,ue=Q.rowSpan,he=Q.colSpan,Oe=S[D].findIndex(function(b){return b===void 0});if(ne==="TD"){if(ue>1||he>1){for(var we=D;we<D+ue;we++)if(we<y)for(var $=Oe;$<Oe+he;$++)S[we][$]=null;var P=Q.getAttribute("style"),g=P&&P.includes("mso-ignore:colspan");g||k.push({col:Oe,row:D,rowspan:ue,colspan:he})}var m="";l&&/excel/gi.test(l.content)?m=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):m=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[D][Oe]=m.replace(zTe,function(b){return DU[b]})}else _.push(J)}return k.length&&(r.mergeCells=k),_.length&&(r.rowHeaders=_),S.length&&(r.data=S),r}}const YTe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:IO,htmlToGridSettings:NU,instanceToHTML:AO},Symbol.toStringTag,{value:"Module"}));function Kx(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function KTe(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var qTe=new Map([["mousedown",Kx],["mouseover",KTe],["touchstart",Kx]]);function qx(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;qTe.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Yp(e)||e.type==="touchstart",isRightClick:Ai(e)})}var HU=new WeakMap,XP=Symbol("rootInstance");function XTe(e){HU.set(e,!0)}function ZTe(e){return e===XP}function MO(e){return HU.has(e)}function Zh(e){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}function ac(e,t){return ePe(e)||JTe(e,t)||LU(e,t)||QTe()}function QTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ePe(e){if(Array.isArray(e))return e}function Xx(e){return nPe(e)||rPe(e)||LU(e)||tPe()}function tPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LU(e,t){if(e){if(typeof e=="string")return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}}function rPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nPe(e){if(Array.isArray(e))return xO(e)}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jU(n.key),n)}}function iPe(e,t,r){return t&&Zx(e.prototype,t),r&&Zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qx(e,t,r){aPe(e,t),t.set(e,r)}function aPe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jo(e,t,r){return t=jU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jU(e){var t=lPe(e,"string");return Zh(t)==="symbol"?t:String(t)}function lPe(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jx(e,t){var r=FU(e,t,"get");return sPe(e,r)}function sPe(e,t){return t.get?t.get.call(e):t.value}function eD(e,t,r){var n=FU(e,t,"set");return uPe(e,n,r),r}function FU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function uPe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Zi=new WeakMap,uS=new WeakMap,fS=new WeakMap,fPe=function(){function e(t){oPe(this,e),Jo(this,"instance",void 0),Jo(this,"eventManager",void 0),Jo(this,"settings",void 0),Jo(this,"THEAD",void 0),Jo(this,"TBODY",void 0),Jo(this,"_wt",void 0),Jo(this,"activeWt",void 0),Qx(this,uS,{writable:!0,value:0}),Qx(this,fS,{writable:!0,value:0}),Jo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new kt(this.instance),this.settings=this.instance.getSettings(),Zi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return iPe(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Zi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),te(o,"handsontable"),r.table=i.createElement("TABLE"),te(r.table,"htCore"),this.instance.getSettings().tableClassName&&te(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Zi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;l_(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&l_(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&Yp(u)&&l.finish(),n.mouseDown=!1,(Zp(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!Ai(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&Ai(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var y=Jt(a);if(a.elementFromPoint(c+y,h)!==v||a.elementFromPoint(c,h+y)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var p=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;p?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||rh(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,Xx(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Zi.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return MO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,Xx(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),eD(r,fS,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),eD(r,uS,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=ac(d,2),y=v[0],p=v[1],w=r.instance.runHooks("modifyGetCellCoords",y,p),S=y,C=p;if(Array.isArray(w)){var k=ac(w,2);S=k[0],C=k[1]}var _=r.instance.getCellMeta(S,C),D=r.instance.colToProp(C),V=r.instance.getDataAtRowProp(S,D);r.instance.hasHook("beforeValueRender")&&(V=r.instance.runHooks("beforeValueRender",V,_)),r.instance.runHooks("beforeRenderer",h,y,p,D,V,_),r.instance.getCellRenderer(_)(r.instance,h,y,p,D,V,_),r.instance.runHooks("afterRenderer",h,y,p,D,V,_)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,y),!sa(f)&&(qx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!sa(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!sa(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,y),!sa(f)&&(n.mouseDown&&qx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(sa(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),y=ac(v,2),p=y[0],w=y[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var k=(h??0)+1-C,_=S.peekByIndex(k);d=[_.from.row,_.from.col,_.to.row,_.to.col]}return r.instance.runHooks("afterDrawSelection",p,w,d,h)},onBeforeDrawBorders:function(f,c){var h=ac(f,4),d=h[0],v=h[1],y=h[2],p=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(y),r.instance.columnIndexMapper.getVisualFromRenderableIndex(p)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,y=c>=0?v.getVisualFromRenderableIndex(c):c,p=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",p,y,h);if(Array.isArray(w)){var S=ac(w,4),C=S[0],k=S[1],_=S[2],D=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,k>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(k,1)):k,_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,-1)):_,D>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(D,-1)):D]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var y=Math.ceil(v/h*12);f.startRow=Math.max(d-y,0),f.endRow=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var y=Math.ceil(v/h*6);f.startColumn=Math.max(d-y,0),f.endColumn=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new $be(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(rh(r))return!0;var n=bi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Zi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){_n(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(_n(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?fl(r,o(n,i)):(Ii(r,String.fromCharCode(160)),te(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Zi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Zi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Jx(this,uS)}},{key:"getRowHeadersCount",value:function(){return Jx(this,fS)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const cPe=fPe;function DO(e){"@babel/helpers - typeof";return DO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DO(e)}var BU="ABCDEFGHIJKLMNOPQRSTUVWXYZ",NO=BU.length;function vb(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%NO,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/NO,10);return r}function hPe(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(NO,n)*(BU.indexOf(e[r])+1);return t-=1,t}function dPe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(vb(o)+(n+1));r.push(i)}return r}function vPe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=vb(o)+(n+1);r.push(i)}return r}function yPe(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function HO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function ZP(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ue(e[0])&&(t=Gp(e[0]))),t}function VU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function WU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return DO(t)==="object"&&!Array.isArray(t)&&t!==null}))}const gPe=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:ZP,createEmptySpreadsheetData:yPe,createSpreadsheetData:dPe,createSpreadsheetObjectData:vPe,dataRowToChangesArray:HO,isArrayOfArrays:VU,isArrayOfObjects:WU,spreadsheetColumnIndex:hPe,spreadsheetColumnLabel:vb},Symbol.toStringTag,{value:"Module"}));function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}function mPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bPe(n.key),n)}}function pPe(e,t,r){return t&&tD(e.prototype,t),r&&tD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bPe(e){var t=wPe(e,"string");return Qh(t)==="symbol"?t:String(t)}function wPe(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SPe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];mPe(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return pPe(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return A(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):Ce(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ue(s)||pt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;Ce(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):yg(u,d,v)}})}else ze(s,function(h,d){yg(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=Va(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:yg(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=KV(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=Va(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Ce(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return ZP(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const CPe=SPe;var rD;function _Pe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function OPe(e,t){return ze(t,function(r,n){bt(e[n])&&(e[n]=r)}),e}function UU(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function zU(e){ve(e)&&VE(dt(rD||(rD=_Pe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function RPe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var GU=on("phraseFormatters"),EPe=GU.register,TPe=GU.getValues;function PPe(e,t){EPe(e,t)}function kPe(){return TPe()}PPe("pluralize",RPe);function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var fe;function ce(e,t,r){return t=$Pe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Pe(e){var t=APe(e,"string");return Jh(t)==="symbol"?t:String(t)}function APe(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IPe=(fe={languageCode:"en-US"},ce(fe,kT,"No available options"),ce(fe,$T,"Insert row above"),ce(fe,AT,"Insert row below"),ce(fe,IT,"Insert column left"),ce(fe,MT,"Insert column right"),ce(fe,xT,["Remove row","Remove rows"]),ce(fe,DT,["Remove column","Remove columns"]),ce(fe,NT,"Undo"),ce(fe,HT,"Redo"),ce(fe,LT,"Read only"),ce(fe,jT,"Clear column"),ce(fe,JT,"Alignment"),ce(fe,eP,"Left"),ce(fe,tP,"Center"),ce(fe,rP,"Right"),ce(fe,nP,"Justify"),ce(fe,oP,"Top"),ce(fe,iP,"Middle"),ce(fe,aP,"Bottom"),ce(fe,zT,"Freeze column"),ce(fe,GT,"Unfreeze column"),ce(fe,lP,"Borders"),ce(fe,sP,"Top"),ce(fe,uP,"Right"),ce(fe,fP,"Bottom"),ce(fe,cP,"Left"),ce(fe,hP,"Remove border(s)"),ce(fe,qT,"Add comment"),ce(fe,XT,"Edit comment"),ce(fe,ZT,"Delete comment"),ce(fe,QT,"Read-only comment"),ce(fe,YT,"Merge cells"),ce(fe,KT,"Unmerge cells"),ce(fe,FT,"Copy"),ce(fe,BT,["Copy with header","Copy with headers"]),ce(fe,VT,["Copy with group header","Copy with group headers"]),ce(fe,WT,["Copy header only","Copy headers only"]),ce(fe,UT,"Cut"),ce(fe,dP,"Insert child row"),ce(fe,vP,"Detach from parent"),ce(fe,yP,["Hide column","Hide columns"]),ce(fe,gP,["Show column","Show columns"]),ce(fe,mP,["Hide row","Hide rows"]),ce(fe,pP,["Show row","Show rows"]),ce(fe,ob,"None"),ce(fe,bP,"Is empty"),ce(fe,wP,"Is not empty"),ce(fe,SP,"Is equal to"),ce(fe,CP,"Is not equal to"),ce(fe,_P,"Begins with"),ce(fe,OP,"Ends with"),ce(fe,RP,"Contains"),ce(fe,EP,"Does not contain"),ce(fe,TP,"Greater than"),ce(fe,PP,"Greater than or equal to"),ce(fe,kP,"Less than"),ce(fe,$P,"Less than or equal to"),ce(fe,AP,"Is between"),ce(fe,IP,"Is not between"),ce(fe,MP,"After"),ce(fe,xP,"Before"),ce(fe,DP,"Today"),ce(fe,NP,"Tomorrow"),ce(fe,HP,"Yesterday"),ce(fe,Km,"Blank cells"),ce(fe,LP,"Filter by condition"),ce(fe,jP,"Filter by value"),ce(fe,FP,"And"),ce(fe,ib,"Or"),ce(fe,BP,"Select all"),ce(fe,VP,"Clear"),ce(fe,WP,"OK"),ce(fe,UP,"Cancel"),ce(fe,zP,"Search"),ce(fe,GP,"Value"),ce(fe,YP,"Second value"),fe);const YU=IPe;var LO=YU.languageCode,yb=on("languagesDictionaries"),MPe=yb.register,KU=yb.getItem,xPe=yb.hasItem,DPe=yb.getValues;qU(YU);function qU(e,t){var r=e,n=t;return Ue(e)&&(n=e,r=n.languageCode),NPe(r,n),MPe(r,fr(n)),fr(n)}function NPe(e,t){e!==LO&&OPe(t,KU(LO))}function XU(e){return QP(e)?fr(KU(e)):null}function QP(e){return xPe(e)}function HPe(){return DPe()}function ZU(e,t,r){var n=XU(e);if(n===null)return null;var o=n[t];if(bt(o))return null;var i=LPe(o,r);return Array.isArray(i)?i[0]:i}function LPe(e,t){var r=e;return A(kPe(),function(n){r=n(e,t)}),r}function jPe(e){var t=UU(e);return QP(t)||(t=LO,zU(e)),t}var gb="active-header",mb="area",ed="cell",JP="fill",Wv="header",ek="custom-selection";function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function FPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JU(n.key),n)}}function BPe(e,t,r){return t&&nD(e.prototype,t),r&&nD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ag(){return typeof Reflect<"u"&&Reflect.get?Ag=Reflect.get.bind():Ag=function(t,r,n){var o=VPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ag.apply(this,arguments)}function VPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_u(e),e!==null););return e}function WPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jO(e,t)}function jO(e,t){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jO(e,t)}function UPe(e){var t=GPe();return function(){var n=_u(e),o;if(t){var i=_u(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zPe(this,o)}}function zPe(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QU(e)}function QU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _u(e){return _u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_u(e)}function YPe(e,t,r){return t=JU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JU(e){var t=KPe(e,"string");return Cu(t)==="symbol"?t:String(t)}function KPe(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qPe=function(e){WPe(r,e);var t=UPe(r);function r(n,o){var i;return FPe(this,r),i=t.call(this,n,null),YPe(QU(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return BPe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,Ag(_u(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(lwe);const Hf=qPe;function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}var XPe=["activeHeaderClassName"];function oD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function iD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oD(Object(r),!0).forEach(function(n){ZPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZPe(e,t,r){return t=QPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QPe(e){var t=JPe(e,"string");return td(t)==="symbol"?t:String(t)}function JPe(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eke(e,t){if(e==null)return{};var r=tke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function rke(e){var t=e.activeHeaderClassName,r=eke(e,XPe),n=new Hf(iD(iD({highlightHeaderClassName:t},r),{},{selectionType:gb}));return n}function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}var nke=["layerLevel","areaCornerVisible"];function aD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aD(Object(r),!0).forEach(function(n){oke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oke(e,t,r){return t=ike(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ike(e){var t=ake(e,"string");return rd(t)==="symbol"?t:String(t)}function ake(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lke(e,t){if(e==null)return{};var r=ske(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ske(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function uke(e){var t=e.layerLevel,r=e.areaCornerVisible,n=lke(e,nke),o=new Hf(lD(lD({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:mb}));return o}function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}var fke=["cellCornerVisible"];function sD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sD(Object(r),!0).forEach(function(n){cke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cke(e,t,r){return t=hke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hke(e){var t=dke(e,"string");return nd(t)==="symbol"?t:String(t)}function dke(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vke(e,t){if(e==null)return{};var r=yke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function gke(e){var t=e.cellCornerVisible,r=vke(e,fke),n=new Hf(uD(uD({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:ed}));return n}function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}var mke=["border","visualCellRange"];function fD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fD(Object(r),!0).forEach(function(n){pke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pke(e,t,r){return t=bke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bke(e){var t=wke(e,"string");return od(t)==="symbol"?t:String(t)}function wke(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ske(e,t){if(e==null)return{};var r=Cke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function _ke(e){var t=e.border,r=e.visualCellRange,n=Ske(e,mke),o=new Hf(cS(cS(cS({},t),n),{},{selectionType:ek}),r);return o}function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function cD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function hD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cD(Object(r),!0).forEach(function(n){Oke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oke(e,t,r){return t=Rke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rke(e){var t=Eke(e,"string");return id(t)==="symbol"?t:String(t)}function Eke(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tke(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function Pke(e){var t=Object.assign({},(Tke(e),e)),r=new Hf(hD(hD({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:JP}));return r}function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}var kke=["headerClassName","rowClassName","columnClassName"];function dD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function vD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dD(Object(r),!0).forEach(function(n){$ke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $ke(e,t,r){return t=Ake(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ake(e){var t=Ike(e,"string");return ad(t)==="symbol"?t:String(t)}function Ike(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mke(e,t){if(e==null)return{};var r=xke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Dke(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=Mke(e,kke),i=new Hf(vD(vD({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:Wv}));return i}function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function yD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Nke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yD(Object(r),!0).forEach(function(n){Hke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hke(e,t,r){return t=Lke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lke(e){var t=jke(e,"string");return ld(t)==="symbol"?t:String(t)}function jke(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ez=on("highlight/types"),Lf=ez.register,Fke=ez.getItem;Lf(gb,rke);Lf(mb,uke);Lf(ed,gke);Lf(ek,_ke);Lf(JP,Pke);Lf(Wv,Dke);function kl(e,t){return Fke(e)(Nke({type:e},t))}function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function ei(e){return Uke(e)||Wke(e)||Vke(e)||Bke()}function Bke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vke(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function Wke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uke(e){if(Array.isArray(e))return FO(e)}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gD(Object(r),!0).forEach(function(n){zke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zke(e,t,r){return t=tz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tz(n.key),n)}}function Yke(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tz(e){var t=Kke(e,"string");return sd(t)==="symbol"?t:String(t)}function Kke(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qke=function(e){function t(r){Gke(this,t),this.options=r,this.layerLevel=0,this.cell=kl(ed,r),this.fill=kl(JP,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Yke(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===ed&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=kl(mb,lc({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return ei(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=kl(Wv,lc({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return ei(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=kl(gb,lc({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return ei(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return ei(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(kl(ek,lc(lc({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),A(this.areas.values(),function(n){return void n.clear()}),A(this.headers.values(),function(n){return void n.clear()}),A(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(ei(this.areas.values()),ei(this.headers.values()),ei(this.activeHeaders.values()),ei(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Xke=qke;function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function Zke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jke(n.key),n)}}function Qke(e,t,r){return t&&pD(e.prototype,t),r&&pD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jke(e){var t=e$e(e,"string");return ud(t)==="symbol"?t:String(t)}function e$e(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t$e=function(e){function t(r){Zke(this,t),this.ranges=[],this.createCellRange=r}return Qke(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const r$e=t$e;function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function n$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i$e(n.key),n)}}function o$e(e,t,r){return t&&bD(e.prototype,t),r&&bD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i$e(e){var t=a$e(e,"string");return fd(t)==="symbol"?t:String(t)}function a$e(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rz=function(){function e(t,r){n$e(this,e),this.range=t,this.options=r}return o$e(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),y=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&p>0&&!(y&&s>=d-y-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var k=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,k.row<0?(c=-1,k.row=0):k.row>0&&k.row>=d&&(c=1,k.row=d-1),k.col<0?(h=-1,k.col=0):k.col>0&&k.col>=v&&(h=1,k.col=v-1),f=this.options.renderableToVisualCoords(k)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),y=v.row,p=v.col,w=this.options.createCellCoords(y+o.row,p+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();gt(rz,Mr);const l$e=rz;function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}var wD;function SD(e,t){return c$e(e)||f$e(e,t)||u$e(e,t)||s$e()}function s$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u$e(e,t){if(e){if(typeof e=="string")return CD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CD(e,t)}}function CD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function c$e(e){if(Array.isArray(e))return e}function h$e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function d$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y$e(n.key),n)}}function v$e(e,t,r){return t&&_D(e.prototype,t),r&&_D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y$e(e){var t=g$e(e,"string");return cd(t)==="symbol"?t:String(t)}function g$e(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nz=function(){function e(t,r){var n=this;d$e(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new r$e(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new Xke({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new l$e(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return v$e(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=bt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&bt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(ed,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(A(this.highlight.getAreas(),function(y){return void y.clear()}),A(this.highlight.getHeaders(),function(y){return void y.clear()}),A(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(mb,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Wv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Va(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=Su(r);if(o===ub)return!1;if(o===sb)throw new Error(dt(wD||(wD=h$e([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=zh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=SD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],p=Qo(h,a)&&Qo(d,l)&&Qo(v,a)&&Qo(y,l);return!p});return s&&(this.clear(),A(r,function(u){var f=i(u),c=SD(f,4),h=c[0],d=c[1],v=c[2],y=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,y)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Qo(i,l)&&Qo(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Qo(r,i)&&Qo(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();gt(nz,Mr);const m$e=nz;var p$e=$e,oz=yv,b$e=zn.f,w$e=ol,OD=Kt,S$e=RE,C$e=Ar,_$e=EE,RD=oz("".startsWith),O$e=oz("".slice),R$e=Math.min,iz=_$e("startsWith"),E$e=!iz&&!!function(){var e=b$e(String.prototype,"startsWith");return e&&!e.writable}();p$e({target:"String",proto:!0,forced:!E$e&&!iz},{startsWith:function(t){var r=OD(C$e(this));S$e(t);var n=w$e(R$e(arguments.length>1?arguments[1]:void 0,r.length)),o=OD(t);return RD?RD(r,o,n):O$e(r,n,n+o.length)===o}});var ED=/^(\r\n|\n\r|\r|\n)/,T$e=/^[^\t\r\n]+/,TD=/^\t/;function P$e(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(TD))e=e.replace(TD,""),r+=1,t[n][r]="";else if(e.match(ED))e=e.replace(ED,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(T$e);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function Vc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function hS(e){return I$e(e)||A$e(e)||$$e(e)||k$e()}function k$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $$e(e,t){if(e){if(typeof e=="string")return BO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(e,t)}}function A$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function I$e(e){if(Array.isArray(e))return BO(e)}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function M$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D$e(n.key),n)}}function x$e(e,t,r){return t&&PD(e.prototype,t),r&&PD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D$e(e){var t=N$e(e,"string");return Ou(t)==="symbol"?t:String(t)}function N$e(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H$e=function(){function e(t,r,n){M$e(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return x$e(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=Gp(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ue(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return ZP(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Ou(r)==="object"&&!Array.isArray(r)&&ze(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ve(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ve(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ms(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,y=this.getSchema().length,p=[],w=function(){var k=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?k=fr(n.getSchema()):(k=[],Ce(y-1,function(){return k.push(null)})):n.instance.dataType==="function"?k=n.tableMeta.dataSchema(h+c):(k={},Tv(k,n.getSchema())),p.push(k),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,p);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===p.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),y=this.instance.countCols(),p=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;p<n&&y<u;){if(typeof c!="number"||c>=y)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var k=0;k<v;k++)s[k].splice(w,0,null);p+=1,w+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,p),p>0&&(r==null?this.metaManager.createColumn(null,p):i!=="auto"&&this.metaManager.createColumn(S,n));var _=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",_,p,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ve(this.tableMeta.columns)||ve(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var y=0,p=this.instance.countSourceRows();y<p;y++)for(var w=0;w<f;w++)c[y].splice(l[w],1),y===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];zC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return BV(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];zC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(hS(this.dataSource.slice(0,r)),hS(o),hS(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&xt(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=Va(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=Va(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&xt(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return Vc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Vc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const L$e=H$e;function j$e(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!xt(t,e)}function pb(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?aT(t.type):t.type;if(e._automaticallyAssignedMetaProps&&ze(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ue(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};ze(n,function(i,a){if(j$e(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),zt(e,o)}}function F$e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}qo(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Ig(e){return Number.isInteger(e)&&e>=0}function Mg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function $y(e){return e==null}function VO(e){"@babel/helpers - typeof";return VO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VO(e)}const az=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),Xt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),Xt(o)===!1)return VO(o)==="object"?(i=this.getCellMeta(t,r),zp(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function kD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $D(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kD(Object(r),!0).forEach(function(n){B$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B$e(e,t,r){return t=sz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sz(n.key),n)}}function lz(e,t,r){return t&&AD(e.prototype,t),r&&AD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sz(e){var t=V$e(e,"string");return hd(t)==="symbol"?t:String(t)}function V$e(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W$e(){return lz(function e(){uz(this,e)})}var U$e=function(){function e(t){uz(this,e),this.metaCtor=W$e(),this.meta=this.metaCtor.prototype,zt(this.meta,az()),this.meta.instance=t}return lz(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;zt(this.meta,r),pb(this.meta,$D($D({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function z$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ID(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y$e(n.key),n)}}function G$e(e,t,r){return t&&ID(e.prototype,t),r&&ID(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y$e(e){var t=K$e(e,"string");return dd(t)==="symbol"?t:String(t)}function K$e(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q$e=function(){function e(t){z$e(this,e);var r=t.getMetaConstructor();this.meta=new r}return G$e(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){zt(this.meta,r),pb(this.meta,r,r)}}]),e}();function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function MD(e){return J$e(e)||Q$e(e)||Z$e(e)||X$e()}function X$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z$e(e,t){if(e){if(typeof e=="string")return WO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WO(e,t)}}function Q$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function J$e(e){if(Array.isArray(e))return WO(e)}function WO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r1e(n.key),n)}}function t1e(e,t,r){return t&&xD(e.prototype,t),r&&xD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r1e(e){var t=n1e(e,"string");return vd(t)==="symbol"?t:String(t)}function n1e(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UO=function(e){function t(r){e1e(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return t1e(t,[{key:"obtain",value:function(n){Mg(function(){return Ig(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Mg(function(){return Ig(n)||$y(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=$y(n)?this.index.length:n;this.index=[].concat(MD(this.index.slice(0,s)),i,MD(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Mg(function(){return Ig(n)||$y(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice($y(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Wr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function o1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a1e(n.key),n)}}function i1e(e,t,r){return t&&DD(e.prototype,t),r&&DD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a1e(e){var t=l1e(e,"string");return yd(t)==="symbol"?t:String(t)}function l1e(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s1e=["data","width"],u1e=function(){function e(t){var r=this;o1e(this,e),this.globalMeta=t,this.metas=new UO(function(){return r._createMeta()})}return i1e(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);zt(o,n),pb(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return F$e(this.globalMeta.getMetaConstructor(),s1e).prototype}}]),e}();function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function f1e(e){return v1e(e)||d1e(e)||h1e(e)||c1e()}function c1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h1e(e,t){if(e){if(typeof e=="string")return zO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zO(e,t)}}function d1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function v1e(e){if(Array.isArray(e))return zO(e)}function zO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ND(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m1e(n.key),n)}}function g1e(e,t,r){return t&&ND(e.prototype,t),r&&ND(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m1e(e){var t=p1e(e,"string");return gd(t)==="symbol"?t:String(t)}function p1e(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b1e=function(){function e(t){var r=this;y1e(this,e),this.columnMeta=t,this.metas=new UO(function(){return r._createRow()})}return g1e(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);zt(i,o),pb(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,f1e(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){Mg(function(){return Ig(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new UO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function w1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C1e(n.key),n)}}function S1e(e,t,r){return t&&HD(e.prototype,t),r&&HD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C1e(e){var t=_1e(e,"string");return md(t)==="symbol"?t:String(t)}function _1e(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fz=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];w1e(this,e),this.hot=t,this.globalMeta=new U$e(t),this.tableMeta=new q$e(this.globalMeta),this.columnMeta=new u1e(this.globalMeta),this.cellMeta=new b1e(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return S1e(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();gt(fz,Mr);function qm(e){"@babel/helpers - typeof";return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qm(e)}function LD(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=ur(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":pt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new L$e(o,e,u);if(t(d),qm(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var y,p=0,w=0;for(p=0,w=h.startRows;p<w;p++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)y=fr(v),e.push(y);else if(o.dataType==="array")y=fr(v[0]),e.push(y);else{y=[];for(var S=0,C=h.startCols;S<C;S++)y.push(null);e.push(y)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(qm(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function O1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E1e(n.key),n)}}function R1e(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E1e(e){var t=T1e(e,"string");return pd(t)==="symbol"?t:String(t)}function T1e(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P1e=function(){function e(t){var r=this;O1e(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ge.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return R1e(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=xt(r,"type")?r.type:null,c=pt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function k1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A1e(n.key),n)}}function $1e(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A1e(e){var t=I1e(e,"string");return bd(t)==="symbol"?t:String(t)}function I1e(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M1e=function(){function e(t){k1e(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return $1e(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),BD=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ay=function(t){return t.map(function(r){var n=r.toLowerCase();return BD.has(n)?BD.get(n):n}).sort().join("+")},x1e=function(t){return t.split("+")},VD=function(t){return t.toLowerCase()},WD;function D1e(e){return L1e(e)||H1e(e)||cz(e)||N1e()}function N1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function L1e(e){if(Array.isArray(e))return GO(e)}function j1e(e,t){return V1e(e)||B1e(e,t)||cz(e,t)||F1e()}function F1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cz(e,t){if(e){if(typeof e=="string")return GO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GO(e,t)}}function GO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function V1e(e){if(Array.isArray(e))return e}function W1e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var U1e=function(t){var r=eb({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,y=v===void 0?function(){return!0}:v,p=f.captureCtrl,w=p===void 0?!1:p,S=f.preventDefault,C=S===void 0?!0:S,k=f.stopPropagation,_=k===void 0?!1:k,D=f.relativeToGroup,V=f.position;if(bt(d))throw new Error("You need to define the shortcut's group.");if(pt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(dt(WD||(WD=W1e([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var X={callback:h,group:d,runOnlyIf:y,captureCtrl:w,preventDefault:C,stopPropagation:_};if(ve(D)){var G=[D,V];X.relativeToGroup=G[0],X.position=G[1]}c.forEach(function(q){var Q=Ay(q),ne=r.hasItem(Q);if(ne){var J=r.getItem(Q),ue=J.findIndex(function(he){return he.group===D});ue!==-1?V==="before"?ue-=1:ue+=1:ue=J.length,J.splice(ue,0,X)}else r.addItem(Q,[X])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){ze(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=Ay(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=j1e(h,2),v=d[0],y=d[1],p=y.filter(function(w){return w.group!==f});p.length===0?i(x1e(v)):(y.length=0,y.push.apply(y,D1e(p)))})},l=function(f){var c=Ay(f),h=r.getItem(c);return ve(h)?h.slice():[]},s=function(f){var c=Ay(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function z1e(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var G1e=["meta","alt","shift","control"],sc=z1e();function Y1e(e,t,r,n,o){var i=function(d){return G1e.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return d.altKey&&y.push("alt"),v&&(d.ctrlKey||d.metaKey)?y.push("control/meta"):(d.ctrlKey&&y.push("control"),d.metaKey&&y.push("meta")),d.shiftKey&&y.push("shift"),y},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||sa(d))){var y=VD(d.key),p=[];i(y)?sc.press(y):p=a(d);var w=[y].concat(p),S=o(d,w);!S&&(im()&&p.includes("meta")||!im()&&p.includes("control"))&&o(d,[y].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=VD(d.key);i(v)!==!1&&sc.release(v)}},u=function(){sc.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Jc(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Jc(d)};return{mount:f,unmount:c,isPressed:function(d){return sc.isPressed(d)},releasePressedKeys:function(){return sc.releaseAll()}}}var K1e=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=eb({errorIdExists:function(y){return'The "'.concat(y,'" context name is already registered.')}}),l="grid",s=function(y){var p=U1e(y);return a.addItem(y,p),p},u=function(){return l},f=function(y){return a.getItem(y)},c=function(y){l=y},h=!1,d=Y1e(r,n,o,i,function(v,y){var p=f(u()),w=!1;if(!p.hasShortcut(y))return w;for(var S=p.getShortcuts(y),C=0;C<S.length;C++){var k=S[C],_=k.callback,D=k.runOnlyIf,V=k.preventDefault,X=k.stopPropagation,G=k.captureCtrl;if(D(v)!==!1&&(h=G,w=_(v,y)===!1,h=!1,V&&v.preventDefault(),X&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}};function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(e)}function An(e,t){return Z1e(e)||X1e(e,t)||hz(e,t)||q1e()}function q1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Z1e(e){if(Array.isArray(e))return e}function $l(e){return eAe(e)||J1e(e)||hz(e)||Q1e()}function Q1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hz(e,t){if(e){if(typeof e=="string")return YO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YO(e,t)}}function J1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eAe(e){if(Array.isArray(e))return YO(e)}function YO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tAe="gridDefault",dS=null;function tk(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new kt(a),s,u,f,c,h=!0;ZTe(o)&&XTe(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=jPe(t.language);var y=new fz(a,t,[P1e,M1e]),p=y.getTableMeta(),w=y.getGlobalMeta(),S=eb();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),MO(this)&&zV(t.licenseKey,e),this.guid="ht_".concat(NE()),this.columnIndexMapper=new sO,this.rowIndexMapper=new sO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterRowSequenceChange",g)}),u=new CPe(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(m){var b=m.row,E=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,E>=0?a.columnIndexMapper.getRenderableFromVisualIndex(E):E)},k=function(m){var b=m.row,E=m.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,E>=0?a.columnIndexMapper.getVisualFromRenderableIndex(E):E)},_=new m$e(p,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(m){return s.propToCol(m)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(m,b){return a._createCellCoords(m,b)},createCellRange:function(m,b,E){return a._createCellRange(m,b,E)},visualToRenderableCoords:C,renderableToVisualCoords:k,isDisabledCellSelection:function(m,b){return a.getCellMeta(m,b).disableVisualSelection}});this.selection=_;var D=function(m){var b=m.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",D),this.rowIndexMapper.addLocalHook("cacheUpdated",D),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var m=Va(!1),b=n.selection.getSelectedRange(),E=b.current(),R=E.from,B=E.to,x=b.size()-1;n.runHooks("afterSelection",R.row,R.col,B.row,B.col,m,x),n.runHooks("afterSelectionByProp",R.row,a.colToProp(R.col),B.row,a.colToProp(B.col),m,x);var K=n.selection.isSelectedByAnyHeader(),Z=n.selection.selectedRange.current(),re=!0;i&&(re=!1),m.isTouched()&&(re=!m.value);var ie=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();re!==!1&&(K?ie?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):Z&&!n.selection.isMultiple()?n.view.scrollViewport(C(Z.from)):n.view.scrollViewport(C(g))),ie&&se?te(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ie?(Le(n.rootElement,"ht__selection--columns"),te(n.rootElement,"ht__selection--rows")):se?(Le(n.rootElement,"ht__selection--rows"),te(n.rootElement,"ht__selection--columns")):Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var m=g.length-1,b=g[m],E=b.from,R=b.to;n.runHooks("afterSelectionEnd",E.row,E.col,R.row,R.col,m),n.runHooks("afterSelectionEndByProp",E.row,a.colToProp(E.col),R.row,a.colToProp(R.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var m=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,m,b){n.runHooks("afterModifyTransformStart",g,m,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,m,b){n.runHooks("afterModifyTransformEnd",g,m,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),f={alter:function(m,b){var E,R,B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0,Z=function(Me){if(Me.length===0)return[];var De=$l(Me);De.sort(function(Bt,Ve){var et=An(Bt,1),Ct=et[0],ut=An(Ve,1),ct=ut[0];return Ct===ct?0:Ct>ct?1:-1});var dr=Ft(De,function(Bt,Ve){var et=An(Ve,2),Ct=et[0],ut=et[1],ct=Bt[Bt.length-1],tt=An(ct,2),Xo=tt[0],Cb=tt[1],Fi=Xo+Cb;if(Ct<=Fi){var jf=Math.max(ut-(Fi-Ct),0);ct[1]+=jf}else Bt.push([Ct,ut]);return Bt},[De[0]]);return dr};switch(m){case"insert_row_below":case"insert_row_above":var re=a.countSourceRows();if(p.maxRows===re)return;var ie=m==="insert_row_below"?"below":"above";b=(E=b)!==null&&E!==void 0?E:ie==="below"?re:0;var se=s.createRow(b,B,{source:x,mode:ie}),_e=se.delta,Se=se.startPhysicalIndex;if(_e){var z=_.selectedRange.current(),Ne=z==null?void 0:z.from,Be=Ne==null?void 0:Ne.row,ke=a.toVisualRow(Se);if(_.isSelectedByCorner())a.selectAll();else if(ve(Be)&&Be>=ke){var Ie=z.to,Ae=Ie.row,O=Ie.col,T=Ne.col;_.isSelectedByRowHeader()&&(T=-1),_.getSelectedRange().pop(),_.setRangeStartOnly(a._createCellCoords(Be+_e,T),!0),_.setRangeEnd(a._createCellCoords(Ae+_e,O))}else a._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var I=m==="insert_col_end"?"end":"start";b=(R=b)!==null&&R!==void 0?R:I==="end"?a.countSourceCols():0;var F=s.createCol(b,B,{source:x,mode:I}),M=F.delta,W=F.startPhysicalIndex;if(M){if(Array.isArray(p.colHeaders)){var H=[a.toVisualColumn(W),0];H.length+=M,Array.prototype.splice.apply(p.colHeaders,H)}var N=_.selectedRange.current(),U=N==null?void 0:N.from,j=U==null?void 0:U.col,Y=a.toVisualColumn(W);if(_.isSelectedByCorner())a.selectAll();else if(ve(j)&&j>=Y){var le=N.to,me=le.row,Re=le.col,He=U.row;_.isSelectedByColumnHeader()&&(He=-1),_.getSelectedRange().pop(),_.setRangeStartOnly(a._createCellCoords(He,j+M),!0),_.setRangeEnd(a._createCellCoords(me,Re+M))}else a._refreshBorders()}break;case"remove_row":var Ze=function(Me){var De=0;A(Me,function(dr){var Bt=An(dr,2),Ve=Bt[0],et=Bt[1],Ct=Xt(Ve)?a.countRows()-1:Math.max(Ve-De,0);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ut=s.removeRow(Ve,et,x);if(ut){var ct=a.countRows(),tt=p.fixedRowsTop;tt>=Ct+1&&(p.fixedRowsTop-=Math.min(et,tt-Ct));var Xo=p.fixedRowsBottom;Xo&&Ct>=ct-Xo&&(p.fixedRowsBottom-=Math.min(et,Xo)),De+=et}})};Array.isArray(b)?Ze(Z(b)):Ze([[b,B]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var st=function(Me){var De=0;A(Me,function(dr){var Bt=An(dr,2),Ve=Bt[0],et=Bt[1],Ct=Xt(Ve)?a.countCols()-1:Math.max(Ve-De,0),ut=a.toPhysicalColumn(Ct);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ct=s.removeCol(Ve,et,x);if(ct){var tt=p.fixedColumnsStart;tt>=Ct+1&&(p.fixedColumnsStart-=Math.min(et,tt-Ct)),Array.isArray(p.colHeaders)&&(typeof ut>"u"&&(ut=-1),p.colHeaders.splice(ut,et)),De+=et}})};Array.isArray(b)?st(Z(b)):st([[b,B]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(m,'"'))}K||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var m=p.minRows,b=p.minSpareRows,E=p.minCols,R=p.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&_.deselect(),m){var B=a.countRows();B<m&&s.createRow(B,m-B,{source:"auto"})}if(b){var x=a.countEmptyRows(!0);if(x<b){var K=b-x,Z=Math.min(K,p.maxRows-a.countSourceRows());s.createRow(a.countRows(),Z,{source:"auto"})}}{var re;(E||R)&&(re=a.countEmptyCols(!0));var ie=a.countCols();if(E&&!p.columns&&ie<E){var se=E-ie;re+=se,s.createCol(ie,se,{source:"auto"})}if(R&&!p.columns&&a.dataType==="array"&&re<R){ie=a.countCols();var _e=R-re,Se=Math.min(_e,p.maxCols-ie);s.createCol(ie,Se,{source:"auto"})}}if(_.isSelected()){var z=a.countRows(),Ne=a.countCols();A(_.selectedRange,function(Be){var ke=!1,Ie=Be.from.row,Ae=Be.from.col,O=Be.to.row,T=Be.to.col;Ie>z-1?(Ie=z-1,ke=!0,O>Ie&&(O=Ie)):O>z-1&&(O=z-1,ke=!0,Ie>O&&(Ie=O)),Ae>Ne-1?(Ae=Ne-1,ke=!0,T>Ae&&(T=Ae)):T>Ne-1&&(T=Ne-1,ke=!0,Ae>T&&(Ae=T)),ke&&a.selectCell(Ie,Ae,O,T)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(m,b,E,R,B){var x,K,Z,re,ie=[],se={},_e=[],Se=m.row,z=m.col;if(K=b.length,K===0)return!1;var Ne=0,Be=0;switch(Ue(E)&&(Ne=E.col-z+1,Be=E.row-Se+1),B){case"shift_down":var ke=Ac(b),Ie=ke.length,Ae=Math.max(Ie,Ne),O=a.getData().slice(Se),T=Ac(O).slice(z,z+Ae);for(Z=0;Z<Ae;Z+=1)if(Z<Ie){for(x=0,K=ke[Z].length;x<Be-K;x+=1)ke[Z].push(ke[Z][x%K]);Z<T.length?_e.push(ke[Z].concat(T[Z])):_e.push(ke[Z].concat(new Array(O.length).fill(null)))}else _e.push(ke[Z%Ie].concat(T[Z]));a.populateFromArray(Se,z,Ac(_e));break;case"shift_right":var I=b.length,F=Math.max(I,Be),M=a.getData().slice(Se).map(function(Ve){return Ve.slice(z)});for(x=0;x<F;x+=1)if(x<I){for(Z=0,re=b[x].length;Z<Ne-re;Z+=1)b[x].push(b[x][Z%re]);if(x<M.length)for(var W=0;W<M[x].length;W+=1)b[x].push(M[x][W]);else{var H;(H=b[x]).push.apply(H,$l(new Array(M[0].length).fill(null)))}}else b.push(b[x%K].slice(0,F).concat(M[x]));a.populateFromArray(Se,z,b);break;case"overwrite":default:se.row=m.row,se.col=m.col;var N=0,U=0,j=!0,Y,le=function(et){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ut=b[et%b.length];return Ct!==null?ut[Ct%ut.length]:ut},me=b.length,Re=E?E.row-m.row+1:0;for(E?K=Re:K=Math.max(me,Re),x=0;x<K&&!(E&&se.row>E.row&&Re>me||!p.allowInsertRow&&se.row>a.countRows()-1||se.row>=p.maxRows);x++){var He=x-N,Ze=le(He).length,st=E?E.col-m.col+1:0;if(E?re=st:re=Math.max(Ze,st),se.col=m.col,Y=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Y.skipRowOnPaste){N+=1,se.row+=1,K+=1;continue}for(U=0,Z=0;Z<re&&!(E&&se.col>E.col&&st>Ze||!p.allowInsertColumn&&se.col>a.countCols()-1||se.col>=p.maxCols);Z++){if(Y=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Y.skipColumnOnPaste){U+=1,se.col+=1,re+=1;continue}if(Y.readOnly&&R!=="UndoRedo.undo"){se.col+=1;continue}var Ye=Z-U,Me=le(He,Ye),De=a.getDataAtCell(se.row,se.col);if(Me!==null&&Er(Me)==="object")if(Array.isArray(Me)&&De===null&&(De=[]),De===null||Er(De)!=="object")j=!1;else{var dr=ms(Array.isArray(De)?De:De[0]||De),Bt=ms(Array.isArray(Me)?Me:Me[0]||Me);zp(dr,Bt)||Array.isArray(dr)&&Array.isArray(Bt)?Me=fr(Me):j=!1}else De!==null&&Er(De)==="object"&&(j=!1);j&&ie.push([se.row,se.col,Me]),j=!0,se.col+=1}se.row+=1}a.setDataAtCell(ie,null,null,R||"populateFromArray");break}}};function V(g){var m=UU(g);QP(m)?(a.runHooks("beforeLanguageChange",m),w.language=m,a.runHooks("afterLanguageChange",m)):zU(g)}function X(g,m){var b=g==="className"?a.rootElement:a.table;if(h)te(b,m);else{var E=[],R=[];w[g]&&(E=Array.isArray(w[g])?w[g]:YC(w[g])),m&&(R=Array.isArray(m)?m:YC(m));var B=GC(E,R),x=GC(R,E);B.length&&Le(b,B),x.length&&te(b,x)}w[g]=m}this.init=function(){u.setData(p.data),a.runHooks("beforeInit"),(pn()||AE())&&te(a.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new cPe(this),c=Ase.getInstance(a,p,_),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&RW(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Er(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function G(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function q(g){var m=g.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):g}function Q(g,m,b){if(g.length){var E=a.getActiveEditor(),R=new G,B=!0;R.onQueueEmpty=function(Se){E&&B&&E.cancelChanges(),b(Se)};for(var x=g.length-1;x>=0;x--){var K=An(g[x],4),Z=K[0],re=K[1],ie=K[3],se=s.propToCol(re),_e=a.getCellMeta(Z,se);_e.type==="numeric"&&typeof ie=="string"&&HW(ie)&&(g[x][3]=q(ie)),a.getCellValidator(_e)&&(R.addValidatorToQueue(),a.validateCell(g[x][3],_e,function(Se,z){return function(Ne){if(typeof Ne!="boolean")throw new Error("Validation error: result is not boolean");if(Ne===!1&&z.allowInvalid===!1){B=!1,g.splice(Se,1),z.valid=!0;var Be=a.getCell(z.visualRow,z.visualCol);Be!==null&&Le(Be,p.invalidCellClassName)}R.removeValidatorFormQueue()}}(x,_e),m))}R.checkIfQueueIsEmpty()}}function ne(g,m){var b=g.length-1;if(!(b<0)){for(;b>=0;b--){var E=!1;if(g[b]===null){g.splice(b,1);continue}if(!((g[b][2]===null||g[b][2]===void 0)&&(g[b][3]===null||g[b][3]===void 0))){if(p.allowInsertRow)for(;g[b][0]>a.countRows()-1;){var R=s.createRow(void 0,void 0,{source:m}),B=R.delta;if(B===0){E=!0;break}}if(a.dataType==="array"&&(!p.columns||p.columns.length===0)&&p.allowInsertColumn)for(;s.propToCol(g[b][1])>a.countCols()-1;){var x=s.createCol(void 0,void 0,{source:m}),K=x.delta;if(K===0){E=!0;break}}E||s.set(g[b][0],g[b][1],g[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,m),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,m||"edit");var Z=a.getActiveEditor();Z&&ve(Z.refreshValue)&&Z.refreshValue()}}this._createCellCoords=function(g,m){return a.view._wt.createCellCoords(g,m)},this._createCellRange=function(g,m,b){return a.view._wt.createCellRange(g,m,b)},this.validateCell=function(g,m,b,E){var R=a.getCellValidator(m);function B(x){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!K||m.hidden===!0){b(x);return}var Z=m.visualCol,re=m.visualRow,ie=a.getCell(re,Z,!0);if(ie&&ie.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(re),_e=a.columnIndexMapper.getRenderableFromVisualIndex(Z);a.view._wt.getSetting("cellRenderer",se,_e,ie)}b(x)}UV(R)&&(R=function(x){return function(K,Z){Z(x.test(K))}}(R)),pt(R)?(g=a.runHooks("beforeValidate",g,m.visualRow,m.prop,E),a._registerImmediate(function(){R.call(m,g,function(x){a&&(x=a.runHooks("afterValidate",x,g,m.visualRow,m.prop,E),m.valid=x,B(x),a.runHooks("postAfterValidate",x,g,m.visualRow,m.prop,E))})})):a._registerImmediate(function(){m.valid=!0,B(m.valid,!1)})};function J(g,m,b){return Array.isArray(g)?g:[[g,m,b]]}function ue(g,m){var b=a.getActiveEditor(),E=a.runHooks("beforeChange",g,m||"edit"),R=g.filter(function(B){return B!==null});return E===!1||R.length===0?(b&&b.cancelChanges(),[]):R}this.setDataAtCell=function(g,m,b,E){var R=J(g,m,b),B=[],x=E,K,Z,re;for(K=0,Z=R.length;K<Z;K++){if(Er(R[K])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[K][1]>=this.countCols()?re=R[K][1]:re=s.colToProp(R[K][1]),B.push([R[K][0],re,u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]])}!x&&Er(g)==="object"&&(x=m);var ie=ue(B,E);a.runHooks("afterSetDataAtCell",ie,x),Q(ie,x,function(){ne(ie,x)})},this.setDataAtRowProp=function(g,m,b,E){var R=J(g,m,b),B=[],x=E,K,Z;for(K=0,Z=R.length;K<Z;K++)B.push([R[K][0],R[K][1],u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]]);!x&&Er(g)==="object"&&(x=m);var re=ue(B,E);a.runHooks("afterSetDataAtRowProp",re,x),Q(re,x,function(){ne(re,x)})},this.listen=function(){a&&!a.isListening()&&(dS=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(dS=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return dS===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,m)},this.populateFromArray=function(g,m,b,E,R,B,x){if(!(Er(b)==="object"&&Er(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var K=typeof E=="number"?a._createCellCoords(E,R):null;return f.populateFromArray(a._createCellCoords(g,m),b,K,B,x)},this.spliceCol=function(g,m,b){for(var E,R=arguments.length,B=new Array(R>3?R-3:0),x=3;x<R;x++)B[x-3]=arguments[x];return(E=s).spliceCol.apply(E,[g,m,b].concat(B))},this.spliceRow=function(g,m,b){for(var E,R=arguments.length,B=new Array(R>3?R-3:0),x=3;x<R;x++)B[x-3]=arguments[x];return(E=s).spliceRow.apply(E,[g,m,b].concat(B))},this.getSelected=function(){if(_.isSelected())return We(_.getSelectedRange(),function(g){var m=g.from,b=g.to;return[m.row,m.col,b.row,b.col]})},this.getSelectedLast=function(){var g=this.getSelected(),m;return g&&g.length>0&&(m=g[g.length-1]),m},this.getSelectedRange=function(){if(_.isSelected())return Array.from(_.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),m;return g&&g.length>0&&(m=g[g.length-1]),m},this.emptySelectedCells=function(g){var m=this;if(!(!_.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];A(_.getSelectedRange(),function(E){var R=E.getTopStartCorner(),B=E.getBottomEndCorner();Ce(R.row,B.row,function(x){Ce(R.col,B.col,function(K){m.getCellMeta(x,K).readOnly||b.push([x,K,null])})})}),b.length>0&&this.setDataAtCell(b,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var m=g();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=g();return this.resumeExecution(m),b},this.batch=function(g){this.suspendRender(),this.suspendExecution();var m=g();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),m=g.width,b=g.height,E=a.rootElement.getBoundingClientRect(),R=E.width,B=E.height,x=R!==m||B!==b,K=a.runHooks("beforeRefreshDimensions",{width:m,height:b},{width:R,height:B},x)===!1;K||((x||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(R,B),a.render()),a.runHooks("afterRefreshDimensions",{width:m,height:b},{width:R,height:B},x))}},this.updateData=function(g,m){var b=this;LD(g,function(E){s=E},function(E){s=E,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:m,metaManager:y,firstRun:h})},this.loadData=function(g,m){LD(g,function(b){s=b},function(){y.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:m,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var g=p.columns,m=0;if(Array.isArray(g))m=g.length;else if(pt(g))if(a.dataType==="array")for(var b=this.countSourceCols(),E=0;E<b;E+=1)g(E)&&(m+=1);else(a.dataType==="object"||a.dataType==="function")&&(m=s.colToPropCache.length);else if(ve(p.dataSchema)){var R=s.getSchema();m=Array.isArray(R)?R.length:Gp(R)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,m,b,E){return bt(g)?s.getAll():s.getRange(a._createCellCoords(g,m),a._createCellCoords(b,E),s.DESTINATION_RENDERER)},this.getCopyableText=function(g,m,b,E){return s.getCopyableText(a._createCellCoords(g,m),a._createCellCoords(b,E))},this.getCopyableData=function(g,m){return s.getCopyable(g,s.colToProp(m))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),E=!1,R,B;if(ve(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ve(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ve(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in g)R==="data"||(R==="language"?V(g.language):R==="className"?X("className",g.className):R==="tableClassName"&&a.table?(X("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(R)||ge.getSingleton().isDeprecated(R)?(pt(g[R])||Array.isArray(g[R]))&&(g[R].initialHook=!0,a.addHook(R,g[R])):!m&&xt(g,R)&&(w[R]=g[R]));g.data===void 0&&p.data===void 0?b(null,"updateSettings"):g.data!==void 0?b(g.data,"updateSettings"):g.columns!==void 0&&(s.createMap(),a.initIndexMappers());var x=a.countCols(),K=p.columns;if(K&&pt(K)&&(E=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),x>0)for(R=0,B=0;R<x;R++){if(K){var Z=E?K(R):K[B];Z&&y.updateColumnMeta(B,Z)}B+=1}ve(g.cell)&&ze(g.cell,function(z){a.setCellMetaObject(z.row,z.col,z)}),a.runHooks("afterCellMetaReset");var re=a.rootElement.style.height;re!==""&&(re=parseInt(a.rootElement.style.height,10));var ie=g.height;if(pt(ie)&&(ie=ie()),m){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ie===null){var _e=a.rootElement.getAttribute("data-initialstyle");_e&&(_e.indexOf("height")>-1||_e.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",_e):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ie!==void 0&&(a.rootElement.style.height=isNaN(ie)?"".concat(ie):"".concat(ie,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var Se=g.width;pt(Se)&&(Se=Se()),a.rootElement.style.width=isNaN(Se)?"".concat(Se):"".concat(Se,"px")}m||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!m&&a.view&&(re===""||ie===""||ie===void 0)&&re!==ie&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(p.getValue){if(pt(p.getValue))return p.getValue.call(a);if(g)return a.getData()[g[0][0]][p.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return p},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,m,b,E,R){f.alter(g,m,b,E,R)},this.getCell=function(g,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=m,R=g;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return R===null||E===null?null:a.view.getCellAtCoords(a._createCellCoords(R,E),b)},this.getCoords=function(g){var m=this.view._wt.wtTable.getCoords(g);if(m===null)return null;var b=m.row,E=m.col,R=b,B=E;return b>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(b)),E>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(E)),a._createCellCoords(R,B)},this.colToProp=function(g){return s.colToProp(g)},this.propToCol=function(g){return s.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,m){return s.get(g,s.colToProp(m))},this.getDataAtRowProp=function(g,m){return s.get(g,m)},this.getDataAtCol=function(g){for(var m=[],b=s.getRange(a._createCellCoords(0,g),a._createCellCoords(p.data.length-1,g),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var R=0;R<b[E].length;R+=1)m.push(b[E][R]);return m},this.getDataAtProp=function(g){for(var m=[],b=s.getRange(a._createCellCoords(0,s.propToCol(g)),a._createCellCoords(p.data.length-1,s.propToCol(g)),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var R=0;R<b[E].length;R+=1)m.push(b[E][R]);return m},this.getSourceData=function(g,m,b,E){var R;return g===void 0?R=u.getData():R=u.getByRange(a._createCellCoords(g,m),a._createCellCoords(b,E)),R},this.getSourceDataArray=function(g,m,b,E){var R;return g===void 0?R=u.getData(!0):R=u.getByRange(a._createCellCoords(g,m),a._createCellCoords(b,E),!0),R},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,m,b,E){var R=J(g,m,b),B=this.hasHook("afterSetSourceDataAtCell"),x=[];B&&A(R,function(Z){var re=An(Z,3),ie=re[0],se=re[1],_e=re[2];x.push([ie,se,u.getAtCell(ie,se),_e])}),A(R,function(Z){var re=An(Z,3),ie=re[0],se=re[1],_e=re[2];u.setAtCell(ie,se,_e)}),B&&this.runHooks("afterSetSourceDataAtCell",x,E),this.render();var K=a.getActiveEditor();K&&ve(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,m){return u.getAtCell(g,m)},this.getDataAtRow=function(g){var m=s.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),s.DESTINATION_RENDERER);return m[0]||[]},this.getDataType=function(g,m,b,E){var R=this,B=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,m,b,E],x=B[0],K=B[1],Z=B[2],re=B[3],ie=null,se=null;Z===void 0&&(Z=x),re===void 0&&(re=K);var _e="mixed";return Ce(Math.max(Math.min(x,Z),0),Math.max(x,Z),function(Se){var z=!0;return Ce(Math.max(Math.min(K,re),0),Math.max(K,re),function(Ne){var Be=R.getCellMeta(Se,Ne);return se=Be.type,ie?z=ie===se:ie=se,z}),_e=z?se:"mixed",z}),_e},this.removeCellMeta=function(g,m,b){var E=[this.toPhysicalRow(g),this.toPhysicalColumn(m)],R=E[0],B=E[1],x=y.getCellMetaKeyValue(R,B,b),K=a.runHooks("beforeRemoveCellMeta",g,m,b,x);K!==!1&&(y.removeCellMeta(R,B,b),a.runHooks("afterRemoveCellMeta",g,m,b,x)),x=null},this.spliceCellsMeta=function(g){for(var m=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=arguments.length,R=new Array(E>2?E-2:0),B=2;B<E;B++)R[B-2]=arguments[B];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&y.removeRow(this.toPhysicalRow(g),b),R.length>0&&A(R.reverse(),function(x){y.createRow(m.toPhysicalRow(g)),A(x,function(K,Z){return m.setCellMetaObject(g,Z,K)})}),a.render()},this.setCellMetaObject=function(g,m,b){var E=this;Er(b)==="object"&&ze(b,function(R,B){E.setCellMeta(g,m,B,R)})},this.setCellMeta=function(g,m,b,E){var R=a.runHooks("beforeSetCellMeta",g,m,b,E);if(R!==!1){var B=g,x=m;g<this.countRows()&&(B=this.toPhysicalRow(g)),m<this.countCols()&&(x=this.toPhysicalColumn(m)),y.setCellMeta(B,x,b,E),a.runHooks("afterSetCellMeta",g,m,b,E)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,m){var b=this.toPhysicalRow(g),E=this.toPhysicalColumn(m);return b===null&&(b=g),E===null&&(E=m),y.getCellMeta(b,E,{visualRow:g,visualColumn:m})},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||p.columns)},this.getCellRenderer=function(g,m){var b=typeof g=="number"?a.getCellMeta(g,m).renderer:g.renderer;return typeof b=="string"?ym(b):bt(b)?ym("text"):b},this.getCellEditor=function(g,m){var b=typeof g=="number"?a.getCellMeta(g,m).editor:g.editor;return typeof b=="string"?fm(b):bt(b)?fm("text"):b},this.getCellValidator=function(g,m){var b=typeof g=="number"?a.getCellMeta(g,m).validator:g.validator;return typeof b=="string"?iT(b):b},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,m){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,g)},this.validateColumns=function(g,m){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,g)},this._validateCells=function(g,m,b){var E=new G;g&&(E.onQueueEmpty=g);for(var R=a.countRows()-1;R>=0;){if(m!==void 0&&m.indexOf(R)===-1){R-=1;continue}for(var B=a.countCols()-1;B>=0;){if(b!==void 0&&b.indexOf(B)===-1){B-=1;continue}E.addValidatorToQueue(),a.validateCell(a.getDataAtCell(R,B),a.getCellMeta(R,B),function(x){if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),B-=1}R-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var m=p.rowHeaders,b=g;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(m=[],Ce(a.countRows()-1,function(E){m.push(a.getRowHeader(E))})):Array.isArray(m)&&m[b]!==void 0?m=m[b]:pt(m)?m=m(b):m&&typeof m!="string"&&typeof m!="number"&&(m=b+1),m},this.hasRowHeaders=function(){return!!p.rowHeaders},this.hasColHeaders=function(){if(p.colHeaders!==void 0&&p.colHeaders!==null)return!!p.colHeaders;for(var g=0,m=a.countCols();g<m;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",g);if(b===void 0){for(var E=[],R=a.countCols(),B=0;B<R;B++)E.push(a.getColHeader(B));return E}var x=p.colHeaders,K=function(se){for(var _e=[],Se=a.countCols(),z=0;z<Se;z++)pt(p.columns)&&p.columns(z)&&_e.push(z);return _e[se]},Z=a.toPhysicalColumn(b),re=K(Z);return p.colHeaders===!1?x=null:p.columns&&pt(p.columns)&&p.columns(re)&&p.columns(re).title?x=p.columns(re).title:p.columns&&p.columns[Z]&&p.columns[Z].title?x=p.columns[Z].title:Array.isArray(p.colHeaders)&&p.colHeaders[Z]!==void 0?x=p.colHeaders[Z]:pt(p.colHeaders)?x=p.colHeaders(Z):p.colHeaders&&typeof p.colHeaders!="string"&&typeof p.colHeaders!="number"&&(x=vb(b)),x=a.runHooks("modifyColumnHeaderValue",x,g,m),x},this._getColWidthFromSettings=function(g){var m;if(g>=0){var b=a.getCellMeta(0,g);m=b.width}if((m===void 0||m===p.width)&&(m=p.colWidths),m!=null){switch(Er(m)){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(g){var m=a._getColWidthFromSettings(g);return m=a.runHooks("modifyColWidth",m,g),m===void 0&&(m=fT.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(g){var m=p.rowHeights;if(m!=null){switch(Er(m)){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(g){var m=a._getRowHeightFromSettings(g);return m=a.runHooks("modifyRowHeight",m,g),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var g=p.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,m)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return hm(a.countRows()-1,function(b){if(a.isEmptyRow(b))m+=1;else if(g===!0)return!1}),m},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return hm(a.countCols()-1,function(b){if(a.isEmptyCol(b))m+=1;else if(g===!0)return!1}),m},this.isEmptyRow=function(g){return p.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return p.isEmptyCol.call(a,g)},this.selectCell=function(g,m,b,E){var R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return bt(g)||bt(m)?!1:this.selectCells([[g,m,b,E]],R,B)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);var E=_.selectCells(g);return E&&b&&a.listen(),i=!1,E},this.selectColumns=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return _.selectColumns(g,m)},this.selectRows=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return _.selectRows(g,m)},this.deselectCell=function(){_.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=g&&this.hasRowHeaders(),b=g&&this.hasColHeaders();i=!0,_.selectAll(m,b),i=!1};var he=function(m,b){return m.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(g,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=!b,x=!E,K=g,Z=m;if(R){var re=Number.isInteger(g),ie=Number.isInteger(m),se=re?he(this.rowIndexMapper,g):void 0,_e=ie?he(this.columnIndexMapper,m):void 0;if(se===null||_e===null)return!1;K=re?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,Z=ie?a.columnIndexMapper.getRenderableFromVisualIndex(_e):void 0}var Se=Number.isInteger(K),z=Number.isInteger(Z);return Se&&z?a.view.scrollViewport(a._createCellCoords(K,Z),B,E,b,x):Se&&z===!1?a.view.scrollViewportVertically(K,B,b):z&&Se===!1?a.view.scrollViewportHorizontally(Z,E,x):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),MO(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}_n(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(m){var b=An(m,2),E=b[1];E.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(a),ze(a,function(m,b,E){pt(m)?E[b]=Oe(b):b!=="guid"&&(E[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,_=null,c=null,a=null};function Oe(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){var m=ur(g);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,m){ge.getSingleton().add(g,m,a)},this.hasHook=function(g){return ge.getSingleton().has(g,a)||ge.getSingleton().has(g)},this.addHookOnce=function(g,m){ge.getSingleton().once(g,m,a)},this.removeHook=function(g,m){ge.getSingleton().remove(g,m,a)},this.runHooks=function(g,m,b,E,R,B,x){return ge.getSingleton().run(a,g,m,b,E,R,B,x)},this.getTranslatedPhrase=function(g,m){return ZU(p.language,g,m)},this.toHTML=function(){return AO(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",AO(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=g;typeof b=="function"&&(b=setTimeout(b,m)),this.timeouts.push(b)},this._clearTimeouts=function(){A(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){A(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(g),a.view.render(),m&&_.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var we=K1e({handleEvent:function(m){var b=a.isListening(),E=(m==null?void 0:m.key)!==void 0;return b&&E},beforeKeyDown:function(m){return n.runHooks("beforeKeyDown",m)},afterKeyDown:function(m){n.isDestroyed||a.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we};var $=we.addContext("grid"),P={runOnlyIf:function(){return ve(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:tAe};we.setActiveContextName("grid"),$.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var m=a.getSelectedRange(),b=m[m.length-1].highlight,E=b.row,R=b.col,B=a.getDataAtCell(E,R),x=new Map,K=0;K<m.length;K++)m[K].forAll(function(Z,re){if(Z>=0&&re>=0&&(Z!==E||re!==R)){var ie=a.getCellMeta(Z,re),se=ie.readOnly;se||x.set("".concat(Z,"x").concat(re),[Z,re,B])}});a.setDataAtCell(Array.from(x.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){_.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){_.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){_.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,E=m.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);_.setRangeStart(b.clone()),_.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){_.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){_.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){_.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m=a.getSelectedRangeLast(),b=m.from,E=m.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);_.setRangeStart(b.clone()),_.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){_.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,E=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,$l(a.isRtl()?[a.countCols()-1,-1]:[0,1]));_.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowLeft","Shift"]],callback:function(){_.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),E=b.from,R=b.to,B=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,$l(a.isRtl()?[a.countCols()-1,-1]:[0,1]));_.setRangeStart(E.clone()),_.setRangeEnd(a._createCellCoords(R.row,B))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){_.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast().highlight.row,E=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,$l(a.isRtl()?[0,1]:[a.countCols()-1,-1]));_.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowRight","Shift"]],callback:function(){_.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var m,b=a.getSelectedRangeLast(),E=b.from,R=b.to,B=(m=a.columnIndexMapper).getNearestNotHiddenIndex.apply(m,$l(a.isRtl()?[0,1]:[a.countCols()-1,-1]));_.setRangeStart(E.clone()),_.setRangeEnd(a._createCellCoords(R.row,B))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,E=a.columnIndexMapper.getNearestNotHiddenIndex(m,1);_.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){_.setRangeEnd(a._createCellCoords(_.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),E=a.rowIndexMapper.getNearestNotHiddenIndex(m,1),R=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);_.setRangeStart(a._createCellCoords(E,R))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){_.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){_.setRangeEnd(a._createCellCoords(_.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var m=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-m-1,-1),E=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);_.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){_.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,E=Math.max(b.row-a.countVisibleRows(),0),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,1);if(R!==null){var B=a._createCellCoords(R,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.max(B.row-x,0);_.setRangeEnd(B),a.scrollViewportTo(K)}}},{keys:[["PageDown"]],callback:function(){_.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var m=a.getSelectedRangeLast(),b=m.to,E=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,-1);if(R!==null){var B=a._createCellCoords(R,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.min(B.row-x,a.countRows()-1);_.setRangeEnd(B),a.scrollViewportTo(K)}}},{keys:[["Tab"]],callback:function(m){var b=typeof p.tabMoves=="function"?p.tabMoves(m):p.tabMoves;_.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(m){var b=typeof p.tabMoves=="function"?p.tabMoves(m):p.tabMoves;_.transformStart(-b.row,-b.col)}}],P),sT().forEach(function(g){var m=Dv(g);S.addItem(g,new m(n))}),ge.getSingleton().run(a,"construct")}function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function UD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UD(Object(r),!0).forEach(function(n){rAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rAe(e,t,r){return t=dz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dz(n.key),n)}}function oAe(e,t,r){return t&&GD(e.prototype,t),r&&GD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dz(e){var t=iAe(e,"string");return wd(t)==="symbol"?t:String(t)}function iAe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YD=215,vz="menu",aAe=vz,yz=function(){function e(t,r){nAe(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:YD,container:this.hot.rootDocument.documentElement},this.eventManager=new kt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return oAe(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Jc(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=UE(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||YD,i=!1,a=Wr(this.menuItems,function(d){return d.key===Gh&&(i=!0),R0e(d,r.hot)});if(a.length<1&&!i)a.push(PU()[Gh]);else if(a.length===0)return;a=P0e(a,qe);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ve(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,y,p,w,S,C){return r.menuItemRenderer(v,y,p,w,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,y){r.isAllSubMenusClosed()?n(y.row):r.openSubMenu(y.row)},rowHeights:function(v){return a[v].name===qe?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),XC()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!XC()||!Ai(v))&&l&&r.hasSelectedItem()&&(pn()||AE()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new tk(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(aAe),c={group:vz},h=zD(zD({},c),{},{runOnlyIf:function(v){return rh(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var y=r.openSubMenu(v[0]);y&&y.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(y[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!S0e(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;A(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?w0e(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===qe||l===!0||a}},{key:"setPosition",value:function(r){var n=new zEe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);Ry(r)||Ey(r)||Ty(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);Ry(n)||Ey(n)||Ty(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(Ry(i)||Ey(i)||Ty(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(Ry(i)||Ey(i)||Ty(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return xt(w,"submenu")},h=function(w){return new RegExp(qe,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},y=l;typeof y=="function"&&(y=y.call(this.hot)),_n(n),te(f,"htItemWrapper"),n.appendChild(f),h(u)?te(n,"htSeparator"):typeof u.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,y))):fl(f,y),d(u)?(te(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(te(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(te(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Le(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(pt(o)&&(o=o.call(this.hot),o===null||bt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),te(i,"htMenu ".concat(this.options.className)),o&&te(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=Ft(n,function(s,u){return s+(u.name===qe?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!bi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!bi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&bi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();gt(yz,Mr);const rk=yz;function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function lAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uAe(n.key),n)}}function sAe(e,t,r){return t&&KD(e.prototype,t),r&&KD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uAe(e){var t=fAe(e,"string");return Ru(t)==="symbol"?t:String(t)}function fAe(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=cAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function cAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function hAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KO(e,t)}function dAe(e){var t=yAe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vAe(this,o)}}function vAe(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gz(e)}function gz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}var Iy="contextMenu",gAe=70;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var mz=function(e){hAe(r,e);var t=dAe(r);function r(n){var o;return lAe(this,r),o=t.call(this,n),o.eventManager=new kt(gz(o)),o.commandExecutor=new RU(o.hot),o.itemsFactory=null,o.menu=null,o}return sAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Iy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Iy];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new rk(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),ba(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(So(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),ba(So(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-ws(o.view),a=f-Wa(o.view)}else i=-1*ws(this.menu.hotMenu.rootWindow),a=-1*Wa(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new kU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Iy],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ba(So(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Iy}},{key:"PLUGIN_PRIORITY",get:function(){return gAe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[cb,hb,qe,jv,Fv,qe,fb,Vv,qe,db,lb,qe,Bv,qe,Xr]}}]),r}(ot);mz.SEPARATOR={name:qe};function mAe(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(FT)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function pAe(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(WT,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function bAe(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(VT,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function wAe(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(BT,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function SAe(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(UT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function CAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OAe(n.key),n)}}function _Ae(e,t,r){return t&&qD(e.prototype,t),r&&qD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OAe(e){var t=RAe(e,"string");return Sd(t)==="symbol"?t:String(t)}function RAe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EAe=function(){function e(){CAe(this,e),this.data={}}return _Ae(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function XD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PAe(n.key),n)}}function TAe(e,t,r){return t&&XD(e.prototype,t),r&&XD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PAe(e){var t=kAe(e,"string");return Cd(t)==="symbol"?t:String(t)}function kAe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AAe=TAe(function e(){$Ae(this,e),this.clipboardData=new EAe});function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function IAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xAe(n.key),n)}}function MAe(e,t,r){return t&&ZD(e.prototype,t),r&&ZD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xAe(e){var t=DAe(e,"string");return _d(t)==="symbol"?t:String(t)}function DAe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nk=function(){function e(t){IAe(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new kt(this),this.listenersCount=new WeakSet,this.container=t}return MAe(e,[{key:"useSecondaryElement",value:function(){var r=LAe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),QD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),QD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",pn()||OW(this.mainElement)}}]),e}();gt(nk,Mr);var Xm=new WeakMap;function NAe(e){var t=new nk(e),r=Xm.get(e);return r=isNaN(r)?0:r,Xm.set(e,r+1),t}function HAe(e){e.eventManager.clear()}var vS=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function QD(e,t,r){e.addEventListener(t,"copy",vS("copy",r)),e.addEventListener(t,"cut",vS("cut",r)),e.addEventListener(t,"paste",vS("paste",r))}var Zm=new WeakMap;function LAe(e){var t=Zm.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Zm.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function JD(e){if(e instanceof nk){var t=Xm.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),HAe(e),t<=0){t=0;var r=Zm.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Zm.delete(e.container)),e.mainElement=null}Xm.set(e.container,t)}}function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function jAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BAe(n.key),n)}}function FAe(e,t,r){return t&&eN(e.prototype,t),r&&eN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BAe(e){var t=VAe(e,"string");return Od(t)==="symbol"?t:String(t)}function VAe(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tN(e,t){pz(e,t),t.add(e)}function Al(e,t,r){pz(e,t),t.set(e,r)}function pz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function My(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function pr(e,t){var r=bz(e,t,"get");return WAe(e,r)}function WAe(e,t){return t.get?t.get.call(e):t.value}function Il(e,t,r){var n=bz(e,t,"set");return UAe(e,n,r),r}function bz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function UAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ti=new WeakMap,yS=new WeakMap,uc=new WeakMap,qO=new WeakMap,XO=new WeakMap,fc=new WeakMap,xy=new WeakSet,rN=new WeakSet,zAe=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;jAe(this,e),tN(this,rN),tN(this,xy),Al(this,ti,{writable:!0,value:void 0}),Al(this,yS,{writable:!0,value:void 0}),Al(this,uc,{writable:!0,value:void 0}),Al(this,qO,{writable:!0,value:void 0}),Al(this,XO,{writable:!0,value:void 0}),Al(this,fc,{writable:!0,value:void 0}),Il(this,yS,r),Il(this,uc,n),Il(this,qO,o),Il(this,XO,i),Il(this,fc,a)}return FAe(e,[{key:"setSelectedRange",value:function(r){Il(this,ti,r)}},{key:"getCellsRange",value:function(){if(pr(this,yS).call(this)===0||pr(this,uc).call(this)===0)return null;var r=pr(this,ti).getTopStartCorner(),n=r.row,o=r.col,i=pr(this,ti).getBottomEndCorner(),a=i.row,l=i.col,s=My(this,rN,GAe).call(this,n,a),u=My(this,xy,gS).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(pr(this,uc).call(this)===0||pr(this,fc).call(this)===0)return null;var r=pr(this,ti).getTopStartCorner(),n=r.col,o=pr(this,ti).getBottomEndCorner(),i=o.col,a=My(this,xy,gS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(pr(this,uc).call(this)===0||pr(this,fc).call(this)===0)return null;var r=pr(this,ti).getTopStartCorner(),n=r.col,o=pr(this,ti).getBottomEndCorner(),i=o.col,a=My(this,xy,gS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-pr(this,fc).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function gS(e,t){return Math.min(t,Math.max(e+pr(this,XO).call(this)-1,e))}function GAe(e,t){return Math.min(t,Math.max(e+pr(this,qO).call(this)-1,e))}function wz(e){var t=[],r=[];return A(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Ce(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);Ce(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function YAe(e,t){return ZAe(e)||XAe(e,t)||qAe(e,t)||KAe()}function KAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qAe(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZAe(e){if(Array.isArray(e))return e}function el(e){"@babel/helpers - typeof";return el=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},el(e)}function QAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cz(n.key),n)}}function JAe(e,t,r){return t&&oN(e.prototype,t),r&&oN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=eIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function eIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function tIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function rIe(e){var t=oIe();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nIe(this,o)}}function nIe(e,t){if(t&&(el(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mr(e)}function mr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}function iIe(e,t){Sz(e,t),t.add(e)}function Qi(e,t,r){Sz(e,t),t.set(e,r)}function Sz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(e,t,r){return t=Cz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cz(e){var t=aIe(e,"string");return el(t)==="symbol"?t:String(t)}function aIe(e,t){if(el(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(el(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lIe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Dr(e,t){var r=_z(e,t,"get");return sIe(e,r)}function sIe(e,t){return t.get?t.get.call(e):t.value}function Jn(e,t,r){var n=_z(e,t,"set");return uIe(e,n,r),r}function _z(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function uIe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");var Dy="copyPaste",fIe=80,cIe=["fragmentSelection"],iN=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),mS=new WeakMap,pS=new WeakMap,bS=new WeakMap,xl=new WeakMap,Ny=new WeakMap,Hy=new WeakMap,Dl=new WeakMap,aN=new WeakSet,hIe=function(e){tIe(r,e);var t=rIe(r);function r(){var n;QAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),iIe(mr(n),aN),Ml(mr(n),"columnsLimit",1/0),Ml(mr(n),"rowsLimit",1/0),Ml(mr(n),"pasteMode","overwrite"),Ml(mr(n),"uiContainer",n.hot.rootDocument.body),Qi(mr(n),mS,{writable:!0,value:!1}),Qi(mr(n),pS,{writable:!0,value:!1}),Qi(mr(n),bS,{writable:!0,value:!1}),Qi(mr(n),xl,{writable:!0,value:"cells-only"}),Qi(mr(n),Ny,{writable:!0,value:!1}),Qi(mr(n),Hy,{writable:!0,value:!1}),Qi(mr(n),Dl,{writable:!0,value:new zAe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Ml(mr(n),"copyableRanges",[]),Ml(mr(n),"focusableElement",void 0),n}return JAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Dy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[Dy];if(el(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Jn(this,mS,!!a.copyColumnHeaders),Jn(this,pS,!!a.copyColumnGroupHeaders),Jn(this,bS,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=NAe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),wa(Co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),wa(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&JD(this.focusableElement),wa(Co(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Jn(this,xl,o),Jn(this,Ny,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Jn(this,Hy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return Vc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=wz(o),s=l.rows,u=l.columns;return A(s,function(f){var c=[];A(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new AAe;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){Dr(this,Dl).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);Dr(this,xl)==="column-headers-only"?i.set("headers",Dr(this,Dl).getMostBottomColumnHeadersRange()):(Dr(this,xl)==="with-column-headers"?i.set("headers",Dr(this,Dl).getMostBottomColumnHeadersRange()):Dr(this,xl)==="with-column-group-headers"&&i.set("headers",Dr(this,Dl).getAllColumnHeadersRange()),i.set("cells",Dr(this,Dl).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,y=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,y=f,p=c,w=f,S=c;s.length<a||y<=d;){var C=this.hot.getCellMeta(y,c),k=C.skipRowOnPaste,_=C.visualRow;if(y=_+1,k!==!0){w=_,p=c;for(var D=[],V=s.length%a;D.length<l||p<=v;){var X=this.hot.getCellMeta(f,p),G=X.skipColumnOnPaste,q=X.visualCol;if(p=q+1,G!==!0){S=q;var Q=D.length%l;D.push(o[V][Q])}}s.push(D)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,Ny)||this.isEditorOpened())){this.setCopyableText(),Jn(this,Ny,!1);var i=this.getRangedData(this.copyableRanges),a=lIe(this,aN,dIe).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=Vc(i);if(o&&o.clipboardData){var u=IO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[iN,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Jn(this,xl,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,Hy)||this.isEditorOpened())){this.setCopyableText(),Jn(this,Hy,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=Vc(i);if(o&&o.clipboardData){var s=IO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[iN,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=qp(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=NU(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=P$e(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=YAe(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},mAe(this)),Dr(this,mS)&&o.items.push(wAe(this)),Dr(this,pS)&&o.items.push(bAe(this)),Dr(this,bS)&&o.items.push(pAe(this)),o.items.push(SAe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&SW())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(JD(this.focusableElement),this.focusableElement=null),wa(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dy}},{key:"SETTING_KEYS",get:function(){return[Dy].concat(cIe)}},{key:"PLUGIN_PRIORITY",get:function(){return fIe}}]),r}(ot);function dIe(e){for(var t=wz(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function Oz(e,t){return"border_row".concat(e,"col").concat(t)}function Ec(){return{width:1,color:"#000"}}function _o(){return{hide:!0}}function vIe(){return{width:1,color:"#000",cornerVisible:!1}}function wS(e){if(ve(e.start)||ve(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ve(e.end)||ve(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function cc(e){return ve(e.start)&&(e.left=e.start),ve(e.end)&&(e.right=e.end),e}function SS(e,t){return{id:Oz(e,t),border:vIe(),row:e,col:t,top:_o(),bottom:_o(),start:_o(),end:_o()}}function yIe(e,t){return xt(t,"border")&&t.border&&(e.border=t.border),xt(t,"top")&&ve(t.top)&&(t.top?(Ue(t.top)||(t.top=Ec()),e.top=t.top):(t.top=_o(),e.top=t.top)),xt(t,"bottom")&&ve(t.bottom)&&(t.bottom?(Ue(t.bottom)||(t.bottom=Ec()),e.bottom=t.bottom):(t.bottom=_o(),e.bottom=t.bottom)),xt(t,"start")&&ve(t.start)&&(t.start?(Ue(t.start)||(t.start=Ec()),e.start=t.start):(t.start=_o(),e.start=t.start)),xt(t,"end")&&ve(t.end)&&(t.end?(Ue(t.end)||(t.end=Ec()),e.end=t.end):(t.end=_o(),e.end=t.end)),e}function Uo(e,t){var r=!1;return A(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!xt(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function bb(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function gIe(e){return e.some(function(t){return ve(t.left)||ve(t.right)})}function mIe(e){return e.some(function(t){return ve(t.start)||ve(t.end)})}var pIe=new Map([["left","start"],["right","end"]]);function bIe(e){var t;return(t=pIe.get(e))!==null&&t!==void 0?t:e}function wIe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(fP),n=Uo(this,"bottom");return n&&(r=bb(r)),r},callback:function(r,n){var o=Uo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function SIe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(cP),o=Uo(this,t);return o&&(n=bb(n)),n},callback:function(n,o){var i=Uo(this,t);e.prepareBorder(o,t,i)}}}function CIe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(hP)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Uo(this)}}}function _Ie(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(uP),o=Uo(this,t);return o&&(n=bb(n)),n},callback:function(n,o){var i=Uo(this,t);e.prepareBorder(o,t,i)}}}function OIe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(sP),n=Uo(this,"top");return n&&(r=bb(r)),r},callback:function(r,n){var o=Uo(this,"top");e.prepareBorder(n,"top",o)}}}function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function lN(e,t){return PIe(e)||TIe(e,t)||EIe(e,t)||RIe()}function RIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EIe(e,t){if(e){if(typeof e=="string")return sN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sN(e,t)}}function sN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function PIe(e){if(Array.isArray(e))return e}function kIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ez(n.key),n)}}function $Ie(e,t,r){return t&&uN(e.prototype,t),r&&uN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=AIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function AIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function IIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QO(e,t)}function MIe(e){var t=DIe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xIe(this,o)}}function xIe(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rz(e)}function Rz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}function NIe(e,t,r){return t=Ez(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ez(e){var t=HIe(e,"string");return Eu(t)==="symbol"?t:String(t)}function HIe(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ly="customBorders",LIe=90,jIe=function(e){IIe(r,e);var t=MIe(r);function r(){var n;kIe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),NIe(Rz(n),"savedBorders",[]),n}return $Ie(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ly]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),Sa(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Sa(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Sa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=wS(i));var u=Su(o),f=zh(u);A(o,function(c){for(var h=f(c),d=lN(h,4),v=d[0],y=d[1],p=d[2],w=d[3],S=function(_){for(var D=function(G){A(l,function(q){a.prepareBorderFromCustomAdded(_,G,s,bIe(q))})},V=y;V<=w;V+=1)D(V)},C=v;C<=p;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=Su(o),l=zh(a),s=[];return A(o,function(u){for(var f=l(u),c=lN(f,4),h=c[0],d=c[1],v=c[2],y=c[3],p=function(C){for(var k=function(V){A(i.savedBorders,function(X){X.row===C&&X.col===V&&s.push(cc(X))})},_=d;_<=y;_+=1)k(_)},w=h;w<=v;w+=1)p(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(A(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=SS(o,i);a&&(f=yIe(f,a),A(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",cc(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);Ce(o.from.row,l,function(u){Ce(o.from.col,s,function(f){var c=SS(u,f),h=0;u===o.from.row&&xt(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&xt(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&xt(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&xt(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",cc(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=Oz(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=SS(o,i):s=wS(s),l){s[a]=_o();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",cc(s))}}else{s[a]=Ec();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",cc(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;A(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Ce(u.col,f.col,function(c){Ce(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":Ce(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":Ce(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":Ce(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":Ce(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;A(o,function(a){var l=wS(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return Ft(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=We(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;A(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;A(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=We(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):A(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return A(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return ze(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):A(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&ze(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[Ly];if(Array.isArray(o)){var i=fr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=gIe(o),a=mIe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[Ly]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(lP)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[OIe(this),_Ie(this),wIe(this),SIe(this),CIe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Sa(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ly}},{key:"PLUGIN_PRIORITY",get:function(){return LIe}}]),r}(ot);function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function FIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VIe(n.key),n)}}function BIe(e,t,r){return t&&fN(e.prototype,t),r&&fN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VIe(e){var t=WIe(e,"string");return Tu(t)==="symbol"?t:String(t)}function WIe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ca(){return typeof Reflect<"u"&&Reflect.get?Ca=Reflect.get.bind():Ca=function(t,r,n){var o=UIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function UIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function zIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JO(e,t)}function GIe(e){var t=KIe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YIe(this,o)}}function YIe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tz(e)}function Tz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}var cN="dragToScroll",qIe=100,XIe=function(e){zIe(r,e);var t=GIe(r);function r(n){var o;return FIe(this,r),o=t.call(this,n),o.eventManager=new kt(Tz(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return BIe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),Ca(Ro(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ca(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Ca(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Jc(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!Ai(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){Ca(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cN}},{key:"PLUGIN_PRIORITY",get:function(){return qIe}}]),r}(ot);function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function ZIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JIe(n.key),n)}}function QIe(e,t,r){return t&&hN(e.prototype,t),r&&hN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JIe(e){var t=eMe(e,"string");return Pu(t)==="symbol"?t:String(t)}function eMe(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _a(){return typeof Reflect<"u"&&Reflect.get?_a=Reflect.get.bind():_a=function(t,r,n){var o=tMe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_a.apply(this,arguments)}function tMe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function rMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eR(e,t)}function eR(e,t){return eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eR(e,t)}function nMe(e){var t=iMe();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oMe(this,o)}}function oMe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pz(e)}function Pz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");var CS="dropdownMenu",aMe=230,_S="changeType",kz=function(e){rMe(r,e);var t=nMe(r);function r(n){var o;return ZIe(this,r),o=t.call(this,n),o.eventManager=new kt(Pz(o)),o.commandExecutor=new RU(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return QIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[CS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new kU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[CS],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),_a(Eo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new rk(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_a(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),_a(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,_S)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(_S));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=_S,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),_a(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return CS}},{key:"PLUGIN_PRIORITY",get:function(){return aMe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[jv,Fv,qe,Vv,qe,ab,qe,Bv,qe,Xr]}}]),r}(ot);kz.SEPARATOR={name:qe};function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function lMe(e,t){return cMe(e)||fMe(e,t)||uMe(e,t)||sMe()}function sMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uMe(e,t){if(e){if(typeof e=="string")return dN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dN(e,t)}}function dN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cMe(e){if(Array.isArray(e))return e}function hMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vMe(n.key),n)}}function dMe(e,t,r){return t&&vN(e.prototype,t),r&&vN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vMe(e){var t=yMe(e,"string");return Rd(t)==="symbol"?t:String(t)}function yMe(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gMe=function(){function e(t){hMe(this,e),this.hot=t,this.options={}}return dMe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return Ce(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(Ce(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();Ce(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();Ce(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=lMe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const mMe=gMe;function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}function pMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wMe(n.key),n)}}function bMe(e,t,r){return t&&yN(e.prototype,t),r&&yN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wMe(e){var t=SMe(e,"string");return Ed(t)==="symbol"?t:String(t)}function SMe(e,t){if(Ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CMe=function(){function e(t,r){pMe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return bMe(e,[{key:"_mergeOptions",value:function(r){var n=Sr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=zt(Sr(e.DEFAULT_OPTIONS),n),n=zt(n,r),n.filename=LE(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const _Me=CMe;function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function OMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EMe(n.key),n)}}function RMe(e,t,r){return t&&gN(e.prototype,t),r&&gN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EMe(e){var t=TMe(e,"string");return ku(t)==="symbol"?t:String(t)}function TMe(e,t){if(ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function kMe(e){var t=IMe();return function(){var n=Qm(e),o;if(t){var i=Qm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $Me(this,o)}}function $Me(e,t){if(t&&(ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AMe(e)}function AMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qm(e){return Qm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qm(e)}var MMe=String.fromCharCode(13),xMe=String.fromCharCode(34),DMe=String.fromCharCode(10),NMe=function(e){PMe(r,e);var t=kMe(r);function r(){return OMe(this,r),t.apply(this,arguments)}return RMe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=We(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),A(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Dt(o);return a!==""&&(i||a.indexOf(MMe)>=0||a.indexOf(xMe)>=0||a.indexOf(DMe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(_Me);const HMe=NMe;function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}function LMe(e,t,r){return t=jMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jMe(e){var t=FMe(e,"string");return Td(t)==="symbol"?t:String(t)}function FMe(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BMe="csv",rR=LMe({},BMe,HMe);function VMe(e,t,r){return typeof rR[e]=="function"?new rR[e](t,r):null}function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function WMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zMe(n.key),n)}}function UMe(e,t,r){return t&&mN(e.prototype,t),r&&mN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zMe(e){var t=GMe(e,"string");return $u(t)==="symbol"?t:String(t)}function GMe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nR(e,t)}function KMe(e){var t=ZMe();return function(){var n=Jm(e),o;if(t){var i=Jm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qMe(this,o)}}function qMe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XMe(e)}function XMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jm(e){return Jm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jm(e)}var QMe="exportFile",JMe=240,exe=function(e){YMe(r,e);var t=KMe(r);function r(){return WMe(this,r),t.apply(this,arguments)}return UMe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!rR[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return VMe(o,new mMe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return QMe}},{key:"PLUGIN_PRIORITY",get:function(){return JMe}}]),r}(ot);function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}function txe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nxe(n.key),n)}}function rxe(e,t,r){return t&&pN(e.prototype,t),r&&pN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nxe(e){var t=oxe(e,"string");return Pd(t)==="symbol"?t:String(t)}function oxe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $z=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;txe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new rb)}return rxe(e,[{key:"reset",value:function(){A(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();gt($z,Mr);const wb=$z;var kd={};function xi(e,t){if(!kd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=kd[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function Oa(e){if(!kd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return kd[e].descriptor}function qt(e,t,r){r.key=e,kd[e]={condition:t,descriptor:r}}var rr="none";function ixe(){return!0}qt(rr,ixe,{name:ob,inputsCount:0,showOperators:!1});var Wc="empty";function axe(e){return Xt(e.value)}qt(Wc,axe,{name:bP,inputsCount:0,showOperators:!0});var xg="not_empty";function lxe(e,t){return!xi(Wc,t)(e)}qt(xg,lxe,{name:wP,inputsCount:0,showOperators:!0});function sxe(e,t){return hxe(e)||cxe(e,t)||fxe(e,t)||uxe()}function uxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fxe(e,t){if(e){if(typeof e=="string")return bN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bN(e,t)}}function bN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hxe(e){if(Array.isArray(e))return e}var Uc="eq";function dxe(e,t){var r=sxe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale)===Dt(n)}qt(Uc,dxe,{name:SP,inputsCount:1,showOperators:!0});var Dg="neq";function vxe(e,t){return!xi(Uc,t)(e)}qt(Dg,vxe,{name:CP,inputsCount:1,showOperators:!0});function yxe(e,t){return bxe(e)||pxe(e,t)||mxe(e,t)||gxe()}function gxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mxe(e,t){if(e){if(typeof e=="string")return wN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wN(e,t)}}function wN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bxe(e){if(Array.isArray(e))return e}var Az="gt";function wxe(e,t){var r=yxe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}qt(Az,wxe,{name:TP,inputsCount:1,showOperators:!0});function Sxe(e,t){return Rxe(e)||Oxe(e,t)||_xe(e,t)||Cxe()}function Cxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _xe(e,t){if(e){if(typeof e=="string")return SN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SN(e,t)}}function SN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Rxe(e){if(Array.isArray(e))return e}var Iz="gte";function Exe(e,t){var r=Sxe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}qt(Iz,Exe,{name:PP,inputsCount:1,showOperators:!0});function Txe(e,t){return Axe(e)||$xe(e,t)||kxe(e,t)||Pxe()}function Pxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kxe(e,t){if(e){if(typeof e=="string")return CN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CN(e,t)}}function CN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $xe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Axe(e){if(Array.isArray(e))return e}var Mz="lt";function Ixe(e,t){var r=Txe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}qt(Mz,Ixe,{name:kP,inputsCount:1,showOperators:!0});function Mxe(e,t){return Hxe(e)||Nxe(e,t)||Dxe(e,t)||xxe()}function xxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dxe(e,t){if(e){if(typeof e=="string")return _N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _N(e,t)}}function _N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Hxe(e){if(Array.isArray(e))return e}var xz="lte";function Lxe(e,t){var r=Mxe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}qt(xz,Lxe,{name:$P,inputsCount:1,showOperators:!0});function jxe(e,t){return Wxe(e)||Vxe(e,t)||Bxe(e,t)||Fxe()}function Fxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bxe(e,t){if(e){if(typeof e=="string")return ON(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ON(e,t)}}function ON(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Wxe(e){if(Array.isArray(e))return e}var ok="date_after";function Uxe(e,t){var r=jxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}qt(ok,Uxe,{name:MP,inputsCount:1,showOperators:!0});function zxe(e,t){return qxe(e)||Kxe(e,t)||Yxe(e,t)||Gxe()}function Gxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yxe(e,t){if(e){if(typeof e=="string")return RN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RN(e,t)}}function RN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function qxe(e){if(Array.isArray(e))return e}var ik="date_before";function Xxe(e,t){var r=zxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}qt(ik,Xxe,{name:xP,inputsCount:1,showOperators:!0});function Zxe(e,t){return tDe(e)||eDe(e,t)||Jxe(e,t)||Qxe()}function Qxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jxe(e,t){if(e){if(typeof e=="string")return EN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EN(e,t)}}function EN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tDe(e){if(Array.isArray(e))return e}var ep="between";function rDe(e,t){var r=Zxe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=xi(ik,[a]),f=xi(ok,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}qt(ep,rDe,{name:AP,inputsCount:2,showOperators:!0});var Dz="not_between";function nDe(e,t){return!xi(ep,t)(e)}qt(Dz,nDe,{name:IP,inputsCount:2,showOperators:!0});function oDe(e,t){return sDe(e)||lDe(e,t)||aDe(e,t)||iDe()}function iDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aDe(e,t){if(e){if(typeof e=="string")return TN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TN(e,t)}}function TN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function sDe(e){if(Array.isArray(e))return e}var Nz="begins_with";function uDe(e,t){var r=oDe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Dt(n))}qt(Nz,uDe,{name:_P,inputsCount:1,showOperators:!0});var fDe=$e,Hz=yv,cDe=zn.f,hDe=ol,PN=Kt,dDe=RE,vDe=Ar,yDe=EE,kN=Hz("".endsWith),gDe=Hz("".slice),mDe=Math.min,Lz=yDe("endsWith"),pDe=!Lz&&!!function(){var e=cDe(String.prototype,"endsWith");return e&&!e.writable}();fDe({target:"String",proto:!0,forced:!pDe&&!Lz},{endsWith:function(t){var r=PN(vDe(this));dDe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:mDe(hDe(n),o),a=PN(t);return kN?kN(r,a,i):gDe(r,i-a.length,i)===a}});function bDe(e,t){return _De(e)||CDe(e,t)||SDe(e,t)||wDe()}function wDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SDe(e,t){if(e){if(typeof e=="string")return $N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $N(e,t)}}function $N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _De(e){if(Array.isArray(e))return e}var jz="ends_with";function ODe(e,t){var r=bDe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Dt(n))}qt(jz,ODe,{name:OP,inputsCount:1,showOperators:!0});function RDe(e,t){return kDe(e)||PDe(e,t)||TDe(e,t)||EDe()}function EDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TDe(e,t){if(e){if(typeof e=="string")return AN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AN(e,t)}}function AN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kDe(e){if(Array.isArray(e))return e}var ak="contains";function $De(e,t){var r=RDe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Dt(n))>=0}qt(ak,$De,{name:RP,inputsCount:1,showOperators:!0});var Fz="not_contains";function ADe(e,t){return!xi(ak,t)(e)}qt(Fz,ADe,{name:EP,inputsCount:1,showOperators:!0});var Bz="date_tomorrow";function IDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}qt(Bz,IDe,{name:NP,inputsCount:0});var Vz="date_today";function MDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().startOf("day"),"d"):!1}qt(Vz,MDe,{name:DP,inputsCount:0});var Wz="date_yesterday";function xDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}qt(Wz,xDe,{name:HP,inputsCount:0});hW();function DDe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var oR=new Set([1]).has(1),NDe=oR&&typeof Array.from=="function";function Uv(e){var t=e;return oR&&(t=new Set(t)),function(r){var n;return oR?n=t.has(r):n=!!~t.indexOf(r),n}}function Uz(e){return e??""}function iR(e){var t=e;return NDe?t=Array.from(new Set(t)):t=PE(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function IN(e,t,r,n){var o=[],i=e===t,a;return i||(a=Uv(t)),A(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:DDe(l,r)};n&&n(u),o.push(u)}),o}function zz(e,t){return FDe(e)||jDe(e,t)||LDe(e,t)||HDe()}function HDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LDe(e,t){if(e){if(typeof e=="string")return MN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MN(e,t)}}function MN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FDe(e){if(Array.isArray(e))return e}var Ra="by_value";function BDe(e,t){var r=zz(t,1),n=r[0];return n(e.value)}qt(Ra,BDe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=zz(t,1),n=r[0];return[Uv(n)]},showOperators:!1});var $d={};function VDe(e){if(!$d[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=$d[e].func;return function(r,n){return t(r,n)}}function WDe(e){return $d[e].name}function lk(e,t,r){$d[e]={name:t,func:r}}var _i="conjunction",UDe=FP;function zDe(e,t){return e.every(function(r){return r.func(t)})}lk(_i,UDe,zDe);var tp="disjunction",GDe=ib;function YDe(e,t){return e.some(function(r){return r.func(t)})}lk(tp,GDe,YDe);var sk="disjunctionWithExtraCondition",KDe=ib;function qDe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}lk(sk,KDe,qDe);function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}var hc;function OS(e,t,r){return t=XDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XDe(e){var t=ZDe(e,"string");return Ad(t)==="symbol"?t:String(t)}function ZDe(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QDe="numeric",Gz="text",JDe="date",xN=(hc={},OS(hc,QDe,[rr,qe,Wc,xg,qe,Uc,Dg,qe,Az,Iz,Mz,xz,ep,Dz]),OS(hc,Gz,[rr,qe,Wc,xg,qe,Uc,Dg,qe,Nz,jz,qe,ak,Fz]),OS(hc,JDe,[rr,qe,Wc,xg,qe,Uc,Dg,qe,ik,ok,ep,qe,Bz,Vz,Wz]),hc);function eNe(e){var t=[],r=e;return xN[r]||(r=Gz),A(xN[r],function(n){var o;n===qe?o={name:qe}:o=Sr(Oa(n)),t.push(o)}),t}function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function tNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nNe(n.key),n)}}function rNe(e,t,r){return t&&DN(e.prototype,t),r&&DN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nNe(e){var t=oNe(e,"string");return Id(t)==="symbol"?t:String(t)}function oNe(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RS="built",ES="building",NN=["click","input","keydown","keypress","keyup","focus","blur","change"],Yz=function(){function e(t,r){tNe(this,e),this.hot=t,this.eventManager=new kt(this),this.options=zt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return rNe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===ES?this._element:this.buildState===RS?(this.update(),this._element):(this.buildState=ES,this.build(),this.buildState=RS,this._element)}},{key:"isBuilt",value:function(){return this.buildState===RS}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Or)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=ES),this.options.className&&te(this._element,this.options.className),this.options.children.length)A(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);ze(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),A(NN,function(i){return n(o,i)})}else A(NN,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Sr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();gt(Yz,Mr);const Oi=Yz;function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function iNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lNe(n.key),n)}}function aNe(e,t,r){return t&&HN(e.prototype,t),r&&HN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lNe(e){var t=sNe(e,"string");return Au(t)==="symbol"?t:String(t)}function sNe(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ng(){return typeof Reflect<"u"&&Reflect.get?Ng=Reflect.get.bind():Ng=function(t,r,n){var o=uNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ng.apply(this,arguments)}function uNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Iu(e),e!==null););return e}function fNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aR(e,t)}function cNe(e){var t=dNe();return function(){var n=Iu(e),o;if(t){var i=Iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hNe(this,o)}}function hNe(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kz(e)}function Kz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(e){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iu(e)}var jy=new WeakMap,vNe=function(e){fNe(r,e);var t=cNe(r);function r(n,o){var i;return iNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),jy.set(Kz(i),{}),i.registerHooks(),i}return aNe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){Ng(Iu(r.prototype),"build",this).call(this);var o=jy.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,te(this._element,"htUIInput"),te(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=jy.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&jy.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return Sr({placeholder:"",type:"text",tagName:"input"})}}]),r}(Oi);const ls=vNe;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function yNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mNe(n.key),n)}}function gNe(e,t,r){return t&&LN(e.prototype,t),r&&LN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mNe(e){var t=pNe(e,"string");return Mu(t)==="symbol"?t:String(t)}function pNe(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ss(){return typeof Reflect<"u"&&Reflect.get?ss=Reflect.get.bind():ss=function(t,r,n){var o=bNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ss.apply(this,arguments)}function bNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ri(e),e!==null););return e}function wNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lR(e,t)}function SNe(e){var t=_Ne();return function(){var n=Ri(e),o;if(t){var i=Ri(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CNe(this,o)}}function CNe(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qz(e)}function qz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ri(e){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ri(e)}var Fy=new WeakMap,ONe=function(e){wNe(r,e);var t=SNe(r);function r(n,o){var i;return yNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Fy.set(qz(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return gNe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return A(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;ss(Ri(r.prototype),"build",this).call(this),this.menu=new rk(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new Oi(this.hot,{className:"htUISelectCaption"}),a=new Oi(this.hot,{className:"htUISelectDropdown"}),l=Fy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,A([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(ob),Fy.get(this).captionElement.textContent=o,ss(Ri(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==qe&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=Fy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),ss(Ri(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUISelect",wrapIt:!1})}}]),r}(Oi);const jN=ONe;function xu(e){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}function RNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TNe(n.key),n)}}function ENe(e,t,r){return t&&FN(e.prototype,t),r&&FN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TNe(e){var t=PNe(e,"string");return xu(t)==="symbol"?t:String(t)}function PNe(e,t){if(xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hg(){return typeof Reflect<"u"&&Reflect.get?Hg=Reflect.get.bind():Hg=function(t,r,n){var o=kNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hg.apply(this,arguments)}function kNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Du(e),e!==null););return e}function $Ne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function ANe(e){var t=xNe();return function(){var n=Du(e),o;if(t){var i=Du(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return INe(this,o)}}function INe(e,t){if(t&&(xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MNe(e)}function MNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(e){return Du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Du(e)}var DNe=function(e){$Ne(r,e);var t=ANe(r);function r(n,o){var i;return RNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new jN(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new ls(i.hot,{placeholder:GP})),i.elements.push(new ls(i.hot,{placeholder:YP})),i.registerHooks(),i}return ENe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),A(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=Sr(o.command);a.name.startsWith(Ht)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),A(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||Oa(rr),i=[];return A(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=Oa(o?o.name:rr);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||A(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof jN})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof ls})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&te(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[Oa(rr)];if(o!==null){var a=o.visualIndex;i=eNe(this.hot.getDataType(0,a,this.hot.countRows(),a))}A(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),Hg(Du(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){A(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){ps(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),Sn(o)):ps(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Sn(o))}}]),r}(wb);const TS=DNe;function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function NNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LNe(n.key),n)}}function HNe(e,t,r){return t&&BN(e.prototype,t),r&&BN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LNe(e){var t=jNe(e,"string");return Nu(t)==="symbol"?t:String(t)}function jNe(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lg(){return typeof Reflect<"u"&&Reflect.get?Lg=Reflect.get.bind():Lg=function(t,r,n){var o=FNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Lg.apply(this,arguments)}function FNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hu(e),e!==null););return e}function BNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function VNe(e){var t=UNe();return function(){var n=Hu(e),o;if(t){var i=Hu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WNe(this,o)}}function WNe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xz(e)}function Xz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hu(e){return Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hu(e)}var By=new WeakMap,zNe=function(e){BNe(r,e);var t=VNe(r);function r(n,o){var i;return NNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),By.set(Xz(i),{}),i}return HNe(r,[{key:"build",value:function(){Lg(Hu(r.prototype),"build",this).call(this);var o=By.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=By.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&By.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Sr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(Oi);const VN=zNe;function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}var WN;function GNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qNe(n.key),n)}}function KNe(e,t,r){return t&&UN(e.prototype,t),r&&UN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qNe(e){var t=XNe(e,"string");return Lu(t)==="symbol"?t:String(t)}function XNe(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fR(e,t)}function fR(e,t){return fR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fR(e,t)}function QNe(e){var t=tHe();return function(){var n=rp(e),o;if(t){var i=rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JNe(this,o)}}function JNe(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eHe(e)}function eHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(e)}var zN=0,rHe=function(e){ZNe(r,e);var t=QNe(r);function r(n,o){var i;return YNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return KNe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[_i,tp];A(i,function(a){var l=new VN(o.hot,{name:"operator",label:{htmlFor:a,textContent:WDe(a)},value:a,checked:a===i[zN],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(dt(WN||(WN=GNe(["Radio button with index "," doesn't exist."])),o));A(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof VN&&i.isChecked()});return o?o.getValue():_i}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&A(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_i,i=arguments.length>1?arguments[1]:void 0,a=o;a===sk&&(a=tp),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(zN)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(wb);const nHe=rHe;var oHe=Ge,iHe=Ar,GN=Kt,aHe=/"/g,lHe=oHe("".replace),sHe=function(e,t,r,n){var o=GN(iHe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+lHe(GN(n),aHe,"&quot;")+'"'),i+">"+o+"</"+t+">"},uHe=je,fHe=function(e){return uHe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},cHe=$e,hHe=sHe,dHe=fHe;cHe({target:"String",proto:!0,forced:dHe("link")},{link:function(t){return hHe(this,"a","href",t)}});function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function vHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gHe(n.key),n)}}function yHe(e,t,r){return t&&YN(e.prototype,t),r&&YN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gHe(e){var t=mHe(e,"string");return ju(t)==="symbol"?t:String(t)}function mHe(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jg(){return typeof Reflect<"u"&&Reflect.get?jg=Reflect.get.bind():jg=function(t,r,n){var o=pHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jg.apply(this,arguments)}function pHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fu(e),e!==null););return e}function bHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}function cR(e,t){return cR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cR(e,t)}function wHe(e){var t=CHe();return function(){var n=Fu(e),o;if(t){var i=Fu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return SHe(this,o)}}function SHe(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zz(e)}function Zz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fu(e){return Fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fu(e)}var PS=new WeakMap,_He=function(e){bHe(r,e);var t=wHe(r);function r(n,o){var i;return vHe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),PS.set(Zz(i),{}),i}return yHe(r,[{key:"build",value:function(){jg(Fu(r.prototype),"build",this).call(this);var o=PS.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(PS.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Sr({href:"#",tagName:"a"})}}]),r}(Oi);const KN=_He;function Bu(e){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}function qN(e){return THe(e)||EHe(e)||RHe(e)||OHe()}function OHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RHe(e,t){if(e){if(typeof e=="string")return hR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hR(e,t)}}function EHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function THe(e){if(Array.isArray(e))return hR(e)}function hR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$He(n.key),n)}}function kHe(e,t,r){return t&&XN(e.prototype,t),r&&XN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $He(e){var t=AHe(e,"string");return Bu(t)==="symbol"?t:String(t)}function AHe(e,t){if(Bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function us(){return typeof Reflect<"u"&&Reflect.get?us=Reflect.get.bind():us=function(t,r,n){var o=IHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},us.apply(this,arguments)}function IHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ei(e),e!==null););return e}function MHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dR(e,t)}function dR(e,t){return dR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dR(e,t)}function xHe(e){var t=NHe();return function(){var n=Ei(e),o;if(t){var i=Ei(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DHe(this,o)}}function DHe(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qz(e)}function Qz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ei(e)}var HHe=new WeakMap,LHe="multipleSelect.itemBox",jHe=function(e){MHe(r,e);var t=xHe(r);function r(n,o){var i;return PHe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),HHe.set(Qz(i),{}),i.searchInput=new ls(i.hot,{placeholder:zP,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new KN(i.hot,{textContent:BP,className:"htUISelectAll"}),i.clearAllUI=new KN(i.hot,{textContent:VP,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return kHe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return qN(this.items)}},{key:"getValue",value:function(){return BHe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;us(Ei(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new Oi(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),te(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,y,p,w,S,C){v.title=C.instance.getDataAtRowProp(y,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Jt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:LHe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(FHe(this.items,this.options.value)),us(Ei(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,us(Ei(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=qN(this.items):l=Wr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=zE(ps,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Sn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(HO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(HO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUIMultipleSelect",value:[]})}}]),r}(Oi);const ZN=jHe;function FHe(e,t){var r=Uv(t);return We(e,function(n){return n.checked=r(n.value),n})}function BHe(e){var t=[];return A(e,function(r){r.checked&&t.push(r.value)}),t}function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function VHe(e,t){return GHe(e)||zHe(e,t)||UHe(e,t)||WHe()}function WHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UHe(e,t){if(e){if(typeof e=="string")return QN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QN(e,t)}}function QN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function GHe(e){if(Array.isArray(e))return e}function YHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qHe(n.key),n)}}function KHe(e,t,r){return t&&JN(e.prototype,t),r&&JN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qHe(e){var t=XHe(e,"string");return Vu(t)==="symbol"?t:String(t)}function XHe(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fg(){return typeof Reflect<"u"&&Reflect.get?Fg=Reflect.get.bind():Fg=function(t,r,n){var o=ZHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fg.apply(this,arguments)}function ZHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wu(e),e!==null););return e}function QHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vR(e,t)}function vR(e,t){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vR(e,t)}function JHe(e){var t=rLe();return function(){var n=Wu(e),o;if(t){var i=Wu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eLe(this,o)}}function eLe(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tLe(e)}function tLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wu(e){return Wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wu(e)}var nLe=function(e){QHe(r,e);var t=JHe(r);function r(n,o){var i;return YHe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new ZN(i.hot)),i.registerHooks(),i}return KHe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===Ra){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?rr:Ra},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Wr(u,function(D){return D.name===Ra}),v=VHe(d,1),y=v[0],p={},w=i.hot.getTranslatedPhrase(Km);if(y){var S=iR(We(c(s,h),function(D){return D.value}));f&&(y.args[0]=f);var C=[],k=IN(S,y.args[0],w,function(D){D.checked&&C.push(D.value)}),_=o.editedConditionStack.column;p.locale=i.hot.getCellMeta(0,_).locale,p.args=[C],p.command=Oa(Ra),p.itemsSnapshot=k}else p.args=[],p.command=Oa(rr);i.state.setValueAtIndex(s,p)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof ZN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(Km),i=iR(this._getColumnVisibleValues()),a=IN(i,i,o);this.getMultipleSelectElement().setItems(a),Fg(Wu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){ps(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Sn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:We(this.hot.getDataAtCol(o.visualIndex),function(i){return Uz(i)})}}]),r}(wb);const oLe=nLe;function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function iLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lLe(n.key),n)}}function aLe(e,t,r){return t&&eH(e.prototype,t),r&&eH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lLe(e){var t=sLe(e,"string");return Uu(t)==="symbol"?t:String(t)}function sLe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yR(e,t)}function yR(e,t){return yR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yR(e,t)}function fLe(e){var t=dLe();return function(){var n=np(e),o;if(t){var i=np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cLe(this,o)}}function cLe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hLe(e)}function hLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function np(e){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(e)}var vLe=function(e){uLe(r,e);var t=fLe(r);function r(n,o){var i;return iLe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new ls(i.hot,{type:"button",value:WP,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new ls(i.hot,{type:"button",value:UP,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return aLe(r,[{key:"registerHooks",value:function(){var o=this;A(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(wb);const yLe=vLe;function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}var tH,rH;function nH(e,t){return bLe(e)||pLe(e,t)||mLe(e,t)||gLe()}function gLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mLe(e,t){if(e){if(typeof e=="string")return oH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oH(e,t)}}function oH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bLe(e){if(Array.isArray(e))return e}function iH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function wLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CLe(n.key),n)}}function SLe(e,t,r){return t&&aH(e.prototype,t),r&&aH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CLe(e){var t=_Le(e,"string");return Md(t)==="symbol"?t:String(t)}function _Le(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lH="ConditionCollection.filteringStates",Jz=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;wLe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new rb,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(lH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return SLe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_i;return r.length?VDe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_i,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=We(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(dt(tH||(tH=iH(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(bt($d[o]))throw new Error(dt(rH||(rH=iH(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:xi(s,l)}]},i):f.push({name:s,args:l,func:xi(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=nH(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Ft(this.filteringStates.getEntries(),function(r,n){var o=nH(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:We(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),A(r,function(o){A(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(lH),this.filteringStates=null,this.clearLocalHooks()}}]),e}();gt(Jz,Mr);const eG=Jz;function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function OLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ELe(n.key),n)}}function RLe(e,t,r){return t&&sH(e.prototype,t),r&&sH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ELe(e){var t=TLe(e,"string");return xd(t)==="symbol"?t:String(t)}function TLe(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PLe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};OLe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return RLe(e,[{key:"filter",value:function(){var r=this,n=[];return A(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return A(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return A(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const tG=PLe;function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function kLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ALe(n.key),n)}}function $Le(e,t,r){return t&&uH(e.prototype,t),r&&uH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ALe(e){var t=ILe(e,"string");return Dd(t)==="symbol"?t:String(t)}function ILe(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rG=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};kLe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return $Le(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,A(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=AW(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new eG(o.hot,!1),y=[].concat(c,d);v.importAllConditions(y);var p=o.columnDataFactory(h),w;v.isEmpty()?w=p:w=new tG(v,function(C){return o.columnDataFactory(C)}).filter(),w=We(w,function(C){return C.meta.visualRow});var S=Uv(w);return v.destroy(),Wr(p,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;A(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),ze(this,function(n,o){r[o]=null})}}]),e}();gt(rG,Mr);const MLe=rG;function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}var fH;function xLe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function DLe(e,t){return jLe(e)||LLe(e,t)||HLe(e,t)||NLe()}function NLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HLe(e,t){if(e){if(typeof e=="string")return cH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cH(e,t)}}function cH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jLe(e){if(Array.isArray(e))return e}function FLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VLe(n.key),n)}}function BLe(e,t,r){return t&&hH(e.prototype,t),r&&hH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VLe(e){var t=WLe(e,"string");return zu(t)==="symbol"?t:String(t)}function WLe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fs(){return typeof Reflect<"u"&&Reflect.get?fs=Reflect.get.bind():fs=function(t,r,n){var o=ULe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fs.apply(this,arguments)}function ULe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ti(e),e!==null););return e}function zLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gR(e,t)}function gR(e,t){return gR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gR(e,t)}function GLe(e){var t=KLe();return function(){var n=Ti(e),o;if(t){var i=Ti(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YLe(this,o)}}function YLe(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nG(e)}function nG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ti(e){return Ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ti(e)}var dH="filters",qLe=250,XLe=function(e){zLe(r,e);var t=GLe(r);function r(n){var o;return FLe(this,r),o=t.call(this,n),o.eventManager=new kt(nG(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return BLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[dH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Lv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(LP),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(jP),":")};if(!this.components.get("filter_by_condition")){var f=new TS(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new nHe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new TS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new oLe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new yLe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new eG(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new MLe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),fs(Ti(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}fs(Ti(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:_i,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=We(i.filter(),function(h){return h.meta.visualRow});var c=Uv(l);Ce(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),A(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return A(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,y=c.visualRow,p=c.type,w=c.instance,S=c.dateFormat,C=c.locale,k=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:y,type:p,instance:w,dateFormat:S,locale:C},value:Uz(k)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&A(o,function(a){var l=DLe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=iR(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:qe}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===tp&&i.command.key!==rr&&a.command.key!==rr&&l.command.key!==rr?s=sk:l.command.key!==rr&&(i.command.key===rr||a.command.key===rr)&&(s=_i),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==rr&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==rr&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==rr&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===TS&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?te(i,"htFiltersActive"):Le(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new tG(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===Ra}),f=l.filter(function(h){return h.name!==Ra});if(u.length>=2||f.length>=3)wt(dt(fH||(fH=xLe([`The filter conditions have been applied properly, but couldnât be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnât be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return A(l,function(u){A(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),fs(Ti(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return dH}},{key:"PLUGIN_PRIORITY",get:function(){return qLe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ot);function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}function vH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vH(Object(r),!0).forEach(function(n){ZLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZLe(e,t,r){return t=QLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QLe(e){var t=JLe(e,"string");return Nd(t)==="symbol"?t:String(t)}function JLe(e,t){if(Nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oG="internal-use-in-handsontable",mR={licenseKey:oG,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function iG(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[ar])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function aG(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function eje(e){var t,r=e[ar],n=aG(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=iG(e);return zc(zc(zc({},mR),n),o)}function tje(e){var t,r=e[ar],n=aG(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=iG(e);return zc(zc({},n),o)}function rje(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var yH;function nje(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function pR(e){"@babel/helpers - typeof";return pR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pR(e)}function Sb(){var e="engine_relationship",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function uk(){var e="shared_engine_usage",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function oje(e){var t=e.getSettings(),r=t[ar],n=r==null?void 0:r.engine;if(r===!0||bt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return ije((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(pR(n)==="object"&&bt(n.hyperformula)){var i=Sb(),a=uk().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:oG}),(n.getConfig().leapYear1900!==mR.leapYear1900||zp(n.getConfig().nullDate,mR.nullDate)===!1)&&wt(dt(yH||(yH=nje(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function ije(e,t,r){var n=t[ar],o=eje(t),i=Sb(),a=uk();aje(e,n.functions),lje(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),sje(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function gH(e){var t,r=Sb(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function mH(e,t){if(e){var r=Sb(),n=r.get(e),o=uk(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function aje(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){wt(a.message)}})}function lje(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){wt(n.message)}}}function sje(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){wt(l.message)}}),e.resumeEvaluation())}function uje(e,t){return(bt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var lG="DD/MM/YYYY";function sG(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function fje(e){return sG(e)?e.substr(1):e}function cje(e){return typeof e=="string"&&e.startsWith("=")}function kS(e,t){return typeof e=="string"&&t==="date"}function pH(e,t){return ee(e,t,!0).isValid()}function bH(e,t){return ee(e,t,!0).format(lG)}function hje(e,t){return ee(e,lG,!0).format(t)}function wH(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return ee(n).format(t)}function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}function dje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yje(n.key),n)}}function vje(e,t,r){return t&&SH(e.prototype,t),r&&SH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yje(e){var t=gje(e,"string");return Hd(t)==="symbol"?t:String(t)}function gje(e,t){if(Hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ji(e,t,r){mje(e,t),t.set(e,r)}function mje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _t(e,t){var r=uG(e,t,"get");return pje(e,r)}function pje(e,t){return t.get?t.get.call(e):t.value}function ri(e,t,r){var n=uG(e,t,"set");return bje(e,n,r),r}function uG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var dc=new WeakMap,ni=new WeakMap,Nr=new WeakMap,Vy=new WeakMap,$S=new WeakMap,AS=new WeakMap,Wy=new WeakMap,wje=function(){function e(t,r,n){dje(this,e),Ji(this,dc,{writable:!0,value:void 0}),Ji(this,ni,{writable:!0,value:void 0}),Ji(this,Nr,{writable:!0,value:void 0}),Ji(this,Vy,{writable:!0,value:[]}),Ji(this,$S,{writable:!0,value:[]}),Ji(this,AS,{writable:!0,value:void 0}),Ji(this,Wy,{writable:!0,value:[]}),ri(this,dc,t),ri(this,ni,r),ri(this,Nr,n)}return vje(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return ri(this,Wy,r.map(function(o){var i=_t(n,ni).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),_t(this,Wy)}},{key:"getRemovedHfIndexes",value:function(){return _t(this,Wy)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=_t(this,ni).getIndexesSequence(),o=_t(this,ni).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(ur(_t(this,dc)),"s");_t(this,Nr).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&_t(n,Nr).getEngine()[i](_t(n,Nr).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(ri(this,$S,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),ri(this,AS,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=_t(this,ni).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!_t(this,Nr).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(_t(this,$S),_t(this,AS)));_t(this,Nr).getSheetId()===null?_t(this,Nr).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(ur(_t(this,dc)),"Order");return function(o){if(!_t(r,Nr).isPerformingUndoRedo()){var i=_t(r,ni).getIndexesSequence();if(o==="update"){var a=_t(r,Vy).map(function(c){return i.indexOf(c)}),l=_t(r,Nr).getEngine().getSheetDimensions(_t(r,Nr).getSheetId()),s;_t(r,dc)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);_t(r,Nr).getEngine()[n](_t(r,Nr).getSheetId(),a)}ri(r,Vy,i)}}}},{key:"init",value:function(){ri(this,Vy,_t(this,ni).getIndexesSequence())}}]),e}();const CH=wje;function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}function Sje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_je(n.key),n)}}function Cje(e,t,r){return t&&_H(e.prototype,t),r&&_H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _je(e){var t=Oje(e,"string");return Ld(t)==="symbol"?t:String(t)}function Oje(e,t){if(Ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ea(e,t,r){Rje(e,t),t.set(e,r)}function Rje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eo(e,t){var r=fG(e,t,"get");return Eje(e,r)}function Eje(e,t){return t.get?t.get.call(e):t.value}function ta(e,t,r){var n=fG(e,t,"set");return Tje(e,n,r),r}function fG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Tje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Uy=new WeakMap,zy=new WeakMap,IS=new WeakMap,MS=new WeakMap,xS=new WeakMap,DS=new WeakMap,NS=new WeakMap,Pje=function(){function e(t,r,n){Sje(this,e),ea(this,Uy,{writable:!0,value:void 0}),ea(this,zy,{writable:!0,value:void 0}),ea(this,IS,{writable:!0,value:void 0}),ea(this,MS,{writable:!0,value:!1}),ea(this,xS,{writable:!0,value:!1}),ea(this,DS,{writable:!0,value:null}),ea(this,NS,{writable:!0,value:null}),ta(this,Uy,new CH("row",t,this)),ta(this,zy,new CH("column",r,this)),ta(this,IS,n)}return Cje(e,[{key:"getForAxis",value:function(r){return r==="row"?eo(this,Uy):eo(this,zy)}},{key:"setPerformUndo",value:function(r){ta(this,MS,r)}},{key:"setPerformRedo",value:function(r){ta(this,xS,r)}},{key:"isPerformingUndoRedo",value:function(){return eo(this,MS)||eo(this,xS)}},{key:"getSheetId",value:function(){return eo(this,NS)}},{key:"getEngine",value:function(){return eo(this,DS)}},{key:"getPostponeAction",value:function(){return eo(this,IS)}},{key:"setupSyncEndpoint",value:function(r,n){ta(this,DS,r),ta(this,NS,n),eo(this,Uy).init(),eo(this,zy).init()}}]),e}();const kje=Pje;function $je(e){return Mje(e)||Ije(e)||cG(e)||Aje()}function Aje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ije(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mje(e){if(Array.isArray(e))return bR(e)}function Di(e){"@babel/helpers - typeof";return Di=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Di(e)}function Nl(e,t){return Nje(e)||Dje(e,t)||cG(e,t)||xje()}function xje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cG(e,t){if(e){if(typeof e=="string")return bR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bR(e,t)}}function bR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Nje(e){if(Array.isArray(e))return e}function Hje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hG(n.key),n)}}function Lje(e,t,r){return t&&OH(e.prototype,t),r&&OH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ea(){return typeof Reflect<"u"&&Reflect.get?Ea=Reflect.get.bind():Ea=function(t,r,n){var o=jje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ea.apply(this,arguments)}function jje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function Fje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wR(e,t)}function wR(e,t){return wR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wR(e,t)}function Bje(e){var t=Wje();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vje(this,o)}}function Vje(e,t){if(t&&(Di(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nn(e)}function Nn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}function Hl(e,t,r){return t=hG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hG(e){var t=Uje(e,"string");return Di(t)==="symbol"?t:String(t)}function Uje(e,t){if(Di(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Di(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HS(e,t,r){zje(e,t),t.set(e,r)}function zje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oi(e,t,r){var n=dG(e,t,"set");return Gje(e,n,r),r}function Gje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ll(e,t){var r=dG(e,t,"get");return Yje(e,r)}function dG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Yje(e,t){return t.get?t.get.call(e):t.value}var ar="formulas",Kje=["maxRows","maxColumns","language"],qje=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");var jl=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},to=new WeakMap,LS=new WeakMap,vc=new WeakMap,Xje=function(e){Fje(r,e);var t=Bje(r);function r(){var n;Hje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),HS(Nn(n),to,{writable:!0,value:!1}),HS(Nn(n),LS,{writable:!0,value:!1}),HS(Nn(n),vc,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Hl(Nn(n),"staticRegister",on("formulas")),Hl(Nn(n),"engine",null),Hl(Nn(n),"sheetName",null),Hl(Nn(n),"indexSyncer",null),Hl(Nn(n),"rowAxisSyncer",null),Hl(Nn(n),"columnAxisSyncer",null),n}return Lje(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ar]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=oje(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){wt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new kje(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),Ll(this,vc).forEach(function(l){var s=Nl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),Ea(To(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;Ll(this,vc).forEach(function(i){var a=Nl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),mH(this.engine,this.hot),this.engine=null,Ea(To(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=tje(this.hot.getSettings());rje(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[ar];if(ve(a)&&ve(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[ar].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}Ea(To(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;Ll(this,vc).forEach(function(i){var a,l=Nl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),oi(this,vc,null),mH(this.engine,this.hot),this.engine=null,Ea(To(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ve(i)&&!VU(i))return wt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return wt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return wt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){VE("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(ur(ar),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),gH(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,y=h.sheet;return ve(y)?"".concat(y,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ve(d)===!1||ve(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,p=l(u);if(y!==void 0&&!s.has(p)){var w=gH(i.engine).get(y);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){wt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return kS(a,s.type)&&(pH(a,s.dateFormat)?a=bH(a,s.dateFormat):cje(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&wr(f)&&(f=wH(f,u.dateFormat)),Di(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,y=d.col,p=a.getBottomEndCorner(),w=p.row,S=p.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},k={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(k)===!1)return!1;for(var _=this.engine.getFillRangeData(C,k),D=C.start,V=D.row,X=D.col,G=C.end,q=G.row,Q=G.col,ne=q-V+1,J=Q-X+1,ue=0;ue<_.length;ue+=1)for(var he=0;he<_[ue].length;he+=1){var Oe=_[ue][he],we=ue%ne,$=he%J,P=this.hot.getCellMeta(we,$);kS(Oe,P.type)&&(Oe.startsWith("'")?_[ue][he]=Oe.slice(1):this.isFormulaCellType(we,$,this.sheetId)===!1&&(_[ue][he]=hje(Oe,P.dateFormat)))}return _}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ur(ar))||oi(this,LS,bt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;kS(u,c.type)&&(a=!0,pH(u,h)?i[s][f]=bH(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(oi(this,to,!0),this.engine.setSheetContent(this.sheetId,i),oi(this,to,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ur(ar)))if(this.sheetName=uje(this.engine,this.hot.getSettings()[ar].sheetName),Ll(this,LS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){oi(this,to,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),oi(this,to,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||Ll(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){sG(a.value)&&(a.value=fje(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&wr(h)&&(h=wH(h,d.dateFormat));var v=Di(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||Ll(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!jl(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Nl(f,4),h=c[0],d=c[1],v=c[3],y=a.hot.propToCol(d),p=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(y),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:a.sheetId};p!==null&&w!==null?a.syncChangeWithEngine(h,y,v):l.push([h,y,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Nl(c,3),d=h[0],v=h[1],y=h[2];a.syncChangeWithEngine(d,v,y)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!jl(i)){var l=[],s=[];o.forEach(function(u){var f=Nl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(wr(v)){var y={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(y)){wt("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),l.push.apply(l,$je(a.engine.setCellContents(y,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!jl(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!jl(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!jl(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!jl(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;oi(this,to,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());oi(this,to,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return ar}},{key:"PLUGIN_PRIORITY",get:function(){return qje}},{key:"SETTING_KEYS",get:function(){return[ar].concat(Kje)}}]),r}(ot);function Zje(e,t){return tFe(e)||eFe(e,t)||Jje(e,t)||Qje()}function Qje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jje(e,t){if(e){if(typeof e=="string")return RH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RH(e,t)}}function RH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tFe(e){if(Array.isArray(e))return e}function rFe(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=Zje(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(yP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Gy(e){return aFe(e)||iFe(e)||oFe(e)||nFe()}function nFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oFe(e,t){if(e){if(typeof e=="string")return SR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SR(e,t)}}function iFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aFe(e){if(Array.isArray(e))return SR(e)}function SR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lFe(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(gP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Gy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Gy(c.slice(0,a)));else if(u===null)h.push.apply(h,Gy(c.slice(0,this.countCols())));else{var p=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p,-1));f===w&&p>l&&h.push.apply(h,Gy(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function Gu(e){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function sFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fFe(n.key),n)}}function uFe(e,t,r){return t&&EH(e.prototype,t),r&&EH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fFe(e){var t=cFe(e,"string");return Gu(t)==="symbol"?t:String(t)}function cFe(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ta(){return typeof Reflect<"u"&&Reflect.get?Ta=Reflect.get.bind():Ta=function(t,r,n){var o=hFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ta.apply(this,arguments)}function hFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function dFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CR(e,t)}function CR(e,t){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CR(e,t)}function vFe(e){var t=gFe();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yFe(this,o)}}function yFe(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _R(e)}function _R(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}function TH(e,t,r){mFe(e,t),t.set(e,r)}function mFe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(e,t){var r=vG(e,t,"get");return pFe(e,r)}function pFe(e,t){return t.get?t.get.call(e):t.value}function yc(e,t,r){var n=vG(e,t,"set");return bFe(e,n,r),r}function vG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bFe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");var jS="hiddenColumns",wFe=310,In=new WeakMap,Mn=new WeakMap,SFe=function(e){dFe(r,e);var t=vFe(r);function r(){var n;sFe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),TH(_R(n),In,{writable:!0,value:{}}),TH(_R(n),Mn,{writable:!0,value:null}),n}return uFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[jS];Ue(i)&&(yc(this,In,i),bt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),yc(this,Mn,new tb),Hr(this,Mn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Hr(this,Mn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Ta(Po(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ta(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),yc(this,In,{}),Ta(Po(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Hr(this,Mn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualColumn(y)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Hr(this,Mn).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){Hr(i,Mn).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return We(Hr(this,Mn).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Hr(this,Mn).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Hr(this,In).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Hr(this,In).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Hr(this,In).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Hr(this,In).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},rFe(this),lFe(this))}},{key:"onMapInit",value:function(){Array.isArray(Hr(this,In).columns)&&this.hideColumns(Hr(this,In).columns)}},{key:"destroy",value:function(){yc(this,In,null),yc(this,Mn,null),Ta(Po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jS}},{key:"PLUGIN_PRIORITY",get:function(){return wFe}}]),r}(ot);function CFe(e,t){return EFe(e)||RFe(e,t)||OFe(e,t)||_Fe()}function _Fe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OFe(e,t){if(e){if(typeof e=="string")return PH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PH(e,t)}}function PH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function EFe(e){if(Array.isArray(e))return e}function TFe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=CFe(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(mP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Yy(e){return AFe(e)||$Fe(e)||kFe(e)||PFe()}function PFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kFe(e,t){if(e){if(typeof e=="string")return OR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OR(e,t)}}function $Fe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function AFe(e){if(Array.isArray(e))return OR(e)}function OR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IFe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(pP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Yy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Yy(c.slice(0,a)));else if(u===null)h.push.apply(h,Yy(c.slice(0,this.countRows())));else{var p=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(p,-1));f===w&&p>l&&h.push.apply(h,Yy(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function MFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DFe(n.key),n)}}function xFe(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DFe(e){var t=NFe(e,"string");return Yu(t)==="symbol"?t:String(t)}function NFe(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pa(){return typeof Reflect<"u"&&Reflect.get?Pa=Reflect.get.bind():Pa=function(t,r,n){var o=HFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pa.apply(this,arguments)}function HFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function LFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RR(e,t)}function RR(e,t){return RR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RR(e,t)}function jFe(e){var t=BFe();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FFe(this,o)}}function FFe(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ER(e)}function ER(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}function $H(e,t,r){VFe(e,t),t.set(e,r)}function VFe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(e,t){var r=yG(e,t,"get");return WFe(e,r)}function WFe(e,t){return t.get?t.get.call(e):t.value}function gc(e,t,r){var n=yG(e,t,"set");return UFe(e,n,r),r}function yG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function UFe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");var FS="hiddenRows",zFe=320,ro=new WeakMap,xn=new WeakMap,GFe=function(e){LFe(r,e);var t=jFe(r);function r(){var n;MFe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),$H(ER(n),ro,{writable:!0,value:{}}),$H(ER(n),xn,{writable:!0,value:null}),n}return xFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[FS];Ue(i)&&(gc(this,ro,i),bt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),gc(this,xn,new tb),qr(this,xn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,qr(this,xn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Pa(ko(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Pa(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),gc(this,ro,{}),Pa(ko(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=qr(this,xn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualRow(y)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&qr(this,xn).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){qr(i,xn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return We(qr(this,xn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return qr(this,xn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(qr(this,ro).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(qr(this,ro).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!qr(this,ro).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},TFe(this),IFe(this))}},{key:"onMapInit",value:function(){Array.isArray(qr(this,ro).rows)&&this.hideRows(qr(this,ro).rows)}},{key:"destroy",value:function(){gc(this,ro,null),gc(this,xn,null),Pa(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FS}},{key:"PLUGIN_PRIORITY",get:function(){return zFe}}]),r}(ot);function YFe(e,t){return ZFe(e)||XFe(e,t)||qFe(e,t)||KFe()}function KFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qFe(e,t){if(e){if(typeof e=="string")return AH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AH(e,t)}}function AH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZFe(e){if(Array.isArray(e))return e}function QFe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(zT)},callback:function(r,n){var o=YFe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function JFe(e,t){return nBe(e)||rBe(e,t)||tBe(e,t)||eBe()}function eBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tBe(e,t){if(e){if(typeof e=="string")return IH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IH(e,t)}}function IH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function nBe(e){if(Array.isArray(e))return e}function oBe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(GT)},callback:function(r,n){var o=JFe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function iBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lBe(n.key),n)}}function aBe(e,t,r){return t&&MH(e.prototype,t),r&&MH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lBe(e){var t=sBe(e,"string");return Ku(t)==="symbol"?t:String(t)}function sBe(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cs(){return typeof Reflect<"u"&&Reflect.get?cs=Reflect.get.bind():cs=function(t,r,n){var o=uBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cs.apply(this,arguments)}function uBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pi(e),e!==null););return e}function fBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TR(e,t)}function TR(e,t){return TR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},TR(e,t)}function cBe(e){var t=dBe();return function(){var n=Pi(e),o;if(t){var i=Pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hBe(this,o)}}function hBe(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gG(e)}function gG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pi(e)}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");var xH="manualColumnFreeze",vBe=110,mc=new WeakMap,yBe=function(e){fBe(r,e);var t=cBe(r);function r(n){var o;return iBe(this,r),o=t.call(this,n),mc.set(gG(o),{afterFirstUse:!1}),o}return aBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xH]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),cs(Pi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=mc.get(this);o.afterFirstUse=!1,cs(Pi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),cs(Pi(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=mc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=mc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},QFe(this),oBe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=mc.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return xH}},{key:"PLUGIN_PRIORITY",get:function(){return vBe}}]),r}(ot);function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}function gBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pBe(n.key),n)}}function mBe(e,t,r){return t&&DH(e.prototype,t),r&&DH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pBe(e){var t=bBe(e,"string");return jd(t)==="symbol"?t:String(t)}function bBe(e,t){if(jd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BS=0,NH=1,HH=2,Fl="px",wBe=function(){function e(t){gBe(this,e),this.hot=t,this._element=null,this.state=BS,this.inlineProperty=t.isRtl()?"right":"left"}return mBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=HH}},{key:"build",value:function(){this.state===BS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=NH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=BS}},{key:"isAppended",value:function(){return this.state===HH}},{key:"isBuilt",value:function(){return this.state>=NH}},{key:"setPosition",value:function(r,n){wr(r)&&(this._element.style.top=r+Fl),wr(n)&&(this._element.style[this.inlineProperty]=n+Fl)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){wr(r)&&(this._element.style.width=r+Fl),wr(n)&&(this._element.style.height=n+Fl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){wr(r)&&(this._element.style.marginTop=r+Fl),wr(n)&&(this._element.style["margin".concat(ur(this.inlineProperty))]=n+Fl)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ur(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const mG=wBe;function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function SBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Be(n.key),n)}}function CBe(e,t,r){return t&&LH(e.prototype,t),r&&LH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Be(e){var t=OBe(e,"string");return qu(t)==="symbol"?t:String(t)}function OBe(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bg(){return typeof Reflect<"u"&&Reflect.get?Bg=Reflect.get.bind():Bg=function(t,r,n){var o=RBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Bg.apply(this,arguments)}function RBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xu(e),e!==null););return e}function EBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PR(e,t)}function PR(e,t){return PR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PR(e,t)}function TBe(e){var t=$Be();return function(){var n=Xu(e),o;if(t){var i=Xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return PBe(this,o)}}function PBe(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kBe(e)}function kBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Be(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xu(e){return Xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xu(e)}var ABe="ht__manualColumnMove--backlight",IBe=function(e){EBe(r,e);var t=TBe(r);function r(){return SBe(this,r),t.apply(this,arguments)}return CBe(r,[{key:"build",value:function(){Bg(Xu(r.prototype),"build",this).call(this),te(this._element,ABe)}}]),r}(mG);const MBe=IBe;function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function xBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NBe(n.key),n)}}function DBe(e,t,r){return t&&jH(e.prototype,t),r&&jH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NBe(e){var t=HBe(e,"string");return Zu(t)==="symbol"?t:String(t)}function HBe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vg(){return typeof Reflect<"u"&&Reflect.get?Vg=Reflect.get.bind():Vg=function(t,r,n){var o=LBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Vg.apply(this,arguments)}function LBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qu(e),e!==null););return e}function jBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kR(e,t)}function kR(e,t){return kR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kR(e,t)}function FBe(e){var t=WBe();return function(){var n=Qu(e),o;if(t){var i=Qu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BBe(this,o)}}function BBe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VBe(e)}function VBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qu(e){return Qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qu(e)}var UBe="ht__manualColumnMove--guideline",zBe=function(e){jBe(r,e);var t=FBe(r);function r(){return xBe(this,r),t.apply(this,arguments)}return DBe(r,[{key:"build",value:function(){Vg(Qu(r.prototype),"build",this).call(this),te(this._element,UBe)}}]),r}(mG);const GBe=zBe;function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function YBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qBe(n.key),n)}}function KBe(e,t,r){return t&&FH(e.prototype,t),r&&FH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qBe(e){var t=XBe(e,"string");return Ju(t)==="symbol"?t:String(t)}function XBe(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(){return typeof Reflect<"u"&&Reflect.get?ka=Reflect.get.bind():ka=function(t,r,n){var o=ZBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ka.apply(this,arguments)}function ZBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function QBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$R(e,t)}function $R(e,t){return $R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$R(e,t)}function JBe(e){var t=tVe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eVe(this,o)}}function eVe(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AR(e)}function AR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");var VS="manualColumnMove",rVe=120,ii=new WeakMap,BH="ht__manualColumnMove",Ky="show-ui",WS="on-moving--columns",US="after-selection--columns",nVe=function(e){QBe(r,e);var t=JBe(r);function r(n){var o;return YBe(this,r),o=t.call(this,n),ii.set(AR(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new kt(AR(o)),o.backlight=new MBe(n),o.guideline=new GBe(n),o}return KBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[VS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,BH),ka($o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ka($o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,BH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ka($o(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=ii.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=ii.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[VS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Ce(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=ii.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,y=0;if(this.hot.isRtl()){var p=this.hot.rootWindow,w=ht(this.hot.rootElement),S=p.innerWidth-o.rootElementOffset-w;y=p.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else y=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=y){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var k=y,_=u;y+d+h>=f?k=f-d-h:y+h<c+v&&(k=c+v+Math.abs(h)),u>=f-1?_=f-1:_===0?_=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(_-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,k),this.guideline.setPosition(null,_)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=ii.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Le(this.hot.rootElement,[WS,Ky]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=f.from,p=f.to,w=Math.min(y.col,p.col),S=Math.max(y.col,p.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Ut(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,k=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,_=i.col<c.fixedColumnsStart,D=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),V=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),X=this.getColumnsWidth(w,i.col-1)+V,G=this.getColumnsWidth(C,w-1)+(_?D:0)+X;this.backlight.setPosition(k,G),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-k),this.backlight.setOffset(null,-X),te(this.hot.rootElement,WS)}else Le(this.hot.rootElement,US),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ii.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ii.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Le(this.hot.rootElement,Ky):te(this.hot.rootElement,Ky),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ii.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,Le(this.hot.rootElement,[WS,Ky,US]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,US),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ka($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return VS}},{key:"PLUGIN_PRIORITY",get:function(){return rVe}}]),r}(ot);function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function oVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aVe(n.key),n)}}function iVe(e,t,r){return t&&VH(e.prototype,t),r&&VH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aVe(e){var t=lVe(e,"string");return ef(t)==="symbol"?t:String(t)}function lVe(e,t){if(ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $a(){return typeof Reflect<"u"&&Reflect.get?$a=Reflect.get.bind():$a=function(t,r,n){var o=sVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$a.apply(this,arguments)}function sVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function uVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IR(e,t)}function IR(e,t){return IR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IR(e,t)}function fVe(e){var t=hVe();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cVe(this,o)}}function cVe(e,t){if(t&&(ef(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MR(e)}function MR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}var qy="manualColumnResize",dVe=130,WH="manualColumnWidths",zS=new WeakMap,vVe=function(e){uVe(r,e);var t=fVe(r);function r(n){var o;oVe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new kt(MR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,zS.set(MR(o),{config:void 0}),te(o.handle,"manualColumnResizer"),te(o.guide,"manualColumnResizerGuide"),o}return iVe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[qy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new ji,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),$a(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$a(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=zS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),$a(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",WH,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",WH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=zS.get(this),a=this.hot.getSettings()[qy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Pt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();A(v,function(y){var p=y.getTopStartCorner().col,w=y.getBottomEndCorner().col;Ce(p,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Pt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!pi(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!BE(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,A(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[qy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){$a(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return qy}},{key:"PLUGIN_PRIORITY",get:function(){return dVe}}]),r}(ot);function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function yVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mVe(n.key),n)}}function gVe(e,t,r){return t&&UH(e.prototype,t),r&&UH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mVe(e){var t=pVe(e,"string");return Fd(t)==="symbol"?t:String(t)}function pVe(e,t){if(Fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GS=0,zH=1,GH=2,Bl="px",bVe=function(){function e(t){yVe(this,e),this.hot=t,this._element=null,this.state=GS}return gVe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=GH}},{key:"build",value:function(){this.state===GS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=zH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=GS}},{key:"isAppended",value:function(){return this.state===GH}},{key:"isBuilt",value:function(){return this.state>=zH}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Bl),n!==void 0&&(this._element.style.left=n+Bl)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Bl),n&&(this._element.style.height=n+Bl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Bl),n&&(this._element.style.marginLeft=n+Bl)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const pG=bVe;function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function wVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CVe(n.key),n)}}function SVe(e,t,r){return t&&YH(e.prototype,t),r&&YH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CVe(e){var t=_Ve(e,"string");return tf(t)==="symbol"?t:String(t)}function _Ve(e,t){if(tf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wg(){return typeof Reflect<"u"&&Reflect.get?Wg=Reflect.get.bind():Wg=function(t,r,n){var o=OVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Wg.apply(this,arguments)}function OVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=rf(e),e!==null););return e}function RVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xR(e,t)}function xR(e,t){return xR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xR(e,t)}function EVe(e){var t=kVe();return function(){var n=rf(e),o;if(t){var i=rf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TVe(this,o)}}function TVe(e,t){if(t&&(tf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PVe(e)}function PVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rf(e){return rf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rf(e)}var $Ve="ht__manualRowMove--backlight",AVe=function(e){RVe(r,e);var t=EVe(r);function r(){return wVe(this,r),t.apply(this,arguments)}return SVe(r,[{key:"build",value:function(){Wg(rf(r.prototype),"build",this).call(this),te(this._element,$Ve)}}]),r}(pG);const IVe=AVe;function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function MVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DVe(n.key),n)}}function xVe(e,t,r){return t&&KH(e.prototype,t),r&&KH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DVe(e){var t=NVe(e,"string");return nf(t)==="symbol"?t:String(t)}function NVe(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ug(){return typeof Reflect<"u"&&Reflect.get?Ug=Reflect.get.bind():Ug=function(t,r,n){var o=HVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ug.apply(this,arguments)}function HVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=of(e),e!==null););return e}function LVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DR(e,t)}function DR(e,t){return DR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},DR(e,t)}function jVe(e){var t=VVe();return function(){var n=of(e),o;if(t){var i=of(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FVe(this,o)}}function FVe(e,t){if(t&&(nf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BVe(e)}function BVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function of(e){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},of(e)}var WVe="ht__manualRowMove--guideline",UVe=function(e){LVe(r,e);var t=jVe(r);function r(){return MVe(this,r),t.apply(this,arguments)}return xVe(r,[{key:"build",value:function(){Ug(of(r.prototype),"build",this).call(this),te(this._element,WVe)}}]),r}(pG);const zVe=UVe;function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function GVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KVe(n.key),n)}}function YVe(e,t,r){return t&&qH(e.prototype,t),r&&qH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KVe(e){var t=qVe(e,"string");return af(t)==="symbol"?t:String(t)}function qVe(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aa(){return typeof Reflect<"u"&&Reflect.get?Aa=Reflect.get.bind():Aa=function(t,r,n){var o=XVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Aa.apply(this,arguments)}function XVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function ZVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NR(e,t)}function NR(e,t){return NR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NR(e,t)}function QVe(e){var t=eWe();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JVe(this,o)}}function JVe(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HR(e)}function HR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");var YS="manualRowMove",tWe=140,ai=new WeakMap,XH="ht__manualRowMove",Xy="show-ui",KS="on-moving--rows",qS="after-selection--rows",rWe=function(e){ZVe(r,e);var t=QVe(r);function r(n){var o;return GVe(this,r),o=t.call(this,n),ai.set(HR(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new kt(HR(o)),o.backlight=new IVe(n),o.guideline=new zVe(n),o}return YVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,XH),Aa(Io(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Aa(Io(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,XH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Aa(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=ai.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=ai.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[YS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return Ce(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=ai.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Ut(c),d=Ua(c),v=u.holder.scrollTop,y;this.hot.rootWindow===d?y=d.scrollY:y=d.scrollTop;var p=h.top-y,w=o.target.eventPageY-p+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,k=this.backlight.getOffset().top,_=this.backlight.getSize().height,D=f.offsetHeight/2,V=f.offsetHeight,X=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),G=w>=X+D;this.isFixedRowTop(i.row)&&(X+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:G?(o.target.row=i.row+1,X+=i.row===0?V-1:V):o.target.row=i.row;var q=w,Q=X;w+_+k>=S?q=S-_-k:w+k<C&&(q=C+Math.abs(k)),X>=S-1&&(Q=S-1),this.backlight.setPosition(q),this.guideline.setPosition(Q)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=ai.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Le(this.hot.rootElement,[KS,Xy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&y&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var p=h.from,w=h.to,S=Math.min(p.row,w.row),C=Math.max(p.row,w.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var k=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,k),this.backlight.setSize(u.hider.offsetWidth-k,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),te(this.hot.rootElement,KS),this.refreshPositions()}else Le(this.hot.rootElement,qS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ai.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ai.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Le(this.hot.rootElement,Xy):te(this.hot.rootElement,Xy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ai.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Le(this.hot.rootElement,[KS,Xy,qS]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,qS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Aa(Io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YS}},{key:"PLUGIN_PRIORITY",get:function(){return tWe}}]),r}(ot);function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function nWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iWe(n.key),n)}}function oWe(e,t,r){return t&&ZH(e.prototype,t),r&&ZH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iWe(e){var t=aWe(e,"string");return lf(t)==="symbol"?t:String(t)}function aWe(e,t){if(lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ia(){return typeof Reflect<"u"&&Reflect.get?Ia=Reflect.get.bind():Ia=function(t,r,n){var o=lWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ia.apply(this,arguments)}function lWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mo(e),e!==null););return e}function sWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LR(e,t)}function LR(e,t){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LR(e,t)}function uWe(e){var t=cWe();return function(){var n=Mo(e),o;if(t){var i=Mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fWe(this,o)}}function fWe(e,t){if(t&&(lf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jR(e)}function jR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mo(e)}var Zy="manualRowResize",hWe=30,QH="manualRowHeights",XS=new WeakMap,dWe=function(e){sWe(r,e);var t=uWe(r);function r(n){var o;nWe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new kt(jR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,XS.set(jR(o),{config:void 0}),te(o.handle,"manualRowResizer"),te(o.guide,"manualRowResizerGuide"),o}return oWe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Zy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new ji,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),Ia(Mo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ia(Mo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=XS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ia(Mo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",QH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",QH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,l2.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=ht(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var p=this.hot.getSelectedRange();A(p,function(w){var S=w.getTopStartCorner().row,C=w.getBottomStartCorner().row;Ce(S,C,function(k){i.selectedRows.includes(k)||i.selectedRows.push(k)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(ht(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=pi(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!BE(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),A(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[Zy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=XS.get(this),a=this.hot.getSettings()[Zy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){Ia(Mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zy}},{key:"PLUGIN_PRIORITY",get:function(){return hWe}}]),r}(ot);function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}var JH,eL,tL,rL;function Qy(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function vWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gWe(n.key),n)}}function yWe(e,t,r){return t&&nL(e.prototype,t),r&&nL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gWe(e){var t=mWe(e,"string");return Bd(t)==="symbol"?t:String(t)}function mWe(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pWe=function(){function e(t,r,n,o,i,a){vWe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return yWe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return dt(JH||(JH=Qy(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return dt(eL||(eL=Qy(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return dt(tL||(tL=Qy(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return dt(rL||(rL=Qy(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const Ln=pWe;function FR(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vd(e)}var oL;function bWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function iL(e){return _We(e)||CWe(e)||SWe(e)||wWe()}function wWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SWe(e,t){if(e){if(typeof e=="string")return BR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BR(e,t)}}function CWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _We(e){if(Array.isArray(e))return BR(e)}function BR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EWe(n.key),n)}}function RWe(e,t,r){return t&&aL(e.prototype,t),r&&aL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EWe(e){var t=TWe(e,"string");return Vd(t)==="symbol"?t:String(t)}function TWe(e,t){if(Vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PWe=function(){function e(t){OWe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return RWe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return A(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return A(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return A(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new Ln(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(wt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];A(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,A(o,function(a,l){Ce(0,a.rowspan-1,function(s){Ce(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),A(o,function(a){FR.apply(void 0,iL(a))}),A(i,function(a){FR.apply(void 0,iL(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return A(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}A(this.mergedCells,function(l){l.shift(a,n)}),hm(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return dt(oL||(oL=bWe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const kWe=PWe;function Wd(e){"@babel/helpers - typeof";return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wd(e)}function ra(e,t){return MWe(e)||IWe(e,t)||AWe(e,t)||$We()}function $We(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AWe(e,t){if(e){if(typeof e=="string")return lL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lL(e,t)}}function lL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function MWe(e){if(Array.isArray(e))return e}function xWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NWe(n.key),n)}}function DWe(e,t,r){return t&&sL(e.prototype,t),r&&sL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NWe(e){var t=HWe(e,"string");return Wd(t)==="symbol"?t:String(t)}function HWe(e,t){if(Wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LWe=function(){function e(t){xWe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return DWe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=ra(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,y=Math.floor(l/v)*v,p=l-y,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-p,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=p:a[2]+=p?S:0}else if(o==="right"){var k=w.col+w.colspan-f-p,_=a[3]+k;_>=this.plugin.hot.countCols()?a[3]-=p:a[3]+=p?k:0}else if(o==="up"){var D=c-p-w.row+1,V=a[0]+D;V<0?a[0]+=p:a[0]-=p?D:0}else if(o==="left"){var X=h-p-w.col+1,G=a[1]+X;G<0?a[1]+=p:a[1]-=p?X:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),zt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=ra(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ra(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=ra(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ra(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=ra(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),y=c?u-l+1:f-s+1,p=Math.floor(v/y)*y,w=v-p,S=null,C=null,k=null;switch(o){case"up":S="includesVertically",k=h-w+1;break;case"left":S="includesHorizontally",k=h-w+1;break;case"down":S="includesVertically",k=d+w-1;break;case"right":S="includesHorizontally",k=d+w-1;break}return A(i,function(_){_[S](k)&&_.isFarther(C,o)&&(C=_)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return A(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=ra(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const jWe=LWe;function Ud(e){"@babel/helpers - typeof";return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}function FWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VWe(n.key),n)}}function BWe(e,t,r){return t&&uL(e.prototype,t),r&&uL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VWe(e){var t=WWe(e,"string");return Ud(t)==="symbol"?t:String(t)}function WWe(e,t){if(Ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UWe=function(){function e(t){FWe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return BWe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const zWe=UWe;function GWe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(KT)}return this.getTranslatedPhrase(YT)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Ln.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function YWe(e,t){return XWe(e)||qWe(e,t)||bG(e,t)||KWe()}function KWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XWe(e){if(Array.isArray(e))return e}function ZWe(e){return e2e(e)||JWe(e)||bG(e)||QWe()}function QWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bG(e,t){if(e){if(typeof e=="string")return VR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VR(e,t)}}function JWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function e2e(e){if(Array.isArray(e))return VR(e)}function VR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n2e(n.key),n)}}function r2e(e,t,r){return t&&fL(e.prototype,t),r&&fL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n2e(e){var t=o2e(e,"string");return sf(t)==="symbol"?t:String(t)}function o2e(e,t){if(sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hs(){return typeof Reflect<"u"&&Reflect.get?hs=Reflect.get.bind():hs=function(t,r,n){var o=i2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hs.apply(this,arguments)}function i2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ki(e),e!==null););return e}function a2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WR(e,t)}function WR(e,t){return WR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WR(e,t)}function l2e(e){var t=u2e();return function(){var n=ki(e),o;if(t){var i=ki(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return s2e(this,o)}}function s2e(e,t){if(t&&(sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wG(e)}function wG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ki(e){return ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ki(e)}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");var Tc="mergeCells",f2e=150,cL=new WeakMap,hL=Tc,c2e=function(e){a2e(r,e);var t=l2e(r);function r(n){var o;return t2e(this,r),o=t.call(this,n),cL.set(wG(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return r2e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Tc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new kWe(this),this.autofillCalculations=new jWe(this),this.selectionCalculations=new zWe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),hs(ki(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),hs(ki(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[Tc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),hs(ki(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(kE()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=ZWe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=Ss(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=Ss(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(Ln.containsNegativeValues(o)?(wt(Ln.NEGATIVE_VALUES_WARNING(o)),i=!1):Ln.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(wt(Ln.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Ln.isSingleCell(o)?(wt(Ln.IS_SINGLE_CELL(o)),i=!1):Ln.containsZeroSpan(o)&&(wt(Ln.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(A(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),Ce(l.row,l.row+l.rowspan-1,function(c){Ce(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Ce(0,f.rowspan-1,function(v){Ce(0,f.colspan-1,function(y){var p=null;c[v]||(c[v]=[]),v===0&&y===0?p=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+y,"hidden",!0),c[v][y]=p})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),A(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),Ce(0,s.rowspan-1,function(u){Ce(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Tc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:hL})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(hL)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=cL.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var y=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:y.row-u.row,col:y.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=Sr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=Sr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=Sr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),A(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},GWe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ue(l)?Sr(l):void 0;if(Ue(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,y=s.rowspan,p=this.translateMergedCellToRenderable(h,y,d,v),w=YWe(p,2),S=w[0],C=w[1],k=f.getRenderableFromVisualIndex(i),_=c.getRenderableFromVisualIndex(a),D=S-k+1,V=C-_+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,D),s.colspan=Math.min(s.colspan,V)}FR(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);A(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,y=l.col===0;(s&&h||u&&d||c&&v||f&&y)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Tc}},{key:"PLUGIN_PRIORITY",get:function(){return f2e}}]),r}(ot);function dL(e){return y2e(e)||v2e(e)||d2e(e)||h2e()}function h2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d2e(e,t){if(e){if(typeof e=="string")return vL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vL(e,t)}}function vL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function y2e(e){if(Array.isArray(e))return e}function g2e(e,t){return function(r,n){var o=dL(r),i=o.slice(1),a=dL(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:yU(c.type),p=y(f,c,v)(h,d);if(p===Vn){var w=u+1;if(typeof t[w]<"u")return s(w)}return p}(0)}}var yL;function m2e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function gL(){wt(dt(yL||(yL=m2e(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var SG="sort";function p2e(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(SG,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function b2e(e){var t=e.className.split(" "),r=new RegExp("^".concat(SG,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function w2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C2e(n.key),n)}}function S2e(e,t,r){return t&&mL(e.prototype,t),r&&mL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C2e(e){var t=_2e(e,"string");return uf(t)==="symbol"?t:String(t)}function _2e(e,t){if(uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jr(){return typeof Reflect<"u"&&Reflect.get?jr=Reflect.get.bind():jr=function(t,r,n){var o=O2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jr.apply(this,arguments)}function O2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=br(e),e!==null););return e}function R2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UR(e,t)}function UR(e,t){return UR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UR(e,t)}function E2e(e){var t=k2e();return function(){var n=br(e),o;if(t){var i=br(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return T2e(this,o)}}function T2e(e,t){if(t&&(uf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P2e(e)}function P2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},br(e)}var zR="multiColumnSorting",$2e=170,A2e="append",pL="columnSorting";vU(zR,g2e);var I2e=function(e){R2e(r,e);var t=E2e(r);function r(n){var o;return w2e(this,r),o=t.call(this,n),o.pluginKey=zR,o}return S2e(r,[{key:"isEnabled",value:function(){return jr(br(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[pL]&&gL(),jr(br(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){jr(br(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){jr(br(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){jr(br(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return jr(br(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return jr(br(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){jr(br(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=jr(br(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),Le(o,b2e(o)),this.enabled!==!1&&te(o,p2e.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[pL]&&gL(),jr(br(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){bO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,A2e))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return zR}},{key:"PLUGIN_PRIORITY",get:function(){return $2e}}]),r}(mU);function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function M2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D2e(n.key),n)}}function x2e(e,t,r){return t&&bL(e.prototype,t),r&&bL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D2e(e){var t=N2e(e,"string");return ff(t)==="symbol"?t:String(t)}function N2e(e,t){if(ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zg(){return typeof Reflect<"u"&&Reflect.get?zg=Reflect.get.bind():zg=function(t,r,n){var o=H2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},zg.apply(this,arguments)}function H2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cf(e),e!==null););return e}function L2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GR(e,t)}function GR(e,t){return GR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GR(e,t)}function j2e(e){var t=V2e();return function(){var n=cf(e),o;if(t){var i=cf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return F2e(this,o)}}function F2e(e,t){if(t&&(ff(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B2e(e)}function B2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cf(e){return cf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cf(e)}var W2e="multipleSelectionHandles",U2e=160,z2e=function(e){L2e(r,e);var t=j2e(r);function r(n){var o;return M2e(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return x2e(r,[{key:"isEnabled",value:function(){return pn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new kt(this)),this.registerListeners(),zg(cf(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,y;if(i.dragged.length!==0){var p=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!p||p===i.lastSetCell||((p.nodeName==="TD"||p.nodeName==="TH")&&(f=i.hot.getCoords(p),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),y=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),y.start!==null&&i.hot.selection.setRangeStart(y.start),i.hot.selection.setRangeEnd(y.end),i.lastSetCell=p),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return W2e}},{key:"PLUGIN_PRIORITY",get:function(){return U2e}}]),r}(ot);function YR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,y=e.isRoot,p=y===void 0?!1:y,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:p,isPlaceholder:S}}function CG(){return{label:"",isPlaceholder:!0}}function wL(e){return q2e(e)||K2e(e)||Y2e(e)||G2e()}function G2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y2e(e,t){if(e){if(typeof e=="string")return KR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KR(e,t)}}function K2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q2e(e){if(Array.isArray(e))return KR(e)}function KR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function X2e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;A(e,function(o){var i=[],a=0;r.push(i),A(o,function(l){var s=YR();if(Ue(l)){var u=l.label,f=l.colspan;s.label=Dt(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=Dt(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(CG());return!c})});var n=Math.max.apply(Math,wL(We(r,function(o){return o.length})));return A(r,function(o){if(o.length<n){var i=We(new Array(n-o.length),function(){return YR()});o.splice.apply(o,[o.length,0].concat(wL(i)))}}),r}function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}var Z2e=["row","col"];function SL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Q2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SL(Object(r),!0).forEach(function(n){J2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J2e(e,t,r){return t=_G(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eUe(e,t){if(e==null)return{};var r=tUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function rUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_G(n.key),n)}}function nUe(e,t,r){return t&&CL(e.prototype,t),r&&CL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _G(e){var t=oUe(e,"string");return zd(t)==="symbol"?t:String(t)}function oUe(e,t){if(zd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZS(e,t,r){iUe(e,t),t.set(e,r)}function iUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(e,t){var r=OG(e,t,"get");return aUe(e,r)}function aUe(e,t){return t.get?t.get.call(e):t.value}function pc(e,t,r){var n=OG(e,t,"set");return lUe(e,n,r),r}function OG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function lUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var _L=["label","collapsible"],no=new WeakMap,na=new WeakMap,QS=new WeakMap,sUe=function(){function e(){rUe(this,e),ZS(this,no,{writable:!0,value:[]}),ZS(this,na,{writable:!0,value:0}),ZS(this,QS,{writable:!0,value:1/0})}return nUe(e,[{key:"setColumnsLimit",value:function(r){pc(this,QS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];pc(this,no,X2e(r,un(this,QS))),pc(this,na,un(this,no).length)}},{key:"getData",value:function(){return un(this,no)}},{key:"mergeWith",value:function(r){var n=this;A(r,function(o){var i=o.row,a=o.col,l=eUe(o,Z2e),s=n.getHeaderSettings(i,a);s!==null&&zt(s,l,_L)})}},{key:"map",value:function(r){A(un(this,no),function(n){A(n,function(o){var i=r(Q2e({},o));Ue(i)&&zt(o,i,_L)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=un(this,na)||r<0)return null;var i=un(this,no)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=un(this,na)||r<0)return i;for(var a=un(this,no)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return un(this,na)}},{key:"getColumnsCount",value:function(){return un(this,na)>0?un(this,no)[0].length:0}},{key:"clear",value:function(){pc(this,no,[]),pc(this,na,0)}}]),e}();function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}function OL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function RL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OL(Object(r),!0).forEach(function(n){Gg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RG(n.key),n)}}function fUe(e,t,r){return t&&EL(e.prototype,t),r&&EL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gg(e,t,r){return t=RG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RG(e){var t=cUe(e,"string");return Gd(t)==="symbol"?t:String(t)}function cUe(e,t){if(Gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hUe(e){return gUe(e)||yUe(e)||vUe(e)||dUe()}function dUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vUe(e,t){if(e){if(typeof e=="string")return qR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qR(e,t)}}function yUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gUe(e){if(Array.isArray(e))return qR(e)}function qR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var mUe="DF-pre-order";function EG(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=EG.call(this.childs[n],e,t)}return r}var pUe="DF-post-order";function TG(e,t){for(var r=0;r<this.childs.length;r++){var n=TG.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var PG="BF";function bUe(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,hUe(o.childs)),e.call(t,o)!==!1&&n()}}n()}var wUe=PG,TL=new Map([[mUe,EG],[pUe,TG],[PG,bUe]]),PL=function(){function e(t){uUe(this,e),Gg(this,"data",{}),Gg(this,"parent",null),Gg(this,"childs",[]),this.data=t}return fUe(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(RL({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=RL({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wUe;if(!TL.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));TL.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}function kL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $L(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kL(Object(r),!0).forEach(function(n){SUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SUe(e,t,r){return t=kG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CUe(e,t){return EUe(e)||RUe(e,t)||OUe(e,t)||_Ue()}function _Ue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OUe(e,t){if(e){if(typeof e=="string")return AL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AL(e,t)}}function AL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function EUe(e){if(Array.isArray(e))return e}function TUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kG(n.key),n)}}function PUe(e,t,r){return t&&IL(e.prototype,t),r&&IL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kG(e){var t=kUe(e,"string");return Yd(t)==="symbol"?t:String(t)}function kUe(e,t){if(Yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JS(e,t,r){$Ue(e,t),t.set(e,r)}function $Ue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(e,t){var r=$G(e,t,"get");return AUe(e,r)}function AUe(e,t){return t.get?t.get.call(e):t.value}function IUe(e,t,r){var n=$G(e,t,"set");return MUe(e,n,r),r}function $G(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function MUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Vl=new WeakMap,oa=new WeakMap,Wl=new WeakMap,xUe=function(){function e(t){TUe(this,e),JS(this,Vl,{writable:!0,value:new Map}),JS(this,oa,{writable:!0,value:new Map}),JS(this,Wl,{writable:!0,value:null}),IUe(this,Wl,t)}return PUe(e,[{key:"getRoots",value:function(){return Array.from(gr(this,Vl).values())}},{key:"getRootByColumn",value:function(r){var n;return gr(this,oa).has(r)&&(n=gr(this,Vl).get(gr(this,oa).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-gr(this,oa).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;gr(this,oa).clear(),A(gr(this,Vl),function(o){for(var i=CUe(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)gr(r,oa).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=gr(this,Wl).getColumnsCount(),n=0;n<r;){var o=gr(this,Wl).getHeaderSettings(0,n),i=new PL;gr(this,Vl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=gr(this,Wl).getHeadersSettings(o,n,a);o+=1,A(l,function(s){var u=$L($L({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new PL(u),r.addChild(f)),o<gr(i,Wl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){gr(this,Vl).clear(),gr(this,oa).clear()}}]),e}();function AG(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function op(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function ip(e){return op(e,"origColspan")===e.data.origColspan}function fk(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=ip(e);if(n)return fk(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)A(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,AG(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):ip(c)&&(h.isCollapsed=op(c,"isCollapsed"))}),{rollbackModification:function(){return ck(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function ck(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=ip(e);if(o)return ck(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)A(i,function(h){AG(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=op(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):ip(h)&&(d.isCollapsed=op(h,"isCollapsed"))}),{rollbackModification:function(){return fk(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var ML;function DUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function NUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(ML||(ML=DUe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var xL;function HUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function LUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(xL||(xL=HUe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var DL=new Map([["collapse",ck],["expand",fk],["hide-column",NUe],["show-column",LUe]]);function jUe(e,t,r){if(!DL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return DL.get(e)(t,r)}var FUe=["crossHiddenColumns"];function BUe(e,t){if(e==null)return{};var r=VUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Jy(e){var t=[];return A(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=UUe(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(CG());else{var d=WUe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function WUe(e){var t=YR(e);t.crossHiddenColumns;var r=BUe(t,FUe);return r}function UUe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function Kd(e){"@babel/helpers - typeof";return Kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kd(e)}var zUe=["row"];function NL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function HL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NL(Object(r),!0).forEach(function(n){GUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GUe(e,t,r){return t=IG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YUe(e,t){if(e==null)return{};var r=KUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function qUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IG(n.key),n)}}function XUe(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IG(e){var t=ZUe(e,"string");return Kd(t)==="symbol"?t:String(t)}function ZUe(e,t){if(Kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eC(e,t,r){QUe(e,t),t.set(e,r)}function QUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bc(e,t,r){var n=MG(e,t,"set");return JUe(e,n,r),r}function JUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Lt(e,t){var r=MG(e,t,"get");return eze(e,r)}function MG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function eze(e,t){return t.get?t.get.call(e):t.value}var Dn=new WeakMap,Lr=new WeakMap,ia=new WeakMap,tze=function(){function e(){qUe(this,e),eC(this,Dn,{writable:!0,value:new sUe}),eC(this,Lr,{writable:!0,value:new xUe(Lt(this,Dn))}),eC(this,ia,{writable:!0,value:[[]]})}return XUe(e,[{key:"setState",value:function(r){Lt(this,Dn).setData(r);var n=!1;try{Lt(this,Lr).buildTree()}catch{Lt(this,Lr).clear(),Lt(this,Dn).clear(),n=!0}return bc(this,ia,Jy(Lt(this,Lr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Lt(this,Dn).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=We(r,function(i){var a=i.row,l=YUe(i,zUe);return HL({row:a<0?n.rowCoordsToLevel(a):a},l)});Lt(this,Dn).mergeWith(o),Lt(this,Lr).buildTree(),bc(this,ia,Jy(Lt(this,Lr).getRoots()))}},{key:"mapState",value:function(r){Lt(this,Dn).map(r),Lt(this,Lr).buildTree(),bc(this,ia,Jy(Lt(this,Lr).getRoots()))}},{key:"mapNodes",value:function(r){return Ft(Lt(this,Lr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Lt(this,Lr).getNode(n,o),a;return i&&(a=jUe(r,i,o),bc(this,ia,Jy(Lt(this,Lr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Lt(this,ia)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Lt(this,Lr).getNode(r,n);return o?HL({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Lt(this,Dn).getLayersCount()}},{key:"getColumnsCount",value:function(){return Lt(this,Dn).getColumnsCount()}},{key:"clear",value:function(){bc(this,ia,[]),Lt(this,Dn).clear(),Lt(this,Lr).clear()}}]),e}();function qd(e){"@babel/helpers - typeof";return qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qd(e)}function rze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xG(n.key),n)}}function nze(e,t,r){return t&&jL(e.prototype,t),r&&jL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wc(e,t,r){return t=xG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xG(e){var t=oze(e,"string");return qd(t)==="symbol"?t:String(t)}function oze(e,t){if(qd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ize=function(){function e(t,r){rze(this,e),wc(this,"hot",void 0),wc(this,"nestedHeaderSettingsGetter",void 0),wc(this,"layersCount",0),wc(this,"container",void 0),wc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return nze(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),y=this.nestedHeaderSettingsGetter(f,d);if(y&&(!y.isPlaceholder||y.isHidden)){var p=y.label;s&&(p+='<button class="changeType"></button>'),fl(v,p),v.colSpan=y.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const aze=ize;function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}var FL,BL;function VL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DG(n.key),n)}}function sze(e,t,r){return t&&WL(e.prototype,t),r&&WL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ma(){return typeof Reflect<"u"&&Reflect.get?Ma=Reflect.get.bind():Ma=function(t,r,n){var o=uze(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ma.apply(this,arguments)}function uze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xo(e),e!==null););return e}function fze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XR(e,t)}function XR(e,t){return XR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XR(e,t)}function cze(e){var t=dze();return function(){var n=xo(e),o;if(t){var i=xo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hze(this,o)}}function hze(e,t){if(t&&(hf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pc(e)}function Pc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xo(e){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xo(e)}function UL(e,t,r){return t=DG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DG(e){var t=vze(e,"string");return hf(t)==="symbol"?t:String(t)}function vze(e,t){if(hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zL(e,t,r){yze(e,t),t.set(e,r)}function yze(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eg(e,t,r){var n=NG(e,t,"set");return gze(e,n,r),r}function gze(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function $t(e,t){var r=NG(e,t,"get");return mze(e,r)}function NG(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mze(e,t){return t.get?t.get.call(e):t.value}var GL="nestedHeaders",pze=280,Vt=new WeakMap,li=new WeakMap,bze=function(e){fze(r,e);var t=cze(r);function r(){var n;lze(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),zL(Pc(n),Vt,{writable:!0,value:new tze}),zL(Pc(n),li,{writable:!0,value:null}),UL(Pc(n),"ghostTable",new aze(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),UL(Pc(n),"detectedOverlappedHeaders",!1),n}return sze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[GL]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&wt(dt(FL||(FL=VL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),Ma(xo(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;$t(this,Vt).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=$t(this,Vt).setState(a)),this.detectedOverlappedHeaders&&wt(dt(BL||(BL=VL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(u,s)}),!$t(this,li)&&this.enabled&&eg(this,li,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Ma(xo(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),$t(this,Vt).clear(),$t(this,li).unsubscribe(),eg(this,li,null),this.ghostTable.clear(),Ma(xo(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return $t(this,Vt)}},{key:"getLayersCount",value:function(){return $t(this,Vt).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return $t(this,Vt).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Le(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Le(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Le(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),Le(s,"hiddenHeader");var v=(u=$t(i,Vt).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},y=v.colspan,p=v.isHidden,w=v.isPlaceholder;if(w||p)te(s,"hiddenHeader");else if(y>1){var S,C,k=h._wt.wtOverlays,_=(S=k.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),D=(C=k.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),V=_||D?Math.min(y,a-l):y;V>1&&s.setAttribute("colspan",V)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=$t(this,Vt).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=$t(this,Vt).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=$t(this,Vt).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===Wv){if(!d)return l.columnIndex}else f===gb&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,y=c-d+1;if(f>=0||y===1)break;for(var p=c;p<=d;p++)for(var w=f;w<=h;w++){var S,C=v+w,k=p-c;if(k!==0){var _=(S=$t(this,Vt).getHeaderTreeNodeData(w,p))===null||S===void 0?void 0:S.isRoot;_===!1&&(o[C][k]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(Yp(o)||Ai(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),y=h.from;l.column=!0,l.cell=!0;var p=[];i.col<y.col?p.push(v.col,f):i.col>y.col?p.push(d.col,f+c-1):p.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,p)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<$t(this,Vt).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=$t(this,Vt).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=$t(this,Vt).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),wr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?$t(this,Vt).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=$t(this,Vt).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){eg(this,Vt,null),$t(this,li)!==null&&($t(this,li).unsubscribe(),eg(this,li,null)),Ma(xo(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return $t(this,Vt).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return GL}},{key:"PLUGIN_PRIORITY",get:function(){return pze}}]),r}(ot);function YL(e){return _ze(e)||Cze(e)||Sze(e)||wze()}function wze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sze(e,t){if(e){if(typeof e=="string")return ZR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZR(e,t)}}function Cze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _ze(e){if(Array.isArray(e))return ZR(e)}function ZR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function Oze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eze(n.key),n)}}function Rze(e,t,r){return t&&KL(e.prototype,t),r&&KL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eze(e){var t=Tze(e,"string");return df(t)==="symbol"?t:String(t)}function Tze(e,t){if(df(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pze=function(){function e(t,r){Oze(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return Rze(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&A(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&A(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return ze(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(A(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||df(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Ce(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),Ce(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),p=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];A(o,function(l){a.push(i.getDataObject(l))}),A(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(YL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(YL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const kze=Pze;function Xd(e){"@babel/helpers - typeof";return Xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xd(e)}function qL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Aze(n.key),n)}}function $ze(e,t,r){return t&&qL(e.prototype,t),r&&qL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aze(e){var t=Ize(e,"string");return Xd(t)==="symbol"?t:String(t)}function Ize(e,t){if(Xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var xze=$ze(function e(t,r){Mze(this,e),this.hot=r,this.plugin=t});const hk=xze;function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function Dze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hze(n.key),n)}}function Nze(e,t,r){return t&&XL(e.prototype,t),r&&XL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hze(e){var t=Lze(e,"string");return vf(t)==="symbol"?t:String(t)}function Lze(e,t){if(vf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QR(e,t)}function QR(e,t){return QR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QR(e,t)}function Fze(e){var t=Wze();return function(){var n=ap(e),o;if(t){var i=ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bze(this,o)}}function Bze(e,t){if(t&&(vf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vze(e)}function Vze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ap(e)}var Uze=function(e){jze(r,e);var t=Fze(r);function r(n,o){var i;return Dze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return Nze(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(A(c,function(y){y&&u.removeChild(y)}),te(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Ce(0,l-1,function(){var y=h.createElement("SPAN");te(y,r.CSS_CLASSES.emptyIndicator),u.appendChild(y)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");te(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(hk);const HG=Uze;function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function ZL(e){return Kze(e)||Yze(e)||Gze(e)||zze()}function zze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gze(e,t){if(e){if(typeof e=="string")return JR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JR(e,t)}}function Yze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kze(e){if(Array.isArray(e))return JR(e)}function JR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zze(n.key),n)}}function Xze(e,t,r){return t&&QL(e.prototype,t),r&&QL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zze(e){var t=Qze(e,"string");return yf(t)==="symbol"?t:String(t)}function Qze(e,t){if(yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e0(e,t)}function e0(e,t){return e0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},e0(e,t)}function eGe(e){var t=nGe();return function(){var n=lp(e),o;if(t){var i=lp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tGe(this,o)}}function tGe(e,t){if(t&&(yf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rGe(e)}function rGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lp(e){return lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lp(e)}var oGe=function(e){Jze(r,e);var t=eGe(r);function r(n,o){var i;return qze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),A(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){Ce(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return Xze(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&A(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,ZL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&A(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,ZL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&A(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,HG.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),Sn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(hk);const iGe=oGe;function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function aGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sGe(n.key),n)}}function lGe(e,t,r){return t&&JL(e.prototype,t),r&&JL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sGe(e){var t=uGe(e,"string");return gf(t)==="symbol"?t:String(t)}function uGe(e,t){if(gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t0(e,t)}function t0(e,t){return t0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},t0(e,t)}function cGe(e){var t=dGe();return function(){var n=sp(e),o;if(t){var i=sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hGe(this,o)}}function hGe(e,t){if(t&&(gf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LG(e)}function LG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sp(e){return sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sp(e)}var ej=new WeakMap,vGe=function(e){fGe(r,e);var t=cGe(r);function r(n,o){var i;return aGe(this,r),i=t.call(this,n,o),ej.set(LG(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return lGe(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(dP)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(vP)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,o.items.length-1,function(l){if(l===0)return A(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=ej.get(this);return Ce(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(hk);const yGe=vGe;function Zd(e){"@babel/helpers - typeof";return Zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zd(e)}var tj;function rj(e){return bGe(e)||pGe(e)||mGe(e)||gGe()}function gGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mGe(e,t){if(e){if(typeof e=="string")return r0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r0(e,t)}}function pGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bGe(e){if(Array.isArray(e))return r0(e)}function r0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wGe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function SGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ge(n.key),n)}}function CGe(e,t,r){return t&&nj(e.prototype,t),r&&nj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ge(e){var t=OGe(e,"string");return Zd(t)==="symbol"?t:String(t)}function OGe(e,t){if(Zd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RGe=function(){function e(t){SGe(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return CGe(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(p){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(p);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),y=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,y),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return bt(i)&&(wt(dt(tj||(tj=wGe([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,rj(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,rj(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function EGe(e){return $Ge(e)||kGe(e)||PGe(e)||TGe()}function TGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PGe(e,t){if(e){if(typeof e=="string")return n0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n0(e,t)}}function kGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Ge(e){if(Array.isArray(e))return n0(e)}function n0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MGe(n.key),n)}}function IGe(e,t,r){return t&&oj(e.prototype,t),r&&oj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MGe(e){var t=xGe(e,"string");return mf(t)==="symbol"?t:String(t)}function xGe(e,t){if(mf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xa(){return typeof Reflect<"u"&&Reflect.get?xa=Reflect.get.bind():xa=function(t,r,n){var o=DGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xa.apply(this,arguments)}function DGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Do(e),e!==null););return e}function NGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o0(e,t)}function o0(e,t){return o0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o0(e,t)}function HGe(e){var t=jGe();return function(){var n=Do(e),o;if(t){var i=Do(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LGe(this,o)}}function LGe(e,t){if(t&&(mf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jG(e)}function jG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Do(e){return Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Do(e)}var tC="nestedRows",FGe=300,oo=new WeakMap,BGe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",VGe=function(e){NGe(r,e);var t=HGe(r);function r(n){var o;return AGe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,oo.set(jG(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return IGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tC]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Lv),this.dataManager=new kze(this,this.hot),this.collapsingUI=new iGe(this,this.hot),this.headersUI=new HG(this,this.hot),this.contextMenuUI=new yGe(this,this.hot),this.rowMoveController=new RGe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),xa(Do(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),xa(Do(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),xa(Do(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=oo.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=oo.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=oo.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=oo.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=oo.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,EGe(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=oo.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){xa(Do(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!WU(o)){VE(BGe),this.hot.getSettings()[tC]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return tC}},{key:"PLUGIN_PRIORITY",get:function(){return FGe}}]),r}(ot);function Qd(e){"@babel/helpers - typeof";return Qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qd(e)}function WGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ij(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zGe(n.key),n)}}function UGe(e,t,r){return t&&ij(e.prototype,t),r&&ij(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zGe(e){var t=GGe(e,"string");return Qd(t)==="symbol"?t:String(t)}function GGe(e,t){if(Qd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YGe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;WGe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return UGe(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;A(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const KGe=YGe;function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function qGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZGe(n.key),n)}}function XGe(e,t,r){return t&&aj(e.prototype,t),r&&aj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZGe(e){var t=QGe(e,"string");return pf(t)==="symbol"?t:String(t)}function QGe(e,t){if(pf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Da(){return typeof Reflect<"u"&&Reflect.get?Da=Reflect.get.bind():Da=function(t,r,n){var o=JGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Da.apply(this,arguments)}function JGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=No(e),e!==null););return e}function eYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i0(e,t)}function i0(e,t){return i0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},i0(e,t)}function tYe(e){var t=oYe();return function(){var n=No(e),o;if(t){var i=No(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rYe(this,o)}}function rYe(e,t){if(t&&(pf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nYe(e)}function nYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function No(e){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},No(e)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");var lj="persistentState",iYe=0,aYe=function(e){eYe(r,e);var t=tYe(r);function r(n){var o;return qGe(this,r),o=t.call(this,n),o.storage=void 0,o}return XGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[lj]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new KGe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Da(No(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Da(No(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Da(No(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Da(No(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return lj}},{key:"PLUGIN_PRIORITY",get:function(){return iYe}}]),r}(ot);function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function lYe(e){return cYe(e)||fYe(e)||uYe(e)||sYe()}function sYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uYe(e,t){if(e){if(typeof e=="string")return a0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a0(e,t)}}function fYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cYe(e){if(Array.isArray(e))return a0(e)}function a0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vYe(n.key),n)}}function dYe(e,t,r){return t&&sj(e.prototype,t),r&&sj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vYe(e){var t=yYe(e,"string");return bf(t)==="symbol"?t:String(t)}function yYe(e,t){if(bf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Na(){return typeof Reflect<"u"&&Reflect.get?Na=Reflect.get.bind():Na=function(t,r,n){var o=gYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Na.apply(this,arguments)}function gYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ho(e),e!==null););return e}function mYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l0(e,t)}function l0(e,t){return l0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},l0(e,t)}function pYe(e){var t=SYe();return function(){var n=Ho(e),o;if(t){var i=Ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bYe(this,o)}}function bYe(e,t){if(t&&(bf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wYe(e)}function wYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ho(e){return Ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ho(e)}var rC="search",CYe=190,_Ye="htSearchResult",OYe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},RYe=function(t,r,n){return bt(t)||t===null||!t.toLocaleLowerCase||t.length===0||bt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},EYe=function(e){mYe(r,e);var t=pYe(r);function r(n){var o;return hYe(this,r),o=t.call(this,n),o.callback=OYe,o.queryMethod=RYe,o.searchResultClass=_Ye,o}return dYe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[rC]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[rC];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),Na(Ho(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),Na(Ho(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Na(Ho(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Ce(0,s-1,function(h){Ce(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),y=i.hot.getCellMeta(h,d),p=y.search.callback||a,w=y.search.queryMethod||l,S=w(o,v,y);if(S){var C={row:h,col:d,data:v};f.push(C)}p&&p(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ue(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,lYe(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){Na(Ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rC}},{key:"PLUGIN_PRIORITY",get:function(){return CYe}}]),r}(ot);function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function TYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kYe(n.key),n)}}function PYe(e,t,r){return t&&uj(e.prototype,t),r&&uj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kYe(e){var t=$Ye(e,"string");return wf(t)==="symbol"?t:String(t)}function $Ye(e,t){if(wf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ds(){return typeof Reflect<"u"&&Reflect.get?ds=Reflect.get.bind():ds=function(t,r,n){var o=AYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ds.apply(this,arguments)}function AYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$i(e),e!==null););return e}function IYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s0(e,t)}function s0(e,t){return s0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},s0(e,t)}function MYe(e){var t=NYe();return function(){var n=$i(e),o;if(t){var i=$i(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xYe(this,o)}}function xYe(e,t){if(t&&(wf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DYe(e)}function DYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $i(e){return $i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$i(e)}var HYe="touchScroll",LYe=200,jYe=function(e){IYe(r,e);var t=MYe(r);function r(n){var o;return TYe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return PYe(r,[{key:"isEnabled",value:function(){return xE()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),ds($i(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,ds($i(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ds($i(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,A(this.clones,function(o){te(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,A(this.clones,function(i){Le(i,"hide-tween"),te(i,"show-tween")}),this.hot._registerTimeout(function(){A(o.clones,function(i){Le(i,"show-tween")})},400),A(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return HYe}},{key:"PLUGIN_PRIORITY",get:function(){return LYe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ot);function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function FYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VYe(n.key),n)}}function BYe(e,t,r){return t&&fj(e.prototype,t),r&&fj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VYe(e){var t=WYe(e,"string");return Sf(t)==="symbol"?t:String(t)}function WYe(e,t){if(Sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ha(){return typeof Reflect<"u"&&Reflect.get?Ha=Reflect.get.bind():Ha=function(t,r,n){var o=UYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ha.apply(this,arguments)}function UYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Lo(e),e!==null););return e}function zYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u0(e,t)}function u0(e,t){return u0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u0(e,t)}function GYe(e){var t=qYe();return function(){var n=Lo(e),o;if(t){var i=Lo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YYe(this,o)}}function YYe(e,t){if(t&&(Sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KYe(e)}function KYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lo(e){return Lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lo(e)}var tg="trimRows",XYe=330,ZYe=function(e){zYe(r,e);var t=GYe(r);function r(n){var o;return FYe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return BYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tg]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Lv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Ha(Lo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[tg];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Ha(Lo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Ha(Lo(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(A(o,function(c){s[c]=!1}),l=Ft(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[tg];Array.isArray(i)&&this.hot.batchExecution(function(){A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Ha(Lo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tg}},{key:"PLUGIN_PRIORITY",get:function(){return XYe}}]),r}(ot);function Cf(e){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(e)}function FG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QYe(n.key),n)}}function BG(e,t,r){return t&&cj(e.prototype,t),r&&cj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QYe(e){var t=JYe(e,"string");return Cf(t)==="symbol"?t:String(t)}function JYe(e,t){if(Cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f0(e,t)}function f0(e,t){return f0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},f0(e,t)}function WG(e){var t=r3e();return function(){var n=up(e),o;if(t){var i=up(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return e3e(this,o)}}function e3e(e,t){if(t&&(Cf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t3e(e)}function t3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function up(e){return up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},up(e)}function n3e(e){return a3e(e)||i3e(e)||zG(e)||o3e()}function o3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function a3e(e){if(Array.isArray(e))return c0(e)}function UG(e,t){return u3e(e)||s3e(e,t)||zG(e,t)||l3e()}function l3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zG(e,t){if(e){if(typeof e=="string")return c0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c0(e,t)}}function c0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function u3e(e){if(Array.isArray(e))return e}var GG="undoRedo",f3e="undoRedo";function ye(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=UG(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(n3e(h)),c},[]);A(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ye.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ye.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=fr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ye.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ye.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Ce(s.length-1,function(y){var p=[],w=s[y];Ce(u,u+(n-1),function(S){p.push(w[e.toPhysicalColumn(S)])}),f.push(p)}),Ce(n-1,function(y){h.push(e.toPhysicalColumn(u+y))}),Array.isArray(e.getSettings().colHeaders)&&Ce(n-1,function(y){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+y)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ye.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ye.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ye.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ye.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ye.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ye.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ye.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ye.prototype.isEnabled=function(){return this.enabled};ye.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,d3e(e),this.registerShortcuts(),e.addHook("afterChange",YG)}};ye.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,v3e(e),this.unregisterShortcuts(),e.removeHook("afterChange",YG)}};ye.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ye.Action=function(){};ye.Action.prototype.undo=function(){};ye.Action.prototype.redo=function(){};ye.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};qo(ye.ChangeAction,ye.Action);ye.ChangeAction.prototype.undo=function(e,t){for(var r=fr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=UG(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ye.ChangeAction.prototype.redo=function(e,t){for(var r=fr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ye.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};qo(ye.CreateRowAction,ye.Action);ye.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ye.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ye.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};qo(ye.RemoveRowAction,ye.Action);ye.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ye.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ye.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};qo(ye.CreateColumnAction,ye.Action);ye.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ye.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ye.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};qo(ye.RemoveColumnAction,ye.Action);ye.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(We(this.data[s],i));var u=We(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(e.getSourceDataArray(),function(c,h){A(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&A(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ye.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ye.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ye.CellAlignmentAction.prototype.undo=function(e,t){var r=this;A(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ye.CellAlignmentAction.prototype.redo=function(e,t){ui(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};qo(ye.FiltersAction,ye.Action);ye.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ye.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var c3e=function(e){VG(r,e);var t=WG(r);function r(n,o){var i;FG(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return BG(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ye.Action);ye.MergeCellsAction=c3e;var h3e=function(e){VG(r,e);var t=WG(r);function r(n,o){var i;return FG(this,r),i=t.call(this),i.cellRange=o,i}return BG(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ye.Action);ye.UnmergeCellsAction=h3e;ye.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};qo(ye.RowMoveAction,ye.Action);ye.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ye.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ye.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ye.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:GG};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ye.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(GG)};function YG(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function d3e(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function v3e(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var zv=ge.getSingleton();zv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});zv.register("beforeUndo");zv.register("afterUndo");zv.register("beforeRedo");zv.register("afterRedo");ye.PLUGIN_KEY=f3e;ye.SETTING_KEYS=!0;function y3e(){rt(OCe),rt(KCe),rt(h_e),rt(iOe),rt(OOe),rt(mU),rt(h0e),rt(Y0e),rt(mz),rt(hIe),rt(jIe),rt(XIe),rt(kz),rt(exe),rt(XLe),rt(Xje),rt(SFe),rt(GFe),rt(yBe),rt(nVe),rt(vVe),rt(rWe),rt(dWe),rt(c2e),rt(I2e),rt(z2e),rt(bze),rt(VGe),rt(aYe),rt(EYe),rt(jYe),rt(ZYe),rt(ye)}function KG(){cce(),kce(),Kce(),yhe(),y3e()}var g3e=$e,m3e=je,p3e=pp.f,b3e=m3e(function(){return!Object.getOwnPropertyNames(1)});g3e({target:"Object",stat:!0,forced:b3e},{getOwnPropertyNames:p3e});hn(QW);Te.editors={BaseEditor:Mf};function Te(e,t){var r=new tk(e,t||{},XP);return r.init(),r}Te.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new tk(e,t,XP)};Te.DefaultSettings=az();Te.hooks=ge.getSingleton();Te.CellCoords=gm;Te.CellRange=cT;Te.packageName="handsontable";Te.buildDate="22/06/2023 12:51:08";Te.version="13.0.0";Te.languages={dictionaryKeys:H0e,getLanguageDictionary:XU,getLanguagesDictionaries:HPe,registerLanguageDictionary:qU,getTranslatedPhrase:ZU};function w3e(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var l,s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];a=(l=o[r]).call.apply(l,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var nC,oC,iC,aC,lC;KG();w3e(Te);Te.__GhostTable=uT;Te._getListenersCounter=Sse;Te._getRegisteredMapsCounter=TSe;Te.EventManager=kt;var S3e=[uie,Nie,gPe,jce,Cae,Jle,die,rue,Iie,Jae,jie,YTe],C3e=[fle,Fie];Te.helper={};Te.dom={};A(S3e,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.helper[t]=e[t])})});A(C3e,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.dom[t]=e[t])})});Te.cellTypes=(nC=Te.cellTypes)!==null&&nC!==void 0?nC:{};A(vhe(),function(e){Te.cellTypes[e]=aT(e)});Te.cellTypes.registerCellType=hn;Te.cellTypes.getCellType=aT;Te.editors=(oC=Te.editors)!==null&&oC!==void 0?oC:{};A(dse(),function(e){Te.editors["".concat(ur(e),"Editor")]=fm(e)});Te.editors.registerEditor=Pr;Te.editors.getEditor=fm;Te.renderers=(iC=Te.renderers)!==null&&iC!==void 0?iC:{};A(Pce(),function(e){var t=ym(e);e==="base"&&(Te.renderers.cellDecorator=t),Te.renderers["".concat(ur(e),"Renderer")]=t});Te.renderers.registerRenderer=Hn;Te.renderers.getRenderer=ym;Te.validators=(aC=Te.validators)!==null&&aC!==void 0?aC:{};A(Yce(),function(e){Te.validators["".concat(ur(e),"Validator")]=iT(e)});Te.validators.registerValidator=Zl;Te.validators.getValidator=iT;Te.plugins=(lC=Te.plugins)!==null&&lC!==void 0?lC:{};A(sT(),function(e){Te.plugins[e]=Dv(e)});Te.plugins["".concat(ur(ot.PLUGIN_KEY),"Plugin")]=ot;Te.plugins.registerPlugin=rt;Te.plugins.getPlugin=Dv;const hj="selected",dj="odd",_3e=(e,t,r,n,o,i)=>{if(r!==0)return;const a=e.parentElement;if(a===null)return;i.instance.getSourceDataAtRow(t).checked?Te.dom.addClass(a,hj):Te.dom.removeClass(a,hj),t%2===0?Te.dom.addClass(a,dj):Te.dom.removeClass(a,dj)},O3e=function(t,r){const n=document.createElement("input"),o=this.getSourceDataAtRow(t);n.type="checkbox",n.checked=!!o.checked,Te.dom.empty(r),r.appendChild(n)};function R3e(e,t,r){if(t<0||!r.firstChild)return;const n=e.isRtl()?"htRight":"htLeft";Te.dom.addClass(r.firstChild,n)}const E3e=function(t,r){const n=t.target;r.col===-1&&t.target&&n.nodeName==="INPUT"&&(t.preventDefault(),this.setSourceDataAtCell(r.row,"checked",!n.checked))},T3e=(...e)=>{const[t,r,n,o,i,a,l]=e;xf(...e),a?r.innerHTML='<div class="circle critical"></div>':r.innerHTML='<div class="circle"></div>'};var vs=Symbol("unassigned"),P3e="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function fp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function qG(e){var t=Te.hooks.getRegistered(),r={};Object.assign(r,Te.DefaultSettings);for(var n in r)r[n]={default:vs};for(var o=0;o<t.length;o++)r[t[o]]={default:vs};return r.settings={default:vs},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function XG(e){var t={},r=e.settings;if(r!==vs)for(var n in r)fp(r,n)&&r[n]!==vs&&(t[n]=r[n]);for(var o in e)fp(e,o)&&o!=="settings"&&e[o]!==vs&&(t[o]=e[o]);return t}function vj(e,t){var r=XG(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)fp(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!yj(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)fp(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!yj(t[l],o[l]))&&(i[l]=o[l]);return i}function yj(e,t){return JSON.stringify(e)===JSON.stringify(t)}var k3e="13.0.0",dk=h0({name:"HotTable",props:qG("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=vj(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(P3e),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=vj(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=lY(new Te.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:k3e}),$3e=["id"];function A3e(e,t,r,n,o,i){return fa(),Jl("div",{id:e.id},[sY(e.$slots,"default")],8,$3e)}dk.render=A3e;dk.__file="src/HotTable.vue";function gj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function I3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gj(Object(r),!0).forEach(function(n){M3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M3e(e,t,r){return t=D3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x3e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D3e(e){var t=x3e(e,"string");return typeof t=="symbol"?t:String(t)}var At=h0({name:"HotColumn",props:qG("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=XG(this.$props),r=I3e({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});At.__file="src/HotColumn.vue";const sC={__name:"Table",props:["tableOptions"],setup(e){const t=e;KG();const r=aa(()=>R3e),n=aa(()=>_3e),o=aa(()=>O3e),i=aa(()=>E3e),a=aa(()=>t.tableOptions.data),l=aa(()=>T3e);return uY(()=>{}),(s,u)=>(fa(),fY(ft(dk),{data:a.value,style:{width:"100%"},height:400,colWidths:e.tableOptions.colWidths,colHeaders:e.tableOptions.colHeaders,dropdownMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:r.value,beforeRenderer:n.value,afterGetRowHeader:o.value,afterOnCellMouseDown:i.value,manualRowMove:!0,readOnly:!0,licenseKey:"non-commercial-and-evaluation",viewportRowRenderingOffset:5,viewportColumnRenderingOffset:5},{default:cn(()=>[e.tableOptions.tableName=="one"?(fa(),Jl(ng,{key:0},[Je(ft(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),Je(ft(At),{data:"Code"}),Je(ft(At),{data:"Name"}),Je(ft(At),{data:"Duration(Old)"}),Je(ft(At),{data:"Duration(New)"}),Je(ft(At),{data:"Ratio"})],64)):Rb("",!0),e.tableOptions.tableName=="two"?(fa(),Jl(ng,{key:1},[Je(ft(At),{data:"ID",style:{display:"flex","justify-content":"center"}}),Je(ft(At),{data:"Code"}),Je(ft(At),{data:"Type"}),Je(ft(At),{data:"Name"}),Je(ft(At),{data:"Distribution(Min)"}),Je(ft(At),{data:"Distribution(Max)"}),Je(ft(At),{data:"Span"})],64)):Rb("",!0),e.tableOptions.tableName=="three"?(fa(),Jl(ng,{key:2},[Je(ft(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),Je(ft(At),{data:"Task Code"}),Je(ft(At),{data:"Resource Name"}),Je(ft(At),{data:"Task Name"}),Je(ft(At),{data:"Duration(Old)"}),Je(ft(At),{data:"Duration(New)"}),Je(ft(At),{data:"UnitsPerHour(Old)"}),Je(ft(At),{data:"UnitsPerHour(New)"}),Je(ft(At),{data:"Total Planned Units"})],64)):Rb("",!0)]),_:1},8,["data","colWidths","colHeaders","afterGetColHeader","beforeRenderer","afterGetRowHeader","afterOnCellMouseDown"]))}};const N3e=e=>(Tj("data-v-43c7b59a"),e=e(),Pj(),e),H3e={class:"content"},L3e=N3e(()=>mt("div",{id:"luckysheets"},null,-1)),j3e={id:"tip"},F3e={__name:"Lucksheettable",props:{url:Object},setup(e){const t=Rj();async function r(){t.SummaryData.group=="baseline"&&(t.SummaryData.group="Balanced");let s=`${t.SummaryData.group}-${t.file.name.split(".")[0]}_FrontlineExport.${t.file.name.split(".")[1]}`;return await og.getUrl(s,t.truefile)}function n(s,u){const f=[];for(let c=0;c<s.length;c+=u)f.push(s.slice(c,c+u));return f}function o(s,u){if(u<s.length){let f=[...s[u]],c=`A${u*f.length+1}:BH${(u+1)*f.length}`;luckysheet.setRangeValue(f,{range:c}),i.value=!1,setTimeout(()=>{o(s,u+1)},300)}}Ej(async()=>{const s=await r(),u="test";i.value=!0,setTimeout(()=>{pY.transformExcelToLuckyByUrl(s,u,(f,c)=>{var v;if(f.sheets==null||f.sheets.length==0){alert("Failed to read the content of the excel file, currently does not support xls files!");return}a.value=f,bY((v=window==null?void 0:window.luckysheet)==null?void 0:v.destroy)&&window.luckysheet.destroy();let h=f.sheets[0].celldata;h=window.luckysheet.transToData(h);let d=n(h,1e3);f.sheets[0].celldata=[],f.sheets[0].row=h.length,luckysheet.create({container:"luckysheets",showinfobar:!1,data:f.sheets,title:f.info.name,userInfo:f.info.name.creator,editable:!1}),o(d,0)})},0)});const i=fo(!1);fo("");const a=fo({});let l;return cY(i,()=>{i.value===!0?l=OY.service({lock:!0,text:"å è½½ä¸­",background:"rgba(0, 0, 0, 0.7)"}):l.close()},{deep:!0}),(s,u)=>(fa(),Jl("div",H3e,[L3e,mj(mt("div",j3e,"Loading...",512),[[pj,i.value]])]))}},B3e=Oj(F3e,[["__scopeId","data-v-43c7b59a"]]);const V3e=e=>(Tj("data-v-fb8a0d5c"),e=e(),Pj(),e),W3e={class:"optimize-content"},U3e={class:"content-row"},z3e={style:{"text-transform":"capitalize",color:"rgba(130, 181, 199, 0.9)"}},G3e={class:"chip primary"},Y3e={class:"chip primary"},K3e={class:"content-box"},q3e=V3e(()=>mt("h3",null,"Online Excel",-1)),X3e={class:"sheet"},Z3e={class:"content-box"},Q3e={class:"sub-content"},J3e={class:"content-row"},eKe=gY('<div class="legend" data-v-fb8a0d5c><div style="display:flex;justify-content:flex-start;align-items:center;margin-right:10px;" data-v-fb8a0d5c><div class="circle critical" data-v-fb8a0d5c></div> Critical </div><div style="display:flex;justify-content:flex-start;align-items:center;" data-v-fb8a0d5c><div class="circle" data-v-fb8a0d5c></div> Non-Critical </div></div>',1),tKe={class:"table"},rKe={class:"sub-content"},nKe={class:"content-row"},oKe={class:"table"},iKe={class:"sub-content"},aKe={class:"content-row"},lKe={class:"table"},sKe={class:"content-row"},uKe={__name:"optimizedReport",setup(e){let t=fo(!1);function r(){t.value=!1}fo(!1);function n(){i.value=!1}const o=Rj();hY(()=>{}),Ej(()=>{});let i=fo(!1);function a(){o.loginStatus===!0?i.value=!0:(t.value=!1,mY({showClose:!0,message:"Restricted to logged-in users only.",type:"error"}),t.value=!0)}const l=dY();function s(){o.SummaryData.group=="baseline"&&(o.SummaryData.group="Balanced");let _=`${o.SummaryData.group}-${o.file.name.split(".")[0]}_FrontlineExport.${o.file.name.split(".")[1]}`;og.getProjectReport(_,o.truefile)}let u=fo({});async function f(){o.SummaryData.group=="baseline"&&(o.SummaryData.group="Balanced");let _=`${o.SummaryData.group}-${o.file.name.split(".")[0]}_FrontlineExport.${o.file.name.split(".")[1]}`;return await og.getUrl(_,o.truefile)}function c(){o.SummaryData.group=="baseline"&&(o.SummaryData.group="Balanced");let _=`${o.SummaryData.group}-${o.file.name.split(".")[0]}_FrontlineExport.${o.file.name.split(".")[1]}`;og.getExcelReport(_,o.truefile)}function h(){l.push({name:"optimizedSummary"}),o.active=2}vY((_,D)=>{_.name=="InputData"});function d(D){if(!D)return"0.00";var D=Math.round(parseFloat(D)*100)/100,V=D.toString().split(".");if(V.length==1)return D=D.toString()+".00",D;if(V.length>1)return V[1].length<2&&(D=D.toString()+"0"),D}function v(D){if(!D)return"0.0";var D=Math.round(parseFloat(D)*10)/10,V=D.toString().split(".");return V.length==1&&(D=D.toString()+".0"),D}let y=o.selectedData.tasks.filter(_=>_.durationRatio!==1).map(_=>(_.critical?_.critical=!0:_.critical=!1,{Critical:_.critical,Code:_.ID,Name:_.name,"Duration(Old)":v(_.remainingDuration),"Duration(New)":v(_.newDuration),Ratio:d(_.durationRatio)})),p=o.selectedData.newResources.map(_=>({ID:_.id,Code:_.ID,Type:_.type,Name:_.name,"Distribution(Min)":v(_.distribution.min),"Distribution(Max)":d(_.distribution.max),Span:d(_.distribution.span)})),w=aa(()=>o.selectedData.tasks.filter(V=>Object.keys(V.resources).length!==0).flatMap(V=>{let X=Object.values(V.resources),G=o.selectedData.tasks.find(q=>q.id==V.id);return X.map(q=>{var Q;return{Critical:G.critical,"Task Code":G.ID,"Resource Name":(Q=o.selectedData.newResources.find(ne=>ne.id==q.resourceId))==null?void 0:Q.name,"Task Name":G.name,"Duration(Old)":v(G.plannedDuration),"Duration(New)":v(G.newDuration),"UnitsPerHour(Old)":d(q.plannedUnitsPerHour),"UnitsPerHour(New)":d(Number(q.newUnitsPerHour)),"Total Planned Units":d(G.plannedDuration*q.plannedUnitsPerHour)}})}));const S=Sc({data:y,colWidths:[100,245,250,250,250,250],colHeaders:["Critical","Code","Name","Duration(Old)","Duration(New)","Ratio"],tableName:"one"}),C=Sc({data:p,colWidths:[100,245,250,250,250,250,250,100],colHeaders:["ID","Code","Type","Name","Distribution(Min)","Distribution(Max)","Span"],tableName:"two"}),k=Sc({data:w.value,colWidths:[100,245,250,150,150,150,150,150,150],colHeaders:["Critical","Task Code","Resource Name","Task Name","Duration(Old)","Duration(New)","UnitsPerHour(Old)","UnitsPerHour(New)","Total Planned Units"],tableName:"three"});return Sc({data:w.value,colWidths:[100,245,250,150,150,150,150,150,150],colHeaders:["Resource Name","Estimated Quantity/Area (Unit)","Estimated Unit Price (Unit)","Estimated Total Cost (Unit)","Actual Quantity/Area (Unit)","Actual Unit Price (Unit)","Actual Total Cost (Unit)"],tableName:"three"}),(_,D)=>{const V=Wf("v-btn"),X=Wf("v-card-text"),G=Wf("v-card-actions"),q=Wf("v-card"),Q=Wf("v-dialog");return fa(),Jl(ng,null,[mt("div",W3e,[mt("div",U3e,[mt("h2",null,[Bi(an(_.$t("optimizedReport.title[0]"))+"Â  ",1),mt("span",z3e,an(ft(o).SummaryData.group.replace("_"," ")),1),mt("div",G3e,[mt("small",null,an(ft(o).setting.Steps)+" "+an(_.$t("optimizedReport.title[1]")),1)]),mt("div",Y3e,[mt("small",null,an(`${ft(o).setting.Ratio[0]*100}% - ${ft(o).setting.Ratio[1]*100}% ${_.$t("optimizedReport.title[2]")}`),1)])]),Je(V,{onClick:a,class:"row-btn"},{default:cn(()=>[Bi(an(_.$t("optimizedReport.btn[1]")),1)]),_:1})]),mt("div",K3e,[q3e,mt("div",X3e,[Je(B3e,{onGetUrl:f,url:ft(u)},null,8,["url"])])]),mt("div",Z3e,[mt("div",Q3e,[mt("div",J3e,[mt("h3",null,an(_.$t("optimizedReport.tableName[0]")),1)]),eKe,mt("div",tKe,[Je(sC,{tableOptions:S},null,8,["tableOptions"])])]),mt("div",rKe,[mt("div",nKe,[mt("h3",null,an(_.$t("optimizedReport.tableName[1]")),1)]),mt("div",oKe,[Je(sC,{tableOptions:C},null,8,["tableOptions"])])]),mt("div",iKe,[mt("div",aKe,[mt("h3",null,an(_.$t("optimizedReport.tableName[2]")),1)]),mt("div",lKe,[Je(sC,{tableOptions:k},null,8,["tableOptions"])])])]),mt("div",sKe,[Je(V,{onClick:h,class:"back"},{default:cn(()=>[Bi(an(_.$t("optimizedReport.btn[0]")),1)]),_:1}),Je(V,{onClick:a,class:"report"},{default:cn(()=>[Bi(an(_.$t("optimizedReport.btn[1]")),1)]),_:1})]),Je(Q,{onClose:n,modelValue:ft(i),"onUpdate:modelValue":D[2]||(D[2]=ne=>Cj(i)?i.value=ne:i=ne),width:"auto"},{default:cn(()=>[Je(q,{style:{"border-radius":"50px",width:"400px"}},{default:cn(()=>[Je(X,{style:{"text-align":"center"}},{default:cn(()=>[Bi(" Export Optimized File ")]),_:1}),Je(G,{style:{"justify-content":"center"}},{default:cn(()=>[Je(V,{color:"rgb(64, 170, 151)",onClick:D[0]||(D[0]=()=>{s()})},{default:cn(()=>[Bi(" Original Format ")]),_:1}),Je(V,{color:"rgb(64, 170, 151)",onClick:D[1]||(D[1]=()=>{c()})},{default:cn(()=>[Bi(" EXCEL ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),Je(yY,{onClose:r,dialogVisible:ft(t)},null,8,["dialogVisible"])],64)}}},yKe=Oj(uKe,[["__scopeId","data-v-fb8a0d5c"]]);export{yKe as default};
