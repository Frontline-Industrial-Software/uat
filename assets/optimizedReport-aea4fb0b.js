import{b6 as Qy,b7 as LY,b8 as lj,p as sj,b9 as jY,v as ua,w as Ql,y as FY,s as ia,b5 as BY,B as VY,C as Dn,ar as mb,D as Je,A as ct,H as bb,aW as uj,a0 as fj,$ as Rc,X as WY,Y as UY,x as bt,aX as cj,aY as hj,aQ as zY,ba as YY,aZ as GY,b4 as KY,R as wb,ap as Ff,aU as Fi,Z as an,b1 as Sb,bb as qY}from"./index-2f9623ee.js";import{c as Uv,L as XY,i as ZY}from"./luckyexcel.umd-3832a1f3.js";import"./index-f7adadce.js";import{a as Cb}from"./index-840e8203.js";import"./index.min-71e4b107.js";var je=function(e){try{return!!e()}catch{return!0}},QY=je,Xd=!QY(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),dj=Xd,vj=Function.prototype,aC=vj.call,JY=dj&&vj.bind.bind(aC,aC),Ye=dj?JY:function(e){return function(){return aC.apply(e,arguments)}},yj=Ye,eG=yj({}.toString),tG=yj("".slice),Un=function(e){return tG(eG(e),8,-1)},rG=Ye,nG=je,oG=Un,_b=Object,iG=rG("".split),Zd=nG(function(){return!_b("z").propertyIsEnumerable(0)})?function(e){return oG(e)=="String"?iG(e,""):_b(e)}:_b,_n=function(e){return e==null},aG=_n,lG=TypeError,Ar=function(e){if(aG(e))throw lG("Can't call method on "+e);return e},sG=Zd,uG=Ar,zr=function(e){return sG(uG(e))},zv=function(e){return e&&e.Math==Math&&e},vt=zv(typeof globalThis=="object"&&globalThis)||zv(typeof window=="object"&&window)||zv(typeof self=="object"&&self)||zv(typeof Qy=="object"&&Qy)||function(){return this}()||Qy||Function("return this")(),gj={exports:{}},fG=!1,yk=vt,cG=Object.defineProperty,l0=function(e,t){try{cG(yk,e,{value:t,configurable:!0,writable:!0})}catch{yk[e]=t}return t},hG=vt,dG=l0,gk="__core-js_shared__",vG=hG[gk]||dG(gk,{}),s0=vG,pk=s0;(gj.exports=function(e,t){return pk[e]||(pk[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.0",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Cf=gj.exports,yG=Ar,gG=Object,Ir=function(e){return gG(yG(e))},pG=Ye,mG=Ir,bG=pG({}.hasOwnProperty),Nt=Object.hasOwn||function(t,r){return bG(mG(t),r)},wG=Ye,SG=0,CG=Math.random(),_G=wG(1 .toString),om=function(e){return"Symbol("+(e===void 0?"":e)+")_"+_G(++SG+CG,36)},el=typeof navigator<"u"&&String(navigator.userAgent)||"",pj=vt,Ob=el,mk=pj.process,bk=pj.Deno,wk=mk&&mk.versions||bk&&bk.version,Sk=wk&&wk.v8,dn,Bg;Sk&&(dn=Sk.split("."),Bg=dn[0]>0&&dn[0]<4?1:+(dn[0]+dn[1]));!Bg&&Ob&&(dn=Ob.match(/Edge\/(\d+)/),(!dn||dn[1]>=74)&&(dn=Ob.match(/Chrome\/(\d+)/),dn&&(Bg=+dn[1])));var Qd=Bg,Ck=Qd,OG=je,RG=vt,EG=RG.String,_f=!!Object.getOwnPropertySymbols&&!OG(function(){var e=Symbol();return!EG(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ck&&Ck<41}),TG=_f,mj=TG&&!Symbol.sham&&typeof Symbol.iterator=="symbol",PG=vt,kG=Cf,_k=Nt,$G=om,AG=_f,IG=mj,Gl=PG.Symbol,Rb=kG("wks"),MG=IG?Gl.for||Gl:Gl&&Gl.withoutSetter||$G,St=function(e){return _k(Rb,e)||(Rb[e]=AG&&_k(Gl,e)?Gl[e]:MG("Symbol."+e)),Rb[e]},lC=typeof document=="object"&&document.all,xG=typeof lC>"u"&&lC!==void 0,bj={all:lC,IS_HTMLDDA:xG},wj=bj,DG=wj.all,Rt=wj.IS_HTMLDDA?function(e){return typeof e=="function"||e===DG}:function(e){return typeof e=="function"},Ok=Rt,Sj=bj,NG=Sj.all,Yt=Sj.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Ok(e)||e===NG}:function(e){return typeof e=="object"?e!==null:Ok(e)},HG=Yt,LG=String,jG=TypeError,jt=function(e){if(HG(e))return e;throw jG(LG(e)+" is not an object")},u0={},FG=je,Gt=!FG(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),BG=Gt,VG=je,Cj=BG&&VG(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),_r={},WG=vt,Rk=Yt,sC=WG.document,UG=Rk(sC)&&Rk(sC.createElement),im=function(e){return UG?sC.createElement(e):{}},zG=Gt,YG=je,GG=im,_j=!zG&&!YG(function(){return Object.defineProperty(GG("div"),"a",{get:function(){return 7}}).a!=7}),KG=Xd,Yv=Function.prototype.call,Zt=KG?Yv.bind(Yv):function(){return Yv.apply(Yv,arguments)},Eb=vt,qG=Rt,XG=function(e){return qG(e)?e:void 0},Uo=function(e,t){return arguments.length<2?XG(Eb[e]):Eb[e]&&Eb[e][t]},ZG=Ye,Di=ZG({}.isPrototypeOf),QG=Uo,JG=Rt,e3=Di,t3=mj,r3=Object,Jd=t3?function(e){return typeof e=="symbol"}:function(e){var t=QG("Symbol");return JG(t)&&e3(t.prototype,r3(e))},n3=String,Of=function(e){try{return n3(e)}catch{return"Object"}},o3=Rt,i3=Of,a3=TypeError,tl=function(e){if(o3(e))return e;throw a3(i3(e)+" is not a function")},l3=tl,s3=_n,rl=function(e,t){var r=e[t];return s3(r)?void 0:l3(r)},Tb=Zt,Pb=Rt,kb=Yt,u3=TypeError,Oj=function(e,t){var r,n;if(t==="string"&&Pb(r=e.toString)&&!kb(n=Tb(r,e))||Pb(r=e.valueOf)&&!kb(n=Tb(r,e))||t!=="string"&&Pb(r=e.toString)&&!kb(n=Tb(r,e)))return n;throw u3("Can't convert object to primitive value")},f3=Zt,Ek=Yt,Tk=Jd,c3=rl,h3=Oj,d3=St,v3=TypeError,y3=d3("toPrimitive"),Rj=function(e,t){if(!Ek(e)||Tk(e))return e;var r=c3(e,y3),n;if(r){if(t===void 0&&(t="default"),n=f3(r,e,t),!Ek(n)||Tk(n))return n;throw v3("Can't convert object to primitive value")}return t===void 0&&(t="number"),h3(e,t)},g3=Rj,p3=Jd,am=function(e){var t=g3(e,"string");return p3(t)?t:t+""},m3=Gt,b3=_j,w3=Cj,Gv=jt,Pk=am,S3=TypeError,$b=Object.defineProperty,C3=Object.getOwnPropertyDescriptor,Ab="enumerable",Ib="configurable",Mb="writable";_r.f=m3?w3?function(t,r,n){if(Gv(t),r=Pk(r),Gv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Mb in n&&!n[Mb]){var o=C3(t,r);o&&o[Mb]&&(t[r]=n.value,n={configurable:Ib in n?n[Ib]:o[Ib],enumerable:Ab in n?n[Ab]:o[Ab],writable:!1})}return $b(t,r,n)}:$b:function(t,r,n){if(Gv(t),r=Pk(r),Gv(n),b3)try{return $b(t,r,n)}catch{}if("get"in n||"set"in n)throw S3("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var _3=Math.ceil,O3=Math.floor,R3=Math.trunc||function(t){var r=+t;return(r>0?O3:_3)(r)},E3=R3,Ni=function(e){var t=+e;return t!==t||t===0?0:E3(t)},T3=Ni,P3=Math.max,k3=Math.min,ev=function(e,t){var r=T3(e);return r<0?P3(r+t,0):k3(r,t)},$3=Ni,A3=Math.min,nl=function(e){return e>0?A3($3(e),9007199254740991):0},I3=nl,en=function(e){return I3(e.length)},M3=zr,x3=ev,D3=en,kk=function(e){return function(t,r,n){var o=M3(t),i=D3(o),a=x3(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},f0={includes:kk(!0),indexOf:kk(!1)},tv={},N3=Ye,xb=Nt,H3=zr,L3=f0.indexOf,j3=tv,$k=N3([].push),Ej=function(e,t){var r=H3(e),n=0,o=[],i;for(i in r)!xb(j3,i)&&xb(r,i)&&$k(o,i);for(;t.length>n;)xb(r,i=t[n++])&&(~L3(o,i)||$k(o,i));return o},c0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],F3=Ej,B3=c0,rv=Object.keys||function(t){return F3(t,B3)},V3=Gt,W3=Cj,U3=_r,z3=jt,Y3=zr,G3=rv;u0.f=V3&&!W3?Object.defineProperties:function(t,r){z3(t);for(var n=Y3(r),o=G3(r),i=o.length,a=0,l;i>a;)U3.f(t,l=o[a++],n[l]);return t};var K3=Uo,Tj=K3("document","documentElement"),q3=Cf,X3=om,Ak=q3("keys"),lm=function(e){return Ak[e]||(Ak[e]=X3(e))},Z3=jt,Q3=u0,Ik=c0,J3=tv,eK=Tj,tK=im,rK=lm,Mk=">",xk="<",uC="prototype",fC="script",Pj=rK("IE_PROTO"),Db=function(){},kj=function(e){return xk+fC+Mk+e+xk+"/"+fC+Mk},Dk=function(e){e.write(kj("")),e.close();var t=e.parentWindow.Object;return e=null,t},nK=function(){var e=tK("iframe"),t="java"+fC+":",r;return e.style.display="none",eK.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(kj("document.F=Object")),r.close(),r.F},Kv,Jy=function(){try{Kv=new ActiveXObject("htmlfile")}catch{}Jy=typeof document<"u"?document.domain&&Kv?Dk(Kv):nK():Dk(Kv);for(var e=Ik.length;e--;)delete Jy[uC][Ik[e]];return Jy()};J3[Pj]=!0;var Rf=Object.create||function(t,r){var n;return t!==null?(Db[uC]=Z3(t),n=new Db,Db[uC]=null,n[Pj]=t):n=Jy(),r===void 0?n:Q3.f(n,r)},oK=St,iK=Rf,aK=_r.f,cC=oK("unscopables"),hC=Array.prototype;hC[cC]==null&&aK(hC,cC,{configurable:!0,value:iK(null)});var nv=function(e){hC[cC][e]=!0},ov={},lK=vt,sK=Rt,Nk=lK.WeakMap,$j=sK(Nk)&&/native code/.test(String(Nk)),iv=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},uK=Gt,fK=_r,cK=iv,ol=uK?function(e,t,r){return fK.f(e,t,cK(1,r))}:function(e,t,r){return e[t]=r,e},hK=$j,Aj=vt,dK=Yt,vK=ol,Nb=Nt,Hb=s0,yK=lm,gK=tv,Hk="Object already initialized",dC=Aj.TypeError,pK=Aj.WeakMap,Vg,Wc,Wg,mK=function(e){return Wg(e)?Wc(e):Vg(e,{})},bK=function(e){return function(t){var r;if(!dK(t)||(r=Wc(t)).type!==e)throw dC("Incompatible receiver, "+e+" required");return r}};if(hK||Hb.state){var Rn=Hb.state||(Hb.state=new pK);Rn.get=Rn.get,Rn.has=Rn.has,Rn.set=Rn.set,Vg=function(e,t){if(Rn.has(e))throw dC(Hk);return t.facade=e,Rn.set(e,t),t},Wc=function(e){return Rn.get(e)||{}},Wg=function(e){return Rn.has(e)}}else{var dl=yK("state");gK[dl]=!0,Vg=function(e,t){if(Nb(e,dl))throw dC(Hk);return t.facade=e,vK(e,dl,t),t},Wc=function(e){return Nb(e,dl)?e[dl]:{}},Wg=function(e){return Nb(e,dl)}}var zo={set:Vg,get:Wc,has:Wg,enforce:mK,getterFor:bK},zn={},av={},Ij={}.propertyIsEnumerable,Mj=Object.getOwnPropertyDescriptor,wK=Mj&&!Ij.call({1:2},1);av.f=wK?function(t){var r=Mj(this,t);return!!r&&r.enumerable}:Ij;var SK=Gt,CK=Zt,_K=av,OK=iv,RK=zr,EK=am,TK=Nt,PK=_j,Lk=Object.getOwnPropertyDescriptor;zn.f=SK?Lk:function(t,r){if(t=RK(t),r=EK(r),PK)try{return Lk(t,r)}catch{}if(TK(t,r))return OK(!CK(_K.f,t,r),t[r])};var xj={exports:{}},vC=Gt,kK=Nt,Dj=Function.prototype,$K=vC&&Object.getOwnPropertyDescriptor,h0=kK(Dj,"name"),AK=h0&&function(){}.name==="something",IK=h0&&(!vC||vC&&$K(Dj,"name").configurable),lv={EXISTS:h0,PROPER:AK,CONFIGURABLE:IK},MK=Ye,xK=Rt,yC=s0,DK=MK(Function.toString);xK(yC.inspectSource)||(yC.inspectSource=function(e){return DK(e)});var Nj=yC.inspectSource,d0=Ye,NK=je,HK=Rt,qv=Nt,gC=Gt,LK=lv.CONFIGURABLE,jK=Nj,Hj=zo,FK=Hj.enforce,BK=Hj.get,jk=String,eg=Object.defineProperty,VK=d0("".slice),WK=d0("".replace),UK=d0([].join),zK=gC&&!NK(function(){return eg(function(){},"length",{value:8}).length!==8}),YK=String(String).split("String"),GK=xj.exports=function(e,t,r){VK(jk(t),0,7)==="Symbol("&&(t="["+WK(jk(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!qv(e,"name")||LK&&e.name!==t)&&(gC?eg(e,"name",{value:t,configurable:!0}):e.name=t),zK&&r&&qv(r,"arity")&&e.length!==r.arity&&eg(e,"length",{value:r.arity});try{r&&qv(r,"constructor")&&r.constructor?gC&&eg(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=FK(e);return qv(n,"source")||(n.source=UK(YK,typeof t=="string"?t:"")),e};Function.prototype.toString=GK(function(){return HK(this)&&BK(this).source||jK(this)},"toString");var Lj=xj.exports,KK=Rt,qK=_r,XK=Lj,ZK=l0,tn=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(KK(r)&&XK(r,i,n),n.global)o?e[t]=r:ZK(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:qK.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},il={},QK=Ej,JK=c0,e4=JK.concat("length","prototype");il.f=Object.getOwnPropertyNames||function(t){return QK(t,e4)};var sv={};sv.f=Object.getOwnPropertySymbols;var t4=Uo,r4=Ye,n4=il,o4=sv,i4=jt,a4=r4([].concat),jj=t4("Reflect","ownKeys")||function(t){var r=n4.f(i4(t)),n=o4.f;return n?a4(r,n(t)):r},Fk=Nt,l4=jj,s4=zn,u4=_r,Fj=function(e,t,r){for(var n=l4(t),o=u4.f,i=s4.f,a=0;a<n.length;a++){var l=n[a];!Fk(e,l)&&!(r&&Fk(r,l))&&o(e,l,i(t,l))}},f4=je,c4=Rt,h4=/#|\.prototype\./,uv=function(e,t){var r=v4[d4(e)];return r==g4?!0:r==y4?!1:c4(t)?f4(t):!!t},d4=uv.normalize=function(e){return String(e).replace(h4,".").toLowerCase()},v4=uv.data={},y4=uv.NATIVE="N",g4=uv.POLYFILL="P",sm=uv,Lb=vt,p4=zn.f,m4=ol,b4=tn,w4=l0,S4=Fj,C4=sm,$e=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Lb:o?a=Lb[r]||w4(r,{}):a=(Lb[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=p4(a,l),s=f&&f.value):s=a[l],i=C4(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;S4(u,s)}(e.sham||s&&s.sham)&&m4(u,"sham",!0),b4(a,l,u,e)}},_4=je,Bj=!_4(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),O4=Nt,R4=Rt,E4=Ir,T4=lm,P4=Bj,Bk=T4("IE_PROTO"),pC=Object,k4=pC.prototype,fv=P4?pC.getPrototypeOf:function(e){var t=E4(e);if(O4(t,Bk))return t[Bk];var r=t.constructor;return R4(r)&&t instanceof r?r.prototype:t instanceof pC?k4:null},$4=je,A4=Rt,I4=Yt,Vk=fv,M4=tn,x4=St,mC=x4("iterator"),Vj=!1,Fa,jb,Fb;[].keys&&(Fb=[].keys(),"next"in Fb?(jb=Vk(Vk(Fb)),jb!==Object.prototype&&(Fa=jb)):Vj=!0);var D4=!I4(Fa)||$4(function(){var e={};return Fa[mC].call(e)!==e});D4&&(Fa={});A4(Fa[mC])||M4(Fa,mC,function(){return this});var Wj={IteratorPrototype:Fa,BUGGY_SAFARI_ITERATORS:Vj},N4=_r.f,H4=Nt,L4=St,Wk=L4("toStringTag"),um=function(e,t,r){e&&!r&&(e=e.prototype),e&&!H4(e,Wk)&&N4(e,Wk,{configurable:!0,value:t})},j4=Wj.IteratorPrototype,F4=Rf,B4=iv,V4=um,W4=ov,U4=function(){return this},z4=function(e,t,r,n){var o=t+" Iterator";return e.prototype=F4(j4,{next:B4(+!n,r)}),V4(e,o,!1),W4[o]=U4,e},Y4=Ye,G4=tl,K4=function(e,t,r){try{return Y4(G4(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},q4=Rt,X4=String,Z4=TypeError,Q4=function(e){if(typeof e=="object"||q4(e))return e;throw Z4("Can't set "+X4(e)+" as a prototype")},J4=K4,e6=jt,t6=Q4,v0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=J4(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return e6(o),t6(i),e?r(o,i):o.__proto__=i,o}}():void 0),r6=$e,n6=Zt,Uj=lv,o6=Rt,i6=z4,Uk=fv,zk=v0,a6=um,l6=ol,Bb=tn,s6=St,u6=ov,zj=Wj,f6=Uj.PROPER,c6=Uj.CONFIGURABLE,Yk=zj.IteratorPrototype,Xv=zj.BUGGY_SAFARI_ITERATORS,Bf=s6("iterator"),Gk="keys",Vf="values",Kk="entries",h6=function(){return this},y0=function(e,t,r,n,o,i,a){i6(r,t,n);var l=function(b){if(b===o&&h)return h;if(!Xv&&b in f)return f[b];switch(b){case Gk:return function(){return new r(this,b)};case Vf:return function(){return new r(this,b)};case Kk:return function(){return new r(this,b)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Bf]||f["@@iterator"]||o&&f[o],h=!Xv&&c||l(o),d=t=="Array"&&f.entries||c,v,y,m;if(d&&(v=Uk(d.call(new e)),v!==Object.prototype&&v.next&&(Uk(v)!==Yk&&(zk?zk(v,Yk):o6(v[Bf])||Bb(v,Bf,h6)),a6(v,s,!0))),f6&&o==Vf&&c&&c.name!==Vf&&(c6?l6(f,"name",Vf):(u=!0,h=function(){return n6(c,this)})),o)if(y={values:l(Vf),keys:i?h:l(Gk),entries:l(Kk)},a)for(m in y)(Xv||u||!(m in f))&&Bb(f,m,y[m]);else r6({target:t,proto:!0,forced:Xv||u},y);return f[Bf]!==h&&Bb(f,Bf,h,{name:o}),u6[t]=h,y},g0=function(e,t){return{value:e,done:t}},d6=zr,p0=nv,qk=ov,Yj=zo,v6=_r.f,y6=y0,Zv=g0,g6=Gt,Gj="Array Iterator",p6=Yj.set,m6=Yj.getterFor(Gj),b6=y6(Array,"Array",function(e,t){p6(this,{type:Gj,target:d6(e),index:0,kind:t})},function(){var e=m6(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Zv(void 0,!0)):r=="keys"?Zv(n,!1):r=="values"?Zv(t[n],!1):Zv([n,t[n]],!1)},"values"),Xk=qk.Arguments=qk.Array;p0("keys");p0("values");p0("entries");if(g6&&Xk.name!=="values")try{v6(Xk,"name",{value:"values"})}catch{}var w6=St,S6=w6("toStringTag"),Kj={};Kj[S6]="z";var m0=String(Kj)==="[object z]",C6=m0,_6=Rt,tg=Un,O6=St,R6=O6("toStringTag"),E6=Object,T6=tg(function(){return arguments}())=="Arguments",P6=function(e,t){try{return e[t]}catch{}},fm=C6?tg:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=P6(t=E6(e),R6))=="string"?r:T6?tg(t):(n=tg(t))=="Object"&&_6(t.callee)?"Arguments":n},k6=m0,$6=fm,A6=k6?{}.toString:function(){return"[object "+$6(this)+"]"},I6=m0,M6=tn,x6=A6;I6||M6(Object.prototype,"toString",x6,{unsafe:!0});var D6=fm,N6=String,Kt=function(e){if(D6(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return N6(e)},b0=Ye,H6=Ni,L6=Kt,j6=Ar,F6=b0("".charAt),Zk=b0("".charCodeAt),B6=b0("".slice),Qk=function(e){return function(t,r){var n=L6(j6(t)),o=H6(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=Zk(n,o),a<55296||a>56319||o+1===i||(l=Zk(n,o+1))<56320||l>57343?e?F6(n,o):a:e?B6(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},w0={codeAt:Qk(!1),charAt:Qk(!0)},V6=w0.charAt,W6=Kt,qj=zo,U6=y0,Jk=g0,Xj="String Iterator",z6=qj.set,Y6=qj.getterFor(Xj);U6(String,"String",function(e){z6(this,{type:Xj,string:W6(e),index:0})},function(){var t=Y6(this),r=t.string,n=t.index,o;return n>=r.length?Jk(void 0,!0):(o=V6(r,n),t.index+=o.length,Jk(o,!1))});var G6=je,S0=!G6(function(){return Object.isExtensible(Object.preventExtensions({}))}),K6=tn,C0=function(e,t,r){for(var n in t)K6(e,n,t[n],r);return e},Zj={exports:{}},cm={},q6=am,X6=_r,Z6=iv,Ef=function(e,t,r){var n=q6(t);n in e?X6.f(e,n,Z6(0,r)):e[n]=r},e$=ev,Q6=en,J6=Ef,e8=Array,t8=Math.max,_0=function(e,t,r){for(var n=Q6(e),o=e$(t,n),i=e$(r===void 0?n:r,n),a=e8(t8(i-o,0)),l=0;o<i;o++,l++)J6(a,l,e[o]);return a.length=l,a},r8=Un,n8=zr,Qj=il.f,o8=_0,Jj=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i8=function(e){try{return Qj(e)}catch{return o8(Jj)}};cm.f=function(t){return Jj&&r8(t)=="Window"?i8(t):Qj(n8(t))};var a8=je,l8=a8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),s8=je,u8=Yt,f8=Un,t$=l8,rg=Object.isExtensible,c8=s8(function(){rg(1)}),h8=c8||t$?function(t){return!u8(t)||t$&&f8(t)=="ArrayBuffer"?!1:rg?rg(t):!0}:rg,d8=$e,v8=Ye,y8=tv,g8=Yt,O0=Nt,p8=_r.f,r$=il,m8=cm,R0=h8,b8=om,w8=S0,eF=!1,jo=b8("meta"),S8=0,E0=function(e){p8(e,jo,{value:{objectID:"O"+S8++,weakData:{}}})},C8=function(e,t){if(!g8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!O0(e,jo)){if(!R0(e))return"F";if(!t)return"E";E0(e)}return e[jo].objectID},_8=function(e,t){if(!O0(e,jo)){if(!R0(e))return!0;if(!t)return!1;E0(e)}return e[jo].weakData},O8=function(e){return w8&&eF&&R0(e)&&!O0(e,jo)&&E0(e),e},R8=function(){E8.enable=function(){},eF=!0;var e=r$.f,t=v8([].splice),r={};r[jo]=1,e(r).length&&(r$.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===jo){t(o,i,1);break}return o},d8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:m8.f}))},E8=Zj.exports={enable:R8,fastKey:C8,getWeakData:_8,onFreeze:O8};y8[jo]=!0;var cv=Zj.exports,T8=Un,P8=Ye,hv=function(e){if(T8(e)==="Function")return P8(e)},n$=hv,k8=tl,$8=Xd,A8=n$(n$.bind),dv=function(e,t){return k8(e),t===void 0?e:$8?A8(e,t):function(){return e.apply(t,arguments)}},I8=St,M8=ov,x8=I8("iterator"),D8=Array.prototype,tF=function(e){return e!==void 0&&(M8.Array===e||D8[x8]===e)},N8=fm,o$=rl,H8=_n,L8=ov,j8=St,F8=j8("iterator"),T0=function(e){if(!H8(e))return o$(e,F8)||o$(e,"@@iterator")||L8[N8(e)]},B8=Zt,V8=tl,W8=jt,U8=Of,z8=T0,Y8=TypeError,rF=function(e,t){var r=arguments.length<2?z8(e):t;if(V8(r))return W8(B8(r,e));throw Y8(U8(e)+" is not iterable")},G8=Zt,i$=jt,K8=rl,nF=function(e,t,r){var n,o;i$(e);try{if(n=K8(e,"return"),!n){if(t==="throw")throw r;return r}n=G8(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return i$(n),r},q8=dv,X8=Zt,Z8=jt,Q8=Of,J8=tF,e5=en,a$=Di,t5=rF,r5=T0,l$=nF,n5=TypeError,ng=function(e,t){this.stopped=e,this.result=t},s$=ng.prototype,P0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=q8(t,n),u,f,c,h,d,v,y,m=function(S){return u&&l$(u,"normal",S),new ng(!0,S)},b=function(S){return o?(Z8(S),l?s(S[0],S[1],m):s(S[0],S[1])):l?s(S,m):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=r5(e),!f)throw n5(Q8(e)+" is not iterable");if(J8(f)){for(c=0,h=e5(e);h>c;c++)if(d=b(e[c]),d&&a$(s$,d))return d;return new ng(!1)}u=t5(e,f)}for(v=i?e.next:u.next;!(y=X8(v,u)).done;){try{d=b(y.value)}catch(S){l$(u,"throw",S)}if(typeof d=="object"&&d&&a$(s$,d))return d}return new ng(!1)},o5=Di,i5=TypeError,k0=function(e,t){if(o5(t,e))return e;throw i5("Incorrect invocation")},a5=St,oF=a5("iterator"),iF=!1;try{var l5=0,u$={next:function(){return{done:!!l5++}},return:function(){iF=!0}};u$[oF]=function(){return this},Array.from(u$,function(){throw 2})}catch{}var aF=function(e,t){if(!t&&!iF)return!1;var r=!1;try{var n={};n[oF]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},s5=Rt,u5=Yt,f$=v0,$0=function(e,t,r){var n,o;return f$&&s5(n=t.constructor)&&n!==r&&u5(o=n.prototype)&&o!==r.prototype&&f$(e,o),e},f5=$e,c5=vt,h5=Ye,c$=sm,d5=tn,v5=cv,y5=P0,g5=k0,p5=Rt,m5=_n,Vb=Yt,Wb=je,b5=aF,w5=um,S5=$0,hm=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=c5[e],l=a&&a.prototype,s=a,u={},f=function(b){var S=h5(l[b]);d5(l,b,b=="add"?function(k){return S(this,k===0?0:k),this}:b=="delete"?function(C){return o&&!Vb(C)?!1:S(this,C===0?0:C)}:b=="get"?function(k){return o&&!Vb(k)?void 0:S(this,k===0?0:k)}:b=="has"?function(k){return o&&!Vb(k)?!1:S(this,k===0?0:k)}:function(k,O){return S(this,k===0?0:k,O),this})},c=c$(e,!p5(a)||!(o||l.forEach&&!Wb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),v5.enable();else if(c$(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=Wb(function(){h.has(1)}),y=b5(function(b){new a(b)}),m=!o&&Wb(function(){for(var b=new a,S=5;S--;)b[i](S,S);return!b.has(-0)});y||(s=t(function(b,S){g5(b,l);var C=S5(new a,b,s);return m5(S)||y5(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||m)&&(f("delete"),f("has"),n&&f("get")),(m||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,f5({global:!0,constructor:!0,forced:s!=a},u),w5(s,e),o||r.setStrong(s,e,n),s},C5=Un,Tf=Array.isArray||function(t){return C5(t)=="Array"},_5=Ye,O5=je,lF=Rt,R5=fm,E5=Uo,T5=Nj,sF=function(){},P5=[],uF=E5("Reflect","construct"),A0=/^\s*(?:class|function)\b/,k5=_5(A0.exec),$5=!A0.exec(sF),Wf=function(t){if(!lF(t))return!1;try{return uF(sF,P5,t),!0}catch{return!1}},fF=function(t){if(!lF(t))return!1;switch(R5(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return $5||!!k5(A0,T5(t))}catch{return!0}};fF.sham=!0;var dm=!uF||O5(function(){var e;return Wf(Wf.call)||!Wf(Object)||!Wf(function(){e=!0})||e})?fF:Wf,h$=Tf,A5=dm,I5=Yt,M5=St,x5=M5("species"),d$=Array,D5=function(e){var t;return h$(e)&&(t=e.constructor,A5(t)&&(t===d$||h$(t.prototype))?t=void 0:I5(t)&&(t=t[x5],t===null&&(t=void 0))),t===void 0?d$:t},N5=D5,I0=function(e,t){return new(N5(e))(t===0?0:t)},H5=dv,L5=Ye,j5=Zd,F5=Ir,B5=en,V5=I0,v$=L5([].push),Xo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,f,c){for(var h=F5(s),d=j5(h),v=H5(u,f),y=B5(d),m=0,b=c||V5,S=t?b(s,y):r||a?b(s,0):void 0,C,k;y>m;m++)if((l||m in d)&&(C=d[m],k=v(C,m,h),e))if(t)S[m]=k;else if(k)switch(e){case 3:return!0;case 5:return C;case 6:return m;case 2:v$(S,C)}else switch(e){case 4:return!1;case 7:v$(S,C)}return i?-1:n||o?o:S}},al={forEach:Xo(0),map:Xo(1),filter:Xo(2),some:Xo(3),every:Xo(4),find:Xo(5),findIndex:Xo(6),filterReject:Xo(7)},W5=Ye,y$=C0,Qv=cv.getWeakData,U5=k0,z5=jt,Y5=_n,Ub=Yt,G5=P0,cF=al,g$=Nt,hF=zo,K5=hF.set,q5=hF.getterFor,X5=cF.find,Z5=cF.findIndex,Q5=W5([].splice),J5=0,Jv=function(e){return e.frozen||(e.frozen=new dF)},dF=function(){this.entries=[]},zb=function(e,t){return X5(e.entries,function(r){return r[0]===t})};dF.prototype={get:function(e){var t=zb(this,e);if(t)return t[1]},has:function(e){return!!zb(this,e)},set:function(e,t){var r=zb(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=Z5(this.entries,function(r){return r[0]===e});return~t&&Q5(this.entries,t,1),!!~t}};var vF={getConstructor:function(e,t,r,n){var o=e(function(s,u){U5(s,i),K5(s,{type:t,id:J5++,frozen:void 0}),Y5(u)||G5(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=q5(t),l=function(s,u,f){var c=a(s),h=Qv(z5(u),!0);return h===!0?Jv(c).set(u,f):h[c.id]=f,s};return y$(i,{delete:function(s){var u=a(this);if(!Ub(s))return!1;var f=Qv(s);return f===!0?Jv(u).delete(s):f&&g$(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!Ub(u))return!1;var c=Qv(u);return c===!0?Jv(f).has(u):c&&g$(c,f.id)}}),y$(i,r?{get:function(u){var f=a(this);if(Ub(u)){var c=Qv(u);return c===!0?Jv(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},e7=S0,p$=vt,og=Ye,m$=C0,t7=cv,r7=hm,yF=vF,ey=Yt,ty=zo.enforce,n7=je,o7=$j,vv=Object,i7=Array.isArray,ry=vv.isExtensible,gF=vv.isFrozen,a7=vv.isSealed,pF=vv.freeze,l7=vv.seal,b$={},w$={},s7=!p$.ActiveXObject&&"ActiveXObject"in p$,Uf,mF=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},bF=r7("WeakMap",mF,yF),Wl=bF.prototype,ig=og(Wl.set),u7=function(){return e7&&n7(function(){var e=pF([]);return ig(new bF,e,1),!gF(e)})};if(o7)if(s7){Uf=yF.getConstructor(mF,"WeakMap",!0),t7.enable();var S$=og(Wl.delete),ny=og(Wl.has),C$=og(Wl.get);m$(Wl,{delete:function(e){if(ey(e)&&!ry(e)){var t=ty(this);return t.frozen||(t.frozen=new Uf),S$(this,e)||t.frozen.delete(e)}return S$(this,e)},has:function(t){if(ey(t)&&!ry(t)){var r=ty(this);return r.frozen||(r.frozen=new Uf),ny(this,t)||r.frozen.has(t)}return ny(this,t)},get:function(t){if(ey(t)&&!ry(t)){var r=ty(this);return r.frozen||(r.frozen=new Uf),ny(this,t)?C$(this,t):r.frozen.get(t)}return C$(this,t)},set:function(t,r){if(ey(t)&&!ry(t)){var n=ty(this);n.frozen||(n.frozen=new Uf),ny(this,t)?ig(this,t,r):n.frozen.set(t,r)}else ig(this,t,r);return this}})}else u7()&&m$(Wl,{set:function(t,r){var n;return i7(t)&&(gF(t)?n=b$:a7(t)&&(n=w$)),ig(this,t,r),n==b$&&pF(t),n==w$&&l7(t),this}});var wF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},f7=im,Yb=f7("span").classList,_$=Yb&&Yb.constructor&&Yb.constructor.prototype,SF=_$===Object.prototype?void 0:_$,O$=vt,CF=wF,c7=SF,mc=b6,Gb=ol,_F=St,Kb=_F("iterator"),R$=_F("toStringTag"),qb=mc.values,OF=function(e,t){if(e){if(e[Kb]!==qb)try{Gb(e,Kb,qb)}catch{e[Kb]=qb}if(e[R$]||Gb(e,R$,t),CF[t]){for(var r in mc)if(e[r]!==mc[r])try{Gb(e,r,mc[r])}catch{e[r]=mc[r]}}}};for(var Xb in CF)OF(O$[Xb]&&O$[Xb].prototype,Xb);OF(c7,"DOMTokenList");var h7=je,Pf=function(e,t){var r=[][e];return!!r&&h7(function(){r.call(null,t||function(){return 1},1)})},d7=$e,v7=hv,y7=f0.indexOf,g7=Pf,bC=v7([].indexOf),RF=!!bC&&1/bC([1],1,-0)<0,p7=RF||!g7("indexOf");d7({target:"Array",proto:!0,forced:p7},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return RF?bC(this,t,r)||0:y7(this,t,r)}});var E$=Of,m7=TypeError,EF=function(e,t){if(!delete e[t])throw m7("Cannot delete property "+E$(t)+" of "+E$(e))},T$=_0,b7=Math.floor,wC=function(e,t){var r=e.length,n=b7(r/2);return r<8?w7(e,t):S7(e,wC(T$(e,0,n),t),wC(T$(e,n),t),t)},w7=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},S7=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},C7=wC,_7=el,P$=_7.match(/firefox\/(\d+)/i),O7=!!P$&&+P$[1],R7=el,E7=/MSIE|Trident/.test(R7),T7=el,k$=T7.match(/AppleWebKit\/(\d+)\./),P7=!!k$&&+k$[1],k7=$e,TF=Ye,$7=tl,A7=Ir,$$=en,I7=EF,A$=Kt,M0=je,M7=C7,x7=Pf,I$=O7,D7=E7,M$=Qd,x$=P7,ci=[],D$=TF(ci.sort),N7=TF(ci.push),H7=M0(function(){ci.sort(void 0)}),L7=M0(function(){ci.sort(null)}),j7=x7("sort"),PF=!M0(function(){if(M$)return M$<70;if(!(I$&&I$>3)){if(D7)return!0;if(x$)return x$<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)ci.push({k:r+o,v:n})}for(ci.sort(function(i,a){return a.v-i.v}),o=0;o<ci.length;o++)r=ci[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),F7=H7||!L7||!j7||!PF,B7=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:A$(t)>A$(r)?1:-1}};k7({target:"Array",proto:!0,forced:F7},{sort:function(t){t!==void 0&&$7(t);var r=A7(this);if(PF)return t===void 0?D$(r):D$(r,t);var n=[],o=$$(r),i,a;for(a=0;a<o;a++)a in r&&N7(n,r[a]);for(M7(n,B7(t)),i=$$(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)I7(r,a++);return r}});var V7=$e,W7=al.find,U7=nv,SC="find",kF=!0;SC in[]&&Array(1)[SC](function(){kF=!1});V7({target:"Array",proto:!0,forced:kF},{find:function(t){return W7(this,t,arguments.length>1?arguments[1]:void 0)}});U7(SC);var z7=jt,$F=function(){var e=z7(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},x0=je,Y7=vt,D0=Y7.RegExp,N0=x0(function(){var e=D0("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),G7=N0||x0(function(){return!D0("a","y").sticky}),K7=N0||x0(function(){var e=D0("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),H0={BROKEN_CARET:K7,MISSED_STICKY:G7,UNSUPPORTED_Y:N0},q7=je,X7=vt,Z7=X7.RegExp,AF=q7(function(){var e=Z7(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),Q7=je,J7=vt,e9=J7.RegExp,IF=Q7(function(){var e=e9("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Kl=Zt,vm=Ye,t9=Kt,r9=$F,n9=H0,o9=Cf,i9=Rf,a9=zo.get,l9=AF,s9=IF,u9=o9("native-string-replace",String.prototype.replace),Ug=RegExp.prototype.exec,CC=Ug,f9=vm("".charAt),c9=vm("".indexOf),h9=vm("".replace),Zb=vm("".slice),_C=function(){var e=/a/,t=/b*/g;return Kl(Ug,e,"a"),Kl(Ug,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),MF=n9.BROKEN_CARET,OC=/()??/.exec("")[1]!==void 0,d9=_C||OC||MF||l9||s9;d9&&(CC=function(t){var r=this,n=a9(r),o=t9(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=Kl(CC,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=MF&&r.sticky,y=Kl(r9,r),m=r.source,b=0,S=o;if(v&&(y=h9(y,"y",""),c9(y,"g")===-1&&(y+="g"),S=Zb(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&f9(o,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",S=" "+S,b++),l=new RegExp("^(?:"+m+")",y)),OC&&(l=new RegExp("^"+m+"$(?!\\s)",y)),_C&&(s=r.lastIndex),u=Kl(Ug,v?l:r,S),v?u?(u.input=Zb(u.input,b),u[0]=Zb(u[0],b),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:_C&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),OC&&u&&u.length>1&&Kl(u9,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=i9(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var ym=CC,v9=$e,N$=ym;v9({target:"RegExp",proto:!0,forced:/./.exec!==N$},{exec:N$});var y9=Xd,xF=Function.prototype,H$=xF.apply,L$=xF.call,ll=typeof Reflect=="object"&&Reflect.apply||(y9?L$.bind(H$):function(){return L$.apply(H$,arguments)}),j$=hv,F$=tn,g9=ym,B$=je,DF=St,p9=ol,m9=DF("species"),Qb=RegExp.prototype,gm=function(e,t,r,n){var o=DF(e),i=!B$(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!B$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[m9]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=j$(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=j$(u),y=f.exec;return y===g9||y===Qb.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});F$(String.prototype,e,s[0]),F$(Qb,o,s[1])}n&&p9(Qb[o],"sham",!0)},b9=w0.charAt,L0=function(e,t,r){return t+(r?b9(e,t).length:1)},j0=Ye,w9=Ir,S9=Math.floor,Jb=j0("".charAt),C9=j0("".replace),ew=j0("".slice),_9=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,O9=/\$([$&'`]|\d{1,2})/g,R9=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=O9;return o!==void 0&&(o=w9(o),s=_9),C9(i,s,function(u,f){var c;switch(Jb(f,0)){case"$":return"$";case"&":return e;case"`":return ew(t,0,r);case"'":return ew(t,a);case"<":c=o[ew(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=S9(h/10);return d===0?u:d<=l?n[d-1]===void 0?Jb(f,1):n[d-1]+Jb(f,1):u}c=n[h-1]}return c===void 0?"":c})},V$=Zt,E9=jt,T9=Rt,P9=Un,k9=ym,$9=TypeError,pm=function(e,t){var r=e.exec;if(T9(r)){var n=V$(r,e,t);return n!==null&&E9(n),n}if(P9(e)==="RegExp")return V$(k9,e,t);throw $9("RegExp#exec called on incompatible receiver")},A9=ll,W$=Zt,mm=Ye,I9=gm,M9=je,x9=jt,D9=Rt,N9=_n,H9=Ni,L9=nl,vl=Kt,j9=Ar,F9=L0,B9=rl,V9=R9,W9=pm,U9=St,RC=U9("replace"),z9=Math.max,Y9=Math.min,G9=mm([].concat),tw=mm([].push),U$=mm("".indexOf),z$=mm("".slice),K9=function(e){return e===void 0?e:String(e)},q9=function(){return"a".replace(/./,"$0")==="$0"}(),Y$=function(){return/./[RC]?/./[RC]("a","$0")==="":!1}(),X9=!M9(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});I9("replace",function(e,t,r){var n=Y$?"$":"$0";return[function(i,a){var l=j9(this),s=N9(i)?void 0:B9(i,RC);return s?W$(s,i,l,a):W$(t,vl(l),i,a)},function(o,i){var a=x9(this),l=vl(o);if(typeof i=="string"&&U$(i,n)===-1&&U$(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=D9(i);u||(i=vl(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=W9(a,l);if(d===null||(tw(h,d),!f))break;var v=vl(d[0]);v===""&&(a.lastIndex=F9(l,L9(a.lastIndex),c))}for(var y="",m=0,b=0;b<h.length;b++){d=h[b];for(var S=vl(d[0]),C=z9(Y9(H9(d.index),l.length),0),k=[],O=1;O<d.length;O++)tw(k,K9(d[O]));var B=d.groups;if(u){var z=G9([S],k,C,l);B!==void 0&&tw(z,B);var q=vl(A9(i,void 0,z))}else q=V9(S,l,C,k,B,i);C>=m&&(y+=z$(l,m,C)+q,m=C+S.length)}return y+z$(l,m)}]},!X9||!q9||Y$);var Z9=je,Q9=St,J9=Qd,eq=Q9("species"),yv=function(e){return J9>=51||!Z9(function(){var t=[],r=t.constructor={};return r[eq]=function(){return{foo:1}},t[e](Boolean).foo!==1})},tq=$e,rq=al.filter,nq=yv,oq=nq("filter");tq({target:"Array",proto:!0,forced:!oq},{filter:function(t){return rq(this,t,arguments.length>1?arguments[1]:void 0)}});var iq=vt,NF=iq,F0={},aq=St;F0.f=aq;var G$=NF,lq=Nt,sq=F0,uq=_r.f,B0=function(e){var t=G$.Symbol||(G$.Symbol={});lq(t,e)||uq(t,e,{value:sq.f(e)})},fq=Zt,cq=Uo,hq=St,dq=tn,HF=function(){var e=cq("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=hq("toPrimitive");t&&!t[n]&&dq(t,n,function(o){return fq(r,this)},{arity:1})},vq=B0,yq=HF;vq("toPrimitive");yq();var gq=jt,pq=Oj,mq=TypeError,bq=function(e){if(gq(this),e==="string"||e==="default")e="string";else if(e!=="number")throw mq("Incorrect hint");return pq(this,e)},wq=Nt,Sq=tn,Cq=bq,_q=St,K$=_q("toPrimitive"),q$=Date.prototype;wq(q$,K$)||Sq(q$,K$,Cq);var X$=Lj,Oq=_r,gv=function(e,t,r){return r.get&&X$(r.get,t,{getter:!0}),r.set&&X$(r.set,t,{setter:!0}),Oq.f(e,t,r)},bm=$e,V0=vt,W0=Zt,Rq=Ye,vs=Gt,ys=_f,Eq=je,nr=Nt,Tq=Di,EC=jt,wm=zr,U0=am,Pq=Kt,TC=iv,Uc=Rf,LF=rv,kq=il,jF=cm,$q=sv,FF=zn,BF=_r,Aq=u0,VF=av,rw=tn,Iq=gv,z0=Cf,Mq=lm,WF=tv,Z$=om,xq=St,Dq=F0,Nq=B0,Hq=HF,Lq=um,UF=zo,Sm=al.forEach,$r=Mq("hidden"),Cm="Symbol",zc="prototype",jq=UF.set,Q$=UF.getterFor(Cm),Qr=Object[zc],Ha=V0.Symbol,bc=Ha&&Ha[zc],Fq=V0.TypeError,nw=V0.QObject,zF=FF.f,aa=BF.f,YF=jF.f,Bq=VF.f,GF=Rq([].push),Fo=z0("symbols"),pv=z0("op-symbols"),Vq=z0("wks"),PC=!nw||!nw[zc]||!nw[zc].findChild,kC=vs&&Eq(function(){return Uc(aa({},"a",{get:function(){return aa(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=zF(Qr,t);n&&delete Qr[t],aa(e,t,r),n&&e!==Qr&&aa(Qr,t,n)}:aa,ow=function(e,t){var r=Fo[e]=Uc(bc);return jq(r,{type:Cm,tag:e,description:t}),vs||(r.description=t),r},_m=function(t,r,n){t===Qr&&_m(pv,r,n),EC(t);var o=U0(r);return EC(n),nr(Fo,o)?(n.enumerable?(nr(t,$r)&&t[$r][o]&&(t[$r][o]=!1),n=Uc(n,{enumerable:TC(0,!1)})):(nr(t,$r)||aa(t,$r,TC(1,{})),t[$r][o]=!0),kC(t,o,n)):aa(t,o,n)},Y0=function(t,r){EC(t);var n=wm(r),o=LF(n).concat(XF(n));return Sm(o,function(i){(!vs||W0($C,n,i))&&_m(t,i,n[i])}),t},Wq=function(t,r){return r===void 0?Uc(t):Y0(Uc(t),r)},$C=function(t){var r=U0(t),n=W0(Bq,this,r);return this===Qr&&nr(Fo,r)&&!nr(pv,r)?!1:n||!nr(this,r)||!nr(Fo,r)||nr(this,$r)&&this[$r][r]?n:!0},KF=function(t,r){var n=wm(t),o=U0(r);if(!(n===Qr&&nr(Fo,o)&&!nr(pv,o))){var i=zF(n,o);return i&&nr(Fo,o)&&!(nr(n,$r)&&n[$r][o])&&(i.enumerable=!0),i}},qF=function(t){var r=YF(wm(t)),n=[];return Sm(r,function(o){!nr(Fo,o)&&!nr(WF,o)&&GF(n,o)}),n},XF=function(e){var t=e===Qr,r=YF(t?pv:wm(e)),n=[];return Sm(r,function(o){nr(Fo,o)&&(!t||nr(Qr,o))&&GF(n,Fo[o])}),n};ys||(Ha=function(){if(Tq(bc,this))throw Fq("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:Pq(arguments[0]),r=Z$(t),n=function(o){this===Qr&&W0(n,pv,o),nr(this,$r)&&nr(this[$r],r)&&(this[$r][r]=!1),kC(this,r,TC(1,o))};return vs&&PC&&kC(Qr,r,{configurable:!0,set:n}),ow(r,t)},bc=Ha[zc],rw(bc,"toString",function(){return Q$(this).tag}),rw(Ha,"withoutSetter",function(e){return ow(Z$(e),e)}),VF.f=$C,BF.f=_m,Aq.f=Y0,FF.f=KF,kq.f=jF.f=qF,$q.f=XF,Dq.f=function(e){return ow(xq(e),e)},vs&&(Iq(bc,"description",{configurable:!0,get:function(){return Q$(this).description}}),rw(Qr,"propertyIsEnumerable",$C,{unsafe:!0})));bm({global:!0,constructor:!0,wrap:!0,forced:!ys,sham:!ys},{Symbol:Ha});Sm(LF(Vq),function(e){Nq(e)});bm({target:Cm,stat:!0,forced:!ys},{useSetter:function(){PC=!0},useSimple:function(){PC=!1}});bm({target:"Object",stat:!0,forced:!ys,sham:!vs},{create:Wq,defineProperty:_m,defineProperties:Y0,getOwnPropertyDescriptor:KF});bm({target:"Object",stat:!0,forced:!ys},{getOwnPropertyNames:qF});Hq();Lq(Ha,Cm);WF[$r]=!0;var Uq=_f,ZF=Uq&&!!Symbol.for&&!!Symbol.keyFor,zq=$e,Yq=Uo,Gq=Nt,Kq=Kt,QF=Cf,qq=ZF,iw=QF("string-to-symbol-registry"),Xq=QF("symbol-to-string-registry");zq({target:"Symbol",stat:!0,forced:!qq},{for:function(e){var t=Kq(e);if(Gq(iw,t))return iw[t];var r=Yq("Symbol")(t);return iw[t]=r,Xq[r]=t,r}});var Zq=$e,Qq=Nt,Jq=Jd,eX=Of,tX=Cf,rX=ZF,J$=tX("symbol-to-string-registry");Zq({target:"Symbol",stat:!0,forced:!rX},{keyFor:function(t){if(!Jq(t))throw TypeError(eX(t)+" is not a symbol");if(Qq(J$,t))return J$[t]}});var nX=Ye,mv=nX([].slice),oX=Ye,e1=Tf,iX=Rt,t1=Un,aX=Kt,r1=oX([].push),lX=function(e){if(iX(e))return e;if(e1(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?r1(r,o):(typeof o=="number"||t1(o)=="Number"||t1(o)=="String")&&r1(r,aX(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(e1(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},sX=$e,JF=Uo,eB=ll,uX=Zt,bv=Ye,tB=je,n1=Rt,o1=Jd,rB=mv,fX=lX,cX=_f,hX=String,vi=JF("JSON","stringify"),oy=bv(/./.exec),i1=bv("".charAt),dX=bv("".charCodeAt),vX=bv("".replace),yX=bv(1 .toString),gX=/[\uD800-\uDFFF]/g,a1=/^[\uD800-\uDBFF]$/,l1=/^[\uDC00-\uDFFF]$/,s1=!cX||tB(function(){var e=JF("Symbol")();return vi([e])!="[null]"||vi({a:e})!="{}"||vi(Object(e))!="{}"}),u1=tB(function(){return vi("\uDF06\uD834")!=='"\\udf06\\ud834"'||vi("\uDEAD")!=='"\\udead"'}),pX=function(e,t){var r=rB(arguments),n=fX(t);if(!(!n1(n)&&(e===void 0||o1(e))))return r[1]=function(o,i){if(n1(n)&&(i=uX(n,this,hX(o),i)),!o1(i))return i},eB(vi,null,r)},mX=function(e,t,r){var n=i1(r,t-1),o=i1(r,t+1);return oy(a1,e)&&!oy(l1,o)||oy(l1,e)&&!oy(a1,n)?"\\u"+yX(dX(e,0),16):e};vi&&sX({target:"JSON",stat:!0,arity:3,forced:s1||u1},{stringify:function(t,r,n){var o=rB(arguments),i=eB(s1?pX:vi,null,o);return u1&&typeof i=="string"?vX(i,gX,mX):i}});var bX=$e,wX=_f,SX=je,nB=sv,CX=Ir,_X=!wX||SX(function(){nB.f(1)});bX({target:"Object",stat:!0,forced:_X},{getOwnPropertySymbols:function(t){var r=nB.f;return r?r(CX(t)):[]}});var OX=$e,RX=Gt,EX=vt,iy=Ye,TX=Nt,PX=Rt,kX=Di,$X=Kt,AX=gv,IX=Fj,io=EX.Symbol,Bi=io&&io.prototype;if(RX&&PX(io)&&(!("description"in Bi)||io().description!==void 0)){var f1={},ay=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:$X(arguments[0]),r=kX(Bi,this)?new io(t):t===void 0?io():io(t);return t===""&&(f1[r]=!0),r};IX(ay,io),ay.prototype=Bi,Bi.constructor=ay;var MX=String(io("test"))=="Symbol(test)",xX=iy(Bi.valueOf),DX=iy(Bi.toString),NX=/^Symbol\((.*)\)[^)]+$/,HX=iy("".replace),LX=iy("".slice);AX(Bi,"description",{configurable:!0,get:function(){var t=xX(this);if(TX(f1,t))return"";var r=DX(t),n=MX?LX(r,7,-1):HX(r,NX,"$1");return n===""?void 0:n}}),OX({global:!0,constructor:!0,forced:!0},{Symbol:ay})}var jX=Ye,oB=jX(1 .valueOf),iB=`	
\v\f\r                　\u2028\u2029\uFEFF`,FX=Ye,BX=Ar,VX=Kt,AC=iB,c1=FX("".replace),WX=RegExp("^["+AC+"]+"),UX=RegExp("(^|[^"+AC+"])["+AC+"]+$"),aw=function(e){return function(t){var r=VX(BX(t));return e&1&&(r=c1(r,WX,"")),e&2&&(r=c1(r,UX,"$1")),r}},aB={start:aw(1),end:aw(2),trim:aw(3)},zX=$e,lB=fG,YX=Gt,sB=vt,uB=NF,fB=Ye,GX=sm,h1=Nt,KX=$0,qX=Di,XX=Jd,cB=Rj,ZX=je,QX=il.f,JX=zn.f,eZ=_r.f,tZ=oB,rZ=aB.trim,Om="Number",Jl=sB[Om];uB[Om];var G0=Jl.prototype,nZ=sB.TypeError,oZ=fB("".slice),ly=fB("".charCodeAt),iZ=function(e){var t=cB(e,"number");return typeof t=="bigint"?t:aZ(t)},aZ=function(e){var t=cB(e,"number"),r,n,o,i,a,l,s,u;if(XX(t))throw nZ("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=rZ(t),r=ly(t,0),r===43||r===45){if(n=ly(t,2),n===88||n===120)return NaN}else if(r===48){switch(ly(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=oZ(t,2),l=a.length,s=0;s<l;s++)if(u=ly(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},K0=GX(Om,!Jl(" 0o1")||!Jl("0b1")||Jl("+0x1")),lZ=function(e){return qX(G0,e)&&ZX(function(){tZ(e)})},Rm=function(t){var r=arguments.length<1?0:Jl(iZ(t));return lZ(this)?KX(Object(r),this,Rm):r};Rm.prototype=G0;K0&&!lB&&(G0.constructor=Rm);zX({global:!0,constructor:!0,wrap:!0,forced:K0},{Number:Rm});var sZ=function(e,t){for(var r=YX?QX(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)h1(t,o=r[n])&&!h1(e,o)&&eZ(e,o,JX(t,o))};(K0||lB)&&sZ(uB[Om],Jl);var uZ=$e,fZ=v0;uZ({target:"Object",stat:!0},{setPrototypeOf:fZ});var cZ=$e,hZ=je,dZ=Ir,hB=fv,vZ=Bj,yZ=hZ(function(){hB(1)});cZ({target:"Object",stat:!0,forced:yZ,sham:!vZ},{getPrototypeOf:function(t){return hB(dZ(t))}});var dB=Ye,gZ=tl,pZ=Yt,mZ=Nt,d1=mv,bZ=Xd,vB=Function,wZ=dB([].concat),SZ=dB([].join),lw={},CZ=function(e,t,r){if(!mZ(lw,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";lw[t]=vB("C,a","return new C("+SZ(n,",")+")")}return lw[t](e,r)},_Z=bZ?vB.bind:function(t){var r=gZ(this),n=r.prototype,o=d1(arguments,1),i=function(){var l=wZ(o,d1(arguments));return this instanceof i?CZ(r,l.length,l):r.apply(t,l)};return pZ(n)&&(i.prototype=n),i},OZ=dm,RZ=Of,EZ=TypeError,yB=function(e){if(OZ(e))return e;throw EZ(RZ(e)+" is not a constructor")},TZ=$e,PZ=Uo,sw=ll,kZ=_Z,v1=yB,$Z=jt,y1=Yt,AZ=Rf,gB=je,q0=PZ("Reflect","construct"),IZ=Object.prototype,MZ=[].push,pB=gB(function(){function e(){}return!(q0(function(){},[],e)instanceof e)}),mB=!gB(function(){q0(function(){})}),g1=pB||mB;TZ({target:"Reflect",stat:!0,forced:g1,sham:g1},{construct:function(t,r){v1(t),$Z(r);var n=arguments.length<3?t:v1(arguments[2]);if(mB&&!pB)return q0(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return sw(MZ,o,r),new(sw(kZ,t,o))}var i=n.prototype,a=AZ(y1(i)?i:IZ),l=sw(t,a,r);return y1(l)?l:a}});var p1=Nt,xZ=function(e){return e!==void 0&&(p1(e,"value")||p1(e,"writable"))},DZ=$e,NZ=Zt,HZ=Yt,LZ=jt,jZ=xZ,FZ=zn,BZ=fv;function bB(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(LZ(e)===r)return e[t];if(n=FZ.f(e,t),n)return jZ(n)?n.value:n.get===void 0?void 0:NZ(n.get,r);if(HZ(o=BZ(e)))return bB(o,t,r)}DZ({target:"Reflect",stat:!0},{get:bB});var VZ=$e,WZ=je,UZ=zr,wB=zn.f,SB=Gt,zZ=!SB||WZ(function(){wB(1)});VZ({target:"Object",stat:!0,forced:zZ,sham:!SB},{getOwnPropertyDescriptor:function(t,r){return wB(UZ(t),r)}});var YZ=B0;YZ("iterator");var GZ=$e,m1=Tf,KZ=dm,qZ=Yt,b1=ev,XZ=en,ZZ=zr,QZ=Ef,JZ=St,eQ=yv,tQ=mv,rQ=eQ("slice"),nQ=JZ("species"),uw=Array,oQ=Math.max;GZ({target:"Array",proto:!0,forced:!rQ},{slice:function(t,r){var n=ZZ(this),o=XZ(n),i=b1(t,o),a=b1(r===void 0?o:r,o),l,s,u;if(m1(n)&&(l=n.constructor,KZ(l)&&(l===uw||m1(l.prototype))?l=void 0:qZ(l)&&(l=l[nQ],l===null&&(l=void 0)),l===uw||l===void 0))return tQ(n,i,a);for(s=new(l===void 0?uw:l)(oQ(a-i,0)),u=0;i<a;i++,u++)i in n&&QZ(s,u,n[i]);return s.length=u,s}});var iQ=Zt,aQ=Nt,lQ=Di,sQ=$F,w1=RegExp.prototype,CB=function(e){var t=e.flags;return t===void 0&&!("flags"in w1)&&!aQ(e,"flags")&&lQ(w1,e)?iQ(sQ,e):t},uQ=lv.PROPER,fQ=tn,cQ=jt,S1=Kt,hQ=je,dQ=CB,X0="toString",vQ=RegExp.prototype,_B=vQ[X0],yQ=hQ(function(){return _B.call({source:"a",flags:"b"})!="/a/b"}),gQ=uQ&&_B.name!=X0;(yQ||gQ)&&fQ(RegExp.prototype,X0,function(){var t=cQ(this),r=S1(t.source),n=S1(dQ(t));return"/"+r+"/"+n},{unsafe:!0});var pQ=Gt,mQ=lv.EXISTS,OB=Ye,bQ=gv,RB=Function.prototype,wQ=OB(RB.toString),EB=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,SQ=OB(EB.exec),CQ="name";pQ&&!mQ&&bQ(RB,CQ,{configurable:!0,get:function(){try{return SQ(EB,wQ(this))[1]}catch{return""}}});var _Q=jt,OQ=nF,RQ=function(e,t,r,n){try{return n?t(_Q(r)[0],r[1]):t(r)}catch(o){OQ(e,"throw",o)}},EQ=dv,TQ=Zt,PQ=Ir,kQ=RQ,$Q=tF,AQ=dm,IQ=en,C1=Ef,MQ=rF,xQ=T0,_1=Array,DQ=function(t){var r=PQ(t),n=AQ(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=EQ(i,o>2?arguments[2]:void 0));var l=xQ(r),s=0,u,f,c,h,d,v;if(l&&!(this===_1&&$Q(l)))for(h=MQ(r,l),d=h.next,f=n?new this:[];!(c=TQ(d,h)).done;s++)v=a?kQ(h,i,[c.value,s],!0):c.value,C1(f,s,v);else for(u=IQ(r),f=n?new this(u):_1(u);u>s;s++)v=a?i(r[s],s):r[s],C1(f,s,v);return f.length=s,f},NQ=$e,HQ=DQ,LQ=aF,jQ=!LQ(function(e){Array.from(e)});NQ({target:"Array",stat:!0,forced:jQ},{from:HQ});var FQ=$e,BQ=S0,VQ=je,WQ=Yt,UQ=cv.onFreeze,IC=Object.freeze,zQ=VQ(function(){IC(1)});FQ({target:"Object",stat:!0,forced:zQ,sham:!BQ},{freeze:function(t){return IC&&WQ(t)?IC(UQ(t)):t}});var YQ=lv.PROPER,GQ=je,O1=iB,R1="​᠎",KQ=function(e){return GQ(function(){return!!O1[e]()||R1[e]()!==R1||YQ&&O1[e].name!==e})},qQ=$e,XQ=aB.trim,ZQ=KQ;qQ({target:"String",proto:!0,forced:ZQ("trim")},{trim:function(){return XQ(this)}});var QQ=$e,JQ=f0.includes,eJ=je,tJ=nv,rJ=eJ(function(){return!Array(1).includes()});QQ({target:"Array",proto:!0,forced:rJ},{includes:function(t){return JQ(this,t,arguments.length>1?arguments[1]:void 0)}});tJ("includes");var nJ=$e,oJ=w0.codeAt;nJ({target:"String",proto:!0},{codePointAt:function(t){return oJ(this,t)}});var iJ=Ni,aJ=Kt,lJ=Ar,sJ=RangeError,Z0=function(t){var r=aJ(lJ(this)),n="",o=iJ(t);if(o<0||o==1/0)throw sJ("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},TB=Ye,uJ=nl,E1=Kt,fJ=Z0,cJ=Ar,hJ=TB(fJ),dJ=TB("".slice),vJ=Math.ceil,T1=function(e){return function(t,r,n){var o=E1(cJ(t)),i=uJ(r),a=o.length,l=n===void 0?" ":E1(n),s,u;return i<=a||l==""?o:(s=i-a,u=hJ(l,vJ(s/l.length)),u.length>s&&(u=dJ(u,0,s)),e?o+u:u+o)}},yJ={start:T1(!1),end:T1(!0)},gJ=el,pJ=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(gJ),mJ=$e,bJ=yJ.start,wJ=pJ;mJ({target:"String",proto:!0,forced:wJ},{padStart:function(t){return bJ(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var PB;function ee(){return PB.apply(null,arguments)}function SJ(e){PB=e}function mn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function La(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Q0(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(it(e,t))return!1;return!0}function Tr(e){return e===void 0}function Bo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function wv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function kB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function hi(e,t){for(var r in t)it(t,r)&&(e[r]=t[r]);return it(t,"toString")&&(e.toString=t.toString),it(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Yn(e,t,r,n){return JB(e,t,r,n,!0).utc()}function CJ(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ke(e){return e._pf==null&&(e._pf=CJ()),e._pf}var MC;Array.prototype.some?MC=Array.prototype.some:MC=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function J0(e){if(e._isValid==null){var t=Ke(e),r=MC.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Em(e){var t=Yn(NaN);return e!=null?hi(Ke(t),e):Ke(t).userInvalidated=!0,t}var P1=ee.momentProperties=[],fw=!1;function eE(e,t){var r,n,o,i=P1.length;if(Tr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Tr(t._i)||(e._i=t._i),Tr(t._f)||(e._f=t._f),Tr(t._l)||(e._l=t._l),Tr(t._strict)||(e._strict=t._strict),Tr(t._tzm)||(e._tzm=t._tzm),Tr(t._isUTC)||(e._isUTC=t._isUTC),Tr(t._offset)||(e._offset=t._offset),Tr(t._pf)||(e._pf=Ke(t)),Tr(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=P1[r],o=t[n],Tr(o)||(e[n]=o);return e}function Sv(e){eE(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),fw===!1&&(fw=!0,ee.updateOffset(this),fw=!1)}function bn(e){return e instanceof Sv||e!=null&&e._isAMomentObject!=null}function $B(e){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function rn(e,t){var r=!0;return hi(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])it(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}$B(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var k1={};function AB(e,t){ee.deprecationHandler!=null&&ee.deprecationHandler(e,t),k1[e]||($B(t),k1[e]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Gn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function _J(e){var t,r;for(r in e)it(e,r)&&(t=e[r],Gn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function xC(e,t){var r=hi({},e),n;for(n in t)it(t,n)&&(La(e[n])&&La(t[n])?(r[n]={},hi(r[n],e[n]),hi(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)it(e,n)&&!it(t,n)&&La(e[n])&&(r[n]=hi({},r[n]));return r}function tE(e){e!=null&&this.set(e)}var DC;Object.keys?DC=Object.keys:DC=function(e){var t,r=[];for(t in e)it(e,t)&&r.push(t);return r};var OJ={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function RJ(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Gn(n)?n.call(t,r):n}function Wn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var rE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,sy=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,cw={},es={};function Pe(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(es[e]=o),t&&(es[t[0]]=function(){return Wn(o.apply(this,arguments),t[1],t[2])}),r&&(es[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function EJ(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function TJ(e){var t=e.match(rE),r,n;for(r=0,n=t.length;r<n;r++)es[t[r]]?t[r]=es[t[r]]:t[r]=EJ(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Gn(t[a])?t[a].call(o,e):t[a];return i}}function ag(e,t){return e.isValid()?(t=IB(t,e.localeData()),cw[t]=cw[t]||TJ(t),cw[t](e)):e.localeData().invalidDate()}function IB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(sy.lastIndex=0;r>=0&&sy.test(e);)e=e.replace(sy,n),sy.lastIndex=0,r-=1;return e}var PJ={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function kJ(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(rE).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var $J="Invalid date";function AJ(){return this._invalidDate}var IJ="%d",MJ=/\d{1,2}/;function xJ(e){return this._ordinal.replace("%d",e)}var DJ={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function NJ(e,t,r,n){var o=this._relativeTime[r];return Gn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function HJ(e,t){var r=this._relativeTime[e>0?"future":"past"];return Gn(r)?r(t):r.replace(/%s/i,t)}var Ec={};function cr(e,t){var r=e.toLowerCase();Ec[r]=Ec[r+"s"]=Ec[t]=e}function nn(e){return typeof e=="string"?Ec[e]||Ec[e.toLowerCase()]:void 0}function nE(e){var t={},r,n;for(n in e)it(e,n)&&(r=nn(n),r&&(t[r]=e[n]));return t}var MB={};function hr(e,t){MB[e]=t}function LJ(e){var t=[],r;for(r in e)it(e,r)&&t.push({unit:r,priority:MB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function Tm(e){return e%4===0&&e%100!==0||e%400===0}function Zr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Qe(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Zr(t)),r}function kf(e,t){return function(r){return r!=null?(xB(this,e,r),ee.updateOffset(this,t),this):zg(this,e)}}function zg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function xB(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&Tm(e.year())&&e.month()===1&&e.date()===29?(r=Qe(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Mm(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function jJ(e){return e=nn(e),Gn(this[e])?this[e]():this}function FJ(e,t){if(typeof e=="object"){e=nE(e);var r=LJ(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=nn(e),Gn(this[e]))return this[e](t);return this}var DB=/\d/,Yr=/\d\d/,NB=/\d{3}/,oE=/\d{4}/,Pm=/[+-]?\d{6}/,Et=/\d\d?/,HB=/\d\d\d\d?/,LB=/\d\d\d\d\d\d?/,km=/\d{1,3}/,iE=/\d{1,4}/,$m=/[+-]?\d{1,6}/,$f=/\d+/,Am=/[+-]?\d+/,BJ=/Z|[+-]\d\d:?\d\d/gi,Im=/Z|[+-]\d\d(?::?\d\d)?/gi,VJ=/[+-]?\d+(\.\d{1,3})?/,Cv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Yg;Yg={};function be(e,t,r){Yg[e]=Gn(t)?t:function(n,o){return n&&r?r:t}}function WJ(e,t){return it(Yg,e)?Yg[e](t._strict,t._locale):new RegExp(UJ(e))}function UJ(e){return Br(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Br(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var NC={};function yt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Bo(t)&&(n=function(i,a){a[t]=Qe(i)}),o=e.length,r=0;r<o;r++)NC[e[r]]=n}function _v(e,t){yt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function zJ(e,t,r){t!=null&&it(NC,e)&&NC[e](t,r._a,r,e)}var sr=0,fo=1,Fn=2,Qt=3,gn=4,co=5,fa=6,YJ=7,GJ=8;function KJ(e,t){return(e%t+t)%t}var Wt;Array.prototype.indexOf?Wt=Array.prototype.indexOf:Wt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Mm(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=KJ(t,12);return e+=(t-r)/12,r===1?Tm(e)?29:28:31-r%7%2}Pe("M",["MM",2],"Mo",function(){return this.month()+1});Pe("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Pe("MMMM",0,0,function(e){return this.localeData().months(this,e)});cr("month","M");hr("month",8);be("M",Et);be("MM",Et,Yr);be("MMM",function(e,t){return t.monthsShortRegex(e)});be("MMMM",function(e,t){return t.monthsRegex(e)});yt(["M","MM"],function(e,t){t[fo]=Qe(e)-1});yt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[fo]=o:Ke(r).invalidMonth=e});var qJ="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),jB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),FB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,XJ=Cv,ZJ=Cv;function QJ(e,t){return e?mn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||FB).test(t)?"format":"standalone"][e.month()]:mn(this._months)?this._months:this._months.standalone}function JJ(e,t){return e?mn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[FB.test(t)?"format":"standalone"][e.month()]:mn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function eee(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Yn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null))}function tee(e,t,r){var n,o,i;if(this._monthsParseExact)return eee.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Yn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function BB(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Qe(t);else if(t=e.localeData().monthsParse(t),!Bo(t))return e}return r=Math.min(e.date(),Mm(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function VB(e){return e!=null?(BB(this,e),ee.updateOffset(this,!0),this):zg(this,"Month")}function ree(){return Mm(this.year(),this.month())}function nee(e){return this._monthsParseExact?(it(this,"_monthsRegex")||WB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=XJ),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function oee(e){return this._monthsParseExact?(it(this,"_monthsRegex")||WB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=ZJ),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function WB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Yn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Br(t[o]),r[o]=Br(r[o]);for(o=0;o<24;o++)n[o]=Br(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Pe("Y",0,0,function(){var e=this.year();return e<=9999?Wn(e,4):"+"+e});Pe(0,["YY",2],0,function(){return this.year()%100});Pe(0,["YYYY",4],0,"year");Pe(0,["YYYYY",5],0,"year");Pe(0,["YYYYYY",6,!0],0,"year");cr("year","y");hr("year",1);be("Y",Am);be("YY",Et,Yr);be("YYYY",iE,oE);be("YYYYY",$m,Pm);be("YYYYYY",$m,Pm);yt(["YYYYY","YYYYYY"],sr);yt("YYYY",function(e,t){t[sr]=e.length===2?ee.parseTwoDigitYear(e):Qe(e)});yt("YY",function(e,t){t[sr]=ee.parseTwoDigitYear(e)});yt("Y",function(e,t){t[sr]=parseInt(e,10)});function Tc(e){return Tm(e)?366:365}ee.parseTwoDigitYear=function(e){return Qe(e)+(Qe(e)>68?1900:2e3)};var UB=kf("FullYear",!0);function iee(){return Tm(this.year())}function aee(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function Yc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Gg(e,t,r){var n=7+t-r,o=(7+Yc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function zB(e,t,r,n,o){var i=(7+r-n)%7,a=Gg(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=Tc(s)+l):l>Tc(e)?(s=e+1,u=l-Tc(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Gc(e,t,r){var n=Gg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Lo(a,t,r)):o>Lo(e.year(),t,r)?(i=o-Lo(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Lo(e,t,r){var n=Gg(e,t,r),o=Gg(e+1,t,r);return(Tc(e)-n+o)/7}Pe("w",["ww",2],"wo","week");Pe("W",["WW",2],"Wo","isoWeek");cr("week","w");cr("isoWeek","W");hr("week",5);hr("isoWeek",5);be("w",Et);be("ww",Et,Yr);be("W",Et);be("WW",Et,Yr);_v(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Qe(e)});function lee(e){return Gc(e,this._week.dow,this._week.doy).week}var see={dow:0,doy:6};function uee(){return this._week.dow}function fee(){return this._week.doy}function cee(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function hee(e){var t=Gc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Pe("d",0,"do","day");Pe("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Pe("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Pe("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Pe("e",0,0,"weekday");Pe("E",0,0,"isoWeekday");cr("day","d");cr("weekday","e");cr("isoWeekday","E");hr("day",11);hr("weekday",11);hr("isoWeekday",11);be("d",Et);be("e",Et);be("E",Et);be("dd",function(e,t){return t.weekdaysMinRegex(e)});be("ddd",function(e,t){return t.weekdaysShortRegex(e)});be("dddd",function(e,t){return t.weekdaysRegex(e)});_v(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Ke(r).invalidWeekday=e});_v(["d","e","E"],function(e,t,r,n){t[n]=Qe(e)});function dee(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function vee(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function aE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var yee="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),YB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),gee="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),pee=Cv,mee=Cv,bee=Cv;function wee(e,t){var r=mn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?aE(r,this._week.dow):e?r[e.day()]:r}function See(e){return e===!0?aE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Cee(e){return e===!0?aE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function _ee(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Yn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1||(o=Wt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Wt.call(this._minWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function Oee(e,t,r){var n,o,i;if(this._weekdaysParseExact)return _ee.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Yn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Ree(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=dee(e,this.localeData()),this.add(e-t,"d")):t}function Eee(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Tee(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=vee(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Pee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||lE.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=pee),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function kee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||lE.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=mee),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function $ee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||lE.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=bee),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function lE(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Yn([2e3,1]).day(i),l=Br(this.weekdaysMin(a,"")),s=Br(this.weekdaysShort(a,"")),u=Br(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function sE(){return this.hours()%12||12}function Aee(){return this.hours()||24}Pe("H",["HH",2],0,"hour");Pe("h",["hh",2],0,sE);Pe("k",["kk",2],0,Aee);Pe("hmm",0,0,function(){return""+sE.apply(this)+Wn(this.minutes(),2)});Pe("hmmss",0,0,function(){return""+sE.apply(this)+Wn(this.minutes(),2)+Wn(this.seconds(),2)});Pe("Hmm",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)});Pe("Hmmss",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)+Wn(this.seconds(),2)});function GB(e,t){Pe(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}GB("a",!0);GB("A",!1);cr("hour","h");hr("hour",13);function KB(e,t){return t._meridiemParse}be("a",KB);be("A",KB);be("H",Et);be("h",Et);be("k",Et);be("HH",Et,Yr);be("hh",Et,Yr);be("kk",Et,Yr);be("hmm",HB);be("hmmss",LB);be("Hmm",HB);be("Hmmss",LB);yt(["H","HH"],Qt);yt(["k","kk"],function(e,t,r){var n=Qe(e);t[Qt]=n===24?0:n});yt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});yt(["h","hh"],function(e,t,r){t[Qt]=Qe(e),Ke(r).bigHour=!0});yt("hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n)),Ke(r).bigHour=!0});yt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n,2)),t[co]=Qe(e.substr(o)),Ke(r).bigHour=!0});yt("Hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n))});yt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n,2)),t[co]=Qe(e.substr(o))});function Iee(e){return(e+"").toLowerCase().charAt(0)==="p"}var Mee=/[ap]\.?m?\.?/i,xee=kf("Hours",!0);function Dee(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var qB={calendar:OJ,longDateFormat:PJ,invalidDate:$J,ordinal:IJ,dayOfMonthOrdinalParse:MJ,relativeTime:DJ,months:qJ,monthsShort:jB,week:see,weekdays:yee,weekdaysMin:gee,weekdaysShort:YB,meridiemParse:Mee},Tt={},zf={},Kc;function Nee(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function $1(e){return e&&e.toLowerCase().replace("_","-")}function Hee(e){for(var t=0,r,n,o,i;t<e.length;){for(i=$1(e[t]).split("-"),r=i.length,n=$1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=xm(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&Nee(i,n)>=r-1)break;r--}t++}return Kc}function Lee(e){return e.match("^[^/\\\\]*$")!=null}function xm(e){var t=null,r;if(Tt[e]===void 0&&typeof module<"u"&&module&&module.exports&&Lee(e))try{t=Kc._abbr,r=require,r("./locale/"+e),yi(t)}catch{Tt[e]=null}return Tt[e]}function yi(e,t){var r;return e&&(Tr(t)?r=Yo(e):r=uE(e,t),r?Kc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Kc._abbr}function uE(e,t){if(t!==null){var r,n=qB;if(t.abbr=e,Tt[e]!=null)AB("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Tt[e]._config;else if(t.parentLocale!=null)if(Tt[t.parentLocale]!=null)n=Tt[t.parentLocale]._config;else if(r=xm(t.parentLocale),r!=null)n=r._config;else return zf[t.parentLocale]||(zf[t.parentLocale]=[]),zf[t.parentLocale].push({name:e,config:t}),null;return Tt[e]=new tE(xC(n,t)),zf[e]&&zf[e].forEach(function(o){uE(o.name,o.config)}),yi(e),Tt[e]}else return delete Tt[e],null}function jee(e,t){if(t!=null){var r,n,o=qB;Tt[e]!=null&&Tt[e].parentLocale!=null?Tt[e].set(xC(Tt[e]._config,t)):(n=xm(e),n!=null&&(o=n._config),t=xC(o,t),n==null&&(t.abbr=e),r=new tE(t),r.parentLocale=Tt[e],Tt[e]=r),yi(e)}else Tt[e]!=null&&(Tt[e].parentLocale!=null?(Tt[e]=Tt[e].parentLocale,e===yi()&&yi(e)):Tt[e]!=null&&delete Tt[e]);return Tt[e]}function Yo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Kc;if(!mn(e)){if(t=xm(e),t)return t;e=[e]}return Hee(e)}function Fee(){return DC(Tt)}function fE(e){var t,r=e._a;return r&&Ke(e).overflow===-2&&(t=r[fo]<0||r[fo]>11?fo:r[Fn]<1||r[Fn]>Mm(r[sr],r[fo])?Fn:r[Qt]<0||r[Qt]>24||r[Qt]===24&&(r[gn]!==0||r[co]!==0||r[fa]!==0)?Qt:r[gn]<0||r[gn]>59?gn:r[co]<0||r[co]>59?co:r[fa]<0||r[fa]>999?fa:-1,Ke(e)._overflowDayOfYear&&(t<sr||t>Fn)&&(t=Fn),Ke(e)._overflowWeeks&&t===-1&&(t=YJ),Ke(e)._overflowWeekday&&t===-1&&(t=GJ),Ke(e).overflow=t),e}var Bee=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Vee=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Wee=/Z|[+-]\d\d(?::?\d\d)?/,uy=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],hw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Uee=/^\/?Date\((-?\d+)/i,zee=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Yee={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function XB(e){var t,r,n=e._i,o=Bee.exec(n)||Vee.exec(n),i,a,l,s,u=uy.length,f=hw.length;if(o){for(Ke(e).iso=!0,t=0,r=u;t<r;t++)if(uy[t][1].exec(o[1])){a=uy[t][0],i=uy[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(hw[t][1].exec(o[3])){l=(o[2]||" ")+hw[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(Wee.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),hE(e)}else e._isValid=!1}function Gee(e,t,r,n,o,i){var a=[Kee(e),jB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Kee(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function qee(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Xee(e,t,r){if(e){var n=YB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Ke(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Zee(e,t,r){if(e)return Yee[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function ZB(e){var t=zee.exec(qee(e._i)),r;if(t){if(r=Gee(t[4],t[3],t[2],t[5],t[6],t[7]),!Xee(t[1],r,e))return;e._a=r,e._tzm=Zee(t[8],t[9],t[10]),e._d=Yc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Ke(e).rfc2822=!0}else e._isValid=!1}function Qee(e){var t=Uee.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(XB(e),e._isValid===!1)delete e._isValid;else return;if(ZB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ee.createFromInputFallback(e)}ee.createFromInputFallback=rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Ul(e,t,r){return e??t??r}function Jee(e){var t=new Date(ee.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function cE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=Jee(e),e._w&&e._a[Fn]==null&&e._a[fo]==null&&ete(e),e._dayOfYear!=null&&(a=Ul(e._a[sr],o[sr]),(e._dayOfYear>Tc(a)||e._dayOfYear===0)&&(Ke(e)._overflowDayOfYear=!0),r=Yc(a,0,e._dayOfYear),e._a[fo]=r.getUTCMonth(),e._a[Fn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Qt]===24&&e._a[gn]===0&&e._a[co]===0&&e._a[fa]===0&&(e._nextDay=!0,e._a[Qt]=0),e._d=(e._useUTC?Yc:aee).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Qt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Ke(e).weekdayMismatch=!0)}}function ete(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=Ul(t.GG,e._a[sr],Gc(Ot(),1,4).year),n=Ul(t.W,1),o=Ul(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Gc(Ot(),i,a),r=Ul(t.gg,e._a[sr],u.year),n=Ul(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Lo(r,i,a)?Ke(e)._overflowWeeks=!0:s!=null?Ke(e)._overflowWeekday=!0:(l=zB(r,n,o,i,a),e._a[sr]=l.year,e._dayOfYear=l.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function hE(e){if(e._f===ee.ISO_8601){XB(e);return}if(e._f===ee.RFC_2822){ZB(e);return}e._a=[],Ke(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=IB(e._f,e._locale).match(rE)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(WJ(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Ke(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),es[i]?(n?Ke(e).empty=!1:Ke(e).unusedTokens.push(i),zJ(i,n,e)):e._strict&&!n&&Ke(e).unusedTokens.push(i);Ke(e).charsLeftOver=l-s,t.length>0&&Ke(e).unusedInput.push(t),e._a[Qt]<=12&&Ke(e).bigHour===!0&&e._a[Qt]>0&&(Ke(e).bigHour=void 0),Ke(e).parsedDateParts=e._a.slice(0),Ke(e).meridiem=e._meridiem,e._a[Qt]=tte(e._locale,e._a[Qt],e._meridiem),u=Ke(e).era,u!==null&&(e._a[sr]=e._locale.erasConvertYear(u,e._a[sr])),cE(e),fE(e)}function tte(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function rte(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){Ke(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=eE({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],hE(t),J0(t)&&(a=!0),i+=Ke(t).charsLeftOver,i+=Ke(t).unusedTokens.length*10,Ke(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));hi(e,r||t)}function nte(e){if(!e._d){var t=nE(e._i),r=t.day===void 0?t.date:t.day;e._a=kB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),cE(e)}}function ote(e){var t=new Sv(fE(QB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function QB(e){var t=e._i,r=e._f;return e._locale=e._locale||Yo(e._l),t===null||r===void 0&&t===""?Em({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),bn(t)?new Sv(fE(t)):(wv(t)?e._d=t:mn(r)?rte(e):r?hE(e):ite(e),J0(e)||(e._d=null),e))}function ite(e){var t=e._i;Tr(t)?e._d=new Date(ee.now()):wv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Qee(e):mn(t)?(e._a=kB(t.slice(0),function(r){return parseInt(r,10)}),cE(e)):La(t)?nte(e):Bo(t)?e._d=new Date(t):ee.createFromInputFallback(e)}function JB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(La(e)&&Q0(e)||mn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,ote(i)}function Ot(e,t,r,n){return JB(e,t,r,n,!1)}var ate=rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Em()}),lte=rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Em()});function eV(e,t){var r,n;if(t.length===1&&mn(t[0])&&(t=t[0]),!t.length)return Ot();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function ste(){var e=[].slice.call(arguments,0);return eV("isBefore",e)}function ute(){var e=[].slice.call(arguments,0);return eV("isAfter",e)}var fte=function(){return Date.now?Date.now():+new Date},Yf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function cte(e){var t,r=!1,n,o=Yf.length;for(t in e)if(it(e,t)&&!(Wt.call(Yf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Yf[n]]){if(r)return!1;parseFloat(e[Yf[n]])!==Qe(e[Yf[n]])&&(r=!0)}return!0}function hte(){return this._isValid}function dte(){return On(NaN)}function Dm(e){var t=nE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=cte(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Yo(),this._bubble()}function lg(e){return e instanceof Dm}function HC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function vte(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Qe(e[a])!==Qe(t[a]))&&i++;return i+o}function tV(e,t){Pe(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Wn(~~(r/60),2)+t+Wn(~~r%60,2)})}tV("Z",":");tV("ZZ","");be("Z",Im);be("ZZ",Im);yt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=dE(Im,e)});var yte=/([\+\-]|\d\d)/gi;function dE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(yte)||["-",0,0],i=+(o[1]*60)+Qe(o[2]),i===0?0:o[0]==="+"?i:-i)}function vE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(bn(e)||wv(e)?e.valueOf():Ot(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ee.updateOffset(r,!1),r):Ot(e).local()}function LC(e){return-Math.round(e._d.getTimezoneOffset())}ee.updateOffset=function(){};function gte(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=dE(Im,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=LC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?oV(this,On(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:LC(this)}function pte(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function mte(e){return this.utcOffset(0,e)}function bte(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(LC(this),"m")),this}function wte(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=dE(BJ,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Ste(e){return this.isValid()?(e=e?Ot(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Cte(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function _te(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var e={},t;return eE(e,this),e=QB(e),e._a?(t=e._isUTC?Yn(e._a):Ot(e._a),this._isDSTShifted=this.isValid()&&vte(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ote(){return this.isValid()?!this._isUTC:!1}function Rte(){return this.isValid()?this._isUTC:!1}function rV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Ete=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Tte=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function On(e,t){var r=e,n=null,o,i,a;return lg(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Bo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Ete.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Qe(n[Fn])*o,h:Qe(n[Qt])*o,m:Qe(n[gn])*o,s:Qe(n[co])*o,ms:Qe(HC(n[fa]*1e3))*o}):(n=Tte.exec(e))?(o=n[1]==="-"?-1:1,r={y:Vi(n[2],o),M:Vi(n[3],o),w:Vi(n[4],o),d:Vi(n[5],o),h:Vi(n[6],o),m:Vi(n[7],o),s:Vi(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=Pte(Ot(r.from),Ot(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Dm(r),lg(e)&&it(e,"_locale")&&(i._locale=e._locale),lg(e)&&it(e,"_isValid")&&(i._isValid=e._isValid),i}On.fn=Dm.prototype;On.invalid=dte;function Vi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function A1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Pte(e,t){var r;return e.isValid()&&t.isValid()?(t=vE(t,e),e.isBefore(t)?r=A1(e,t):(r=A1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function nV(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(AB(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=On(r,n),oV(this,o,e),this}}function oV(e,t,r,n){var o=t._milliseconds,i=HC(t._days),a=HC(t._months);e.isValid()&&(n=n??!0,a&&BB(e,zg(e,"Month")+a*r),i&&xB(e,"Date",zg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&ee.updateOffset(e,i||a))}var kte=nV(1,"add"),$te=nV(-1,"subtract");function iV(e){return typeof e=="string"||e instanceof String}function Ate(e){return bn(e)||wv(e)||iV(e)||Bo(e)||Mte(e)||Ite(e)||e===null||e===void 0}function Ite(e){var t=La(e)&&!Q0(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||it(e,i);return t&&r}function Mte(e){var t=mn(e),r=!1;return t&&(r=e.filter(function(n){return!Bo(n)&&iV(e)}).length===0),t&&r}function xte(e){var t=La(e)&&!Q0(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||it(e,i);return t&&r}function Dte(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Nte(e,t){arguments.length===1&&(arguments[0]?Ate(arguments[0])?(e=arguments[0],t=void 0):xte(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ot(),n=vE(r,this).startOf("day"),o=ee.calendarFormat(this,n)||"sameElse",i=t&&(Gn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,Ot(r)))}function Hte(){return new Sv(this)}function Lte(e,t){var r=bn(e)?e:Ot(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function jte(e,t){var r=bn(e)?e:Ot(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function Fte(e,t,r,n){var o=bn(e)?e:Ot(e),i=bn(t)?t:Ot(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function Bte(e,t){var r=bn(e)?e:Ot(e),n;return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function Vte(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Wte(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Ute(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=vE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=nn(t),t){case"year":i=sg(this,n)/12;break;case"month":i=sg(this,n);break;case"quarter":i=sg(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Zr(i)}function sg(e,t){if(e.date()<t.date())return-sg(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function zte(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Yte(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?ag(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Gn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ag(r,"Z")):ag(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Gte(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Kte(e){e||(e=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var t=ag(this,e);return this.localeData().postformat(t)}function qte(e,t){return this.isValid()&&(bn(e)&&e.isValid()||Ot(e).isValid())?On({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Xte(e){return this.from(Ot(),e)}function Zte(e,t){return this.isValid()&&(bn(e)&&e.isValid()||Ot(e).isValid())?On({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Qte(e){return this.to(Ot(),e)}function aV(e){var t;return e===void 0?this._locale._abbr:(t=Yo(e),t!=null&&(this._locale=t),this)}var lV=rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function sV(){return this._locale}var Kg=1e3,ts=60*Kg,qg=60*ts,uV=(365*400+97)*24*qg;function rs(e,t){return(e%t+t)%t}function fV(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-uV:new Date(e,t,r).valueOf()}function cV(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-uV:Date.UTC(e,t,r)}function Jte(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?cV:fV,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=rs(t+(this._isUTC?0:this.utcOffset()*ts),qg);break;case"minute":t=this._d.valueOf(),t-=rs(t,ts);break;case"second":t=this._d.valueOf(),t-=rs(t,Kg);break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function ere(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?cV:fV,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=qg-rs(t+(this._isUTC?0:this.utcOffset()*ts),qg)-1;break;case"minute":t=this._d.valueOf(),t+=ts-rs(t,ts)-1;break;case"second":t=this._d.valueOf(),t+=Kg-rs(t,Kg)-1;break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function tre(){return this._d.valueOf()-(this._offset||0)*6e4}function rre(){return Math.floor(this.valueOf()/1e3)}function nre(){return new Date(this.valueOf())}function ore(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function ire(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function are(){return this.isValid()?this.toISOString():null}function lre(){return J0(this)}function sre(){return hi({},Ke(this))}function ure(){return Ke(this).overflow}function fre(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pe("N",0,0,"eraAbbr");Pe("NN",0,0,"eraAbbr");Pe("NNN",0,0,"eraAbbr");Pe("NNNN",0,0,"eraName");Pe("NNNNN",0,0,"eraNarrow");Pe("y",["y",1],"yo","eraYear");Pe("y",["yy",2],0,"eraYear");Pe("y",["yyy",3],0,"eraYear");Pe("y",["yyyy",4],0,"eraYear");be("N",yE);be("NN",yE);be("NNN",yE);be("NNNN",Sre);be("NNNNN",Cre);yt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Ke(r).era=o:Ke(r).invalidEra=e});be("y",$f);be("yy",$f);be("yyy",$f);be("yyyy",$f);be("yo",_re);yt(["y","yy","yyy","yyyy"],sr);yt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[sr]=r._locale.eraYearOrdinalParse(e,o):t[sr]=parseInt(e,10)});function cre(e,t){var r,n,o,i=this._eras||Yo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=ee(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=ee(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function hre(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function dre(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ee(e.since).year():ee(e.since).year()+(t-e.offset)*r}function vre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function yre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function gre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function pre(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-ee(o[e].since).year())*r+o[e].offset;return this.year()}function mre(e){return it(this,"_erasNameRegex")||gE.call(this),e?this._erasNameRegex:this._erasRegex}function bre(e){return it(this,"_erasAbbrRegex")||gE.call(this),e?this._erasAbbrRegex:this._erasRegex}function wre(e){return it(this,"_erasNarrowRegex")||gE.call(this),e?this._erasNarrowRegex:this._erasRegex}function yE(e,t){return t.erasAbbrRegex(e)}function Sre(e,t){return t.erasNameRegex(e)}function Cre(e,t){return t.erasNarrowRegex(e)}function _re(e,t){return t._eraYearOrdinalRegex||$f}function gE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Br(a[o].name)),e.push(Br(a[o].abbr)),r.push(Br(a[o].narrow)),n.push(Br(a[o].name)),n.push(Br(a[o].abbr)),n.push(Br(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pe(0,["gg",2],0,function(){return this.weekYear()%100});Pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Nm(e,t){Pe(0,[e,e.length],0,t)}Nm("gggg","weekYear");Nm("ggggg","weekYear");Nm("GGGG","isoWeekYear");Nm("GGGGG","isoWeekYear");cr("weekYear","gg");cr("isoWeekYear","GG");hr("weekYear",1);hr("isoWeekYear",1);be("G",Am);be("g",Am);be("GG",Et,Yr);be("gg",Et,Yr);be("GGGG",iE,oE);be("gggg",iE,oE);be("GGGGG",$m,Pm);be("ggggg",$m,Pm);_v(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Qe(e)});_v(["gg","GG"],function(e,t,r,n){t[n]=ee.parseTwoDigitYear(e)});function Ore(e){return hV.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Rre(e){return hV.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ere(){return Lo(this.year(),1,4)}function Tre(){return Lo(this.isoWeekYear(),1,4)}function Pre(){var e=this.localeData()._week;return Lo(this.year(),e.dow,e.doy)}function kre(){var e=this.localeData()._week;return Lo(this.weekYear(),e.dow,e.doy)}function hV(e,t,r,n,o){var i;return e==null?Gc(this,n,o).year:(i=Lo(e,n,o),t>i&&(t=i),$re.call(this,e,t,r,n,o))}function $re(e,t,r,n,o){var i=zB(e,t,r,n,o),a=Yc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Pe("Q",0,"Qo","quarter");cr("quarter","Q");hr("quarter",7);be("Q",DB);yt("Q",function(e,t){t[fo]=(Qe(e)-1)*3});function Are(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Pe("D",["DD",2],"Do","date");cr("date","D");hr("date",9);be("D",Et);be("DD",Et,Yr);be("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Fn);yt("Do",function(e,t){t[Fn]=Qe(e.match(Et)[0])});var dV=kf("Date",!0);Pe("DDD",["DDDD",3],"DDDo","dayOfYear");cr("dayOfYear","DDD");hr("dayOfYear",4);be("DDD",km);be("DDDD",NB);yt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Qe(e)});function Ire(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Pe("m",["mm",2],0,"minute");cr("minute","m");hr("minute",14);be("m",Et);be("mm",Et,Yr);yt(["m","mm"],gn);var Mre=kf("Minutes",!1);Pe("s",["ss",2],0,"second");cr("second","s");hr("second",15);be("s",Et);be("ss",Et,Yr);yt(["s","ss"],co);var xre=kf("Seconds",!1);Pe("S",0,0,function(){return~~(this.millisecond()/100)});Pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pe(0,["SSS",3],0,"millisecond");Pe(0,["SSSS",4],0,function(){return this.millisecond()*10});Pe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});cr("millisecond","ms");hr("millisecond",16);be("S",km,DB);be("SS",km,Yr);be("SSS",km,NB);var di,vV;for(di="SSSS";di.length<=9;di+="S")be(di,$f);function Dre(e,t){t[fa]=Qe(("0."+e)*1e3)}for(di="S";di.length<=9;di+="S")yt(di,Dre);vV=kf("Milliseconds",!1);Pe("z",0,0,"zoneAbbr");Pe("zz",0,0,"zoneName");function Nre(){return this._isUTC?"UTC":""}function Hre(){return this._isUTC?"Coordinated Universal Time":""}var ne=Sv.prototype;ne.add=kte;ne.calendar=Nte;ne.clone=Hte;ne.diff=Ute;ne.endOf=ere;ne.format=Kte;ne.from=qte;ne.fromNow=Xte;ne.to=Zte;ne.toNow=Qte;ne.get=jJ;ne.invalidAt=ure;ne.isAfter=Lte;ne.isBefore=jte;ne.isBetween=Fte;ne.isSame=Bte;ne.isSameOrAfter=Vte;ne.isSameOrBefore=Wte;ne.isValid=lre;ne.lang=lV;ne.locale=aV;ne.localeData=sV;ne.max=lte;ne.min=ate;ne.parsingFlags=sre;ne.set=FJ;ne.startOf=Jte;ne.subtract=$te;ne.toArray=ore;ne.toObject=ire;ne.toDate=nre;ne.toISOString=Yte;ne.inspect=Gte;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=are;ne.toString=zte;ne.unix=rre;ne.valueOf=tre;ne.creationData=fre;ne.eraName=vre;ne.eraNarrow=yre;ne.eraAbbr=gre;ne.eraYear=pre;ne.year=UB;ne.isLeapYear=iee;ne.weekYear=Ore;ne.isoWeekYear=Rre;ne.quarter=ne.quarters=Are;ne.month=VB;ne.daysInMonth=ree;ne.week=ne.weeks=cee;ne.isoWeek=ne.isoWeeks=hee;ne.weeksInYear=Pre;ne.weeksInWeekYear=kre;ne.isoWeeksInYear=Ere;ne.isoWeeksInISOWeekYear=Tre;ne.date=dV;ne.day=ne.days=Ree;ne.weekday=Eee;ne.isoWeekday=Tee;ne.dayOfYear=Ire;ne.hour=ne.hours=xee;ne.minute=ne.minutes=Mre;ne.second=ne.seconds=xre;ne.millisecond=ne.milliseconds=vV;ne.utcOffset=gte;ne.utc=mte;ne.local=bte;ne.parseZone=wte;ne.hasAlignedHourOffset=Ste;ne.isDST=Cte;ne.isLocal=Ote;ne.isUtcOffset=Rte;ne.isUtc=rV;ne.isUTC=rV;ne.zoneAbbr=Nre;ne.zoneName=Hre;ne.dates=rn("dates accessor is deprecated. Use date instead.",dV);ne.months=rn("months accessor is deprecated. Use month instead",VB);ne.years=rn("years accessor is deprecated. Use year instead",UB);ne.zone=rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pte);ne.isDSTShifted=rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",_te);function Lre(e){return Ot(e*1e3)}function jre(){return Ot.apply(null,arguments).parseZone()}function yV(e){return e}var at=tE.prototype;at.calendar=RJ;at.longDateFormat=kJ;at.invalidDate=AJ;at.ordinal=xJ;at.preparse=yV;at.postformat=yV;at.relativeTime=NJ;at.pastFuture=HJ;at.set=_J;at.eras=cre;at.erasParse=hre;at.erasConvertYear=dre;at.erasAbbrRegex=bre;at.erasNameRegex=mre;at.erasNarrowRegex=wre;at.months=QJ;at.monthsShort=JJ;at.monthsParse=tee;at.monthsRegex=oee;at.monthsShortRegex=nee;at.week=lee;at.firstDayOfYear=fee;at.firstDayOfWeek=uee;at.weekdays=wee;at.weekdaysMin=Cee;at.weekdaysShort=See;at.weekdaysParse=Oee;at.weekdaysRegex=Pee;at.weekdaysShortRegex=kee;at.weekdaysMinRegex=$ee;at.isPM=Iee;at.meridiem=Dee;function Xg(e,t,r,n){var o=Yo(),i=Yn().set(n,t);return o[r](i,e)}function gV(e,t,r){if(Bo(e)&&(t=e,e=void 0),e=e||"",t!=null)return Xg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Xg(e,n,r,"month");return o}function pE(e,t,r,n){typeof e=="boolean"?(Bo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Bo(t)&&(r=t,t=void 0),t=t||"");var o=Yo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return Xg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=Xg(t,(a+i)%7,n,"day");return l}function Fre(e,t){return gV(e,t,"months")}function Bre(e,t){return gV(e,t,"monthsShort")}function Vre(e,t,r){return pE(e,t,r,"weekdays")}function Wre(e,t,r){return pE(e,t,r,"weekdaysShort")}function Ure(e,t,r){return pE(e,t,r,"weekdaysMin")}yi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Qe(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ee.lang=rn("moment.lang is deprecated. Use moment.locale instead.",yi);ee.langData=rn("moment.langData is deprecated. Use moment.localeData instead.",Yo);var Zn=Math.abs;function zre(){var e=this._data;return this._milliseconds=Zn(this._milliseconds),this._days=Zn(this._days),this._months=Zn(this._months),e.milliseconds=Zn(e.milliseconds),e.seconds=Zn(e.seconds),e.minutes=Zn(e.minutes),e.hours=Zn(e.hours),e.months=Zn(e.months),e.years=Zn(e.years),this}function pV(e,t,r,n){var o=On(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Yre(e,t){return pV(this,e,t,1)}function Gre(e,t){return pV(this,e,t,-1)}function I1(e){return e<0?Math.floor(e):Math.ceil(e)}function Kre(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=I1(jC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Zr(e/1e3),n.seconds=o%60,i=Zr(o/60),n.minutes=i%60,a=Zr(i/60),n.hours=a%24,t+=Zr(a/24),s=Zr(mV(t)),r+=s,t-=I1(jC(s)),l=Zr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function mV(e){return e*4800/146097}function jC(e){return e*146097/4800}function qre(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=nn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+mV(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(jC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function Xre(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function Go(e){return function(){return this.as(e)}}var Zre=Go("ms"),Qre=Go("s"),Jre=Go("m"),ene=Go("h"),tne=Go("d"),rne=Go("w"),nne=Go("M"),one=Go("Q"),ine=Go("y");function ane(){return On(this)}function lne(e){return e=nn(e),this.isValid()?this[e+"s"]():NaN}function sl(e){return function(){return this.isValid()?this._data[e]:NaN}}var sne=sl("milliseconds"),une=sl("seconds"),fne=sl("minutes"),cne=sl("hours"),hne=sl("days"),dne=sl("months"),vne=sl("years");function yne(){return Zr(this.days()/7)}var ao=Math.round,ql={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function gne(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function pne(e,t,r,n){var o=On(e).abs(),i=ao(o.as("s")),a=ao(o.as("m")),l=ao(o.as("h")),s=ao(o.as("d")),u=ao(o.as("M")),f=ao(o.as("w")),c=ao(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,gne.apply(null,h)}function mne(e){return e===void 0?ao:typeof e=="function"?(ao=e,!0):!1}function bne(e,t){return ql[e]===void 0?!1:t===void 0?ql[e]:(ql[e]=t,e==="s"&&(ql.ss=t-1),!0)}function wne(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=ql,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},ql,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=pne(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var dw=Math.abs;function yl(e){return(e>0)-(e<0)||+e}function Hm(){if(!this.isValid())return this.localeData().invalidDate();var e=dw(this._milliseconds)/1e3,t=dw(this._days),r=dw(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Zr(e/60),o=Zr(n/60),e%=60,n%=60,i=Zr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=yl(this._months)!==yl(l)?"-":"",f=yl(this._days)!==yl(l)?"-":"",c=yl(this._milliseconds)!==yl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var nt=Dm.prototype;nt.isValid=hte;nt.abs=zre;nt.add=Yre;nt.subtract=Gre;nt.as=qre;nt.asMilliseconds=Zre;nt.asSeconds=Qre;nt.asMinutes=Jre;nt.asHours=ene;nt.asDays=tne;nt.asWeeks=rne;nt.asMonths=nne;nt.asQuarters=one;nt.asYears=ine;nt.valueOf=Xre;nt._bubble=Kre;nt.clone=ane;nt.get=lne;nt.milliseconds=sne;nt.seconds=une;nt.minutes=fne;nt.hours=cne;nt.days=hne;nt.weeks=yne;nt.months=dne;nt.years=vne;nt.humanize=wne;nt.toISOString=Hm;nt.toString=Hm;nt.toJSON=Hm;nt.locale=aV;nt.localeData=sV;nt.toIsoString=rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Hm);nt.lang=lV;Pe("X",0,0,"unix");Pe("x",0,0,"valueOf");be("x",Am);be("X",VJ);yt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});yt("x",function(e,t,r){r._d=new Date(Qe(e))});//! moment.js
ee.version="2.29.4";SJ(Ot);ee.fn=ne;ee.min=ste;ee.max=ute;ee.now=fte;ee.utc=Yn;ee.unix=Lre;ee.months=Fre;ee.isDate=wv;ee.locale=yi;ee.invalid=Em;ee.duration=On;ee.isMoment=bn;ee.weekdays=Vre;ee.parseZone=jre;ee.localeData=Yo;ee.isDuration=lg;ee.monthsShort=Bre;ee.weekdaysMin=Ure;ee.defineLocale=uE;ee.updateLocale=jee;ee.locales=Fee;ee.weekdaysShort=Wre;ee.normalizeUnits=nn;ee.relativeTimeRounding=mne;ee.relativeTimeThreshold=bne;ee.calendarFormat=Dte;ee.prototype=ne;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Sne=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));var Cne=TypeError,_ne=9007199254740991,bV=function(e){if(e>_ne)throw Cne("Maximum allowed index exceeded");return e},One=$e,Rne=je,Ene=Tf,Tne=Yt,Pne=Ir,kne=en,M1=bV,x1=Ef,$ne=I0,Ane=yv,Ine=St,Mne=Qd,wV=Ine("isConcatSpreadable"),xne=Mne>=51||!Rne(function(){var e=[];return e[wV]=!1,e.concat()[0]!==e}),Dne=function(e){if(!Tne(e))return!1;var t=e[wV];return t!==void 0?!!t:Ene(e)},Nne=!xne||!Ane("concat");One({target:"Array",proto:!0,arity:1,forced:Nne},{concat:function(t){var r=Pne(this),n=$ne(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],Dne(u))for(s=kne(u),M1(o+s),a=0;a<s;a++,o++)a in u&&x1(n,o,u[a]);else M1(o+1),x1(n,o++,u);return n.length=o,n}});var Hne=Yt,Lne=Un,jne=St,Fne=jne("match"),mE=function(e){var t;return Hne(e)&&((t=e[Fne])!==void 0?!!t:Lne(e)=="RegExp")},Bne=mE,Vne=TypeError,bE=function(e){if(Bne(e))throw Vne("The method doesn't accept regular expressions");return e},Wne=St,Une=Wne("match"),wE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[Une]=!1,"/./"[e](t)}catch{}}return!1},zne=$e,Yne=Ye,Gne=bE,Kne=Ar,D1=Kt,qne=wE,Xne=Yne("".indexOf);zne({target:"String",proto:!0,forced:!qne("includes")},{includes:function(t){return!!~Xne(D1(Kne(this)),D1(Gne(t)),arguments.length>1?arguments[1]:void 0)}});var Zne=Uo,Qne=gv,Jne=St,eoe=Gt,N1=Jne("species"),SV=function(e){var t=Zne(e);eoe&&t&&!t[N1]&&Qne(t,N1,{configurable:!0,get:function(){return this}})},toe=Rf,roe=gv,H1=C0,noe=dv,ooe=k0,ioe=_n,aoe=P0,loe=y0,fy=g0,soe=SV,Gf=Gt,L1=cv.fastKey,CV=zo,j1=CV.set,vw=CV.getterFor,_V={getConstructor:function(e,t,r,n){var o=e(function(u,f){ooe(u,i),j1(u,{type:t,index:toe(null),first:void 0,last:void 0,size:0}),Gf||(u.size=0),ioe(f)||aoe(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=vw(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,y;return d?d.value=c:(h.last=d={index:y=L1(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),Gf?h.size++:u.size++,y!=="F"&&(h.index[y]=d)),u},s=function(u,f){var c=a(u),h=L1(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return H1(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,Gf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),Gf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=noe(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),H1(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),Gf&&roe(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=vw(t),i=vw(n);loe(e,t,function(a,l){j1(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,fy(void 0,!0)):l=="keys"?fy(s.key,!1):l=="values"?fy(s.value,!1):fy([s.key,s.value],!1)},r?"entries":"values",!r,!0),soe(t)}},uoe=hm,foe=_V;uoe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},foe);var F1=jt,coe=yB,hoe=_n,doe=St,voe=doe("species"),yoe=function(e,t){var r=F1(e).constructor,n;return r===void 0||hoe(n=F1(r)[voe])?t:coe(n)},goe=ll,Kf=Zt,SE=Ye,poe=gm,moe=jt,boe=_n,woe=mE,B1=Ar,Soe=yoe,Coe=L0,_oe=nl,yw=Kt,Ooe=rl,V1=_0,W1=pm,Roe=ym,Eoe=H0,Toe=je,gl=Eoe.UNSUPPORTED_Y,U1=4294967295,Poe=Math.min,OV=[].push,koe=SE(/./.exec),pl=SE(OV),qf=SE("".slice),$oe=!Toe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});poe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=yw(B1(this)),l=i===void 0?U1:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!woe(o))return Kf(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=Kf(Roe,c,a))&&(d=c.lastIndex,!(d>f&&(pl(s,qf(a,f,h.index)),h.length>1&&h.index<a.length&&goe(OV,s,V1(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!koe(c,""))&&pl(s,""):pl(s,qf(a,f)),s.length>l?V1(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Kf(t,this,o,i)}:n=t,[function(i,a){var l=B1(this),s=boe(i)?void 0:Ooe(i,e);return s?Kf(s,i,l,a):Kf(n,yw(l),i,a)},function(o,i){var a=moe(this),l=yw(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=Soe(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(gl?"g":"y"),h=new u(gl?"^(?:"+a.source+")":a,c),d=i===void 0?U1:i>>>0;if(d===0)return[];if(l.length===0)return W1(h,l)===null?[l]:[];for(var v=0,y=0,m=[];y<l.length;){h.lastIndex=gl?0:y;var b=W1(h,gl?qf(l,y):l),S;if(b===null||(S=Poe(_oe(h.lastIndex+(gl?y:0)),l.length))===v)y=Coe(l,y,f);else{if(pl(m,qf(l,v,y)),m.length===d)return m;for(var C=1;C<=b.length-1;C++)if(pl(m,b[C]),m.length===d)return m;y=v=S}}return pl(m,qf(l,v)),m}]},!$oe,gl);function RV(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function FC(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Pc(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function Ft(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Wr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function We(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function A(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function EV(e){return Ft(e,function(t,r){return t+r},0)}function Aoe(e){return Ft(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function Ioe(e){return Ft(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function Moe(e){return e.length?EV(e)/e.length:0}function TV(e){return Ft(e,function(t,r){return t.concat(Array.isArray(r)?TV(r):r)},[])}function CE(e){var t=[];return A(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function BC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function xoe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return l.includes(s)})}),a}function Doe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return A(i,function(l){A(l,function(s){a.has(s)||a.add(s)})}),Array.from(a)}function VC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const Noe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Moe,arrayEach:A,arrayFilter:Wr,arrayFlatten:TV,arrayMap:We,arrayMax:Aoe,arrayMin:Ioe,arrayReduce:Ft,arraySum:EV,arrayUnique:CE,extendArray:FC,getDifferenceOfArrays:BC,getIntersectionOfArrays:xoe,getUnionOfArrays:Doe,pivot:Pc,stringToArray:VC,to2dArray:RV},Symbol.toStringTag,{value:"Module"}));function dt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=Ft(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var z1,Y1,G1,K1,q1,X1;function ns(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function WC(e){"@babel/helpers - typeof";return WC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WC(e)}function Dt(e){var t;switch(WC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ve(e){return typeof e<"u"}function mt(e){return typeof e>"u"}function Xt(e){return e===null||e===""||mt(e)}function PV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var wc="length",kc=function(t){return parseInt(t,16)},Z1=function(t){return parseInt(t,10)},Zg=function(t,r,n){return t.substr(r,n)},$c=function(t){return t.codePointAt(0)-65},UC=function(t){return"".concat(t).replace(/\-/g,"")},Hoe=function(t){return kc(Zg(UC(t),kc("12"),$c("F")))/(kc(Zg(UC(t),$c("B"),~~![][wc]))||9)},Loe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},Q1=!1,J1={invalid:function(){return dt(z1||(z1=ns([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(Y1||(Y1=ns([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return dt(G1||(G1=ns([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},eA={invalid:function(){return dt(K1||(K1=ns([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(q1||(q1=ns([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return dt(X1||(X1=ns([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function kV(e,t){var r=!Xt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="13.0.0",i,a="invalid",l="invalid";e=UC(e||"");var s=joe(e);if(r||n||s)if(s){var u=ee("22/06/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=Hoe(e);i=ee((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(Loe()&&(a="valid",l="valid"),!Q1&&a!=="valid"){var h=J1[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](J1[a]({keyValidityDate:i,hotVersion:o})),Q1=!0}if(l!=="valid"&&t.parentNode){var d=eA[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=eA[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function joe(e){var t=[][wc],r=t;if(e[wc]!==$c("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=$c(o.shift());i;i=$c(o.shift()||"A"))--i<""[wc]?r=r|(Z1("".concat(Z1(kc(n)+(kc(Zg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Zg(e,i,i?o[wc]===1?9:8:6);return r===t}const Foe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:kV,isDefined:ve,isEmpty:Xt,isRegExp:PV,isUndefined:mt,stringify:Dt},Symbol.toStringTag,{value:"Module"}));var Boe=Ir,tA=ev,Voe=en,Woe=function(t){for(var r=Boe(this),n=Voe(r),o=arguments.length,i=tA(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:tA(a,n);l>i;)r[i++]=t;return r},Uoe=$e,zoe=Woe,Yoe=nv;Uoe({target:"Array",proto:!0},{fill:zoe});Yoe("fill");var Goe=$e,Koe=Ir,$V=rv,qoe=je,Xoe=qoe(function(){$V(1)});Goe({target:"Object",stat:!0,forced:Xoe},{keys:function(t){return $V(Koe(t))}});var Zoe=al.forEach,Qoe=Pf,Joe=Qoe("forEach"),eie=Joe?[].forEach:function(t){return Zoe(this,t,arguments.length>1?arguments[1]:void 0)},rA=vt,nA=wF,tie=SF,gw=eie,rie=ol,AV=function(e){if(e&&e.forEach!==gw)try{rie(e,"forEach",gw)}catch{e.forEach=gw}};for(var pw in nA)nA[pw]&&AV(rA[pw]&&rA[pw].prototype);AV(tie);function oA(e,t,r){return t=nie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nie(e){var t=oie(e,"string");return Vo(t)==="symbol"?t:String(t)}function oie(e,t){if(Vo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vo(e){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(e)}function gs(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},ze(e,function(r,n){n!=="__children"&&(r&&Vo(r)==="object"&&!Array.isArray(r)?t[n]=gs(r):Array.isArray(r)?r.length&&Vo(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[gs(r[0])]:t[n]=[]:t[n]=null)})),t}function Ko(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function zt(e,t,r){var n=Array.isArray(r);return ze(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function Ov(e,t){ze(t,function(r,n){t[n]&&Vo(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Ov(e[n],t[n])):e[n]=t[n]})}function fr(e){return Vo(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Sr(e){var t={};return ze(e,function(r,n){t[n]=r}),t}function gt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return A(r,function(o){e.MIXINS.push(o.MIXIN_NAME),ze(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(y){var m=y;return(Array.isArray(m)||Ue(m))&&(m=fr(m)),m};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function Lm(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function Kn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function ze(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function IV(e,t){var r=t.split("."),n=e;return ze(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function ug(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(xt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function jm(e){if(!Ue(e))return 0;var t=function r(n){var o=0;return Ue(n)?ze(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Ba(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},oA(t,n,e),oA(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const iie=Object.freeze(Object.defineProperty({__proto__:null,clone:Sr,createObjectPropListener:Ba,deepClone:fr,deepExtend:Ov,deepObjectSize:jm,defineGetter:Kn,duckSchema:gs,extend:zt,getProperty:IV,hasOwnProperty:xt,inherit:Ko,isObject:Ue,isObjectEqual:Lm,mixin:gt,objectEach:ze,setProperty:ug},Symbol.toStringTag,{value:"Module"}));var kr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Ur={chrome:kr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:kr(function(e){return/CriOS/.test(e)}),edge:kr(function(e){return/Edge/.test(e)}),edgeWebKit:kr(function(e){return/EdgiOS/.test(e)}),firefox:kr(function(e){return/Firefox/.test(e)}),firefoxWebKit:kr(function(e){return/FxiOS/.test(e)}),ie:kr(function(e){return/Trident/.test(e)}),ie9:kr(function(){return!!document.documentMode}),mobile:kr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:kr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Af={mac:kr(function(e){return/^Mac/.test(e)}),win:kr(function(e){return/^Win/.test(e)}),linux:kr(function(e){return/^Linux/.test(e)}),ios:kr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function MV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;ze(Ur,function(i){var a=i.test;return void a(r,o)})}function xV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;ze(Af,function(n){var o=n.test;return void o(r)})}MV();xV();function _E(){return Ur.chrome.value}function DV(){return Ur.chromeWebKit.value}function fg(){return Ur.firefox.value}function NV(){return Ur.firefoxWebKit.value}function HV(){return Ur.safari.value}function LV(){return Ur.edge.value}function aie(){return Ur.edgeWebKit.value}function jV(){return Ur.ie.value}function FV(){return Ur.ie9.value}function lie(){return Ur.ie.value||Ur.edge.value}function pn(){return Ur.mobile.value}function OE(){return Af.ios.value}function RE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Af.mac.value}function zC(){return Af.win.value}function Qg(){return Af.mac.value}function sie(){return Af.linux.value}const uie=Object.freeze(Object.defineProperty({__proto__:null,isChrome:_E,isChromeWebKit:DV,isEdge:LV,isEdgeWebKit:aie,isFirefox:fg,isFirefoxWebKit:NV,isIE:jV,isIE9:FV,isIOS:OE,isIpadOS:RE,isLinuxOS:sie,isMSBrowser:lie,isMacOS:Qg,isMobileBrowser:pn,isSafari:HV,isWindowsOS:zC,setBrowserMeta:MV,setPlatformMeta:xV},Symbol.toStringTag,{value:"Module"}));var me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:fg()?182:174,AUDIO_MUTE:fg()?181:173,AUDIO_UP:fg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},fie=[me.ALT,me.ARROW_DOWN,me.ARROW_LEFT,me.ARROW_RIGHT,me.ARROW_UP,me.AUDIO_DOWN,me.AUDIO_MUTE,me.AUDIO_UP,me.BACKSPACE,me.CAPS_LOCK,me.DELETE,me.END,me.ENTER,me.ESCAPE,me.F1,me.F2,me.F3,me.F4,me.F5,me.F6,me.F7,me.F8,me.F9,me.F10,me.F11,me.F12,me.F13,me.F14,me.F15,me.F16,me.F17,me.F18,me.F19,me.HOME,me.INSERT,me.MEDIA_NEXT,me.MEDIA_PLAY_PAUSE,me.MEDIA_PREV,me.MEDIA_STOP,me.NULL,me.NUM_LOCK,me.PAGE_DOWN,me.PAGE_UP,me.PAUSE,me.SCROLL_LOCK,me.SHIFT,me.TAB];function BV(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function EE(e){return fie.includes(e)}function cie(e){var t=[];return Qg()?t.push(me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX):t.push(me.CONTROL),t.includes(e)}function VV(e){return[me.CONTROL,me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX].includes(e)}function ps(e,t){var r=t.split("|"),n=!1;return A(r,function(o){if(e===me[o])return n=!0,!1}),n}const hie=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:me,isCtrlKey:cie,isCtrlMetaKey:VV,isFunctionKey:EE,isKey:ps,isPrintableChar:BV},Symbol.toStringTag,{value:"Module"}));function wn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function la(e){return e.isImmediatePropagationEnabled===!1}function $i(e){return e.button===2}function Fm(e){return e.button===0}const die=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:la,isLeftClick:Fm,isRightClick:$i,stopImmediatePropagation:wn},Symbol.toStringTag,{value:"Module"}));var vie=_r.f,yie=function(e,t,r){r in e||vie(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},gie=Gt,TE=vt,Rv=Ye,pie=sm,mie=$0,bie=ol,wie=il.f,iA=Di,Sie=mE,aA=Kt,Cie=CB,WV=H0,_ie=yie,Oie=tn,Rie=je,Eie=Nt,Tie=zo.enforce,Pie=SV,kie=St,UV=AF,zV=IF,$ie=kie("match"),gi=TE.RegExp,zl=gi.prototype,Aie=TE.SyntaxError,Iie=Rv(zl.exec),Jg=Rv("".charAt),lA=Rv("".replace),sA=Rv("".indexOf),Mie=Rv("".slice),xie=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,ja=/a/g,mw=/a/g,Die=new gi(ja)!==ja,YV=WV.MISSED_STICKY,Nie=WV.UNSUPPORTED_Y,Hie=gie&&(!Die||YV||UV||zV||Rie(function(){return mw[$ie]=!1,gi(ja)!=ja||gi(mw)==mw||gi(ja,"i")!="/a/i"})),Lie=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Jg(e,r),i==="\\"){n+=i+Jg(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},jie=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=Jg(e,r),f==="\\")f=f+Jg(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":Iie(xie,Mie(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||Eie(i,u))throw new Aie("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(pie("RegExp",Hie)){for(var Wi=function(t,r){var n=iA(zl,this),o=Sie(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Wi)return t;if((o||iA(zl,t))&&(t=t.source,i&&(r=Cie(l))),t=t===void 0?"":aA(t),r=r===void 0?"":aA(r),l=t,UV&&"dotAll"in ja&&(u=!!r&&sA(r,"s")>-1,u&&(r=lA(r,/s/g,""))),s=r,YV&&"sticky"in ja&&(f=!!r&&sA(r,"y")>-1,f&&Nie&&(r=lA(r,/y/g,""))),zV&&(c=jie(t),t=c[0],a=c[1]),h=mie(gi(t,r),n?this:zl,Wi),(u||f||a.length)&&(d=Tie(h),u&&(d.dotAll=!0,d.raw=Wi(Lie(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{bie(h,"source",l===""?"(?:)":l)}catch{}return h},uA=wie(gi),fA=0;uA.length>fA;)_ie(Wi,gi,uA[fA++]);zl.constructor=Wi,Wi.prototype=zl,Oie(TE,"RegExp",Wi,{constructor:!0})}Pie("RegExp");var Fie=$e,Bie=Ye,Vie=Zd,Wie=zr,Uie=Pf,zie=Bie([].join),Yie=Vie!=Object,Gie=Yie||!Uie("join",",");Fie({target:"Array",proto:!0,forced:Gie},{join:function(t){return zie(Wie(this),t===void 0?",":t)}});function YC(e){"@babel/helpers - typeof";return YC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YC(e)}function Bm(e){return window.requestAnimationFrame(e)}function GV(){return!!document.documentElement.classList}function KV(){return!!document.createTextNode("test").textContent}function qV(){return!!window.getComputedStyle}function qc(e){window.cancelAnimationFrame(e)}function PE(){return"ontouchstart"in window}var GC;function Kie(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),GC=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function kE(){return GC===void 0&&Kie(),GC}var ml;function XV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ml||((typeof Intl>"u"?"undefined":YC(Intl))==="object"?ml=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?ml=function(n,o){return"".concat(n).localeCompare(o)}:ml=function(n,o){return n===o?0:n>o?-1:1},ml)}var Xf;function ZV(){if(Xf!==void 0)return Xf;try{var e={get passive(){Xf=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Xf=!1}return Xf}const qie=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:qc,getComparisonFunction:XV,hasCaptionProblem:kE,isClassListSupported:GV,isGetComputedStyleSupported:qV,isPassiveEventSupported:ZV,isTextContentSupported:KV,isTouchSupported:PE,requestAnimationFrame:Bm},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function ui(e){"@babel/helpers - typeof";return ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(e)}function KC(e,t){return KC=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},KC(e,t)}function Xie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cg(e,t,r){return Xie()?cg=Reflect.construct:cg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&KC(u,a.prototype),u},cg.apply(null,arguments)}function fn(e){return Zie(e)||Qie(e)||Jie(e)||eae()}function Zie(e){if(Array.isArray(e))return qC(e)}function Qie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jie(e,t){if(e){if(typeof e=="string")return qC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qC(e,t)}}function qC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tae=Object.hasOwnProperty,cA=Object.setPrototypeOf,rae=Object.isFrozen,nae=Object.getPrototypeOf,oae=Object.getOwnPropertyDescriptor,Cr=Object.freeze,Sn=Object.seal,iae=Object.create,QV=typeof Reflect<"u"&&Reflect,ep=QV.apply,XC=QV.construct;ep||(ep=function(t,r,n){return t.apply(r,n)});Cr||(Cr=function(t){return t});Sn||(Sn=function(t){return t});XC||(XC=function(t,r){return cg(t,fn(r))});var aae=Jr(Array.prototype.forEach),hA=Jr(Array.prototype.pop),Zf=Jr(Array.prototype.push),hg=Jr(String.prototype.toLowerCase),bw=Jr(String.prototype.toString),lae=Jr(String.prototype.match),ln=Jr(String.prototype.replace),sae=Jr(String.prototype.indexOf),uae=Jr(String.prototype.trim),vr=Jr(RegExp.prototype.test),ww=fae(TypeError);function Jr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return ep(e,t,n)}}function fae(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return XC(e,r)}}function Xe(e,t,r){r=r||hg,cA&&cA(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(rae(t)||(t[n]=i),o=i)}e[o]=!0}return e}function Ui(e){var t=iae(null),r;for(r in e)ep(tae,e,[r])===!0&&(t[r]=e[r]);return t}function cy(e,t){for(;e!==null;){var r=oae(e,t);if(r){if(r.get)return Jr(r.get);if(typeof r.value=="function")return Jr(r.value)}e=nae(e)}function n(o){return console.warn("fallback value for",o),null}return n}var dA=Cr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Sw=Cr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Cw=Cr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),cae=Cr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_w=Cr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),hae=Cr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),vA=Cr(["#text"]),yA=Cr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ow=Cr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gA=Cr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),hy=Cr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dae=Sn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),vae=Sn(/<%[\w\W]*|[\w\W]*%>/gm),yae=Sn(/\${[\w\W]*}/gm),gae=Sn(/^data-[\-\w.\u00B7-\uFFFF]/),pae=Sn(/^aria-[\-\w]+$/),mae=Sn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bae=Sn(/^(?:\w+script|data):/i),wae=Sn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Sae=Sn(/^html$/i),Cae=function(){return typeof window>"u"?null:window},_ae=function(t,r){if(ui(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function JV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Cae(),t=function(H){return JV(H)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,y=cy(v,"cloneNode"),m=cy(v,"nextSibling"),b=cy(v,"childNodes"),S=cy(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var k=_ae(d,r),O=k?k.createHTML(""):"",B=n,z=B.implementation,q=B.createNodeIterator,G=B.createDocumentFragment,X=B.getElementsByTagName,Q=r.importNode,oe={};try{oe=Ui(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof S=="function"&&z&&typeof z.createHTMLDocument<"u"&&oe!==9;var ue=dae,he=vae,Oe=yae,we=gae,$=pae,P=bae,g=wae,p=mae,w=null,E=Xe({},[].concat(fn(dA),fn(Sw),fn(Cw),fn(_w),fn(vA))),R=null,F=Xe({},[].concat(fn(yA),fn(Ow),fn(gA),fn(hy))),x=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Z=null,re=!0,ie=!0,se=!1,_e=!0,Se=!1,U=!1,Ne=!1,Be=!1,ke=!1,Ie=!1,Ae=!1,_=!0,T=!1,I="user-content-",j=!0,M=!1,V={},N=null,D=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),W=null,L=Xe({},["audio","video","img","source","image","track"]),Y=null,le=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",He="http://www.w3.org/1999/xhtml",Ze=He,st=!1,Ge=null,Me=Xe({},[pe,Re,He],bw),De,dr=["application/xhtml+xml","text/html"],Bt="text/html",Ve,et=null,Ct=n.createElement("form"),ut=function(H){return H instanceof RegExp||H instanceof Function},ft=function(H){et&&et===H||((!H||ui(H)!=="object")&&(H={}),H=Ui(H),De=dr.indexOf(H.PARSER_MEDIA_TYPE)===-1?De=Bt:De=H.PARSER_MEDIA_TYPE,Ve=De==="application/xhtml+xml"?bw:hg,w="ALLOWED_TAGS"in H?Xe({},H.ALLOWED_TAGS,Ve):E,R="ALLOWED_ATTR"in H?Xe({},H.ALLOWED_ATTR,Ve):F,Ge="ALLOWED_NAMESPACES"in H?Xe({},H.ALLOWED_NAMESPACES,bw):Me,Y="ADD_URI_SAFE_ATTR"in H?Xe(Ui(le),H.ADD_URI_SAFE_ATTR,Ve):le,W="ADD_DATA_URI_TAGS"in H?Xe(Ui(L),H.ADD_DATA_URI_TAGS,Ve):L,N="FORBID_CONTENTS"in H?Xe({},H.FORBID_CONTENTS,Ve):D,K="FORBID_TAGS"in H?Xe({},H.FORBID_TAGS,Ve):{},Z="FORBID_ATTR"in H?Xe({},H.FORBID_ATTR,Ve):{},V="USE_PROFILES"in H?H.USE_PROFILES:!1,re=H.ALLOW_ARIA_ATTR!==!1,ie=H.ALLOW_DATA_ATTR!==!1,se=H.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=H.SAFE_FOR_TEMPLATES||!1,U=H.WHOLE_DOCUMENT||!1,ke=H.RETURN_DOM||!1,Ie=H.RETURN_DOM_FRAGMENT||!1,Ae=H.RETURN_TRUSTED_TYPE||!1,Be=H.FORCE_BODY||!1,_=H.SANITIZE_DOM!==!1,T=H.SANITIZE_NAMED_PROPS||!1,j=H.KEEP_CONTENT!==!1,M=H.IN_PLACE||!1,p=H.ALLOWED_URI_REGEXP||p,Ze=H.NAMESPACE||He,x=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&ut(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&ut(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(ie=!1),Ie&&(ke=!0),V&&(w=Xe({},fn(vA)),R=[],V.html===!0&&(Xe(w,dA),Xe(R,yA)),V.svg===!0&&(Xe(w,Sw),Xe(R,Ow),Xe(R,hy)),V.svgFilters===!0&&(Xe(w,Cw),Xe(R,Ow),Xe(R,hy)),V.mathMl===!0&&(Xe(w,_w),Xe(R,gA),Xe(R,hy))),H.ADD_TAGS&&(w===E&&(w=Ui(w)),Xe(w,H.ADD_TAGS,Ve)),H.ADD_ATTR&&(R===F&&(R=Ui(R)),Xe(R,H.ADD_ATTR,Ve)),H.ADD_URI_SAFE_ATTR&&Xe(Y,H.ADD_URI_SAFE_ATTR,Ve),H.FORBID_CONTENTS&&(N===D&&(N=Ui(N)),Xe(N,H.FORBID_CONTENTS,Ve)),j&&(w["#text"]=!0),U&&Xe(w,["html","head","body"]),w.table&&(Xe(w,["tbody"]),delete K.tbody),Cr&&Cr(H),et=H)},tt=Xe({},["mi","mo","mn","ms","mtext"]),qo=Xe({},["foreignobject","desc","title","annotation-xml"]),yb=Xe({},["title","style","font","a","script"]),ji=Xe({},Sw);Xe(ji,Cw),Xe(ji,cae);var Lf=Xe({},_w);Xe(Lf,hae);var DY=function(H){var ae=S(H);(!ae||!ae.tagName)&&(ae={namespaceURI:Ze,tagName:"template"});var de=hg(H.tagName),lt=hg(ae.tagName);return Ge[H.namespaceURI]?H.namespaceURI===Re?ae.namespaceURI===He?de==="svg":ae.namespaceURI===pe?de==="svg"&&(lt==="annotation-xml"||tt[lt]):!!ji[de]:H.namespaceURI===pe?ae.namespaceURI===He?de==="math":ae.namespaceURI===Re?de==="math"&&qo[lt]:!!Lf[de]:H.namespaceURI===He?ae.namespaceURI===Re&&!qo[lt]||ae.namespaceURI===pe&&!tt[lt]?!1:!Lf[de]&&(yb[de]||!ji[de]):!!(De==="application/xhtml+xml"&&Ge[H.namespaceURI]):!1},qn=function(H){Zf(t.removed,{element:H});try{H.parentNode.removeChild(H)}catch{try{H.outerHTML=O}catch{H.remove()}}},gb=function(H,ae){try{Zf(t.removed,{attribute:ae.getAttributeNode(H),from:ae})}catch{Zf(t.removed,{attribute:null,from:ae})}if(ae.removeAttribute(H),H==="is"&&!R[H])if(ke||Ie)try{qn(ae)}catch{}else try{ae.setAttribute(H,"")}catch{}},sk=function(H){var ae,de;if(Be)H="<remove></remove>"+H;else{var lt=lae(H,/^[\r\n\t ]+/);de=lt&&lt[0]}De==="application/xhtml+xml"&&Ze===He&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");var Rr=k?k.createHTML(H):H;if(Ze===He)try{ae=new h().parseFromString(Rr,De)}catch{}if(!ae||!ae.documentElement){ae=z.createDocument(Ze,"template",null);try{ae.documentElement.innerHTML=st?O:Rr}catch{}}var ir=ae.body||ae.documentElement;return H&&de&&ir.insertBefore(n.createTextNode(de),ir.childNodes[0]||null),Ze===He?X.call(ae,U?"html":"body")[0]:U?ae.documentElement:ir},uk=function(H){return q.call(H.ownerDocument||H,H,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},NY=function(H){return H instanceof c&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof f)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},jf=function(H){return ui(a)==="object"?H instanceof a:H&&ui(H)==="object"&&typeof H.nodeType=="number"&&typeof H.nodeName=="string"},Xn=function(H,ae,de){J[H]&&aae(J[H],function(lt){lt.call(t,ae,de,et)})},fk=function(H){var ae;if(Xn("beforeSanitizeElements",H,null),NY(H)||vr(/[\u0080-\uFFFF]/,H.nodeName))return qn(H),!0;var de=Ve(H.nodeName);if(Xn("uponSanitizeElement",H,{tagName:de,allowedTags:w}),H.hasChildNodes()&&!jf(H.firstElementChild)&&(!jf(H.content)||!jf(H.content.firstElementChild))&&vr(/<[/\w]/g,H.innerHTML)&&vr(/<[/\w]/g,H.textContent)||de==="select"&&vr(/<template/i,H.innerHTML))return qn(H),!0;if(!w[de]||K[de]){if(!K[de]&&hk(de)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de)))return!1;if(j&&!N[de]){var lt=S(H)||H.parentNode,Rr=b(H)||H.childNodes;if(Rr&&lt)for(var ir=Rr.length,or=ir-1;or>=0;--or)lt.insertBefore(y(Rr[or],!0),m(H))}return qn(H),!0}return H instanceof l&&!DY(H)||(de==="noscript"||de==="noembed")&&vr(/<\/no(script|embed)/i,H.innerHTML)?(qn(H),!0):(Se&&H.nodeType===3&&(ae=H.textContent,ae=ln(ae,ue," "),ae=ln(ae,he," "),ae=ln(ae,Oe," "),H.textContent!==ae&&(Zf(t.removed,{element:H.cloneNode()}),H.textContent=ae)),Xn("afterSanitizeElements",H,null),!1)},ck=function(H,ae,de){if(_&&(ae==="id"||ae==="name")&&(de in n||de in Ct))return!1;if(!(ie&&!Z[ae]&&vr(we,ae))){if(!(re&&vr($,ae))){if(!R[ae]||Z[ae]){if(!(hk(H)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,H)||x.tagNameCheck instanceof Function&&x.tagNameCheck(H))&&(x.attributeNameCheck instanceof RegExp&&vr(x.attributeNameCheck,ae)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(ae))||ae==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de))))return!1}else if(!Y[ae]){if(!vr(p,ln(de,g,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&H!=="script"&&sae(de,"data:")===0&&W[H])){if(!(se&&!vr(P,ln(de,g,"")))){if(de)return!1}}}}}}return!0},hk=function(H){return H.indexOf("-")>0},dk=function(H){var ae,de,lt,Rr;Xn("beforeSanitizeAttributes",H,null);var ir=H.attributes;if(ir){var or={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};for(Rr=ir.length;Rr--;){ae=ir[Rr];var Wv=ae,er=Wv.name,pb=Wv.namespaceURI;if(de=er==="value"?ae.value:uae(ae.value),lt=Ve(er),or.attrName=lt,or.attrValue=de,or.keepAttr=!0,or.forceKeepAttr=void 0,Xn("uponSanitizeAttribute",H,or),de=or.attrValue,!or.forceKeepAttr&&(gb(er,H),!!or.keepAttr)){if(!_e&&vr(/\/>/i,de)){gb(er,H);continue}Se&&(de=ln(de,ue," "),de=ln(de,he," "),de=ln(de,Oe," "));var vk=Ve(H.nodeName);if(ck(vk,lt,de)){if(T&&(lt==="id"||lt==="name")&&(gb(er,H),de=I+de),k&&ui(d)==="object"&&typeof d.getAttributeType=="function"&&!pb)switch(d.getAttributeType(vk,lt)){case"TrustedHTML":de=k.createHTML(de);break;case"TrustedScriptURL":de=k.createScriptURL(de);break}try{pb?H.setAttributeNS(pb,er,de):H.setAttribute(er,de),hA(t.removed)}catch{}}}}Xn("afterSanitizeAttributes",H,null)}},HY=function Ee(H){var ae,de=uk(H);for(Xn("beforeSanitizeShadowDOM",H,null);ae=de.nextNode();)Xn("uponSanitizeShadowNode",ae,null),!fk(ae)&&(ae.content instanceof o&&Ee(ae.content),dk(ae));Xn("afterSanitizeShadowDOM",H,null)};return t.sanitize=function(Ee){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,de,lt,Rr,ir;if(st=!Ee,st&&(Ee="<!-->"),typeof Ee!="string"&&!jf(Ee)){if(typeof Ee.toString!="function")throw ww("toString is not a function");if(Ee=Ee.toString(),typeof Ee!="string")throw ww("dirty is not a string, aborting")}if(!t.isSupported){if(ui(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(jf(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Ne||ft(H),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var or=Ve(Ee.nodeName);if(!w[or]||K[or])throw ww("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)ae=sk("<!---->"),de=ae.ownerDocument.importNode(Ee,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?ae=de:ae.appendChild(de);else{if(!ke&&!Se&&!U&&Ee.indexOf("<")===-1)return k&&Ae?k.createHTML(Ee):Ee;if(ae=sk(Ee),!ae)return ke?null:Ae?O:""}ae&&Be&&qn(ae.firstChild);for(var Wv=uk(M?Ee:ae);lt=Wv.nextNode();)lt.nodeType===3&&lt===Rr||fk(lt)||(lt.content instanceof o&&HY(lt.content),dk(lt),Rr=lt);if(Rr=null,M)return Ee;if(ke){if(Ie)for(ir=G.call(ae.ownerDocument);ae.firstChild;)ir.appendChild(ae.firstChild);else ir=ae;return(R.shadowroot||R.shadowrootmod)&&(ir=Q.call(r,ir,!0)),ir}var er=U?ae.outerHTML:ae.innerHTML;return U&&w["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&vr(Sae,ae.ownerDocument.doctype.name)&&(er="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+er),Se&&(er=ln(er,ue," "),er=ln(er,he," "),er=ln(er,Oe," ")),k&&Ae?k.createHTML(er):er},t.setConfig=function(Ee){ft(Ee),Ne=!0},t.clearConfig=function(){et=null,Ne=!1},t.isValidAttribute=function(Ee,H,ae){et||ft({});var de=Ve(Ee),lt=Ve(H);return ck(de,lt,ae)},t.addHook=function(Ee,H){typeof H=="function"&&(J[Ee]=J[Ee]||[],Zf(J[Ee],H))},t.removeHook=function(Ee){if(J[Ee])return hA(J[Ee])},t.removeHooks=function(Ee){J[Ee]&&(J[Ee]=[])},t.removeAllHooks=function(){J={}},t}var Oae=JV();function ur(e){return e[0].toUpperCase()+e.substr(1)}function Rae(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=Dt(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function $E(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function AE(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function IE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function ZC(e){return Vm("".concat(e),{ALLOWED_TAGS:[]})}function Vm(e,t){return Oae.sanitize(e,t)}const Eae=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Rae,isPercentValue:AE,randomString:$E,sanitize:Vm,stripTags:ZC,substitute:IE,toUpperCaseFirst:ur},Symbol.toStringTag,{value:"Module"}));function pA(e){return $ae(e)||kae(e)||Pae(e)||Tae()}function Tae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pae(e,t){if(e){if(typeof e=="string")return QC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QC(e,t)}}function kae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $ae(e){if(Array.isArray(e))return QC(e)}function QC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eW(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function tW(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Xc(e){return tW(e)&&e.parent}function Aae(e){return!!Object.getPrototypeOf(e.parent)}function pi(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function Sc(e,t,r){for(var n=[],o=e;o&&(o=pi(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function mi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function rW(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function li(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var JC,e_,t_;function dy(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(GV()){var mA=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};JC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},e_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=dy(o),o.length>0)if(mA(n)){var i;(i=t.classList).add.apply(i,pA(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},t_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=dy(o),o.length>0)if(mA(n)){var i;(i=t.classList).remove.apply(i,pA(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var Rw=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};JC=function(t,r){return t.className!==void 0&&Rw(r).test(t.className)},e_=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=dy(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!Rw(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},t_=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=dy(i);i[n];)o=o.replace(Rw(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return JC(e,t)}function te(e,t){e_(e,t)}function Le(e,t){t_(e,t)}function ME(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)ME(t[r])}function Cn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var nW=/(<(.*)>|&(.*);)/;function ul(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;nW.test(t)?e.innerHTML=r?Vm(t):t:Ai(e,t)}function Ai(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?KV?r.textContent=t:r.data=t:(Cn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function ms(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ms(r.host.impl);if(r.host)return ms(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Ut(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(kE()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function bs(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Va(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Zc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?bs(t):e.scrollTop}function tp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Va(t):e.scrollLeft}function Qc(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=qV(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function Wa(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ii(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function ws(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ii(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function Iae(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ii(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ht(e){return e.offsetWidth}function Pt(e){return kE()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function ho(e){return e.clientHeight||e.innerHeight}function Ac(e){return e.clientWidth||e.innerWidth}function Mae(e,t,r){e.addEventListener(t,r,!1)}function xae(e,t,r){e.removeEventListener(t,r,!1)}function xE(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function oW(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function iW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function r_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Ev(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var Ew;function Dae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Jt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ew===void 0&&(Ew=Dae(e)),Ew}function aW(e){return e.offsetWidth!==e.clientWidth}function lW(e){return e.offsetHeight!==e.clientHeight}function Wm(e,t,r){FV()?(e.style.top=r,e.style.left=t):HV()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Nae(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function Tv(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Jc(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Um(e){return Jc(e)&&e.hasAttribute("data-hot-input")===!1}function sW(e){var t=e.ownerDocument.activeElement;Um(t)||e.select()}function DE(e){return!e.parentNode}function uW(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const Hae=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:nW,addClass:te,addEvent:Mae,clearTextSelection:r_,closest:pi,closestDown:Sc,empty:Cn,fastInnerHTML:ul,fastInnerText:Ai,getCaretPosition:xE,getComputedStyle:Ii,getCssTransform:Nae,getFrameElement:tW,getParent:eW,getParentWindow:Xc,getScrollLeft:tp,getScrollTop:Zc,getScrollableElement:Qc,getScrollbarWidth:Jt,getSelectionEndPosition:oW,getSelectionText:iW,getStyle:ws,getTrimmingContainer:Wa,getWindowScrollLeft:Va,getWindowScrollTop:bs,hasAccessToParentWindow:Aae,hasClass:xe,hasHorizontalScrollbar:lW,hasVerticalScrollbar:aW,index:rW,innerHeight:ho,innerWidth:Ac,isChildOf:mi,isDetached:DE,isInput:Jc,isOutsideInput:Um,isVisible:ms,matchesCSSRules:Iae,observeVisibilityChangeOnce:uW,offset:Ut,outerHeight:Pt,outerWidth:ht,overlayContainsElement:li,removeClass:Le,removeEvent:xae,removeTextNodes:ME,resetCssTransform:Tv,selectElementIfAllowed:sW,setCaretPosition:Ev,setOverlayPosition:Wm},Symbol.toStringTag,{value:"Module"}));var Lae=hm,jae=_V;Lae("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},jae);var Fae=Gt,Bae=Tf,Vae=TypeError,Wae=Object.getOwnPropertyDescriptor,Uae=Fae&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),zae=Uae?function(e,t){if(Bae(e)&&!Wae(e,"length").writable)throw Vae("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Yae=$e,Gae=Ir,Kae=ev,qae=Ni,Xae=en,Zae=zae,Qae=bV,Jae=I0,ele=Ef,Tw=EF,tle=yv,rle=tle("splice"),nle=Math.max,ole=Math.min;Yae({target:"Array",proto:!0,forced:!rle},{splice:function(t,r){var n=Gae(this),o=Xae(n),i=Kae(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=ole(nle(qae(r),0),o-i)),Qae(o+l-s),u=Jae(n,s),f=0;f<s;f++)c=i+f,c in n&&ele(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:Tw(n,h);for(f=o;f>o-s+l;f--)Tw(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:Tw(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return Zae(n,o-s+l),u}});function wt(){if(ve(console)){var e;(e=console).warn.apply(e,arguments)}}function NE(){if(ve(console)){var e;(e=console).error.apply(e,arguments)}}var ile=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",ale=TypeError,fW=function(e,t){if(e<t)throw ale("Not enough arguments");return e},cW=vt,lle=ll,sle=Rt,ule=ile,fle=el,cle=mv,hle=fW,dle=cW.Function,vle=/MSIE .\./.test(fle)||ule&&function(){var e=cW.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),HE=function(e,t){var r=t?2:1;return vle?function(n,o){var i=hle(arguments.length,1)>r,a=sle(n)?n:dle(n),l=i?cle(arguments,r):[],s=i?function(){lle(a,this,l)}:a;return t?e(s,o):e(s)}:e},yle=$e,hW=vt,gle=HE,bA=gle(hW.setInterval,!0);yle({global:!0,bind:!0,forced:hW.setInterval!==bA},{setInterval:bA});var ple=$e,dW=vt,mle=HE,wA=mle(dW.setTimeout,!0);ple({global:!0,bind:!0,forced:dW.setTimeout!==wA},{setTimeout:wA});var ble=$e,wle=Ye,Sle=Tf,Cle=wle([].reverse),SA=[1,2];ble({target:"Array",proto:!0,forced:String(SA)===String(SA.reverse())},{reverse:function(){return Sle(this)&&(this.length=this.length),Cle(this)}});function pt(e){return typeof e=="function"}function vW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,s),r=0,o=void 0},h)),n}return i}function _le(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=vW(e,t),o=r;function i(){o=r}function a(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return o?(o-=1,e.apply(this,s)):n.apply(this,s)}return a.clearHits=i,a}function LE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function Ole(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return Ft(o,function(u,f){return f(u)},n.apply(this,l))}}function jE(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function yW(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function Rle(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a.reverse()),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function rp(e,t,r,n,o,i,a,l){return ve(l)?e.call(t,r,n,o,i,a,l):ve(a)?e.call(t,r,n,o,i,a):ve(i)?e.call(t,r,n,o,i):ve(o)?e.call(t,r,n,o):ve(n)?e.call(t,r,n):ve(r)?e.call(t,r):e.call(t)}const Ele=Object.freeze(Object.defineProperty({__proto__:null,curry:yW,curryRight:Rle,debounce:LE,fastCall:rp,isFunction:pt,partial:jE,pipe:Ole,throttle:vW,throttleAfterHits:_le},Symbol.toStringTag,{value:"Module"}));function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}var CA;function Tle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kle(n.key),n)}}function Ple(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kle(e){var t=$le(e,"string");return eh(t)==="symbol"?t:String(t)}function $le(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ale(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var bl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Ile=dt(CA||(CA=Ale([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Pw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),kw=new Map([]),gW=function(){function e(){Tle(this,e),this.globalBucket=this.createEmptyBucket()}return Ple(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return A(bl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))A(n,function(s){return o.add(r,s,i)});else{Pw.has(r)&&wt(IE(Ile,{hookName:r,removedInVersion:Pw.get(r)})),kw.has(r)&&wt(kw.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&A(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?A(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=rp(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],y=v?v.length:0,m=0;if(y)for(;m<y;){if(!v[m]||v[m].skip){m+=1;continue}var b=rp(v[m],r,o,i,a,l,s,u);b!==void 0&&(o=b),v[m]&&v[m].runOnce&&this.remove(n,v[m],r),m+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ze(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||bl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&bl.splice(bl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return kw.has(r)||Pw.has(r)}},{key:"isRegistered",value:function(r){return bl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return bl}}],[{key:"getSingleton",value:function(){return xle()}}]),e}(),Mle=new gW;function xle(){return Mle}const ge=gW;function OA(e){return Lle(e)||Hle(e)||Nle(e)||Dle()}function Dle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nle(e,t){if(e){if(typeof e=="string")return n_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n_(e,t)}}function Hle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lle(e){if(Array.isArray(e))return n_(e)}function n_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $w=new Map;function on(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";$w.has(e)||$w.set(e,new Map);var t=$w.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return OA(t.keys())}function a(){return OA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var o_=new WeakMap,Pv=on("editors"),jle=Pv.register,pW=Pv.getItem,mW=Pv.hasItem,Fle=Pv.getNames;Pv.getValues;function Ble(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ge.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function bW(e,t){var r;if(typeof e=="function")o_.get(e)||Pr(null,e),r=o_.get(e);else if(typeof e=="string")r=pW(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function np(e){if(typeof e=="function")return e;if(!mW(e))throw Error('No registered editor found under "'.concat(e,'" name'));return pW(e).getConstructor()}function Pr(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new Ble(t);typeof e=="string"&&jle(e,r),o_.set(t,r)}function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function Vle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ule(n.key),n)}}function Wle(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ule(e){var t=zle(e,"string");return th(t)==="symbol"?t:String(t)}function zle(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dg=0,Yle=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vle(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Wle(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,Gle(s))}return typeof a!="boolean"&&!ZV()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),dg+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),dg-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),dg-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function Gle(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),wn(this)},e}const kt=Yle;function Kle(){return dg}function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function qle(e,t){return Jle(e)||Qle(e,t)||Zle(e,t)||Xle()}function Xle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zle(e,t){if(e){if(typeof e=="string")return EA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EA(e,t)}}function EA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Jle(e){if(Array.isArray(e))return e}function ese(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rse(n.key),n)}}function tse(e,t,r){return t&&TA(e.prototype,t),r&&TA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rse(e){var t=nse(e,"string");return rh(t)==="symbol"?t:String(t)}function nse(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zm="editorManager.navigation",Ic="editorManager.handlingEditor",i_=function(){function e(t,r,n){var o=this;ese(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new kt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return tse(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:Ic};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),wn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=qle(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&Um(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=bW(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!EE(o)&&!VV(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ve(n.instance.getSelected())},group:zm};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),PA=new WeakMap;i_.getInstance=function(e,t,r){var n=PA.get(e);return n||(n=new i_(e,t,r),PA.set(e,n)),n};const ose=i_;var ise="hooksRefRegisterer",wW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;A(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;ze(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Kn(wW,"MIXIN_NAME",ise,{writable:!1,enumerable:!1});const ase=wW;function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function lse(e,t){return cse(e)||fse(e,t)||use(e,t)||sse()}function sse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function use(e,t){if(e){if(typeof e=="string")return kA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kA(e,t)}}function kA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cse(e){if(Array.isArray(e))return e}function hse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a_(e,t)}function a_(e,t){return a_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},a_(e,t)}function dse(e){var t=gse();return function(){var n=op(e),o;if(t){var i=op(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vse(this,o)}}function vse(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yse(e)}function yse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function op(e){return op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},op(e)}function $A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pse(n.key),n)}}function IA(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pse(e){var t=mse(e,"string");return Ss(t)==="symbol"?t:String(t)}function mse(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bse="base",tr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),l_="baseEditor",If=function(){function e(t){$A(this,e),this.hot=t,this.instance=t,this.state=tr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return IA(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=tr.VIRGIN}},{key:"extend",value:function(){return function(r){hse(o,r);var n=dse(o);function o(){return $A(this,o),n.apply(this,arguments)}return IA(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=lse(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),y={runOnlyIf:function(){return ve(o.hot.getSelected())},group:l_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===tr.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=tr.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:Dt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(l_),u.removeShortcutsByGroup(zm),this.state===tr.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===tr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=tr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=tr.FINISHED,i.discardEditor(c)}):(this.state=tr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=tr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===tr.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=tr.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=tr.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===tr.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Ut(n),u=ht(n),f=Ut(this.hot.rootElement),c=ht(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,y=d!==l?d.scrollLeft:0,m=l.innerWidth-f.left-c,b=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=b.wtTable,C=S.name,k=["master","inline_start"].includes(C)?v:0,O=["master","top","bottom"].includes(C)?y:0,B=s.top===f.top?0:1,z=s.top-f.top-B-k,q=0;this.hot.isRtl()?q=l.innerWidth-s.left-u-m-1+O:q=s.left-f.left-1-O,["top","top_inline_start_corner"].includes(C)&&(z+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(q+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var G=this.hot.hasColHeaders(),X=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),oe=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=oe-this.hot.view._wt.getSetting("fixedRowsBottom");(G&&X<=0||X===J)&&(z+=1),Q<=0&&(q+=1);var ue=a.rowsRenderCalculator.startPosition,he=a.columnsRenderCalculator.startPosition,Oe=Math.abs(i.inlineStartOverlay.getScrollPosition()),we=i.topOverlay.getScrollPosition(),$=Jt(this.hot.rootDocument),P=n.offsetTop+ue-we,g=0;if(this.hot.isRtl()){var p=n.offsetLeft;p>=0?g=S.getWidth()-n.offsetLeft:g=Math.abs(p),g+=he-Oe-u}else g=n.offsetLeft+he-Oe;var w=Ii(this.TD,this.hot.rootWindow),E=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",R=parseInt(w[E],10)>0?0:1,F=parseInt(w.borderTopWidth,10)>0?0:1,x=ht(n)+R,K=Pt(n)+F,Z=aW(h)?$:0,re=lW(d)?$:0,ie=this.hot.view.maximumVisibleElementWidth(g)-Z+R,se=Math.max(this.hot.view.maximumVisibleElementHeight(P)-re+F,23);return{top:z,start:q,height:K,maxHeight:se,width:x,maxWidth:ie}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return bse}}]),e}();gt(If,ase);var wse=$e,Sse=al.map,Cse=yv,_se=Cse("map");wse({target:"Array",proto:!0,forced:!_se},{map:function(t){return Sse(this,t,arguments.length>1?arguments[1]:void 0)}});function Ose(e){return Pse(e)||Tse(e)||Ese(e)||Rse()}function Rse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ese(e,t){if(e){if(typeof e=="string")return s_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s_(e,t)}}function Tse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pse(e){if(Array.isArray(e))return s_(e)}function s_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u_(e){"@babel/helpers - typeof";return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(e)}function wr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=u_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(Ose(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function SW(e){return wr(e,[","])}function Ce(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function ip(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function FE(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const kse=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:wr,isNumericLike:SW,rangeEach:Ce,rangeEachReverse:ip,valueAccordingPercent:FE},Symbol.toStringTag,{value:"Module"}));function $se(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,y){d.addEventListener(v,y,!1)},a=function(d,v,y){d.removeEventListener(v,y,!1)},l=function(d){var v,y;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(d.maxHeight);isNaN(y)||(e.maxHeight=y)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(d.minWidth);isNaN(m)||(e.minWidth=m)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var b=parseInt(d.maxWidth);isNaN(b)||(e.maxWidth=b)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,y){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,y){f(d,v,y)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function MA(e,t){for(var r=xE(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}Ev(t,o)}function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function xA(e,t){return xse(e)||Mse(e,t)||Ise(e,t)||Ase()}function Ase(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ise(e,t){if(e){if(typeof e=="string")return DA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DA(e,t)}}function DA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xse(e){if(Array.isArray(e))return e}function Dse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hse(n.key),n)}}function Nse(e,t,r){return t&&NA(e.prototype,t),r&&NA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hse(e){var t=Lse(e,"string");return Cs(t)==="symbol"?t:String(t)}function Lse(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mc(){return typeof Reflect<"u"&&Reflect.get?Mc=Reflect.get.bind():Mc=function(t,r,n){var o=jse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mc.apply(this,arguments)}function jse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ua(e),e!==null););return e}function Fse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f_(e,t)}function f_(e,t){return f_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},f_(e,t)}function Bse(e){var t=Wse();return function(){var n=Ua(e),o;if(t){var i=Ua(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vse(this,o)}}function Vse(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CW(e)}function CW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ua(e){return Ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ua(e)}var Use="ht_editor_visible",vy="ht_editor_hidden",HA="textEditor",zse="text",fl=function(e){Fse(r,e);var t=Bse(r);function r(n){var o;return Dse(this,r),o=t.call(this,n),o.eventManager=new kt(CW(o)),o.autoResize=$se(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return Nse(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(Mc(Ua(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==tr.FINISHED&&this.hideEditableElement();var d=!h;d&&!pn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===tr.VIRGIN&&(this.TEXTAREA.value="",Mc(Ua(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),Ev(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,vy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(jV()||LV())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,vy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Ce(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,vy)&&Le(this.TEXTAREA_PARENT,vy),i?(this.layerClass=Use,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==tr.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ii(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ii(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),y=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),m=s-v,b=f-y,S=u-v,C=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,S),minHeight:Math.min(b,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),OE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ve(o.hot.getSelected())},group:HA},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:Ic,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:Ic,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:Ic,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=xA(c,1),d=h[0];MA(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=xA(c,1),d=h[0];MA(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(zm),i.removeShortcutsByGroup(HA),i.removeShortcutsByGroup(l_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[me.ARROW_UP,me.ARROW_RIGHT,me.ARROW_DOWN,me.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return zse}}]),r}(If);function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function Yse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kse(n.key),n)}}function Gse(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kse(e){var t=qse(e,"string");return _s(t)==="symbol"?t:String(t)}function qse(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hn(){return typeof Reflect<"u"&&Reflect.get?hn=Reflect.get.bind():hn=function(t,r,n){var o=Xse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hn.apply(this,arguments)}function Xse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fr(e),e!==null););return e}function Zse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c_(e,t)}function c_(e,t){return c_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},c_(e,t)}function Qse(e){var t=tue();return function(){var n=Fr(e),o;if(t){var i=Fr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jse(this,o)}}function Jse(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eue(e)}function eue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fr(e)}var jA="handsontableEditor",rue="handsontable",BE=function(e){Zse(r,e);var t=Qse(r);function r(){return Yse(this,r),t.apply(this,arguments)}return Gse(r,[{key:"open",value:function(){hn(Fr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Ev(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),hn(Fr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){hn(Fr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var y=this.getSourceData(v.row,v.col);y!==void 0&&f.setValue(y),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&zt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||hn(Fr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){hn(Fr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}hn(Fr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");hn(Fr(r.prototype),"registerShortcuts",this).call(this);var l={group:jA,relativeToGroup:zm,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),wn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){hn(Fr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(jA)}}],[{key:"EDITOR_TYPE",get:function(){return rue}}]),r}(fl),nue="base";function Mf(e,t,r,n,o,i,a){var l=[],s=[];a.className&&te(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Le(t,s),te(t,l)}Mf.RENDERER_TYPE=nue;var oue="text";function Hi(e,t,r,n,o,i,a){Mf.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Dt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Cn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ai(t,l)}Hi.RENDERER_TYPE=oue;function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function iue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_W(n.key),n)}}function aue(e,t,r){return t&&FA(e.prototype,t),r&&FA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(t,r,n){var o=lue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function lue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function sue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h_(e,t)}function h_(e,t){return h_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},h_(e,t)}function uue(e){var t=cue();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fue(this,o)}}function fue(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d_(e)}function d_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}function hue(e,t,r){return t=_W(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _W(e){var t=due(e,"string");return Os(t)==="symbol"?t:String(t)}function due(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aw=new WeakMap,vue="autocomplete",VE=function(e){sue(r,e);var t=uue(r);function r(n){var o;return iue(this,r),o=t.call(this,n),hue(d_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,y;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=ZC(Dt(a[v])),l)y=d.indexOf(i);else{var m=this.cellProperties.locale;y=d.toLocaleLowerCase(m).indexOf(i.toLocaleLowerCase(m))}y!==-1&&(h=d.length-y-f,s.push({baseIndex:v,index:y,charsLeft:h,value:d}))}for(s.sort(function(b,S){if(S.index===-1)return-1;if(b.index===-1)return 1;if(b.index<S.index)return-1;if(S.index<b.index)return 1;if(b.index===S.index){if(b.charsLeft<S.charsLeft)return-1;if(b.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],Aw.set(d_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return aue(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ve(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){ca(vo(r.prototype),"createElements",this).call(this),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=Aw.get(this);ca(vo(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Jt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[ht(this.TEXTAREA)-2]:void 0,width:l?ht(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,y,m){Hi(f,c,h,d,v,y,m);var b=o.cellProperties,S=b.filteringCaseSensitive,C=b.allowHtml,k=b.locale,O=o.query,B=Dt(y),z,q;B&&!C&&(z=S===!0?B.indexOf(O):B.toLocaleLowerCase(k).indexOf(O.toLocaleLowerCase(k)),z!==-1&&(q=B.substr(z,O.length),B=B.replace(q,"<strong>".concat(q,"</strong>")))),c.innerHTML=B},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),ca(vo(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){ca(vo(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=xE(this.TEXTAREA),a=oW(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,y=c.length;v<y&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Pc([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),Ev(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Wa(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Ut(this.TEXTAREA),s=Pt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Pt(this.hot.view._wt.wtTable.THEAD),h=Ut(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,y=u>v&&d>v;return y?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(y?d:v,u),y}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=We(o,function(s){return Dt(s)}),l=We(a,function(s){return i?s:ZC(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===me.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===me.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=Aw.get(this);if(a.skipOne=!1,BV(o.keyCode)||o.keyCode===me.BACKSPACE||o.keyCode===me.DELETE||o.keyCode===me.INSERT){var l=10;if(o.keyCode===me.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return vue}}]),r}(BE);function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function yue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pue(n.key),n)}}function gue(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pue(e){var t=mue(e,"string");return Rs(t)==="symbol"?t:String(t)}function mue(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v_(e,t)}function v_(e,t){return v_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},v_(e,t)}function wue(e){var t=_ue();return function(){var n=ap(e),o;if(t){var i=ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Sue(this,o)}}function Sue(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cue(e)}function Cue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ap(e)}var Oue="checkbox",OW=function(e){bue(r,e);var t=wue(r);function r(){return yue(this,r),t.apply(this,arguments)}return gue(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return Oue}}]),r}(If),RW={exports:{}};const Rue=LY(Sne);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=Rue}catch{}e.exports=n(o)}})(Qy,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function($,P,g,p){o?$.addEventListener(P,g,!!p):$.attachEvent("on"+P,g)},s=function($,P,g,p){o?$.removeEventListener(P,g,!!p):$.detachEvent("on"+P,g)},u=function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},f=function($,P){return(" "+$.className+" ").indexOf(" "+P+" ")!==-1},c=function($,P){f($,P)||($.className=$.className===""?P:$.className+" "+P)},h=function($,P){$.className=u((" "+$.className+" ").replace(" "+P+" "," "))},d=function($){return/Array/.test(Object.prototype.toString.call($))},v=function($){return/Date/.test(Object.prototype.toString.call($))&&!isNaN($.getTime())},y=function($){var P=$.getDay();return P===0||P===6},m=function($){return $%4===0&&$%100!==0||$%400===0},b=function($,P){return[31,m($)?29:28,31,30,31,30,31,31,30,31,30,31][P]},S=function($){v($)&&$.setHours(0,0,0,0)},C=function($,P){return $.getTime()===P.getTime()},k=function($,P,g){var p,w;for(p in P)w=$[p]!==void 0,w&&typeof P[p]=="object"&&P[p]!==null&&P[p].nodeName===void 0?v(P[p])?g&&($[p]=new Date(P[p].getTime())):d(P[p])?g&&($[p]=P[p].slice(0)):$[p]=k({},P[p],g):(g||!w)&&($[p]=P[p]);return $},O=function($,P,g){var p;i.createEvent?(p=i.createEvent("HTMLEvents"),p.initEvent(P,!0,!1),p=k(p,g),$.dispatchEvent(p)):i.createEventObject&&(p=i.createEventObject(),p=k(p,g),$.fireEvent("on"+P,p))},B=function($){return $.month<0&&($.year-=Math.ceil(Math.abs($.month)/12),$.month+=12),$.month>11&&($.year+=Math.floor(Math.abs($.month)/12),$.month-=12),$},z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},q=function($,P,g){for(P+=$.firstDay;P>=7;)P-=7;return g?$.i18n.weekdaysShort[P]:$.i18n.weekdays[P]},G=function($){var P=[],g="false";if($.isEmpty)if($.showDaysInNextAndPreviousMonths)P.push("is-outside-current-month"),$.enableSelectionDaysInNextAndPreviousMonths||P.push("is-selection-disabled");else return'<td class="is-empty"></td>';return $.isDisabled&&P.push("is-disabled"),$.isToday&&P.push("is-today"),$.isSelected&&(P.push("is-selected"),g="true"),$.hasEvent&&P.push("has-event"),$.isInRange&&P.push("is-inrange"),$.isStartRange&&P.push("is-startrange"),$.isEndRange&&P.push("is-endrange"),'<td data-day="'+$.day+'" class="'+P.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+$.year+'" data-pika-month="'+$.month+'" data-pika-day="'+$.day+'">'+$.day+"</button></td>"},X=function($,P){$.setHours(0,0,0,0);var g=$.getDate(),p=$.getDay(),w=P,E=w-1,R=7,F=function(ie){return(ie+R-1)%R};$.setDate(g+E-F(p));var x=new Date($.getFullYear(),0,w),K=24*60*60*1e3,Z=($.getTime()-x.getTime())/K,re=1+Math.round((Z-E+F(x.getDay()))/R);return re},Q=function($,P,g,p){var w=new Date(g,P,$),E=n?r(w).isoWeek():X(w,p);return'<td class="pika-week">'+E+"</td>"},oe=function($,P,g,p){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(P?$.reverse():$).join("")+"</tr>"},J=function($){return"<tbody>"+$.join("")+"</tbody>"},ue=function($){var P,g=[];for($.showWeekNumber&&g.push("<th></th>"),P=0;P<7;P++)g.push('<th scope="col"><abbr title="'+q($,P)+'">'+q($,P,!0)+"</abbr></th>");return"<thead><tr>"+($.isRTL?g.reverse():g).join("")+"</tr></thead>"},he=function($,P,g,p,w,E){var R,F,x,K=$._o,Z=g===K.minYear,re=g===K.maxYear,ie='<div id="'+E+'" class="pika-title" role="heading" aria-live="assertive">',se,_e,Se=!0,U=!0;for(x=[],R=0;R<12;R++)x.push('<option value="'+(g===w?R-P:12+R-P)+'"'+(R===p?' selected="selected"':"")+(Z&&R<K.minMonth||re&&R>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[R]+"</option>");for(se='<div class="pika-label">'+K.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+x.join("")+"</select></div>",d(K.yearRange)?(R=K.yearRange[0],F=K.yearRange[1]+1):(R=g-K.yearRange,F=1+g+K.yearRange),x=[];R<F&&R<=K.maxYear;R++)R>=K.minYear&&x.push('<option value="'+R+'"'+(R===g?' selected="selected"':"")+">"+R+"</option>");return _e='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+x.join("")+"</select></div>",K.showMonthAfterYear?ie+=_e+se:ie+=se+_e,Z&&(p===0||K.minMonth>=p)&&(Se=!1),re&&(p===11||K.maxMonth<=p)&&(U=!1),P===0&&(ie+='<button class="pika-prev'+(Se?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),P===$._o.numberOfMonths-1&&(ie+='<button class="pika-next'+(U?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),ie+="</div>"},Oe=function($,P,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ue($)+J(P)+"</table>"},we=function($){var P=this,g=P.config($);P._onMouseDown=function(w){if(P._v){w=w||window.event;var E=w.target||w.srcElement;if(E)if(f(E,"is-disabled")||(f(E,"pika-button")&&!f(E,"is-empty")&&!f(E.parentNode,"is-disabled")?(P.setDate(new Date(E.getAttribute("data-pika-year"),E.getAttribute("data-pika-month"),E.getAttribute("data-pika-day"))),g.bound&&a(function(){P.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):f(E,"pika-prev")?P.prevMonth():f(E,"pika-next")&&P.nextMonth()),f(E,"pika-select"))P._c=!0;else if(w.preventDefault)w.preventDefault();else return w.returnValue=!1,!1}},P._onChange=function(w){w=w||window.event;var E=w.target||w.srcElement;E&&(f(E,"pika-select-month")?P.gotoMonth(E.value):f(E,"pika-select-year")&&P.gotoYear(E.value))},P._onKeyChange=function(w){if(w=w||window.event,P.isVisible())switch(w.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:P.adjustDate("subtract",1);break;case 38:P.adjustDate("subtract",7);break;case 39:P.adjustDate("add",1);break;case 40:P.adjustDate("add",7);break;case 8:case 46:P.setDate(null);break}},P._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var w=r(g.field.value,g.format,g.formatStrict);return w&&w.isValid()?w.toDate():null}else return new Date(Date.parse(g.field.value))},P._onInputChange=function(w){var E;w.firedBy!==P&&(E=P._parseFieldValue(),v(E)&&P.setDate(E),P._v||P.show())},P._onInputFocus=function(){P.show()},P._onInputClick=function(){P.show()},P._onInputBlur=function(){var w=i.activeElement;do if(f(w,"pika-single"))return;while(w=w.parentNode);P._c||(P._b=a(function(){P.hide()},50)),P._c=!1},P._onClick=function(w){w=w||window.event;var E=w.target||w.srcElement,R=E;if(E){!o&&f(E,"pika-select")&&(E.onchange||(E.setAttribute("onchange","return;"),l(E,"change",P._onChange)));do if(f(R,"pika-single")||R===g.trigger)return;while(R=R.parentNode);P._v&&E!==g.trigger&&R!==g.trigger&&P.hide()}},P.el=i.createElement("div"),P.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),l(P.el,"mousedown",P._onMouseDown,!0),l(P.el,"touchend",P._onMouseDown,!0),l(P.el,"change",P._onChange),g.keyboardInput&&l(i,"keydown",P._onKeyChange),g.field&&(g.container?g.container.appendChild(P.el):g.bound?i.body.appendChild(P.el):g.field.parentNode.insertBefore(P.el,g.field.nextSibling),l(g.field,"change",P._onInputChange),g.defaultDate||(g.defaultDate=P._parseFieldValue(),g.setDefaultDate=!0));var p=g.defaultDate;v(p)?g.setDefaultDate?P.setDate(p,!0):P.gotoDate(p):P.gotoDate(new Date),g.bound?(this.hide(),P.el.className+=" is-bound",l(g.trigger,"click",P._onInputClick),l(g.trigger,"focus",P._onInputFocus),l(g.trigger,"blur",P._onInputBlur)):this.show()};return we.prototype={config:function($){this._o||(this._o=k({},z,!0));var P=k(this._o,$,!0);P.isRTL=!!P.isRTL,P.field=P.field&&P.field.nodeName?P.field:null,P.theme=typeof P.theme=="string"&&P.theme?P.theme:null,P.bound=!!(P.bound!==void 0?P.field&&P.bound:P.field),P.trigger=P.trigger&&P.trigger.nodeName?P.trigger:P.field,P.disableWeekends=!!P.disableWeekends,P.disableDayFn=typeof P.disableDayFn=="function"?P.disableDayFn:null;var g=parseInt(P.numberOfMonths,10)||1;if(P.numberOfMonths=g>4?4:g,v(P.minDate)||(P.minDate=!1),v(P.maxDate)||(P.maxDate=!1),P.minDate&&P.maxDate&&P.maxDate<P.minDate&&(P.maxDate=P.minDate=!1),P.minDate&&this.setMinDate(P.minDate),P.maxDate&&this.setMaxDate(P.maxDate),d(P.yearRange)){var p=new Date().getFullYear()-10;P.yearRange[0]=parseInt(P.yearRange[0],10)||p,P.yearRange[1]=parseInt(P.yearRange[1],10)||p}else P.yearRange=Math.abs(parseInt(P.yearRange,10))||z.yearRange,P.yearRange>100&&(P.yearRange=100);return P},toString:function($){return $=$||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,$):n?r(this._d).format($):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function($,P){n&&r.isMoment($)&&this.setDate($.toDate(),P)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function($,P){if(!$)return this._d=null,this._o.field&&(this._o.field.value="",O(this._o.field,"change",{firedBy:this})),this.draw();if(typeof $=="string"&&($=new Date(Date.parse($))),!!v($)){var g=this._o.minDate,p=this._o.maxDate;v(g)&&$<g?$=g:v(p)&&$>p&&($=p),this._d=new Date($.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),O(this._o.field,"change",{firedBy:this})),!P&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function($){var P=!0;if(v($)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),w=$.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),P=w<g.getTime()||p.getTime()<w}P&&(this.calendars=[{month:$.getMonth(),year:$.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function($,P){var g=this.getDate()||new Date,p=parseInt(P)*24*60*60*1e3,w;$==="add"?w=new Date(g.valueOf()+p):$==="subtract"&&(w=new Date(g.valueOf()-p)),this.setDate(w)},adjustCalendars:function(){this.calendars[0]=B(this.calendars[0]);for(var $=1;$<this._o.numberOfMonths;$++)this.calendars[$]=B({month:this.calendars[0].month+$,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function($){isNaN($)||(this.calendars[0].month=parseInt($,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function($){isNaN($)||(this.calendars[0].year=parseInt($,10),this.adjustCalendars())},setMinDate:function($){$ instanceof Date?(S($),this._o.minDate=$,this._o.minYear=$.getFullYear(),this._o.minMonth=$.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange),this.draw()},setMaxDate:function($){$ instanceof Date?(S($),this._o.maxDate=$,this._o.maxYear=$.getFullYear(),this._o.maxMonth=$.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange),this.draw()},setStartRange:function($){this._o.startRange=$},setEndRange:function($){this._o.endRange=$},draw:function($){if(!(!this._v&&!$)){var P=this._o,g=P.minYear,p=P.maxYear,w=P.minMonth,E=P.maxMonth,R="",F;this._y<=g&&(this._y=g,!isNaN(w)&&this._m<w&&(this._m=w)),this._y>=p&&(this._y=p,!isNaN(E)&&this._m>E&&(this._m=E));for(var x=0;x<P.numberOfMonths;x++)F="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),R+='<div class="pika-lendar">'+he(this,x,this.calendars[x].year,this.calendars[x].month,this.calendars[0].year,F)+this.render(this.calendars[x].year,this.calendars[x].month,F)+"</div>";this.el.innerHTML=R,P.bound&&P.field.type!=="hidden"&&a(function(){P.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),P.bound&&P.field.setAttribute("aria-label",P.ariaLabel)}},adjustPosition:function(){var $,P,g,p,w,E,R,F,x,K,Z,re;if(!this._o.container){if(this.el.style.position="absolute",$=this._o.trigger,P=$,g=this.el.offsetWidth,p=this.el.offsetHeight,w=window.innerWidth||i.documentElement.clientWidth,E=window.innerHeight||i.documentElement.clientHeight,R=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Z=!0,re=!0,typeof $.getBoundingClientRect=="function")K=$.getBoundingClientRect(),F=K.left+window.pageXOffset,x=K.bottom+window.pageYOffset;else for(F=P.offsetLeft,x=P.offsetTop+P.offsetHeight;P=P.offsetParent;)F+=P.offsetLeft,x+=P.offsetTop;(this._o.reposition&&F+g>w||this._o.position.indexOf("right")>-1&&F-g+$.offsetWidth>0)&&(F=F-g+$.offsetWidth,Z=!1),(this._o.reposition&&x+p>E+R||this._o.position.indexOf("top")>-1&&x-p-$.offsetHeight>0)&&(x=x-p-$.offsetHeight,re=!1),this.el.style.left=F+"px",this.el.style.top=x+"px",c(this.el,Z?"left-aligned":"right-aligned"),c(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,Z?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function($,P,g){var p=this._o,w=new Date,E=b($,P),R=new Date($,P,1).getDay(),F=[],x=[];S(w),p.firstDay>0&&(R-=p.firstDay,R<0&&(R+=7));for(var K=P===0?11:P-1,Z=P===11?0:P+1,re=P===0?$-1:$,ie=P===11?$+1:$,se=b(re,K),_e=E+R,Se=_e;Se>7;)Se-=7;_e+=7-Se;for(var U=!1,Ne=0,Be=0;Ne<_e;Ne++){var ke=new Date($,P,1+(Ne-R)),Ie=v(this._d)?C(ke,this._d):!1,Ae=C(ke,w),_=p.events.indexOf(ke.toDateString())!==-1,T=Ne<R||Ne>=E+R,I=1+(Ne-R),j=P,M=$,V=p.startRange&&C(p.startRange,ke),N=p.endRange&&C(p.endRange,ke),D=p.startRange&&p.endRange&&p.startRange<ke&&ke<p.endRange,W=p.minDate&&ke<p.minDate||p.maxDate&&ke>p.maxDate||p.disableWeekends&&y(ke)||p.disableDayFn&&p.disableDayFn(ke);T&&(Ne<R?(I=se+I,j=K,M=re):(I=I-E,j=Z,M=ie));var L={day:I,month:j,year:M,hasEvent:_,isSelected:Ie,isToday:Ae,isDisabled:W,isEmpty:T,isStartRange:V,isEndRange:N,isInRange:D,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&Ie&&(U=!0),x.push(G(L)),++Be===7&&(p.showWeekNumber&&x.unshift(Q(Ne-R,P,$,p.firstWeekOfYearMinDays)),F.push(oe(x,p.isRTL,p.pickWholeWeek,U)),x=[],Be=0,U=!1)}return Oe(p,F,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var $=this._v;$!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,$!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var $=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),$.keyboardInput&&s(i,"keydown",this._onKeyChange),$.field&&(s($.field,"change",this._onInputChange),$.bound&&(s($.trigger,"click",this._onInputClick),s($.trigger,"focus",this._onInputFocus),s($.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},we})})(RW);var Eue=RW.exports;const VA=lj(Eue);function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function Tue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kue(n.key),n)}}function Pue(e,t,r){return t&&WA(e.prototype,t),r&&WA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kue(e){var t=$ue(e,"string");return Es(t)==="symbol"?t:String(t)}function $ue(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function so(){return typeof Reflect<"u"&&Reflect.get?so=Reflect.get.bind():so=function(t,r,n){var o=Aue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},so.apply(this,arguments)}function Aue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vn(e),e!==null););return e}function Iue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},y_(e,t)}function Mue(e){var t=Nue();return function(){var n=vn(e),o;if(t){var i=vn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xue(this,o)}}function xue(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Due(e)}function Due(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vn(e){return vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vn(e)}var EW="date",UA="dateEditor",TW=function(e){Iue(r,e);var t=Mue(r);function r(n){var o;return Tue(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return Pue(r,[{key:"init",value:function(){var o=this;if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof VA!="function")throw new Error("You need to include Pikaday to your project.");so(vn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){so(vn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new kt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){so(vn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");so(vn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:UA})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(UA),so(vn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}so(vn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?EE(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new VA(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Pt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-ht(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ov(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ee(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return EW}}]),r}(fl);function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function Hue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jue(n.key),n)}}function Lue(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jue(e){var t=Fue(e,"string");return Ts(t)==="symbol"?t:String(t)}function Fue(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vg(){return typeof Reflect<"u"&&Reflect.get?vg=Reflect.get.bind():vg=function(t,r,n){var o=Bue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vg.apply(this,arguments)}function Bue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ps(e),e!==null););return e}function Vue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g_(e,t)}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},g_(e,t)}function Wue(e){var t=Yue();return function(){var n=Ps(e),o;if(t){var i=Ps(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uue(this,o)}}function Uue(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zue(e)}function zue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ps(e){return Ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ps(e)}var Gue="dropdown",WE=function(e){Vue(r,e);var t=Wue(r);function r(){return Hue(this,r),t.apply(this,arguments)}return Lue(r,[{key:"prepare",value:function(o,i,a,l,s,u){vg(Ps(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Gue}}]),r}(VE);ge.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===WE&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function Kue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xue(n.key),n)}}function que(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xue(e){var t=Zue(e,"string");return ks(t)==="symbol"?t:String(t)}function Zue(e,t){if(ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Que(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},p_(e,t)}function Jue(e){var t=rfe();return function(){var n=lp(e),o;if(t){var i=lp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return efe(this,o)}}function efe(e,t){if(t&&(ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tfe(e)}function tfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lp(e){return lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lp(e)}var nfe="numeric",PW=function(e){Que(r,e);var t=Jue(r);function r(){return Kue(this,r),t.apply(this,arguments)}return que(r,null,[{key:"EDITOR_TYPE",get:function(){return nfe}}]),r}(fl);function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function ofe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,afe(n.key),n)}}function ife(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function afe(e){var t=lfe(e,"string");return $s(t)==="symbol"?t:String(t)}function lfe(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yg(){return typeof Reflect<"u"&&Reflect.get?yg=Reflect.get.bind():yg=function(t,r,n){var o=sfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},yg.apply(this,arguments)}function sfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=As(e),e!==null););return e}function ufe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function ffe(e){var t=dfe();return function(){var n=As(e),o;if(t){var i=As(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cfe(this,o)}}function cfe(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hfe(e)}function hfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function As(e){return As=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},As(e)}var vfe="password",kW=function(e){ufe(r,e);var t=ffe(r);function r(){return ofe(this,r),t.apply(this,arguments)}return ife(r,[{key:"createElements",value:function(){yg(As(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Cn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return vfe}}]),r}(fl);function za(e){"@babel/helpers - typeof";return za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},za(e)}function yfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pfe(n.key),n)}}function gfe(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pfe(e){var t=mfe(e,"string");return za(t)==="symbol"?t:String(t)}function mfe(e,t){if(za(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(za(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gg(){return typeof Reflect<"u"&&Reflect.get?gg=Reflect.get.bind():gg=function(t,r,n){var o=bfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gg.apply(this,arguments)}function bfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Is(e),e!==null););return e}function wfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b_(e,t)}function b_(e,t){return b_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},b_(e,t)}function Sfe(e){var t=Ofe();return function(){var n=Is(e),o;if(t){var i=Is(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Cfe(this,o)}}function Cfe(e,t){if(t&&(za(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _fe(e)}function _fe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ofe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Is(e){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Is(e)}var Iw="ht_editor_visible",qA="selectEditor",Rfe="select",Efe=function(e){wfe(r,e);var t=Sfe(r);function r(){return yfe(this,r),t.apply(this,arguments)}return gfe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,Iw)&&Le(this.select,Iw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;gg(Is(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),Cn(this.select),ze(h,function(d,v){var y=f.hot.rootDocument.createElement("OPTION");y.value=v,ul(y,d),f.select.appendChild(y)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else za(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===tr.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",te(this.select,Iw)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:qA};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(qA)}}],[{key:"EDITOR_TYPE",get:function(){return Rfe}}]),r}(If);function Ms(e){"@babel/helpers - typeof";return Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ms(e)}function Tfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kfe(n.key),n)}}function Pfe(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kfe(e){var t=$fe(e,"string");return Ms(t)==="symbol"?t:String(t)}function $fe(e,t){if(Ms(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ms(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pg(){return typeof Reflect<"u"&&Reflect.get?pg=Reflect.get.bind():pg=function(t,r,n){var o=Afe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pg.apply(this,arguments)}function Afe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xs(e),e!==null););return e}function Ife(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w_(e,t)}function w_(e,t){return w_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},w_(e,t)}function Mfe(e){var t=Nfe();return function(){var n=xs(e),o;if(t){var i=xs(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xfe(this,o)}}function xfe(e,t){if(t&&(Ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dfe(e)}function Dfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xs(e){return xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xs(e)}var Hfe="time",$W=function(e){Ife(r,e);var t=Mfe(r);function r(){return Tfe(this,r),t.apply(this,arguments)}return Pfe(r,[{key:"prepare",value:function(o,i,a,l,s,u){pg(xs(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return Hfe}}]),r}(fl);function Lfe(){Pr(If),Pr(VE),Pr(OW),Pr(TW),Pr(WE),Pr(BE),Pr(PW),Pr(kW),Pr(Efe),Pr(fl),Pr($W)}var jfe="html";function UE(e,t,r,n,o,i,a){Mf.apply(this,[e,t,r,n,o,i,a]),ul(t,i??"",!1)}UE.RENDERER_TYPE=jfe;var Ffe="autocomplete";function xf(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?UE:Hi,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),te(t,"htAutocomplete"),!e.acArrowListener){var f=new kt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}xf.RENDERER_TYPE=Ffe;var ZA=new WeakMap,QA=new WeakMap,Bfe="htBadValue",Ds="data-row",Ns="data-col",Vfe="checkboxRenderer",AW="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===AW){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function zE(e,t,r,n,o,i,a){var l=e.rootDocument;Mf.apply(this,[e,t,r,n,o,i,a]),Wfe(e);var s=Ufe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Cn(t),i===a.checkedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Xt(i)?te(s,"noValue"):(s.style.display="none",te(s,Bfe),f=!0),s.setAttribute(Ds,r),s.setAttribute(Ns,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=zfe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),ZA.has(e)||(ZA.set(e,!0),v());function v(){var b=e.getShortcutManager(),S=b.getContext("grid"),C={group:Vfe};S.addShortcuts([{keys:[["space"]],callback:function(){return y(),!m()}},{keys:[["enter"]],callback:function(){return y(),!m()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!m()},relativeToGroup:Ic,position:"before"}],C)}function y(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var k=S[C].getTopStartCorner(),O=k.row,B=k.col,z=S[C].getBottomEndCorner(),q=z.row,G=z.col,X=[],Q=O;Q<=q;Q+=1)for(var oe=B;oe<=G;oe+=1){var J=e.getCellMeta(Q,oe);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var ue=e.getDataAtCell(Q,oe);b===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ue)?X.push([Q,oe,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ue)&&X.push([Q,oe,J.checkedTemplate]):X.push([Q,oe,J.uncheckedTemplate])}}X.length>0&&e.setDataAtCell(X)}}function m(){var b=e.getSelectedRange();if(b){for(var S=0;S<b.length;S++)for(var C=b[S].getTopStartCorner(),k=b[S].getBottomEndCorner(),O=C.row;O<=k.row;O++)for(var B=C.col;B<=k.col;B++){var z=e.getCellMeta(O,B);if(z.type!=="checkbox")return!1;var q=e.getCell(O,B);if(q==null)return!0;var G=q.querySelectorAll("input[type=checkbox]");if(G.length>0&&!z.readOnly)return!0}return!1}}}zE.RENDERER_TYPE=AW;function Wfe(e){var t=QA.get(e);if(!t){var r=e.rootElement;t=new kt(e),t.addEventListener(r,"click",function(n){return Gfe(n,e)}),t.addEventListener(r,"mouseup",function(n){return Yfe(n,e)}),t.addEventListener(r,"change",function(n){return Kfe(n,e)}),QA.set(e,t)}return t}function Ufe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function zfe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function Yfe(e,t){var r=e.target;YE(r)&&(!r.hasAttribute(Ds)||!r.hasAttribute(Ns)||setTimeout(t.listen,10))}function Gfe(e,t){var r=e.target;if(YE(r)&&!(!r.hasAttribute(Ds)||!r.hasAttribute(Ns))){var n=parseInt(r.getAttribute(Ds),10),o=parseInt(r.getAttribute(Ns),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function Kfe(e,t){var r=e.target;if(YE(r)&&!(!r.hasAttribute(Ds)||!r.hasAttribute(Ns))){var n=parseInt(r.getAttribute(Ds),10),o=parseInt(r.getAttribute(Ns),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function YE(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var IW={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof Uv=="function"&&Uv;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof Uv=="function"&&Uv,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,b=1e9;function S(G){var X=0|G;return 0<G||G===X?X:X-1}function C(G){for(var X,Q,oe=1,J=G.length,ue=G[0]+"";oe<J;){for(X=G[oe++]+"",Q=d-X.length;Q--;X="0"+X);ue+=X}for(J=ue.length;ue.charCodeAt(--J)===48;);return ue.slice(0,J+1||1)}function k(G,X){var Q,oe,J=G.c,ue=X.c,he=G.s,Oe=X.s,we=G.e,$=X.e;if(!he||!Oe)return null;if(Q=J&&!J[0],oe=ue&&!ue[0],Q||oe)return Q?oe?0:-Oe:he;if(he!=Oe)return he;if(Q=he<0,oe=we==$,!J||!ue)return oe?0:!J^Q?1:-1;if(!oe)return $<we^Q?1:-1;for(Oe=(we=J.length)<($=ue.length)?we:$,he=0;he<Oe;he++)if(J[he]!=ue[he])return J[he]>ue[he]^Q?1:-1;return we==$?0:$<we^Q?1:-1}function O(G,X,Q,oe){if(G<X||Q<G||G!==(G<0?s(G):u(G)))throw Error(f+(oe||"Argument")+(typeof G=="number"?G<X||Q<G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(G))}function B(G){var X=G.c.length-1;return S(G.e/d)==X&&G.c[X]%2!=0}function z(G,X){return(1<G.length?G.charAt(0)+"."+G.slice(1):G)+(X<0?"e":"e+")+X}function q(G,X,Q){var oe,J;if(X<0){for(J=Q+".";++X;J+=Q);G=J+G}else if(++X>(oe=G.length)){for(J=Q,X-=oe;--X;J+=Q);G+=J}else X<oe&&(G=G.slice(0,X)+"."+G.slice(X));return G}(a=function G(X){var Q,oe,J,ue,he,Oe,we,$,P,g,p=U.prototype={constructor:U,toString:null,valueOf:null},w=new U(1),E=20,R=4,F=-7,x=21,K=-1e7,Z=1e7,re=!1,ie=1,se=0,_e={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Se="0123456789abcdefghijklmnopqrstuvwxyz";function U(_,T){var I,j,M,V,N,D,W,L,Y=this;if(!(Y instanceof U))return new U(_,T);if(T==null){if(_ instanceof U)return Y.s=_.s,Y.e=_.e,void(Y.c=(_=_.c)?_.slice():_);if((D=typeof _=="number")&&0*_==0){if(Y.s=1/_<0?(_=-_,-1):1,_===~~_){for(V=0,N=_;10<=N;N/=10,V++);return Y.e=V,void(Y.c=[_])}L=String(_)}else{if(L=String(_),!l.test(L))return J(Y,L,D);Y.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(V=L.indexOf("."))&&(L=L.replace(".","")),0<(N=L.search(/e/i))?(V<0&&(V=N),V+=+L.slice(N+1),L=L.substring(0,N)):V<0&&(V=L.length)}else{if(O(T,2,Se.length,"Base"),L=String(_),T==10)return Ie(Y=new U(_ instanceof U?_:L),E+Y.e+1,R);if(D=typeof _=="number"){if(0*_!=0)return J(Y,L,D,T);if(Y.s=1/_<0?(L=L.slice(1),-1):1,U.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+_);D=!1}else Y.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(I=Se.slice(0,T),V=N=0,W=L.length;N<W;N++)if(I.indexOf(j=L.charAt(N))<0){if(j=="."){if(V<N){V=W;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,N=-1,V=0;continue}return J(Y,String(_),D,T)}-1<(V=(L=oe(L,T,10,Y.s)).indexOf("."))?L=L.replace(".",""):V=L.length}for(N=0;L.charCodeAt(N)===48;N++);for(W=L.length;L.charCodeAt(--W)===48;);if(L=L.slice(N,++W)){if(W-=N,D&&U.DEBUG&&15<W&&(v<_||_!==u(_)))throw Error(c+Y.s*_);if(Z<(V=V-N-1))Y.c=Y.e=null;else if(V<K)Y.c=[Y.e=0];else{if(Y.e=V,Y.c=[],N=(V+1)%d,V<0&&(N+=d),N<W){for(N&&Y.c.push(+L.slice(0,N)),W-=d;N<W;)Y.c.push(+L.slice(N,N+=d));L=L.slice(N),N=d-L.length}else N-=W;for(;N--;L+="0");Y.c.push(+L)}}else Y.c=[Y.e=0]}function Ne(_,T,I,j){var M,V,N,D,W;if(I==null?I=R:O(I,0,8),!_.c)return _.toString();if(M=_.c[0],N=_.e,T==null)W=C(_.c),W=j==1||j==2&&(N<=F||x<=N)?z(W,N):q(W,N,"0");else if(V=(_=Ie(new U(_),T,I)).e,D=(W=C(_.c)).length,j==1||j==2&&(T<=V||V<=F)){for(;D<T;W+="0",D++);W=z(W,V)}else if(T-=N,W=q(W,V,"0"),D<V+1){if(0<--T)for(W+=".";T--;W+="0");}else if(0<(T+=V-D))for(V+1==D&&(W+=".");T--;W+="0");return _.s<0&&M?"-"+W:W}function Be(_,T){for(var I,j=1,M=new U(_[0]);j<_.length;j++){if(!(I=new U(_[j])).s){M=I;break}T.call(M,I)&&(M=I)}return M}function ke(_,T,I){for(var j=1,M=T.length;!T[--M];T.pop());for(M=T[0];10<=M;M/=10,j++);return(I=j+I*d-1)>Z?_.c=_.e=null:_.c=I<K?[_.e=0]:(_.e=I,T),_}function Ie(_,T,I,j){var M,V,N,D,W,L,Y,le=_.c,pe=y;if(le){e:{for(M=1,D=le[0];10<=D;D/=10,M++);if((V=T-M)<0)V+=d,N=T,Y=(W=le[L=0])/pe[M-N-1]%10|0;else if((L=s((V+1)/d))>=le.length){if(!j)break e;for(;le.length<=L;le.push(0));W=Y=0,N=(V%=d)-d+(M=1)}else{for(W=D=le[L],M=1;10<=D;D/=10,M++);Y=(N=(V%=d)-d+M)<0?0:W/pe[M-N-1]%10|0}if(j=j||T<0||le[L+1]!=null||(N<0?W:W%pe[M-N-1]),j=I<4?(Y||j)&&(I==0||I==(_.s<0?3:2)):5<Y||Y==5&&(I==4||j||I==6&&(0<V?0<N?W/pe[M-N]:0:le[L-1])%10&1||I==(_.s<0?8:7)),T<1||!le[0])return le.length=0,j?(T-=_.e+1,le[0]=pe[(d-T%d)%d],_.e=-T||0):le[0]=_.e=0,_;if(V==0?(le.length=L,D=1,L--):(le.length=L+1,D=pe[d-V],le[L]=0<N?u(W/pe[M-N]%pe[N])*D:0),j)for(;;){if(L==0){for(V=1,N=le[0];10<=N;N/=10,V++);for(N=le[0]+=D,D=1;10<=N;N/=10,D++);V!=D&&(_.e++,le[0]==h&&(le[0]=1));break}if(le[L]+=D,le[L]!=h)break;le[L--]=0,D=1}for(V=le.length;le[--V]===0;le.pop());}_.e>Z?_.c=_.e=null:_.e<K&&(_.c=[_.e=0])}return _}function Ae(_){var T,I=_.e;return I===null?_.toString():(T=C(_.c),T=I<=F||x<=I?z(T,I):q(T,I,"0"),_.s<0?"-"+T:T)}return U.clone=G,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(_){var T,I;if(_!=null){if(typeof _!="object")throw Error(f+"Object expected: "+_);if(_.hasOwnProperty(T="DECIMAL_PLACES")&&(O(I=_[T],0,b,T),E=I),_.hasOwnProperty(T="ROUNDING_MODE")&&(O(I=_[T],0,8,T),R=I),_.hasOwnProperty(T="EXPONENTIAL_AT")&&((I=_[T])&&I.pop?(O(I[0],-b,0,T),O(I[1],0,b,T),F=I[0],x=I[1]):(O(I,-b,b,T),F=-(x=I<0?-I:I))),_.hasOwnProperty(T="RANGE"))if((I=_[T])&&I.pop)O(I[0],-b,-1,T),O(I[1],1,b,T),K=I[0],Z=I[1];else{if(O(I,-b,b,T),!I)throw Error(f+T+" cannot be zero: "+I);K=-(Z=I<0?-I:I)}if(_.hasOwnProperty(T="CRYPTO")){if((I=_[T])!==!!I)throw Error(f+T+" not true or false: "+I);if(I){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!I,Error(f+"crypto unavailable");re=I}else re=I}if(_.hasOwnProperty(T="MODULO_MODE")&&(O(I=_[T],0,9,T),ie=I),_.hasOwnProperty(T="POW_PRECISION")&&(O(I=_[T],0,b,T),se=I),_.hasOwnProperty(T="FORMAT")){if(typeof(I=_[T])!="object")throw Error(f+T+" not an object: "+I);_e=I}if(_.hasOwnProperty(T="ALPHABET")){if(typeof(I=_[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(I))throw Error(f+T+" invalid: "+I);Se=I}}return{DECIMAL_PLACES:E,ROUNDING_MODE:R,EXPONENTIAL_AT:[F,x],RANGE:[K,Z],CRYPTO:re,MODULO_MODE:ie,POW_PRECISION:se,FORMAT:_e,ALPHABET:Se}},U.isBigNumber=function(_){return _ instanceof U||_&&_._isBigNumber===!0||!1},U.maximum=U.max=function(){return Be(arguments,p.lt)},U.minimum=U.min=function(){return Be(arguments,p.gt)},U.random=(ue=9007199254740992,he=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(_){var T,I,j,M,V,N=0,D=[],W=new U(w);if(_==null?_=E:O(_,0,b),M=s(_/d),re)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(M*=2));N<M;)9e15<=(V=131072*T[N]+(T[N+1]>>>11))?(I=crypto.getRandomValues(new Uint32Array(2)),T[N]=I[0],T[N+1]=I[1]):(D.push(V%1e14),N+=2);N=M/2}else{if(!crypto.randomBytes)throw re=!1,Error(f+"crypto unavailable");for(T=crypto.randomBytes(M*=7);N<M;)9e15<=(V=281474976710656*(31&T[N])+1099511627776*T[N+1]+4294967296*T[N+2]+16777216*T[N+3]+(T[N+4]<<16)+(T[N+5]<<8)+T[N+6])?crypto.randomBytes(7).copy(T,N):(D.push(V%1e14),N+=7);N=M/7}if(!re)for(;N<M;)(V=he())<9e15&&(D[N++]=V%1e14);for(M=D[--N],_%=d,M&&_&&(V=y[d-_],D[N]=u(M/V)*V);D[N]===0;D.pop(),N--);if(N<0)D=[j=0];else{for(j=-1;D[0]===0;D.splice(0,1),j-=d);for(N=1,V=D[0];10<=V;V/=10,N++);N<d&&(j-=d-N)}return W.e=j,W.c=D,W}),U.sum=function(){for(var _=1,T=arguments,I=new U(T[0]);_<T.length;)I=I.plus(T[_++]);return I},oe=function(){var _="0123456789";function T(I,j,M,V){for(var N,D,W=[0],L=0,Y=I.length;L<Y;){for(D=W.length;D--;W[D]*=j);for(W[0]+=V.indexOf(I.charAt(L++)),N=0;N<W.length;N++)W[N]>M-1&&(W[N+1]==null&&(W[N+1]=0),W[N+1]+=W[N]/M|0,W[N]%=M)}return W.reverse()}return function(I,j,M,V,N){var D,W,L,Y,le,pe,Re,He,Ze=I.indexOf("."),st=E,Ge=R;for(0<=Ze&&(Y=se,se=0,I=I.replace(".",""),pe=(He=new U(j)).pow(I.length-Ze),se=Y,He.c=T(q(C(pe.c),pe.e,"0"),10,M,_),He.e=He.c.length),L=Y=(Re=T(I,j,M,N?(D=Se,_):(D=_,Se))).length;Re[--Y]==0;Re.pop());if(!Re[0])return D.charAt(0);if(Ze<0?--L:(pe.c=Re,pe.e=L,pe.s=V,Re=(pe=Q(pe,He,st,Ge,M)).c,le=pe.r,L=pe.e),Ze=Re[W=L+st+1],Y=M/2,le=le||W<0||Re[W+1]!=null,le=Ge<4?(Ze!=null||le)&&(Ge==0||Ge==(pe.s<0?3:2)):Y<Ze||Ze==Y&&(Ge==4||le||Ge==6&&1&Re[W-1]||Ge==(pe.s<0?8:7)),W<1||!Re[0])I=le?q(D.charAt(1),-st,D.charAt(0)):D.charAt(0);else{if(Re.length=W,le)for(--M;++Re[--W]>M;)Re[W]=0,W||(++L,Re=[1].concat(Re));for(Y=Re.length;!Re[--Y];);for(Ze=0,I="";Ze<=Y;I+=D.charAt(Re[Ze++]));I=q(I,L,D.charAt(0))}return I}}(),Q=function(){function _(j,M,V){var N,D,W,L,Y=0,le=j.length,pe=M%m,Re=M/m|0;for(j=j.slice();le--;)Y=((D=pe*(W=j[le]%m)+(N=Re*W+(L=j[le]/m|0)*pe)%m*m+Y)/V|0)+(N/m|0)+Re*L,j[le]=D%V;return Y&&(j=[Y].concat(j)),j}function T(j,M,V,N){var D,W;if(V!=N)W=N<V?1:-1;else for(D=W=0;D<V;D++)if(j[D]!=M[D]){W=j[D]>M[D]?1:-1;break}return W}function I(j,M,V,N){for(var D=0;V--;)j[V]-=D,D=j[V]<M[V]?1:0,j[V]=D*N+j[V]-M[V];for(;!j[0]&&1<j.length;j.splice(0,1));}return function(j,M,V,N,D){var W,L,Y,le,pe,Re,He,Ze,st,Ge,Me,De,dr,Bt,Ve,et,Ct,ut=j.s==M.s?1:-1,ft=j.c,tt=M.c;if(!(ft&&ft[0]&&tt&&tt[0]))return new U(j.s&&M.s&&(ft?!tt||ft[0]!=tt[0]:tt)?ft&&ft[0]==0||!tt?0*ut:ut/0:NaN);for(st=(Ze=new U(ut)).c=[],ut=V+(L=j.e-M.e)+1,D||(D=h,L=S(j.e/d)-S(M.e/d),ut=ut/d|0),Y=0;tt[Y]==(ft[Y]||0);Y++);if(tt[Y]>(ft[Y]||0)&&L--,ut<0)st.push(1),le=!0;else{for(Bt=ft.length,et=tt.length,ut+=2,1<(pe=u(D/(tt[Y=0]+1)))&&(tt=_(tt,pe,D),ft=_(ft,pe,D),et=tt.length,Bt=ft.length),dr=et,Me=(Ge=ft.slice(0,et)).length;Me<et;Ge[Me++]=0);Ct=tt.slice(),Ct=[0].concat(Ct),Ve=tt[0],tt[1]>=D/2&&Ve++;do{if(pe=0,(W=T(tt,Ge,et,Me))<0){if(De=Ge[0],et!=Me&&(De=De*D+(Ge[1]||0)),1<(pe=u(De/Ve)))for(D<=pe&&(pe=D-1),He=(Re=_(tt,pe,D)).length,Me=Ge.length;T(Re,Ge,He,Me)==1;)pe--,I(Re,et<He?Ct:tt,He,D),He=Re.length,W=1;else pe==0&&(W=pe=1),He=(Re=tt.slice()).length;if(He<Me&&(Re=[0].concat(Re)),I(Ge,Re,Me,D),Me=Ge.length,W==-1)for(;T(tt,Ge,et,Me)<1;)pe++,I(Ge,et<Me?Ct:tt,Me,D),Me=Ge.length}else W===0&&(pe++,Ge=[0]);st[Y++]=pe,Ge[0]?Ge[Me++]=ft[dr]||0:(Ge=[ft[dr]],Me=1)}while((dr++<Bt||Ge[0]!=null)&&ut--);le=Ge[0]!=null,st[0]||st.splice(0,1)}if(D==h){for(Y=1,ut=st[0];10<=ut;ut/=10,Y++);Ie(Ze,V+(Ze.e=Y+L*d-1)+1,N,le)}else Ze.e=L,Ze.r=+le;return Ze}}(),Oe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,we=/^([^.]+)\.$/,$=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(_,T,I,j){var M,V=I?T:T.replace(g,"");if(P.test(V))_.s=isNaN(V)?null:V<0?-1:1,_.c=_.e=null;else{if(!I&&(V=V.replace(Oe,function(N,D,W){return M=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,j&&j!=M?N:D}),j&&(M=j,V=V.replace(we,"$1").replace($,"0.$1")),T!=V))return new U(V,M);if(U.DEBUG)throw Error(f+"Not a"+(j?" base "+j:"")+" number: "+T);_.c=_.e=_.s=null}},p.absoluteValue=p.abs=function(){var _=new U(this);return _.s<0&&(_.s=1),_},p.comparedTo=function(_,T){return k(this,new U(_,T))},p.decimalPlaces=p.dp=function(_,T){var I,j,M;if(_!=null)return O(_,0,b),T==null?T=R:O(T,0,8),Ie(new U(this),_+this.e+1,T);if(!(I=this.c))return null;if(j=((M=I.length-1)-S(this.e/d))*d,M=I[M])for(;M%10==0;M/=10,j--);return j<0&&(j=0),j},p.dividedBy=p.div=function(_,T){return Q(this,new U(_,T),E,R)},p.dividedToIntegerBy=p.idiv=function(_,T){return Q(this,new U(_,T),0,1)},p.exponentiatedBy=p.pow=function(_,T){var I,j,M,V,N,D,W,L,Y=this;if((_=new U(_)).c&&!_.isInteger())throw Error(f+"Exponent not an integer: "+Ae(_));if(T!=null&&(T=new U(T)),N=14<_.e,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!_.c||!_.c[0])return L=new U(Math.pow(+Ae(Y),N?2-B(_):+Ae(_))),T?L.mod(T):L;if(D=_.s<0,T){if(T.c?!T.c[0]:!T.s)return new U(NaN);(j=!D&&Y.isInteger()&&T.isInteger())&&(Y=Y.mod(T))}else{if(9<_.e&&(0<Y.e||Y.e<-1||(Y.e==0?1<Y.c[0]||N&&24e7<=Y.c[1]:Y.c[0]<8e13||N&&Y.c[0]<=9999975e7)))return V=Y.s<0&&B(_)?-0:0,-1<Y.e&&(V=1/V),new U(D?1/V:V);se&&(V=s(se/d+2))}for(W=N?(I=new U(.5),D&&(_.s=1),B(_)):(M=Math.abs(+Ae(_)))%2,L=new U(w);;){if(W){if(!(L=L.times(Y)).c)break;V?L.c.length>V&&(L.c.length=V):j&&(L=L.mod(T))}if(M){if((M=u(M/2))===0)break;W=M%2}else if(Ie(_=_.times(I),_.e+1,1),14<_.e)W=B(_);else{if((M=+Ae(_))==0)break;W=M%2}Y=Y.times(Y),V?Y.c&&Y.c.length>V&&(Y.c.length=V):j&&(Y=Y.mod(T))}return j?L:(D&&(L=w.div(L)),T?L.mod(T):V?Ie(L,se,R,void 0):L)},p.integerValue=function(_){var T=new U(this);return _==null?_=R:O(_,0,8),Ie(T,T.e+1,_)},p.isEqualTo=p.eq=function(_,T){return k(this,new U(_,T))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(_,T){return 0<k(this,new U(_,T))},p.isGreaterThanOrEqualTo=p.gte=function(_,T){return(T=k(this,new U(_,T)))===1||T===0},p.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},p.isLessThan=p.lt=function(_,T){return k(this,new U(_,T))<0},p.isLessThanOrEqualTo=p.lte=function(_,T){return(T=k(this,new U(_,T)))===-1||T===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(_,T){var I,j,M,V,N=this,D=N.s;if(T=(_=new U(_,T)).s,!D||!T)return new U(NaN);if(D!=T)return _.s=-T,N.plus(_);var W=N.e/d,L=_.e/d,Y=N.c,le=_.c;if(!W||!L){if(!Y||!le)return Y?(_.s=-T,_):new U(le?N:NaN);if(!Y[0]||!le[0])return le[0]?(_.s=-T,_):new U(Y[0]?N:R==3?-0:0)}if(W=S(W),L=S(L),Y=Y.slice(),D=W-L){for((M=(V=D<0)?(D=-D,Y):(L=W,le)).reverse(),T=D;T--;M.push(0));M.reverse()}else for(j=(V=(D=Y.length)<(T=le.length))?D:T,D=T=0;T<j;T++)if(Y[T]!=le[T]){V=Y[T]<le[T];break}if(V&&(M=Y,Y=le,le=M,_.s=-_.s),0<(T=(j=le.length)-(I=Y.length)))for(;T--;Y[I++]=0);for(T=h-1;D<j;){if(Y[--j]<le[j]){for(I=j;I&&!Y[--I];Y[I]=T);--Y[I],Y[j]+=h}Y[j]-=le[j]}for(;Y[0]==0;Y.splice(0,1),--L);return Y[0]?ke(_,Y,L):(_.s=R==3?-1:1,_.c=[_.e=0],_)},p.modulo=p.mod=function(_,T){var I,j,M=this;return _=new U(_,T),!M.c||!_.s||_.c&&!_.c[0]?new U(NaN):!_.c||M.c&&!M.c[0]?new U(M):(ie==9?(j=_.s,_.s=1,I=Q(M,_,0,3),_.s=j,I.s*=j):I=Q(M,_,0,ie),(_=M.minus(I.times(_))).c[0]||ie!=1||(_.s=M.s),_)},p.multipliedBy=p.times=function(_,T){var I,j,M,V,N,D,W,L,Y,le,pe,Re,He,Ze,st,Ge=this,Me=Ge.c,De=(_=new U(_,T)).c;if(!(Me&&De&&Me[0]&&De[0]))return!Ge.s||!_.s||Me&&!Me[0]&&!De||De&&!De[0]&&!Me?_.c=_.e=_.s=null:(_.s*=Ge.s,Me&&De?(_.c=[0],_.e=0):_.c=_.e=null),_;for(j=S(Ge.e/d)+S(_.e/d),_.s*=Ge.s,(W=Me.length)<(le=De.length)&&(He=Me,Me=De,De=He,M=W,W=le,le=M),M=W+le,He=[];M--;He.push(0));for(Ze=h,st=m,M=le;0<=--M;){for(I=0,pe=De[M]%st,Re=De[M]/st|0,V=M+(N=W);M<V;)I=((L=pe*(L=Me[--N]%st)+(D=Re*L+(Y=Me[N]/st|0)*pe)%st*st+He[V]+I)/Ze|0)+(D/st|0)+Re*Y,He[V--]=L%Ze;He[V]=I}return I?++j:He.splice(0,1),ke(_,He,j)},p.negated=function(){var _=new U(this);return _.s=-_.s||null,_},p.plus=function(_,T){var I,j=this,M=j.s;if(T=(_=new U(_,T)).s,!M||!T)return new U(NaN);if(M!=T)return _.s=-T,j.minus(_);var V=j.e/d,N=_.e/d,D=j.c,W=_.c;if(!V||!N){if(!D||!W)return new U(M/0);if(!D[0]||!W[0])return W[0]?_:new U(D[0]?j:0*M)}if(V=S(V),N=S(N),D=D.slice(),M=V-N){for((I=0<M?(N=V,W):(M=-M,D)).reverse();M--;I.push(0));I.reverse()}for((M=D.length)-(T=W.length)<0&&(I=W,W=D,D=I,T=M),M=0;T;)M=(D[--T]=D[T]+W[T]+M)/h|0,D[T]=h===D[T]?0:D[T]%h;return M&&(D=[M].concat(D),++N),ke(_,D,N)},p.precision=p.sd=function(_,T){var I,j,M;if(_!=null&&_!==!!_)return O(_,1,b),T==null?T=R:O(T,0,8),Ie(new U(this),_,T);if(!(I=this.c))return null;if(j=(M=I.length-1)*d+1,M=I[M]){for(;M%10==0;M/=10,j--);for(M=I[0];10<=M;M/=10,j++);}return _&&this.e+1>j&&(j=this.e+1),j},p.shiftedBy=function(_){return O(_,-v,v),this.times("1e"+_)},p.squareRoot=p.sqrt=function(){var _,T,I,j,M,V=this,N=V.c,D=V.s,W=V.e,L=E+4,Y=new U("0.5");if(D!==1||!N||!N[0])return new U(!D||D<0&&(!N||N[0])?NaN:N?V:1/0);if((I=(D=Math.sqrt(+Ae(V)))==0||D==1/0?(((T=C(N)).length+W)%2==0&&(T+="0"),D=Math.sqrt(+T),W=S((W+1)/2)-(W<0||W%2),new U(T=D==1/0?"1e"+W:(T=D.toExponential()).slice(0,T.indexOf("e")+1)+W)):new U(D+"")).c[0]){for((D=(W=I.e)+L)<3&&(D=0);;)if(M=I,I=Y.times(M.plus(Q(V,M,L,1))),C(M.c).slice(0,D)===(T=C(I.c)).slice(0,D)){if(I.e<W&&--D,(T=T.slice(D-3,D+1))!="9999"&&(j||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(Ie(I,I.e+E+2,1),_=!I.times(I).eq(V));break}if(!j&&(Ie(M,M.e+E+2,0),M.times(M).eq(V))){I=M;break}L+=4,D+=4,j=1}}return Ie(I,I.e+E+1,R,_)},p.toExponential=function(_,T){return _!=null&&(O(_,0,b),_++),Ne(this,_,T,1)},p.toFixed=function(_,T){return _!=null&&(O(_,0,b),_=_+this.e+1),Ne(this,_,T)},p.toFormat=function(_,T,I){var j;if(I==null)_!=null&&T&&typeof T=="object"?(I=T,T=null):_&&typeof _=="object"?(I=_,_=T=null):I=_e;else if(typeof I!="object")throw Error(f+"Argument not an object: "+I);if(j=this.toFixed(_,T),this.c){var M,V=j.split("."),N=+I.groupSize,D=+I.secondaryGroupSize,W=I.groupSeparator||"",L=V[0],Y=V[1],le=this.s<0,pe=le?L.slice(1):L,Re=pe.length;if(D&&(M=N,N=D,Re-=D=M),0<N&&0<Re){for(M=Re%N||N,L=pe.substr(0,M);M<Re;M+=N)L+=W+pe.substr(M,N);0<D&&(L+=W+pe.slice(M)),le&&(L="-"+L)}j=Y?L+(I.decimalSeparator||"")+((D=+I.fractionGroupSize)?Y.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):Y):L}return(I.prefix||"")+j+(I.suffix||"")},p.toFraction=function(_){var T,I,j,M,V,N,D,W,L,Y,le,pe,Re=this,He=Re.c;if(_!=null&&(!(D=new U(_)).isInteger()&&(D.c||D.s!==1)||D.lt(w)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Ae(D));if(!He)return new U(Re);for(T=new U(w),L=I=new U(w),j=W=new U(w),pe=C(He),V=T.e=pe.length-Re.e-1,T.c[0]=y[(N=V%d)<0?d+N:N],_=!_||0<D.comparedTo(T)?0<V?T:L:D,N=Z,Z=1/0,D=new U(pe),W.c[0]=0;Y=Q(D,T,0,1),(M=I.plus(Y.times(j))).comparedTo(_)!=1;)I=j,j=M,L=W.plus(Y.times(M=L)),W=M,T=D.minus(Y.times(M=T)),D=M;return M=Q(_.minus(I),j,0,1),W=W.plus(M.times(L)),I=I.plus(M.times(j)),W.s=L.s=Re.s,le=Q(L,j,V*=2,R).minus(Re).abs().comparedTo(Q(W,I,V,R).minus(Re).abs())<1?[L,j]:[W,I],Z=N,le},p.toNumber=function(){return+Ae(this)},p.toPrecision=function(_,T){return _!=null&&O(_,1,b),Ne(this,_,T,2)},p.toString=function(_){var T,I=this,j=I.s,M=I.e;return M===null?j?(T="Infinity",j<0&&(T="-"+T)):T="NaN":(T=_==null?M<=F||x<=M?z(C(I.c),M):q(C(I.c),M,"0"):_===10?q(C((I=Ie(new U(I),E+M+1,R)).c),I.e,"0"):(O(_,2,Se.length,"Base"),oe(q(C(I.c),M,"0"),10,_,j,!0)),j<0&&I.c[0]&&(T="-"+T)),T},p.valueOf=p.toJSON=function(){return Ae(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),X!=null&&U.set(X),U}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(k){if(Array.isArray(k))return k}(S)||function(k,O){var B=[],z=!0,q=!1,G=void 0;try{for(var X,Q=k[Symbol.iterator]();!(z=(X=Q.next()).done)&&(B.push(X.value),!O||B.length!==O);z=!0);}catch(oe){q=!0,G=oe}finally{try{z||Q.return==null||Q.return()}finally{if(q)throw G}}return B}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},k=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var O=C.prefix||"",B=C.postfix||"",z=function(q,G,X){switch(G.output){case"currency":return G=b(G,a.currentCurrencyDefaultFormat()),function(Se,U,Ne){var Be=Ne.currentCurrency(),ke=Object.assign({},c,U),Ie=void 0,Ae="",_=!!ke.totalLength||!!ke.forceAverage||ke.average,T=U.currencyPosition||Be.position,I=U.currencySymbol||Be.symbol;ke.spaceSeparated&&(Ae=" "),T==="infix"&&(Ie=Ae+I+Ae);var j=m({instance:Se,providedFormat:U,state:Ne,decimalSeparator:Ie});return T==="prefix"&&(j=Se._value<0&&ke.negative==="sign"?"-".concat(Ae).concat(I).concat(j.slice(1)):I+Ae+j),T&&T!=="postfix"||(j=j+(Ae=_?"":Ae)+I),j}(q,G,a);case"percent":return G=b(G,a.currentPercentageDefaultFormat()),function(Se,U,Ne,Be){var ke=U.prefixSymbol,Ie=m({instance:Be(100*Se._value),providedFormat:U,state:Ne}),Ae=Object.assign({},c,U);return ke?"%".concat(Ae.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Ae.spaceSeparated?" ":"","%")}(q,G,a,X);case"byte":return G=b(G,a.currentByteDefaultFormat()),w=q,R=a,F=X,x=(E=G).base||"binary",K=f[x],Z=d(w._value,K.suffixes,K.scale),re=Z.value,ie=Z.suffix,se=m({instance:F(re),providedFormat:E,state:R,defaults:R.currentByteDefaultFormat()}),_e=R.currentAbbreviations(),"".concat(se).concat(_e.spaced?" ":"").concat(ie);case"time":return G=b(G,a.currentTimeDefaultFormat()),$=q,P=Math.floor($._value/60/60),g=Math.floor(($._value-60*P*60)/60),p=Math.round($._value-60*P*60-60*g),"".concat(P,":").concat(g<10?"0":"").concat(g,":").concat(p<10?"0":"").concat(p);case"ordinal":return G=b(G,a.currentOrdinalDefaultFormat()),Q=q,oe=G,ue=(J=a).currentOrdinal(),he=Object.assign({},c,oe),Oe=m({instance:Q,providedFormat:oe,state:J}),we=ue(Q._value),"".concat(Oe).concat(he.spaceSeparated?" ":"").concat(we);case"number":default:return m({instance:q,providedFormat:G,numbro:X})}var Q,oe,J,ue,he,Oe,we,$,P,g,p,w,E,R,F,x,K,Z,re,ie,se,_e}(S,C,k);return z=(z=O+z)+B}function d(S,C,k){var O=C[0],B=Math.abs(S);if(k<=B){for(var z=1;z<C.length;++z){var q=Math.pow(k,z),G=Math.pow(k,z+1);if(q<=B&&B<G){O=C[z],S/=q;break}}O===C[0]&&(S/=Math.pow(k,C.length-1),O=C[C.length-1])}return{value:S,suffix:O}}function v(S){for(var C="",k=0;k<S;k++)C+="0";return C}function y(S,C){return S.toString().indexOf("e")!==-1?function(k,O){var B=k.toString(),z=i(B.split("e"),2),q=z[0],G=z[1],X=i(q.split("."),2),Q=X[0],oe=X[1],J=oe===void 0?"":oe;if(0<+G)B=Q+J+v(G-J.length);else{var ue=".";ue=+Q<0?"-0".concat(ue):"0".concat(ue);var he=(v(-G-1)+Math.abs(Q)+J).substr(0,O);he.length<O&&(he+=v(O-he.length)),B=ue+he}return 0<+G&&0<O&&(B+=".".concat(v(O))),B}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function m(S){var C=S.instance,k=S.providedFormat,O=S.state,B=O===void 0?a:O,z=S.decimalSeparator,q=S.defaults,G=q===void 0?B.currentDefaults():q,X=C._value;if(X===0&&B.hasZeroFormat())return B.getZeroFormat();if(!isFinite(X))return X.toString();var Q,oe,J,ue,he,Oe,we,$,P=Object.assign({},c,G,k),g=P.totalLength,p=g?0:P.characteristic,w=P.optionalCharacteristic,E=P.forceAverage,R=!!g||!!E||P.average,F=g?-1:R&&k.mantissa===void 0?0:P.mantissa,x=!g&&(k.optionalMantissa===void 0?F===-1:P.optionalMantissa),K=P.trimMantissa,Z=P.thousandSeparated,re=P.spaceSeparated,ie=P.negative,se=P.forceSign,_e=P.exponential,Se="";if(R){var U=function(_){var T=_.value,I=_.forceAverage,j=_.abbreviations,M=_.spaceSeparated,V=M!==void 0&&M,N=_.totalLength,D=N===void 0?0:N,W="",L=Math.abs(T),Y=-1;if(L>=Math.pow(10,12)&&!I||I==="trillion"?(W=j.trillion,T/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!I||I==="billion"?(W=j.billion,T/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!I||I==="million"?(W=j.million,T/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!I||I==="thousand")&&(W=j.thousand,T/=Math.pow(10,3)),W&&(W=(V?" ":"")+W),D){var le=T.toString().split(".")[0];Y=Math.max(D-le.length,0)}return{value:T,abbreviation:W,mantissaPrecision:Y}}({value:X,forceAverage:E,abbreviations:B.currentAbbreviations(),spaceSeparated:re,totalLength:g});X=U.value,Se+=U.abbreviation,g&&(F=U.mantissaPrecision)}if(_e){var Ne=(oe=(Q={value:X,characteristicPrecision:p}).value,J=Q.characteristicPrecision,ue=J===void 0?0:J,he=i(oe.toExponential().split("e"),2),Oe=he[0],we=he[1],$=+Oe,ue&&1<ue&&($*=Math.pow(10,ue-1),we=0<=(we=+we-(ue-1))?"+".concat(we):we),{value:$,abbreviation:"e".concat(we)});X=Ne.value,Se=Ne.abbreviation+Se}var Be,ke,Ie,Ae=function(_,T,I,j,M){if(j===-1)return _;var V=y(T,j),N=i(V.toString().split("."),2),D=N[0],W=N[1],L=W===void 0?"":W;if(L.match(/^0+$/)&&(I||M))return D;var Y=L.match(/0+$/);return M&&Y?"".concat(D,".").concat(L.toString().slice(0,Y.index)):V.toString()}(X.toString(),X,x,F,K);return Ae=function(_,T,I,j,M){var V=j.currentDelimiters(),N=V.thousands;M=M||V.decimal;var D=V.thousandsSize||3,W=_.toString(),L=W.split(".")[0],Y=W.split(".")[1];return I&&(T<0&&(L=L.slice(1)),function(le,pe){for(var Re=[],He=0,Ze=le;0<Ze;Ze--)He===pe&&(Re.unshift(Ze),He=0),He++;return Re}(L.length,D).forEach(function(le,pe){L=L.slice(0,le+pe)+N+L.slice(le+pe)}),T<0&&(L="-".concat(L))),W=Y?L+M+Y:L}(Ae=function(_,T,I,j){var M=_,V=i(M.toString().split("."),2),N=V[0],D=V[1];if(N.match(/^-?0$/)&&I)return D?"".concat(N.replace("0",""),".").concat(D):N.replace("0","");if(N.length<j)for(var W=j-N.length,L=0;L<W;L++)M="0".concat(M);return M.toString()}(Ae,0,w,p),X,Z,B,z),(R||_e)&&(Ae=Ae+Se),(se||X<0)&&(Be=Ae,Ie=ie,Ae=(ke=X)===0?Be:+Be==0?Be.replace("-",""):0<ke?"+".concat(Be):Ie==="sign"?Be:"(".concat(Be.replace("-",""),")")),Ae}function b(S,C){if(!S)return C;var k=Object.keys(S);return k.length===1&&k[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return h.apply(void 0,k.concat([S]))},getByteUnit:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return function(B){var z=f.general;return d(B._value,z.suffixes,z.scale).suffix}.apply(void 0,k.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return function(B){var z=f.binary;return d(B._value,z.suffixes,z.scale).suffix}.apply(void 0,k.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,k=new Array(C),O=0;O<C;O++)k[O]=arguments[O];return function(B){var z=f.decimal;return d(B._value,z.suffixes,z.scale).suffix}.apply(void 0,k.concat([S]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(y){u=y}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(y){y=l.parseFormat(y),a.validateFormat(y)&&(h=y)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(y){return c=typeof y=="string"?y:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(y){if(y){if(f[y])return f[y];throw new Error('Unknown tag "'.concat(y,'"'))}return v()},s.registerLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(y))throw new Error("Invalid language data");f[y.languageTag]=y,m&&d(y.languageTag)},s.setLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[y]){var b=y.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===b});return f[S]?void d(S):void d(m)}d(y)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(m,b){for(var S=0;S<b.length;S++){var C=b[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(m,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(y),u=r("./unformatting"),f=r("./formatting")(y),c=r("./manipulating")(y),h=r("./parsing"),d=function(){function m(C){(function(k,O){if(!(k instanceof O))throw new TypeError("Cannot call a class as a function")})(this,m),this._value=C}var b,S;return b=m,(S=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(b.prototype,S),m}();function v(m){var b=m;return y.isNumbro(m)?b=m._value:typeof m=="string"?b=y.unformat(m):isNaN(m)&&(b=NaN),b}function y(m){return new d(v(m))}y.version="2.1.2",y.isNumbro=function(m){return m instanceof d},y.language=a.currentLanguage,y.registerLanguage=a.registerLanguage,y.setLanguage=a.setLanguage,y.languages=a.languages,y.languageData=a.languageData,y.zeroFormat=a.setZeroFormat,y.defaultFormat=a.currentDefaults,y.setDefaults=a.setDefaults,y.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=s.loadLanguagesInNode,y.unformat=u.unformat,n.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,y,m,b,S,C,k,O,B,z,q,G,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=X,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=X,function(Q,oe){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):Q.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):Q.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,X),h=X,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=X,(y=i.split(".")[0].match(/0+/))&&(v.characteristic=y[0].length),function(Q,oe){if(Q.indexOf(".")!==-1){var J=Q.split(".")[0];oe.optionalCharacteristic=J.indexOf("0")===-1}}(i,X),m=X,i.indexOf("a")!==-1&&(m.average=!0),S=X,(b=i).indexOf("K")!==-1?S.forceAverage="thousand":b.indexOf("M")!==-1?S.forceAverage="million":b.indexOf("B")!==-1?S.forceAverage="billion":b.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Q,oe){var J=Q.split(".")[1];if(J){var ue=J.match(/0+/);ue&&(oe.mantissa=ue[0].length)}}(i,X),k=X,(C=i).match(/\[\.]/)?k.optionalMantissa=!0:C.match(/\./)&&(k.optionalMantissa=!1),O=X,i.indexOf(",")!==-1&&(O.thousandSeparated=!0),B=X,i.indexOf(" ")!==-1&&(B.spaceSeparated=!0),q=X,(z=i).match(/^\+?\([^)]*\)$/)&&(q.negative="parenthesis"),z.match(/^\+?-/)&&(q.negative="sign"),G=X,i.match(/^\+/)&&(G.forceSign=!0),X)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function y(m,b){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,k=4<arguments.length?arguments[4]:void 0,O=5<arguments.length?arguments[5]:void 0,B=6<arguments.length?arguments[6]:void 0;if(!isNaN(+m))return+m;var z="",q=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(q!==m)return-1*y(q,b,S,C,k,O,B);for(var G=0;G<i.length;G++){var X=i[G];if((z=m.replace(X.key,""))!==m)return y(z,b,S,C,k,O,B)*X.factor}if((z=m.replace("%",""))!==m)return y(z,b,S,C,k,O,B)/100;var Q=parseFloat(m);if(!isNaN(Q)){var oe=C(Q);if(oe&&oe!=="."&&(z=m.replace(new RegExp("".concat(a(oe),"$")),""))!==m)return y(z,b,S,C,k,O,B);var J={};Object.keys(O).forEach(function(g){J[O[g]]=g});for(var ue=Object.keys(J).sort().reverse(),he=ue.length,Oe=0;Oe<he;Oe++){var we=ue[Oe],$=J[we];if((z=m.replace(we,""))!==m){var P=void 0;switch($){case"thousand":P=Math.pow(10,3);break;case"million":P=Math.pow(10,6);break;case"billion":P=Math.pow(10,9);break;case"trillion":P=Math.pow(10,12)}return y(z,b,S,C,k,O,B)*P}}}}(function(y,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=y.replace(b,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(m.thousands),"([0-9])"),"g"),"$1$2")).replace(m.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),y=d.currentCurrency().symbol,m=d.currentOrdinal(),b=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(k,O){if(!k.indexOf(":")||O.thousands===":")return!1;var B=k.split(":");if(B.length!==3)return!1;var z=+B[0],q=+B[1],G=+B[2];return!isNaN(z)&&!isNaN(q)&&!isNaN(G)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,y,m,b,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(y){if(Array.isArray(y)){for(var m=0,b=new Array(y.length);m<y.length;m++)b[m]=y[m];return b}}(v)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,y,m){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!y[C])return console.error("".concat(m," Invalid key: ").concat(C)),!1;var k=v[C],O=y[C];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!h(k,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(k)!==O.type)return console.error("".concat(m," ").concat(C,' type mismatched: "').concat(O.type,'" expected, "').concat(a(k),'" provided')),!1;if(O.restrictions&&O.restrictions.length)for(var B=O.restrictions.length,z=0;z<B;z++){var q=O.restrictions[z],G=q.restriction,X=q.message;if(!G(k,v))return console.error("".concat(m," ").concat(C," invalid value: ").concat(X)),!1}return O.restriction&&!O.restriction(k,v)?(console.error("".concat(m," ").concat(C," invalid value: ").concat(O.message)),!1):O.validValues&&O.validValues.indexOf(k)===-1?(console.error("".concat(m," ").concat(C," invalid value: must be among ").concat(JSON.stringify(O.validValues),', "').concat(k,'" provided')),!1):!(O.children&&!h(k,O.children,"[Validate ".concat(C,"]")))});return b||S.push.apply(S,i(Object.keys(y).map(function(C){var k=y[C];if(typeof k=="string"&&(k={type:k}),k.mandatory){var O=k.mandatory;if(typeof O=="function"&&(O=O(v)),O&&v[C]===void 0)return console.error("".concat(m,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,k){return C&&k},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,y){var m=c(v),b=d(y);return m&&b},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(IW);var qfe=IW.exports;const zi=lj(qfe);var Xfe="numeric";function GE(e,t,r,n,o,i,a){var l=i;if(wr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!zi.languages()[u]){var d=u.replace("-",""),v=zi.allLanguages?zi.allLanguages[u]:zi[d];v&&zi.registerLanguage(v)}zi.setLanguage(u),l=zi(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Hi(e,t,r,n,o,l,a)}GE.RENDERER_TYPE=Xfe;var Zfe="password";function KE(e,t,r,n,o,i,a){Hi.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Ce(l-1,function(){u+=s}),ul(t,u)}KE.RENDERER_TYPE=Zfe;var Qfe="time";function qE(e,t,r,n,o,i,a){Hi.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}qE.RENDERER_TYPE=Qfe;var kv=on("renderers"),Jfe=kv.register,ece=kv.getItem,MW=kv.hasItem,tce=kv.getNames;kv.getValues;function sp(e){if(typeof e=="function")return e;if(!MW(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return ece(e)}function Hn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),Jfe(e,t)}function rce(){Hn(xf),Hn(Mf),Hn(zE),Hn(UE),Hn(GE),Hn(KE),Hn(Hi),Hn(qE)}var nce="autocomplete";function Ym(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,JA(r,t)):JA(r,t)(this.source):t(!0)}Ym.VALIDATOR_TYPE=nce;function JA(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var oce=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},ice=Zt,ace=gm,lce=jt,sce=_n,uce=Ar,eI=oce,tI=Kt,fce=rl,cce=pm;ace("search",function(e,t,r){return[function(o){var i=uce(this),a=sce(o)?void 0:fce(o,e);return a?ice(a,o,i):new RegExp(o)[e](tI(i))},function(n){var o=lce(this),i=tI(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;eI(l,0)||(o.lastIndex=0);var s=cce(o,i);return eI(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function xW(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const hce=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:xW},Symbol.toStringTag,{value:"Module"}));var dce="date";function XE(e,t){var r=bW(EW,this.instance),n=e,o=!0;n==null&&(n="");var i=ee(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=ee(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=vce(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}XE.VALIDATOR_TYPE=dce;function vce(e,t){var r=ee(xW(e)),n=ee(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var yce="numeric";function ZE(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:wr(e))}ZE.VALIDATOR_TYPE=yce;var gce=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],pce="time";function QE(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=ee(o,gce,!0).isValid()?ee(o):ee(o,r),l=a.isValid(),s=ee(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}QE.VALIDATOR_TYPE=pce;var $v=on("validators"),mce=$v.register,bce=$v.getItem,DW=$v.hasItem,wce=$v.getNames;$v.getValues;function JE(e){if(typeof e=="function")return e;if(!DW(e))throw Error('No registered validator found under "'.concat(e,'" name'));return bce(e)}function Xl(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),mce(e,t)}function Sce(){Xl(Ym),Xl(XE),Xl(ZE),Xl(QE)}var Cce="autocomplete",_ce={CELL_TYPE:Cce,editor:VE,renderer:xf,validator:Ym},Oce="checkbox",Rce={CELL_TYPE:Oce,editor:OW,renderer:zE},Ece="date",Tce={CELL_TYPE:Ece,editor:TW,renderer:xf,validator:XE},Pce="dropdown",kce={CELL_TYPE:Pce,editor:WE,renderer:xf,validator:Ym},$ce="handsontable",Ace={CELL_TYPE:$ce,editor:BE,renderer:xf},Ice="numeric",Mce={CELL_TYPE:Ice,editor:PW,renderer:GE,validator:ZE,dataType:"number"},xce="password",Dce={CELL_TYPE:xce,editor:kW,renderer:KE,copyable:!1},Nce="text",NW={CELL_TYPE:Nce,editor:fl,renderer:Hi},Hce="time",Lce={CELL_TYPE:Hce,editor:$W,renderer:qE,validator:QE},Av=on("cellTypes"),jce=Av.register,Fce=Av.getItem,HW=Av.hasItem,Bce=Av.getNames;Av.getValues;function eT(e){if(!HW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Fce(e)}function cn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Pr(e,n),o&&Hn(e,o),i&&Xl(e,i),jce(e,t)}function Vce(){cn(_ce),cn(Rce),cn(Tce),cn(kce),cn(Ace),cn(Mce),cn(Dce),cn(NW),cn(Lce)}var Wce=hm,Uce=vF;Wce("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Uce);function zce(e){return Kce(e)||Gce(e)||LW(e)||Yce()}function Yce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kce(e){if(Array.isArray(e))return S_(e)}function qce(e,t){return Qce(e)||Zce(e,t)||LW(e,t)||Xce()}function Xce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LW(e,t){if(e){if(typeof e=="string")return S_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S_(e,t)}}function S_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Qce(e){if(Array.isArray(e))return e}var C_="asc",Jce="desc",rI=new Map([[C_,[-1,1]],[Jce,[1,-1]]]),ehe=function(t){return"The priority '".concat(t,"' is already declared in a map.")},the=function(t){return"The priority '".concat(t,"' is not a number.")};function rhe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=pt(t)?t:ehe,r=pt(r)?r:the;function o(a,l){if(!wr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C_,l=rI.get(a)||rI.get(C_),s=qce(l,2),u=s[0],f=s[1];return zce(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}function nhe(e){return ahe(e)||ihe(e)||jW(e)||ohe()}function ohe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ihe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ahe(e){if(Array.isArray(e))return __(e)}function nI(e,t){return uhe(e)||she(e,t)||jW(e,t)||lhe()}function lhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jW(e,t){if(e){if(typeof e=="string")return __(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return __(e,t)}}function __(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function she(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function uhe(e){if(Array.isArray(e))return e}var fhe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function Gm(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=pt(t)?t:fhe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var y=nI(v,2),m=y[0],b=y[1];return f===b?m:!1})||[null],h=nI(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return nhe(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function che(e){return yhe(e)||vhe(e)||dhe(e)||hhe()}function hhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dhe(e,t){if(e){if(typeof e=="string")return O_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O_(e,t)}}function vhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yhe(e){if(Array.isArray(e))return O_(e)}function O_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ghe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function phe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=pt(t)?t:ghe;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return che(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function mhe(e,t){return She(e)||whe(e,t)||FW(e,t)||bhe()}function bhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function whe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function She(e){if(Array.isArray(e))return e}function oI(e){return Ohe(e)||_he(e)||FW(e)||Che()}function Che(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FW(e,t){if(e){if(typeof e=="string")return R_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R_(e,t)}}function _he(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ohe(e){if(Array.isArray(e))return R_(e)}function R_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tT=function(t){return'There is already registered "'.concat(t,'" plugin.')},Rhe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Ehe=function(t){return'The priority "'.concat(t,'" is not a number.')},BW=rhe({errorPriorityExists:Rhe,errorPriorityNaN:Ehe}),VW=phe({errorItemExists:tT}),E_=Gm({errorIdExists:tT});function rT(){return[].concat(oI(BW.getItems()),oI(VW.getItems()))}function Iv(e){var t=ur(e);return E_.getItem(t)}function The(e){return!!Iv(e)}function rt(e,t,r){var n=khe(e,t,r),o=mhe(n,3);e=o[0],t=o[1],r=o[2],Iv(e)===void 0&&Phe(e,t,r)}function Phe(e,t,r){var n=ur(e);if(E_.hasItem(n))throw new Error(tT(n));r===void 0?VW.addItem(n):BW.addItem(r,n),E_.addItem(n,t)}function khe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function $he(e,t){return xhe(e)||Mhe(e,t)||Ihe(e,t)||Ahe()}function Ahe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ihe(e,t){if(e){if(typeof e=="string")return iI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iI(e,t)}}function iI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xhe(e){if(Array.isArray(e))return e}function Dhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hhe(n.key),n)}}function Nhe(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hhe(e){var t=Lhe(e,"string");return nh(t)==="symbol"?t:String(t)}function Lhe(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jhe(e,t){Fhe(e,t),t.add(e)}function Fhe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var lI=new Map([["plugin",The],["cell-type",HW],["editor",mW],["renderer",MW],["validator",DW]]),Vhe="base",Yi=new WeakMap,Mw=[],En=null,sI=new WeakSet,ot=function(){function e(t){var r=this;Dhe(this,e),jhe(this,sI),Kn(this,"hot",t,{writable:!1}),Yi.set(this,{hooks:{}}),En=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Nhe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=$he(f,2),h=c[0],d=c[1];if(!lI.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));lI.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Mw.push(a)}}En||(En=rT()),En.indexOf("UndoRedo")>=0&&En.splice(En.indexOf("UndoRedo"),1),En.indexOf(this.pluginName)>=0&&En.splice(En.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=En.length===0;if(l){if(Mw.length>0){var s=["".concat(Mw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Yi.get(this).hooks[r]=Yi.get(this).hooks[r]||[];var o=Yi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Yi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;A(Yi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Yi.get(this).hooks;ze(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){A(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=Bhe(this,sI,Whe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ze(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Vhe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function Whe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function Uhe(e,t){return Khe(e)||Ghe(e,t)||Yhe(e,t)||zhe()}function zhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yhe(e,t){if(e){if(typeof e=="string")return uI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uI(e,t)}}function uI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ghe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Khe(e){if(Array.isArray(e))return e}function qhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zhe(n.key),n)}}function Xhe(e,t,r){return t&&fI(e.prototype,t),r&&fI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zhe(e){var t=Qhe(e,"string");return oh(t)==="symbol"?t:String(t)}function Qhe(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jhe=function(){function e(t){qhe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Xhe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),A(this.rows,function(n){r(n.row,Pt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),A(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){A(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),A(i,function(l){var s=Uhe(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){A(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),te(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return te(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const nT=Jhe;function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function ede(e,t,r){return t=WW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WW(n.key),n)}}function rde(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WW(e){var t=nde(e,"string");return ih(t)==="symbol"?t:String(t)}function nde(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ode=function(){function e(t){tde(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return rde(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return Ce(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return Ce(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ue(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(Dt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var y=a.get(v);if(y.needed){var m=s.indexOf(c)>-1;(!m||i.allowDuplicates||d)&&(y.strings.push(ede({value:c},l,u)),s.push(c),y.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const UW=ode;var sa=1,lr=2;function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function ide(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lde(n.key),n)}}function ade(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lde(e){var t=sde(e,"string");return ah(t)==="symbol"?t:String(t)}function sde(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wl=new WeakMap,ude=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;ide(this,e),wl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return ade(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=wl.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,y=h>0?v+1:v,m=0;m<d;m++)if(i=this._getColumnWidth(m),r<=h&&u!==lr&&(this.startColumn=m,a=i),r>=h&&r+(u===lr?i:0)<=h+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,a=i),this.endColumn=m),o.push(r),r+=i,l=i,u!==lr&&(this.endColumn=m),r>=h+v){n=!1;break}var b=c+v-y,S=u===lr?0:l,C=u===lr?a:0;if(b<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var k=o[this.endColumn]+i-o[this.startColumn-1];if((k<=v||u!==lr)&&(this.startColumn-=1),k>v)break}u===sa&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=wl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=wl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=wl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=wl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const oT=ude;function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function fde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hde(n.key),n)}}function cde(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hde(e){var t=dde(e,"string");return lh(t)==="symbol"?t:String(t)}function dde(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vI=new WeakMap,vde=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;fde(this,e),vI.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return cde(e,[{key:"calculate",value:function(){for(var r=vI.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,y=0,m=0,b=0;b<s;b++)if(v=i(b),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==lr&&(this.startRow=b,y=v),c>=l&&c+(n===lr?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=b,y=v),this.endRow=b),d.push(c),c+=v,m=v,n!==lr&&(this.endRow=b),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===lr?y:0,k=n===lr?0:m;if(S<C||a>d.at(-1)+k?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var O=d[this.endRow]+v-d[this.startRow-1];if((O<=u-f||n!==lr)&&(this.startRow-=1),O>=u-f)break}n===sa&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const zW=vde;function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function yde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YW(n.key),n)}}function gde(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pde(e,t,r){mde(e,t),t.set(e,r)}function mde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gI(e,t,r){return t=YW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YW(e){var t=bde(e,"string");return sh(t)==="symbol"?t:String(t)}function bde(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qf(e,t){var r=GW(e,t,"get");return wde(e,r)}function wde(e,t){return t.get?t.get.call(e):t.value}function Sde(e,t,r){var n=GW(e,t,"set");return Cde(e,n,r),r}function GW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Cde(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gi=new WeakMap,_de=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;yde(this,e),gI(this,"row",null),gI(this,"col",null),pde(this,Gi,{writable:!0,value:!1}),Sde(this,Gi,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return gde(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Qf(this,Gi)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Qf(this,Gi)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Qf(this,Gi)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Qf(this,Gi)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Qf(this,Gi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const up=_de;function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function Ode(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KW(n.key),n)}}function Rde(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ede(e,t,r){Tde(e,t),t.set(e,r)}function Tde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xw(e,t,r){return t=KW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KW(e){var t=Pde(e,"string");return uh(t)==="symbol"?t:String(t)}function Pde(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tn(e,t){var r=qW(e,t,"get");return kde(e,r)}function kde(e,t){return t.get?t.get.call(e):t.value}function $de(e,t,r){var n=qW(e,t,"set");return Ade(e,n,r),r}function qW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ade(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gr=new WeakMap,Ide=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Ode(this,e),xw(this,"highlight",null),xw(this,"from",null),xw(this,"to",null),Ede(this,Gr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),$de(this,Gr,o)}return Rde(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Tn(this,Gr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Tn(this,Gr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Tn(this,Gr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Tn(this,Gr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Tn(this,Gr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Tn(this,Gr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Tn(this,Gr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Tn(this,Gr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof up))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Tn(this,Gr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new up(r,n,Tn(this,Gr))}}]),e}();const iT=Ide;function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function Mde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dde(n.key),n)}}function xde(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dde(e){var t=Nde(e,"string");return fh(t)==="symbol"?t:String(t)}function Nde(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sl=new WeakMap,Hde=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Mde(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,Sl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return xde(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};pn()?n():(PE()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=Sl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=Sc(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Sl.get(this),o=this.domBindings.rootDocument.activeElement,i=jE(eW,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=Sc(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&mi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=Sc(r.target,["TD","TH"],n),i=Sc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&mi(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=Sl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Sl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ve(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];OE()&&(DV()||NV())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=Sl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const XW=Hde;function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function Lde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fde(n.key),n)}}function jde(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fde(e){var t=Bde(e,"string");return ch(t)==="symbol"?t:String(t)}function Bde(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vde=function(){function e(t,r,n){Lde(this,e),this.offset=t,this.total=r,this.countTH=n}return jde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Wde=Vde;function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function Ude(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yde(n.key),n)}}function zde(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yde(e){var t=Gde(e,"string");return hh(t)==="symbol"?t:String(t)}function Gde(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kde=function(){function e(t,r,n){Ude(this,e),this.offset=t,this.total=r,this.countTH=n}return zde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const qde=Kde;var Xde=0,fp=1,cp=2;function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function Zde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jde(n.key),n)}}function Qde(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jde(e){var t=eve(e,"string");return dh(t)==="symbol"?t:String(t)}function eve(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CI=function(){function e(){Zde(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Qde(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function tve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nve(n.key),n)}}function rve(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nve(e){var t=ove(e,"string");return vh(t)==="symbol"?t:String(t)}function ove(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ive=function(){function e(){tve(this,e),this.size=new CI,this.workingSpace=Xde,this.sharedSize=null}return rve(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof CI}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=fp,r.workingSpace=cp,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=cp,r.workingSpace=fp,this.sharedSize=r.getViewSize()}}]),e}();function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function ave(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sve(n.key),n)}}function lve(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sve(e){var t=uve(e,"string");return yh(t)==="symbol"?t:String(t)}function uve(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZW=function(){function e(t,r,n){ave(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new ive,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return lve(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(fp))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(cp)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(fp);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(cp)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function fve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hve(n.key),n)}}function cve(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hve(e){var t=dve(e,"string");return Hs(t)==="symbol"?t:String(t)}function dve(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T_(e,t)}function T_(e,t){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T_(e,t)}function yve(e){var t=mve();return function(){var n=hp(e),o;if(t){var i=hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gve(this,o)}}function gve(e,t){if(t&&(Hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pve(e)}function pve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hp(e){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hp(e)}var QW=function(e){vve(r,e);var t=yve(r);function r(){return fve(this,r),t.apply(this,arguments)}return cve(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(ZW);function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function bve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sve(n.key),n)}}function wve(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sve(e){var t=Cve(e,"string");return gh(t)==="symbol"?t:String(t)}function Cve(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _ve=function(){function e(t){bve(this,e),this.nodeType=t.toUpperCase()}return wve(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Ove(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eve(n.key),n)}}function Rve(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eve(e){var t=Tve(e,"string");return ph(t)==="symbol"?t:String(t)}function Tve(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mv=function(){function e(t,r){Ove(this,e),this.nodesPool=typeof t=="string"?new _ve(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Rve(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function Pve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$ve(n.key),n)}}function kve(e,t,r){return t&&PI(e.prototype,t),r&&PI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ve(e){var t=Ave(e,"string");return Ls(t)==="symbol"?t:String(t)}function Ave(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ive(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P_(e,t)}function P_(e,t){return P_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},P_(e,t)}function Mve(e){var t=Nve();return function(){var n=dp(e),o;if(t){var i=dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xve(this,o)}}function xve(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dve(e)}function Dve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dp(e){return dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dp(e)}var Hve=function(e){Ive(r,e);var t=Mve(r);function r(){var n;return Pve(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return kve(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new QW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<l;y++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),a[y](c,m,y)}d.end()}}}]),r}(Mv);function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function Lve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fve(n.key),n)}}function jve(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fve(e){var t=Bve(e,"string");return js(t)==="symbol"?t:String(t)}function Bve(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k_(e,t)}function k_(e,t){return k_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},k_(e,t)}function Wve(e){var t=Yve();return function(){var n=vp(e),o;if(t){var i=vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uve(this,o)}}function Uve(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zve(e)}function zve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vp(e)}var Gve=function(e){Vve(r,e);var t=Wve(r);function r(n){return Lve(this,r),t.call(this,null,n)}return jve(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Cn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(Mv);function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function Kve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xve(n.key),n)}}function qve(e,t,r){return t&&$I(e.prototype,t),r&&$I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xve(e){var t=Zve(e,"string");return Fs(t)==="symbol"?t:String(t)}function Zve(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}function $_(e,t){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$_(e,t)}function Jve(e){var t=rye();return function(){var n=yp(e),o;if(t){var i=yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eye(this,o)}}function eye(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tye(e)}function tye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yp(e){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yp(e)}var nye=function(e){Qve(r,e);var t=Jve(r);function r(n){return Kve(this,r),t.call(this,null,n)}return qve(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&te(d,"rowHeader")}}]),r}(Mv);function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}var AI;function oye(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function iye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function II(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lye(n.key),n)}}function aye(e,t,r){return t&&II(e.prototype,t),r&&II(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lye(e){var t=sye(e,"string");return Bs(t)==="symbol"?t:String(t)}function sye(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function A_(e,t){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},A_(e,t)}function fye(e){var t=dye();return function(){var n=gp(e),o;if(t){var i=gp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cye(this,o)}}function cye(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hye(e)}function hye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gp(e){return gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gp(e)}var MI=!1,vye=function(e){uye(r,e);var t=fye(r);function r(n){var o;return iye(this,r),o=t.call(this,"TR",n),o.orderView=new ZW(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return aye(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!MI&&o>1e3&&(MI=!0,wt(dt(AI||(AI=oye([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Mv);function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}function yye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pye(n.key),n)}}function gye(e,t,r){return t&&xI(e.prototype,t),r&&xI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pye(e){var t=mye(e,"string");return Vs(t)==="symbol"?t:String(t)}function mye(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I_(e,t)}function I_(e,t){return I_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},I_(e,t)}function wye(e){var t=_ye();return function(){var n=pp(e),o;if(t){var i=pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Sye(this,o)}}function Sye(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cye(e)}function Cye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pp(e){return pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pp(e)}var Oye=function(e){bye(r,e);var t=wye(r);function r(){var n;return yye(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return gye(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new QW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var y=h.getCurrentNode(),m=this.table.renderedColumnToSource(v);xe(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(f,m,y)}h.end()}}}]),r}(Mv);function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function Rye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tye(n.key),n)}}function Eye(e,t,r){return t&&DI(e.prototype,t),r&&DI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tye(e){var t=Pye(e,"string");return mh(t)==="symbol"?t:String(t)}function Pye(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kye=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Rye(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Eye(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function $ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iye(n.key),n)}}function Aye(e,t,r){return t&&NI(e.prototype,t),r&&NI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iye(e){var t=Mye(e,"string");return bh(t)==="symbol"?t:String(t)}function Mye(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xye=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;$ye(this,e),this.renderer=new kye(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Hve,columnHeaders:new Gve(n),colGroup:new nye(o),rows:new vye(i),cells:new Oye}),this.renderer.setAxisUtils(a,l)}return Aye(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Dye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hye(n.key),n)}}function Nye(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hye(e){var t=Lye(e,"string");return wh(t)==="symbol"?t:String(t)}function Lye(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jye=function(){function e(t,r){Dye(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Nye(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Jt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function Fye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vye(n.key),n)}}function Bye(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vye(e){var t=Wye(e,"string");return Sh(t)==="symbol"?t:String(t)}function Wye(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uye=function(){function e(t,r){Fye(this,e),this.dataAccessObject=t,this.wtSettings=r}return Bye(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}function zye(e){return Kye(e)||Gye(e)||JW(e)||Yye()}function Yye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kye(e){if(Array.isArray(e))return M_(e)}function qye(e,t){return Qye(e)||Zye(e,t)||JW(e,t)||Xye()}function Xye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JW(e,t){if(e){if(typeof e=="string")return M_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M_(e,t)}}function M_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Qye(e){if(Array.isArray(e))return e}function Jye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e2(n.key),n)}}function ege(e,t,r){return t&&jI(e.prototype,t),r&&jI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pn(e,t,r){return t=e2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e2(e){var t=tge(e,"string");return Ch(t)==="symbol"?t:String(t)}function tge(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rge=function(){function e(t,r,n,o,i){var a=this;Jye(this,e),Pn(this,"wtSettings",null),Pn(this,"domBindings",void 0),Pn(this,"TBODY",null),Pn(this,"THEAD",null),Pn(this,"COLGROUP",null),Pn(this,"hasTableHeight",!0),Pn(this,"hasTableWidth",!0),Pn(this,"isTableVisible",!1),Pn(this,"tableOffset",0),Pn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,ME(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new Uye(this.dataAccessObject,this.wtSettings),this.columnUtils=new jye(this.dataAccessObject,this.wtSettings),this.tableRenderer=new xye({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return ege(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Ut(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var y=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,m!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ut(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var b=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new qde(b,l,h),this.columnFilter=new Wde(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var k={};this.wtSettings.getSetting("beforeDraw",!0,k),C=k.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Bn)||this.is(bi))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var O;if(this.isMaster&&(O=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Bn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var B=ht(this.hider),z=ht(this.TABLE);B!==0&&z!==B&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),O!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Bn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var q=!1;return this.isMaster&&(q=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(q=i.bottomOverlay.resetFixedPosition()||q),q=i.inlineStartOverlay.resetFixedPosition()||q,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),q?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=ho(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Bn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Le(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,y=0;y<v;y++)l.includes(d[y])||l.push(d[y]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var m=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var b=0;b<m.length;b++)l.push(m[b]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var k=0;k<a;k++)i[k].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=qye(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=pi(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=rW(o),l=n.cellIndex;if(li(Ka,n,this.wtRootElement)||li(Ya,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(li(bi,n,this.wtRootElement)||li(Bn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return li(Ka,n,this.wtRootElement)||li(Ga,n,this.wtRootElement)||li(bi,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=ho(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=ho(u):a=ho(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ht(this.TABLE)}},{key:"getHeight",value:function(){return Pt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ht(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Pt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return ms(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=pt(r)?r():null;return Array.isArray(n)?(n=zye(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Df=rge;var nge="stickyRowsBottom",t2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(t2,"MIXIN_NAME",nge,{writable:!1,enumerable:!1});const r2=t2;var oge="stickyColumnsStart",n2={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Kn(n2,"MIXIN_NAME",oge,{writable:!1,enumerable:!1});const aT=n2;function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function FI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,age(n.key),n)}}function ige(e,t,r){return t&&FI(e.prototype,t),r&&FI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function age(e){var t=lge(e,"string");return Ws(t)==="symbol"?t:String(t)}function lge(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function fge(e){var t=dge();return function(){var n=mp(e),o;if(t){var i=mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cge(this,o)}}function cge(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hge(e)}function hge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mp(e){return mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mp(e)}var lT=function(e){uge(r,e);var t=fge(r);function r(n,o,i,a){return sge(this,r),t.call(this,n,o,i,a,bi)}return ige(r)}(Df);gt(lT,r2);gt(lT,aT);const vge=lT;var Ya="top",Bn="bottom",Ga="inline_start",Ka="top_inline_start_corner",bi="bottom_inline_start_corner",yge=[Ya,Bn,Ga,Ka,bi],gge=new Map([[Ya,"ht_clone_".concat(Ya)],[Bn,"ht_clone_".concat(Bn)],[Ga,"ht_clone_".concat(Ga," ht_clone_left")],[Ka,"ht_clone_".concat(Ka," ht_clone_top_left_corner")],[bi,"ht_clone_".concat(bi," ht_clone_bottom_left_corner")]]),pge=Yt,mge=Math.floor,bge=Number.isInteger||function(t){return!pge(t)&&isFinite(t)&&mge(t)===t},wge=$e,Sge=bge;wge({target:"Number",stat:!0},{isInteger:Sge});function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function Cge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o2(n.key),n)}}function _ge(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dw(e,t,r){return t=o2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o2(e){var t=Oge(e,"string");return _h(t)==="symbol"?t:String(t)}function Oge(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rge=function(){function e(t){Cge(this,e),Dw(this,"dataAccessObject",void 0),Dw(this,"lastScrolledColumnPos",-1),Dw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return _ge(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var y=!1;return s===-1?y=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(y=v.scrollTo(r,f?r>u:o)),y&&(this.lastScrolledRowPos=r),y}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Ut(o.wtRootElement),c=ho(o.hider),h=ho(s),d=Zc(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var y=a;y>0;y--)if(v+=n.sumCellSizes(y-1,y),f.top+c-v<=d){u=y;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=Zc(l,l);if(u.top>f){for(var c=ho(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=Ac(o.hider),c=Ac(l),h=Math.abs(tp(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var y=Ut(i.wtRootElement);c=y.left}var m=Math.abs(tp(s,s));if(c>m){for(var b=Ac(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-m>=b){u=C-2;break}}}return u}}]),e}();const Ege=Rge;function Oh(e){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}function Tge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i2(n.key),n)}}function Pge(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sn(e,t,r){return t=i2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i2(e){var t=kge(e,"string");return Oh(t)==="symbol"?t:String(t)}function kge(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sT=function(){function e(t,r){Tge(this,e),sn(this,"wtTable",void 0),sn(this,"wtScroll",void 0),sn(this,"wtViewport",void 0),sn(this,"wtOverlays",void 0),sn(this,"selections",void 0),sn(this,"wtEvent",void 0),sn(this,"guid","wt_".concat($E())),sn(this,"drawInterrupted",!1),sn(this,"drawn",!1),sn(this,"domBindings",void 0),sn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Ege(this.createScrollDao())}return Pge(e,[{key:"eventManager",get:function(){return new kt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ai(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new up(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new iT(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a2(n.key),n)}}function $ge(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Age(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ige(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D_(e,t)}function D_(e,t){return D_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},D_(e,t)}function Mge(e){var t=Dge();return function(){var n=bp(e),o;if(t){var i=bp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xge(this,o)}}function xge(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mg(e)}function mg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bp(e){return bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bp(e)}function UI(e,t,r){return t=a2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a2(e){var t=Nge(e,"string");return Us(t)==="symbol"?t:String(t)}function Nge(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hge=function(e){Ige(r,e);var t=Mge(r);function r(n,o,i){var a;Age(this,r),a=t.call(this,n,o),UI(mg(a),"cloneSource",void 0),UI(mg(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",mg(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new XW(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return $ge(r)}(sT);function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function Lge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l2(n.key),n)}}function jge(e,t,r){return t&&zI(e.prototype,t),r&&zI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fge(e,t,r){return t=l2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l2(e){var t=Bge(e,"string");return Rh(t)==="symbol"?t:String(t)}function Bge(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xv=function(){function e(t,r,n,o,i){Lge(this,e),Fge(this,"wtSettings",null),Kn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=Wa(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return jge(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Wa(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Qc(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){wt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Jt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(yge.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(gge.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ya||u==="vertical"&&this.type===Ga?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Qc(r.TABLE),new Hge(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;A([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function bg(e,t,r){return s2()?bg=Reflect.construct.bind():bg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&wp(u,a.prototype),u},bg.apply(null,arguments)}function Vge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uge(n.key),n)}}function Wge(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uge(e){var t=zge(e,"string");return zs(t)==="symbol"?t:String(t)}function zge(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wp(e,t)}function wp(e,t){return wp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wp(e,t)}function Gge(e){var t=s2();return function(){var n=Sp(e),o;if(t){var i=Sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kge(this,o)}}function Kge(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qge(e)}function qge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sp(e){return Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sp(e)}var Xge=function(e){Yge(r,e);var t=Gge(r);function r(n,o,i,a,l,s){var u;return Vge(this,r),u=t.call(this,n,o,bi,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return Wge(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return bg(vge,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else Tv(i),this.repositionOverlay();var s=Pt(this.clone.wtTable.TABLE),u=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}}]),r}(xv),Zge="calculatedColumns",u2={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Kn(u2,"MIXIN_NAME",Zge,{writable:!1,enumerable:!1});const uT=u2;function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jge(n.key),n)}}function Qge(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jge(e){var t=epe(e,"string");return Ys(t)==="symbol"?t:String(t)}function epe(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N_(e,t)}function N_(e,t){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N_(e,t)}function npe(e){var t=ape();return function(){var n=Cp(e),o;if(t){var i=Cp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ope(this,o)}}function ope(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ipe(e)}function ipe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ape(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cp(e){return Cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cp(e)}var fT=function(e){rpe(r,e);var t=npe(r);function r(n,o,i,a){return tpe(this,r),t.call(this,n,o,i,a,Bn)}return Qge(r)}(Df);gt(fT,r2);gt(fT,uT);const lpe=fT;function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function wg(e,t,r){return c2()?wg=Reflect.construct.bind():wg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&_p(u,a.prototype),u},wg.apply(null,arguments)}function spe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h2(n.key),n)}}function upe(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_p(e,t)}function _p(e,t){return _p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_p(e,t)}function cpe(e){var t=c2();return function(){var n=Op(e),o;if(t){var i=Op(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hpe(this,o)}}function hpe(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f2(e)}function f2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Op(e)}function dpe(e,t,r){return t=h2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h2(e){var t=vpe(e,"string");return Gs(t)==="symbol"?t:String(t)}function vpe(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ype=function(e){fpe(r,e);var t=cpe(r);function r(n,o,i,a){var l;return spe(this,r),l=t.call(this,n,o,Bn,i,a),dpe(f2(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return upe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return wg(lpe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Va(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Jt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var y=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),h.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Zc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(te(u,"innerBorderBottom"),s=!f):(Le(u,"innerBorderBottom"),s=f)}return s}}]),r}(xv),gpe="calculatedRows",d2={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Kn(d2,"MIXIN_NAME",gpe,{writable:!1,enumerable:!1});const v2=d2;function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mpe(n.key),n)}}function ppe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mpe(e){var t=bpe(e,"string");return Ks(t)==="symbol"?t:String(t)}function bpe(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Spe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H_(e,t)}function H_(e,t){return H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},H_(e,t)}function Cpe(e){var t=Rpe();return function(){var n=Rp(e),o;if(t){var i=Rp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _pe(this,o)}}function _pe(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ope(e)}function Ope(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rp(e){return Rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rp(e)}var cT=function(e){Spe(r,e);var t=Cpe(r);function r(n,o,i,a){return wpe(this,r),t.call(this,n,o,i,a,Ga)}return ppe(r)}(Df);gt(cT,v2);gt(cT,aT);const Epe=cT;function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function Sg(e,t,r){return y2()?Sg=Reflect.construct.bind():Sg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Ep(u,a.prototype),u},Sg.apply(null,arguments)}function Tpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kpe(n.key),n)}}function Ppe(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kpe(e){var t=$pe(e,"string");return qs(t)==="symbol"?t:String(t)}function $pe(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ape(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ep(e,t)}function Ep(e,t){return Ep=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ep(e,t)}function Ipe(e){var t=y2();return function(){var n=Tp(e),o;if(t){var i=Tp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Mpe(this,o)}}function Mpe(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xpe(e)}function xpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tp(e)}var Dpe=function(e){Ape(r,e);var t=Ipe(r);function r(n,o,i,a){return Tpe(this,r),t.call(this,n,o,Ga,i,a)}return Ppe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Sg(Epe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Wm(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),Tv(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,bs(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=ht(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(tp(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Le(i,"emptyRows"):te(i,"emptyRows");var u=!1;if(l&&!a.length)te(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(te(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(Le(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(xv),Npe="stickyRowsTop",g2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(g2,"MIXIN_NAME",Npe,{writable:!1,enumerable:!1});const p2=g2;function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lpe(n.key),n)}}function Hpe(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lpe(e){var t=jpe(e,"string");return Xs(t)==="symbol"?t:String(t)}function jpe(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L_(e,t)}function L_(e,t){return L_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},L_(e,t)}function Vpe(e){var t=zpe();return function(){var n=Pp(e),o;if(t){var i=Pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Wpe(this,o)}}function Wpe(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Upe(e)}function Upe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pp(e){return Pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pp(e)}var hT=function(e){Bpe(r,e);var t=Vpe(r);function r(n,o,i,a){return Fpe(this,r),t.call(this,n,o,i,a,Ka)}return Hpe(r)}(Df);gt(hT,p2);gt(hT,aT);const Ype=hT;function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function Cg(e,t,r){return m2()?Cg=Reflect.construct.bind():Cg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&kp(u,a.prototype),u},Cg.apply(null,arguments)}function Gpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b2(n.key),n)}}function Kpe(e,t,r){return t&&QI(e.prototype,t),r&&QI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kp(e,t)}function kp(e,t){return kp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kp(e,t)}function Xpe(e){var t=m2();return function(){var n=$p(e),o;if(t){var i=$p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zpe(this,o)}}function Zpe(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j_(e)}function j_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $p(e){return $p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$p(e)}function JI(e,t,r){return t=b2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b2(e){var t=Qpe(e,"string");return Zs(t)==="symbol"?t:String(t)}function Qpe(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jpe=function(e){qpe(r,e);var t=Xpe(r);function r(n,o,i,a,l,s){var u;return Gpe(this,r),u=t.call(this,n,o,Ka,i,a),JI(j_(u),"topOverlay",void 0),JI(j_(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return Kpe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Cg(Ype,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();Wm(o,"".concat(i,"px"),"".concat(a,"px"))}else Tv(o);var l=Pt(this.clone.wtTable.TABLE),s=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(xv);function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tme(n.key),n)}}function eme(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tme(e){var t=rme(e,"string");return Qs(t)==="symbol"?t:String(t)}function rme(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ome(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F_(e,t)}function F_(e,t){return F_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},F_(e,t)}function ime(e){var t=sme();return function(){var n=Ap(e),o;if(t){var i=Ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ame(this,o)}}function ame(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lme(e)}function lme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ap(e){return Ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ap(e)}var dT=function(e){ome(r,e);var t=ime(r);function r(n,o,i,a){return nme(this,r),t.call(this,n,o,i,a,Ya)}return eme(r)}(Df);gt(dT,p2);gt(dT,uT);const ume=dT;function Js(e){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Js(e)}function _g(e,t,r){return S2()?_g=Reflect.construct.bind():_g=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Ip(u,a.prototype),u},_g.apply(null,arguments)}function fme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C2(n.key),n)}}function cme(e,t,r){return t&&tM(e.prototype,t),r&&tM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ip(e,t)}function Ip(e,t){return Ip=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ip(e,t)}function dme(e){var t=S2();return function(){var n=Mp(e),o;if(t){var i=Mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vme(this,o)}}function vme(e,t){if(t&&(Js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w2(e)}function w2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}function yme(e,t,r){return t=C2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C2(e){var t=gme(e,"string");return Js(t)==="symbol"?t:String(t)}function gme(e,t){if(Js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pme=function(e){hme(r,e);var t=dme(r);function r(n,o,i,a){var l;return fme(this,r),l=t.call(this,n,o,Ya,i,a),yme(w2(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return cme(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return _g(ume,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),Wm(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),Tv(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Va(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Jt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Zc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Le(a,"emptyColumns"):te(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(te(a,"innerBorderTop"),s=!h):(Le(a,"innerBorderTop"),s=h)}}return s}}]),r}(xv);function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function fi(e,t,r){return mme()?fi=Reflect.construct.bind():fi=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&B_(u,a.prototype),u},fi.apply(null,arguments)}function mme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function B_(e,t){return B_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},B_(e,t)}function bme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_2(n.key),n)}}function wme(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qn(e,t,r){return t=_2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _2(e){var t=Sme(e,"string");return Eh(t)==="symbol"?t:String(t)}function Sme(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cme=function(){function e(t,r,n,o,i,a){var l=this;bme(this,e),Qn(this,"wot",null),Qn(this,"topOverlay",null),Qn(this,"bottomOverlay",null),Qn(this,"inlineStartOverlay",null),Qn(this,"topInlineStartCornerOverlay",null),Qn(this,"bottomInlineStartCornerOverlay",null),Qn(this,"browserLineHeight",void 0),Qn(this,"wtSettings",null),Qn(this,"resizeObserver",new ResizeObserver(function(h){Bm(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Jt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Qc(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return wme(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=fi(pme,r),this.bottomOverlay=fi(ype,r),this.inlineStartOverlay=fi(Dpe,r),this.topInlineStartCornerOverlay=fi(Jpe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=fi(Xge,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!_E())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var y=v.clone.wtTable.holder;r.eventManager.addEventListener(y,"wheel",function(m){return r.onCloneWheel(m,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=ps(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Qc(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,y=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<y,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return A(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const _me=Cme;function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function Ome(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O2(n.key),n)}}function Rme(e,t,r){return t&&nM(e.prototype,t),r&&nM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oM(e,t,r){return t=O2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O2(e){var t=Eme(e,"string");return Th(t)==="symbol"?t:String(t)}function Eme(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tme=function(){function e(t){var r=this;Ome(this,e),oM(this,"settings",{}),oM(this,"defaults",Object.freeze(this.getDefaults())),ze(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return Rme(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ai(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?ze(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function eu(e){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function Pme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$me(n.key),n)}}function kme(e,t,r){return t&&iM(e.prototype,t),r&&iM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $me(e){var t=Ame(e,"string");return eu(t)==="symbol"?t:String(t)}function Ame(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ime(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V_(e,t)}function V_(e,t){return V_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},V_(e,t)}function Mme(e){var t=Nme();return function(){var n=xp(e),o;if(t){var i=xp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xme(this,o)}}function xme(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dme(e)}function Dme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xp(e){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xp(e)}var vT=function(e){Ime(r,e);var t=Mme(r);function r(n,o,i,a){return Pme(this,r),t.call(this,n,o,i,a,"master")}return kme(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Wa(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=ws(o,"height",i),u=ws(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,y=d.height,m=["auto","hidden","scroll"];if(l&&m.includes(u)){var b=o.cloneNode(!1);b.style.overflow="auto",b.style.position="absolute",o.nextElementSibling?l.insertBefore(b,o.nextElementSibling):l.appendChild(b);var S=parseInt(Ii(b,i).height,10);l.removeChild(b),S===0&&(y=0)}y=Math.min(y,h),f.height=s==="auto"?"auto":"".concat(y,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:y>0,this.hasTableWidth=v>0}this.isTableVisible=ms(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Df);gt(vT,v2);gt(vT,uT);const Hme=vT;function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function Lme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fme(n.key),n)}}function jme(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fme(e){var t=Bme(e,"string");return Ph(t)==="symbol"?t:String(t)}function Bme(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vme=function(){function e(t,r,n,o,i){var a=this;Lme(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return jme(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Pt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,y;if(u)return ht(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(y=ws(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,a.clientWidth);var m=r.getSetting("stretchH");return m==="none"||!m?Math.max(v,ht(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Ut(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Pt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=ht(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sa,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===sa?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Jt(this.domBindings.rootDocument),new zW({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sa,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new oT({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(lr),i=this.createColumnsCalculator(lr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(sa),this.columnsRenderCalculator=this.createColumnsCalculator(sa)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(lr),this.columnsVisibleCalculator=this.createColumnsCalculator(lr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){ze(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const Wme=Vme;function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function Ume(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yme(n.key),n)}}function zme(e,t,r){return t&&lM(e.prototype,t),r&&lM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yme(e){var t=Gme(e,"string");return tu(t)==="symbol"?t:String(t)}function Gme(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W_(e,t)}function W_(e,t){return W_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},W_(e,t)}function qme(e){var t=Zme();return function(){var n=Dp(e),o;if(t){var i=Dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Xme(this,o)}}function Xme(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U_(e)}function U_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dp(e){return Dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dp(e)}var Qme=function(e){Kme(r,e);var t=qme(r);function r(n,o){var i;Ume(this,r),i=t.call(this,n,new Tme(o));var a=i.wtSettings.getSetting("facade",U_(i));return i.wtTable=new Hme(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new Wme(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new XW(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new _me(U_(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return zme(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];ze(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Le(this.wtTable.wtRootElement.parentNode,a),te(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(sT);function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function Jme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tbe(n.key),n)}}function ebe(e,t,r){return t&&sM(e.prototype,t),r&&sM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tbe(e){var t=rbe(e,"string");return kh(t)==="symbol"?t:String(t)}function rbe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nbe=function(){function e(t){Jme(this,e),t instanceof sT?this._wot=t:this._initFromSettings(t)}return ebe(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new Qme(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),R2=Gt,obe=je,E2=Ye,ibe=fv,abe=rv,lbe=zr,sbe=av.f,T2=E2(sbe),ube=E2([].push),fbe=R2&&obe(function(){var e=Object.create(null);return e[2]=2,!T2(e,2)}),uM=function(e){return function(t){for(var r=lbe(t),n=abe(r),o=fbe&&ibe(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!R2||(o?s in r:T2(r,s)))&&ube(l,e?[s,r[s]]:r[s]);return l}},cbe={entries:uM(!0),values:uM(!1)},hbe=$e,dbe=cbe.values;hbe({target:"Object",stat:!0},{values:function(t){return dbe(t)}});function $h(e){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}function Nw(e,t){return pbe(e)||gbe(e,t)||ybe(e,t)||vbe()}function vbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ybe(e,t){if(e){if(typeof e=="string")return fM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fM(e,t)}}function fM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function pbe(e){if(Array.isArray(e))return e}function mbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wbe(n.key),n)}}function bbe(e,t,r){return t&&cM(e.prototype,t),r&&cM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wbe(e){var t=Sbe(e,"string");return $h(t)==="symbol"?t:String(t)}function Sbe(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cbe=function(){function e(t,r){mbe(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return bbe(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),wn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),pn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};ze(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};ze(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,y=parseInt(c.borderWidth,10),m=parseInt(c.width,10),b=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-m-1,10),"px"),c[u]="".concat(parseInt(i-m-1,10),"px"),h.top="".concat(parseInt(o-b/4*3,10),"px"),h[u]="".concat(parseInt(i-b/4*3,10),"px");var k=Math.min(parseInt(i+a,10),S-m-y*2),O=Math.min(parseInt(i+a-b/4,10),S-b-y*2);d[u]="".concat(k,"px"),v[u]="".concat(O,"px");var B=Math.min(parseInt(o+l,10),C-m-y*2),z=Math.min(parseInt(o+l-b/4,10),C-b-y*2);d.top="".concat(B,"px"),v.top="".concat(z,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var y=o.rowFilter.renderedToSource(v);if(y>=r[0]&&y<=r[2]){l=y,c=r[0];break}}for(var m=d-1;m>=0;m-=1){var b=o.rowFilter.renderedToSource(m);if(b>=r[0]&&b<=r[2]){s=b;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var k=o.columnFilter.renderedToSource(C);if(k>=r[1]&&k<=r[3]){u=k,h=r[1];break}}for(var O=S-1;O>=0;O-=1){var B=o.columnFilter.renderedToSource(O);if(B>=r[1]&&B<=r[3]){f=B;break}}if(l===void 0||u===void 0){this.disappear();return}var z=o.getCell(this.wot.createCellCoords(l,u)),q=l!==s||u!==f,G=q?o.getCell(this.wot.createCellCoords(s,f)):z,X=Ut(z),Q=q?Ut(G):X,oe=Ut(o.TABLE),J=ht(o.TABLE),ue=X.top,he=X.left,Oe=this.wot.wtSettings.getSetting("rtlMode"),we=0,$=0;if(Oe){var P=ht(z),g=a.innerWidth-oe.left-J;$=he+P-Q.left,we=a.innerWidth-he-P-g-1}else $=Q.left+ht(G)-he,we=he-oe.left-1;if(this.isEntireColumnSelected(l,s)){var p=this.getDimensionsFromHeader("columns",u,f,c,oe),w=null;if(p){var E=Nw(p,3);w=E[0],we=E[1],$=E[2]}w&&(z=w)}var R=ue-oe.top-1,F=Q.top+Pt(G)-ue;if(this.isEntireRowSelected(u,f)){var x=this.getDimensionsFromHeader("rows",l,s,h,oe),K=null;if(x){var Z=Nw(x,3);K=Z[0],R=Z[1],F=Z[2]}K&&(z=K)}var re=Ii(z,a);parseInt(re.borderTopWidth,10)>0&&(R+=1,F=F>0?F-1:0),parseInt(re[Oe?"borderRightWidth":"borderLeftWidth"],10)>0&&(we+=1,$=$>0?$-1:0);var ie=Oe?"right":"left";this.topStyle.top="".concat(R,"px"),this.topStyle[ie]="".concat(we,"px"),this.topStyle.width="".concat($,"px"),this.topStyle.display="block",this.startStyle.top="".concat(R,"px"),this.startStyle[ie]="".concat(we,"px"),this.startStyle.height="".concat(F,"px"),this.startStyle.display="block";var se=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(R+F-se,"px"),this.bottomStyle[ie]="".concat(we,"px"),this.bottomStyle.width="".concat($,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(R,"px"),this.endStyle[ie]="".concat(we+$-se,"px"),this.endStyle.height="".concat(F+1,"px"),this.endStyle.display="block";var _e=this.settings.border.cornerVisible;_e=typeof _e=="function"?_e(this.settings.layerLevel):_e;var Se=this.wot.getSetting("onModifyGetCellCoords",s,f),U=s,Ne=f;if(Se&&Array.isArray(Se)){var Be=Nw(Se,4);U=Be[2],Ne=Be[3]}if(pn()||!_e||this.isPartRange(U,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(R+F+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ie]="".concat(we+$+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ke=Wa(o.TABLE),Ie=ke===a;Ie&&(ke=i.documentElement);var Ae=parseInt(this.cornerDefaultStyle.width,10)/2,_=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var T=Ie?G.getBoundingClientRect().left:G.offsetLeft,I=!1,j=0;Oe?(j=T-parseInt(this.cornerDefaultStyle.width,10)/2,I=j<0):(j=T+ht(G)+parseInt(this.cornerDefaultStyle.width,10)/2,I=j>=Ac(ke)),I&&(this.cornerStyle[ie]="".concat(Math.floor(we+$+this.cornerCenterPointOffset-Ae),"px"),this.cornerStyle[Oe?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ie?G.getBoundingClientRect().top:G.offsetTop,V=M+Pt(G)+parseInt(this.cornerDefaultStyle.height,10)/2,N=V>=ho(ke);N&&(this.cornerStyle.top="".concat(Math.floor(R+F+this.cornerCenterPointOffset-_),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}pn()&&this.updateMultipleSelectionHandlesPosition(s,f,R,we,$,F)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,y=null,m=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Pt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return ht.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var b=this.wot.getSetting("columnHeaders").length;if(y=u(n,b-i),m=u(o,b-i),!y||!m)return!1;var S=Ut(y),C=Ut(m);return y&&m&&(h=S[v]-a[v]-1,d=C[v]+f(m)-S[v]),[y,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?te(this[r],"hidden"):(xe(this[r],"hidden")&&Le(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?te(this[r],"hidden"):Le(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",pn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const _be=Cbe;function Obe(e,t){return Pbe(e)||Tbe(e,t)||Ebe(e,t)||Rbe()}function Rbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ebe(e,t){if(e){if(typeof e=="string")return hM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hM(e,t)}}function hM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Pbe(e){if(Array.isArray(e))return e}function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function kbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Abe(n.key),n)}}function $be(e,t,r){return t&&dM(e.prototype,t),r&&dM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Abe(e){var t=Ibe(e,"string");return ru(t)==="symbol"?t:String(t)}function Ibe(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mbe=function(){function e(t,r){kbe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return $be(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new _be(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(ru(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),te(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Obe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,m=c.selectionType,b=m===void 0||["active-header","header"].includes(m);if(b&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var k=r.wtTable.columnFilter.renderedToSource(C);if(k>=s&&k<=f){var O=r.wtTable.getColumnHeaders(k),B=O.length-1;y&&O.length>1&&(O=[O[B]]);for(var z=0;z<O.length;z+=1){var q=[],G=O[z];h&&q.push(h),d&&q.push(d),z=y?B:z;var X=r.getSetting("onBeforeHighlightingColumnHeader",k,z,{selectionType:m,columnCursor:S,selectionWidth:f-s+1,classNames:q});X!==k&&(G=r.wtTable.getColumnHeader(X,z)),te(G,q)}S+=1}}if(l!==null&&u!==null)for(var Q=0,oe=0;oe<n;oe+=1){var J=r.wtTable.rowFilter.renderedToSource(oe);if(b&&J>=l&&J<=u){var ue=r.wtTable.getRowHeaders(J),he=ue.length-1;y&&ue.length>1&&(ue=[ue[he]]);for(var Oe=0;Oe<ue.length;Oe+=1){var we=[],$=ue[Oe];h&&we.push(h),v&&we.push(v),Oe=y?he:Oe;var P=r.getSetting("onBeforeHighlightingRowHeader",J,Oe,{selectionType:m,rowCursor:Q,selectionHeight:u-l+1,classNames:we});P!==J&&($=r.wtTable.getRowHeader(P,Oe)),te($,we)}Q+=1}if(s!==null&&f!==null)for(var g=0;g<o;g+=1){var p=r.wtTable.columnFilter.renderedToSource(g);J>=l&&J<=u&&p>=s&&p<=f?this.settings.className&&this.addClassAtCoords(r,J,p,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,p,v):p>=s&&p<=f&&d&&this.addClassAtCoords(r,J,p,d);var w=r.getSetting("onAfterDrawSelection",J,p,this.settings.layerLevel);typeof w=="string"&&this.addClassAtCoords(r,J,p,w)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const xbe=Mbe;var Dbe=$e,Nbe=al.findIndex,Hbe=nv,z_="findIndex",P2=!0;z_ in[]&&Array(1)[z_](function(){P2=!1});Dbe({target:"Array",proto:!0,forced:P2},{findIndex:function(t){return Nbe(this,t,arguments.length>1?arguments[1]:void 0)}});Hbe(z_);var Lbe="localHooks",k2={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)rp(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Kn(k2,"MIXIN_NAME",Lbe,{writable:!1,enumerable:!1});const Mr=k2;function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function jbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bbe(n.key),n)}}function Fbe(e,t,r){return t&&vM(e.prototype,t),r&&vM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bbe(e){var t=Vbe(e,"string");return Ah(t)==="symbol"?t:String(t)}function Vbe(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cl=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;jbe(this,e),this.indexedValues=[],this.initValueOrFn=t}return Fbe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,pt(this.initValueOrFn)?Ce(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Ce(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();gt(cl,Mr);function Hw(e){return Ybe(e)||zbe(e)||Ube(e)||Wbe()}function Wbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ube(e,t){if(e){if(typeof e=="string")return Y_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y_(e,t)}}function zbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ybe(e){if(Array.isArray(e))return Y_(e)}function Y_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yT(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Hw(e.slice(0,o)),Hw(r.map(function(i,a){return pt(n)?n(i,a):n})),Hw(o===void 0?[]:e.slice(o)))}function gT(e,t){return Wr(e,function(r,n){return t.includes(n)===!1})}function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function Gbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qbe(n.key),n)}}function Kbe(e,t,r){return t&&yM(e.prototype,t),r&&yM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qbe(e){var t=Xbe(e,"string");return nu(t)==="symbol"?t:String(t)}function Xbe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xc(){return typeof Reflect<"u"&&Reflect.get?xc=Reflect.get.bind():xc=function(t,r,n){var o=Zbe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xc.apply(this,arguments)}function Zbe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qa(e),e!==null););return e}function Qbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G_(e,t)}function G_(e,t){return G_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},G_(e,t)}function Jbe(e){var t=rwe();return function(){var n=qa(e),o;if(t){var i=qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ewe(this,o)}}function ewe(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return twe(e)}function twe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qa(e){return qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qa(e)}var Li=function(e){Qbe(r,e);var t=Jbe(r);function r(){return Gbe(this,r),t.apply(this,arguments)}return Kbe(r,[{key:"insert",value:function(o,i){this.indexedValues=yT(this.indexedValues,o,i,this.initValueOrFn),xc(qa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=gT(this.indexedValues,o),xc(qa(r.prototype),"remove",this).call(this,o)}}]),r}(cl);function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function nwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iwe(n.key),n)}}function owe(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iwe(e){var t=awe(e,"string");return ou(t)==="symbol"?t:String(t)}function awe(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K_(e,t)}function K_(e,t){return K_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},K_(e,t)}function swe(e){var t=cwe();return function(){var n=Np(e),o;if(t){var i=Np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uwe(this,o)}}function uwe(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fwe(e)}function fwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Np(e)}var Km=function(e){lwe(r,e);var t=swe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return nwe(this,r),t.call(this,n)}return owe(r,[{key:"getHiddenIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Li);function Lw(e){return ywe(e)||vwe(e)||dwe(e)||hwe()}function hwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dwe(e,t){if(e){if(typeof e=="string")return q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q_(e,t)}}function vwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ywe(e){if(Array.isArray(e))return q_(e)}function q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pT(e,t,r){return[].concat(Lw(e.slice(0,t)),Lw(r),Lw(e.slice(t)))}function Ih(e,t){return Wr(e,function(r){return t.includes(r)===!1})}function mT(e,t){return We(e,function(r){return r-t.filter(function(n){return n<r}).length})}function bT(e,t){var r=t[0],n=t.length;return We(e,function(o){return o>=r?o+n:o})}function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function gwe(e){return wwe(e)||bwe(e)||mwe(e)||pwe()}function pwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mwe(e,t){if(e){if(typeof e=="string")return X_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X_(e,t)}}function bwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wwe(e){if(Array.isArray(e))return X_(e)}function X_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Swe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A2(n.key),n)}}function Cwe(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uo(){return typeof Reflect<"u"&&Reflect.get?uo=Reflect.get.bind():uo=function(t,r,n){var o=_we(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},uo.apply(this,arguments)}function _we(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yn(e),e!==null););return e}function Owe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z_(e,t)}function Z_(e,t){return Z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Z_(e,t)}function Rwe(e){var t=Twe();return function(){var n=yn(e),o;if(t){var i=yn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ewe(this,o)}}function Ewe(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $2(e)}function $2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Twe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yn(e){return yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yn(e)}function Pwe(e,t,r){return t=A2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A2(e){var t=kwe(e,"string");return iu(t)==="symbol"?t:String(t)}function kwe(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qm=function(e){Owe(r,e);var t=Rwe(r);function r(){var n;Swe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Pwe($2(n),"orderOfIndexes",[]),n}return Cwe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=gwe(Array(o.length).keys()),uo(yn(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=Ih(this.orderOfIndexes,[o]),pt(this.initValueOrFn)?uo(yn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):uo(yn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,uo(yn(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=yT(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=bT(this.orderOfIndexes,i),uo(yn(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=gT(this.indexedValues,o),this.orderOfIndexes=Ih(this.orderOfIndexes,o),this.orderOfIndexes=mT(this.orderOfIndexes,o),uo(yn(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(cl);function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function $we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iwe(n.key),n)}}function Awe(e,t,r){return t&&mM(e.prototype,t),r&&mM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iwe(e){var t=Mwe(e,"string");return au(t)==="symbol"?t:String(t)}function Mwe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q_(e,t)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q_(e,t)}function Dwe(e){var t=Lwe();return function(){var n=Hp(e),o;if(t){var i=Hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nwe(this,o)}}function Nwe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hwe(e)}function Hwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hp(e){return Hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hp(e)}var Dv=function(e){xwe(r,e);var t=Dwe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return $we(this,r),t.call(this,n)}return Awe(r,[{key:"getTrimmedIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Li),bM=new Map([["indexesSequence",{getListWithInsertedItems:pT,getListWithRemovedItems:Ih}],["physicallyIndexed",{getListWithInsertedItems:yT,getListWithRemovedItems:gT}]]),I2=function(t){if(bM.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return bM.get(t)};function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function jwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bwe(n.key),n)}}function Fwe(e,t,r){return t&&wM(e.prototype,t),r&&wM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bwe(e){var t=Vwe(e,"string");return lu(t)==="symbol"?t:String(t)}function Vwe(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dc(){return typeof Reflect<"u"&&Reflect.get?Dc=Reflect.get.bind():Dc=function(t,r,n){var o=Wwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dc.apply(this,arguments)}function Wwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xa(e),e!==null););return e}function Uwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J_(e,t)}function J_(e,t){return J_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},J_(e,t)}function zwe(e){var t=Kwe();return function(){var n=Xa(e),o;if(t){var i=Xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ywe(this,o)}}function Ywe(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gwe(e)}function Gwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xa(e){return Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xa(e)}var M2=function(e){Uwe(r,e);var t=zwe(r);function r(){return jwe(this,r),t.call(this,function(n){return n})}return Fwe(r,[{key:"insert",value:function(o,i){var a=bT(this.indexedValues,i);this.indexedValues=pT(a,o,i),Dc(Xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Ih(this.indexedValues,o);this.indexedValues=mT(i,o),Dc(Xa(r.prototype),"remove",this).call(this,o)}}]),r}(cl),SM=new Map([["hiding",Km],["index",cl],["linkedPhysicalIndexToValue",qm],["physicalIndexToValue",Li],["trimming",Dv]]);function qwe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!SM.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(SM.get(e))(t)}function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function Xwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qwe(n.key),n)}}function Zwe(e,t,r){return t&&CM(e.prototype,t),r&&CM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qwe(e){var t=Jwe(e,"string");return Mh(t)==="symbol"?t:String(t)}function Jwe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eO=0,wT=function(){function e(){Xwe(this,e),this.collection=new Map}return Zwe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),eO+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);ve(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),eO-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return mt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();gt(wT,Mr);function eSe(){return eO}function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function tSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nSe(n.key),n)}}function rSe(e,t,r){return t&&_M(e.prototype,t),r&&_M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nSe(e){var t=oSe(e,"string");return su(t)==="symbol"?t:String(t)}function oSe(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tO(e,t)}function tO(e,t){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tO(e,t)}function aSe(e){var t=uSe();return function(){var n=Lp(e),o;if(t){var i=Lp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lSe(this,o)}}function lSe(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sSe(e)}function sSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lp(e){return Lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lp(e)}var OM=function(e){iSe(r,e);var t=aSe(r);function r(n,o){var i;return tSe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return rSe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=We(this.get(),function(c){return c.getValues()}),a=[],l=ve(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return We(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ve(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(wT);function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function fSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hSe(n.key),n)}}function cSe(e,t,r){return t&&RM(e.prototype,t),r&&RM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hSe(e){var t=dSe(e,"string");return xh(t)==="symbol"?t:String(t)}function dSe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vSe(e,t,r){ySe(e,t),t.set(e,r)}function ySe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gSe(e,t,r){var n=x2(e,t,"set");return pSe(e,n,r),r}function pSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function mSe(e,t){var r=x2(e,t,"get");return bSe(e,r)}function x2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bSe(e,t){return t.get?t.get.call(e):t.value}var jw=new WeakMap,D2=function(){function e(){fSe(this,e),vSe(this,jw,{writable:!0,value:[]})}return cSe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(mSe(this,jw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){gSe(this,jw,r)}}]),e}();gt(D2,Mr);function EM(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function Dh(e){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function wSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CSe(n.key),n)}}function SSe(e,t,r){return t&&TM(e.prototype,t),r&&TM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CSe(e){var t=_Se(e,"string");return Dh(t)==="symbol"?t:String(t)}function _Se(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jf(e,t,r){OSe(e,t),t.set(e,r)}function OSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(e,t){var r=N2(e,t,"get");return RSe(e,r)}function RSe(e,t){return t.get?t.get.call(e):t.value}function yy(e,t,r){var n=N2(e,t,"set");return ESe(e,n,r),r}function N2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ESe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var gy=new WeakMap,ec=new WeakMap,py=new WeakMap,my=new WeakMap,by=new WeakMap,TSe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;wSe(this,e),Jf(this,gy,{writable:!0,value:new Set}),Jf(this,ec,{writable:!0,value:[]}),Jf(this,py,{writable:!0,value:[]}),Jf(this,my,{writable:!0,value:!1}),Jf(this,by,{writable:!0,value:!1}),yy(this,by,r??!1)}return SSe(e,[{key:"createObserver",value:function(){var r=this,n=new D2;return Kr(this,gy).add(n),n.addLocalHook("unsubscribe",function(){Kr(r,gy).delete(n)}),n._writeInitialChanges(EM(Kr(this,ec),Kr(this,py))),n}},{key:"emit",value:function(r){var n=Kr(this,py);(!Kr(this,my)||Kr(this,ec).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Kr(this,by)):yy(this,ec,new Array(r.length).fill(Kr(this,by))),Kr(this,my)||(yy(this,my,!0),n=Kr(this,ec)));var o=EM(n,r);Kr(this,gy).forEach(function(i){return i._write(o)}),yy(this,py,r)}}]),e}();function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function Fw(e){return ASe(e)||$Se(e)||kSe(e)||PSe()}function PSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kSe(e,t){if(e){if(typeof e=="string")return rO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rO(e,t)}}function $Se(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ASe(e){if(Array.isArray(e))return rO(e)}function rO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ISe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xSe(n.key),n)}}function MSe(e,t,r){return t&&PM(e.prototype,t),r&&PM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xSe(e){var t=DSe(e,"string");return Nh(t)==="symbol"?t:String(t)}function DSe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nO=function(){function e(){var t=this;ISe(this,e),this.indexesSequence=new M2,this.trimmingMapsCollection=new OM(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new OM(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new wT,this.hidingChangesObservable=new TSe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return MSe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,qwe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof Dv?this.trimmingMapsCollection.register(r,n):n instanceof Km?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ve(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ve(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ve(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ve(n)?n:null}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Fw(new Array(r).keys()),this.notHiddenIndexesCache=Fw(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=Fw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=We(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=Ih(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(pT(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ve(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=We(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();gt(nO,Mr);function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function kM(e,t){return jSe(e)||LSe(e,t)||HSe(e,t)||NSe()}function NSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HSe(e,t){if(e){if(typeof e=="string")return $M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $M(e,t)}}function $M(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jSe(e){if(Array.isArray(e))return e}function FSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VSe(n.key),n)}}function BSe(e,t,r){return t&&AM(e.prototype,t),r&&AM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VSe(e){var t=WSe(e,"string");return uu(t)==="symbol"?t:String(t)}function WSe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=USe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function USe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function zSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function YSe(e){var t=KSe();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return GSe(this,o)}}function GSe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H2(e)}function H2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}ge.getSingleton().register("modifyAutoColumnSizeSeed");var tc="autoColumnSize",qSe=10,Bw=new WeakMap,XSe="autoColumnSize",ZSe=function(e){zSe(r,e);var t=YSe(r);function r(n){var o;return FSe(this,r),o=t.call(this,n),Bw.set(H2(o),{cachedColumnHeaders:[]}),o.ghostTable=new nT(o.hot),o.samplesGenerator=new UW(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Li,o.hot.columnIndexMapper.registerMap(XSe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return BSe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[tc]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[tc];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),ha(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),ha(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;ha(yo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Ce(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);A(h,function(d){var v=kM(d,2),y=v[0],m=v[1];return o.ghostTable.addColumn(y,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){qc(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Bm(c):(qc(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[tc],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[tc],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ue(o)&&(i=o.syncLimit,AE(i)?i=FE(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,oT.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=Bw.get(this),a=i.cachedColumnHeaders,l=Ft(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){A(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=We(o,function(l){var s=kM(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){Bw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Wr(o,function(l){var s;return ve((s=l.address)===null||s===void 0?void 0:s.col)}),a=We(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),ha(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tc}},{key:"PLUGIN_PRIORITY",get:function(){return qSe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ot),da={horizontal:"horizontal",vertical:"vertical"};function QSe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function JSe(e){var t={};return e===!0?(t.directions=Object.keys(da),t.autoInsertRow=!0):Ue(e)?(ve(e.autoInsertRow)?e.direction===da.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ve(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(da)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function eCe(e){return nCe(e)||rCe(e)||L2(e)||tCe()}function tCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nCe(e){if(Array.isArray(e))return iO(e)}function oCe(e,t){return lCe(e)||aCe(e,t)||L2(e,t)||iCe()}function iCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L2(e,t){if(e){if(typeof e=="string")return iO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iO(e,t)}}function iO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lCe(e){if(Array.isArray(e))return e}function sCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fCe(n.key),n)}}function uCe(e,t,r){return t&&IM(e.prototype,t),r&&IM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fCe(e){var t=cCe(e,"string");return fu(t)==="symbol"?t:String(t)}function cCe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,r,n){var o=hCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function hCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function dCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function vCe(e){var t=gCe();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yCe(this,o)}}function yCe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j2(e)}function j2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");var MM="autofill",pCe=20,mCe=["fillHandle"],bCe="insert_row_below",wCe=200,SCe=function(e){dCe(r,e);var t=vCe(r);function r(n){var o;return sCe(this,r),o=t.call(this,n),o.eventManager=new kt(j2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return uCe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),va(go(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),va(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),va(go(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],y=[];return A(h,function(m){for(var b=m.startRow;b<=m.endRow;b+=1)d.indexOf(b)===-1&&d.push(b);for(var S=m.startCol;S<=m.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),A(d,function(m){var b=[];A(v,function(S){b.push(o.hot.getCopyableData(m,S))}),y.push(b)}),y}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=oCe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),m=QSe(v,y,function(we,$){return o.hot._createCellCoords(we,$)}),b=m.directionOfDrag,S=m.startOfDragCoords,C=m.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var k=this.getSelectionData(),O=c.clone(),B=this.hot._createCellRange(S,S,C),z=this.hot.runHooks("beforeAutofill",k,O,B,b);if(z===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var q=z,G=z;if(["up","left"].indexOf(b)>-1&&!(G.length===1&&G[0].length===0))if(q=[],b==="up")for(var X=C.row-S.row+1,Q=X%G.length,oe=0;oe<X;oe++)q.push(G[(oe+(G.length-Q))%G.length]);else for(var J=C.col-S.col+1,ue=J%G[0].length,he=0;he<G.length;he++){q.push([]);for(var Oe=0;Oe<J;Oe++)q[he].push(G[he][(Oe+(G[he].length-ue))%G[he].length])}this.hot.populateFromArray(S.row,S.col,q,C.row,C.col,"".concat(this.pluginName,".fill"),null),this.setSelection(y),this.hot.runHooks("afterAutofill",q,O,B,b),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(da.vertical)&&this.directions.includes(da.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(da.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(da.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(bCe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},wCe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,eCe(We(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Ut(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Pt(this.hot.table),l=Ut(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+ht(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=JSe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){va(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MM}},{key:"PLUGIN_PRIORITY",get:function(){return pCe}},{key:"SETTING_KEYS",get:function(){return[MM].concat(mCe)}}]),r}(ot);function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function CCe(e,t){return ECe(e)||RCe(e,t)||OCe(e,t)||_Ce()}function _Ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OCe(e,t){if(e){if(typeof e=="string")return xM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xM(e,t)}}function xM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ECe(e){if(Array.isArray(e))return e}function TCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kCe(n.key),n)}}function PCe(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kCe(e){var t=$Ce(e,"string");return cu(t)==="symbol"?t:String(t)}function $Ce(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function os(){return typeof Reflect<"u"&&Reflect.get?os=Reflect.get.bind():os=function(t,r,n){var o=ACe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},os.apply(this,arguments)}function ACe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function ICe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function MCe(e){var t=NCe();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xCe(this,o)}}function xCe(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DCe(e)}function DCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}var wy="autoRowSize",HCe=40,LCe="autoRowSize",jCe=function(e){ICe(r,e);var t=MCe(r);function r(n){var o;return TCe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new nT(o.hot),o.samplesGenerator=new UW(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Li,o.hot.rowIndexMapper.registerMap(LCe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return PCe(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[wy];return o===!0||Ue(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),os(wi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,os(wi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Ce(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);A(h,function(d){var v=CCe(d,2),y=v[0],m=v[1];return o.ghostTable.addRow(y,m)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){qc(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Bm(c):(qc(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[wy],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){ms(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[wy],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ue(o)&&(i=o.syncLimit,AE(i)?i=FE(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){Ce(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),os(wi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return wy}},{key:"PLUGIN_PRIORITY",get:function(){return HCe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ot);function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function FCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VCe(n.key),n)}}function BCe(e,t,r){return t&&NM(e.prototype,t),r&&NM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VCe(e){var t=WCe(e,"string");return hu(t)==="symbol"?t:String(t)}function WCe(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nc(){return typeof Reflect<"u"&&Reflect.get?Nc=Reflect.get.bind():Nc=function(t,r,n){var o=UCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Nc.apply(this,arguments)}function UCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Za(e),e!==null););return e}function zCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sO(e,t)}function YCe(e){var t=qCe();return function(){var n=Za(e),o;if(t){var i=Za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return GCe(this,o)}}function GCe(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KCe(e)}function KCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Za(e){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Za(e)}var F2=I2("physicallyIndexed"),XCe=F2.getListWithInsertedItems,ZCe=F2.getListWithRemovedItems,QCe=function(e){zCe(r,e);var t=YCe(r);function r(){return FCe(this,r),t.call(this,function(n){return n})}return BCe(r,[{key:"insert",value:function(o,i){var a=bT(this.indexedValues,i);this.indexedValues=XCe(a,o,i,this.initValueOrFn),Nc(Za(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=ZCe(this.indexedValues,o);this.indexedValues=mT(i,o),Nc(Za(r.prototype),"remove",this).call(this,o)}}]),r}(cl);const JCe=QCe;function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function e_e(e){return o_e(e)||n_e(e)||r_e(e)||t_e()}function t_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r_e(e,t){if(e){if(typeof e=="string")return uO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uO(e,t)}}function n_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function o_e(e){if(Array.isArray(e))return uO(e)}function uO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l_e(n.key),n)}}function a_e(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l_e(e){var t=s_e(e,"string");return du(t)==="symbol"?t:String(t)}function s_e(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hc(){return typeof Reflect<"u"&&Reflect.get?Hc=Reflect.get.bind():Hc=function(t,r,n){var o=u_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hc.apply(this,arguments)}function u_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qa(e),e!==null););return e}function f_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function c_e(e){var t=v_e();return function(){var n=Qa(e),o;if(t){var i=Qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return h_e(this,o)}}function h_e(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d_e(e)}function d_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qa(e){return Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qa(e)}var B2=I2("physicallyIndexed"),y_e=B2.getListWithInsertedItems,g_e=B2.getListWithRemovedItems,p_e=function(e){f_e(r,e);var t=c_e(r);function r(){return i_e(this,r),t.call(this,function(n){return n})}return a_e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=y_e(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),Hc(Qa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=g_e(this.indexedValues,o),Hc(Qa(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,e_e(this.getValues()))+1+o}}]),r}(cl);const m_e=p_e;function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function b_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S_e(n.key),n)}}function w_e(e,t,r){return t&&LM(e.prototype,t),r&&LM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S_e(e){var t=C_e(e,"string");return vu(t)==="symbol"?t:String(t)}function C_e(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function is(){return typeof Reflect<"u"&&Reflect.get?is=Reflect.get.bind():is=function(t,r,n){var o=__e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},is.apply(this,arguments)}function __e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Si(e),e!==null););return e}function O_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function R_e(e){var t=P_e();return function(){var n=Si(e),o;if(t){var i=Si(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return E_e(this,o)}}function E_e(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T_e(e)}function T_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Si(e)}var Vw="bindRowsWithHeaders",k_e=210,$_e="loose",A_e=new Map([["loose",JCe],["strict",m_e]]),I_e=function(e){O_e(r,e);var t=R_e(r);function r(n){var o;return b_e(this,r),o=t.call(this,n),o.headerIndexes=null,o}return w_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Vw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Vw];typeof i!="string"&&(i=$_e);var a=A_e.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),is(Si(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),is(Si(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){is(Si(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Vw}},{key:"PLUGIN_PRIORITY",get:function(){return k_e}}]),r}(ot);function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function jM(e){return N_e(e)||D_e(e)||x_e(e)||M_e()}function M_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x_e(e,t){if(e){if(typeof e=="string")return hO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hO(e,t)}}function D_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function N_e(e){if(Array.isArray(e))return hO(e)}function hO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function H_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V2(n.key),n)}}function L_e(e,t,r){return t&&FM(e.prototype,t),r&&FM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=j_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function j_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function F_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dO(e,t)}function B_e(e){var t=W_e();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return V_e(this,o)}}function V_e(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yl(e)}function Yl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function U_e(e,t,r){z_e(e,t),t.set(e,r)}function z_e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ww(e,t,r){return t=V2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V2(e){var t=Y_e(e,"string");return yu(t)==="symbol"?t:String(t)}function Y_e(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BM(e,t){var r=W2(e,t,"get");return G_e(e,r)}function G_e(e,t){return t.get?t.get.call(e):t.value}function Uw(e,t,r){var n=W2(e,t,"set");return K_e(e,n,r),r}function W2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function K_e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var zw="collapsibleColumns",q_e=290,X_e=["nestedHeaders"],Cl="collapsibleIndicator",VM=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),_l=new WeakMap,Z_e=function(e){F_e(r,e);var t=B_e(r);function r(){var n;H_e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Ww(Yl(n),"nestedHeadersPlugin",null),Ww(Yl(n),"eventManager",new kt(Yl(n))),Ww(Yl(n),"headerStateManager",null),U_e(Yl(n),_l,{writable:!0,value:null}),n}return L_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||wt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Uw(this,_l,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),ya(po(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}ya(po(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Uw(this,_l,null),this.nestedHeadersPlugin=null,this.clearButtons(),ya(po(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};Ce(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;Ce(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(Cl));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(Cl)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(Cl)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!VM.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Wr(o,function(m){var b=m.row;return b<0}),s=l.length>0;A(l,function(m){var b,S=m.row,C=m.col,k=(b=a.headerStateManager.getHeaderSettings(S,C))!==null&&b!==void 0?b:{},O=k.collapsible,B=k.isCollapsed;if(!O||B&&i==="collapse"||!B&&i==="expand")return s=!1,!1});var u=[],f=[];s&&A(l,function(m){var b=m.row,S=m.col,C=a.headerStateManager.triggerNodeModification(i,b,S),k=C.colspanCompensation,O=C.affectedColumns,B=C.rollbackModification;k>0&&(f.push.apply(f,jM(O)),u.push(B))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=CE([].concat(jM(c),f)):i==="expand"&&(h=Wr(c,function(m){return!f.includes(m)}));var d=VM.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){A(u,function(m){m()});return}this.hot.batchExecution(function(){A(f,function(m){BM(a,_l).setValueAtIndex(a.hot.toPhysicalColumn(m),d.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return BM(this,_l).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(Cl));if(h)d||(d=this.hot.rootDocument.createElement("div"),te(d,Cl),i.querySelector("div:first-child").appendChild(d)),Le(d,["collapsed","expanded"]),c?(te(d,"collapsed"),Ai(d,"+")):(te(d,"expanded"),Ai(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,Cl)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),wn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Uw(this,_l,null),ya(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zw}},{key:"PLUGIN_PRIORITY",get:function(){return q_e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[zw].concat(X_e)}}]),r}(ot),Q_e=$e,J_e=Gt,eOe=jj,tOe=zr,rOe=zn,nOe=Ef;Q_e({target:"Object",stat:!0,sham:!J_e},{getOwnPropertyDescriptors:function(t){for(var r=tOe(t),n=rOe.f,o=eOe(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&nOe(i,l,s);return i}});var WM=Gt,oOe=Ye,iOe=Zt,aOe=je,Yw=rv,lOe=sv,sOe=av,uOe=Ir,fOe=Zd,Ol=Object.assign,UM=Object.defineProperty,cOe=oOe([].concat),hOe=!Ol||aOe(function(){if(WM&&Ol({b:1},Ol(UM({},"a",{enumerable:!0,get:function(){UM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),Ol({},e)[r]!=7||Yw(Ol({},t)).join("")!=n})?function(t,r){for(var n=uOe(t),o=arguments.length,i=1,a=lOe.f,l=sOe.f;o>i;)for(var s=fOe(arguments[i++]),u=a?cOe(Yw(s),a(s)):Yw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!WM||iOe(l,s,h))&&(n[h]=s[h]);return n}:Ol,dOe=$e,zM=hOe;dOe({target:"Object",stat:!0,arity:2,forced:Object.assign!==zM},{assign:zM});function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function YM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function vOe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YM(Object(r),!0).forEach(function(n){yOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yOe(e,t,r){return t=U2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GM(e,t){return bOe(e)||mOe(e,t)||pOe(e,t)||gOe()}function gOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pOe(e,t){if(e){if(typeof e=="string")return KM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KM(e,t)}}function KM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bOe(e){if(Array.isArray(e))return e}function wOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U2(n.key),n)}}function SOe(e,t,r){return t&&qM(e.prototype,t),r&&qM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U2(e){var t=COe(e,"string");return Hh(t)==="symbol"?t:String(t)}function COe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _Oe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],OOe=!1,ROe=!0,EOe=!0,TOe=function(){function e(t,r){wOe(this,e),this.hot=t,this.sortingStates=new qm,this.sortEmptyCells=OOe,this.indicator=ROe,this.headerAction=EOe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return SOe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ue(r)&&ze(r,function(o,i){_Oe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=GM(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ue(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=GM(o,2),a=i[0],l=i[1];return vOe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ve(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),jp="asc",Fp="desc",POe="colHeader";function kOe(e){if(Ue(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[jp,Fp].includes(r)}function $Oe(e){if(e.some(function(r){return kOe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function XM(e){if(e!==Fp)return e===jp?Fp:jp}function ZM(e){var t=e.querySelector(".".concat(POe));return t}function QM(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function vO(e,t,r){return e===-1&&t>=0&&$i(r)===!1}var AOe="ascending",IOe="descending",z2="indicatorDisabled",Y2="columnSorting",G2="sortAction",K2=new Map([[jp,AOe],[Fp,IOe]]);function MOe(e,t,r,n){var o=[Y2];if(n&&o.push(G2),r===!1)return o.push(z2),o;var i=e.getSortOrderOfColumn(t);return ve(i)&&o.push(K2.get(i)),o}function xOe(){return Array.from(K2.values()).concat(G2,z2,Y2)}function q2(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Vn:Xt(o)?Xt(i)?Vn:a&&e==="asc"?It:Mt:Xt(i)?a&&e==="asc"?Mt:It:isNaN(o)&&!isNaN(i)?e==="asc"?Mt:It:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?It:Mt:o>i?e==="asc"?Mt:It:Vn}}var X2="default";function DOe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Vn;if(l){if(Xt(n))return e==="asc"?It:Mt;if(Xt(o))return e==="asc"?Mt:It}return isNaN(i)?Mt:isNaN(a)?It:i<a?e==="asc"?It:Mt:i>a?e==="asc"?Mt:It:Vn}}var NOe="numeric";function HOe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=Xt(a),u=Xt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return Mt;if(s===!1&&u)return It}return h===!1&&d?e==="asc"?It:Mt:h&&d===!1?e==="asc"?Mt:It:h===!1&&d===!1?q2(e,t,r)(a,l):f===o&&c===n?e==="asc"?It:Mt:f===n&&c===o?e==="asc"?Mt:It:Vn}}var LOe="checkbox";function jOe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Vn;if(Xt(n))return Xt(o)?Vn:i&&e==="asc"?It:Mt;if(Xt(o))return i&&e==="asc"?Mt:It;var a=t.dateFormat,l=ee(n,a),s=ee(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?It:Mt:s.isBefore(l)?e==="asc"?Mt:It:Vn:It:Mt}}var FOe="date",ST=on("sorting.compareFunctionFactory"),Xm=ST.register,JM=ST.getItem,BOe=ST.hasItem,Z2=on("sorting.mainSortComparator"),Q2=Z2.register,VOe=Z2.getItem;function J2(e){return BOe(e)?JM(e):JM(X2)}Xm(NOe,DOe);Xm(LOe,HOe);Xm(FOe,jOe);Xm(X2,q2);var Vn=0,It=-1,Mt=1;function WOe(e,t){for(var r=VOe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function ex(e){return GOe(e)||YOe(e)||zOe(e)||UOe()}function UOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zOe(e,t){if(e){if(typeof e=="string")return tx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tx(e,t)}}function tx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GOe(e){if(Array.isArray(e))return e}function KOe(e,t){return function(r,n){var o=ex(r),i=o.slice(1),a=ex(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:J2(c.type),m=y(f,c,v)(h,d);return m}(0)}}function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}var qOe=["column"],XOe=["column"];function Rl(e){return eRe(e)||JOe(e)||QOe(e)||ZOe()}function ZOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QOe(e,t){if(e){if(typeof e=="string")return yO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yO(e,t)}}function JOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eRe(e){if(Array.isArray(e))return yO(e)}function yO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rx(Object(r),!0).forEach(function(n){tRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tRe(e,t,r){return t=eU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ox(e,t){if(e==null)return{};var r=rRe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rRe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function nRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eU(n.key),n)}}function oRe(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eU(e){var t=iRe(e,"string");return gu(t)==="symbol"?t:String(t)}function iRe(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=aRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function aRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function lRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gO(e,t)}function gO(e,t){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gO(e,t)}function sRe(e){var t=cRe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uRe(this,o)}}function uRe(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fRe(e)}function fRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}var pO="columnSorting",hRe=50,ax="append",dRe="replace";Q2(pO,KOe);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var tU=function(e){lRe(r,e);var t=sRe(r);function r(n){var o;return nRe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=pO,o.indexesSequenceCache=null,o}return oRe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new TOe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Li(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),ga(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=ZM(s);QM(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,ga(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new M2),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ve(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return $Oe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=ox(u,qOe);return nx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=We(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=ox(u,XOe);return nx({column:o.hot.toVisualColumn(f)},c)};return ve(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=We(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ve(i)){var a=XM(i);return ve(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:XM()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ax,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(mt(u))return[].concat(Rl(s.slice(0,a)),Rl(s.slice(a+1)));if(i===ax)return[].concat(Rl(s.slice(0,a)),Rl(s.slice(a+1)),[u]);if(i===dRe)return[].concat(Rl(s.slice(0,a)),[u],Rl(s.slice(a+1)))}return ve(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ue(o)){var i=o[this.pluginKey];if(Ue(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):pt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(m){return We(o,function(b){return i.hot.getDataAtCell(m,b.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=We(a,function(y){return y[0]});WOe(a,this.pluginKey,We(o,function(y){return y.sortOrder}),We(o,function(y){return i.getFirstCellSettings(y.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=We(a,function(y){return y[0]}),d=new Map(We(f,function(y,m){return[y,h[m]]})),v=We(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return d.has(y)?d.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ue(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ue(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ue(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=ZM(i);if(!(QM(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(Le(o,xOe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];te(o,MOe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){ga(mo(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ve(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){vO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){vO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),ga(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pO}},{key:"PLUGIN_PRIORITY",get:function(){return hRe}}]),r}(ot),vRe=$e,CT=Ye,yRe=Ni,gRe=oB,pRe=Z0,lx=je,mRe=RangeError,rU=String,nU=Math.floor,mO=CT(pRe),sx=CT("".slice),rc=CT(1 .toFixed),Zl=function(e,t,r){return t===0?r:t%2===1?Zl(e,t-1,r*e):Zl(e*e,t/2,r)},bRe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},El=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=nU(o/1e7)},Gw=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=nU(n/t),n=n%t*1e7},ux=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=rU(e[t]);r=r===""?n:r+mO("0",7-n.length)+n}return r},wRe=lx(function(){return rc(8e-5,3)!=="0.000"||rc(.9,0)!=="1"||rc(1.255,2)!=="1.25"||rc(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!lx(function(){rc({})});vRe({target:"Number",proto:!0,forced:wRe},{toFixed:function(t){var r=gRe(this),n=yRe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw mRe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return rU(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=bRe(r*Zl(2,69,1))-69,s=l<0?r*Zl(2,-l,1):r/Zl(2,l,1),s*=4503599627370496,l=52-l,l>0){for(El(o,0,s),u=n;u>=7;)El(o,1e7,0),u-=7;for(El(o,Zl(10,u,1),0),u=l-1;u>=23;)Gw(o,1<<23),u-=23;Gw(o,1<<u),El(o,1,1),Gw(o,2),a=ux(o)}else El(o,0,s),El(o,1<<-l,0),a=ux(o)+mO("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+mO("0",n-f)+a:sx(a,0,f-n)+"."+sx(a,f-n))):a=i+a,a}});function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function SRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Re(n.key),n)}}function CRe(e,t,r){return t&&fx(e.prototype,t),r&&fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Re(e){var t=ORe(e,"string");return Lh(t)==="symbol"?t:String(t)}function ORe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RRe=function(){function e(t,r){SRe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return CRe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),A(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();A(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function y(){return l.hot.removeHook("beforeViewRender",y),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;A(h,function(y){f==="row"&&y.destinationRow>=v&&(y.alterRowOffset=c*o),f==="col"&&y.destinationColumn>=v&&(y.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?A(h,function(y){l.extendEndpointRanges(y,v,i[0],i.length),l.recreatePhysicalRanges(y),l.clearOffsetInformation(y)}):A(h,function(y){l.shiftEndpointCoordinates(y,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){A(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];A(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),A(a,function(l){var s=[];A(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,A(r.ranges,function(o){A(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],A(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],A(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],A(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&A(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),A(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){wt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const ERe=RRe;function Kw(e){return e==null||isNaN(e)}function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}var cx;function TRe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function PRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Re(n.key),n)}}function kRe(e,t,r){return t&&hx(e.prototype,t),r&&hx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Re(e){var t=ARe(e,"string");return pu(t)==="symbol"?t:String(t)}function ARe(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Og(){return typeof Reflect<"u"&&Reflect.get?Og=Reflect.get.bind():Og=function(t,r,n){var o=IRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Og.apply(this,arguments)}function IRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mu(e),e!==null););return e}function MRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bO(e,t)}function bO(e,t){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bO(e,t)}function xRe(e){var t=HRe();return function(){var n=mu(e),o;if(t){var i=mu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DRe(this,o)}}function DRe(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NRe(e)}function NRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mu(e)}var qw="columnSummary",LRe=220,jRe=function(e){MRe(r,e);var t=xRe(r);function r(n){var o;return PRe(this,r),o=t.call(this,n),o.endpoints=null,o}return kRe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[qw],this.endpoints=new ERe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),Og(mu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return ze(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Kw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return ze(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Kw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Kw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return ze(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(dt(cx||(cx=TRe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return qw}},{key:"PLUGIN_PRIORITY",get:function(){return LRe}}]),r}(ot);function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function FRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VRe(n.key),n)}}function BRe(e,t,r){return t&&dx(e.prototype,t),r&&dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VRe(e){var t=WRe(e,"string");return jh(t)==="symbol"?t:String(t)}function WRe(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var URe=function(){function e(t,r){FRe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return BRe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ht(this.getInputElement()),height:Pt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(r,e.CLASS_EDITOR),te(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const zRe=URe;var qe="---------";function YRe(){return{name:qe}}function GRe(e){return We(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function Sy(e){return xe(e,"htSeparator")}function KRe(e){return xe(e,"htSubmenu")}function Cy(e){return xe(e,"htDisabled")}function _y(e){return xe(e,"htSelectionDisabled")}function hl(e){var t=e.getSelected();return!t||t[0]<0?null:t}function qRe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function XRe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Ki(e,t){var r={};return A(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function si(e,t,r,n,o){A(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&ZRe(a,l,t,r,n,o)})})}function ZRe(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=qRe(a.className,n):l=XRe(a.className,n)),i(e,t,"className",l)}function jn(e,t){var r=!1;return Array.isArray(e)&&A(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function lo(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function QRe(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function oU(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function JRe(e,t){var r=e.slice(0);return r.reverse(),r=oU(r,t),r.reverse(),r}function e0e(e){var t=[];return A(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function t0e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,r=e.slice(0);return r=oU(r,t),r=JRe(r,t),r=e0e(r),r}function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function r0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o0e(n.key),n)}}function n0e(e,t,r){return t&&vx(e.prototype,t),r&&vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o0e(e){var t=i0e(e,"string");return Fh(t)==="symbol"?t:String(t)}function i0e(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a0e=250,l0e=250,iU=function(){function e(t){r0e(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return n0e(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},l0e)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a0e;this.showDebounced=LE(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();gt(iU,Mr);const s0e=iU;var aU="ContextMenu:items",Fe=aU,_T="".concat(Fe,".noItems"),OT="".concat(Fe,".insertRowAbove"),RT="".concat(Fe,".insertRowBelow"),ET="".concat(Fe,".insertColumnOnTheLeft"),TT="".concat(Fe,".insertColumnOnTheRight"),PT="".concat(Fe,".removeRow"),kT="".concat(Fe,".removeColumn"),$T="".concat(Fe,".undo"),AT="".concat(Fe,".redo"),IT="".concat(Fe,".readOnly"),MT="".concat(Fe,".clearColumn"),xT="".concat(Fe,".copy"),DT="".concat(Fe,".copyWithHeaders"),NT="".concat(Fe,".copyWithGroupHeaders"),HT="".concat(Fe,".copyHeadersOnly"),LT="".concat(Fe,".cut"),jT="".concat(Fe,".freezeColumn"),FT="".concat(Fe,".unfreezeColumn"),BT="".concat(Fe,".mergeCells"),VT="".concat(Fe,".unmergeCells"),WT="".concat(Fe,".addComment"),UT="".concat(Fe,".editComment"),zT="".concat(Fe,".removeComment"),YT="".concat(Fe,".readOnlyComment"),GT="".concat(Fe,".align"),KT="".concat(Fe,".align.left"),qT="".concat(Fe,".align.center"),XT="".concat(Fe,".align.right"),ZT="".concat(Fe,".align.justify"),QT="".concat(Fe,".align.top"),JT="".concat(Fe,".align.middle"),eP="".concat(Fe,".align.bottom"),tP="".concat(Fe,".borders"),rP="".concat(Fe,".borders.top"),nP="".concat(Fe,".borders.right"),oP="".concat(Fe,".borders.bottom"),iP="".concat(Fe,".borders.left"),aP="".concat(Fe,".borders.remove"),lP="".concat(Fe,".nestedHeaders.insertChildRow"),sP="".concat(Fe,".nestedHeaders.detachFromParent"),uP="".concat(Fe,".hideColumn"),fP="".concat(Fe,".showColumn"),cP="".concat(Fe,".hideRow"),hP="".concat(Fe,".showRow"),Or="Filters:",Ht="".concat(Or,"conditions"),Zm="".concat(Ht,".none"),dP="".concat(Ht,".isEmpty"),vP="".concat(Ht,".isNotEmpty"),yP="".concat(Ht,".isEqualTo"),gP="".concat(Ht,".isNotEqualTo"),pP="".concat(Ht,".beginsWith"),mP="".concat(Ht,".endsWith"),bP="".concat(Ht,".contains"),wP="".concat(Ht,".doesNotContain"),u0e="".concat(Ht,".byValue"),SP="".concat(Ht,".greaterThan"),CP="".concat(Ht,".greaterThanOrEqualTo"),_P="".concat(Ht,".lessThan"),OP="".concat(Ht,".lessThanOrEqualTo"),RP="".concat(Ht,".isBetween"),EP="".concat(Ht,".isNotBetween"),TP="".concat(Ht,".after"),PP="".concat(Ht,".before"),kP="".concat(Ht,".today"),$P="".concat(Ht,".tomorrow"),AP="".concat(Ht,".yesterday"),IP="".concat(Or,"labels.filterByCondition"),MP="".concat(Or,"labels.filterByValue"),xP="".concat(Or,"labels.conjunction"),Qm="".concat(Or,"labels.disjunction"),Bp="".concat(Or,"values.blankCells"),DP="".concat(Or,"buttons.selectAll"),NP="".concat(Or,"buttons.clear"),HP="".concat(Or,"buttons.ok"),LP="".concat(Or,"buttons.cancel"),jP="".concat(Or,"buttons.placeholder.search"),FP="".concat(Or,"buttons.placeholder.value"),BP="".concat(Or,"buttons.placeholder.secondValue");const f0e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:WT,CONTEXTMENU_ITEMS_ALIGNMENT:GT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:eP,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:qT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ZT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:KT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:JT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:XT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:QT,CONTEXTMENU_ITEMS_BORDERS:tP,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:oP,CONTEXTMENU_ITEMS_BORDERS_LEFT:iP,CONTEXTMENU_ITEMS_BORDERS_RIGHT:nP,CONTEXTMENU_ITEMS_BORDERS_TOP:rP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:MT,CONTEXTMENU_ITEMS_COPY:xT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:HT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:NT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:DT,CONTEXTMENU_ITEMS_CUT:LT,CONTEXTMENU_ITEMS_EDIT_COMMENT:UT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:jT,CONTEXTMENU_ITEMS_HIDE_COLUMN:uP,CONTEXTMENU_ITEMS_HIDE_ROW:cP,CONTEXTMENU_ITEMS_INSERT_LEFT:ET,CONTEXTMENU_ITEMS_INSERT_RIGHT:TT,CONTEXTMENU_ITEMS_MERGE_CELLS:BT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:sP,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:lP,CONTEXTMENU_ITEMS_NO_ITEMS:_T,CONTEXTMENU_ITEMS_READ_ONLY:IT,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:YT,CONTEXTMENU_ITEMS_REDO:AT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:aP,CONTEXTMENU_ITEMS_REMOVE_COLUMN:kT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:zT,CONTEXTMENU_ITEMS_REMOVE_ROW:PT,CONTEXTMENU_ITEMS_ROW_ABOVE:OT,CONTEXTMENU_ITEMS_ROW_BELOW:RT,CONTEXTMENU_ITEMS_SHOW_COLUMN:fP,CONTEXTMENU_ITEMS_SHOW_ROW:hP,CONTEXTMENU_ITEMS_UNDO:$T,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:FT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:VT,CONTEXT_MENU_ITEMS_NAMESPACE:aU,FILTERS_BUTTONS_CANCEL:LP,FILTERS_BUTTONS_CLEAR:NP,FILTERS_BUTTONS_OK:HP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:jP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:BP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:FP,FILTERS_BUTTONS_SELECT_ALL:DP,FILTERS_CONDITIONS_AFTER:TP,FILTERS_CONDITIONS_BEFORE:PP,FILTERS_CONDITIONS_BEGINS_WITH:pP,FILTERS_CONDITIONS_BETWEEN:RP,FILTERS_CONDITIONS_BY_VALUE:u0e,FILTERS_CONDITIONS_CONTAINS:bP,FILTERS_CONDITIONS_EMPTY:dP,FILTERS_CONDITIONS_ENDS_WITH:mP,FILTERS_CONDITIONS_EQUAL:yP,FILTERS_CONDITIONS_GREATER_THAN:SP,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:CP,FILTERS_CONDITIONS_LESS_THAN:_P,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:OP,FILTERS_CONDITIONS_NAMESPACE:Ht,FILTERS_CONDITIONS_NONE:Zm,FILTERS_CONDITIONS_NOT_BETWEEN:EP,FILTERS_CONDITIONS_NOT_CONTAIN:wP,FILTERS_CONDITIONS_NOT_EMPTY:vP,FILTERS_CONDITIONS_NOT_EQUAL:gP,FILTERS_CONDITIONS_TODAY:kP,FILTERS_CONDITIONS_TOMORROW:$P,FILTERS_CONDITIONS_YESTERDAY:AP,FILTERS_DIVS_FILTER_BY_CONDITION:IP,FILTERS_DIVS_FILTER_BY_VALUE:MP,FILTERS_LABELS_CONJUNCTION:xP,FILTERS_LABELS_DISJUNCTION:Qm,FILTERS_NAMESPACE:Or,FILTERS_VALUES_BLANK_CELLS:Bp},Symbol.toStringTag,{value:"Module"}));function bu(e){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function Xw(e,t,r){return t=lU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lU(n.key),n)}}function h0e(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lU(e){var t=d0e(e,"string");return bu(t)==="symbol"?t:String(t)}function d0e(e,t){if(bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=v0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function v0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function y0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wO(e,t)}function wO(e,t){return wO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wO(e,t)}function g0e(e){var t=m0e();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return p0e(this,o)}}function p0e(e,t){if(t&&(bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sU(e)}function sU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var Zw="comments",b0e=60,Oy=new WeakMap,kn="comment",Tl="value",gx="style",Ry="readOnly",w0e=function(e){y0e(r,e);var t=g0e(r);function r(n){var o;return c0e(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,Oy.set(sU(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return h0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new zRe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new kt(this)),this.displaySwitch||(this.displaySwitch=new s0e(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),pa(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pa(bo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){pa(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=pi(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&pi(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,Xw({},Tl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,kn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,Tl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,Tl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[kn]?l[kn][Tl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),y=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var m=d===null,b=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,k=S.view._wt,O=k.wtTable,B=k.getCell({row:d,col:v},!0),z=this.getCommentMeta(c,h,gx);z?this.editor.setSize(z.width,z.height):this.editor.resetSize();var q=b?0:O.getStretchedColumnWidth(v),G=y&&!m?Pt(B):0,X=B.getBoundingClientRect(),Q=X.left,oe=X.top,J=X.width,ue=X.height,he=this.editor.getSize(),Oe=he.width,we=he.height,$=this.hot.rootWindow,P=$.innerWidth,g=$.innerHeight,p=this.hot.rootDocument.documentElement,w=Q+C.scrollX+q,E=oe+C.scrollY+G;this.hot.isRtl()&&(w-=Oe+q),this.hot.isLtr()&&Q+J+Oe>P?w=Q+C.scrollX-Oe-1:this.hot.isRtl()&&w<-(p.scrollWidth-p.clientWidth)&&(w=Q+C.scrollX+q+1),oe+we>g&&(E-=we-ue+1),this.editor.setPosition(w,E),this.editor.setReadOnlyState(this.getCommentMeta(c,h,Ry))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Tl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[kn],s;l?(s=fr(l),Ov(s,a)):s=a,this.hot.setCellMeta(o,i,kn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[kn])return l[kn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=pi(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=Oy.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else mi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[kn]&&i[kn][Tl]&&te(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=Oy.get(this);i.tempEditorDimensions={width:ht(o.target),height:Pt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=Oy.get(this),a=ht(o.target),l=Pt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Xw({},gx,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,Ry);o.updateCommentMeta(a,l,Xw({},Ry,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(UT):i.hot.getTranslatedPhrase(WT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(zT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(YT),f=jn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[kn];if(d&&(d=d[Ry]),d)return!0});return f&&(u=lo(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[Zw];if(Ue(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),pa(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zw}},{key:"PLUGIN_PRIORITY",get:function(){return b0e}}]),r}(ot);function Bh(e){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}function S0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function px(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_0e(n.key),n)}}function C0e(e,t,r){return t&&px(e.prototype,t),r&&px(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _0e(e){var t=O0e(e,"string");return Bh(t)==="symbol"?t:String(t)}function O0e(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R0e=function(){function e(t){S0e(this,e),this.hot=t,this.commands={},this.commonCallback=null}return C0e(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=E0e(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!xt(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),A(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function E0e(e,t){var r;return A(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const uU=R0e;var Xr="alignment";function T0e(){return{key:Xr,name:function(){return this.getTranslatedPhrase(GT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Xr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(KT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(qT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(XT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(ZT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:qe},{key:"".concat(Xr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(QT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(JT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(eP),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var Jm="clear_column";function P0e(){return{key:Jm,name:function(){return this.getTranslatedPhrase(MT)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=hl(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var Nv="col_left";function k0e(){return{key:Nv,name:function(){return this.getTranslatedPhrase(ET)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=hl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Hv="col_right";function $0e(){return{key:Hv,name:function(){return this.getTranslatedPhrase(TT)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=hl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Lv="make_read_only";function A0e(){return{key:Lv,name:function(){var t=this,r=this.getTranslatedPhrase(IT),n=jn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jn(r,function(o,i){return t.getCellMeta(o,i).readOnly});A(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var eb="redo";function I0e(){return{key:eb,name:function(){return this.getTranslatedPhrase(AT)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function fU(e,t){return N0e(e)||D0e(e,t)||x0e(e,t)||M0e()}function M0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x0e(e,t){if(e){if(typeof e=="string")return mx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mx(e,t)}}function mx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function N0e(e){if(Array.isArray(e))return e}function SO(e){"@babel/helpers - typeof";return SO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SO(e)}var tb=0,rb=1,cU=2,VP=3,H0e=[VP,cU],L0e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Qw=Symbol("root"),bx=Symbol("child");function wu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qw;if(t!==Qw&&t!==bx)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Qw,o=tb;if(r){var i=e[0];if(e.length===0)o=rb;else if(n&&i instanceof iT)o=VP;else if(n&&Array.isArray(i))o=wu(i,bx);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!L0e[s].includes(SO(l))});a&&(o=cU)}}return o}function Vh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!H0e.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===VP,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),mt(u)&&(u=l),mt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function j0e(e){var t=wu(e);if(t===tb||t===rb)return[];var r=Vh(t),n=new Set;A(e,function(a){var l=r(a),s=fU(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function F0e(e){var t=wu(e);if(t===tb||t===rb)return[];var r=Vh(t),n=new Set;A(e,function(a){var l=r(a),s=fU(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Zo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function B0e(e,t){return z0e(e)||U0e(e,t)||W0e(e,t)||V0e()}function V0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W0e(e,t){if(e){if(typeof e=="string")return wx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wx(e,t)}}function wx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function z0e(e){if(Array.isArray(e))return e}var jv="remove_col";function Y0e(){return{key:jv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=B0e(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(kT,r)},callback:function(){this.alter("remove_col",j0e(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=hl(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function G0e(e,t){return Z0e(e)||X0e(e,t)||q0e(e,t)||K0e()}function K0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q0e(e,t){if(e){if(typeof e=="string")return Sx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sx(e,t)}}function Sx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function X0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Z0e(e){if(Array.isArray(e))return e}var nb="remove_row";function Q0e(){return{key:nb,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=G0e(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(PT,r)},callback:function(){this.alter("remove_row",F0e(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=hl(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var ob="row_above";function J0e(){return{key:ob,name:function(){return this.getTranslatedPhrase(OT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=hl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var ib="row_below";function eEe(){return{key:ib,name:function(){return this.getTranslatedPhrase(RT)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=hl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Wh="no_items";function tEe(){return{key:Wh,name:function(){return this.getTranslatedPhrase(_T)},disabled:!0,isCommand:!1}}var ab="undo";function rEe(){return{key:ab,name:function(){return this.getTranslatedPhrase($T)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}var yr;function xr(e,t,r){return t=nEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nEe(e){var t=oEe(e,"string");return Uh(t)==="symbol"?t:String(t)}function oEe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iEe=[ob,ib,Nv,Hv,Jm,nb,jv,ab,eb,Lv,Xr,qe,Wh],aEe=(yr={},xr(yr,qe,YRe),xr(yr,Wh,tEe),xr(yr,ob,J0e),xr(yr,ib,eEe),xr(yr,Nv,k0e),xr(yr,Hv,$0e),xr(yr,Jm,P0e),xr(yr,nb,Q0e),xr(yr,jv,Y0e),xr(yr,ab,rEe),xr(yr,eb,I0e),xr(yr,Lv,A0e),xr(yr,Xr,T0e),yr);function hU(){var e={};return ze(aEe,function(t,r){e[r]=t()}),e}function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function lEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uEe(n.key),n)}}function sEe(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uEe(e){var t=fEe(e,"string");return zh(t)==="symbol"?t:String(t)}function fEe(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cEe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;lEe(this,e),this.hot=t,this.predefinedItems=hU(),this.defaultOrderPattern=r}return sEe(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,ze(r,function(i,a){var l="";i.name===qe?(o[qe]=i,l=qe):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return hEe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function hEe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ue(o)?ze(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ue(i)?zt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):A(o,function(i,a){var l=r[i];!l&&iEe.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ue(i)&&zt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const dU=cEe;function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function dEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yEe(n.key),n)}}function vEe(e,t,r){return t&&_x(e.prototype,t),r&&_x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yEe(e){var t=gEe(e,"string");return Yh(t)==="symbol"?t:String(t)}function gEe(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pEe=function(){function e(t,r){dEe(this,e);var n=bs(r),o=Va(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return vEe(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const mEe=pEe;var bEe=el,wEe=/(?:ipad|iphone|ipod).*applewebkit/i.test(bEe),SEe=Un,vU=typeof process<"u"&&SEe(process)=="process",Vr=vt,CEe=ll,_Ee=dv,Ox=Rt,OEe=Nt,yU=je,Rx=Tj,REe=mv,Ex=im,EEe=fW,TEe=wEe,PEe=vU,CO=Vr.setImmediate,_O=Vr.clearImmediate,kEe=Vr.process,Jw=Vr.Dispatch,$Ee=Vr.Function,Tx=Vr.MessageChannel,AEe=Vr.String,eS=0,Lc={},Px="onreadystatechange",Gh,qi,tS,rS;yU(function(){Gh=Vr.location});var WP=function(e){if(OEe(Lc,e)){var t=Lc[e];delete Lc[e],t()}},nS=function(e){return function(){WP(e)}},kx=function(e){WP(e.data)},$x=function(e){Vr.postMessage(AEe(e),Gh.protocol+"//"+Gh.host)};(!CO||!_O)&&(CO=function(t){EEe(arguments.length,1);var r=Ox(t)?t:$Ee(t),n=REe(arguments,1);return Lc[++eS]=function(){CEe(r,void 0,n)},qi(eS),eS},_O=function(t){delete Lc[t]},PEe?qi=function(e){kEe.nextTick(nS(e))}:Jw&&Jw.now?qi=function(e){Jw.now(nS(e))}:Tx&&!TEe?(tS=new Tx,rS=tS.port2,tS.port1.onmessage=kx,qi=_Ee(rS.postMessage,rS)):Vr.addEventListener&&Ox(Vr.postMessage)&&!Vr.importScripts&&Gh&&Gh.protocol!=="file:"&&!yU($x)?(qi=$x,Vr.addEventListener("message",kx,!1)):Px in Ex("script")?qi=function(e){Rx.appendChild(Ex("script"))[Px]=function(){Rx.removeChild(this),WP(e)}}:qi=function(e){setTimeout(nS(e),0)});var gU={set:CO,clear:_O},IEe=$e,MEe=vt,Ax=gU.clear;IEe({global:!0,bind:!0,enumerable:!0,forced:MEe.clearImmediate!==Ax},{clearImmediate:Ax});var xEe=$e,pU=vt,Ix=gU.set,DEe=HE,Mx=pU.setImmediate?DEe(Ix,!1):Ix;xEe({global:!0,bind:!0,enumerable:!0,forced:pU.setImmediate!==Mx},{setImmediate:Mx});var NEe=$e,HEe=Z0;NEe({target:"String",proto:!0},{repeat:HEe});var LEe=Zt,jEe=gm,FEe=jt,BEe=_n,VEe=nl,oS=Kt,WEe=Ar,UEe=rl,zEe=L0,xx=pm;jEe("match",function(e,t,r){return[function(o){var i=WEe(this),a=BEe(o)?void 0:UEe(o,e);return a?LEe(a,o,i):new RegExp(o)[e](oS(i))},function(n){var o=FEe(this),i=oS(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return xx(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=xx(o,i))!==null;){var c=oS(f[0]);s[u]=c,c===""&&(o.lastIndex=zEe(i,VEe(o.lastIndex),l)),u++}return u===0?null:s}]});var YEe=ll,GEe=zr,KEe=Ni,qEe=en,XEe=Pf,ZEe=Math.min,OO=[].lastIndexOf,mU=!!OO&&1/[1].lastIndexOf(1,-0)<0,QEe=XEe("lastIndexOf"),JEe=mU||!QEe,eTe=JEe?function(t){if(mU)return YEe(OO,this,arguments)||0;var r=GEe(this),n=qEe(r),o=n-1;for(arguments.length>1&&(o=ZEe(o,KEe(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:OO,tTe=$e,Dx=eTe;tTe({target:"Array",proto:!0,forced:Dx!==[].lastIndexOf},{lastIndexOf:Dx});var rTe=tl,nTe=Ir,oTe=Zd,iTe=en,aTe=TypeError,Nx=function(e){return function(t,r,n,o){rTe(r);var i=nTe(t),a=oTe(i),l=iTe(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw aTe("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},lTe={left:Nx(!1),right:Nx(!0)},sTe=$e,uTe=lTe.left,fTe=Pf,Hx=Qd,cTe=vU,hTe=!cTe&&Hx>79&&Hx<83,dTe=hTe||!fTe("reduce");sTe({target:"Array",proto:!0,forced:dTe},{reduce:function(t){var r=arguments.length;return uTe(this,t,r,r>1?arguments[1]:void 0)}});function iS(e){return pTe(e)||gTe(e)||yTe(e)||vTe()}function vTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yTe(e,t){if(e){if(typeof e=="string")return RO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RO(e,t)}}function gTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pTe(e){if(Array.isArray(e))return RO(e)}function RO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},mTe=new RegExp(Object.keys(bU).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function bTe(e){return(e&&e.nodeName||"")==="TABLE"}function EO(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],y=0;y<a;y+=1){var m=!d&&r&&y===0,b="";if(d)b="<th>".concat(e.getColHeader(y-f),"</th>");else if(m)b="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][y],C=e.getCellMeta(h-c,y-f),k=C.hidden,O=C.rowspan,B=C.colspan;if(!k){var z=[];if(O&&z.push('rowspan="'.concat(O,'"')),B&&z.push('colspan="'.concat(B,'"')),Xt(S))b="<td ".concat(z.join(" "),"></td>");else{var q=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b="<td ".concat(z.join(" "),">").concat(q,"</td>")}}}v.push(b)}var G=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,G):u.splice(-1,0,G)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function TO(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Xt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function wU(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(w){var E=w.match(/<td\b[^>]*?>/g)[0],R=w.substring(E.length,w.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),F="</td>";return"".concat(E).concat(R).concat(F)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!bTe(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(w,E){return w+E.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,y=0;if(i.tHead){var m=Array.from(i.tHead.rows).filter(function(w){var E=w.querySelector("td")!==null;return E&&h.push(w),!E});v=m.length,d=v>0,v>1?r.nestedHeaders=Array.from(m).reduce(function(w,E){var R=Array.from(E.cells).reduce(function(F,x,K){if(s&&K===0)return F;var Z=x.colSpan,re=x.innerHTML,ie=Z>1?{label:re,colspan:Z}:re;return F.push(ie),F},[]);return w.push(R),w},[]):d&&(r.colHeaders=Array.from(m[0].children).reduce(function(w,E,R){return s&&R===0||w.push(E.innerHTML),w},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var b=[].concat(h,iS(Array.from(i.tBodies).reduce(function(w,E){return w.push.apply(w,iS(Array.from(E.rows))),w},[])),iS(c));y=b.length;for(var S=new Array(y),C=0;C<y;C++)S[C]=new Array(f);for(var k=[],O=[],B=0;B<y;B++)for(var z=b[B],q=Array.from(z.cells),G=q.length,X=0;X<G;X++){var Q=q[X],oe=Q.nodeName,J=Q.innerHTML,ue=Q.rowSpan,he=Q.colSpan,Oe=S[B].findIndex(function(w){return w===void 0});if(oe==="TD"){if(ue>1||he>1){for(var we=B;we<B+ue;we++)if(we<y)for(var $=Oe;$<Oe+he;$++)S[we][$]=null;var P=Q.getAttribute("style"),g=P&&P.includes("mso-ignore:colspan");g||k.push({col:Oe,row:B,rowspan:ue,colspan:he})}var p="";l&&/excel/gi.test(l.content)?p=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):p=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[B][Oe]=p.replace(mTe,function(w){return bU[w]})}else O.push(J)}return k.length&&(r.mergeCells=k),O.length&&(r.rowHeaders=O),S.length&&(r.data=S),r}}const wTe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:TO,htmlToGridSettings:wU,instanceToHTML:EO},Symbol.toStringTag,{value:"Module"}));function Lx(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function STe(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var CTe=new Map([["mousedown",Lx],["mouseover",STe],["touchstart",Lx]]);function jx(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;CTe.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Fm(e)||e.type==="touchstart",isRightClick:$i(e)})}var SU=new WeakMap,UP=Symbol("rootInstance");function _Te(e){SU.set(e,!0)}function OTe(e){return e===UP}function PO(e){return SU.has(e)}function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function nc(e,t){return TTe(e)||ETe(e,t)||CU(e,t)||RTe()}function RTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ETe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function TTe(e){if(Array.isArray(e))return e}function Fx(e){return $Te(e)||kTe(e)||CU(e)||PTe()}function PTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CU(e,t){if(e){if(typeof e=="string")return kO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kO(e,t)}}function kTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Te(e){if(Array.isArray(e))return kO(e)}function kO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ATe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_U(n.key),n)}}function ITe(e,t,r){return t&&Bx(e.prototype,t),r&&Bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vx(e,t,r){MTe(e,t),t.set(e,r)}function MTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(e,t,r){return t=_U(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _U(e){var t=xTe(e,"string");return Kh(t)==="symbol"?t:String(t)}function xTe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wx(e,t){var r=OU(e,t,"get");return DTe(e,r)}function DTe(e,t){return t.get?t.get.call(e):t.value}function Ux(e,t,r){var n=OU(e,t,"set");return NTe(e,n,r),r}function OU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function NTe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Xi=new WeakMap,aS=new WeakMap,lS=new WeakMap,HTe=function(){function e(t){ATe(this,e),Qo(this,"instance",void 0),Qo(this,"eventManager",void 0),Qo(this,"settings",void 0),Qo(this,"THEAD",void 0),Qo(this,"TBODY",void 0),Qo(this,"_wt",void 0),Qo(this,"activeWt",void 0),Vx(this,aS,{writable:!0,value:0}),Vx(this,lS,{writable:!0,value:0}),Qo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new kt(this.instance),this.settings=this.instance.getSettings(),Xi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return ITe(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Xi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),te(o,"handsontable"),r.table=i.createElement("TABLE"),te(r.table,"htCore"),this.instance.getSettings().tableClassName&&te(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Xi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;r_(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&r_(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&Fm(u)&&l.finish(),n.mouseDown=!1,(Um(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!$i(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&$i(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var y=Jt(a);if(a.elementFromPoint(c+y,h)!==v||a.elementFromPoint(c,h+y)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var m=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;m?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Jc(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,Fx(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Xi.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return PO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,Fx(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),Ux(r,lS,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),Ux(r,aS,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=nc(d,2),y=v[0],m=v[1],b=r.instance.runHooks("modifyGetCellCoords",y,m),S=y,C=m;if(Array.isArray(b)){var k=nc(b,2);S=k[0],C=k[1]}var O=r.instance.getCellMeta(S,C),B=r.instance.colToProp(C),z=r.instance.getDataAtRowProp(S,B);r.instance.hasHook("beforeValueRender")&&(z=r.instance.runHooks("beforeValueRender",z,O)),r.instance.runHooks("beforeRenderer",h,y,m,B,z,O),r.instance.getCellRenderer(O)(r.instance,h,y,m,B,z,O),r.instance.runHooks("afterRenderer",h,y,m,B,z,O)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,y),!la(f)&&(jx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(b,S){return r.instance._createCellCoords(b,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!la(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!la(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,y),!la(f)&&(n.mouseDown&&jx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(b,S){return r.instance._createCellCoords(b,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(la(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),y=nc(v,2),m=y[0],b=y[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var k=(h??0)+1-C,O=S.peekByIndex(k);d=[O.from.row,O.from.col,O.to.row,O.to.col]}return r.instance.runHooks("afterDrawSelection",m,b,d,h)},onBeforeDrawBorders:function(f,c){var h=nc(f,4),d=h[0],v=h[1],y=h[2],m=h[3],b=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(y),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m)];return r.instance.runHooks("beforeDrawBorders",b,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,y=c>=0?v.getVisualFromRenderableIndex(c):c,m=f>=0?d.getVisualFromRenderableIndex(f):f,b=r.instance.runHooks("modifyGetCellCoords",m,y,h);if(Array.isArray(b)){var S=nc(b,4),C=S[0],k=S[1],O=S[2],B=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,k>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(k,1)):k,O>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(O,-1)):O,B>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(B,-1)):B]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var y=Math.ceil(v/h*12);f.startRow=Math.max(d-y,0),f.endRow=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var y=Math.ceil(v/h*6);f.startColumn=Math.max(d-y,0),f.endColumn=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new nbe(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Jc(r))return!0;var n=mi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Xi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){Cn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(Cn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?ul(r,o(n,i)):(Ai(r,String.fromCharCode(160)),te(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Xi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Xi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Wx(this,aS)}},{key:"getRowHeadersCount",value:function(){return Wx(this,lS)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const LTe=HTe;function $O(e){"@babel/helpers - typeof";return $O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$O(e)}var RU="ABCDEFGHIJKLMNOPQRSTUVWXYZ",AO=RU.length;function lb(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%AO,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/AO,10);return r}function jTe(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(AO,n)*(RU.indexOf(e[r])+1);return t-=1,t}function FTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(lb(o)+(n+1));r.push(i)}return r}function BTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=lb(o)+(n+1);r.push(i)}return r}function VTe(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function IO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function zP(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ue(e[0])&&(t=jm(e[0]))),t}function EU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function TU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return $O(t)==="object"&&!Array.isArray(t)&&t!==null}))}const WTe=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:zP,createEmptySpreadsheetData:VTe,createSpreadsheetData:FTe,createSpreadsheetObjectData:BTe,dataRowToChangesArray:IO,isArrayOfArrays:EU,isArrayOfObjects:TU,spreadsheetColumnIndex:jTe,spreadsheetColumnLabel:lb},Symbol.toStringTag,{value:"Module"}));function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function UTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YTe(n.key),n)}}function zTe(e,t,r){return t&&zx(e.prototype,t),r&&zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YTe(e){var t=GTe(e,"string");return qh(t)==="symbol"?t:String(t)}function GTe(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KTe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];UTe(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return zTe(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return A(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):Ce(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ue(s)||pt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;Ce(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):ug(u,d,v)}})}else ze(s,function(h,d){ug(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=Ba(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:ug(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=IV(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=Ba(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Ce(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return zP(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const qTe=KTe;var Yx;function XTe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ZTe(e,t){return ze(t,function(r,n){mt(e[n])&&(e[n]=r)}),e}function PU(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function kU(e){ve(e)&&NE(dt(Yx||(Yx=XTe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function QTe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var $U=on("phraseFormatters"),JTe=$U.register,ePe=$U.getValues;function tPe(e,t){JTe(e,t)}function rPe(){return ePe()}tPe("pluralize",QTe);function Xh(e){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}var fe;function ce(e,t,r){return t=nPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nPe(e){var t=oPe(e,"string");return Xh(t)==="symbol"?t:String(t)}function oPe(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iPe=(fe={languageCode:"en-US"},ce(fe,_T,"No available options"),ce(fe,OT,"Insert row above"),ce(fe,RT,"Insert row below"),ce(fe,ET,"Insert column left"),ce(fe,TT,"Insert column right"),ce(fe,PT,["Remove row","Remove rows"]),ce(fe,kT,["Remove column","Remove columns"]),ce(fe,$T,"Undo"),ce(fe,AT,"Redo"),ce(fe,IT,"Read only"),ce(fe,MT,"Clear column"),ce(fe,GT,"Alignment"),ce(fe,KT,"Left"),ce(fe,qT,"Center"),ce(fe,XT,"Right"),ce(fe,ZT,"Justify"),ce(fe,QT,"Top"),ce(fe,JT,"Middle"),ce(fe,eP,"Bottom"),ce(fe,jT,"Freeze column"),ce(fe,FT,"Unfreeze column"),ce(fe,tP,"Borders"),ce(fe,rP,"Top"),ce(fe,nP,"Right"),ce(fe,oP,"Bottom"),ce(fe,iP,"Left"),ce(fe,aP,"Remove border(s)"),ce(fe,WT,"Add comment"),ce(fe,UT,"Edit comment"),ce(fe,zT,"Delete comment"),ce(fe,YT,"Read-only comment"),ce(fe,BT,"Merge cells"),ce(fe,VT,"Unmerge cells"),ce(fe,xT,"Copy"),ce(fe,DT,["Copy with header","Copy with headers"]),ce(fe,NT,["Copy with group header","Copy with group headers"]),ce(fe,HT,["Copy header only","Copy headers only"]),ce(fe,LT,"Cut"),ce(fe,lP,"Insert child row"),ce(fe,sP,"Detach from parent"),ce(fe,uP,["Hide column","Hide columns"]),ce(fe,fP,["Show column","Show columns"]),ce(fe,cP,["Hide row","Hide rows"]),ce(fe,hP,["Show row","Show rows"]),ce(fe,Zm,"None"),ce(fe,dP,"Is empty"),ce(fe,vP,"Is not empty"),ce(fe,yP,"Is equal to"),ce(fe,gP,"Is not equal to"),ce(fe,pP,"Begins with"),ce(fe,mP,"Ends with"),ce(fe,bP,"Contains"),ce(fe,wP,"Does not contain"),ce(fe,SP,"Greater than"),ce(fe,CP,"Greater than or equal to"),ce(fe,_P,"Less than"),ce(fe,OP,"Less than or equal to"),ce(fe,RP,"Is between"),ce(fe,EP,"Is not between"),ce(fe,TP,"After"),ce(fe,PP,"Before"),ce(fe,kP,"Today"),ce(fe,$P,"Tomorrow"),ce(fe,AP,"Yesterday"),ce(fe,Bp,"Blank cells"),ce(fe,IP,"Filter by condition"),ce(fe,MP,"Filter by value"),ce(fe,xP,"And"),ce(fe,Qm,"Or"),ce(fe,DP,"Select all"),ce(fe,NP,"Clear"),ce(fe,HP,"OK"),ce(fe,LP,"Cancel"),ce(fe,jP,"Search"),ce(fe,FP,"Value"),ce(fe,BP,"Second value"),fe);const AU=iPe;var MO=AU.languageCode,sb=on("languagesDictionaries"),aPe=sb.register,IU=sb.getItem,lPe=sb.hasItem,sPe=sb.getValues;MU(AU);function MU(e,t){var r=e,n=t;return Ue(e)&&(n=e,r=n.languageCode),uPe(r,n),aPe(r,fr(n)),fr(n)}function uPe(e,t){e!==MO&&ZTe(t,IU(MO))}function xU(e){return YP(e)?fr(IU(e)):null}function YP(e){return lPe(e)}function fPe(){return sPe()}function DU(e,t,r){var n=xU(e);if(n===null)return null;var o=n[t];if(mt(o))return null;var i=cPe(o,r);return Array.isArray(i)?i[0]:i}function cPe(e,t){var r=e;return A(rPe(),function(n){r=n(e,t)}),r}function hPe(e){var t=PU(e);return YP(t)||(t=MO,kU(e)),t}var ub="active-header",fb="area",Zh="cell",GP="fill",Fv="header",KP="custom-selection";function Su(e){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function dPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HU(n.key),n)}}function vPe(e,t,r){return t&&Gx(e.prototype,t),r&&Gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rg(){return typeof Reflect<"u"&&Reflect.get?Rg=Reflect.get.bind():Rg=function(t,r,n){var o=yPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Rg.apply(this,arguments)}function yPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cu(e),e!==null););return e}function gPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xO(e,t)}function xO(e,t){return xO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xO(e,t)}function pPe(e){var t=bPe();return function(){var n=Cu(e),o;if(t){var i=Cu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mPe(this,o)}}function mPe(e,t){if(t&&(Su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NU(e)}function NU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cu(e)}function wPe(e,t,r){return t=HU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HU(e){var t=SPe(e,"string");return Su(t)==="symbol"?t:String(t)}function SPe(e,t){if(Su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CPe=function(e){gPe(r,e);var t=pPe(r);function r(n,o){var i;return dPe(this,r),i=t.call(this,n,null),wPe(NU(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return vPe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,Rg(Cu(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(xbe);const Nf=CPe;function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}var _Pe=["activeHeaderClassName"];function Kx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kx(Object(r),!0).forEach(function(n){OPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OPe(e,t,r){return t=RPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RPe(e){var t=EPe(e,"string");return Qh(t)==="symbol"?t:String(t)}function EPe(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TPe(e,t){if(e==null)return{};var r=PPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function PPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function kPe(e){var t=e.activeHeaderClassName,r=TPe(e,_Pe),n=new Nf(qx(qx({highlightHeaderClassName:t},r),{},{selectionType:ub}));return n}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var $Pe=["layerLevel","areaCornerVisible"];function Xx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Zx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xx(Object(r),!0).forEach(function(n){APe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function APe(e,t,r){return t=IPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IPe(e){var t=MPe(e,"string");return Jh(t)==="symbol"?t:String(t)}function MPe(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xPe(e,t){if(e==null)return{};var r=DPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function DPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function NPe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=xPe(e,$Pe),o=new Nf(Zx(Zx({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:fb}));return o}function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}var HPe=["cellCornerVisible"];function Qx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Jx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qx(Object(r),!0).forEach(function(n){LPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LPe(e,t,r){return t=jPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jPe(e){var t=FPe(e,"string");return ed(t)==="symbol"?t:String(t)}function FPe(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BPe(e,t){if(e==null)return{};var r=VPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function WPe(e){var t=e.cellCornerVisible,r=BPe(e,HPe),n=new Nf(Jx(Jx({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Zh}));return n}function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}var UPe=["border","visualCellRange"];function eD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function sS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eD(Object(r),!0).forEach(function(n){zPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zPe(e,t,r){return t=YPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YPe(e){var t=GPe(e,"string");return td(t)==="symbol"?t:String(t)}function GPe(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KPe(e,t){if(e==null)return{};var r=qPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function XPe(e){var t=e.border,r=e.visualCellRange,n=KPe(e,UPe),o=new Nf(sS(sS(sS({},t),n),{},{selectionType:KP}),r);return o}function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function tD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tD(Object(r),!0).forEach(function(n){ZPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZPe(e,t,r){return t=QPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QPe(e){var t=JPe(e,"string");return rd(t)==="symbol"?t:String(t)}function JPe(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eke(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function tke(e){var t=Object.assign({},(eke(e),e)),r=new Nf(rD(rD({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:GP}));return r}function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}var rke=["headerClassName","rowClassName","columnClassName"];function nD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function oD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nD(Object(r),!0).forEach(function(n){nke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nke(e,t,r){return t=oke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oke(e){var t=ike(e,"string");return nd(t)==="symbol"?t:String(t)}function ike(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ake(e,t){if(e==null)return{};var r=lke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function ske(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=ake(e,rke),i=new Nf(oD(oD({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:Fv}));return i}function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function iD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iD(Object(r),!0).forEach(function(n){fke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fke(e,t,r){return t=cke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cke(e){var t=hke(e,"string");return od(t)==="symbol"?t:String(t)}function hke(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LU=on("highlight/types"),Hf=LU.register,dke=LU.getItem;Hf(ub,kPe);Hf(fb,NPe);Hf(Zh,WPe);Hf(KP,XPe);Hf(GP,tke);Hf(Fv,ske);function Pl(e,t){return dke(e)(uke({type:e},t))}function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function Jo(e){return pke(e)||gke(e)||yke(e)||vke()}function vke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yke(e,t){if(e){if(typeof e=="string")return DO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DO(e,t)}}function gke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pke(e){if(Array.isArray(e))return DO(e)}function DO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function oc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aD(Object(r),!0).forEach(function(n){mke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mke(e,t,r){return t=jU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jU(n.key),n)}}function wke(e,t,r){return t&&lD(e.prototype,t),r&&lD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jU(e){var t=Ske(e,"string");return id(t)==="symbol"?t:String(t)}function Ske(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cke=function(e){function t(r){bke(this,t),this.options=r,this.layerLevel=0,this.cell=Pl(Zh,r),this.fill=Pl(GP,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return wke(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===Zh&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=Pl(fb,oc({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Jo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=Pl(Fv,oc({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Jo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=Pl(ub,oc({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Jo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Jo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(Pl(KP,oc(oc({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),A(this.areas.values(),function(n){return void n.clear()}),A(this.headers.values(),function(n){return void n.clear()}),A(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Jo(this.areas.values()),Jo(this.headers.values()),Jo(this.activeHeaders.values()),Jo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const _ke=Cke;function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function Oke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eke(n.key),n)}}function Rke(e,t,r){return t&&sD(e.prototype,t),r&&sD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eke(e){var t=Tke(e,"string");return ad(t)==="symbol"?t:String(t)}function Tke(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pke=function(e){function t(r){Oke(this,t),this.ranges=[],this.createCellRange=r}return Rke(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const kke=Pke;function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function $ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ike(n.key),n)}}function Ake(e,t,r){return t&&uD(e.prototype,t),r&&uD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ike(e){var t=Mke(e,"string");return ld(t)==="symbol"?t:String(t)}function Mke(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FU=function(){function e(t,r){$ke(this,e),this.range=t,this.options=r}return Ake(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),y=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),b=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&m>0&&!(y&&s>=d-y-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&b>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var k=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,k.row<0?(c=-1,k.row=0):k.row>0&&k.row>=d&&(c=1,k.row=d-1),k.col<0?(h=-1,k.col=0):k.col>0&&k.col>=v&&(h=1,k.col=v-1),f=this.options.renderableToVisualCoords(k)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),y=v.row,m=v.col,b=this.options.createCellCoords(y+o.row,m+o.col);l=0,s=0,b.row<0?(l=-1,b.row=0):b.row>0&&b.row>=h&&(l=1,b.row=h-1),b.col<0?(s=-1,b.col=0):b.col>0&&b.col>=d&&(s=1,b.col=d-1),a=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();gt(FU,Mr);const xke=FU;function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}var fD;function cD(e,t){return Lke(e)||Hke(e,t)||Nke(e,t)||Dke()}function Dke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nke(e,t){if(e){if(typeof e=="string")return hD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(e,t)}}function hD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Lke(e){if(Array.isArray(e))return e}function jke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Fke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vke(n.key),n)}}function Bke(e,t,r){return t&&dD(e.prototype,t),r&&dD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vke(e){var t=Wke(e,"string");return sd(t)==="symbol"?t:String(t)}function Wke(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BU=function(){function e(t,r){var n=this;Fke(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new kke(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new _ke({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new xke(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Bke(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&mt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Zh,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(A(this.highlight.getAreas(),function(y){return void y.clear()}),A(this.highlight.getHeaders(),function(y){return void y.clear()}),A(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(fb,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Fv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Ba(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=wu(r);if(o===rb)return!1;if(o===tb)throw new Error(dt(fD||(fD=jke([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Vh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=cD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=Zo(h,a)&&Zo(d,l)&&Zo(v,a)&&Zo(y,l);return!m});return s&&(this.clear(),A(r,function(u){var f=i(u),c=cD(f,4),h=c[0],d=c[1],v=c[2],y=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,y)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Zo(i,l)&&Zo(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Zo(r,i)&&Zo(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();gt(BU,Mr);const Uke=BU;var zke=$e,VU=hv,Yke=zn.f,Gke=nl,vD=Kt,Kke=bE,qke=Ar,Xke=wE,yD=VU("".startsWith),Zke=VU("".slice),Qke=Math.min,WU=Xke("startsWith"),Jke=!WU&&!!function(){var e=Yke(String.prototype,"startsWith");return e&&!e.writable}();zke({target:"String",proto:!0,forced:!Jke&&!WU},{startsWith:function(t){var r=vD(qke(this));Kke(t);var n=Gke(Qke(arguments.length>1?arguments[1]:void 0,r.length)),o=vD(t);return yD?yD(r,o,n):Zke(r,n,n+o.length)===o}});var gD=/^(\r\n|\n\r|\r|\n)/,e$e=/^[^\t\r\n]+/,pD=/^\t/;function t$e(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(pD))e=e.replace(pD,""),r+=1,t[n][r]="";else if(e.match(gD))e=e.replace(gD,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(e$e);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function jc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function uS(e){return i$e(e)||o$e(e)||n$e(e)||r$e()}function r$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n$e(e,t){if(e){if(typeof e=="string")return NO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NO(e,t)}}function o$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function i$e(e){if(Array.isArray(e))return NO(e)}function NO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function a$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s$e(n.key),n)}}function l$e(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s$e(e){var t=u$e(e,"string");return _u(t)==="symbol"?t:String(t)}function u$e(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f$e=function(){function e(t,r,n){a$e(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return l$e(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=jm(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ue(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return zP(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),_u(r)==="object"&&!Array.isArray(r)&&ze(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ve(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ve(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?gs(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,y=this.getSchema().length,m=[],b=function(){var k=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?k=fr(n.getSchema()):(k=[],Ce(y-1,function(){return k.push(null)})):n.instance.dataType==="function"?k=n.tableMeta.dataSchema(h+c):(k={},Ov(k,n.getSchema())),m.push(k),c+=1};c<o&&u+c<v;)b();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,m);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),y=this.instance.countCols(),m=0,b=d;l==="end"&&(b=Math.min(b+1,f));for(var S=b;m<n&&y<u;){if(typeof c!="number"||c>=y)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var k=0;k<v;k++)s[k].splice(b,0,null);m+=1,b+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,m),m>0&&(r==null?this.metaManager.createColumn(null,m):i!=="auto"&&this.metaManager.createColumn(S,n));var O=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",O,m,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ve(this.tableMeta.columns)||ve(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var y=0,m=this.instance.countSourceRows();y<m;y++)for(var b=0;b<f;b++)c[y].splice(l[b],1),y===0&&this.metaManager.removeColumn(l[b],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];FC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return RV(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];FC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(uS(this.dataSource.slice(0,r)),uS(o),uS(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&xt(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=Ba(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=Ba(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&xt(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return jc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return jc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const c$e=f$e;function h$e(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!xt(t,e)}function cb(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?eT(t.type):t.type;if(e._automaticallyAssignedMetaProps&&ze(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ue(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};ze(n,function(i,a){if(h$e(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),zt(e,o)}}function d$e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Ko(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Eg(e){return Number.isInteger(e)&&e>=0}function Tg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Ey(e){return e==null}function HO(e){"@babel/helpers - typeof";return HO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HO(e)}const UU=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),Xt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),Xt(o)===!1)return HO(o)==="object"?(i=this.getCellMeta(t,r),Lm(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function bD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bD(Object(r),!0).forEach(function(n){v$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v$e(e,t,r){return t=YU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YU(n.key),n)}}function zU(e,t,r){return t&&SD(e.prototype,t),r&&SD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YU(e){var t=y$e(e,"string");return ud(t)==="symbol"?t:String(t)}function y$e(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g$e(){return zU(function e(){GU(this,e)})}var p$e=function(){function e(t){GU(this,e),this.metaCtor=g$e(),this.meta=this.metaCtor.prototype,zt(this.meta,UU()),this.meta.instance=t}return zU(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;zt(this.meta,r),cb(this.meta,wD(wD({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function m$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w$e(n.key),n)}}function b$e(e,t,r){return t&&CD(e.prototype,t),r&&CD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w$e(e){var t=S$e(e,"string");return fd(t)==="symbol"?t:String(t)}function S$e(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C$e=function(){function e(t){m$e(this,e);var r=t.getMetaConstructor();this.meta=new r}return b$e(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){zt(this.meta,r),cb(this.meta,r,r)}}]),e}();function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function _D(e){return E$e(e)||R$e(e)||O$e(e)||_$e()}function _$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O$e(e,t){if(e){if(typeof e=="string")return LO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LO(e,t)}}function R$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function E$e(e){if(Array.isArray(e))return LO(e)}function LO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k$e(n.key),n)}}function P$e(e,t,r){return t&&OD(e.prototype,t),r&&OD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k$e(e){var t=$$e(e,"string");return cd(t)==="symbol"?t:String(t)}function $$e(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jO=function(e){function t(r){T$e(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return P$e(t,[{key:"obtain",value:function(n){Tg(function(){return Eg(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Tg(function(){return Eg(n)||Ey(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=Ey(n)?this.index.length:n;this.index=[].concat(_D(this.index.slice(0,s)),i,_D(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Tg(function(){return Eg(n)||Ey(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(Ey(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Wr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function A$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M$e(n.key),n)}}function I$e(e,t,r){return t&&RD(e.prototype,t),r&&RD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M$e(e){var t=x$e(e,"string");return hd(t)==="symbol"?t:String(t)}function x$e(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D$e=["data","width"],N$e=function(){function e(t){var r=this;A$e(this,e),this.globalMeta=t,this.metas=new jO(function(){return r._createMeta()})}return I$e(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);zt(o,n),cb(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return d$e(this.globalMeta.getMetaConstructor(),D$e).prototype}}]),e}();function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function H$e(e){return B$e(e)||F$e(e)||j$e(e)||L$e()}function L$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j$e(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function F$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function B$e(e){if(Array.isArray(e))return FO(e)}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function V$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ED(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U$e(n.key),n)}}function W$e(e,t,r){return t&&ED(e.prototype,t),r&&ED(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U$e(e){var t=z$e(e,"string");return dd(t)==="symbol"?t:String(t)}function z$e(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y$e=function(){function e(t){var r=this;V$e(this,e),this.columnMeta=t,this.metas=new jO(function(){return r._createRow()})}return W$e(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);zt(i,o),cb(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,H$e(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){Tg(function(){return Eg(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new jO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function G$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q$e(n.key),n)}}function K$e(e,t,r){return t&&TD(e.prototype,t),r&&TD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q$e(e){var t=X$e(e,"string");return vd(t)==="symbol"?t:String(t)}function X$e(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KU=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];G$e(this,e),this.hot=t,this.globalMeta=new p$e(t),this.tableMeta=new C$e(this.globalMeta),this.columnMeta=new N$e(this.globalMeta),this.cellMeta=new Y$e(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return K$e(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();gt(KU,Mr);function Vp(e){"@babel/helpers - typeof";return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vp(e)}function PD(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=ur(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":pt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new c$e(o,e,u);if(t(d),Vp(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var y,m=0,b=0;for(m=0,b=h.startRows;m<b;m++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)y=fr(v),e.push(y);else if(o.dataType==="array")y=fr(v[0]),e.push(y);else{y=[];for(var S=0,C=h.startCols;S<C;S++)y.push(null);e.push(y)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Vp(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function Z$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J$e(n.key),n)}}function Q$e(e,t,r){return t&&kD(e.prototype,t),r&&kD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J$e(e){var t=e1e(e,"string");return yd(t)==="symbol"?t:String(t)}function e1e(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t1e=function(){function e(t){var r=this;Z$e(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ge.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return Q$e(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=xt(r,"type")?r.type:null,c=pt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function r1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o1e(n.key),n)}}function n1e(e,t,r){return t&&$D(e.prototype,t),r&&$D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o1e(e){var t=i1e(e,"string");return gd(t)==="symbol"?t:String(t)}function i1e(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a1e=function(){function e(t){r1e(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return n1e(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),AD=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ty=function(t){return t.map(function(r){var n=r.toLowerCase();return AD.has(n)?AD.get(n):n}).sort().join("+")},l1e=function(t){return t.split("+")},ID=function(t){return t.toLowerCase()},MD;function s1e(e){return c1e(e)||f1e(e)||qU(e)||u1e()}function u1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function c1e(e){if(Array.isArray(e))return BO(e)}function h1e(e,t){return y1e(e)||v1e(e,t)||qU(e,t)||d1e()}function d1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qU(e,t){if(e){if(typeof e=="string")return BO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(e,t)}}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function y1e(e){if(Array.isArray(e))return e}function g1e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var p1e=function(t){var r=Gm({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,y=v===void 0?function(){return!0}:v,m=f.captureCtrl,b=m===void 0?!1:m,S=f.preventDefault,C=S===void 0?!0:S,k=f.stopPropagation,O=k===void 0?!1:k,B=f.relativeToGroup,z=f.position;if(mt(d))throw new Error("You need to define the shortcut's group.");if(pt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(dt(MD||(MD=g1e([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var q={callback:h,group:d,runOnlyIf:y,captureCtrl:b,preventDefault:C,stopPropagation:O};if(ve(B)){var G=[B,z];q.relativeToGroup=G[0],q.position=G[1]}c.forEach(function(X){var Q=Ty(X),oe=r.hasItem(Q);if(oe){var J=r.getItem(Q),ue=J.findIndex(function(he){return he.group===B});ue!==-1?z==="before"?ue-=1:ue+=1:ue=J.length,J.splice(ue,0,q)}else r.addItem(Q,[q])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){ze(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=Ty(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=h1e(h,2),v=d[0],y=d[1],m=y.filter(function(b){return b.group!==f});m.length===0?i(l1e(v)):(y.length=0,y.push.apply(y,s1e(m)))})},l=function(f){var c=Ty(f),h=r.getItem(c);return ve(h)?h.slice():[]},s=function(f){var c=Ty(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function m1e(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var b1e=["meta","alt","shift","control"],ic=m1e();function w1e(e,t,r,n,o){var i=function(d){return b1e.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return d.altKey&&y.push("alt"),v&&(d.ctrlKey||d.metaKey)?y.push("control/meta"):(d.ctrlKey&&y.push("control"),d.metaKey&&y.push("meta")),d.shiftKey&&y.push("shift"),y},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||la(d))){var y=ID(d.key),m=[];i(y)?ic.press(y):m=a(d);var b=[y].concat(m),S=o(d,b);!S&&(Qg()&&m.includes("meta")||!Qg()&&m.includes("control"))&&o(d,[y].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=ID(d.key);i(v)!==!1&&ic.release(v)}},u=function(){ic.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Xc(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Xc(d)};return{mount:f,unmount:c,isPressed:function(d){return ic.isPressed(d)},releasePressedKeys:function(){return ic.releaseAll()}}}var S1e=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=Gm({errorIdExists:function(y){return'The "'.concat(y,'" context name is already registered.')}}),l="grid",s=function(y){var m=p1e(y);return a.addItem(y,m),m},u=function(){return l},f=function(y){return a.getItem(y)},c=function(y){l=y},h=!1,d=w1e(r,n,o,i,function(v,y){var m=f(u()),b=!1;if(!m.hasShortcut(y))return b;for(var S=m.getShortcuts(y),C=0;C<S.length;C++){var k=S[C],O=k.callback,B=k.runOnlyIf,z=k.preventDefault,q=k.stopPropagation,G=k.captureCtrl;if(B(v)!==!1&&(h=G,b=O(v,y)===!1,h=!1,z&&v.preventDefault(),q&&v.stopPropagation(),b))break}return b});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}};function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(e)}function $n(e,t){return O1e(e)||_1e(e,t)||XU(e,t)||C1e()}function C1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function O1e(e){if(Array.isArray(e))return e}function kl(e){return T1e(e)||E1e(e)||XU(e)||R1e()}function R1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XU(e,t){if(e){if(typeof e=="string")return VO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(e,t)}}function E1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T1e(e){if(Array.isArray(e))return VO(e)}function VO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P1e="gridDefault",fS=null;function qP(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new kt(a),s,u,f,c,h=!0;OTe(o)&&_Te(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=hPe(t.language);var y=new KU(a,t,[t1e,a1e]),m=y.getTableMeta(),b=y.getGlobalMeta(),S=Gm();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),PO(this)&&kV(t.licenseKey,e),this.guid="ht_".concat($E()),this.columnIndexMapper=new nO,this.rowIndexMapper=new nO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterRowSequenceChange",g)}),u=new qTe(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(p){var w=p.row,E=p.col;return a._createCellCoords(w>=0?a.rowIndexMapper.getRenderableFromVisualIndex(w):w,E>=0?a.columnIndexMapper.getRenderableFromVisualIndex(E):E)},k=function(p){var w=p.row,E=p.col;return a._createCellCoords(w>=0?a.rowIndexMapper.getVisualFromRenderableIndex(w):w,E>=0?a.columnIndexMapper.getVisualFromRenderableIndex(E):E)},O=new Uke(m,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(p){return s.propToCol(p)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(p,w){return a._createCellCoords(p,w)},createCellRange:function(p,w,E){return a._createCellRange(p,w,E)},visualToRenderableCoords:C,renderableToVisualCoords:k,isDisabledCellSelection:function(p,w){return a.getCellMeta(p,w).disableVisualSelection}});this.selection=O;var B=function(p){var w=p.hiddenIndexesChanged;w&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",B),this.rowIndexMapper.addLocalHook("cacheUpdated",B),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var p=Ba(!1),w=n.selection.getSelectedRange(),E=w.current(),R=E.from,F=E.to,x=w.size()-1;n.runHooks("afterSelection",R.row,R.col,F.row,F.col,p,x),n.runHooks("afterSelectionByProp",R.row,a.colToProp(R.col),F.row,a.colToProp(F.col),p,x);var K=n.selection.isSelectedByAnyHeader(),Z=n.selection.selectedRange.current(),re=!0;i&&(re=!1),p.isTouched()&&(re=!p.value);var ie=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();re!==!1&&(K?ie?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):Z&&!n.selection.isMultiple()?n.view.scrollViewport(C(Z.from)):n.view.scrollViewport(C(g))),ie&&se?te(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ie?(Le(n.rootElement,"ht__selection--columns"),te(n.rootElement,"ht__selection--rows")):se?(Le(n.rootElement,"ht__selection--rows"),te(n.rootElement,"ht__selection--columns")):Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var p=g.length-1,w=g[p],E=w.from,R=w.to;n.runHooks("afterSelectionEnd",E.row,E.col,R.row,R.col,p),n.runHooks("afterSelectionEndByProp",E.row,a.colToProp(E.col),R.row,a.colToProp(R.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var p=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,p,w){n.runHooks("afterModifyTransformStart",g,p,w)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,p,w){n.runHooks("afterModifyTransformEnd",g,p,w)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),f={alter:function(p,w){var E,R,F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0,Z=function(Me){if(Me.length===0)return[];var De=kl(Me);De.sort(function(Bt,Ve){var et=$n(Bt,1),Ct=et[0],ut=$n(Ve,1),ft=ut[0];return Ct===ft?0:Ct>ft?1:-1});var dr=Ft(De,function(Bt,Ve){var et=$n(Ve,2),Ct=et[0],ut=et[1],ft=Bt[Bt.length-1],tt=$n(ft,2),qo=tt[0],yb=tt[1],ji=qo+yb;if(Ct<=ji){var Lf=Math.max(ut-(ji-Ct),0);ft[1]+=Lf}else Bt.push([Ct,ut]);return Bt},[De[0]]);return dr};switch(p){case"insert_row_below":case"insert_row_above":var re=a.countSourceRows();if(m.maxRows===re)return;var ie=p==="insert_row_below"?"below":"above";w=(E=w)!==null&&E!==void 0?E:ie==="below"?re:0;var se=s.createRow(w,F,{source:x,mode:ie}),_e=se.delta,Se=se.startPhysicalIndex;if(_e){var U=O.selectedRange.current(),Ne=U==null?void 0:U.from,Be=Ne==null?void 0:Ne.row,ke=a.toVisualRow(Se);if(O.isSelectedByCorner())a.selectAll();else if(ve(Be)&&Be>=ke){var Ie=U.to,Ae=Ie.row,_=Ie.col,T=Ne.col;O.isSelectedByRowHeader()&&(T=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(a._createCellCoords(Be+_e,T),!0),O.setRangeEnd(a._createCellCoords(Ae+_e,_))}else a._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var I=p==="insert_col_end"?"end":"start";w=(R=w)!==null&&R!==void 0?R:I==="end"?a.countSourceCols():0;var j=s.createCol(w,F,{source:x,mode:I}),M=j.delta,V=j.startPhysicalIndex;if(M){if(Array.isArray(m.colHeaders)){var N=[a.toVisualColumn(V),0];N.length+=M,Array.prototype.splice.apply(m.colHeaders,N)}var D=O.selectedRange.current(),W=D==null?void 0:D.from,L=W==null?void 0:W.col,Y=a.toVisualColumn(V);if(O.isSelectedByCorner())a.selectAll();else if(ve(L)&&L>=Y){var le=D.to,pe=le.row,Re=le.col,He=W.row;O.isSelectedByColumnHeader()&&(He=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(a._createCellCoords(He,L+M),!0),O.setRangeEnd(a._createCellCoords(pe,Re+M))}else a._refreshBorders()}break;case"remove_row":var Ze=function(Me){var De=0;A(Me,function(dr){var Bt=$n(dr,2),Ve=Bt[0],et=Bt[1],Ct=Xt(Ve)?a.countRows()-1:Math.max(Ve-De,0);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ut=s.removeRow(Ve,et,x);if(ut){var ft=a.countRows(),tt=m.fixedRowsTop;tt>=Ct+1&&(m.fixedRowsTop-=Math.min(et,tt-Ct));var qo=m.fixedRowsBottom;qo&&Ct>=ft-qo&&(m.fixedRowsBottom-=Math.min(et,qo)),De+=et}})};Array.isArray(w)?Ze(Z(w)):Ze([[w,F]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var st=function(Me){var De=0;A(Me,function(dr){var Bt=$n(dr,2),Ve=Bt[0],et=Bt[1],Ct=Xt(Ve)?a.countCols()-1:Math.max(Ve-De,0),ut=a.toPhysicalColumn(Ct);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ft=s.removeCol(Ve,et,x);if(ft){var tt=m.fixedColumnsStart;tt>=Ct+1&&(m.fixedColumnsStart-=Math.min(et,tt-Ct)),Array.isArray(m.colHeaders)&&(typeof ut>"u"&&(ut=-1),m.colHeaders.splice(ut,et)),De+=et}})};Array.isArray(w)?st(Z(w)):st([[w,F]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(p,'"'))}K||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var p=m.minRows,w=m.minSpareRows,E=m.minCols,R=m.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&O.deselect(),p){var F=a.countRows();F<p&&s.createRow(F,p-F,{source:"auto"})}if(w){var x=a.countEmptyRows(!0);if(x<w){var K=w-x,Z=Math.min(K,m.maxRows-a.countSourceRows());s.createRow(a.countRows(),Z,{source:"auto"})}}{var re;(E||R)&&(re=a.countEmptyCols(!0));var ie=a.countCols();if(E&&!m.columns&&ie<E){var se=E-ie;re+=se,s.createCol(ie,se,{source:"auto"})}if(R&&!m.columns&&a.dataType==="array"&&re<R){ie=a.countCols();var _e=R-re,Se=Math.min(_e,m.maxCols-ie);s.createCol(ie,Se,{source:"auto"})}}if(O.isSelected()){var U=a.countRows(),Ne=a.countCols();A(O.selectedRange,function(Be){var ke=!1,Ie=Be.from.row,Ae=Be.from.col,_=Be.to.row,T=Be.to.col;Ie>U-1?(Ie=U-1,ke=!0,_>Ie&&(_=Ie)):_>U-1&&(_=U-1,ke=!0,Ie>_&&(Ie=_)),Ae>Ne-1?(Ae=Ne-1,ke=!0,T>Ae&&(T=Ae)):T>Ne-1&&(T=Ne-1,ke=!0,Ae>T&&(Ae=T)),ke&&a.selectCell(Ie,Ae,_,T)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(p,w,E,R,F){var x,K,Z,re,ie=[],se={},_e=[],Se=p.row,U=p.col;if(K=w.length,K===0)return!1;var Ne=0,Be=0;switch(Ue(E)&&(Ne=E.col-U+1,Be=E.row-Se+1),F){case"shift_down":var ke=Pc(w),Ie=ke.length,Ae=Math.max(Ie,Ne),_=a.getData().slice(Se),T=Pc(_).slice(U,U+Ae);for(Z=0;Z<Ae;Z+=1)if(Z<Ie){for(x=0,K=ke[Z].length;x<Be-K;x+=1)ke[Z].push(ke[Z][x%K]);Z<T.length?_e.push(ke[Z].concat(T[Z])):_e.push(ke[Z].concat(new Array(_.length).fill(null)))}else _e.push(ke[Z%Ie].concat(T[Z]));a.populateFromArray(Se,U,Pc(_e));break;case"shift_right":var I=w.length,j=Math.max(I,Be),M=a.getData().slice(Se).map(function(Ve){return Ve.slice(U)});for(x=0;x<j;x+=1)if(x<I){for(Z=0,re=w[x].length;Z<Ne-re;Z+=1)w[x].push(w[x][Z%re]);if(x<M.length)for(var V=0;V<M[x].length;V+=1)w[x].push(M[x][V]);else{var N;(N=w[x]).push.apply(N,kl(new Array(M[0].length).fill(null)))}}else w.push(w[x%K].slice(0,j).concat(M[x]));a.populateFromArray(Se,U,w);break;case"overwrite":default:se.row=p.row,se.col=p.col;var D=0,W=0,L=!0,Y,le=function(et){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ut=w[et%w.length];return Ct!==null?ut[Ct%ut.length]:ut},pe=w.length,Re=E?E.row-p.row+1:0;for(E?K=Re:K=Math.max(pe,Re),x=0;x<K&&!(E&&se.row>E.row&&Re>pe||!m.allowInsertRow&&se.row>a.countRows()-1||se.row>=m.maxRows);x++){var He=x-D,Ze=le(He).length,st=E?E.col-p.col+1:0;if(E?re=st:re=Math.max(Ze,st),se.col=p.col,Y=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Y.skipRowOnPaste){D+=1,se.row+=1,K+=1;continue}for(W=0,Z=0;Z<re&&!(E&&se.col>E.col&&st>Ze||!m.allowInsertColumn&&se.col>a.countCols()-1||se.col>=m.maxCols);Z++){if(Y=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Y.skipColumnOnPaste){W+=1,se.col+=1,re+=1;continue}if(Y.readOnly&&R!=="UndoRedo.undo"){se.col+=1;continue}var Ge=Z-W,Me=le(He,Ge),De=a.getDataAtCell(se.row,se.col);if(Me!==null&&Er(Me)==="object")if(Array.isArray(Me)&&De===null&&(De=[]),De===null||Er(De)!=="object")L=!1;else{var dr=gs(Array.isArray(De)?De:De[0]||De),Bt=gs(Array.isArray(Me)?Me:Me[0]||Me);Lm(dr,Bt)||Array.isArray(dr)&&Array.isArray(Bt)?Me=fr(Me):L=!1}else De!==null&&Er(De)==="object"&&(L=!1);L&&ie.push([se.row,se.col,Me]),L=!0,se.col+=1}se.row+=1}a.setDataAtCell(ie,null,null,R||"populateFromArray");break}}};function z(g){var p=PU(g);YP(p)?(a.runHooks("beforeLanguageChange",p),b.language=p,a.runHooks("afterLanguageChange",p)):kU(g)}function q(g,p){var w=g==="className"?a.rootElement:a.table;if(h)te(w,p);else{var E=[],R=[];b[g]&&(E=Array.isArray(b[g])?b[g]:VC(b[g])),p&&(R=Array.isArray(p)?p:VC(p));var F=BC(E,R),x=BC(R,E);F.length&&Le(w,F),x.length&&te(w,x)}b[g]=p}this.init=function(){u.setData(m.data),a.runHooks("beforeInit"),(pn()||RE())&&te(a.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new LTe(this),c=ose.getInstance(a,m,O),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&uW(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Er(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function G(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function X(g){var p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function Q(g,p,w){if(g.length){var E=a.getActiveEditor(),R=new G,F=!0;R.onQueueEmpty=function(Se){E&&F&&E.cancelChanges(),w(Se)};for(var x=g.length-1;x>=0;x--){var K=$n(g[x],4),Z=K[0],re=K[1],ie=K[3],se=s.propToCol(re),_e=a.getCellMeta(Z,se);_e.type==="numeric"&&typeof ie=="string"&&SW(ie)&&(g[x][3]=X(ie)),a.getCellValidator(_e)&&(R.addValidatorToQueue(),a.validateCell(g[x][3],_e,function(Se,U){return function(Ne){if(typeof Ne!="boolean")throw new Error("Validation error: result is not boolean");if(Ne===!1&&U.allowInvalid===!1){F=!1,g.splice(Se,1),U.valid=!0;var Be=a.getCell(U.visualRow,U.visualCol);Be!==null&&Le(Be,m.invalidCellClassName)}R.removeValidatorFormQueue()}}(x,_e),p))}R.checkIfQueueIsEmpty()}}function oe(g,p){var w=g.length-1;if(!(w<0)){for(;w>=0;w--){var E=!1;if(g[w]===null){g.splice(w,1);continue}if(!((g[w][2]===null||g[w][2]===void 0)&&(g[w][3]===null||g[w][3]===void 0))){if(m.allowInsertRow)for(;g[w][0]>a.countRows()-1;){var R=s.createRow(void 0,void 0,{source:p}),F=R.delta;if(F===0){E=!0;break}}if(a.dataType==="array"&&(!m.columns||m.columns.length===0)&&m.allowInsertColumn)for(;s.propToCol(g[w][1])>a.countCols()-1;){var x=s.createCol(void 0,void 0,{source:p}),K=x.delta;if(K===0){E=!0;break}}E||s.set(g[w][0],g[w][1],g[w][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,p),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,p||"edit");var Z=a.getActiveEditor();Z&&ve(Z.refreshValue)&&Z.refreshValue()}}this._createCellCoords=function(g,p){return a.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,w){return a.view._wt.createCellRange(g,p,w)},this.validateCell=function(g,p,w,E){var R=a.getCellValidator(p);function F(x){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!K||p.hidden===!0){w(x);return}var Z=p.visualCol,re=p.visualRow,ie=a.getCell(re,Z,!0);if(ie&&ie.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(re),_e=a.columnIndexMapper.getRenderableFromVisualIndex(Z);a.view._wt.getSetting("cellRenderer",se,_e,ie)}w(x)}PV(R)&&(R=function(x){return function(K,Z){Z(x.test(K))}}(R)),pt(R)?(g=a.runHooks("beforeValidate",g,p.visualRow,p.prop,E),a._registerImmediate(function(){R.call(p,g,function(x){a&&(x=a.runHooks("afterValidate",x,g,p.visualRow,p.prop,E),p.valid=x,F(x),a.runHooks("postAfterValidate",x,g,p.visualRow,p.prop,E))})})):a._registerImmediate(function(){p.valid=!0,F(p.valid,!1)})};function J(g,p,w){return Array.isArray(g)?g:[[g,p,w]]}function ue(g,p){var w=a.getActiveEditor(),E=a.runHooks("beforeChange",g,p||"edit"),R=g.filter(function(F){return F!==null});return E===!1||R.length===0?(w&&w.cancelChanges(),[]):R}this.setDataAtCell=function(g,p,w,E){var R=J(g,p,w),F=[],x=E,K,Z,re;for(K=0,Z=R.length;K<Z;K++){if(Er(R[K])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[K][1]>=this.countCols()?re=R[K][1]:re=s.colToProp(R[K][1]),F.push([R[K][0],re,u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]])}!x&&Er(g)==="object"&&(x=p);var ie=ue(F,E);a.runHooks("afterSetDataAtCell",ie,x),Q(ie,x,function(){oe(ie,x)})},this.setDataAtRowProp=function(g,p,w,E){var R=J(g,p,w),F=[],x=E,K,Z;for(K=0,Z=R.length;K<Z;K++)F.push([R[K][0],R[K][1],u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]]);!x&&Er(g)==="object"&&(x=p);var re=ue(F,E);a.runHooks("afterSetDataAtRowProp",re,x),Q(re,x,function(){oe(re,x)})},this.listen=function(){a&&!a.isListening()&&(fS=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(fS=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return fS===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,p)},this.populateFromArray=function(g,p,w,E,R,F,x){if(!(Er(w)==="object"&&Er(w[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var K=typeof E=="number"?a._createCellCoords(E,R):null;return f.populateFromArray(a._createCellCoords(g,p),w,K,F,x)},this.spliceCol=function(g,p,w){for(var E,R=arguments.length,F=new Array(R>3?R-3:0),x=3;x<R;x++)F[x-3]=arguments[x];return(E=s).spliceCol.apply(E,[g,p,w].concat(F))},this.spliceRow=function(g,p,w){for(var E,R=arguments.length,F=new Array(R>3?R-3:0),x=3;x<R;x++)F[x-3]=arguments[x];return(E=s).spliceRow.apply(E,[g,p,w].concat(F))},this.getSelected=function(){if(O.isSelected())return We(O.getSelectedRange(),function(g){var p=g.from,w=g.to;return[p.row,p.col,w.row,w.col]})},this.getSelectedLast=function(){var g=this.getSelected(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){var p=this;if(!(!O.isSelected()||this.countRows()===0||this.countCols()===0)){var w=[];A(O.getSelectedRange(),function(E){var R=E.getTopStartCorner(),F=E.getBottomEndCorner();Ce(R.row,F.row,function(x){Ce(R.col,F.col,function(K){p.getCellMeta(x,K).readOnly||w.push([x,K,null])})})}),w.length>0&&this.setDataAtCell(w,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var w=g();return this.resumeExecution(p),w},this.batch=function(g){this.suspendRender(),this.suspendExecution();var p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),p=g.width,w=g.height,E=a.rootElement.getBoundingClientRect(),R=E.width,F=E.height,x=R!==p||F!==w,K=a.runHooks("beforeRefreshDimensions",{width:p,height:w},{width:R,height:F},x)===!1;K||((x||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(R,F),a.render()),a.runHooks("afterRefreshDimensions",{width:p,height:w},{width:R,height:F},x))}},this.updateData=function(g,p){var w=this;PD(g,function(E){s=E},function(E){s=E,a.columnIndexMapper.fitToLength(w.getInitialColumnCount()),a.rowIndexMapper.fitToLength(w.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:p,metaManager:y,firstRun:h})},this.loadData=function(g,p){PD(g,function(w){s=w},function(){y.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:p,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var g=m.columns,p=0;if(Array.isArray(g))p=g.length;else if(pt(g))if(a.dataType==="array")for(var w=this.countSourceCols(),E=0;E<w;E+=1)g(E)&&(p+=1);else(a.dataType==="object"||a.dataType==="function")&&(p=s.colToPropCache.length);else if(ve(m.dataSchema)){var R=s.getSchema();p=Array.isArray(R)?R.length:jm(R)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,w,E){return mt(g)?s.getAll():s.getRange(a._createCellCoords(g,p),a._createCellCoords(w,E),s.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,w,E){return s.getCopyableText(a._createCellCoords(g,p),a._createCellCoords(w,E))},this.getCopyableData=function(g,p){return s.getCopyable(g,s.colToProp(p))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=(h?a.loadData:a.updateData).bind(this),E=!1,R,F;if(ve(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ve(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ve(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in g)R==="data"||(R==="language"?z(g.language):R==="className"?q("className",g.className):R==="tableClassName"&&a.table?(q("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(R)||ge.getSingleton().isDeprecated(R)?(pt(g[R])||Array.isArray(g[R]))&&(g[R].initialHook=!0,a.addHook(R,g[R])):!p&&xt(g,R)&&(b[R]=g[R]));g.data===void 0&&m.data===void 0?w(null,"updateSettings"):g.data!==void 0?w(g.data,"updateSettings"):g.columns!==void 0&&(s.createMap(),a.initIndexMappers());var x=a.countCols(),K=m.columns;if(K&&pt(K)&&(E=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),x>0)for(R=0,F=0;R<x;R++){if(K){var Z=E?K(R):K[F];Z&&y.updateColumnMeta(F,Z)}F+=1}ve(g.cell)&&ze(g.cell,function(U){a.setCellMetaObject(U.row,U.col,U)}),a.runHooks("afterCellMetaReset");var re=a.rootElement.style.height;re!==""&&(re=parseInt(a.rootElement.style.height,10));var ie=g.height;if(pt(ie)&&(ie=ie()),p){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ie===null){var _e=a.rootElement.getAttribute("data-initialstyle");_e&&(_e.indexOf("height")>-1||_e.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",_e):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ie!==void 0&&(a.rootElement.style.height=isNaN(ie)?"".concat(ie):"".concat(ie,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var Se=g.width;pt(Se)&&(Se=Se()),a.rootElement.style.width=isNaN(Se)?"".concat(Se):"".concat(Se,"px")}p||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!p&&a.view&&(re===""||ie===""||ie===void 0)&&re!==ie&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(m.getValue){if(pt(m.getValue))return m.getValue.call(a);if(g)return a.getData()[g[0][0]][m.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return m},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,w,E,R){f.alter(g,p,w,E,R)},this.getCell=function(g,p){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=p,R=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return R===null||E===null?null:a.view.getCellAtCoords(a._createCellCoords(R,E),w)},this.getCoords=function(g){var p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;var w=p.row,E=p.col,R=w,F=E;return w>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(w)),E>=0&&(F=this.columnIndexMapper.getVisualFromRenderableIndex(E)),a._createCellCoords(R,F)},this.colToProp=function(g){return s.colToProp(g)},this.propToCol=function(g){return s.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,p){return s.get(g,s.colToProp(p))},this.getDataAtRowProp=function(g,p){return s.get(g,p)},this.getDataAtCol=function(g){for(var p=[],w=s.getRange(a._createCellCoords(0,g),a._createCellCoords(m.data.length-1,g),s.DESTINATION_RENDERER),E=0;E<w.length;E+=1)for(var R=0;R<w[E].length;R+=1)p.push(w[E][R]);return p},this.getDataAtProp=function(g){for(var p=[],w=s.getRange(a._createCellCoords(0,s.propToCol(g)),a._createCellCoords(m.data.length-1,s.propToCol(g)),s.DESTINATION_RENDERER),E=0;E<w.length;E+=1)for(var R=0;R<w[E].length;R+=1)p.push(w[E][R]);return p},this.getSourceData=function(g,p,w,E){var R;return g===void 0?R=u.getData():R=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(w,E)),R},this.getSourceDataArray=function(g,p,w,E){var R;return g===void 0?R=u.getData(!0):R=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(w,E),!0),R},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,w,E){var R=J(g,p,w),F=this.hasHook("afterSetSourceDataAtCell"),x=[];F&&A(R,function(Z){var re=$n(Z,3),ie=re[0],se=re[1],_e=re[2];x.push([ie,se,u.getAtCell(ie,se),_e])}),A(R,function(Z){var re=$n(Z,3),ie=re[0],se=re[1],_e=re[2];u.setAtCell(ie,se,_e)}),F&&this.runHooks("afterSetSourceDataAtCell",x,E),this.render();var K=a.getActiveEditor();K&&ve(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return u.getAtCell(g,p)},this.getDataAtRow=function(g){var p=s.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),s.DESTINATION_RENDERER);return p[0]||[]},this.getDataType=function(g,p,w,E){var R=this,F=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,w,E],x=F[0],K=F[1],Z=F[2],re=F[3],ie=null,se=null;Z===void 0&&(Z=x),re===void 0&&(re=K);var _e="mixed";return Ce(Math.max(Math.min(x,Z),0),Math.max(x,Z),function(Se){var U=!0;return Ce(Math.max(Math.min(K,re),0),Math.max(K,re),function(Ne){var Be=R.getCellMeta(Se,Ne);return se=Be.type,ie?U=ie===se:ie=se,U}),_e=U?se:"mixed",U}),_e},this.removeCellMeta=function(g,p,w){var E=[this.toPhysicalRow(g),this.toPhysicalColumn(p)],R=E[0],F=E[1],x=y.getCellMetaKeyValue(R,F,w),K=a.runHooks("beforeRemoveCellMeta",g,p,w,x);K!==!1&&(y.removeCellMeta(R,F,w),a.runHooks("afterRemoveCellMeta",g,p,w,x)),x=null},this.spliceCellsMeta=function(g){for(var p=this,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=arguments.length,R=new Array(E>2?E-2:0),F=2;F<E;F++)R[F-2]=arguments[F];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&y.removeRow(this.toPhysicalRow(g),w),R.length>0&&A(R.reverse(),function(x){y.createRow(p.toPhysicalRow(g)),A(x,function(K,Z){return p.setCellMetaObject(g,Z,K)})}),a.render()},this.setCellMetaObject=function(g,p,w){var E=this;Er(w)==="object"&&ze(w,function(R,F){E.setCellMeta(g,p,F,R)})},this.setCellMeta=function(g,p,w,E){var R=a.runHooks("beforeSetCellMeta",g,p,w,E);if(R!==!1){var F=g,x=p;g<this.countRows()&&(F=this.toPhysicalRow(g)),p<this.countCols()&&(x=this.toPhysicalColumn(p)),y.setCellMeta(F,x,w,E),a.runHooks("afterSetCellMeta",g,p,w,E)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,p){var w=this.toPhysicalRow(g),E=this.toPhysicalColumn(p);return w===null&&(w=g),E===null&&(E=p),y.getCellMeta(w,E,{visualRow:g,visualColumn:p})},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||m.columns)},this.getCellRenderer=function(g,p){var w=typeof g=="number"?a.getCellMeta(g,p).renderer:g.renderer;return typeof w=="string"?sp(w):mt(w)?sp("text"):w},this.getCellEditor=function(g,p){var w=typeof g=="number"?a.getCellMeta(g,p).editor:g.editor;return typeof w=="string"?np(w):mt(w)?np("text"):w},this.getCellValidator=function(g,p){var w=typeof g=="number"?a.getCellMeta(g,p).validator:g.validator;return typeof w=="string"?JE(w):w},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,w){var E=new G;g&&(E.onQueueEmpty=g);for(var R=a.countRows()-1;R>=0;){if(p!==void 0&&p.indexOf(R)===-1){R-=1;continue}for(var F=a.countCols()-1;F>=0;){if(w!==void 0&&w.indexOf(F)===-1){F-=1;continue}E.addValidatorToQueue(),a.validateCell(a.getDataAtCell(R,F),a.getCellMeta(R,F),function(x){if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),F-=1}R-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var p=m.rowHeaders,w=g;return w!==void 0&&(w=a.runHooks("modifyRowHeader",w)),w===void 0?(p=[],Ce(a.countRows()-1,function(E){p.push(a.getRowHeader(E))})):Array.isArray(p)&&p[w]!==void 0?p=p[w]:pt(p)?p=p(w):p&&typeof p!="string"&&typeof p!="number"&&(p=w+1),p},this.hasRowHeaders=function(){return!!m.rowHeaders},this.hasColHeaders=function(){if(m.colHeaders!==void 0&&m.colHeaders!==null)return!!m.colHeaders;for(var g=0,p=a.countCols();g<p;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,w=a.runHooks("modifyColHeader",g);if(w===void 0){for(var E=[],R=a.countCols(),F=0;F<R;F++)E.push(a.getColHeader(F));return E}var x=m.colHeaders,K=function(se){for(var _e=[],Se=a.countCols(),U=0;U<Se;U++)pt(m.columns)&&m.columns(U)&&_e.push(U);return _e[se]},Z=a.toPhysicalColumn(w),re=K(Z);return m.colHeaders===!1?x=null:m.columns&&pt(m.columns)&&m.columns(re)&&m.columns(re).title?x=m.columns(re).title:m.columns&&m.columns[Z]&&m.columns[Z].title?x=m.columns[Z].title:Array.isArray(m.colHeaders)&&m.colHeaders[Z]!==void 0?x=m.colHeaders[Z]:pt(m.colHeaders)?x=m.colHeaders(Z):m.colHeaders&&typeof m.colHeaders!="string"&&typeof m.colHeaders!="number"&&(x=lb(w)),x=a.runHooks("modifyColumnHeaderValue",x,g,p),x},this._getColWidthFromSettings=function(g){var p;if(g>=0){var w=a.getCellMeta(0,g);p=w.width}if((p===void 0||p===m.width)&&(p=m.colWidths),p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g){var p=a._getColWidthFromSettings(g);return p=a.runHooks("modifyColWidth",p,g),p===void 0&&(p=oT.DEFAULT_WIDTH),p},this._getRowHeightFromSettings=function(g){var p=m.rowHeights;if(p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(g){var p=a._getRowHeightFromSettings(g);return p=a.runHooks("modifyRowHeight",p,g),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var g=m.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return ip(a.countRows()-1,function(w){if(a.isEmptyRow(w))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return ip(a.countCols()-1,function(w){if(a.isEmptyCol(w))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return m.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return m.isEmptyCol.call(a,g)},this.selectCell=function(g,p,w,E){var R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mt(g)||mt(p)?!1:this.selectCells([[g,p,w,E]],R,F)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&(i=!0);var E=O.selectCells(g);return E&&w&&a.listen(),i=!1,E},this.selectColumns=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return O.selectColumns(g,p)},this.selectRows=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return O.selectRows(g,p)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=g&&this.hasRowHeaders(),w=g&&this.hasColHeaders();i=!0,O.selectAll(p,w),i=!1};var he=function(p,w){return p.getNearestNotHiddenIndex(w,1,!0)};this.scrollViewportTo=function(g,p){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=!w,x=!E,K=g,Z=p;if(R){var re=Number.isInteger(g),ie=Number.isInteger(p),se=re?he(this.rowIndexMapper,g):void 0,_e=ie?he(this.columnIndexMapper,p):void 0;if(se===null||_e===null)return!1;K=re?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,Z=ie?a.columnIndexMapper.getRenderableFromVisualIndex(_e):void 0}var Se=Number.isInteger(K),U=Number.isInteger(Z);return Se&&U?a.view.scrollViewport(a._createCellCoords(K,Z),F,E,w,x):Se&&U===!1?a.view.scrollViewportVertically(K,F,w):U&&Se===!1?a.view.scrollViewportHorizontally(Z,E,x):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),PO(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Cn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(p){var w=$n(p,2),E=w[1];E.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(a),ze(a,function(p,w,E){pt(p)?E[w]=Oe(w):w!=="guid"&&(E[w]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,O=null,c=null,a=null};function Oe(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){var p=ur(g);return p==="UndoRedo"?this.undoRedo:S.getItem(p)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,p){ge.getSingleton().add(g,p,a)},this.hasHook=function(g){return ge.getSingleton().has(g,a)||ge.getSingleton().has(g)},this.addHookOnce=function(g,p){ge.getSingleton().once(g,p,a)},this.removeHook=function(g,p){ge.getSingleton().remove(g,p,a)},this.runHooks=function(g,p,w,E,R,F,x){return ge.getSingleton().run(a,g,p,w,E,R,F,x)},this.getTranslatedPhrase=function(g,p){return DU(m.language,g,p)},this.toHTML=function(){return EO(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",EO(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=g;typeof w=="function"&&(w=setTimeout(w,p)),this.timeouts.push(w)},this._clearTimeouts=function(){A(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){A(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(g),a.view.render(),p&&O.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var we=S1e({handleEvent:function(p){var w=a.isListening(),E=(p==null?void 0:p.key)!==void 0;return w&&E},beforeKeyDown:function(p){return n.runHooks("beforeKeyDown",p)},afterKeyDown:function(p){n.isDestroyed||a.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we};var $=we.addContext("grid"),P={runOnlyIf:function(){return ve(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:P1e};we.setActiveContextName("grid"),$.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var p=a.getSelectedRange(),w=p[p.length-1].highlight,E=w.row,R=w.col,F=a.getDataAtCell(E,R),x=new Map,K=0;K<p.length;K++)p[K].forAll(function(Z,re){if(Z>=0&&re>=0&&(Z!==E||re!==R)){var ie=a.getCellMeta(Z,re),se=ie.readOnly;se||x.set("".concat(Z,"x").concat(re),[Z,re,F])}});a.setDataAtCell(Array.from(x.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){O.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){O.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),w=p.from,E=p.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);O.setRangeStart(w.clone()),O.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){O.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){O.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),w=p.from,E=p.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);O.setRangeStart(w.clone()),O.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){O.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast().highlight.row,E=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,kl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));O.setRangeStart(a._createCellCoords(w,E))}},{keys:[["ArrowLeft","Shift"]],callback:function(){O.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast(),E=w.from,R=w.to,F=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,kl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));O.setRangeStart(E.clone()),O.setRangeEnd(a._createCellCoords(R.row,F))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){O.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast().highlight.row,E=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,kl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));O.setRangeStart(a._createCellCoords(w,E))}},{keys:[["ArrowRight","Shift"]],callback:function(){O.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,w=a.getSelectedRangeLast(),E=w.from,R=w.to,F=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,kl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));O.setRangeStart(E.clone()),O.setRangeEnd(a._createCellCoords(R.row,F))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedColumnsStart,10),w=a.getSelectedRangeLast().highlight.row,E=a.columnIndexMapper.getNearestNotHiddenIndex(p,1);O.setRangeStart(a._createCellCoords(w,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){O.setRangeEnd(a._createCellCoords(O.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsTop,10),w=parseInt(a.getSettings().fixedColumnsStart,10),E=a.rowIndexMapper.getNearestNotHiddenIndex(p,1),R=a.columnIndexMapper.getNearestNotHiddenIndex(w,1);O.setRangeStart(a._createCellCoords(E,R))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){O.setRangeEnd(a._createCellCoords(O.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsBottom,10),w=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-p-1,-1),E=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);O.setRangeStart(a._createCellCoords(w,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){O.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),w=p.to,E=Math.max(w.row-a.countVisibleRows(),0),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,1);if(R!==null){var F=a._createCellCoords(R,w.col),x=w.row-a.view.getFirstFullyVisibleRow(),K=Math.max(F.row-x,0);O.setRangeEnd(F),a.scrollViewportTo(K)}}},{keys:[["PageDown"]],callback:function(){O.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),w=p.to,E=Math.min(w.row+a.countVisibleRows(),a.countRows()-1),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,-1);if(R!==null){var F=a._createCellCoords(R,w.col),x=w.row-a.view.getFirstFullyVisibleRow(),K=Math.min(F.row-x,a.countRows()-1);O.setRangeEnd(F),a.scrollViewportTo(K)}}},{keys:[["Tab"]],callback:function(p){var w=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;O.transformStart(w.row,w.col,!0)}},{keys:[["Shift","Tab"]],callback:function(p){var w=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;O.transformStart(-w.row,-w.col)}}],P),rT().forEach(function(g){var p=Iv(g);S.addItem(g,new p(n))}),ge.getSingleton().run(a,"construct")}function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function xD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function DD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xD(Object(r),!0).forEach(function(n){k1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k1e(e,t,r){return t=ZU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ND(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZU(n.key),n)}}function A1e(e,t,r){return t&&ND(e.prototype,t),r&&ND(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZU(e){var t=I1e(e,"string");return pd(t)==="symbol"?t:String(t)}function I1e(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HD=215,QU="menu",M1e=QU,JU=function(){function e(t,r){$1e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:HD,container:this.hot.rootDocument.documentElement},this.eventManager=new kt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return A1e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Xc(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=LE(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||HD,i=!1,a=Wr(this.menuItems,function(d){return d.key===Wh&&(i=!0),QRe(d,r.hot)});if(a.length<1&&!i)a.push(hU()[Wh]);else if(a.length===0)return;a=t0e(a,qe);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ve(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,y,m,b,S,C){return r.menuItemRenderer(v,y,m,b,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,y){r.isAllSubMenusClosed()?n(y.row):r.openSubMenu(y.row)},rowHeights:function(v){return a[v].name===qe?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),zC()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!zC()||!$i(v))&&l&&r.hasSelectedItem()&&(pn()||RE()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new qP(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(M1e),c={group:QU},h=DD(DD({},c),{},{runOnlyIf:function(v){return Jc(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var y=r.openSubMenu(v[0]);y&&y.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(y[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!KRe(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;A(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?GRe(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===qe||l===!0||a}},{key:"setPosition",value:function(r){var n=new mEe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);Sy(r)||Cy(r)||_y(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);Sy(n)||Cy(n)||_y(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(Sy(i)||Cy(i)||_y(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(Sy(i)||Cy(i)||_y(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(b){return xt(b,"submenu")},h=function(b){return new RegExp(qe,"i").test(b.name)},d=function(b){return b.disabled===!0||typeof b.disabled=="function"&&b.disabled.call(s.hot)===!0},v=function(b){return b.disableSelection},y=l;typeof y=="function"&&(y=y.call(this.hot)),Cn(n),te(f,"htItemWrapper"),n.appendChild(f),h(u)?te(n,"htSeparator"):typeof u.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,y))):ul(f,y),d(u)?(te(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(te(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(te(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Le(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(pt(o)&&(o=o.call(this.hot),o===null||mt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),te(i,"htMenu ".concat(this.options.className)),o&&te(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=Ft(n,function(s,u){return s+(u.name===qe?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!mi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!mi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&mi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();gt(JU,Mr);const XP=JU;function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function x1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N1e(n.key),n)}}function D1e(e,t,r){return t&&LD(e.prototype,t),r&&LD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N1e(e){var t=H1e(e,"string");return Ou(t)==="symbol"?t:String(t)}function H1e(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=L1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function L1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function j1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WO(e,t)}function WO(e,t){return WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WO(e,t)}function F1e(e){var t=V1e();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return B1e(this,o)}}function B1e(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ez(e)}function ez(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}var Py="contextMenu",W1e=70;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var tz=function(e){j1e(r,e);var t=F1e(r);function r(n){var o;return x1e(this,r),o=t.call(this,n),o.eventManager=new kt(ez(o)),o.commandExecutor=new uU(o.hot),o.itemsFactory=null,o.menu=null,o}return D1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Py]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Py];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new XP(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),ma(wo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ma(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),ma(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-bs(o.view),a=f-Va(o.view)}else i=-1*bs(this.menu.hotMenu.rootWindow),a=-1*Va(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new dU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Py],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ma(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Py}},{key:"PLUGIN_PRIORITY",get:function(){return W1e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[ob,ib,qe,Nv,Hv,qe,nb,jv,qe,ab,eb,qe,Lv,qe,Xr]}}]),r}(ot);tz.SEPARATOR={name:qe};function U1e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(xT)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function z1e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(HT,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Y1e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(NT,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function G1e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(DT,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function K1e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(LT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function q1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z1e(n.key),n)}}function X1e(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z1e(e){var t=Q1e(e,"string");return md(t)==="symbol"?t:String(t)}function Q1e(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J1e=function(){function e(){q1e(this,e),this.data={}}return X1e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tAe(n.key),n)}}function eAe(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tAe(e){var t=rAe(e,"string");return bd(t)==="symbol"?t:String(t)}function rAe(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var oAe=eAe(function e(){nAe(this,e),this.clipboardData=new J1e});function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function iAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lAe(n.key),n)}}function aAe(e,t,r){return t&&BD(e.prototype,t),r&&BD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lAe(e){var t=sAe(e,"string");return wd(t)==="symbol"?t:String(t)}function sAe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZP=function(){function e(t){iAe(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new kt(this),this.listenersCount=new WeakSet,this.container=t}return aAe(e,[{key:"useSecondaryElement",value:function(){var r=cAe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),VD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),VD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",pn()||sW(this.mainElement)}}]),e}();gt(ZP,Mr);var Wp=new WeakMap;function uAe(e){var t=new ZP(e),r=Wp.get(e);return r=isNaN(r)?0:r,Wp.set(e,r+1),t}function fAe(e){e.eventManager.clear()}var cS=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function VD(e,t,r){e.addEventListener(t,"copy",cS("copy",r)),e.addEventListener(t,"cut",cS("cut",r)),e.addEventListener(t,"paste",cS("paste",r))}var Up=new WeakMap;function cAe(e){var t=Up.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Up.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function WD(e){if(e instanceof ZP){var t=Wp.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),fAe(e),t<=0){t=0;var r=Up.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Up.delete(e.container)),e.mainElement=null}Wp.set(e.container,t)}}function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function hAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vAe(n.key),n)}}function dAe(e,t,r){return t&&UD(e.prototype,t),r&&UD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vAe(e){var t=yAe(e,"string");return Sd(t)==="symbol"?t:String(t)}function yAe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zD(e,t){rz(e,t),t.add(e)}function $l(e,t,r){rz(e,t),t.set(e,r)}function rz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ky(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function mr(e,t){var r=nz(e,t,"get");return gAe(e,r)}function gAe(e,t){return t.get?t.get.call(e):t.value}function Al(e,t,r){var n=nz(e,t,"set");return pAe(e,n,r),r}function nz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function pAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ei=new WeakMap,hS=new WeakMap,ac=new WeakMap,UO=new WeakMap,zO=new WeakMap,lc=new WeakMap,$y=new WeakSet,YD=new WeakSet,mAe=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;hAe(this,e),zD(this,YD),zD(this,$y),$l(this,ei,{writable:!0,value:void 0}),$l(this,hS,{writable:!0,value:void 0}),$l(this,ac,{writable:!0,value:void 0}),$l(this,UO,{writable:!0,value:void 0}),$l(this,zO,{writable:!0,value:void 0}),$l(this,lc,{writable:!0,value:void 0}),Al(this,hS,r),Al(this,ac,n),Al(this,UO,o),Al(this,zO,i),Al(this,lc,a)}return dAe(e,[{key:"setSelectedRange",value:function(r){Al(this,ei,r)}},{key:"getCellsRange",value:function(){if(mr(this,hS).call(this)===0||mr(this,ac).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.row,o=r.col,i=mr(this,ei).getBottomEndCorner(),a=i.row,l=i.col,s=ky(this,YD,bAe).call(this,n,a),u=ky(this,$y,dS).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(mr(this,ac).call(this)===0||mr(this,lc).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.col,o=mr(this,ei).getBottomEndCorner(),i=o.col,a=ky(this,$y,dS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(mr(this,ac).call(this)===0||mr(this,lc).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.col,o=mr(this,ei).getBottomEndCorner(),i=o.col,a=ky(this,$y,dS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-mr(this,lc).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function dS(e,t){return Math.min(t,Math.max(e+mr(this,zO).call(this)-1,e))}function bAe(e,t){return Math.min(t,Math.max(e+mr(this,UO).call(this)-1,e))}function oz(e){var t=[],r=[];return A(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Ce(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);Ce(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function wAe(e,t){return OAe(e)||_Ae(e,t)||CAe(e,t)||SAe()}function SAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CAe(e,t){if(e){if(typeof e=="string")return GD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GD(e,t)}}function GD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Ae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function OAe(e){if(Array.isArray(e))return e}function Ja(e){"@babel/helpers - typeof";return Ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ja(e)}function RAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,az(n.key),n)}}function EAe(e,t,r){return t&&KD(e.prototype,t),r&&KD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=TAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function TAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function PAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YO(e,t)}function kAe(e){var t=AAe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $Ae(this,o)}}function $Ae(e,t){if(t&&(Ja(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pr(e)}function pr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function IAe(e,t){iz(e,t),t.add(e)}function Zi(e,t,r){iz(e,t),t.set(e,r)}function iz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Il(e,t,r){return t=az(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function az(e){var t=MAe(e,"string");return Ja(t)==="symbol"?t:String(t)}function MAe(e,t){if(Ja(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ja(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xAe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Dr(e,t){var r=lz(e,t,"get");return DAe(e,r)}function DAe(e,t){return t.get?t.get.call(e):t.value}function Jn(e,t,r){var n=lz(e,t,"set");return NAe(e,n,r),r}function lz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function NAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");var Ay="copyPaste",HAe=80,LAe=["fragmentSelection"],qD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),vS=new WeakMap,yS=new WeakMap,gS=new WeakMap,Ml=new WeakMap,Iy=new WeakMap,My=new WeakMap,xl=new WeakMap,XD=new WeakSet,jAe=function(e){PAe(r,e);var t=kAe(r);function r(){var n;RAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),IAe(pr(n),XD),Il(pr(n),"columnsLimit",1/0),Il(pr(n),"rowsLimit",1/0),Il(pr(n),"pasteMode","overwrite"),Il(pr(n),"uiContainer",n.hot.rootDocument.body),Zi(pr(n),vS,{writable:!0,value:!1}),Zi(pr(n),yS,{writable:!0,value:!1}),Zi(pr(n),gS,{writable:!0,value:!1}),Zi(pr(n),Ml,{writable:!0,value:"cells-only"}),Zi(pr(n),Iy,{writable:!0,value:!1}),Zi(pr(n),My,{writable:!0,value:!1}),Zi(pr(n),xl,{writable:!0,value:new mAe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Il(pr(n),"copyableRanges",[]),Il(pr(n),"focusableElement",void 0),n}return EAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ay]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[Ay];if(Ja(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Jn(this,vS,!!a.copyColumnHeaders),Jn(this,yS,!!a.copyColumnGroupHeaders),Jn(this,gS,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=uAe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),ba(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ba(So(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&WD(this.focusableElement),ba(So(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Jn(this,Ml,o),Jn(this,Iy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Jn(this,My,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return jc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=oz(o),s=l.rows,u=l.columns;return A(s,function(f){var c=[];A(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new oAe;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){Dr(this,xl).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);Dr(this,Ml)==="column-headers-only"?i.set("headers",Dr(this,xl).getMostBottomColumnHeadersRange()):(Dr(this,Ml)==="with-column-headers"?i.set("headers",Dr(this,xl).getMostBottomColumnHeadersRange()):Dr(this,Ml)==="with-column-group-headers"&&i.set("headers",Dr(this,xl).getAllColumnHeadersRange()),i.set("cells",Dr(this,xl).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,y=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,y=f,m=c,b=f,S=c;s.length<a||y<=d;){var C=this.hot.getCellMeta(y,c),k=C.skipRowOnPaste,O=C.visualRow;if(y=O+1,k!==!0){b=O,m=c;for(var B=[],z=s.length%a;B.length<l||m<=v;){var q=this.hot.getCellMeta(f,m),G=q.skipColumnOnPaste,X=q.visualCol;if(m=X+1,G!==!0){S=X;var Q=B.length%l;B.push(o[z][Q])}}s.push(B)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,b,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,Iy)||this.isEditorOpened())){this.setCopyableText(),Jn(this,Iy,!1);var i=this.getRangedData(this.copyableRanges),a=xAe(this,XD,FAe).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=jc(i);if(o&&o.clipboardData){var u=TO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[qD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Jn(this,Ml,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,My)||this.isEditorOpened())){this.setCopyableText(),Jn(this,My,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=jc(i);if(o&&o.clipboardData){var s=TO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[qD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=Vm(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=wU(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=t$e(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=wAe(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},U1e(this)),Dr(this,vS)&&o.items.push(G1e(this)),Dr(this,yS)&&o.items.push(Y1e(this)),Dr(this,gS)&&o.items.push(z1e(this)),o.items.push(K1e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&iW())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(WD(this.focusableElement),this.focusableElement=null),ba(So(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ay}},{key:"SETTING_KEYS",get:function(){return[Ay].concat(LAe)}},{key:"PLUGIN_PRIORITY",get:function(){return HAe}}]),r}(ot);function FAe(e){for(var t=oz(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function sz(e,t){return"border_row".concat(e,"col").concat(t)}function Cc(){return{width:1,color:"#000"}}function Co(){return{hide:!0}}function BAe(){return{width:1,color:"#000",cornerVisible:!1}}function pS(e){if(ve(e.start)||ve(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ve(e.end)||ve(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function sc(e){return ve(e.start)&&(e.left=e.start),ve(e.end)&&(e.right=e.end),e}function mS(e,t){return{id:sz(e,t),border:BAe(),row:e,col:t,top:Co(),bottom:Co(),start:Co(),end:Co()}}function VAe(e,t){return xt(t,"border")&&t.border&&(e.border=t.border),xt(t,"top")&&ve(t.top)&&(t.top?(Ue(t.top)||(t.top=Cc()),e.top=t.top):(t.top=Co(),e.top=t.top)),xt(t,"bottom")&&ve(t.bottom)&&(t.bottom?(Ue(t.bottom)||(t.bottom=Cc()),e.bottom=t.bottom):(t.bottom=Co(),e.bottom=t.bottom)),xt(t,"start")&&ve(t.start)&&(t.start?(Ue(t.start)||(t.start=Cc()),e.start=t.start):(t.start=Co(),e.start=t.start)),xt(t,"end")&&ve(t.end)&&(t.end?(Ue(t.end)||(t.end=Cc()),e.end=t.end):(t.end=Co(),e.end=t.end)),e}function Wo(e,t){var r=!1;return A(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!xt(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function hb(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function WAe(e){return e.some(function(t){return ve(t.left)||ve(t.right)})}function UAe(e){return e.some(function(t){return ve(t.start)||ve(t.end)})}var zAe=new Map([["left","start"],["right","end"]]);function YAe(e){var t;return(t=zAe.get(e))!==null&&t!==void 0?t:e}function GAe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(oP),n=Wo(this,"bottom");return n&&(r=hb(r)),r},callback:function(r,n){var o=Wo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function KAe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(iP),o=Wo(this,t);return o&&(n=hb(n)),n},callback:function(n,o){var i=Wo(this,t);e.prepareBorder(o,t,i)}}}function qAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(aP)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Wo(this)}}}function XAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(nP),o=Wo(this,t);return o&&(n=hb(n)),n},callback:function(n,o){var i=Wo(this,t);e.prepareBorder(o,t,i)}}}function ZAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(rP),n=Wo(this,"top");return n&&(r=hb(r)),r},callback:function(r,n){var o=Wo(this,"top");e.prepareBorder(n,"top",o)}}}function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function ZD(e,t){return tIe(e)||eIe(e,t)||JAe(e,t)||QAe()}function QAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JAe(e,t){if(e){if(typeof e=="string")return QD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QD(e,t)}}function QD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tIe(e){if(Array.isArray(e))return e}function rIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fz(n.key),n)}}function nIe(e,t,r){return t&&JD(e.prototype,t),r&&JD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=oIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function oIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function iIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function aIe(e){var t=sIe();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lIe(this,o)}}function lIe(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uz(e)}function uz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}function uIe(e,t,r){return t=fz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fz(e){var t=fIe(e,"string");return Ru(t)==="symbol"?t:String(t)}function fIe(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xy="customBorders",cIe=90,hIe=function(e){iIe(r,e);var t=aIe(r);function r(){var n;rIe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),uIe(uz(n),"savedBorders",[]),n}return nIe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),wa(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),wa(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),wa(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=pS(i));var u=wu(o),f=Vh(u);A(o,function(c){for(var h=f(c),d=ZD(h,4),v=d[0],y=d[1],m=d[2],b=d[3],S=function(O){for(var B=function(G){A(l,function(X){a.prepareBorderFromCustomAdded(O,G,s,YAe(X))})},z=y;z<=b;z+=1)B(z)},C=v;C<=m;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=wu(o),l=Vh(a),s=[];return A(o,function(u){for(var f=l(u),c=ZD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=function(C){for(var k=function(z){A(i.savedBorders,function(q){q.row===C&&q.col===z&&s.push(sc(q))})},O=d;O<=y;O+=1)k(O)},b=h;b<=v;b+=1)m(b)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(A(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=mS(o,i);a&&(f=VAe(f,a),A(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",sc(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);Ce(o.from.row,l,function(u){Ce(o.from.col,s,function(f){var c=mS(u,f),h=0;u===o.from.row&&xt(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&xt(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&xt(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&xt(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",sc(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=sz(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=mS(o,i):s=pS(s),l){s[a]=Co();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",sc(s))}}else{s[a]=Cc();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",sc(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;A(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Ce(u.col,f.col,function(c){Ce(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":Ce(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":Ce(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":Ce(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":Ce(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;A(o,function(a){var l=pS(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return Ft(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=We(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;A(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;A(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=We(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):A(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return A(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return ze(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):A(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&ze(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[xy];if(Array.isArray(o)){var i=fr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=WAe(o),a=UAe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[xy]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(tP)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[ZAe(this),XAe(this),GAe(this),KAe(this),qAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){wa(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xy}},{key:"PLUGIN_PRIORITY",get:function(){return cIe}}]),r}(ot);function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function dIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yIe(n.key),n)}}function vIe(e,t,r){return t&&eN(e.prototype,t),r&&eN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yIe(e){var t=gIe(e,"string");return Eu(t)==="symbol"?t:String(t)}function gIe(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=pIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function pIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function mIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KO(e,t)}function bIe(e){var t=SIe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wIe(this,o)}}function wIe(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cz(e)}function cz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}var tN="dragToScroll",CIe=100,_Ie=function(e){mIe(r,e);var t=bIe(r);function r(n){var o;return dIe(this,r),o=t.call(this,n),o.eventManager=new kt(cz(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return vIe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),Sa(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Sa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Sa(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Xc(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!$i(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){Sa(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tN}},{key:"PLUGIN_PRIORITY",get:function(){return CIe}}]),r}(ot);function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function OIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EIe(n.key),n)}}function RIe(e,t,r){return t&&rN(e.prototype,t),r&&rN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EIe(e){var t=TIe(e,"string");return Tu(t)==="symbol"?t:String(t)}function TIe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ca(){return typeof Reflect<"u"&&Reflect.get?Ca=Reflect.get.bind():Ca=function(t,r,n){var o=PIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function PIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function kIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qO(e,t)}function $Ie(e){var t=IIe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return AIe(this,o)}}function AIe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hz(e)}function hz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");var bS="dropdownMenu",MIe=230,wS="changeType",dz=function(e){kIe(r,e);var t=$Ie(r);function r(n){var o;return OIe(this,r),o=t.call(this,n),o.eventManager=new kt(hz(o)),o.commandExecutor=new uU(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return RIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[bS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new dU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[bS],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),Ca(Ro(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new XP(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ca(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Ca(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,wS)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(wS));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=wS,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Ca(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bS}},{key:"PLUGIN_PRIORITY",get:function(){return MIe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Nv,Hv,qe,jv,qe,Jm,qe,Lv,qe,Xr]}}]),r}(ot);dz.SEPARATOR={name:qe};function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function xIe(e,t){return LIe(e)||HIe(e,t)||NIe(e,t)||DIe()}function DIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NIe(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function LIe(e){if(Array.isArray(e))return e}function jIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BIe(n.key),n)}}function FIe(e,t,r){return t&&oN(e.prototype,t),r&&oN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BIe(e){var t=VIe(e,"string");return Cd(t)==="symbol"?t:String(t)}function VIe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WIe=function(){function e(t){jIe(this,e),this.hot=t,this.options={}}return FIe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return Ce(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(Ce(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();Ce(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();Ce(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=xIe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const UIe=WIe;function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function zIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GIe(n.key),n)}}function YIe(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GIe(e){var t=KIe(e,"string");return _d(t)==="symbol"?t:String(t)}function KIe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qIe=function(){function e(t,r){zIe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return YIe(e,[{key:"_mergeOptions",value:function(r){var n=Sr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=zt(Sr(e.DEFAULT_OPTIONS),n),n=zt(n,r),n.filename=IE(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const XIe=qIe;function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function ZIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JIe(n.key),n)}}function QIe(e,t,r){return t&&aN(e.prototype,t),r&&aN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JIe(e){var t=eMe(e,"string");return Pu(t)==="symbol"?t:String(t)}function eMe(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XO(e,t)}function rMe(e){var t=iMe();return function(){var n=zp(e),o;if(t){var i=zp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nMe(this,o)}}function nMe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oMe(e)}function oMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zp(e){return zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zp(e)}var aMe=String.fromCharCode(13),lMe=String.fromCharCode(34),sMe=String.fromCharCode(10),uMe=function(e){tMe(r,e);var t=rMe(r);function r(){return ZIe(this,r),t.apply(this,arguments)}return QIe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=We(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),A(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Dt(o);return a!==""&&(i||a.indexOf(aMe)>=0||a.indexOf(lMe)>=0||a.indexOf(sMe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(XIe);const fMe=uMe;function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function cMe(e,t,r){return t=hMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hMe(e){var t=dMe(e,"string");return Od(t)==="symbol"?t:String(t)}function dMe(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vMe="csv",ZO=cMe({},vMe,fMe);function yMe(e,t,r){return typeof ZO[e]=="function"?new ZO[e](t,r):null}function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function gMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mMe(n.key),n)}}function pMe(e,t,r){return t&&lN(e.prototype,t),r&&lN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mMe(e){var t=bMe(e,"string");return ku(t)==="symbol"?t:String(t)}function bMe(e,t){if(ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QO(e,t)}function QO(e,t){return QO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QO(e,t)}function SMe(e){var t=OMe();return function(){var n=Yp(e),o;if(t){var i=Yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CMe(this,o)}}function CMe(e,t){if(t&&(ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Me(e)}function _Me(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yp(e){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yp(e)}var RMe="exportFile",EMe=240,TMe=function(e){wMe(r,e);var t=SMe(r);function r(){return gMe(this,r),t.apply(this,arguments)}return pMe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ZO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return yMe(o,new UIe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return RMe}},{key:"PLUGIN_PRIORITY",get:function(){return EMe}}]),r}(ot);function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function PMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Me(n.key),n)}}function kMe(e,t,r){return t&&sN(e.prototype,t),r&&sN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Me(e){var t=AMe(e,"string");return Rd(t)==="symbol"?t:String(t)}function AMe(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vz=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;PMe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new qm)}return kMe(e,[{key:"reset",value:function(){A(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();gt(vz,Mr);const db=vz;var Ed={};function Mi(e,t){if(!Ed[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Ed[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function _a(e){if(!Ed[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Ed[e].descriptor}function qt(e,t,r){r.key=e,Ed[e]={condition:t,descriptor:r}}var rr="none";function IMe(){return!0}qt(rr,IMe,{name:Zm,inputsCount:0,showOperators:!1});var Fc="empty";function MMe(e){return Xt(e.value)}qt(Fc,MMe,{name:dP,inputsCount:0,showOperators:!0});var Pg="not_empty";function xMe(e,t){return!Mi(Fc,t)(e)}qt(Pg,xMe,{name:vP,inputsCount:0,showOperators:!0});function DMe(e,t){return jMe(e)||LMe(e,t)||HMe(e,t)||NMe()}function NMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HMe(e,t){if(e){if(typeof e=="string")return uN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uN(e,t)}}function uN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jMe(e){if(Array.isArray(e))return e}var Bc="eq";function FMe(e,t){var r=DMe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale)===Dt(n)}qt(Bc,FMe,{name:yP,inputsCount:1,showOperators:!0});var kg="neq";function BMe(e,t){return!Mi(Bc,t)(e)}qt(kg,BMe,{name:gP,inputsCount:1,showOperators:!0});function VMe(e,t){return YMe(e)||zMe(e,t)||UMe(e,t)||WMe()}function WMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UMe(e,t){if(e){if(typeof e=="string")return fN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fN(e,t)}}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function YMe(e){if(Array.isArray(e))return e}var yz="gt";function GMe(e,t){var r=VMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}qt(yz,GMe,{name:SP,inputsCount:1,showOperators:!0});function KMe(e,t){return QMe(e)||ZMe(e,t)||XMe(e,t)||qMe()}function qMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XMe(e,t){if(e){if(typeof e=="string")return cN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cN(e,t)}}function cN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function QMe(e){if(Array.isArray(e))return e}var gz="gte";function JMe(e,t){var r=KMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}qt(gz,JMe,{name:CP,inputsCount:1,showOperators:!0});function exe(e,t){return oxe(e)||nxe(e,t)||rxe(e,t)||txe()}function txe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rxe(e,t){if(e){if(typeof e=="string")return hN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hN(e,t)}}function hN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function oxe(e){if(Array.isArray(e))return e}var pz="lt";function ixe(e,t){var r=exe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}qt(pz,ixe,{name:_P,inputsCount:1,showOperators:!0});function axe(e,t){return fxe(e)||uxe(e,t)||sxe(e,t)||lxe()}function lxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sxe(e,t){if(e){if(typeof e=="string")return dN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dN(e,t)}}function dN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function fxe(e){if(Array.isArray(e))return e}var mz="lte";function cxe(e,t){var r=axe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}qt(mz,cxe,{name:OP,inputsCount:1,showOperators:!0});function hxe(e,t){return gxe(e)||yxe(e,t)||vxe(e,t)||dxe()}function dxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vxe(e,t){if(e){if(typeof e=="string")return vN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vN(e,t)}}function vN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gxe(e){if(Array.isArray(e))return e}var QP="date_after";function pxe(e,t){var r=hxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}qt(QP,pxe,{name:TP,inputsCount:1,showOperators:!0});function mxe(e,t){return Cxe(e)||Sxe(e,t)||wxe(e,t)||bxe()}function bxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wxe(e,t){if(e){if(typeof e=="string")return yN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yN(e,t)}}function yN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Cxe(e){if(Array.isArray(e))return e}var JP="date_before";function _xe(e,t){var r=mxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}qt(JP,_xe,{name:PP,inputsCount:1,showOperators:!0});function Oxe(e,t){return Pxe(e)||Txe(e,t)||Exe(e,t)||Rxe()}function Rxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Exe(e,t){if(e){if(typeof e=="string")return gN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gN(e,t)}}function gN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Txe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Pxe(e){if(Array.isArray(e))return e}var Gp="between";function kxe(e,t){var r=Oxe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=Mi(JP,[a]),f=Mi(QP,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}qt(Gp,kxe,{name:RP,inputsCount:2,showOperators:!0});var bz="not_between";function $xe(e,t){return!Mi(Gp,t)(e)}qt(bz,$xe,{name:EP,inputsCount:2,showOperators:!0});function Axe(e,t){return Dxe(e)||xxe(e,t)||Mxe(e,t)||Ixe()}function Ixe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mxe(e,t){if(e){if(typeof e=="string")return pN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pN(e,t)}}function pN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Dxe(e){if(Array.isArray(e))return e}var wz="begins_with";function Nxe(e,t){var r=Axe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Dt(n))}qt(wz,Nxe,{name:pP,inputsCount:1,showOperators:!0});var Hxe=$e,Sz=hv,Lxe=zn.f,jxe=nl,mN=Kt,Fxe=bE,Bxe=Ar,Vxe=wE,bN=Sz("".endsWith),Wxe=Sz("".slice),Uxe=Math.min,Cz=Vxe("endsWith"),zxe=!Cz&&!!function(){var e=Lxe(String.prototype,"endsWith");return e&&!e.writable}();Hxe({target:"String",proto:!0,forced:!zxe&&!Cz},{endsWith:function(t){var r=mN(Bxe(this));Fxe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:Uxe(jxe(n),o),a=mN(t);return bN?bN(r,a,i):Wxe(r,i-a.length,i)===a}});function Yxe(e,t){return Xxe(e)||qxe(e,t)||Kxe(e,t)||Gxe()}function Gxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kxe(e,t){if(e){if(typeof e=="string")return wN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wN(e,t)}}function wN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Xxe(e){if(Array.isArray(e))return e}var _z="ends_with";function Zxe(e,t){var r=Yxe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Dt(n))}qt(_z,Zxe,{name:mP,inputsCount:1,showOperators:!0});function Qxe(e,t){return rDe(e)||tDe(e,t)||eDe(e,t)||Jxe()}function Jxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eDe(e,t){if(e){if(typeof e=="string")return SN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SN(e,t)}}function SN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rDe(e){if(Array.isArray(e))return e}var ek="contains";function nDe(e,t){var r=Qxe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Dt(n))>=0}qt(ek,nDe,{name:bP,inputsCount:1,showOperators:!0});var Oz="not_contains";function oDe(e,t){return!Mi(ek,t)(e)}qt(Oz,oDe,{name:wP,inputsCount:1,showOperators:!0});var Rz="date_tomorrow";function iDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}qt(Rz,iDe,{name:$P,inputsCount:0});var Ez="date_today";function aDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().startOf("day"),"d"):!1}qt(Ez,aDe,{name:kP,inputsCount:0});var Tz="date_yesterday";function lDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}qt(Tz,lDe,{name:AP,inputsCount:0});XV();function sDe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var JO=new Set([1]).has(1),uDe=JO&&typeof Array.from=="function";function Bv(e){var t=e;return JO&&(t=new Set(t)),function(r){var n;return JO?n=t.has(r):n=!!~t.indexOf(r),n}}function Pz(e){return e??""}function eR(e){var t=e;return uDe?t=Array.from(new Set(t)):t=CE(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function CN(e,t,r,n){var o=[],i=e===t,a;return i||(a=Bv(t)),A(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:sDe(l,r)};n&&n(u),o.push(u)}),o}function kz(e,t){return dDe(e)||hDe(e,t)||cDe(e,t)||fDe()}function fDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cDe(e,t){if(e){if(typeof e=="string")return _N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _N(e,t)}}function _N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dDe(e){if(Array.isArray(e))return e}var Oa="by_value";function vDe(e,t){var r=kz(t,1),n=r[0];return n(e.value)}qt(Oa,vDe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=kz(t,1),n=r[0];return[Bv(n)]},showOperators:!1});var Td={};function yDe(e){if(!Td[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Td[e].func;return function(r,n){return t(r,n)}}function gDe(e){return Td[e].name}function tk(e,t,r){Td[e]={name:t,func:r}}var Ci="conjunction",pDe=xP;function mDe(e,t){return e.every(function(r){return r.func(t)})}tk(Ci,pDe,mDe);var Kp="disjunction",bDe=Qm;function wDe(e,t){return e.some(function(r){return r.func(t)})}tk(Kp,bDe,wDe);var rk="disjunctionWithExtraCondition",SDe=Qm;function CDe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}tk(rk,SDe,CDe);function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}var uc;function SS(e,t,r){return t=_De(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _De(e){var t=ODe(e,"string");return Pd(t)==="symbol"?t:String(t)}function ODe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RDe="numeric",$z="text",EDe="date",ON=(uc={},SS(uc,RDe,[rr,qe,Fc,Pg,qe,Bc,kg,qe,yz,gz,pz,mz,Gp,bz]),SS(uc,$z,[rr,qe,Fc,Pg,qe,Bc,kg,qe,wz,_z,qe,ek,Oz]),SS(uc,EDe,[rr,qe,Fc,Pg,qe,Bc,kg,qe,JP,QP,Gp,qe,Rz,Ez,Tz]),uc);function TDe(e){var t=[],r=e;return ON[r]||(r=$z),A(ON[r],function(n){var o;n===qe?o={name:qe}:o=Sr(_a(n)),t.push(o)}),t}function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function PDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$De(n.key),n)}}function kDe(e,t,r){return t&&RN(e.prototype,t),r&&RN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $De(e){var t=ADe(e,"string");return kd(t)==="symbol"?t:String(t)}function ADe(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CS="built",_S="building",EN=["click","input","keydown","keypress","keyup","focus","blur","change"],Az=function(){function e(t,r){PDe(this,e),this.hot=t,this.eventManager=new kt(this),this.options=zt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return kDe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===_S?this._element:this.buildState===CS?(this.update(),this._element):(this.buildState=_S,this.build(),this.buildState=CS,this._element)}},{key:"isBuilt",value:function(){return this.buildState===CS}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Or)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=_S),this.options.className&&te(this._element,this.options.className),this.options.children.length)A(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);ze(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),A(EN,function(i){return n(o,i)})}else A(EN,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Sr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();gt(Az,Mr);const _i=Az;function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function IDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xDe(n.key),n)}}function MDe(e,t,r){return t&&TN(e.prototype,t),r&&TN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xDe(e){var t=DDe(e,"string");return $u(t)==="symbol"?t:String(t)}function DDe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $g(){return typeof Reflect<"u"&&Reflect.get?$g=Reflect.get.bind():$g=function(t,r,n){var o=NDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$g.apply(this,arguments)}function NDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Au(e),e!==null););return e}function HDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function LDe(e){var t=FDe();return function(){var n=Au(e),o;if(t){var i=Au(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jDe(this,o)}}function jDe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iz(e)}function Iz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Au(e){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Au(e)}var Dy=new WeakMap,BDe=function(e){HDe(r,e);var t=LDe(r);function r(n,o){var i;return IDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Dy.set(Iz(i),{}),i.registerHooks(),i}return MDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){$g(Au(r.prototype),"build",this).call(this);var o=Dy.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,te(this._element,"htUIInput"),te(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Dy.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&Dy.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return Sr({placeholder:"",type:"text",tagName:"input"})}}]),r}(_i);const as=BDe;function Iu(e){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(e)}function VDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UDe(n.key),n)}}function WDe(e,t,r){return t&&PN(e.prototype,t),r&&PN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UDe(e){var t=zDe(e,"string");return Iu(t)==="symbol"?t:String(t)}function zDe(e,t){if(Iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ls(){return typeof Reflect<"u"&&Reflect.get?ls=Reflect.get.bind():ls=function(t,r,n){var o=YDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ls.apply(this,arguments)}function YDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oi(e),e!==null););return e}function GDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rR(e,t)}function KDe(e){var t=XDe();return function(){var n=Oi(e),o;if(t){var i=Oi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qDe(this,o)}}function qDe(e,t){if(t&&(Iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mz(e)}function Mz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oi(e){return Oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oi(e)}var Ny=new WeakMap,ZDe=function(e){GDe(r,e);var t=KDe(r);function r(n,o){var i;return VDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Ny.set(Mz(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return WDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return A(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;ls(Oi(r.prototype),"build",this).call(this),this.menu=new XP(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new _i(this.hot,{className:"htUISelectCaption"}),a=new _i(this.hot,{className:"htUISelectDropdown"}),l=Ny.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,A([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(Zm),Ny.get(this).captionElement.textContent=o,ls(Oi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==qe&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=Ny.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),ls(Oi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUISelect",wrapIt:!1})}}]),r}(_i);const kN=ZDe;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function QDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eNe(n.key),n)}}function JDe(e,t,r){return t&&$N(e.prototype,t),r&&$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eNe(e){var t=tNe(e,"string");return Mu(t)==="symbol"?t:String(t)}function tNe(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ag(){return typeof Reflect<"u"&&Reflect.get?Ag=Reflect.get.bind():Ag=function(t,r,n){var o=rNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ag.apply(this,arguments)}function rNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function nNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nR(e,t)}function oNe(e){var t=lNe();return function(){var n=xu(e),o;if(t){var i=xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iNe(this,o)}}function iNe(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aNe(e)}function aNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}var sNe=function(e){nNe(r,e);var t=oNe(r);function r(n,o){var i;return QDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new kN(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new as(i.hot,{placeholder:FP})),i.elements.push(new as(i.hot,{placeholder:BP})),i.registerHooks(),i}return JDe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),A(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=Sr(o.command);a.name.startsWith(Ht)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),A(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||_a(rr),i=[];return A(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=_a(o?o.name:rr);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||A(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof kN})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof as})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&te(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[_a(rr)];if(o!==null){var a=o.visualIndex;i=TDe(this.hot.getDataType(0,a,this.hot.countRows(),a))}A(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),Ag(xu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){A(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){ps(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),wn(o)):ps(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wn(o))}}]),r}(db);const OS=sNe;function Du(e){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function uNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cNe(n.key),n)}}function fNe(e,t,r){return t&&AN(e.prototype,t),r&&AN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cNe(e){var t=hNe(e,"string");return Du(t)==="symbol"?t:String(t)}function hNe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ig(){return typeof Reflect<"u"&&Reflect.get?Ig=Reflect.get.bind():Ig=function(t,r,n){var o=dNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ig.apply(this,arguments)}function dNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Nu(e),e!==null););return e}function vNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function yNe(e){var t=pNe();return function(){var n=Nu(e),o;if(t){var i=Nu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gNe(this,o)}}function gNe(e,t){if(t&&(Du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xz(e)}function xz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nu(e){return Nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nu(e)}var Hy=new WeakMap,mNe=function(e){vNe(r,e);var t=yNe(r);function r(n,o){var i;return uNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Hy.set(xz(i),{}),i}return fNe(r,[{key:"build",value:function(){Ig(Nu(r.prototype),"build",this).call(this);var o=Hy.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Hy.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Hy.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Sr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(_i);const IN=mNe;function Hu(e){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}var MN;function bNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function wNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CNe(n.key),n)}}function SNe(e,t,r){return t&&xN(e.prototype,t),r&&xN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CNe(e){var t=_Ne(e,"string");return Hu(t)==="symbol"?t:String(t)}function _Ne(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ONe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iR(e,t)}function iR(e,t){return iR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iR(e,t)}function RNe(e){var t=PNe();return function(){var n=qp(e),o;if(t){var i=qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ENe(this,o)}}function ENe(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TNe(e)}function TNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qp(e){return qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qp(e)}var DN=0,kNe=function(e){ONe(r,e);var t=RNe(r);function r(n,o){var i;return wNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return SNe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[Ci,Kp];A(i,function(a){var l=new IN(o.hot,{name:"operator",label:{htmlFor:a,textContent:gDe(a)},value:a,checked:a===i[DN],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(dt(MN||(MN=bNe(["Radio button with index "," doesn't exist."])),o));A(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof IN&&i.isChecked()});return o?o.getValue():Ci}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&A(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ci,i=arguments.length>1?arguments[1]:void 0,a=o;a===rk&&(a=Kp),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(DN)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(db);const $Ne=kNe;var ANe=Ye,INe=Ar,NN=Kt,MNe=/"/g,xNe=ANe("".replace),DNe=function(e,t,r,n){var o=NN(INe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+xNe(NN(n),MNe,"&quot;")+'"'),i+">"+o+"</"+t+">"},NNe=je,HNe=function(e){return NNe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},LNe=$e,jNe=DNe,FNe=HNe;LNe({target:"String",proto:!0,forced:FNe("link")},{link:function(t){return jNe(this,"a","href",t)}});function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}function BNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WNe(n.key),n)}}function VNe(e,t,r){return t&&HN(e.prototype,t),r&&HN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WNe(e){var t=UNe(e,"string");return Lu(t)==="symbol"?t:String(t)}function UNe(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mg(){return typeof Reflect<"u"&&Reflect.get?Mg=Reflect.get.bind():Mg=function(t,r,n){var o=zNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mg.apply(this,arguments)}function zNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ju(e),e!==null););return e}function YNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aR(e,t)}function GNe(e){var t=qNe();return function(){var n=ju(e),o;if(t){var i=ju(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return KNe(this,o)}}function KNe(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dz(e)}function Dz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ju(e){return ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ju(e)}var RS=new WeakMap,XNe=function(e){YNe(r,e);var t=GNe(r);function r(n,o){var i;return BNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),RS.set(Dz(i),{}),i}return VNe(r,[{key:"build",value:function(){Mg(ju(r.prototype),"build",this).call(this);var o=RS.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(RS.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Sr({href:"#",tagName:"a"})}}]),r}(_i);const LN=XNe;function Fu(e){"@babel/helpers - typeof";return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}function jN(e){return eHe(e)||JNe(e)||QNe(e)||ZNe()}function ZNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QNe(e,t){if(e){if(typeof e=="string")return lR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lR(e,t)}}function JNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eHe(e){if(Array.isArray(e))return lR(e)}function lR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nHe(n.key),n)}}function rHe(e,t,r){return t&&FN(e.prototype,t),r&&FN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nHe(e){var t=oHe(e,"string");return Fu(t)==="symbol"?t:String(t)}function oHe(e,t){if(Fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ss(){return typeof Reflect<"u"&&Reflect.get?ss=Reflect.get.bind():ss=function(t,r,n){var o=iHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ss.apply(this,arguments)}function iHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ri(e),e!==null););return e}function aHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function lHe(e){var t=uHe();return function(){var n=Ri(e),o;if(t){var i=Ri(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sHe(this,o)}}function sHe(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nz(e)}function Nz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ri(e){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ri(e)}var fHe=new WeakMap,cHe="multipleSelect.itemBox",hHe=function(e){aHe(r,e);var t=lHe(r);function r(n,o){var i;return tHe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),fHe.set(Nz(i),{}),i.searchInput=new as(i.hot,{placeholder:jP,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new LN(i.hot,{textContent:DP,className:"htUISelectAll"}),i.clearAllUI=new LN(i.hot,{textContent:NP,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return rHe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return jN(this.items)}},{key:"getValue",value:function(){return vHe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;ss(Ri(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new _i(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),te(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,y,m,b,S,C){v.title=C.instance.getDataAtRowProp(y,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Jt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:cHe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(dHe(this.items,this.options.value)),ss(Ri(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,ss(Ri(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=jN(this.items):l=Wr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=jE(ps,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(wn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(IO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(IO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUIMultipleSelect",value:[]})}}]),r}(_i);const BN=hHe;function dHe(e,t){var r=Bv(t);return We(e,function(n){return n.checked=r(n.value),n})}function vHe(e){var t=[];return A(e,function(r){r.checked&&t.push(r.value)}),t}function Bu(e){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}function yHe(e,t){return bHe(e)||mHe(e,t)||pHe(e,t)||gHe()}function gHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pHe(e,t){if(e){if(typeof e=="string")return VN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VN(e,t)}}function VN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bHe(e){if(Array.isArray(e))return e}function wHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CHe(n.key),n)}}function SHe(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CHe(e){var t=_He(e,"string");return Bu(t)==="symbol"?t:String(t)}function _He(e,t){if(Bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xg(){return typeof Reflect<"u"&&Reflect.get?xg=Reflect.get.bind():xg=function(t,r,n){var o=OHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xg.apply(this,arguments)}function OHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vu(e),e!==null););return e}function RHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function EHe(e){var t=kHe();return function(){var n=Vu(e),o;if(t){var i=Vu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return THe(this,o)}}function THe(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PHe(e)}function PHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vu(e){return Vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vu(e)}var $He=function(e){RHe(r,e);var t=EHe(r);function r(n,o){var i;return wHe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new BN(i.hot)),i.registerHooks(),i}return SHe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===Oa){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?rr:Oa},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Wr(u,function(B){return B.name===Oa}),v=yHe(d,1),y=v[0],m={},b=i.hot.getTranslatedPhrase(Bp);if(y){var S=eR(We(c(s,h),function(B){return B.value}));f&&(y.args[0]=f);var C=[],k=CN(S,y.args[0],b,function(B){B.checked&&C.push(B.value)}),O=o.editedConditionStack.column;m.locale=i.hot.getCellMeta(0,O).locale,m.args=[C],m.command=_a(Oa),m.itemsSnapshot=k}else m.args=[],m.command=_a(rr);i.state.setValueAtIndex(s,m)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof BN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(Bp),i=eR(this._getColumnVisibleValues()),a=CN(i,i,o);this.getMultipleSelectElement().setItems(a),xg(Vu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){ps(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:We(this.hot.getDataAtCol(o.visualIndex),function(i){return Pz(i)})}}]),r}(db);const AHe=$He;function Wu(e){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}function IHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xHe(n.key),n)}}function MHe(e,t,r){return t&&UN(e.prototype,t),r&&UN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xHe(e){var t=DHe(e,"string");return Wu(t)==="symbol"?t:String(t)}function DHe(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fR(e,t)}function fR(e,t){return fR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fR(e,t)}function HHe(e){var t=FHe();return function(){var n=Xp(e),o;if(t){var i=Xp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LHe(this,o)}}function LHe(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jHe(e)}function jHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xp(e){return Xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xp(e)}var BHe=function(e){NHe(r,e);var t=HHe(r);function r(n,o){var i;return IHe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new as(i.hot,{type:"button",value:HP,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new as(i.hot,{type:"button",value:LP,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return MHe(r,[{key:"registerHooks",value:function(){var o=this;A(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(db);const VHe=BHe;function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}var zN,YN;function GN(e,t){return YHe(e)||zHe(e,t)||UHe(e,t)||WHe()}function WHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UHe(e,t){if(e){if(typeof e=="string")return KN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KN(e,t)}}function KN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function YHe(e){if(Array.isArray(e))return e}function qN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function GHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qHe(n.key),n)}}function KHe(e,t,r){return t&&XN(e.prototype,t),r&&XN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qHe(e){var t=XHe(e,"string");return $d(t)==="symbol"?t:String(t)}function XHe(e,t){if($d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZN="ConditionCollection.filteringStates",Hz=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;GHe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new qm,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(ZN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return KHe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ci;return r.length?yDe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ci,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=We(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(dt(zN||(zN=qN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(mt(Td[o]))throw new Error(dt(YN||(YN=qN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:Mi(s,l)}]},i):f.push({name:s,args:l,func:Mi(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=GN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Ft(this.filteringStates.getEntries(),function(r,n){var o=GN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:We(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),A(r,function(o){A(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(ZN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();gt(Hz,Mr);const Lz=Hz;function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function ZHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JHe(n.key),n)}}function QHe(e,t,r){return t&&QN(e.prototype,t),r&&QN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JHe(e){var t=eLe(e,"string");return Ad(t)==="symbol"?t:String(t)}function eLe(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tLe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};ZHe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return QHe(e,[{key:"filter",value:function(){var r=this,n=[];return A(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return A(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return A(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const jz=tLe;function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function rLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oLe(n.key),n)}}function nLe(e,t,r){return t&&JN(e.prototype,t),r&&JN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oLe(e){var t=iLe(e,"string");return Id(t)==="symbol"?t:String(t)}function iLe(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fz=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};rLe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return nLe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,A(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=yW(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new Lz(o.hot,!1),y=[].concat(c,d);v.importAllConditions(y);var m=o.columnDataFactory(h),b;v.isEmpty()?b=m:b=new jz(v,function(C){return o.columnDataFactory(C)}).filter(),b=We(b,function(C){return C.meta.visualRow});var S=Bv(b);return v.destroy(),Wr(m,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;A(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),ze(this,function(n,o){r[o]=null})}}]),e}();gt(Fz,Mr);const aLe=Fz;function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}var eH;function lLe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function sLe(e,t){return hLe(e)||cLe(e,t)||fLe(e,t)||uLe()}function uLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fLe(e,t){if(e){if(typeof e=="string")return tH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tH(e,t)}}function tH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hLe(e){if(Array.isArray(e))return e}function dLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yLe(n.key),n)}}function vLe(e,t,r){return t&&rH(e.prototype,t),r&&rH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yLe(e){var t=gLe(e,"string");return Uu(t)==="symbol"?t:String(t)}function gLe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function us(){return typeof Reflect<"u"&&Reflect.get?us=Reflect.get.bind():us=function(t,r,n){var o=pLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},us.apply(this,arguments)}function pLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ei(e),e!==null););return e}function mLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}function cR(e,t){return cR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cR(e,t)}function bLe(e){var t=SLe();return function(){var n=Ei(e),o;if(t){var i=Ei(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wLe(this,o)}}function wLe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bz(e)}function Bz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ei(e)}var nH="filters",CLe=250,_Le=function(e){mLe(r,e);var t=bLe(r);function r(n){var o;return dLe(this,r),o=t.call(this,n),o.eventManager=new kt(Bz(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return vLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Dv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(IP),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(MP),":")};if(!this.components.get("filter_by_condition")){var f=new OS(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new $Ne(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new OS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new AHe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new VHe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Lz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new aLe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),us(Ei(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}us(Ei(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ci,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=We(i.filter(),function(h){return h.meta.visualRow});var c=Bv(l);Ce(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),A(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return A(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,y=c.visualRow,m=c.type,b=c.instance,S=c.dateFormat,C=c.locale,k=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:y,type:m,instance:b,dateFormat:S,locale:C},value:Pz(k)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&A(o,function(a){var l=sLe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=eR(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:qe}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Kp&&i.command.key!==rr&&a.command.key!==rr&&l.command.key!==rr?s=rk:l.command.key!==rr&&(i.command.key===rr||a.command.key===rr)&&(s=Ci),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==rr&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==rr&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==rr&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===OS&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?te(i,"htFiltersActive"):Le(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new jz(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===Oa}),f=l.filter(function(h){return h.name!==Oa});if(u.length>=2||f.length>=3)wt(dt(eH||(eH=lLe([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return A(l,function(u){A(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),us(Ei(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nH}},{key:"PLUGIN_PRIORITY",get:function(){return CLe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ot);function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function oH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Vc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oH(Object(r),!0).forEach(function(n){OLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OLe(e,t,r){return t=RLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RLe(e){var t=ELe(e,"string");return Md(t)==="symbol"?t:String(t)}function ELe(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vz="internal-use-in-handsontable",hR={licenseKey:Vz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Wz(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[ar])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Uz(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function TLe(e){var t,r=e[ar],n=Uz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=Wz(e);return Vc(Vc(Vc({},hR),n),o)}function PLe(e){var t,r=e[ar],n=Uz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=Wz(e);return Vc(Vc({},n),o)}function kLe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var iH;function $Le(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function dR(e){"@babel/helpers - typeof";return dR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dR(e)}function vb(){var e="engine_relationship",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function nk(){var e="shared_engine_usage",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function ALe(e){var t=e.getSettings(),r=t[ar],n=r==null?void 0:r.engine;if(r===!0||mt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return ILe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(dR(n)==="object"&&mt(n.hyperformula)){var i=vb(),a=nk().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Vz}),(n.getConfig().leapYear1900!==hR.leapYear1900||Lm(n.getConfig().nullDate,hR.nullDate)===!1)&&wt(dt(iH||(iH=$Le(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function ILe(e,t,r){var n=t[ar],o=TLe(t),i=vb(),a=nk();MLe(e,n.functions),xLe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),DLe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function aH(e){var t,r=vb(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function lH(e,t){if(e){var r=vb(),n=r.get(e),o=nk(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function MLe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){wt(a.message)}})}function xLe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){wt(n.message)}}}function DLe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){wt(l.message)}}),e.resumeEvaluation())}function NLe(e,t){return(mt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var zz="DD/MM/YYYY";function Yz(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function HLe(e){return Yz(e)?e.substr(1):e}function LLe(e){return typeof e=="string"&&e.startsWith("=")}function ES(e,t){return typeof e=="string"&&t==="date"}function sH(e,t){return ee(e,t,!0).isValid()}function uH(e,t){return ee(e,t,!0).format(zz)}function jLe(e,t){return ee(e,zz,!0).format(t)}function fH(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return ee(n).format(t)}function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function FLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VLe(n.key),n)}}function BLe(e,t,r){return t&&cH(e.prototype,t),r&&cH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VLe(e){var t=WLe(e,"string");return xd(t)==="symbol"?t:String(t)}function WLe(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qi(e,t,r){ULe(e,t),t.set(e,r)}function ULe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _t(e,t){var r=Gz(e,t,"get");return zLe(e,r)}function zLe(e,t){return t.get?t.get.call(e):t.value}function ti(e,t,r){var n=Gz(e,t,"set");return YLe(e,n,r),r}function Gz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function YLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var fc=new WeakMap,ri=new WeakMap,Nr=new WeakMap,Ly=new WeakMap,TS=new WeakMap,PS=new WeakMap,jy=new WeakMap,GLe=function(){function e(t,r,n){FLe(this,e),Qi(this,fc,{writable:!0,value:void 0}),Qi(this,ri,{writable:!0,value:void 0}),Qi(this,Nr,{writable:!0,value:void 0}),Qi(this,Ly,{writable:!0,value:[]}),Qi(this,TS,{writable:!0,value:[]}),Qi(this,PS,{writable:!0,value:void 0}),Qi(this,jy,{writable:!0,value:[]}),ti(this,fc,t),ti(this,ri,r),ti(this,Nr,n)}return BLe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return ti(this,jy,r.map(function(o){var i=_t(n,ri).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),_t(this,jy)}},{key:"getRemovedHfIndexes",value:function(){return _t(this,jy)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=_t(this,ri).getIndexesSequence(),o=_t(this,ri).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(ur(_t(this,fc)),"s");_t(this,Nr).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&_t(n,Nr).getEngine()[i](_t(n,Nr).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(ti(this,TS,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),ti(this,PS,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=_t(this,ri).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!_t(this,Nr).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(_t(this,TS),_t(this,PS)));_t(this,Nr).getSheetId()===null?_t(this,Nr).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(ur(_t(this,fc)),"Order");return function(o){if(!_t(r,Nr).isPerformingUndoRedo()){var i=_t(r,ri).getIndexesSequence();if(o==="update"){var a=_t(r,Ly).map(function(c){return i.indexOf(c)}),l=_t(r,Nr).getEngine().getSheetDimensions(_t(r,Nr).getSheetId()),s;_t(r,fc)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);_t(r,Nr).getEngine()[n](_t(r,Nr).getSheetId(),a)}ti(r,Ly,i)}}}},{key:"init",value:function(){ti(this,Ly,_t(this,ri).getIndexesSequence())}}]),e}();const hH=GLe;function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function KLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XLe(n.key),n)}}function qLe(e,t,r){return t&&dH(e.prototype,t),r&&dH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XLe(e){var t=ZLe(e,"string");return Dd(t)==="symbol"?t:String(t)}function ZLe(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ji(e,t,r){QLe(e,t),t.set(e,r)}function QLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eo(e,t){var r=Kz(e,t,"get");return JLe(e,r)}function JLe(e,t){return t.get?t.get.call(e):t.value}function ea(e,t,r){var n=Kz(e,t,"set");return eje(e,n,r),r}function Kz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function eje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Fy=new WeakMap,By=new WeakMap,kS=new WeakMap,$S=new WeakMap,AS=new WeakMap,IS=new WeakMap,MS=new WeakMap,tje=function(){function e(t,r,n){KLe(this,e),Ji(this,Fy,{writable:!0,value:void 0}),Ji(this,By,{writable:!0,value:void 0}),Ji(this,kS,{writable:!0,value:void 0}),Ji(this,$S,{writable:!0,value:!1}),Ji(this,AS,{writable:!0,value:!1}),Ji(this,IS,{writable:!0,value:null}),Ji(this,MS,{writable:!0,value:null}),ea(this,Fy,new hH("row",t,this)),ea(this,By,new hH("column",r,this)),ea(this,kS,n)}return qLe(e,[{key:"getForAxis",value:function(r){return r==="row"?eo(this,Fy):eo(this,By)}},{key:"setPerformUndo",value:function(r){ea(this,$S,r)}},{key:"setPerformRedo",value:function(r){ea(this,AS,r)}},{key:"isPerformingUndoRedo",value:function(){return eo(this,$S)||eo(this,AS)}},{key:"getSheetId",value:function(){return eo(this,MS)}},{key:"getEngine",value:function(){return eo(this,IS)}},{key:"getPostponeAction",value:function(){return eo(this,kS)}},{key:"setupSyncEndpoint",value:function(r,n){ea(this,IS,r),ea(this,MS,n),eo(this,Fy).init(),eo(this,By).init()}}]),e}();const rje=tje;function nje(e){return aje(e)||ije(e)||qz(e)||oje()}function oje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ije(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aje(e){if(Array.isArray(e))return vR(e)}function xi(e){"@babel/helpers - typeof";return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(e)}function Dl(e,t){return uje(e)||sje(e,t)||qz(e,t)||lje()}function lje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qz(e,t){if(e){if(typeof e=="string")return vR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vR(e,t)}}function vR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function uje(e){if(Array.isArray(e))return e}function fje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xz(n.key),n)}}function cje(e,t,r){return t&&vH(e.prototype,t),r&&vH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ra(){return typeof Reflect<"u"&&Reflect.get?Ra=Reflect.get.bind():Ra=function(t,r,n){var o=hje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ra.apply(this,arguments)}function hje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function dje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yR(e,t)}function yR(e,t){return yR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yR(e,t)}function vje(e){var t=gje();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yje(this,o)}}function yje(e,t){if(t&&(xi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nn(e)}function Nn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}function Nl(e,t,r){return t=Xz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xz(e){var t=pje(e,"string");return xi(t)==="symbol"?t:String(t)}function pje(e,t){if(xi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xS(e,t,r){mje(e,t),t.set(e,r)}function mje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ni(e,t,r){var n=Zz(e,t,"set");return bje(e,n,r),r}function bje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Hl(e,t){var r=Zz(e,t,"get");return wje(e,r)}function Zz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function wje(e,t){return t.get?t.get.call(e):t.value}var ar="formulas",Sje=["maxRows","maxColumns","language"],Cje=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");var Ll=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},to=new WeakMap,DS=new WeakMap,cc=new WeakMap,_je=function(e){dje(r,e);var t=vje(r);function r(){var n;fje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),xS(Nn(n),to,{writable:!0,value:!1}),xS(Nn(n),DS,{writable:!0,value:!1}),xS(Nn(n),cc,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Nl(Nn(n),"staticRegister",on("formulas")),Nl(Nn(n),"engine",null),Nl(Nn(n),"sheetName",null),Nl(Nn(n),"indexSyncer",null),Nl(Nn(n),"rowAxisSyncer",null),Nl(Nn(n),"columnAxisSyncer",null),n}return cje(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ar]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=ALe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){wt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new rje(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),Hl(this,cc).forEach(function(l){var s=Dl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),Ra(Eo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;Hl(this,cc).forEach(function(i){var a=Dl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),lH(this.engine,this.hot),this.engine=null,Ra(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=PLe(this.hot.getSettings());kLe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[ar];if(ve(a)&&ve(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[ar].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}Ra(Eo(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;Hl(this,cc).forEach(function(i){var a,l=Dl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),ni(this,cc,null),lH(this.engine,this.hot),this.engine=null,Ra(Eo(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ve(i)&&!EU(i))return wt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return wt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return wt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){NE("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(ur(ar),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),aH(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,y=h.sheet;return ve(y)?"".concat(y,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ve(d)===!1||ve(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=l(u);if(y!==void 0&&!s.has(m)){var b=aH(i.engine).get(y);if(!b)return;b.validateCell(b.getDataAtCell(d,v),b.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){wt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return ES(a,s.type)&&(sH(a,s.dateFormat)?a=uH(a,s.dateFormat):LLe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&wr(f)&&(f=fH(f,u.dateFormat)),xi(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,y=d.col,m=a.getBottomEndCorner(),b=m.row,S=m.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},k={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(b),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(k)===!1)return!1;for(var O=this.engine.getFillRangeData(C,k),B=C.start,z=B.row,q=B.col,G=C.end,X=G.row,Q=G.col,oe=X-z+1,J=Q-q+1,ue=0;ue<O.length;ue+=1)for(var he=0;he<O[ue].length;he+=1){var Oe=O[ue][he],we=ue%oe,$=he%J,P=this.hot.getCellMeta(we,$);ES(Oe,P.type)&&(Oe.startsWith("'")?O[ue][he]=Oe.slice(1):this.isFormulaCellType(we,$,this.sheetId)===!1&&(O[ue][he]=jLe(Oe,P.dateFormat)))}return O}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ur(ar))||ni(this,DS,mt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;ES(u,c.type)&&(a=!0,sH(u,h)?i[s][f]=uH(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(ni(this,to,!0),this.engine.setSheetContent(this.sheetId,i),ni(this,to,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ur(ar)))if(this.sheetName=NLe(this.engine,this.hot.getSettings()[ar].sheetName),Hl(this,DS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){ni(this,to,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),ni(this,to,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||Hl(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){Yz(a.value)&&(a.value=HLe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&wr(h)&&(h=fH(h,d.dateFormat));var v=xi(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||Hl(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!Ll(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Dl(f,4),h=c[0],d=c[1],v=c[3],y=a.hot.propToCol(d),m=a.hot.toPhysicalRow(h),b=a.hot.toPhysicalColumn(y),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:a.sheetId};m!==null&&b!==null?a.syncChangeWithEngine(h,y,v):l.push([h,y,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Dl(c,3),d=h[0],v=h[1],y=h[2];a.syncChangeWithEngine(d,v,y)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!Ll(i)){var l=[],s=[];o.forEach(function(u){var f=Dl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(wr(v)){var y={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(y)){wt("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),l.push.apply(l,nje(a.engine.setCellContents(y,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!Ll(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!Ll(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!Ll(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!Ll(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;ni(this,to,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());ni(this,to,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return ar}},{key:"PLUGIN_PRIORITY",get:function(){return Cje}},{key:"SETTING_KEYS",get:function(){return[ar].concat(Sje)}}]),r}(ot);function Oje(e,t){return Pje(e)||Tje(e,t)||Eje(e,t)||Rje()}function Rje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eje(e,t){if(e){if(typeof e=="string")return yH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yH(e,t)}}function yH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Pje(e){if(Array.isArray(e))return e}function kje(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=Oje(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(uP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Vy(e){return Mje(e)||Ije(e)||Aje(e)||$je()}function $je(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aje(e,t){if(e){if(typeof e=="string")return gR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gR(e,t)}}function Ije(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mje(e){if(Array.isArray(e))return gR(e)}function gR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xje(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(fP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Vy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Vy(c.slice(0,a)));else if(u===null)h.push.apply(h,Vy(c.slice(0,this.countCols())));else{var m=this.countCols()-1,b=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===b&&m>l&&h.push.apply(h,Vy(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function Dje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hje(n.key),n)}}function Nje(e,t,r){return t&&gH(e.prototype,t),r&&gH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hje(e){var t=Lje(e,"string");return zu(t)==="symbol"?t:String(t)}function Lje(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ea(){return typeof Reflect<"u"&&Reflect.get?Ea=Reflect.get.bind():Ea=function(t,r,n){var o=jje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ea.apply(this,arguments)}function jje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function Fje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pR(e,t)}function pR(e,t){return pR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pR(e,t)}function Bje(e){var t=Wje();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vje(this,o)}}function Vje(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mR(e)}function mR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}function pH(e,t,r){Uje(e,t),t.set(e,r)}function Uje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(e,t){var r=Qz(e,t,"get");return zje(e,r)}function zje(e,t){return t.get?t.get.call(e):t.value}function hc(e,t,r){var n=Qz(e,t,"set");return Yje(e,n,r),r}function Qz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Yje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");var NS="hiddenColumns",Gje=310,An=new WeakMap,In=new WeakMap,Kje=function(e){Fje(r,e);var t=Bje(r);function r(){var n;Dje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),pH(mR(n),An,{writable:!0,value:{}}),pH(mR(n),In,{writable:!0,value:null}),n}return Nje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[NS];Ue(i)&&(hc(this,An,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),hc(this,In,new Km),Hr(this,In).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Hr(this,In)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Ea(To(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ea(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),hc(this,An,{}),Ea(To(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Hr(this,In).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualColumn(y)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Hr(this,In).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){Hr(i,In).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return We(Hr(this,In).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Hr(this,In).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Hr(this,An).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Hr(this,An).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Hr(this,An).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Hr(this,An).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},kje(this),xje(this))}},{key:"onMapInit",value:function(){Array.isArray(Hr(this,An).columns)&&this.hideColumns(Hr(this,An).columns)}},{key:"destroy",value:function(){hc(this,An,null),hc(this,In,null),Ea(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NS}},{key:"PLUGIN_PRIORITY",get:function(){return Gje}}]),r}(ot);function qje(e,t){return Jje(e)||Qje(e,t)||Zje(e,t)||Xje()}function Xje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zje(e,t){if(e){if(typeof e=="string")return mH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mH(e,t)}}function mH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Jje(e){if(Array.isArray(e))return e}function eFe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=qje(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(cP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Wy(e){return oFe(e)||nFe(e)||rFe(e)||tFe()}function tFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rFe(e,t){if(e){if(typeof e=="string")return bR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bR(e,t)}}function nFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oFe(e){if(Array.isArray(e))return bR(e)}function bR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iFe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(hP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Wy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Wy(c.slice(0,a)));else if(u===null)h.push.apply(h,Wy(c.slice(0,this.countRows())));else{var m=this.countRows()-1,b=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===b&&m>l&&h.push.apply(h,Wy(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function aFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sFe(n.key),n)}}function lFe(e,t,r){return t&&bH(e.prototype,t),r&&bH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sFe(e){var t=uFe(e,"string");return Yu(t)==="symbol"?t:String(t)}function uFe(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ta(){return typeof Reflect<"u"&&Reflect.get?Ta=Reflect.get.bind():Ta=function(t,r,n){var o=fFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ta.apply(this,arguments)}function fFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function cFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wR(e,t)}function wR(e,t){return wR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wR(e,t)}function hFe(e){var t=vFe();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dFe(this,o)}}function dFe(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SR(e)}function SR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}function wH(e,t,r){yFe(e,t),t.set(e,r)}function yFe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(e,t){var r=Jz(e,t,"get");return gFe(e,r)}function gFe(e,t){return t.get?t.get.call(e):t.value}function dc(e,t,r){var n=Jz(e,t,"set");return pFe(e,n,r),r}function Jz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function pFe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");var HS="hiddenRows",mFe=320,ro=new WeakMap,Mn=new WeakMap,bFe=function(e){cFe(r,e);var t=hFe(r);function r(){var n;aFe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),wH(SR(n),ro,{writable:!0,value:{}}),wH(SR(n),Mn,{writable:!0,value:null}),n}return lFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[HS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[HS];Ue(i)&&(dc(this,ro,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),dc(this,Mn,new Km),qr(this,Mn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,qr(this,Mn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Ta(Po(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ta(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),dc(this,ro,{}),Ta(Po(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=qr(this,Mn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualRow(y)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&qr(this,Mn).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){qr(i,Mn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return We(qr(this,Mn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return qr(this,Mn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(qr(this,ro).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(qr(this,ro).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!qr(this,ro).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},eFe(this),iFe(this))}},{key:"onMapInit",value:function(){Array.isArray(qr(this,ro).rows)&&this.hideRows(qr(this,ro).rows)}},{key:"destroy",value:function(){dc(this,ro,null),dc(this,Mn,null),Ta(Po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return HS}},{key:"PLUGIN_PRIORITY",get:function(){return mFe}}]),r}(ot);function wFe(e,t){return OFe(e)||_Fe(e,t)||CFe(e,t)||SFe()}function SFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CFe(e,t){if(e){if(typeof e=="string")return SH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(e,t)}}function SH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Fe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function OFe(e){if(Array.isArray(e))return e}function RFe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(jT)},callback:function(r,n){var o=wFe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function EFe(e,t){return $Fe(e)||kFe(e,t)||PFe(e,t)||TFe()}function TFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PFe(e,t){if(e){if(typeof e=="string")return CH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CH(e,t)}}function CH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $Fe(e){if(Array.isArray(e))return e}function AFe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(FT)},callback:function(r,n){var o=EFe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Gu(e){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function IFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xFe(n.key),n)}}function MFe(e,t,r){return t&&_H(e.prototype,t),r&&_H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xFe(e){var t=DFe(e,"string");return Gu(t)==="symbol"?t:String(t)}function DFe(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fs(){return typeof Reflect<"u"&&Reflect.get?fs=Reflect.get.bind():fs=function(t,r,n){var o=NFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fs.apply(this,arguments)}function NFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ti(e),e!==null););return e}function HFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CR(e,t)}function CR(e,t){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CR(e,t)}function LFe(e){var t=FFe();return function(){var n=Ti(e),o;if(t){var i=Ti(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jFe(this,o)}}function jFe(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eY(e)}function eY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ti(e){return Ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ti(e)}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");var OH="manualColumnFreeze",BFe=110,vc=new WeakMap,VFe=function(e){HFe(r,e);var t=LFe(r);function r(n){var o;return IFe(this,r),o=t.call(this,n),vc.set(eY(o),{afterFirstUse:!1}),o}return MFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[OH]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),fs(Ti(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=vc.get(this);o.afterFirstUse=!1,fs(Ti(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fs(Ti(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=vc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=vc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},RFe(this),AFe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=vc.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return OH}},{key:"PLUGIN_PRIORITY",get:function(){return BFe}}]),r}(ot);function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}function WFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zFe(n.key),n)}}function UFe(e,t,r){return t&&RH(e.prototype,t),r&&RH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zFe(e){var t=YFe(e,"string");return Nd(t)==="symbol"?t:String(t)}function YFe(e,t){if(Nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LS=0,EH=1,TH=2,jl="px",GFe=function(){function e(t){WFe(this,e),this.hot=t,this._element=null,this.state=LS,this.inlineProperty=t.isRtl()?"right":"left"}return UFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=TH}},{key:"build",value:function(){this.state===LS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=EH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=LS}},{key:"isAppended",value:function(){return this.state===TH}},{key:"isBuilt",value:function(){return this.state>=EH}},{key:"setPosition",value:function(r,n){wr(r)&&(this._element.style.top=r+jl),wr(n)&&(this._element.style[this.inlineProperty]=n+jl)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){wr(r)&&(this._element.style.width=r+jl),wr(n)&&(this._element.style.height=n+jl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){wr(r)&&(this._element.style.marginTop=r+jl),wr(n)&&(this._element.style["margin".concat(ur(this.inlineProperty))]=n+jl)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ur(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const tY=GFe;function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function KFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XFe(n.key),n)}}function qFe(e,t,r){return t&&PH(e.prototype,t),r&&PH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XFe(e){var t=ZFe(e,"string");return Ku(t)==="symbol"?t:String(t)}function ZFe(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dg(){return typeof Reflect<"u"&&Reflect.get?Dg=Reflect.get.bind():Dg=function(t,r,n){var o=QFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dg.apply(this,arguments)}function QFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qu(e),e!==null););return e}function JFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_R(e,t)}function _R(e,t){return _R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_R(e,t)}function eBe(e){var t=nBe();return function(){var n=qu(e),o;if(t){var i=qu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tBe(this,o)}}function tBe(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rBe(e)}function rBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qu(e){return qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qu(e)}var oBe="ht__manualColumnMove--backlight",iBe=function(e){JFe(r,e);var t=eBe(r);function r(){return KFe(this,r),t.apply(this,arguments)}return qFe(r,[{key:"build",value:function(){Dg(qu(r.prototype),"build",this).call(this),te(this._element,oBe)}}]),r}(tY);const aBe=iBe;function Xu(e){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xu(e)}function lBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uBe(n.key),n)}}function sBe(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uBe(e){var t=fBe(e,"string");return Xu(t)==="symbol"?t:String(t)}function fBe(e,t){if(Xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ng(){return typeof Reflect<"u"&&Reflect.get?Ng=Reflect.get.bind():Ng=function(t,r,n){var o=cBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ng.apply(this,arguments)}function cBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zu(e),e!==null););return e}function hBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OR(e,t)}function OR(e,t){return OR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},OR(e,t)}function dBe(e){var t=gBe();return function(){var n=Zu(e),o;if(t){var i=Zu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vBe(this,o)}}function vBe(e,t){if(t&&(Xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yBe(e)}function yBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zu(e){return Zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zu(e)}var pBe="ht__manualColumnMove--guideline",mBe=function(e){hBe(r,e);var t=dBe(r);function r(){return lBe(this,r),t.apply(this,arguments)}return sBe(r,[{key:"build",value:function(){Ng(Zu(r.prototype),"build",this).call(this),te(this._element,pBe)}}]),r}(tY);const bBe=mBe;function Qu(e){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}function wBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CBe(n.key),n)}}function SBe(e,t,r){return t&&$H(e.prototype,t),r&&$H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CBe(e){var t=_Be(e,"string");return Qu(t)==="symbol"?t:String(t)}function _Be(e,t){if(Qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pa(){return typeof Reflect<"u"&&Reflect.get?Pa=Reflect.get.bind():Pa=function(t,r,n){var o=OBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pa.apply(this,arguments)}function OBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function RBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RR(e,t)}function RR(e,t){return RR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RR(e,t)}function EBe(e){var t=PBe();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TBe(this,o)}}function TBe(e,t){if(t&&(Qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ER(e)}function ER(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");var jS="manualColumnMove",kBe=120,oi=new WeakMap,AH="ht__manualColumnMove",Uy="show-ui",FS="on-moving--columns",BS="after-selection--columns",$Be=function(e){RBe(r,e);var t=EBe(r);function r(n){var o;return wBe(this,r),o=t.call(this,n),oi.set(ER(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new kt(ER(o)),o.backlight=new aBe(n),o.guideline=new bBe(n),o}return SBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,AH),Pa(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Pa(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,AH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Pa(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=oi.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=oi.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[jS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Ce(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=oi.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,y=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,b=ht(this.hot.rootElement),S=m.innerWidth-o.rootElementOffset-b;y=m.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else y=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=y){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var k=y,O=u;y+d+h>=f?k=f-d-h:y+h<c+v&&(k=c+v+Math.abs(h)),u>=f-1?O=f-1:O===0?O=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(O-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,k),this.guideline.setPosition(null,O)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=oi.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Le(this.hot.rootElement,[FS,Uy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=f.from,m=f.to,b=Math.min(y.col,m.col),S=Math.max(y.col,m.col);if(i.row<0&&i.col>=b&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(b,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Ut(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,k=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,O=i.col<c.fixedColumnsStart,B=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),z=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),q=this.getColumnsWidth(b,i.col-1)+z,G=this.getColumnsWidth(C,b-1)+(O?B:0)+q;this.backlight.setPosition(k,G),this.backlight.setSize(this.getColumnsWidth(b,S),s.hider.offsetHeight-k),this.backlight.setOffset(null,-q),te(this.hot.rootElement,FS)}else Le(this.hot.rootElement,BS),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=oi.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=oi.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Le(this.hot.rootElement,Uy):te(this.hot.rootElement,Uy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=oi.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,Le(this.hot.rootElement,[FS,Uy,BS]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,BS),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Pa(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jS}},{key:"PLUGIN_PRIORITY",get:function(){return kBe}}]),r}(ot);function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function ABe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MBe(n.key),n)}}function IBe(e,t,r){return t&&IH(e.prototype,t),r&&IH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MBe(e){var t=xBe(e,"string");return Ju(t)==="symbol"?t:String(t)}function xBe(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(){return typeof Reflect<"u"&&Reflect.get?ka=Reflect.get.bind():ka=function(t,r,n){var o=DBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ka.apply(this,arguments)}function DBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function NBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TR(e,t)}function TR(e,t){return TR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},TR(e,t)}function HBe(e){var t=jBe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LBe(this,o)}}function LBe(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PR(e)}function PR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}var zy="manualColumnResize",FBe=130,MH="manualColumnWidths",VS=new WeakMap,BBe=function(e){NBe(r,e);var t=HBe(r);function r(n){var o;ABe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new kt(PR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,VS.set(PR(o),{config:void 0}),te(o.handle,"manualColumnResizer"),te(o.guide,"manualColumnResizerGuide"),o}return IBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[zy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Li,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),ka($o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ka($o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=VS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),ka($o(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",MH,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",MH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=VS.get(this),a=this.hot.getSettings()[zy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Pt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();A(v,function(y){var m=y.getTopStartCorner().col,b=y.getBottomEndCorner().col;Ce(m,b,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Pt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!pi(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!DE(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,A(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[zy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){ka($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zy}},{key:"PLUGIN_PRIORITY",get:function(){return FBe}}]),r}(ot);function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}function VBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UBe(n.key),n)}}function WBe(e,t,r){return t&&xH(e.prototype,t),r&&xH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UBe(e){var t=zBe(e,"string");return Hd(t)==="symbol"?t:String(t)}function zBe(e,t){if(Hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WS=0,DH=1,NH=2,Fl="px",YBe=function(){function e(t){VBe(this,e),this.hot=t,this._element=null,this.state=WS}return WBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=NH}},{key:"build",value:function(){this.state===WS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=DH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=WS}},{key:"isAppended",value:function(){return this.state===NH}},{key:"isBuilt",value:function(){return this.state>=DH}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Fl),n!==void 0&&(this._element.style.left=n+Fl)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Fl),n&&(this._element.style.height=n+Fl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Fl),n&&(this._element.style.marginLeft=n+Fl)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const rY=YBe;function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function GBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qBe(n.key),n)}}function KBe(e,t,r){return t&&HH(e.prototype,t),r&&HH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qBe(e){var t=XBe(e,"string");return ef(t)==="symbol"?t:String(t)}function XBe(e,t){if(ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hg(){return typeof Reflect<"u"&&Reflect.get?Hg=Reflect.get.bind():Hg=function(t,r,n){var o=ZBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hg.apply(this,arguments)}function ZBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tf(e),e!==null););return e}function QBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kR(e,t)}function kR(e,t){return kR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kR(e,t)}function JBe(e){var t=rVe();return function(){var n=tf(e),o;if(t){var i=tf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return eVe(this,o)}}function eVe(e,t){if(t&&(ef(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tVe(e)}function tVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tf(e){return tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tf(e)}var nVe="ht__manualRowMove--backlight",oVe=function(e){QBe(r,e);var t=JBe(r);function r(){return GBe(this,r),t.apply(this,arguments)}return KBe(r,[{key:"build",value:function(){Hg(tf(r.prototype),"build",this).call(this),te(this._element,nVe)}}]),r}(rY);const iVe=oVe;function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function aVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sVe(n.key),n)}}function lVe(e,t,r){return t&&LH(e.prototype,t),r&&LH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sVe(e){var t=uVe(e,"string");return rf(t)==="symbol"?t:String(t)}function uVe(e,t){if(rf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lg(){return typeof Reflect<"u"&&Reflect.get?Lg=Reflect.get.bind():Lg=function(t,r,n){var o=fVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Lg.apply(this,arguments)}function fVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nf(e),e!==null););return e}function cVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$R(e,t)}function $R(e,t){return $R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$R(e,t)}function hVe(e){var t=yVe();return function(){var n=nf(e),o;if(t){var i=nf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dVe(this,o)}}function dVe(e,t){if(t&&(rf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vVe(e)}function vVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nf(e){return nf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nf(e)}var gVe="ht__manualRowMove--guideline",pVe=function(e){cVe(r,e);var t=hVe(r);function r(){return aVe(this,r),t.apply(this,arguments)}return lVe(r,[{key:"build",value:function(){Lg(nf(r.prototype),"build",this).call(this),te(this._element,gVe)}}]),r}(rY);const mVe=pVe;function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function bVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SVe(n.key),n)}}function wVe(e,t,r){return t&&jH(e.prototype,t),r&&jH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SVe(e){var t=CVe(e,"string");return of(t)==="symbol"?t:String(t)}function CVe(e,t){if(of(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $a(){return typeof Reflect<"u"&&Reflect.get?$a=Reflect.get.bind():$a=function(t,r,n){var o=_Ve(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$a.apply(this,arguments)}function _Ve(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function OVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AR(e,t)}function AR(e,t){return AR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AR(e,t)}function RVe(e){var t=TVe();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return EVe(this,o)}}function EVe(e,t){if(t&&(of(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IR(e)}function IR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");var US="manualRowMove",PVe=140,ii=new WeakMap,FH="ht__manualRowMove",Yy="show-ui",zS="on-moving--rows",YS="after-selection--rows",kVe=function(e){OVe(r,e);var t=RVe(r);function r(n){var o;return bVe(this,r),o=t.call(this,n),ii.set(IR(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new kt(IR(o)),o.backlight=new iVe(n),o.guideline=new mVe(n),o}return wVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[US]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,FH),$a(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),$a(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,FH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),$a(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=ii.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=ii.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[US];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return Ce(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=ii.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Ut(c),d=Wa(c),v=u.holder.scrollTop,y;this.hot.rootWindow===d?y=d.scrollY:y=d.scrollTop;var m=h.top-y,b=o.target.eventPageY-m+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,k=this.backlight.getOffset().top,O=this.backlight.getSize().height,B=f.offsetHeight/2,z=f.offsetHeight,q=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),G=b>=q+B;this.isFixedRowTop(i.row)&&(q+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:G?(o.target.row=i.row+1,q+=i.row===0?z-1:z):o.target.row=i.row;var X=b,Q=q;b+O+k>=S?X=S-O-k:b+k<C&&(X=C+Math.abs(k)),q>=S-1&&(Q=S-1),this.backlight.setPosition(X),this.guideline.setPosition(Q)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=ii.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Le(this.hot.rootElement,[zS,Yy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&y&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var m=h.from,b=h.to,S=Math.min(m.row,b.row),C=Math.max(m.row,b.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var k=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,k),this.backlight.setSize(u.hider.offsetWidth-k,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),te(this.hot.rootElement,zS),this.refreshPositions()}else Le(this.hot.rootElement,YS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ii.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ii.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Le(this.hot.rootElement,Yy):te(this.hot.rootElement,Yy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ii.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Le(this.hot.rootElement,[zS,Yy,YS]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,YS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),$a(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return US}},{key:"PLUGIN_PRIORITY",get:function(){return PVe}}]),r}(ot);function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function $Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IVe(n.key),n)}}function AVe(e,t,r){return t&&BH(e.prototype,t),r&&BH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IVe(e){var t=MVe(e,"string");return af(t)==="symbol"?t:String(t)}function MVe(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aa(){return typeof Reflect<"u"&&Reflect.get?Aa=Reflect.get.bind():Aa=function(t,r,n){var o=xVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Aa.apply(this,arguments)}function xVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function DVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MR(e,t)}function MR(e,t){return MR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MR(e,t)}function NVe(e){var t=LVe();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HVe(this,o)}}function HVe(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xR(e)}function xR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}var Gy="manualRowResize",jVe=30,VH="manualRowHeights",GS=new WeakMap,FVe=function(e){DVe(r,e);var t=NVe(r);function r(n){var o;$Ve(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new kt(xR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,GS.set(xR(o),{config:void 0}),te(o.handle,"manualRowResizer"),te(o.guide,"manualRowResizerGuide"),o}return AVe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Gy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Li,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),Aa(Io(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Aa(Io(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=GS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Aa(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",VH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",VH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,zW.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=ht(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var m=this.hot.getSelectedRange();A(m,function(b){var S=b.getTopStartCorner().row,C=b.getBottomStartCorner().row;Ce(S,C,function(k){i.selectedRows.includes(k)||i.selectedRows.push(k)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(ht(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=pi(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!DE(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),A(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[Gy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=GS.get(this),a=this.hot.getSettings()[Gy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){Aa(Io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Gy}},{key:"PLUGIN_PRIORITY",get:function(){return jVe}}]),r}(ot);function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}var WH,UH,zH,YH;function Ky(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function BVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WVe(n.key),n)}}function VVe(e,t,r){return t&&GH(e.prototype,t),r&&GH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WVe(e){var t=UVe(e,"string");return Ld(t)==="symbol"?t:String(t)}function UVe(e,t){if(Ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zVe=function(){function e(t,r,n,o,i,a){BVe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return VVe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return dt(WH||(WH=Ky(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return dt(UH||(UH=Ky(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return dt(zH||(zH=Ky(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return dt(YH||(YH=Ky(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const Ln=zVe;function DR(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}var KH;function YVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qH(e){return XVe(e)||qVe(e)||KVe(e)||GVe()}function GVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KVe(e,t){if(e){if(typeof e=="string")return NR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NR(e,t)}}function qVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XVe(e){if(Array.isArray(e))return NR(e)}function NR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JVe(n.key),n)}}function QVe(e,t,r){return t&&XH(e.prototype,t),r&&XH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JVe(e){var t=eWe(e,"string");return jd(t)==="symbol"?t:String(t)}function eWe(e,t){if(jd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tWe=function(){function e(t){ZVe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return QVe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return A(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return A(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return A(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new Ln(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(wt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];A(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,A(o,function(a,l){Ce(0,a.rowspan-1,function(s){Ce(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),A(o,function(a){DR.apply(void 0,qH(a))}),A(i,function(a){DR.apply(void 0,qH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return A(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}A(this.mergedCells,function(l){l.shift(a,n)}),ip(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return dt(KH||(KH=YVe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const rWe=tWe;function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function ta(e,t){return aWe(e)||iWe(e,t)||oWe(e,t)||nWe()}function nWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oWe(e,t){if(e){if(typeof e=="string")return ZH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZH(e,t)}}function ZH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aWe(e){if(Array.isArray(e))return e}function lWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uWe(n.key),n)}}function sWe(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uWe(e){var t=fWe(e,"string");return Fd(t)==="symbol"?t:String(t)}function fWe(e,t){if(Fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cWe=function(){function e(t){lWe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return sWe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=ta(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,y=Math.floor(l/v)*v,m=l-y,b=this.getFarthestCollection(r,n,o,i);if(b){if(o==="down"){var S=b.row+b.rowspan-u-m,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=m:a[2]+=m?S:0}else if(o==="right"){var k=b.col+b.colspan-f-m,O=a[3]+k;O>=this.plugin.hot.countCols()?a[3]-=m:a[3]+=m?k:0}else if(o==="up"){var B=c-m-b.row+1,z=a[0]+B;z<0?a[0]+=m:a[0]-=m?B:0}else if(o==="left"){var q=h-m-b.col+1,G=a[1]+q;G<0?a[1]+=m:a[1]-=m?q:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),zt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=ta(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ta(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=ta(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ta(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=ta(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),y=c?u-l+1:f-s+1,m=Math.floor(v/y)*y,b=v-m,S=null,C=null,k=null;switch(o){case"up":S="includesVertically",k=h-b+1;break;case"left":S="includesHorizontally",k=h-b+1;break;case"down":S="includesVertically",k=d+b-1;break;case"right":S="includesHorizontally",k=d+b-1;break}return A(i,function(O){O[S](k)&&O.isFarther(C,o)&&(C=O)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return A(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=ta(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const hWe=cWe;function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function dWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yWe(n.key),n)}}function vWe(e,t,r){return t&&JH(e.prototype,t),r&&JH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yWe(e){var t=gWe(e,"string");return Bd(t)==="symbol"?t:String(t)}function gWe(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pWe=function(){function e(t){dWe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return vWe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const mWe=pWe;function bWe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(VT)}return this.getTranslatedPhrase(BT)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Ln.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function wWe(e,t){return _We(e)||CWe(e,t)||nY(e,t)||SWe()}function SWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _We(e){if(Array.isArray(e))return e}function OWe(e){return TWe(e)||EWe(e)||nY(e)||RWe()}function RWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nY(e,t){if(e){if(typeof e=="string")return HR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HR(e,t)}}function EWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TWe(e){if(Array.isArray(e))return HR(e)}function HR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$We(n.key),n)}}function kWe(e,t,r){return t&&eL(e.prototype,t),r&&eL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $We(e){var t=AWe(e,"string");return lf(t)==="symbol"?t:String(t)}function AWe(e,t){if(lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cs(){return typeof Reflect<"u"&&Reflect.get?cs=Reflect.get.bind():cs=function(t,r,n){var o=IWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cs.apply(this,arguments)}function IWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pi(e),e!==null););return e}function MWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LR(e,t)}function LR(e,t){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LR(e,t)}function xWe(e){var t=NWe();return function(){var n=Pi(e),o;if(t){var i=Pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DWe(this,o)}}function DWe(e,t){if(t&&(lf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oY(e)}function oY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pi(e)}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");var _c="mergeCells",HWe=150,tL=new WeakMap,rL=_c,LWe=function(e){MWe(r,e);var t=xWe(r);function r(n){var o;return PWe(this,r),o=t.call(this,n),tL.set(oY(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return kWe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[_c]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new rWe(this),this.autofillCalculations=new hWe(this),this.selectionCalculations=new mWe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),cs(Pi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),cs(Pi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[_c];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),cs(Pi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(_E()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=OWe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=ws(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=ws(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(Ln.containsNegativeValues(o)?(wt(Ln.NEGATIVE_VALUES_WARNING(o)),i=!1):Ln.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(wt(Ln.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Ln.isSingleCell(o)?(wt(Ln.IS_SINGLE_CELL(o)),i=!1):Ln.containsZeroSpan(o)&&(wt(Ln.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(A(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),Ce(l.row,l.row+l.rowspan-1,function(c){Ce(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Ce(0,f.rowspan-1,function(v){Ce(0,f.colspan-1,function(y){var m=null;c[v]||(c[v]=[]),v===0&&y===0?m=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+y,"hidden",!0),c[v][y]=m})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),A(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),Ce(0,s.rowspan-1,function(u){Ce(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[_c]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:rL})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(rL)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=tL.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var y=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:y.row-u.row,col:y.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=Sr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=Sr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=Sr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),A(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},bWe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ue(l)?Sr(l):void 0;if(Ue(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,y=s.rowspan,m=this.translateMergedCellToRenderable(h,y,d,v),b=wWe(m,2),S=b[0],C=b[1],k=f.getRenderableFromVisualIndex(i),O=c.getRenderableFromVisualIndex(a),B=S-k+1,z=C-O+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,B),s.colspan=Math.min(s.colspan,z)}DR(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);A(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,y=l.col===0;(s&&h||u&&d||c&&v||f&&y)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return _c}},{key:"PLUGIN_PRIORITY",get:function(){return HWe}}]),r}(ot);function nL(e){return VWe(e)||BWe(e)||FWe(e)||jWe()}function jWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FWe(e,t){if(e){if(typeof e=="string")return oL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oL(e,t)}}function oL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VWe(e){if(Array.isArray(e))return e}function WWe(e,t){return function(r,n){var o=nL(r),i=o.slice(1),a=nL(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:J2(c.type),m=y(f,c,v)(h,d);if(m===Vn){var b=u+1;if(typeof t[b]<"u")return s(b)}return m}(0)}}var iL;function UWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aL(){wt(dt(iL||(iL=UWe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var iY="sort";function zWe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(iY,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function YWe(e){var t=e.className.split(" "),r=new RegExp("^".concat(iY,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function GWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qWe(n.key),n)}}function KWe(e,t,r){return t&&lL(e.prototype,t),r&&lL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qWe(e){var t=XWe(e,"string");return sf(t)==="symbol"?t:String(t)}function XWe(e,t){if(sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jr(){return typeof Reflect<"u"&&Reflect.get?jr=Reflect.get.bind():jr=function(t,r,n){var o=ZWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jr.apply(this,arguments)}function ZWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=br(e),e!==null););return e}function QWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jR(e,t)}function jR(e,t){return jR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jR(e,t)}function JWe(e){var t=r2e();return function(){var n=br(e),o;if(t){var i=br(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return e2e(this,o)}}function e2e(e,t){if(t&&(sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t2e(e)}function t2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},br(e)}var FR="multiColumnSorting",n2e=170,o2e="append",sL="columnSorting";Q2(FR,WWe);var i2e=function(e){QWe(r,e);var t=JWe(r);function r(n){var o;return GWe(this,r),o=t.call(this,n),o.pluginKey=FR,o}return KWe(r,[{key:"isEnabled",value:function(){return jr(br(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sL]&&aL(),jr(br(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){jr(br(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){jr(br(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){jr(br(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return jr(br(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return jr(br(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){jr(br(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=jr(br(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),Le(o,YWe(o)),this.enabled!==!1&&te(o,zWe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sL]&&aL(),jr(br(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){vO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,o2e))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return FR}},{key:"PLUGIN_PRIORITY",get:function(){return n2e}}]),r}(tU);function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function a2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s2e(n.key),n)}}function l2e(e,t,r){return t&&uL(e.prototype,t),r&&uL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s2e(e){var t=u2e(e,"string");return uf(t)==="symbol"?t:String(t)}function u2e(e,t){if(uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jg(){return typeof Reflect<"u"&&Reflect.get?jg=Reflect.get.bind():jg=function(t,r,n){var o=f2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jg.apply(this,arguments)}function f2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ff(e),e!==null););return e}function c2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BR(e,t)}function BR(e,t){return BR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BR(e,t)}function h2e(e){var t=y2e();return function(){var n=ff(e),o;if(t){var i=ff(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return d2e(this,o)}}function d2e(e,t){if(t&&(uf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v2e(e)}function v2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ff(e){return ff=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ff(e)}var g2e="multipleSelectionHandles",p2e=160,m2e=function(e){c2e(r,e);var t=h2e(r);function r(n){var o;return a2e(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return l2e(r,[{key:"isEnabled",value:function(){return pn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new kt(this)),this.registerListeners(),jg(ff(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,y;if(i.dragged.length!==0){var m=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!m||m===i.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(f=i.hot.getCoords(m),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),y=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),y.start!==null&&i.hot.selection.setRangeStart(y.start),i.hot.selection.setRangeEnd(y.end),i.lastSetCell=m),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return g2e}},{key:"PLUGIN_PRIORITY",get:function(){return p2e}}]),r}(ot);function VR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,y=e.isRoot,m=y===void 0?!1:y,b=e.isPlaceholder,S=b===void 0?!1:b;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:m,isPlaceholder:S}}function aY(){return{label:"",isPlaceholder:!0}}function fL(e){return C2e(e)||S2e(e)||w2e(e)||b2e()}function b2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w2e(e,t){if(e){if(typeof e=="string")return WR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WR(e,t)}}function S2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function C2e(e){if(Array.isArray(e))return WR(e)}function WR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _2e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;A(e,function(o){var i=[],a=0;r.push(i),A(o,function(l){var s=VR();if(Ue(l)){var u=l.label,f=l.colspan;s.label=Dt(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=Dt(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(aY());return!c})});var n=Math.max.apply(Math,fL(We(r,function(o){return o.length})));return A(r,function(o){if(o.length<n){var i=We(new Array(n-o.length),function(){return VR()});o.splice.apply(o,[o.length,0].concat(fL(i)))}}),r}function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vd(e)}var O2e=["row","col"];function cL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function R2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cL(Object(r),!0).forEach(function(n){E2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function E2e(e,t,r){return t=lY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T2e(e,t){if(e==null)return{};var r=P2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function P2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function k2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lY(n.key),n)}}function $2e(e,t,r){return t&&hL(e.prototype,t),r&&hL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lY(e){var t=A2e(e,"string");return Vd(t)==="symbol"?t:String(t)}function A2e(e,t){if(Vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KS(e,t,r){I2e(e,t),t.set(e,r)}function I2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(e,t){var r=sY(e,t,"get");return M2e(e,r)}function M2e(e,t){return t.get?t.get.call(e):t.value}function yc(e,t,r){var n=sY(e,t,"set");return x2e(e,n,r),r}function sY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function x2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var dL=["label","collapsible"],no=new WeakMap,ra=new WeakMap,qS=new WeakMap,D2e=function(){function e(){k2e(this,e),KS(this,no,{writable:!0,value:[]}),KS(this,ra,{writable:!0,value:0}),KS(this,qS,{writable:!0,value:1/0})}return $2e(e,[{key:"setColumnsLimit",value:function(r){yc(this,qS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];yc(this,no,_2e(r,un(this,qS))),yc(this,ra,un(this,no).length)}},{key:"getData",value:function(){return un(this,no)}},{key:"mergeWith",value:function(r){var n=this;A(r,function(o){var i=o.row,a=o.col,l=T2e(o,O2e),s=n.getHeaderSettings(i,a);s!==null&&zt(s,l,dL)})}},{key:"map",value:function(r){A(un(this,no),function(n){A(n,function(o){var i=r(R2e({},o));Ue(i)&&zt(o,i,dL)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=un(this,ra)||r<0)return null;var i=un(this,no)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=un(this,ra)||r<0)return i;for(var a=un(this,no)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return un(this,ra)}},{key:"getColumnsCount",value:function(){return un(this,ra)>0?un(this,no)[0].length:0}},{key:"clear",value:function(){yc(this,no,[]),yc(this,ra,0)}}]),e}();function Wd(e){"@babel/helpers - typeof";return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wd(e)}function vL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vL(Object(r),!0).forEach(function(n){Fg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uY(n.key),n)}}function H2e(e,t,r){return t&&gL(e.prototype,t),r&&gL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fg(e,t,r){return t=uY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uY(e){var t=L2e(e,"string");return Wd(t)==="symbol"?t:String(t)}function L2e(e,t){if(Wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j2e(e){return W2e(e)||V2e(e)||B2e(e)||F2e()}function F2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B2e(e,t){if(e){if(typeof e=="string")return UR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UR(e,t)}}function V2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function W2e(e){if(Array.isArray(e))return UR(e)}function UR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var U2e="DF-pre-order";function fY(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=fY.call(this.childs[n],e,t)}return r}var z2e="DF-post-order";function cY(e,t){for(var r=0;r<this.childs.length;r++){var n=cY.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var hY="BF";function Y2e(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,j2e(o.childs)),e.call(t,o)!==!1&&n()}}n()}var G2e=hY,pL=new Map([[U2e,fY],[z2e,cY],[hY,Y2e]]),mL=function(){function e(t){N2e(this,e),Fg(this,"data",{}),Fg(this,"parent",null),Fg(this,"childs",[]),this.data=t}return H2e(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(yL({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=yL({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:G2e;if(!pL.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));pL.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Ud(e){"@babel/helpers - typeof";return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}function bL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bL(Object(r),!0).forEach(function(n){K2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K2e(e,t,r){return t=dY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q2e(e,t){return J2e(e)||Q2e(e,t)||Z2e(e,t)||X2e()}function X2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z2e(e,t){if(e){if(typeof e=="string")return SL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SL(e,t)}}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function J2e(e){if(Array.isArray(e))return e}function eUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dY(n.key),n)}}function tUe(e,t,r){return t&&CL(e.prototype,t),r&&CL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dY(e){var t=rUe(e,"string");return Ud(t)==="symbol"?t:String(t)}function rUe(e,t){if(Ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XS(e,t,r){nUe(e,t),t.set(e,r)}function nUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(e,t){var r=vY(e,t,"get");return oUe(e,r)}function oUe(e,t){return t.get?t.get.call(e):t.value}function iUe(e,t,r){var n=vY(e,t,"set");return aUe(e,n,r),r}function vY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function aUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Bl=new WeakMap,na=new WeakMap,Vl=new WeakMap,lUe=function(){function e(t){eUe(this,e),XS(this,Bl,{writable:!0,value:new Map}),XS(this,na,{writable:!0,value:new Map}),XS(this,Vl,{writable:!0,value:null}),iUe(this,Vl,t)}return tUe(e,[{key:"getRoots",value:function(){return Array.from(gr(this,Bl).values())}},{key:"getRootByColumn",value:function(r){var n;return gr(this,na).has(r)&&(n=gr(this,Bl).get(gr(this,na).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-gr(this,na).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;gr(this,na).clear(),A(gr(this,Bl),function(o){for(var i=q2e(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)gr(r,na).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=gr(this,Vl).getColumnsCount(),n=0;n<r;){var o=gr(this,Vl).getHeaderSettings(0,n),i=new mL;gr(this,Bl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=gr(this,Vl).getHeadersSettings(o,n,a);o+=1,A(l,function(s){var u=wL(wL({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new mL(u),r.addChild(f)),o<gr(i,Vl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){gr(this,Bl).clear(),gr(this,na).clear()}}]),e}();function yY(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Zp(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function Qp(e){return Zp(e,"origColspan")===e.data.origColspan}function ok(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Qp(e);if(n)return ok(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)A(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,yY(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Qp(c)&&(h.isCollapsed=Zp(c,"isCollapsed"))}),{rollbackModification:function(){return ik(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function ik(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Qp(e);if(o)return ik(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)A(i,function(h){yY(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=Zp(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):Qp(h)&&(d.isCollapsed=Zp(h,"isCollapsed"))}),{rollbackModification:function(){return ok(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var _L;function sUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function uUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(_L||(_L=sUe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var OL;function fUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function cUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(OL||(OL=fUe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var RL=new Map([["collapse",ik],["expand",ok],["hide-column",uUe],["show-column",cUe]]);function hUe(e,t,r){if(!RL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return RL.get(e)(t,r)}var dUe=["crossHiddenColumns"];function vUe(e,t){if(e==null)return{};var r=yUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function qy(e){var t=[];return A(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=pUe(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(aY());else{var d=gUe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function gUe(e){var t=VR(e);t.crossHiddenColumns;var r=vUe(t,dUe);return r}function pUe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}var mUe=["row"];function EL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function TL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EL(Object(r),!0).forEach(function(n){bUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bUe(e,t,r){return t=gY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wUe(e,t){if(e==null)return{};var r=SUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function CUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gY(n.key),n)}}function _Ue(e,t,r){return t&&PL(e.prototype,t),r&&PL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gY(e){var t=OUe(e,"string");return zd(t)==="symbol"?t:String(t)}function OUe(e,t){if(zd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZS(e,t,r){RUe(e,t),t.set(e,r)}function RUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gc(e,t,r){var n=pY(e,t,"set");return EUe(e,n,r),r}function EUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Lt(e,t){var r=pY(e,t,"get");return TUe(e,r)}function pY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function TUe(e,t){return t.get?t.get.call(e):t.value}var xn=new WeakMap,Lr=new WeakMap,oa=new WeakMap,PUe=function(){function e(){CUe(this,e),ZS(this,xn,{writable:!0,value:new D2e}),ZS(this,Lr,{writable:!0,value:new lUe(Lt(this,xn))}),ZS(this,oa,{writable:!0,value:[[]]})}return _Ue(e,[{key:"setState",value:function(r){Lt(this,xn).setData(r);var n=!1;try{Lt(this,Lr).buildTree()}catch{Lt(this,Lr).clear(),Lt(this,xn).clear(),n=!0}return gc(this,oa,qy(Lt(this,Lr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Lt(this,xn).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=We(r,function(i){var a=i.row,l=wUe(i,mUe);return TL({row:a<0?n.rowCoordsToLevel(a):a},l)});Lt(this,xn).mergeWith(o),Lt(this,Lr).buildTree(),gc(this,oa,qy(Lt(this,Lr).getRoots()))}},{key:"mapState",value:function(r){Lt(this,xn).map(r),Lt(this,Lr).buildTree(),gc(this,oa,qy(Lt(this,Lr).getRoots()))}},{key:"mapNodes",value:function(r){return Ft(Lt(this,Lr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Lt(this,Lr).getNode(n,o),a;return i&&(a=hUe(r,i,o),gc(this,oa,qy(Lt(this,Lr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Lt(this,oa)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Lt(this,Lr).getNode(r,n);return o?TL({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Lt(this,xn).getLayersCount()}},{key:"getColumnsCount",value:function(){return Lt(this,xn).getColumnsCount()}},{key:"clear",value:function(){gc(this,oa,[]),Lt(this,xn).clear(),Lt(this,Lr).clear()}}]),e}();function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}function kUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mY(n.key),n)}}function $Ue(e,t,r){return t&&kL(e.prototype,t),r&&kL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pc(e,t,r){return t=mY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mY(e){var t=AUe(e,"string");return Yd(t)==="symbol"?t:String(t)}function AUe(e,t){if(Yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IUe=function(){function e(t,r){kUe(this,e),pc(this,"hot",void 0),pc(this,"nestedHeaderSettingsGetter",void 0),pc(this,"layersCount",0),pc(this,"container",void 0),pc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return $Ue(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),y=this.nestedHeaderSettingsGetter(f,d);if(y&&(!y.isPlaceholder||y.isHidden)){var m=y.label;s&&(m+='<button class="changeType"></button>'),ul(v,m),v.colSpan=y.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const MUe=IUe;function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}var $L,AL;function IL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function xUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ML(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bY(n.key),n)}}function DUe(e,t,r){return t&&ML(e.prototype,t),r&&ML(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ia(){return typeof Reflect<"u"&&Reflect.get?Ia=Reflect.get.bind():Ia=function(t,r,n){var o=NUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ia.apply(this,arguments)}function NUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mo(e),e!==null););return e}function HUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zR(e,t)}function zR(e,t){return zR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zR(e,t)}function LUe(e){var t=FUe();return function(){var n=Mo(e),o;if(t){var i=Mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jUe(this,o)}}function jUe(e,t){if(t&&(cf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oc(e)}function Oc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mo(e)}function xL(e,t,r){return t=bY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bY(e){var t=BUe(e,"string");return cf(t)==="symbol"?t:String(t)}function BUe(e,t){if(cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DL(e,t,r){VUe(e,t),t.set(e,r)}function VUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xy(e,t,r){var n=wY(e,t,"set");return WUe(e,n,r),r}function WUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function $t(e,t){var r=wY(e,t,"get");return UUe(e,r)}function wY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function UUe(e,t){return t.get?t.get.call(e):t.value}var NL="nestedHeaders",zUe=280,Vt=new WeakMap,ai=new WeakMap,YUe=function(e){HUe(r,e);var t=LUe(r);function r(){var n;xUe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),DL(Oc(n),Vt,{writable:!0,value:new PUe}),DL(Oc(n),ai,{writable:!0,value:null}),xL(Oc(n),"ghostTable",new MUe(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),xL(Oc(n),"detectedOverlappedHeaders",!1),n}return DUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NL]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&wt(dt($L||($L=IL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),Ia(Mo(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;$t(this,Vt).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=$t(this,Vt).setState(a)),this.detectedOverlappedHeaders&&wt(dt(AL||(AL=IL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(u,s)}),!$t(this,ai)&&this.enabled&&Xy(this,ai,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Ia(Mo(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),$t(this,Vt).clear(),$t(this,ai).unsubscribe(),Xy(this,ai,null),this.ghostTable.clear(),Ia(Mo(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return $t(this,Vt)}},{key:"getLayersCount",value:function(){return $t(this,Vt).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return $t(this,Vt).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Le(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Le(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Le(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),Le(s,"hiddenHeader");var v=(u=$t(i,Vt).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},y=v.colspan,m=v.isHidden,b=v.isPlaceholder;if(b||m)te(s,"hiddenHeader");else if(y>1){var S,C,k=h._wt.wtOverlays,O=(S=k.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),B=(C=k.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),z=O||B?Math.min(y,a-l):y;z>1&&s.setAttribute("colspan",z)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=$t(this,Vt).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=$t(this,Vt).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=$t(this,Vt).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===Fv){if(!d)return l.columnIndex}else f===ub&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,y=c-d+1;if(f>=0||y===1)break;for(var m=c;m<=d;m++)for(var b=f;b<=h;b++){var S,C=v+b,k=m-c;if(k!==0){var O=(S=$t(this,Vt).getHeaderTreeNodeData(b,m))===null||S===void 0?void 0:S.isRoot;O===!1&&(o[C][k]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(Fm(o)||$i(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),y=h.from;l.column=!0,l.cell=!0;var m=[];i.col<y.col?m.push(v.col,f):i.col>y.col?m.push(d.col,f+c-1):m.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<$t(this,Vt).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=$t(this,Vt).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=$t(this,Vt).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),wr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?$t(this,Vt).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=$t(this,Vt).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Xy(this,Vt,null),$t(this,ai)!==null&&($t(this,ai).unsubscribe(),Xy(this,ai,null)),Ia(Mo(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return $t(this,Vt).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return NL}},{key:"PLUGIN_PRIORITY",get:function(){return zUe}}]),r}(ot);function HL(e){return XUe(e)||qUe(e)||KUe(e)||GUe()}function GUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KUe(e,t){if(e){if(typeof e=="string")return YR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YR(e,t)}}function qUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XUe(e){if(Array.isArray(e))return YR(e)}function YR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function ZUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JUe(n.key),n)}}function QUe(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JUe(e){var t=eze(e,"string");return hf(t)==="symbol"?t:String(t)}function eze(e,t){if(hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tze=function(){function e(t,r){ZUe(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return QUe(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&A(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&A(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return ze(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(A(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||hf(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Ce(r[0],r[2],function(b){var S=n.translateTrimmedRow(b);a.push(n.getDataObject(S))}),Ce(0,a.length-2,function(b){n.detachFromParent(a[b],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];A(o,function(l){a.push(i.getDataObject(l))}),A(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(HL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(HL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const rze=tze;function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}function jL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oze(n.key),n)}}function nze(e,t,r){return t&&jL(e.prototype,t),r&&jL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oze(e){var t=ize(e,"string");return Gd(t)==="symbol"?t:String(t)}function ize(e,t){if(Gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var lze=nze(function e(t,r){aze(this,e),this.hot=r,this.plugin=t});const ak=lze;function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function sze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fze(n.key),n)}}function uze(e,t,r){return t&&FL(e.prototype,t),r&&FL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fze(e){var t=cze(e,"string");return df(t)==="symbol"?t:String(t)}function cze(e,t){if(df(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GR(e,t)}function GR(e,t){return GR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GR(e,t)}function dze(e){var t=gze();return function(){var n=Jp(e),o;if(t){var i=Jp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vze(this,o)}}function vze(e,t){if(t&&(df(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yze(e)}function yze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jp(e){return Jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jp(e)}var pze=function(e){hze(r,e);var t=dze(r);function r(n,o){var i;return sze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return uze(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(A(c,function(y){y&&u.removeChild(y)}),te(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Ce(0,l-1,function(){var y=h.createElement("SPAN");te(y,r.CSS_CLASSES.emptyIndicator),u.appendChild(y)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");te(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(ak);const SY=pze;function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function BL(e){return Sze(e)||wze(e)||bze(e)||mze()}function mze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bze(e,t){if(e){if(typeof e=="string")return KR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KR(e,t)}}function wze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Sze(e){if(Array.isArray(e))return KR(e)}function KR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oze(n.key),n)}}function _ze(e,t,r){return t&&VL(e.prototype,t),r&&VL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oze(e){var t=Rze(e,"string");return vf(t)==="symbol"?t:String(t)}function Rze(e,t){if(vf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qR(e,t)}function qR(e,t){return qR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qR(e,t)}function Tze(e){var t=$ze();return function(){var n=em(e),o;if(t){var i=em(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Pze(this,o)}}function Pze(e,t){if(t&&(vf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kze(e)}function kze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $ze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function em(e){return em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},em(e)}var Aze=function(e){Eze(r,e);var t=Tze(r);function r(n,o){var i;return Cze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),A(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){Ce(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return _ze(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&A(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,BL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&A(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,BL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&A(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,SY.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),wn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(ak);const Ize=Aze;function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function Mze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dze(n.key),n)}}function xze(e,t,r){return t&&WL(e.prototype,t),r&&WL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dze(e){var t=Nze(e,"string");return yf(t)==="symbol"?t:String(t)}function Nze(e,t){if(yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XR(e,t)}function XR(e,t){return XR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XR(e,t)}function Lze(e){var t=Fze();return function(){var n=tm(e),o;if(t){var i=tm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jze(this,o)}}function jze(e,t){if(t&&(yf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CY(e)}function CY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tm(e)}var UL=new WeakMap,Bze=function(e){Hze(r,e);var t=Lze(r);function r(n,o){var i;return Mze(this,r),i=t.call(this,n,o),UL.set(CY(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return xze(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(lP)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(sP)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,o.items.length-1,function(l){if(l===0)return A(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=UL.get(this);return Ce(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(ak);const Vze=Bze;function Kd(e){"@babel/helpers - typeof";return Kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kd(e)}var zL;function YL(e){return Yze(e)||zze(e)||Uze(e)||Wze()}function Wze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uze(e,t){if(e){if(typeof e=="string")return ZR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZR(e,t)}}function zze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Yze(e){if(Array.isArray(e))return ZR(e)}function ZR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gze(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Kze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xze(n.key),n)}}function qze(e,t,r){return t&&GL(e.prototype,t),r&&GL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xze(e){var t=Zze(e,"string");return Kd(t)==="symbol"?t:String(t)}function Zze(e,t){if(Kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qze=function(){function e(t){Kze(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return qze(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(m){if(!f)return!1;var b=a.dataManager.translateTrimmedRow(m);return f=a.shouldAllowMoving(b,u),b}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),y=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,y),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return mt(i)&&(wt(dt(zL||(zL=Gze([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,YL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,YL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function Jze(e){return nYe(e)||rYe(e)||tYe(e)||eYe()}function eYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tYe(e,t){if(e){if(typeof e=="string")return QR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QR(e,t)}}function rYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nYe(e){if(Array.isArray(e))return QR(e)}function QR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aYe(n.key),n)}}function iYe(e,t,r){return t&&KL(e.prototype,t),r&&KL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aYe(e){var t=lYe(e,"string");return gf(t)==="symbol"?t:String(t)}function lYe(e,t){if(gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ma(){return typeof Reflect<"u"&&Reflect.get?Ma=Reflect.get.bind():Ma=function(t,r,n){var o=sYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ma.apply(this,arguments)}function sYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xo(e),e!==null););return e}function uYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JR(e,t)}function JR(e,t){return JR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JR(e,t)}function fYe(e){var t=hYe();return function(){var n=xo(e),o;if(t){var i=xo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cYe(this,o)}}function cYe(e,t){if(t&&(gf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Y(e)}function _Y(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xo(e){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xo(e)}var QS="nestedRows",dYe=300,oo=new WeakMap,vYe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",yYe=function(e){uYe(r,e);var t=fYe(r);function r(n){var o;return oYe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,oo.set(_Y(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return iYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[QS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Dv),this.dataManager=new rze(this,this.hot),this.collapsingUI=new Ize(this,this.hot),this.headersUI=new SY(this,this.hot),this.contextMenuUI=new Vze(this,this.hot),this.rowMoveController=new Qze(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),Ma(xo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Ma(xo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),Ma(xo(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=oo.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=oo.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=oo.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=oo.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=oo.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,Jze(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=oo.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){Ma(xo(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!TU(o)){NE(vYe),this.hot.getSettings()[QS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return QS}},{key:"PLUGIN_PRIORITY",get:function(){return dYe}}]),r}(ot);function qd(e){"@babel/helpers - typeof";return qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qd(e)}function gYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mYe(n.key),n)}}function pYe(e,t,r){return t&&qL(e.prototype,t),r&&qL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mYe(e){var t=bYe(e,"string");return qd(t)==="symbol"?t:String(t)}function bYe(e,t){if(qd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wYe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;gYe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return pYe(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;A(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const SYe=wYe;function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function CYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OYe(n.key),n)}}function _Ye(e,t,r){return t&&XL(e.prototype,t),r&&XL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OYe(e){var t=RYe(e,"string");return pf(t)==="symbol"?t:String(t)}function RYe(e,t){if(pf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xa(){return typeof Reflect<"u"&&Reflect.get?xa=Reflect.get.bind():xa=function(t,r,n){var o=EYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xa.apply(this,arguments)}function EYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Do(e),e!==null););return e}function TYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e0(e,t)}function e0(e,t){return e0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},e0(e,t)}function PYe(e){var t=AYe();return function(){var n=Do(e),o;if(t){var i=Do(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kYe(this,o)}}function kYe(e,t){if(t&&(pf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ye(e)}function $Ye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Do(e){return Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Do(e)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");var ZL="persistentState",IYe=0,MYe=function(e){TYe(r,e);var t=PYe(r);function r(n){var o;return CYe(this,r),o=t.call(this,n),o.storage=void 0,o}return _Ye(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ZL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new SYe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),xa(Do(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,xa(Do(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),xa(Do(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){xa(Do(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ZL}},{key:"PLUGIN_PRIORITY",get:function(){return IYe}}]),r}(ot);function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function xYe(e){return LYe(e)||HYe(e)||NYe(e)||DYe()}function DYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NYe(e,t){if(e){if(typeof e=="string")return t0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t0(e,t)}}function HYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function LYe(e){if(Array.isArray(e))return t0(e)}function t0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BYe(n.key),n)}}function FYe(e,t,r){return t&&QL(e.prototype,t),r&&QL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BYe(e){var t=VYe(e,"string");return mf(t)==="symbol"?t:String(t)}function VYe(e,t){if(mf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Da(){return typeof Reflect<"u"&&Reflect.get?Da=Reflect.get.bind():Da=function(t,r,n){var o=WYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Da.apply(this,arguments)}function WYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=No(e),e!==null););return e}function UYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r0(e,t)}function r0(e,t){return r0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},r0(e,t)}function zYe(e){var t=KYe();return function(){var n=No(e),o;if(t){var i=No(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return YYe(this,o)}}function YYe(e,t){if(t&&(mf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GYe(e)}function GYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function No(e){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},No(e)}var JS="search",qYe=190,XYe="htSearchResult",ZYe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},QYe=function(t,r,n){return mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||mt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},JYe=function(e){UYe(r,e);var t=zYe(r);function r(n){var o;return jYe(this,r),o=t.call(this,n),o.callback=ZYe,o.queryMethod=QYe,o.searchResultClass=XYe,o}return FYe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[JS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[JS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),Da(No(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),Da(No(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Da(No(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Ce(0,s-1,function(h){Ce(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),y=i.hot.getCellMeta(h,d),m=y.search.callback||a,b=y.search.queryMethod||l,S=b(o,v,y);if(S){var C={row:h,col:d,data:v};f.push(C)}m&&m(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ue(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,xYe(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){Da(No(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return JS}},{key:"PLUGIN_PRIORITY",get:function(){return qYe}}]),r}(ot);function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function eGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rGe(n.key),n)}}function tGe(e,t,r){return t&&JL(e.prototype,t),r&&JL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rGe(e){var t=nGe(e,"string");return bf(t)==="symbol"?t:String(t)}function nGe(e,t){if(bf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hs(){return typeof Reflect<"u"&&Reflect.get?hs=Reflect.get.bind():hs=function(t,r,n){var o=oGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hs.apply(this,arguments)}function oGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ki(e),e!==null););return e}function iGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n0(e,t)}function n0(e,t){return n0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},n0(e,t)}function aGe(e){var t=uGe();return function(){var n=ki(e),o;if(t){var i=ki(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lGe(this,o)}}function lGe(e,t){if(t&&(bf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sGe(e)}function sGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ki(e){return ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ki(e)}var fGe="touchScroll",cGe=200,hGe=function(e){iGe(r,e);var t=aGe(r);function r(n){var o;return eGe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return tGe(r,[{key:"isEnabled",value:function(){return PE()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),hs(ki(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,hs(ki(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){hs(ki(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,A(this.clones,function(o){te(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,A(this.clones,function(i){Le(i,"hide-tween"),te(i,"show-tween")}),this.hot._registerTimeout(function(){A(o.clones,function(i){Le(i,"show-tween")})},400),A(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return fGe}},{key:"PLUGIN_PRIORITY",get:function(){return cGe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ot);function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function dGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ej(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yGe(n.key),n)}}function vGe(e,t,r){return t&&ej(e.prototype,t),r&&ej(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yGe(e){var t=gGe(e,"string");return wf(t)==="symbol"?t:String(t)}function gGe(e,t){if(wf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Na(){return typeof Reflect<"u"&&Reflect.get?Na=Reflect.get.bind():Na=function(t,r,n){var o=pGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Na.apply(this,arguments)}function pGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ho(e),e!==null););return e}function mGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o0(e,t)}function o0(e,t){return o0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o0(e,t)}function bGe(e){var t=CGe();return function(){var n=Ho(e),o;if(t){var i=Ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wGe(this,o)}}function wGe(e,t){if(t&&(wf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SGe(e)}function SGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ho(e){return Ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ho(e)}var Zy="trimRows",_Ge=330,OGe=function(e){mGe(r,e);var t=bGe(r);function r(n){var o;return dGe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return vGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Dv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Na(Ho(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[Zy];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Na(Ho(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Na(Ho(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(A(o,function(c){s[c]=!1}),l=Ft(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[Zy];Array.isArray(i)&&this.hot.batchExecution(function(){A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Na(Ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zy}},{key:"PLUGIN_PRIORITY",get:function(){return _Ge}}]),r}(ot);function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function OY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RGe(n.key),n)}}function RY(e,t,r){return t&&tj(e.prototype,t),r&&tj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RGe(e){var t=EGe(e,"string");return Sf(t)==="symbol"?t:String(t)}function EGe(e,t){if(Sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i0(e,t)}function i0(e,t){return i0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},i0(e,t)}function TY(e){var t=kGe();return function(){var n=rm(e),o;if(t){var i=rm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TGe(this,o)}}function TGe(e,t){if(t&&(Sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PGe(e)}function PGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rm(e){return rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rm(e)}function $Ge(e){return MGe(e)||IGe(e)||kY(e)||AGe()}function AGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MGe(e){if(Array.isArray(e))return a0(e)}function PY(e,t){return NGe(e)||DGe(e,t)||kY(e,t)||xGe()}function xGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kY(e,t){if(e){if(typeof e=="string")return a0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a0(e,t)}}function a0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function NGe(e){if(Array.isArray(e))return e}var $Y="undoRedo",HGe="undoRedo";function ye(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=PY(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push($Ge(h)),c},[]);A(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ye.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ye.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=fr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ye.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ye.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Ce(s.length-1,function(y){var m=[],b=s[y];Ce(u,u+(n-1),function(S){m.push(b[e.toPhysicalColumn(S)])}),f.push(m)}),Ce(n-1,function(y){h.push(e.toPhysicalColumn(u+y))}),Array.isArray(e.getSettings().colHeaders)&&Ce(n-1,function(y){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+y)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ye.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ye.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ye.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ye.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ye.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ye.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ye.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ye.prototype.isEnabled=function(){return this.enabled};ye.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,FGe(e),this.registerShortcuts(),e.addHook("afterChange",AY)}};ye.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,BGe(e),this.unregisterShortcuts(),e.removeHook("afterChange",AY)}};ye.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ye.Action=function(){};ye.Action.prototype.undo=function(){};ye.Action.prototype.redo=function(){};ye.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Ko(ye.ChangeAction,ye.Action);ye.ChangeAction.prototype.undo=function(e,t){for(var r=fr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=PY(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ye.ChangeAction.prototype.redo=function(e,t){for(var r=fr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ye.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Ko(ye.CreateRowAction,ye.Action);ye.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ye.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ye.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Ko(ye.RemoveRowAction,ye.Action);ye.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ye.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ye.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Ko(ye.CreateColumnAction,ye.Action);ye.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ye.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ye.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Ko(ye.RemoveColumnAction,ye.Action);ye.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(We(this.data[s],i));var u=We(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(e.getSourceDataArray(),function(c,h){A(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&A(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ye.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ye.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ye.CellAlignmentAction.prototype.undo=function(e,t){var r=this;A(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ye.CellAlignmentAction.prototype.redo=function(e,t){si(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Ko(ye.FiltersAction,ye.Action);ye.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ye.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var LGe=function(e){EY(r,e);var t=TY(r);function r(n,o){var i;OY(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return RY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ye.Action);ye.MergeCellsAction=LGe;var jGe=function(e){EY(r,e);var t=TY(r);function r(n,o){var i;return OY(this,r),i=t.call(this),i.cellRange=o,i}return RY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ye.Action);ye.UnmergeCellsAction=jGe;ye.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Ko(ye.RowMoveAction,ye.Action);ye.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ye.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ye.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ye.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:$Y};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ye.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup($Y)};function AY(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function FGe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function BGe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Vv=ge.getSingleton();Vv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Vv.register("beforeUndo");Vv.register("afterUndo");Vv.register("beforeRedo");Vv.register("afterRedo");ye.PLUGIN_KEY=HGe;ye.SETTING_KEYS=!0;function VGe(){rt(ZSe),rt(SCe),rt(jCe),rt(I_e),rt(Z_e),rt(tU),rt(jRe),rt(w0e),rt(tz),rt(jAe),rt(hIe),rt(_Ie),rt(dz),rt(TMe),rt(_Le),rt(_je),rt(Kje),rt(bFe),rt(VFe),rt($Be),rt(BBe),rt(kVe),rt(FVe),rt(LWe),rt(i2e),rt(m2e),rt(YUe),rt(yYe),rt(MYe),rt(JYe),rt(hGe),rt(OGe),rt(ye)}function IY(){Lfe(),rce(),Sce(),Vce(),VGe()}var WGe=$e,UGe=je,zGe=cm.f,YGe=UGe(function(){return!Object.getOwnPropertyNames(1)});WGe({target:"Object",stat:!0,forced:YGe},{getOwnPropertyNames:zGe});cn(NW);Te.editors={BaseEditor:If};function Te(e,t){var r=new qP(e,t||{},UP);return r.init(),r}Te.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new qP(e,t,UP)};Te.DefaultSettings=UU();Te.hooks=ge.getSingleton();Te.CellCoords=up;Te.CellRange=iT;Te.packageName="handsontable";Te.buildDate="22/06/2023 12:51:08";Te.version="13.0.0";Te.languages={dictionaryKeys:f0e,getLanguageDictionary:xU,getLanguagesDictionaries:fPe,registerLanguageDictionary:MU,getTranslatedPhrase:DU};function GGe(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var l,s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];a=(l=o[r]).call.apply(l,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var eC,tC,rC,nC,oC;IY();GGe(Te);Te.__GhostTable=nT;Te._getListenersCounter=Kle;Te._getRegisteredMapsCounter=eSe;Te.EventManager=kt;var KGe=[Noe,uie,WTe,hce,qie,Ele,Foe,kse,iie,Eae,hie,wTe],qGe=[Hae,die];Te.helper={};Te.dom={};A(KGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.helper[t]=e[t])})});A(qGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.dom[t]=e[t])})});Te.cellTypes=(eC=Te.cellTypes)!==null&&eC!==void 0?eC:{};A(Bce(),function(e){Te.cellTypes[e]=eT(e)});Te.cellTypes.registerCellType=cn;Te.cellTypes.getCellType=eT;Te.editors=(tC=Te.editors)!==null&&tC!==void 0?tC:{};A(Fle(),function(e){Te.editors["".concat(ur(e),"Editor")]=np(e)});Te.editors.registerEditor=Pr;Te.editors.getEditor=np;Te.renderers=(rC=Te.renderers)!==null&&rC!==void 0?rC:{};A(tce(),function(e){var t=sp(e);e==="base"&&(Te.renderers.cellDecorator=t),Te.renderers["".concat(ur(e),"Renderer")]=t});Te.renderers.registerRenderer=Hn;Te.renderers.getRenderer=sp;Te.validators=(nC=Te.validators)!==null&&nC!==void 0?nC:{};A(wce(),function(e){Te.validators["".concat(ur(e),"Validator")]=JE(e)});Te.validators.registerValidator=Xl;Te.validators.getValidator=JE;Te.plugins=(oC=Te.plugins)!==null&&oC!==void 0?oC:{};A(rT(),function(e){Te.plugins[e]=Iv(e)});Te.plugins["".concat(ur(ot.PLUGIN_KEY),"Plugin")]=ot;Te.plugins.registerPlugin=rt;Te.plugins.getPlugin=Iv;const rj="selected",nj="odd",XGe=(e,t,r,n,o,i)=>{if(r!==0)return;const a=e.parentElement;if(a===null)return;i.instance.getSourceDataAtRow(t).checked?Te.dom.addClass(a,rj):Te.dom.removeClass(a,rj),t%2===0?Te.dom.addClass(a,nj):Te.dom.removeClass(a,nj)},ZGe=function(t,r){const n=document.createElement("input"),o=this.getSourceDataAtRow(t);n.type="checkbox",n.checked=!!o.checked,Te.dom.empty(r),r.appendChild(n)};function QGe(e,t,r){if(t<0||!r.firstChild)return;const n=e.isRtl()?"htRight":"htLeft";Te.dom.addClass(r.firstChild,n)}const JGe=function(t,r){const n=t.target;r.col===-1&&t.target&&n.nodeName==="INPUT"&&(t.preventDefault(),this.setSourceDataAtCell(r.row,"checked",!n.checked))},e3e=(...e)=>{const[t,r,n,o,i,a,l]=e;Mf(...e),a?r.innerHTML='<div class="circle critical"></div>':r.innerHTML='<div class="circle"></div>'};var ds=Symbol("unassigned"),t3e="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function nm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function MY(e){var t=Te.hooks.getRegistered(),r={};Object.assign(r,Te.DefaultSettings);for(var n in r)r[n]={default:ds};for(var o=0;o<t.length;o++)r[t[o]]={default:ds};return r.settings={default:ds},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function xY(e){var t={},r=e.settings;if(r!==ds)for(var n in r)nm(r,n)&&r[n]!==ds&&(t[n]=r[n]);for(var o in e)nm(e,o)&&o!=="settings"&&e[o]!==ds&&(t[o]=e[o]);return t}function oj(e,t){var r=xY(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)nm(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!ij(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)nm(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!ij(t[l],o[l]))&&(i[l]=o[l]);return i}function ij(e,t){return JSON.stringify(e)===JSON.stringify(t)}var r3e="13.0.0",lk=sj({name:"HotTable",props:MY("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=oj(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(t3e),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=oj(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=jY(new Te.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:r3e}),n3e=["id"];function o3e(e,t,r,n,o,i){return ua(),Ql("div",{id:e.id},[FY(e.$slots,"default")],8,n3e)}lk.render=o3e;lk.__file="src/HotTable.vue";function aj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function i3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aj(Object(r),!0).forEach(function(n){a3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a3e(e,t,r){return t=s3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l3e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s3e(e){var t=l3e(e,"string");return typeof t=="symbol"?t:String(t)}var At=sj({name:"HotColumn",props:MY("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=xY(this.$props),r=i3e({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});At.__file="src/HotColumn.vue";const iC={__name:"Table",props:["tableOptions"],setup(e){const t=e;IY();const r=ia(()=>QGe),n=ia(()=>XGe),o=ia(()=>ZGe),i=ia(()=>JGe),a=ia(()=>t.tableOptions.data),l=ia(()=>e3e);return BY(()=>{}),(s,u)=>(ua(),VY(ct(lk),{data:a.value,style:{width:"100%"},height:400,colWidths:e.tableOptions.colWidths,colHeaders:e.tableOptions.colHeaders,dropdownMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:r.value,beforeRenderer:n.value,afterGetRowHeader:o.value,afterOnCellMouseDown:i.value,manualRowMove:!0,readOnly:!0,licenseKey:"non-commercial-and-evaluation"},{default:Dn(()=>[e.tableOptions.tableName=="one"?(ua(),Ql(mb,{key:0},[Je(ct(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),Je(ct(At),{data:"Code"}),Je(ct(At),{data:"Name"}),Je(ct(At),{data:"Duration(Baseline)"}),Je(ct(At),{data:"Duration(New)"}),Je(ct(At),{data:"Ratio"})],64)):bb("",!0),e.tableOptions.tableName=="two"?(ua(),Ql(mb,{key:1},[Je(ct(At),{data:"ID",style:{display:"flex","justify-content":"center"}}),Je(ct(At),{data:"Code"}),Je(ct(At),{data:"Type"}),Je(ct(At),{data:"Name"}),Je(ct(At),{data:"Distribution(Min)"}),Je(ct(At),{data:"Distribution(Max)"}),Je(ct(At),{data:"Span"})],64)):bb("",!0),e.tableOptions.tableName=="three"?(ua(),Ql(mb,{key:2},[Je(ct(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),Je(ct(At),{data:"Task Code"}),Je(ct(At),{data:"Resource Name"}),Je(ct(At),{data:"Task Name"}),Je(ct(At),{data:"Duration(Old)"}),Je(ct(At),{data:"Duration(New)"}),Je(ct(At),{data:"UnitsPerHour(Old)"}),Je(ct(At),{data:"UnitsPerHour(New)"}),Je(ct(At),{data:"Total Planned Units"})],64)):bb("",!0)]),_:1},8,["data","colWidths","colHeaders","afterGetColHeader","beforeRenderer","afterGetRowHeader","afterOnCellMouseDown"]))}};const u3e=e=>(cj("data-v-d140605b"),e=e(),hj(),e),f3e={class:"content"},c3e=u3e(()=>bt("div",{id:"luckysheet"},null,-1)),h3e={id:"tip"},d3e={__name:"Lucksheettable",props:{url:Object},setup(e){const t=e;fj(async()=>{setTimeout(async()=>{const o=t.url,i="test";r.value=!0,setTimeout(()=>{XY.transformExcelToLuckyByUrl(o,i,(a,l)=>{var s;if(a.sheets==null||a.sheets.length==0){alert("Failed to read the content of the excel file, currently does not support xls files!");return}n.value=a,r.value=!1,ZY((s=window==null?void 0:window.luckysheet)==null?void 0:s.destroy)&&window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:a.sheets,title:a.info.name,userInfo:a.info.name.creator,editable:!1})})},0)},1500)});const r=Rc(!1);Rc("");const n=Rc({});return(o,i)=>(ua(),Ql("div",f3e,[c3e,WY(bt("div",h3e,"Downloading",512),[[UY,r.value]])]))}},v3e=uj(d3e,[["__scopeId","data-v-d140605b"]]);const y3e=e=>(cj("data-v-e400dd71"),e=e(),hj(),e),g3e={class:"optimize-content"},p3e={class:"content-row"},m3e={style:{"text-transform":"capitalize",color:"rgba(130, 181, 199, 0.9)"}},b3e={class:"chip primary"},w3e={class:"chip primary"},S3e={class:"content-box"},C3e=y3e(()=>bt("h3",null,"Online Excel",-1)),_3e={class:"sheet"},O3e={class:"content-box"},R3e={class:"sub-content"},E3e={class:"content-row"},T3e=qY('<div class="legend" data-v-e400dd71><div style="display:flex;justify-content:flex-start;align-items:center;margin-right:10px;" data-v-e400dd71><div class="circle critical" data-v-e400dd71></div> Critical </div><div style="display:flex;justify-content:flex-start;align-items:center;" data-v-e400dd71><div class="circle" data-v-e400dd71></div> Non-Critical </div></div>',1),P3e={class:"table"},k3e={class:"sub-content"},$3e={class:"content-row"},A3e={class:"table"},I3e={class:"sub-content"},M3e={class:"content-row"},x3e={class:"table"},D3e={class:"content-row"},N3e={__name:"optimizedReport",setup(e){const t=zY();YY(()=>{}),fj(()=>{a()});let r=Rc(!1);const n=GY();function o(){t.SummaryData.group=="baseline"&&(console.log("触发"),t.SummaryData.group="Balanced");let b=`${t.SummaryData.group}-${t.file.name.split(".")[0]}_FrontlineExport.${t.file.name.split(".")[1]}`;Cb.getProjectReport(b,t.truefile)}let i=Rc({});async function a(){t.SummaryData.group=="baseline"&&(t.SummaryData.group="Balanced");let b=`${t.SummaryData.group}-${t.file.name.split(".")[0]}_FrontlineExport.${t.file.name.split(".")[1]}`;i.value=await Cb.getUrl(b,t.truefile),console.log(i.value)}function l(){t.SummaryData.group=="baseline"&&(t.SummaryData.group="Balanced");let b=`${t.SummaryData.group}-${t.file.name.split(".")[0]}_FrontlineExport.${t.file.name.split(".")[1]}`;Cb.getExcelReport(b,t.truefile)}function s(){n.push({name:"optimizedSummary"}),t.active=2}KY((b,S)=>{b.name=="InputData"});function u(S){if(!S)return"0.00";var S=Math.round(parseFloat(S)*100)/100,C=S.toString().split(".");if(C.length==1)return S=S.toString()+".00",S;if(C.length>1)return C[1].length<2&&(S=S.toString()+"0"),S}function f(S){if(!S)return"0.0";var S=Math.round(parseFloat(S)*10)/10,C=S.toString().split(".");return C.length==1&&(S=S.toString()+".0"),S}let c=t.selectedData.tasks.filter(b=>b.durationRatio!==1).map(b=>(b.critical?b.critical=!0:b.critical=!1,{Critical:b.critical,Code:b.ID,Name:b.name,"Duration(Baseline)":f(b.remainingDuration),"Duration(New)":f(b.newDuration),Ratio:u(b.durationRatio)})),h=t.selectedData.newResources.map(b=>({ID:b.id,Code:b.ID,Type:b.type,Name:b.name,"Distribution(Min)":f(b.distribution.min),"Distribution(Max)":u(b.distribution.max),Span:u(b.distribution.span)})),d=ia(()=>t.selectedData.tasks.filter(C=>Object.keys(C.resources).length!==0).flatMap(C=>{let k=Object.values(C.resources),O=t.selectedData.tasks.find(B=>B.id==C.id);return k.map(B=>{var z;return{Critical:O.critical,"Task Code":O.ID,"Resource Name":(z=t.selectedData.newResources.find(q=>q.id==B.resourceId))==null?void 0:z.name,"Task Name":O.name,"Duration(Old)":f(O.plannedDuration),"Duration(New)":f(O.newDuration),"UnitsPerHour(Old)":u(B.plannedUnitsPerHour),"UnitsPerHour(New)":u(Number(B.newUnitsPerHour)),"Total Planned Units":u(O.plannedDuration*B.plannedUnitsPerHour)}})}));const v=wb({data:c,colWidths:[100,245,250,250,250,250],colHeaders:["Critical","Code","Name","Duration(Baseline)","Duration(New)","Ratio"],tableName:"one"}),y=wb({data:h,colWidths:[100,245,250,250,250,250,250,100],colHeaders:["ID","Code","Type","Name","Distribution(Min)","Distribution(Max)","Span"],tableName:"two"}),m=wb({data:d.value,colWidths:[100,245,250,150,150,150,150,150,150],colHeaders:["Critical","Task Code","Resource Name","Task Name","Duration(Old)","Duration(New)","UnitsPerHour(Old)","UnitsPerHour(New)","Total Planned Units"],tableName:"three"});return(b,S)=>{const C=Ff("v-btn"),k=Ff("v-card-text"),O=Ff("v-card-actions"),B=Ff("v-card"),z=Ff("v-dialog");return ua(),Ql("div",g3e,[bt("div",p3e,[bt("h2",null,[Fi(an(b.$t("optimizedReport.title[0]"))+"  ",1),bt("span",m3e,an(ct(t).SummaryData.group),1),bt("div",b3e,[bt("small",null,an(ct(t).setting.Steps)+" "+an(b.$t("optimizedReport.title[1]")),1)]),bt("div",w3e,[bt("small",null,an(`${ct(t).setting.Ratio[0]*100}% - ${ct(t).setting.Ratio[1]*100}% ${b.$t("optimizedReport.title[2]")}`),1)])]),Je(C,{onClick:S[0]||(S[0]=()=>{Sb(r)?r.value=!0:r=!0}),class:"row-btn"},{default:Dn(()=>[Fi(an(b.$t("optimizedReport.btn[1]")),1)]),_:1})]),bt("div",S3e,[C3e,bt("div",_3e,[Je(v3e,{url:ct(i)},null,8,["url"])])]),bt("div",O3e,[bt("div",R3e,[bt("div",E3e,[bt("h3",null,an(b.$t("optimizedReport.tableName[0]")),1)]),T3e,bt("div",P3e,[Je(iC,{tableOptions:v},null,8,["tableOptions"])])]),bt("div",k3e,[bt("div",$3e,[bt("h3",null,an(b.$t("optimizedReport.tableName[1]")),1)]),bt("div",A3e,[Je(iC,{tableOptions:y},null,8,["tableOptions"])])]),bt("div",I3e,[bt("div",M3e,[bt("h3",null,an(b.$t("optimizedReport.tableName[2]")),1)]),bt("div",x3e,[Je(iC,{tableOptions:m},null,8,["tableOptions"])])])]),bt("div",D3e,[Je(C,{onClick:s,class:"back"},{default:Dn(()=>[Fi(an(b.$t("optimizedReport.btn[0]")),1)]),_:1}),Je(C,{onClick:S[1]||(S[1]=()=>{Sb(r)?r.value=!0:r=!0}),class:"report"},{default:Dn(()=>[Fi(an(b.$t("optimizedReport.btn[1]")),1)]),_:1})]),Je(z,{modelValue:ct(r),"onUpdate:modelValue":S[4]||(S[4]=q=>Sb(r)?r.value=q:r=q),width:"auto"},{default:Dn(()=>[Je(B,{style:{"border-radius":"50px",width:"400px"}},{default:Dn(()=>[Je(k,{style:{"text-align":"center"}},{default:Dn(()=>[Fi(" Export Optimized File ")]),_:1}),Je(O,{style:{"justify-content":"center"}},{default:Dn(()=>[Je(C,{color:"rgb(64, 170, 151)",onClick:S[2]||(S[2]=()=>{o()})},{default:Dn(()=>[Fi(" Original Format ")]),_:1}),Je(C,{color:"rgb(64, 170, 151)",onClick:S[3]||(S[3]=()=>{l()})},{default:Dn(()=>[Fi(" EXCEL ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},W3e=uj(N3e,[["__scopeId","data-v-e400dd71"]]);export{W3e as default};
