import{aI as Zy,aJ as xY,aF as lj,l as sj,aK as DY,x as Yl,y as Oc,D as NY,m as ia,am as HY,G as LY,H as Dn,U as pb,Y as rt,A as ht,F as mb,ak as jY,T as dk,aL as FY,aB as BY,al as VY,aG as WY,ag as UY,aC as bb,an as jf,B as kt,ai as Fi,E as an,aw as wb,aM as zY,aj as YY}from"./index-eac9fe8b.js";import"./index-11e546f7.js";import{a as vk}from"./index-80d925ed.js";import{V as GY}from"./index.min-2d0407fd.js";var je=function(e){try{return!!e()}catch{return!0}},KY=je,qd=!KY(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),uj=qd,fj=Function.prototype,oC=fj.call,qY=uj&&fj.bind.bind(oC,oC),Ye=uj?qY:function(e){return function(){return oC.apply(e,arguments)}},cj=Ye,XY=cj({}.toString),ZY=cj("".slice),Un=function(e){return ZY(XY(e),8,-1)},QY=Ye,JY=je,eG=Un,Sb=Object,tG=QY("".split),Xd=JY(function(){return!Sb("z").propertyIsEnumerable(0)})?function(e){return eG(e)=="String"?tG(e,""):Sb(e)}:Sb,_n=function(e){return e==null},rG=_n,nG=TypeError,Ar=function(e){if(rG(e))throw nG("Can't call method on "+e);return e},oG=Xd,iG=Ar,zr=function(e){return oG(iG(e))},Wv=function(e){return e&&e.Math==Math&&e},vt=Wv(typeof globalThis=="object"&&globalThis)||Wv(typeof window=="object"&&window)||Wv(typeof self=="object"&&self)||Wv(typeof Zy=="object"&&Zy)||function(){return this}()||Zy||Function("return this")(),hj={exports:{}},aG=!1,yk=vt,lG=Object.defineProperty,i0=function(e,t){try{lG(yk,e,{value:t,configurable:!0,writable:!0})}catch{yk[e]=t}return t},sG=vt,uG=i0,gk="__core-js_shared__",fG=sG[gk]||uG(gk,{}),a0=fG,pk=a0;(hj.exports=function(e,t){return pk[e]||(pk[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Sf=hj.exports,cG=Ar,hG=Object,Ir=function(e){return hG(cG(e))},dG=Ye,vG=Ir,yG=dG({}.hasOwnProperty),Nt=Object.hasOwn||function(t,r){return yG(vG(t),r)},gG=Ye,pG=0,mG=Math.random(),bG=gG(1 .toString),nm=function(e){return"Symbol("+(e===void 0?"":e)+")_"+bG(++pG+mG,36)},Ja=typeof navigator<"u"&&String(navigator.userAgent)||"",dj=vt,Cb=Ja,mk=dj.process,bk=dj.Deno,wk=mk&&mk.versions||bk&&bk.version,Sk=wk&&wk.v8,dn,Fg;Sk&&(dn=Sk.split("."),Fg=dn[0]>0&&dn[0]<4?1:+(dn[0]+dn[1]));!Fg&&Cb&&(dn=Cb.match(/Edge\/(\d+)/),(!dn||dn[1]>=74)&&(dn=Cb.match(/Chrome\/(\d+)/),dn&&(Fg=+dn[1])));var Zd=Fg,Ck=Zd,wG=je,SG=vt,CG=SG.String,Cf=!!Object.getOwnPropertySymbols&&!wG(function(){var e=Symbol();return!CG(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ck&&Ck<41}),_G=Cf,vj=_G&&!Symbol.sham&&typeof Symbol.iterator=="symbol",OG=vt,RG=Sf,_k=Nt,EG=nm,TG=Cf,PG=vj,Gl=OG.Symbol,_b=RG("wks"),kG=PG?Gl.for||Gl:Gl&&Gl.withoutSetter||EG,wt=function(e){return _k(_b,e)||(_b[e]=TG&&_k(Gl,e)?Gl[e]:kG("Symbol."+e)),_b[e]},iC=typeof document=="object"&&document.all,$G=typeof iC>"u"&&iC!==void 0,yj={all:iC,IS_HTMLDDA:$G},gj=yj,AG=gj.all,Ot=gj.IS_HTMLDDA?function(e){return typeof e=="function"||e===AG}:function(e){return typeof e=="function"},Ok=Ot,pj=yj,IG=pj.all,Yt=pj.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Ok(e)||e===IG}:function(e){return typeof e=="object"?e!==null:Ok(e)},MG=Yt,xG=String,DG=TypeError,jt=function(e){if(MG(e))return e;throw DG(xG(e)+" is not an object")},l0={},NG=je,Gt=!NG(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),HG=Gt,LG=je,mj=HG&&LG(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),_r={},jG=vt,Rk=Yt,aC=jG.document,FG=Rk(aC)&&Rk(aC.createElement),om=function(e){return FG?aC.createElement(e):{}},BG=Gt,VG=je,WG=om,bj=!BG&&!VG(function(){return Object.defineProperty(WG("div"),"a",{get:function(){return 7}}).a!=7}),UG=qd,Uv=Function.prototype.call,Zt=UG?Uv.bind(Uv):function(){return Uv.apply(Uv,arguments)},Ob=vt,zG=Ot,YG=function(e){return zG(e)?e:void 0},Uo=function(e,t){return arguments.length<2?YG(Ob[e]):Ob[e]&&Ob[e][t]},GG=Ye,Di=GG({}.isPrototypeOf),KG=Uo,qG=Ot,XG=Di,ZG=vj,QG=Object,Qd=ZG?function(e){return typeof e=="symbol"}:function(e){var t=KG("Symbol");return qG(t)&&XG(t.prototype,QG(e))},JG=String,_f=function(e){try{return JG(e)}catch{return"Object"}},e3=Ot,t3=_f,r3=TypeError,el=function(e){if(e3(e))return e;throw r3(t3(e)+" is not a function")},n3=el,o3=_n,tl=function(e,t){var r=e[t];return o3(r)?void 0:n3(r)},Rb=Zt,Eb=Ot,Tb=Yt,i3=TypeError,wj=function(e,t){var r,n;if(t==="string"&&Eb(r=e.toString)&&!Tb(n=Rb(r,e))||Eb(r=e.valueOf)&&!Tb(n=Rb(r,e))||t!=="string"&&Eb(r=e.toString)&&!Tb(n=Rb(r,e)))return n;throw i3("Can't convert object to primitive value")},a3=Zt,Ek=Yt,Tk=Qd,l3=tl,s3=wj,u3=wt,f3=TypeError,c3=u3("toPrimitive"),Sj=function(e,t){if(!Ek(e)||Tk(e))return e;var r=l3(e,c3),n;if(r){if(t===void 0&&(t="default"),n=a3(r,e,t),!Ek(n)||Tk(n))return n;throw f3("Can't convert object to primitive value")}return t===void 0&&(t="number"),s3(e,t)},h3=Sj,d3=Qd,im=function(e){var t=h3(e,"string");return d3(t)?t:t+""},v3=Gt,y3=bj,g3=mj,zv=jt,Pk=im,p3=TypeError,Pb=Object.defineProperty,m3=Object.getOwnPropertyDescriptor,kb="enumerable",$b="configurable",Ab="writable";_r.f=v3?g3?function(t,r,n){if(zv(t),r=Pk(r),zv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Ab in n&&!n[Ab]){var o=m3(t,r);o&&o[Ab]&&(t[r]=n.value,n={configurable:$b in n?n[$b]:o[$b],enumerable:kb in n?n[kb]:o[kb],writable:!1})}return Pb(t,r,n)}:Pb:function(t,r,n){if(zv(t),r=Pk(r),zv(n),y3)try{return Pb(t,r,n)}catch{}if("get"in n||"set"in n)throw p3("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var b3=Math.ceil,w3=Math.floor,S3=Math.trunc||function(t){var r=+t;return(r>0?w3:b3)(r)},C3=S3,Ni=function(e){var t=+e;return t!==t||t===0?0:C3(t)},_3=Ni,O3=Math.max,R3=Math.min,Jd=function(e,t){var r=_3(e);return r<0?O3(r+t,0):R3(r,t)},E3=Ni,T3=Math.min,rl=function(e){return e>0?T3(E3(e),9007199254740991):0},P3=rl,en=function(e){return P3(e.length)},k3=zr,$3=Jd,A3=en,kk=function(e){return function(t,r,n){var o=k3(t),i=A3(o),a=$3(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},s0={includes:kk(!0),indexOf:kk(!1)},ev={},I3=Ye,Ib=Nt,M3=zr,x3=s0.indexOf,D3=ev,$k=I3([].push),Cj=function(e,t){var r=M3(e),n=0,o=[],i;for(i in r)!Ib(D3,i)&&Ib(r,i)&&$k(o,i);for(;t.length>n;)Ib(r,i=t[n++])&&(~x3(o,i)||$k(o,i));return o},u0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],N3=Cj,H3=u0,tv=Object.keys||function(t){return N3(t,H3)},L3=Gt,j3=mj,F3=_r,B3=jt,V3=zr,W3=tv;l0.f=L3&&!j3?Object.defineProperties:function(t,r){B3(t);for(var n=V3(r),o=W3(r),i=o.length,a=0,l;i>a;)F3.f(t,l=o[a++],n[l]);return t};var U3=Uo,_j=U3("document","documentElement"),z3=Sf,Y3=nm,Ak=z3("keys"),am=function(e){return Ak[e]||(Ak[e]=Y3(e))},G3=jt,K3=l0,Ik=u0,q3=ev,X3=_j,Z3=om,Q3=am,Mk=">",xk="<",lC="prototype",sC="script",Oj=Q3("IE_PROTO"),Mb=function(){},Rj=function(e){return xk+sC+Mk+e+xk+"/"+sC+Mk},Dk=function(e){e.write(Rj("")),e.close();var t=e.parentWindow.Object;return e=null,t},J3=function(){var e=Z3("iframe"),t="java"+sC+":",r;return e.style.display="none",X3.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(Rj("document.F=Object")),r.close(),r.F},Yv,Qy=function(){try{Yv=new ActiveXObject("htmlfile")}catch{}Qy=typeof document<"u"?document.domain&&Yv?Dk(Yv):J3():Dk(Yv);for(var e=Ik.length;e--;)delete Qy[lC][Ik[e]];return Qy()};q3[Oj]=!0;var Of=Object.create||function(t,r){var n;return t!==null?(Mb[lC]=G3(t),n=new Mb,Mb[lC]=null,n[Oj]=t):n=Qy(),r===void 0?n:K3.f(n,r)},eK=wt,tK=Of,rK=_r.f,uC=eK("unscopables"),fC=Array.prototype;fC[uC]==null&&rK(fC,uC,{configurable:!0,value:tK(null)});var rv=function(e){fC[uC][e]=!0},nv={},nK=vt,oK=Ot,Nk=nK.WeakMap,Ej=oK(Nk)&&/native code/.test(String(Nk)),ov=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},iK=Gt,aK=_r,lK=ov,nl=iK?function(e,t,r){return aK.f(e,t,lK(1,r))}:function(e,t,r){return e[t]=r,e},sK=Ej,Tj=vt,uK=Yt,fK=nl,xb=Nt,Db=a0,cK=am,hK=ev,Hk="Object already initialized",cC=Tj.TypeError,dK=Tj.WeakMap,Bg,Vc,Vg,vK=function(e){return Vg(e)?Vc(e):Bg(e,{})},yK=function(e){return function(t){var r;if(!uK(t)||(r=Vc(t)).type!==e)throw cC("Incompatible receiver, "+e+" required");return r}};if(sK||Db.state){var Rn=Db.state||(Db.state=new dK);Rn.get=Rn.get,Rn.has=Rn.has,Rn.set=Rn.set,Bg=function(e,t){if(Rn.has(e))throw cC(Hk);return t.facade=e,Rn.set(e,t),t},Vc=function(e){return Rn.get(e)||{}},Vg=function(e){return Rn.has(e)}}else{var hl=cK("state");hK[hl]=!0,Bg=function(e,t){if(xb(e,hl))throw cC(Hk);return t.facade=e,fK(e,hl,t),t},Vc=function(e){return xb(e,hl)?e[hl]:{}},Vg=function(e){return xb(e,hl)}}var zo={set:Bg,get:Vc,has:Vg,enforce:vK,getterFor:yK},zn={},iv={},Pj={}.propertyIsEnumerable,kj=Object.getOwnPropertyDescriptor,gK=kj&&!Pj.call({1:2},1);iv.f=gK?function(t){var r=kj(this,t);return!!r&&r.enumerable}:Pj;var pK=Gt,mK=Zt,bK=iv,wK=ov,SK=zr,CK=im,_K=Nt,OK=bj,Lk=Object.getOwnPropertyDescriptor;zn.f=pK?Lk:function(t,r){if(t=SK(t),r=CK(r),OK)try{return Lk(t,r)}catch{}if(_K(t,r))return wK(!mK(bK.f,t,r),t[r])};var $j={exports:{}},hC=Gt,RK=Nt,Aj=Function.prototype,EK=hC&&Object.getOwnPropertyDescriptor,f0=RK(Aj,"name"),TK=f0&&function(){}.name==="something",PK=f0&&(!hC||hC&&EK(Aj,"name").configurable),av={EXISTS:f0,PROPER:TK,CONFIGURABLE:PK},kK=Ye,$K=Ot,dC=a0,AK=kK(Function.toString);$K(dC.inspectSource)||(dC.inspectSource=function(e){return AK(e)});var Ij=dC.inspectSource,c0=Ye,IK=je,MK=Ot,Gv=Nt,vC=Gt,xK=av.CONFIGURABLE,DK=Ij,Mj=zo,NK=Mj.enforce,HK=Mj.get,jk=String,Jy=Object.defineProperty,LK=c0("".slice),jK=c0("".replace),FK=c0([].join),BK=vC&&!IK(function(){return Jy(function(){},"length",{value:8}).length!==8}),VK=String(String).split("String"),WK=$j.exports=function(e,t,r){LK(jk(t),0,7)==="Symbol("&&(t="["+jK(jk(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Gv(e,"name")||xK&&e.name!==t)&&(vC?Jy(e,"name",{value:t,configurable:!0}):e.name=t),BK&&r&&Gv(r,"arity")&&e.length!==r.arity&&Jy(e,"length",{value:r.arity});try{r&&Gv(r,"constructor")&&r.constructor?vC&&Jy(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=NK(e);return Gv(n,"source")||(n.source=FK(VK,typeof t=="string"?t:"")),e};Function.prototype.toString=WK(function(){return MK(this)&&HK(this).source||DK(this)},"toString");var xj=$j.exports,UK=Ot,zK=_r,YK=xj,GK=i0,tn=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(UK(r)&&YK(r,i,n),n.global)o?e[t]=r:GK(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:zK.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},ol={},KK=Cj,qK=u0,XK=qK.concat("length","prototype");ol.f=Object.getOwnPropertyNames||function(t){return KK(t,XK)};var lv={};lv.f=Object.getOwnPropertySymbols;var ZK=Uo,QK=Ye,JK=ol,e4=lv,t4=jt,r4=QK([].concat),Dj=ZK("Reflect","ownKeys")||function(t){var r=JK.f(t4(t)),n=e4.f;return n?r4(r,n(t)):r},Fk=Nt,n4=Dj,o4=zn,i4=_r,Nj=function(e,t,r){for(var n=n4(t),o=i4.f,i=o4.f,a=0;a<n.length;a++){var l=n[a];!Fk(e,l)&&!(r&&Fk(r,l))&&o(e,l,i(t,l))}},a4=je,l4=Ot,s4=/#|\.prototype\./,sv=function(e,t){var r=f4[u4(e)];return r==h4?!0:r==c4?!1:l4(t)?a4(t):!!t},u4=sv.normalize=function(e){return String(e).replace(s4,".").toLowerCase()},f4=sv.data={},c4=sv.NATIVE="N",h4=sv.POLYFILL="P",lm=sv,Nb=vt,d4=zn.f,v4=nl,y4=tn,g4=i0,p4=Nj,m4=lm,$e=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Nb:o?a=Nb[r]||g4(r,{}):a=(Nb[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=d4(a,l),s=f&&f.value):s=a[l],i=m4(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;p4(u,s)}(e.sham||s&&s.sham)&&v4(u,"sham",!0),y4(a,l,u,e)}},b4=je,Hj=!b4(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),w4=Nt,S4=Ot,C4=Ir,_4=am,O4=Hj,Bk=_4("IE_PROTO"),yC=Object,R4=yC.prototype,uv=O4?yC.getPrototypeOf:function(e){var t=C4(e);if(w4(t,Bk))return t[Bk];var r=t.constructor;return S4(r)&&t instanceof r?r.prototype:t instanceof yC?R4:null},E4=je,T4=Ot,P4=Yt,Vk=uv,k4=tn,$4=wt,gC=$4("iterator"),Lj=!1,ja,Hb,Lb;[].keys&&(Lb=[].keys(),"next"in Lb?(Hb=Vk(Vk(Lb)),Hb!==Object.prototype&&(ja=Hb)):Lj=!0);var A4=!P4(ja)||E4(function(){var e={};return ja[gC].call(e)!==e});A4&&(ja={});T4(ja[gC])||k4(ja,gC,function(){return this});var jj={IteratorPrototype:ja,BUGGY_SAFARI_ITERATORS:Lj},I4=_r.f,M4=Nt,x4=wt,Wk=x4("toStringTag"),sm=function(e,t,r){e&&!r&&(e=e.prototype),e&&!M4(e,Wk)&&I4(e,Wk,{configurable:!0,value:t})},D4=jj.IteratorPrototype,N4=Of,H4=ov,L4=sm,j4=nv,F4=function(){return this},B4=function(e,t,r,n){var o=t+" Iterator";return e.prototype=N4(D4,{next:H4(+!n,r)}),L4(e,o,!1),j4[o]=F4,e},V4=Ye,W4=el,U4=function(e,t,r){try{return V4(W4(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},z4=Ot,Y4=String,G4=TypeError,K4=function(e){if(typeof e=="object"||z4(e))return e;throw G4("Can't set "+Y4(e)+" as a prototype")},q4=U4,X4=jt,Z4=K4,h0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=q4(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return X4(o),Z4(i),e?r(o,i):o.__proto__=i,o}}():void 0),Q4=$e,J4=Zt,Fj=av,e6=Ot,t6=B4,Uk=uv,zk=h0,r6=sm,n6=nl,jb=tn,o6=wt,i6=nv,Bj=jj,a6=Fj.PROPER,l6=Fj.CONFIGURABLE,Yk=Bj.IteratorPrototype,Kv=Bj.BUGGY_SAFARI_ITERATORS,Ff=o6("iterator"),Gk="keys",Bf="values",Kk="entries",s6=function(){return this},d0=function(e,t,r,n,o,i,a){t6(r,t,n);var l=function(w){if(w===o&&h)return h;if(!Kv&&w in f)return f[w];switch(w){case Gk:return function(){return new r(this,w)};case Bf:return function(){return new r(this,w)};case Kk:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Ff]||f["@@iterator"]||o&&f[o],h=!Kv&&c||l(o),d=t=="Array"&&f.entries||c,v,y,m;if(d&&(v=Uk(d.call(new e)),v!==Object.prototype&&v.next&&(Uk(v)!==Yk&&(zk?zk(v,Yk):e6(v[Ff])||jb(v,Ff,s6)),r6(v,s,!0))),a6&&o==Bf&&c&&c.name!==Bf&&(l6?n6(f,"name",Bf):(u=!0,h=function(){return J4(c,this)})),o)if(y={values:l(Bf),keys:i?h:l(Gk),entries:l(Kk)},a)for(m in y)(Kv||u||!(m in f))&&jb(f,m,y[m]);else Q4({target:t,proto:!0,forced:Kv||u},y);return f[Ff]!==h&&jb(f,Ff,h,{name:o}),i6[t]=h,y},v0=function(e,t){return{value:e,done:t}},u6=zr,y0=rv,qk=nv,Vj=zo,f6=_r.f,c6=d0,qv=v0,h6=Gt,Wj="Array Iterator",d6=Vj.set,v6=Vj.getterFor(Wj),y6=c6(Array,"Array",function(e,t){d6(this,{type:Wj,target:u6(e),index:0,kind:t})},function(){var e=v6(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,qv(void 0,!0)):r=="keys"?qv(n,!1):r=="values"?qv(t[n],!1):qv([n,t[n]],!1)},"values"),Xk=qk.Arguments=qk.Array;y0("keys");y0("values");y0("entries");if(h6&&Xk.name!=="values")try{f6(Xk,"name",{value:"values"})}catch{}var g6=wt,p6=g6("toStringTag"),Uj={};Uj[p6]="z";var g0=String(Uj)==="[object z]",m6=g0,b6=Ot,eg=Un,w6=wt,S6=w6("toStringTag"),C6=Object,_6=eg(function(){return arguments}())=="Arguments",O6=function(e,t){try{return e[t]}catch{}},um=m6?eg:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=O6(t=C6(e),S6))=="string"?r:_6?eg(t):(n=eg(t))=="Object"&&b6(t.callee)?"Arguments":n},R6=g0,E6=um,T6=R6?{}.toString:function(){return"[object "+E6(this)+"]"},P6=g0,k6=tn,$6=T6;P6||k6(Object.prototype,"toString",$6,{unsafe:!0});var A6=um,I6=String,Kt=function(e){if(A6(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return I6(e)},p0=Ye,M6=Ni,x6=Kt,D6=Ar,N6=p0("".charAt),Zk=p0("".charCodeAt),H6=p0("".slice),Qk=function(e){return function(t,r){var n=x6(D6(t)),o=M6(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=Zk(n,o),a<55296||a>56319||o+1===i||(l=Zk(n,o+1))<56320||l>57343?e?N6(n,o):a:e?H6(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},m0={codeAt:Qk(!1),charAt:Qk(!0)},L6=m0.charAt,j6=Kt,zj=zo,F6=d0,Jk=v0,Yj="String Iterator",B6=zj.set,V6=zj.getterFor(Yj);F6(String,"String",function(e){B6(this,{type:Yj,string:j6(e),index:0})},function(){var t=V6(this),r=t.string,n=t.index,o;return n>=r.length?Jk(void 0,!0):(o=L6(r,n),t.index+=o.length,Jk(o,!1))});var W6=je,b0=!W6(function(){return Object.isExtensible(Object.preventExtensions({}))}),U6=tn,w0=function(e,t,r){for(var n in t)U6(e,n,t[n],r);return e},Gj={exports:{}},fm={},z6=im,Y6=_r,G6=ov,Rf=function(e,t,r){var n=z6(t);n in e?Y6.f(e,n,G6(0,r)):e[n]=r},e$=Jd,K6=en,q6=Rf,X6=Array,Z6=Math.max,S0=function(e,t,r){for(var n=K6(e),o=e$(t,n),i=e$(r===void 0?n:r,n),a=X6(Z6(i-o,0)),l=0;o<i;o++,l++)q6(a,l,e[o]);return a.length=l,a},Q6=Un,J6=zr,Kj=ol.f,e8=S0,qj=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],t8=function(e){try{return Kj(e)}catch{return e8(qj)}};fm.f=function(t){return qj&&Q6(t)=="Window"?t8(t):Kj(J6(t))};var r8=je,n8=r8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),o8=je,i8=Yt,a8=Un,t$=n8,tg=Object.isExtensible,l8=o8(function(){tg(1)}),s8=l8||t$?function(t){return!i8(t)||t$&&a8(t)=="ArrayBuffer"?!1:tg?tg(t):!0}:tg,u8=$e,f8=Ye,c8=ev,h8=Yt,C0=Nt,d8=_r.f,r$=ol,v8=fm,_0=s8,y8=nm,g8=b0,Xj=!1,jo=y8("meta"),p8=0,O0=function(e){d8(e,jo,{value:{objectID:"O"+p8++,weakData:{}}})},m8=function(e,t){if(!h8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!C0(e,jo)){if(!_0(e))return"F";if(!t)return"E";O0(e)}return e[jo].objectID},b8=function(e,t){if(!C0(e,jo)){if(!_0(e))return!0;if(!t)return!1;O0(e)}return e[jo].weakData},w8=function(e){return g8&&Xj&&_0(e)&&!C0(e,jo)&&O0(e),e},S8=function(){C8.enable=function(){},Xj=!0;var e=r$.f,t=f8([].splice),r={};r[jo]=1,e(r).length&&(r$.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===jo){t(o,i,1);break}return o},u8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:v8.f}))},C8=Gj.exports={enable:S8,fastKey:m8,getWeakData:b8,onFreeze:w8};c8[jo]=!0;var fv=Gj.exports,_8=Un,O8=Ye,cv=function(e){if(_8(e)==="Function")return O8(e)},n$=cv,R8=el,E8=qd,T8=n$(n$.bind),hv=function(e,t){return R8(e),t===void 0?e:E8?T8(e,t):function(){return e.apply(t,arguments)}},P8=wt,k8=nv,$8=P8("iterator"),A8=Array.prototype,Zj=function(e){return e!==void 0&&(k8.Array===e||A8[$8]===e)},I8=um,o$=tl,M8=_n,x8=nv,D8=wt,N8=D8("iterator"),R0=function(e){if(!M8(e))return o$(e,N8)||o$(e,"@@iterator")||x8[I8(e)]},H8=Zt,L8=el,j8=jt,F8=_f,B8=R0,V8=TypeError,Qj=function(e,t){var r=arguments.length<2?B8(e):t;if(L8(r))return j8(H8(r,e));throw V8(F8(e)+" is not iterable")},W8=Zt,i$=jt,U8=tl,Jj=function(e,t,r){var n,o;i$(e);try{if(n=U8(e,"return"),!n){if(t==="throw")throw r;return r}n=W8(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return i$(n),r},z8=hv,Y8=Zt,G8=jt,K8=_f,q8=Zj,X8=en,a$=Di,Z8=Qj,Q8=R0,l$=Jj,J8=TypeError,rg=function(e,t){this.stopped=e,this.result=t},s$=rg.prototype,E0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=z8(t,n),u,f,c,h,d,v,y,m=function(C){return u&&l$(u,"normal",C),new rg(!0,C)},w=function(C){return o?(G8(C),l?s(C[0],C[1],m):s(C[0],C[1])):l?s(C,m):s(C)};if(i)u=e.iterator;else if(a)u=e;else{if(f=Q8(e),!f)throw J8(K8(e)+" is not iterable");if(q8(f)){for(c=0,h=X8(e);h>c;c++)if(d=w(e[c]),d&&a$(s$,d))return d;return new rg(!1)}u=Z8(e,f)}for(v=i?e.next:u.next;!(y=Y8(v,u)).done;){try{d=w(y.value)}catch(C){l$(u,"throw",C)}if(typeof d=="object"&&d&&a$(s$,d))return d}return new rg(!1)},e5=Di,t5=TypeError,T0=function(e,t){if(e5(t,e))return e;throw t5("Incorrect invocation")},r5=wt,eF=r5("iterator"),tF=!1;try{var n5=0,u$={next:function(){return{done:!!n5++}},return:function(){tF=!0}};u$[eF]=function(){return this},Array.from(u$,function(){throw 2})}catch{}var rF=function(e,t){if(!t&&!tF)return!1;var r=!1;try{var n={};n[eF]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},o5=Ot,i5=Yt,f$=h0,P0=function(e,t,r){var n,o;return f$&&o5(n=t.constructor)&&n!==r&&i5(o=n.prototype)&&o!==r.prototype&&f$(e,o),e},a5=$e,l5=vt,s5=Ye,c$=lm,u5=tn,f5=fv,c5=E0,h5=T0,d5=Ot,v5=_n,Fb=Yt,Bb=je,y5=rF,g5=sm,p5=P0,cm=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=l5[e],l=a&&a.prototype,s=a,u={},f=function(w){var C=s5(l[w]);u5(l,w,w=="add"?function(R){return C(this,R===0?0:R),this}:w=="delete"?function(S){return o&&!Fb(S)?!1:C(this,S===0?0:S)}:w=="get"?function(R){return o&&!Fb(R)?void 0:C(this,R===0?0:R)}:w=="has"?function(R){return o&&!Fb(R)?!1:C(this,R===0?0:R)}:function(R,O){return C(this,R===0?0:R,O),this})},c=c$(e,!d5(a)||!(o||l.forEach&&!Bb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),f5.enable();else if(c$(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=Bb(function(){h.has(1)}),y=y5(function(w){new a(w)}),m=!o&&Bb(function(){for(var w=new a,C=5;C--;)w[i](C,C);return!w.has(-0)});y||(s=t(function(w,C){h5(w,l);var S=p5(new a,w,s);return v5(C)||c5(C,S[i],{that:S,AS_ENTRIES:n}),S}),s.prototype=l,l.constructor=s),(v||m)&&(f("delete"),f("has"),n&&f("get")),(m||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,a5({global:!0,constructor:!0,forced:s!=a},u),g5(s,e),o||r.setStrong(s,e,n),s},m5=Un,Ef=Array.isArray||function(t){return m5(t)=="Array"},b5=Ye,w5=je,nF=Ot,S5=um,C5=Uo,_5=Ij,oF=function(){},O5=[],iF=C5("Reflect","construct"),k0=/^\s*(?:class|function)\b/,R5=b5(k0.exec),E5=!k0.exec(oF),Vf=function(t){if(!nF(t))return!1;try{return iF(oF,O5,t),!0}catch{return!1}},aF=function(t){if(!nF(t))return!1;switch(S5(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return E5||!!R5(k0,_5(t))}catch{return!0}};aF.sham=!0;var hm=!iF||w5(function(){var e;return Vf(Vf.call)||!Vf(Object)||!Vf(function(){e=!0})||e})?aF:Vf,h$=Ef,T5=hm,P5=Yt,k5=wt,$5=k5("species"),d$=Array,A5=function(e){var t;return h$(e)&&(t=e.constructor,T5(t)&&(t===d$||h$(t.prototype))?t=void 0:P5(t)&&(t=t[$5],t===null&&(t=void 0))),t===void 0?d$:t},I5=A5,$0=function(e,t){return new(I5(e))(t===0?0:t)},M5=hv,x5=Ye,D5=Xd,N5=Ir,H5=en,L5=$0,v$=x5([].push),Xo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,f,c){for(var h=N5(s),d=D5(h),v=M5(u,f),y=H5(d),m=0,w=c||L5,C=t?w(s,y):r||a?w(s,0):void 0,S,R;y>m;m++)if((l||m in d)&&(S=d[m],R=v(S,m,h),e))if(t)C[m]=R;else if(R)switch(e){case 3:return!0;case 5:return S;case 6:return m;case 2:v$(C,S)}else switch(e){case 4:return!1;case 7:v$(C,S)}return i?-1:n||o?o:C}},il={forEach:Xo(0),map:Xo(1),filter:Xo(2),some:Xo(3),every:Xo(4),find:Xo(5),findIndex:Xo(6),filterReject:Xo(7)},j5=Ye,y$=w0,Xv=fv.getWeakData,F5=T0,B5=jt,V5=_n,Vb=Yt,W5=E0,lF=il,g$=Nt,sF=zo,U5=sF.set,z5=sF.getterFor,Y5=lF.find,G5=lF.findIndex,K5=j5([].splice),q5=0,Zv=function(e){return e.frozen||(e.frozen=new uF)},uF=function(){this.entries=[]},Wb=function(e,t){return Y5(e.entries,function(r){return r[0]===t})};uF.prototype={get:function(e){var t=Wb(this,e);if(t)return t[1]},has:function(e){return!!Wb(this,e)},set:function(e,t){var r=Wb(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=G5(this.entries,function(r){return r[0]===e});return~t&&K5(this.entries,t,1),!!~t}};var fF={getConstructor:function(e,t,r,n){var o=e(function(s,u){F5(s,i),U5(s,{type:t,id:q5++,frozen:void 0}),V5(u)||W5(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=z5(t),l=function(s,u,f){var c=a(s),h=Xv(B5(u),!0);return h===!0?Zv(c).set(u,f):h[c.id]=f,s};return y$(i,{delete:function(s){var u=a(this);if(!Vb(s))return!1;var f=Xv(s);return f===!0?Zv(u).delete(s):f&&g$(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!Vb(u))return!1;var c=Xv(u);return c===!0?Zv(f).has(u):c&&g$(c,f.id)}}),y$(i,r?{get:function(u){var f=a(this);if(Vb(u)){var c=Xv(u);return c===!0?Zv(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},X5=b0,p$=vt,ng=Ye,m$=w0,Z5=fv,Q5=cm,cF=fF,Qv=Yt,Jv=zo.enforce,J5=je,e7=Ej,dv=Object,t7=Array.isArray,ey=dv.isExtensible,hF=dv.isFrozen,r7=dv.isSealed,dF=dv.freeze,n7=dv.seal,b$={},w$={},o7=!p$.ActiveXObject&&"ActiveXObject"in p$,Wf,vF=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},yF=Q5("WeakMap",vF,cF),Vl=yF.prototype,og=ng(Vl.set),i7=function(){return X5&&J5(function(){var e=dF([]);return og(new yF,e,1),!hF(e)})};if(e7)if(o7){Wf=cF.getConstructor(vF,"WeakMap",!0),Z5.enable();var S$=ng(Vl.delete),ty=ng(Vl.has),C$=ng(Vl.get);m$(Vl,{delete:function(e){if(Qv(e)&&!ey(e)){var t=Jv(this);return t.frozen||(t.frozen=new Wf),S$(this,e)||t.frozen.delete(e)}return S$(this,e)},has:function(t){if(Qv(t)&&!ey(t)){var r=Jv(this);return r.frozen||(r.frozen=new Wf),ty(this,t)||r.frozen.has(t)}return ty(this,t)},get:function(t){if(Qv(t)&&!ey(t)){var r=Jv(this);return r.frozen||(r.frozen=new Wf),ty(this,t)?C$(this,t):r.frozen.get(t)}return C$(this,t)},set:function(t,r){if(Qv(t)&&!ey(t)){var n=Jv(this);n.frozen||(n.frozen=new Wf),ty(this,t)?og(this,t,r):n.frozen.set(t,r)}else og(this,t,r);return this}})}else i7()&&m$(Vl,{set:function(t,r){var n;return t7(t)&&(hF(t)?n=b$:r7(t)&&(n=w$)),og(this,t,r),n==b$&&dF(t),n==w$&&n7(t),this}});var gF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},a7=om,Ub=a7("span").classList,_$=Ub&&Ub.constructor&&Ub.constructor.prototype,pF=_$===Object.prototype?void 0:_$,O$=vt,mF=gF,l7=pF,pc=y6,zb=nl,bF=wt,Yb=bF("iterator"),R$=bF("toStringTag"),Gb=pc.values,wF=function(e,t){if(e){if(e[Yb]!==Gb)try{zb(e,Yb,Gb)}catch{e[Yb]=Gb}if(e[R$]||zb(e,R$,t),mF[t]){for(var r in pc)if(e[r]!==pc[r])try{zb(e,r,pc[r])}catch{e[r]=pc[r]}}}};for(var Kb in mF)wF(O$[Kb]&&O$[Kb].prototype,Kb);wF(l7,"DOMTokenList");var s7=je,Tf=function(e,t){var r=[][e];return!!r&&s7(function(){r.call(null,t||function(){return 1},1)})},u7=$e,f7=cv,c7=s0.indexOf,h7=Tf,pC=f7([].indexOf),SF=!!pC&&1/pC([1],1,-0)<0,d7=SF||!h7("indexOf");u7({target:"Array",proto:!0,forced:d7},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return SF?pC(this,t,r)||0:c7(this,t,r)}});var E$=_f,v7=TypeError,CF=function(e,t){if(!delete e[t])throw v7("Cannot delete property "+E$(t)+" of "+E$(e))},T$=S0,y7=Math.floor,mC=function(e,t){var r=e.length,n=y7(r/2);return r<8?g7(e,t):p7(e,mC(T$(e,0,n),t),mC(T$(e,n),t),t)},g7=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},p7=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},m7=mC,b7=Ja,P$=b7.match(/firefox\/(\d+)/i),w7=!!P$&&+P$[1],S7=Ja,C7=/MSIE|Trident/.test(S7),_7=Ja,k$=_7.match(/AppleWebKit\/(\d+)\./),O7=!!k$&&+k$[1],R7=$e,_F=Ye,E7=el,T7=Ir,$$=en,P7=CF,A$=Kt,A0=je,k7=m7,$7=Tf,I$=w7,A7=C7,M$=Zd,x$=O7,ci=[],D$=_F(ci.sort),I7=_F(ci.push),M7=A0(function(){ci.sort(void 0)}),x7=A0(function(){ci.sort(null)}),D7=$7("sort"),OF=!A0(function(){if(M$)return M$<70;if(!(I$&&I$>3)){if(A7)return!0;if(x$)return x$<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)ci.push({k:r+o,v:n})}for(ci.sort(function(i,a){return a.v-i.v}),o=0;o<ci.length;o++)r=ci[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),N7=M7||!x7||!D7||!OF,H7=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:A$(t)>A$(r)?1:-1}};R7({target:"Array",proto:!0,forced:N7},{sort:function(t){t!==void 0&&E7(t);var r=T7(this);if(OF)return t===void 0?D$(r):D$(r,t);var n=[],o=$$(r),i,a;for(a=0;a<o;a++)a in r&&I7(n,r[a]);for(k7(n,H7(t)),i=$$(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)P7(r,a++);return r}});var L7=$e,j7=il.find,F7=rv,bC="find",RF=!0;bC in[]&&Array(1)[bC](function(){RF=!1});L7({target:"Array",proto:!0,forced:RF},{find:function(t){return j7(this,t,arguments.length>1?arguments[1]:void 0)}});F7(bC);var B7=jt,EF=function(){var e=B7(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},I0=je,V7=vt,M0=V7.RegExp,x0=I0(function(){var e=M0("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),W7=x0||I0(function(){return!M0("a","y").sticky}),U7=x0||I0(function(){var e=M0("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),D0={BROKEN_CARET:U7,MISSED_STICKY:W7,UNSUPPORTED_Y:x0},z7=je,Y7=vt,G7=Y7.RegExp,TF=z7(function(){var e=G7(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),K7=je,q7=vt,X7=q7.RegExp,PF=K7(function(){var e=X7("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Kl=Zt,dm=Ye,Z7=Kt,Q7=EF,J7=D0,e9=Sf,t9=Of,r9=zo.get,n9=TF,o9=PF,i9=e9("native-string-replace",String.prototype.replace),Wg=RegExp.prototype.exec,wC=Wg,a9=dm("".charAt),l9=dm("".indexOf),s9=dm("".replace),qb=dm("".slice),SC=function(){var e=/a/,t=/b*/g;return Kl(Wg,e,"a"),Kl(Wg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),kF=J7.BROKEN_CARET,CC=/()??/.exec("")[1]!==void 0,u9=SC||CC||kF||n9||o9;u9&&(wC=function(t){var r=this,n=r9(r),o=Z7(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=Kl(wC,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=kF&&r.sticky,y=Kl(Q7,r),m=r.source,w=0,C=o;if(v&&(y=s9(y,"y",""),l9(y,"g")===-1&&(y+="g"),C=qb(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&a9(o,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",C=" "+C,w++),l=new RegExp("^(?:"+m+")",y)),CC&&(l=new RegExp("^"+m+"$(?!\\s)",y)),SC&&(s=r.lastIndex),u=Kl(Wg,v?l:r,C),v?u?(u.input=qb(u.input,w),u[0]=qb(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:SC&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),CC&&u&&u.length>1&&Kl(i9,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=t9(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var vm=wC,f9=$e,N$=vm;f9({target:"RegExp",proto:!0,forced:/./.exec!==N$},{exec:N$});var c9=qd,$F=Function.prototype,H$=$F.apply,L$=$F.call,al=typeof Reflect=="object"&&Reflect.apply||(c9?L$.bind(H$):function(){return L$.apply(H$,arguments)}),j$=cv,F$=tn,h9=vm,B$=je,AF=wt,d9=nl,v9=AF("species"),Xb=RegExp.prototype,ym=function(e,t,r,n){var o=AF(e),i=!B$(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!B$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[v9]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=j$(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=j$(u),y=f.exec;return y===h9||y===Xb.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});F$(String.prototype,e,s[0]),F$(Xb,o,s[1])}n&&d9(Xb[o],"sham",!0)},y9=m0.charAt,N0=function(e,t,r){return t+(r?y9(e,t).length:1)},H0=Ye,g9=Ir,p9=Math.floor,Zb=H0("".charAt),m9=H0("".replace),Qb=H0("".slice),b9=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,w9=/\$([$&'`]|\d{1,2})/g,S9=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=w9;return o!==void 0&&(o=g9(o),s=b9),m9(i,s,function(u,f){var c;switch(Zb(f,0)){case"$":return"$";case"&":return e;case"`":return Qb(t,0,r);case"'":return Qb(t,a);case"<":c=o[Qb(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=p9(h/10);return d===0?u:d<=l?n[d-1]===void 0?Zb(f,1):n[d-1]+Zb(f,1):u}c=n[h-1]}return c===void 0?"":c})},V$=Zt,C9=jt,_9=Ot,O9=Un,R9=vm,E9=TypeError,gm=function(e,t){var r=e.exec;if(_9(r)){var n=V$(r,e,t);return n!==null&&C9(n),n}if(O9(e)==="RegExp")return V$(R9,e,t);throw E9("RegExp#exec called on incompatible receiver")},T9=al,W$=Zt,pm=Ye,P9=ym,k9=je,$9=jt,A9=Ot,I9=_n,M9=Ni,x9=rl,dl=Kt,D9=Ar,N9=N0,H9=tl,L9=S9,j9=gm,F9=wt,_C=F9("replace"),B9=Math.max,V9=Math.min,W9=pm([].concat),Jb=pm([].push),U$=pm("".indexOf),z$=pm("".slice),U9=function(e){return e===void 0?e:String(e)},z9=function(){return"a".replace(/./,"$0")==="$0"}(),Y$=function(){return/./[_C]?/./[_C]("a","$0")==="":!1}(),Y9=!k9(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});P9("replace",function(e,t,r){var n=Y$?"$":"$0";return[function(i,a){var l=D9(this),s=I9(i)?void 0:H9(i,_C);return s?W$(s,i,l,a):W$(t,dl(l),i,a)},function(o,i){var a=$9(this),l=dl(o);if(typeof i=="string"&&U$(i,n)===-1&&U$(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=A9(i);u||(i=dl(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=j9(a,l);if(d===null||(Jb(h,d),!f))break;var v=dl(d[0]);v===""&&(a.lastIndex=N9(l,x9(a.lastIndex),c))}for(var y="",m=0,w=0;w<h.length;w++){d=h[w];for(var C=dl(d[0]),S=B9(V9(M9(d.index),l.length),0),R=[],O=1;O<d.length;O++)Jb(R,U9(d[O]));var j=d.groups;if(u){var U=W9([C],R,S,l);j!==void 0&&Jb(U,j);var q=dl(T9(i,void 0,U))}else q=L9(C,l,S,R,j,i);S>=m&&(y+=z$(l,m,S)+q,m=S+C.length)}return y+z$(l,m)}]},!Y9||!z9||Y$);var G9=je,K9=wt,q9=Zd,X9=K9("species"),vv=function(e){return q9>=51||!G9(function(){var t=[],r=t.constructor={};return r[X9]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Z9=$e,Q9=il.filter,J9=vv,eq=J9("filter");Z9({target:"Array",proto:!0,forced:!eq},{filter:function(t){return Q9(this,t,arguments.length>1?arguments[1]:void 0)}});var tq=vt,IF=tq,L0={},rq=wt;L0.f=rq;var G$=IF,nq=Nt,oq=L0,iq=_r.f,j0=function(e){var t=G$.Symbol||(G$.Symbol={});nq(t,e)||iq(t,e,{value:oq.f(e)})},aq=Zt,lq=Uo,sq=wt,uq=tn,MF=function(){var e=lq("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=sq("toPrimitive");t&&!t[n]&&uq(t,n,function(o){return aq(r,this)},{arity:1})},fq=j0,cq=MF;fq("toPrimitive");cq();var hq=jt,dq=wj,vq=TypeError,yq=function(e){if(hq(this),e==="string"||e==="default")e="string";else if(e!=="number")throw vq("Incorrect hint");return dq(this,e)},gq=Nt,pq=tn,mq=yq,bq=wt,K$=bq("toPrimitive"),q$=Date.prototype;gq(q$,K$)||pq(q$,K$,mq);var X$=xj,wq=_r,yv=function(e,t,r){return r.get&&X$(r.get,t,{getter:!0}),r.set&&X$(r.set,t,{setter:!0}),wq.f(e,t,r)},mm=$e,F0=vt,B0=Zt,Sq=Ye,ds=Gt,vs=Cf,Cq=je,nr=Nt,_q=Di,OC=jt,bm=zr,V0=im,Oq=Kt,RC=ov,Wc=Of,xF=tv,Rq=ol,DF=fm,Eq=lv,NF=zn,HF=_r,Tq=l0,LF=iv,ew=tn,Pq=yv,W0=Sf,kq=am,jF=ev,Z$=nm,$q=wt,Aq=L0,Iq=j0,Mq=MF,xq=sm,FF=zo,wm=il.forEach,$r=kq("hidden"),Sm="Symbol",Uc="prototype",Dq=FF.set,Q$=FF.getterFor(Sm),Qr=Object[Uc],Na=F0.Symbol,mc=Na&&Na[Uc],Nq=F0.TypeError,tw=F0.QObject,BF=NF.f,aa=HF.f,VF=DF.f,Hq=LF.f,WF=Sq([].push),Fo=W0("symbols"),gv=W0("op-symbols"),Lq=W0("wks"),EC=!tw||!tw[Uc]||!tw[Uc].findChild,TC=ds&&Cq(function(){return Wc(aa({},"a",{get:function(){return aa(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=BF(Qr,t);n&&delete Qr[t],aa(e,t,r),n&&e!==Qr&&aa(Qr,t,n)}:aa,rw=function(e,t){var r=Fo[e]=Wc(mc);return Dq(r,{type:Sm,tag:e,description:t}),ds||(r.description=t),r},Cm=function(t,r,n){t===Qr&&Cm(gv,r,n),OC(t);var o=V0(r);return OC(n),nr(Fo,o)?(n.enumerable?(nr(t,$r)&&t[$r][o]&&(t[$r][o]=!1),n=Wc(n,{enumerable:RC(0,!1)})):(nr(t,$r)||aa(t,$r,RC(1,{})),t[$r][o]=!0),TC(t,o,n)):aa(t,o,n)},U0=function(t,r){OC(t);var n=bm(r),o=xF(n).concat(YF(n));return wm(o,function(i){(!ds||B0(PC,n,i))&&Cm(t,i,n[i])}),t},jq=function(t,r){return r===void 0?Wc(t):U0(Wc(t),r)},PC=function(t){var r=V0(t),n=B0(Hq,this,r);return this===Qr&&nr(Fo,r)&&!nr(gv,r)?!1:n||!nr(this,r)||!nr(Fo,r)||nr(this,$r)&&this[$r][r]?n:!0},UF=function(t,r){var n=bm(t),o=V0(r);if(!(n===Qr&&nr(Fo,o)&&!nr(gv,o))){var i=BF(n,o);return i&&nr(Fo,o)&&!(nr(n,$r)&&n[$r][o])&&(i.enumerable=!0),i}},zF=function(t){var r=VF(bm(t)),n=[];return wm(r,function(o){!nr(Fo,o)&&!nr(jF,o)&&WF(n,o)}),n},YF=function(e){var t=e===Qr,r=VF(t?gv:bm(e)),n=[];return wm(r,function(o){nr(Fo,o)&&(!t||nr(Qr,o))&&WF(n,Fo[o])}),n};vs||(Na=function(){if(_q(mc,this))throw Nq("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:Oq(arguments[0]),r=Z$(t),n=function(o){this===Qr&&B0(n,gv,o),nr(this,$r)&&nr(this[$r],r)&&(this[$r][r]=!1),TC(this,r,RC(1,o))};return ds&&EC&&TC(Qr,r,{configurable:!0,set:n}),rw(r,t)},mc=Na[Uc],ew(mc,"toString",function(){return Q$(this).tag}),ew(Na,"withoutSetter",function(e){return rw(Z$(e),e)}),LF.f=PC,HF.f=Cm,Tq.f=U0,NF.f=UF,Rq.f=DF.f=zF,Eq.f=YF,Aq.f=function(e){return rw($q(e),e)},ds&&(Pq(mc,"description",{configurable:!0,get:function(){return Q$(this).description}}),ew(Qr,"propertyIsEnumerable",PC,{unsafe:!0})));mm({global:!0,constructor:!0,wrap:!0,forced:!vs,sham:!vs},{Symbol:Na});wm(xF(Lq),function(e){Iq(e)});mm({target:Sm,stat:!0,forced:!vs},{useSetter:function(){EC=!0},useSimple:function(){EC=!1}});mm({target:"Object",stat:!0,forced:!vs,sham:!ds},{create:jq,defineProperty:Cm,defineProperties:U0,getOwnPropertyDescriptor:UF});mm({target:"Object",stat:!0,forced:!vs},{getOwnPropertyNames:zF});Mq();xq(Na,Sm);jF[$r]=!0;var Fq=Cf,GF=Fq&&!!Symbol.for&&!!Symbol.keyFor,Bq=$e,Vq=Uo,Wq=Nt,Uq=Kt,KF=Sf,zq=GF,nw=KF("string-to-symbol-registry"),Yq=KF("symbol-to-string-registry");Bq({target:"Symbol",stat:!0,forced:!zq},{for:function(e){var t=Uq(e);if(Wq(nw,t))return nw[t];var r=Vq("Symbol")(t);return nw[t]=r,Yq[r]=t,r}});var Gq=$e,Kq=Nt,qq=Qd,Xq=_f,Zq=Sf,Qq=GF,J$=Zq("symbol-to-string-registry");Gq({target:"Symbol",stat:!0,forced:!Qq},{keyFor:function(t){if(!qq(t))throw TypeError(Xq(t)+" is not a symbol");if(Kq(J$,t))return J$[t]}});var Jq=Ye,pv=Jq([].slice),eX=Ye,e1=Ef,tX=Ot,t1=Un,rX=Kt,r1=eX([].push),nX=function(e){if(tX(e))return e;if(e1(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?r1(r,o):(typeof o=="number"||t1(o)=="Number"||t1(o)=="String")&&r1(r,rX(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(e1(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},oX=$e,qF=Uo,XF=al,iX=Zt,mv=Ye,ZF=je,n1=Ot,o1=Qd,QF=pv,aX=nX,lX=Cf,sX=String,vi=qF("JSON","stringify"),ry=mv(/./.exec),i1=mv("".charAt),uX=mv("".charCodeAt),fX=mv("".replace),cX=mv(1 .toString),hX=/[\uD800-\uDFFF]/g,a1=/^[\uD800-\uDBFF]$/,l1=/^[\uDC00-\uDFFF]$/,s1=!lX||ZF(function(){var e=qF("Symbol")();return vi([e])!="[null]"||vi({a:e})!="{}"||vi(Object(e))!="{}"}),u1=ZF(function(){return vi("\uDF06\uD834")!=='"\\udf06\\ud834"'||vi("\uDEAD")!=='"\\udead"'}),dX=function(e,t){var r=QF(arguments),n=aX(t);if(!(!n1(n)&&(e===void 0||o1(e))))return r[1]=function(o,i){if(n1(n)&&(i=iX(n,this,sX(o),i)),!o1(i))return i},XF(vi,null,r)},vX=function(e,t,r){var n=i1(r,t-1),o=i1(r,t+1);return ry(a1,e)&&!ry(l1,o)||ry(l1,e)&&!ry(a1,n)?"\\u"+cX(uX(e,0),16):e};vi&&oX({target:"JSON",stat:!0,arity:3,forced:s1||u1},{stringify:function(t,r,n){var o=QF(arguments),i=XF(s1?dX:vi,null,o);return u1&&typeof i=="string"?fX(i,hX,vX):i}});var yX=$e,gX=Cf,pX=je,JF=lv,mX=Ir,bX=!gX||pX(function(){JF.f(1)});yX({target:"Object",stat:!0,forced:bX},{getOwnPropertySymbols:function(t){var r=JF.f;return r?r(mX(t)):[]}});var wX=$e,SX=Gt,CX=vt,ny=Ye,_X=Nt,OX=Ot,RX=Di,EX=Kt,TX=yv,PX=Nj,io=CX.Symbol,Bi=io&&io.prototype;if(SX&&OX(io)&&(!("description"in Bi)||io().description!==void 0)){var f1={},oy=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:EX(arguments[0]),r=RX(Bi,this)?new io(t):t===void 0?io():io(t);return t===""&&(f1[r]=!0),r};PX(oy,io),oy.prototype=Bi,Bi.constructor=oy;var kX=String(io("test"))=="Symbol(test)",$X=ny(Bi.valueOf),AX=ny(Bi.toString),IX=/^Symbol\((.*)\)[^)]+$/,MX=ny("".replace),xX=ny("".slice);TX(Bi,"description",{configurable:!0,get:function(){var t=$X(this);if(_X(f1,t))return"";var r=AX(t),n=kX?xX(r,7,-1):MX(r,IX,"$1");return n===""?void 0:n}}),wX({global:!0,constructor:!0,forced:!0},{Symbol:oy})}var DX=Ye,eB=DX(1 .valueOf),tB=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,NX=Ye,HX=Ar,LX=Kt,kC=tB,c1=NX("".replace),jX=RegExp("^["+kC+"]+"),FX=RegExp("(^|[^"+kC+"])["+kC+"]+$"),ow=function(e){return function(t){var r=LX(HX(t));return e&1&&(r=c1(r,jX,"")),e&2&&(r=c1(r,FX,"$1")),r}},rB={start:ow(1),end:ow(2),trim:ow(3)},BX=$e,nB=aG,VX=Gt,oB=vt,iB=IF,aB=Ye,WX=lm,h1=Nt,UX=P0,zX=Di,YX=Qd,lB=Sj,GX=je,KX=ol.f,qX=zn.f,XX=_r.f,ZX=eB,QX=rB.trim,_m="Number",Ql=oB[_m];iB[_m];var z0=Ql.prototype,JX=oB.TypeError,eZ=aB("".slice),iy=aB("".charCodeAt),tZ=function(e){var t=lB(e,"number");return typeof t=="bigint"?t:rZ(t)},rZ=function(e){var t=lB(e,"number"),r,n,o,i,a,l,s,u;if(YX(t))throw JX("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=QX(t),r=iy(t,0),r===43||r===45){if(n=iy(t,2),n===88||n===120)return NaN}else if(r===48){switch(iy(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=eZ(t,2),l=a.length,s=0;s<l;s++)if(u=iy(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},Y0=WX(_m,!Ql(" 0o1")||!Ql("0b1")||Ql("+0x1")),nZ=function(e){return zX(z0,e)&&GX(function(){ZX(e)})},Om=function(t){var r=arguments.length<1?0:Ql(tZ(t));return nZ(this)?UX(Object(r),this,Om):r};Om.prototype=z0;Y0&&!nB&&(z0.constructor=Om);BX({global:!0,constructor:!0,wrap:!0,forced:Y0},{Number:Om});var oZ=function(e,t){for(var r=VX?KX(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)h1(t,o=r[n])&&!h1(e,o)&&XX(e,o,qX(t,o))};(Y0||nB)&&oZ(iB[_m],Ql);var iZ=$e,aZ=h0;iZ({target:"Object",stat:!0},{setPrototypeOf:aZ});var lZ=$e,sZ=je,uZ=Ir,sB=uv,fZ=Hj,cZ=sZ(function(){sB(1)});lZ({target:"Object",stat:!0,forced:cZ,sham:!fZ},{getPrototypeOf:function(t){return sB(uZ(t))}});var uB=Ye,hZ=el,dZ=Yt,vZ=Nt,d1=pv,yZ=qd,fB=Function,gZ=uB([].concat),pZ=uB([].join),iw={},mZ=function(e,t,r){if(!vZ(iw,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";iw[t]=fB("C,a","return new C("+pZ(n,",")+")")}return iw[t](e,r)},bZ=yZ?fB.bind:function(t){var r=hZ(this),n=r.prototype,o=d1(arguments,1),i=function(){var l=gZ(o,d1(arguments));return this instanceof i?mZ(r,l.length,l):r.apply(t,l)};return dZ(n)&&(i.prototype=n),i},wZ=hm,SZ=_f,CZ=TypeError,cB=function(e){if(wZ(e))return e;throw CZ(SZ(e)+" is not a constructor")},_Z=$e,OZ=Uo,aw=al,RZ=bZ,v1=cB,EZ=jt,y1=Yt,TZ=Of,hB=je,G0=OZ("Reflect","construct"),PZ=Object.prototype,kZ=[].push,dB=hB(function(){function e(){}return!(G0(function(){},[],e)instanceof e)}),vB=!hB(function(){G0(function(){})}),g1=dB||vB;_Z({target:"Reflect",stat:!0,forced:g1,sham:g1},{construct:function(t,r){v1(t),EZ(r);var n=arguments.length<3?t:v1(arguments[2]);if(vB&&!dB)return G0(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return aw(kZ,o,r),new(aw(RZ,t,o))}var i=n.prototype,a=TZ(y1(i)?i:PZ),l=aw(t,a,r);return y1(l)?l:a}});var p1=Nt,$Z=function(e){return e!==void 0&&(p1(e,"value")||p1(e,"writable"))},AZ=$e,IZ=Zt,MZ=Yt,xZ=jt,DZ=$Z,NZ=zn,HZ=uv;function yB(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(xZ(e)===r)return e[t];if(n=NZ.f(e,t),n)return DZ(n)?n.value:n.get===void 0?void 0:IZ(n.get,r);if(MZ(o=HZ(e)))return yB(o,t,r)}AZ({target:"Reflect",stat:!0},{get:yB});var LZ=$e,jZ=je,FZ=zr,gB=zn.f,pB=Gt,BZ=!pB||jZ(function(){gB(1)});LZ({target:"Object",stat:!0,forced:BZ,sham:!pB},{getOwnPropertyDescriptor:function(t,r){return gB(FZ(t),r)}});var VZ=j0;VZ("iterator");var WZ=$e,m1=Ef,UZ=hm,zZ=Yt,b1=Jd,YZ=en,GZ=zr,KZ=Rf,qZ=wt,XZ=vv,ZZ=pv,QZ=XZ("slice"),JZ=qZ("species"),lw=Array,eQ=Math.max;WZ({target:"Array",proto:!0,forced:!QZ},{slice:function(t,r){var n=GZ(this),o=YZ(n),i=b1(t,o),a=b1(r===void 0?o:r,o),l,s,u;if(m1(n)&&(l=n.constructor,UZ(l)&&(l===lw||m1(l.prototype))?l=void 0:zZ(l)&&(l=l[JZ],l===null&&(l=void 0)),l===lw||l===void 0))return ZZ(n,i,a);for(s=new(l===void 0?lw:l)(eQ(a-i,0)),u=0;i<a;i++,u++)i in n&&KZ(s,u,n[i]);return s.length=u,s}});var tQ=Zt,rQ=Nt,nQ=Di,oQ=EF,w1=RegExp.prototype,mB=function(e){var t=e.flags;return t===void 0&&!("flags"in w1)&&!rQ(e,"flags")&&nQ(w1,e)?tQ(oQ,e):t},iQ=av.PROPER,aQ=tn,lQ=jt,S1=Kt,sQ=je,uQ=mB,K0="toString",fQ=RegExp.prototype,bB=fQ[K0],cQ=sQ(function(){return bB.call({source:"a",flags:"b"})!="/a/b"}),hQ=iQ&&bB.name!=K0;(cQ||hQ)&&aQ(RegExp.prototype,K0,function(){var t=lQ(this),r=S1(t.source),n=S1(uQ(t));return"/"+r+"/"+n},{unsafe:!0});var dQ=Gt,vQ=av.EXISTS,wB=Ye,yQ=yv,SB=Function.prototype,gQ=wB(SB.toString),CB=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,pQ=wB(CB.exec),mQ="name";dQ&&!vQ&&yQ(SB,mQ,{configurable:!0,get:function(){try{return pQ(CB,gQ(this))[1]}catch{return""}}});var bQ=jt,wQ=Jj,SQ=function(e,t,r,n){try{return n?t(bQ(r)[0],r[1]):t(r)}catch(o){wQ(e,"throw",o)}},CQ=hv,_Q=Zt,OQ=Ir,RQ=SQ,EQ=Zj,TQ=hm,PQ=en,C1=Rf,kQ=Qj,$Q=R0,_1=Array,AQ=function(t){var r=OQ(t),n=TQ(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=CQ(i,o>2?arguments[2]:void 0));var l=$Q(r),s=0,u,f,c,h,d,v;if(l&&!(this===_1&&EQ(l)))for(h=kQ(r,l),d=h.next,f=n?new this:[];!(c=_Q(d,h)).done;s++)v=a?RQ(h,i,[c.value,s],!0):c.value,C1(f,s,v);else for(u=PQ(r),f=n?new this(u):_1(u);u>s;s++)v=a?i(r[s],s):r[s],C1(f,s,v);return f.length=s,f},IQ=$e,MQ=AQ,xQ=rF,DQ=!xQ(function(e){Array.from(e)});IQ({target:"Array",stat:!0,forced:DQ},{from:MQ});var NQ=$e,HQ=b0,LQ=je,jQ=Yt,FQ=fv.onFreeze,$C=Object.freeze,BQ=LQ(function(){$C(1)});NQ({target:"Object",stat:!0,forced:BQ,sham:!HQ},{freeze:function(t){return $C&&jQ(t)?$C(FQ(t)):t}});var VQ=av.PROPER,WQ=je,O1=tB,R1="âÂá ",UQ=function(e){return WQ(function(){return!!O1[e]()||R1[e]()!==R1||VQ&&O1[e].name!==e})},zQ=$e,YQ=rB.trim,GQ=UQ;zQ({target:"String",proto:!0,forced:GQ("trim")},{trim:function(){return YQ(this)}});var KQ=$e,qQ=s0.includes,XQ=je,ZQ=rv,QQ=XQ(function(){return!Array(1).includes()});KQ({target:"Array",proto:!0,forced:QQ},{includes:function(t){return qQ(this,t,arguments.length>1?arguments[1]:void 0)}});ZQ("includes");var JQ=$e,eJ=m0.codeAt;JQ({target:"String",proto:!0},{codePointAt:function(t){return eJ(this,t)}});var tJ=Ni,rJ=Kt,nJ=Ar,oJ=RangeError,q0=function(t){var r=rJ(nJ(this)),n="",o=tJ(t);if(o<0||o==1/0)throw oJ("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},_B=Ye,iJ=rl,E1=Kt,aJ=q0,lJ=Ar,sJ=_B(aJ),uJ=_B("".slice),fJ=Math.ceil,T1=function(e){return function(t,r,n){var o=E1(lJ(t)),i=iJ(r),a=o.length,l=n===void 0?" ":E1(n),s,u;return i<=a||l==""?o:(s=i-a,u=sJ(l,fJ(s/l.length)),u.length>s&&(u=uJ(u,0,s)),e?o+u:u+o)}},cJ={start:T1(!1),end:T1(!0)},hJ=Ja,dJ=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(hJ),vJ=$e,yJ=cJ.start,gJ=dJ;vJ({target:"String",proto:!0,forced:gJ},{padStart:function(t){return yJ(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var OB;function ee(){return OB.apply(null,arguments)}function pJ(e){OB=e}function mn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ha(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function X0(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(it(e,t))return!1;return!0}function Tr(e){return e===void 0}function Bo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function bv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function RB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function hi(e,t){for(var r in t)it(t,r)&&(e[r]=t[r]);return it(t,"toString")&&(e.toString=t.toString),it(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Yn(e,t,r,n){return qB(e,t,r,n,!0).utc()}function mJ(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ke(e){return e._pf==null&&(e._pf=mJ()),e._pf}var AC;Array.prototype.some?AC=Array.prototype.some:AC=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function Z0(e){if(e._isValid==null){var t=Ke(e),r=AC.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Rm(e){var t=Yn(NaN);return e!=null?hi(Ke(t),e):Ke(t).userInvalidated=!0,t}var P1=ee.momentProperties=[],sw=!1;function Q0(e,t){var r,n,o,i=P1.length;if(Tr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Tr(t._i)||(e._i=t._i),Tr(t._f)||(e._f=t._f),Tr(t._l)||(e._l=t._l),Tr(t._strict)||(e._strict=t._strict),Tr(t._tzm)||(e._tzm=t._tzm),Tr(t._isUTC)||(e._isUTC=t._isUTC),Tr(t._offset)||(e._offset=t._offset),Tr(t._pf)||(e._pf=Ke(t)),Tr(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=P1[r],o=t[n],Tr(o)||(e[n]=o);return e}function wv(e){Q0(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),sw===!1&&(sw=!0,ee.updateOffset(this),sw=!1)}function bn(e){return e instanceof wv||e!=null&&e._isAMomentObject!=null}function EB(e){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function rn(e,t){var r=!0;return hi(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])it(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}EB(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var k1={};function TB(e,t){ee.deprecationHandler!=null&&ee.deprecationHandler(e,t),k1[e]||(EB(t),k1[e]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Gn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function bJ(e){var t,r;for(r in e)it(e,r)&&(t=e[r],Gn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function IC(e,t){var r=hi({},e),n;for(n in t)it(t,n)&&(Ha(e[n])&&Ha(t[n])?(r[n]={},hi(r[n],e[n]),hi(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)it(e,n)&&!it(t,n)&&Ha(e[n])&&(r[n]=hi({},r[n]));return r}function J0(e){e!=null&&this.set(e)}var MC;Object.keys?MC=Object.keys:MC=function(e){var t,r=[];for(t in e)it(e,t)&&r.push(t);return r};var wJ={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function SJ(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Gn(n)?n.call(t,r):n}function Wn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var eE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ay=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,uw={},Jl={};function Pe(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(Jl[e]=o),t&&(Jl[t[0]]=function(){return Wn(o.apply(this,arguments),t[1],t[2])}),r&&(Jl[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function CJ(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function _J(e){var t=e.match(eE),r,n;for(r=0,n=t.length;r<n;r++)Jl[t[r]]?t[r]=Jl[t[r]]:t[r]=CJ(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Gn(t[a])?t[a].call(o,e):t[a];return i}}function ig(e,t){return e.isValid()?(t=PB(t,e.localeData()),uw[t]=uw[t]||_J(t),uw[t](e)):e.localeData().invalidDate()}function PB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(ay.lastIndex=0;r>=0&&ay.test(e);)e=e.replace(ay,n),ay.lastIndex=0,r-=1;return e}var OJ={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function RJ(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(eE).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var EJ="Invalid date";function TJ(){return this._invalidDate}var PJ="%d",kJ=/\d{1,2}/;function $J(e){return this._ordinal.replace("%d",e)}var AJ={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function IJ(e,t,r,n){var o=this._relativeTime[r];return Gn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function MJ(e,t){var r=this._relativeTime[e>0?"future":"past"];return Gn(r)?r(t):r.replace(/%s/i,t)}var Rc={};function cr(e,t){var r=e.toLowerCase();Rc[r]=Rc[r+"s"]=Rc[t]=e}function nn(e){return typeof e=="string"?Rc[e]||Rc[e.toLowerCase()]:void 0}function tE(e){var t={},r,n;for(n in e)it(e,n)&&(r=nn(n),r&&(t[r]=e[n]));return t}var kB={};function hr(e,t){kB[e]=t}function xJ(e){var t=[],r;for(r in e)it(e,r)&&t.push({unit:r,priority:kB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function Em(e){return e%4===0&&e%100!==0||e%400===0}function Zr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Qe(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Zr(t)),r}function Pf(e,t){return function(r){return r!=null?($B(this,e,r),ee.updateOffset(this,t),this):Ug(this,e)}}function Ug(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function $B(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&Em(e.year())&&e.month()===1&&e.date()===29?(r=Qe(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Im(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function DJ(e){return e=nn(e),Gn(this[e])?this[e]():this}function NJ(e,t){if(typeof e=="object"){e=tE(e);var r=xJ(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=nn(e),Gn(this[e]))return this[e](t);return this}var AB=/\d/,Yr=/\d\d/,IB=/\d{3}/,rE=/\d{4}/,Tm=/[+-]?\d{6}/,Rt=/\d\d?/,MB=/\d\d\d\d?/,xB=/\d\d\d\d\d\d?/,Pm=/\d{1,3}/,nE=/\d{1,4}/,km=/[+-]?\d{1,6}/,kf=/\d+/,$m=/[+-]?\d+/,HJ=/Z|[+-]\d\d:?\d\d/gi,Am=/Z|[+-]\d\d(?::?\d\d)?/gi,LJ=/[+-]?\d+(\.\d{1,3})?/,Sv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,zg;zg={};function be(e,t,r){zg[e]=Gn(t)?t:function(n,o){return n&&r?r:t}}function jJ(e,t){return it(zg,e)?zg[e](t._strict,t._locale):new RegExp(FJ(e))}function FJ(e){return Br(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Br(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var xC={};function yt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Bo(t)&&(n=function(i,a){a[t]=Qe(i)}),o=e.length,r=0;r<o;r++)xC[e[r]]=n}function Cv(e,t){yt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function BJ(e,t,r){t!=null&&it(xC,e)&&xC[e](t,r._a,r,e)}var sr=0,fo=1,Fn=2,Qt=3,gn=4,co=5,ua=6,VJ=7,WJ=8;function UJ(e,t){return(e%t+t)%t}var Wt;Array.prototype.indexOf?Wt=Array.prototype.indexOf:Wt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Im(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=UJ(t,12);return e+=(t-r)/12,r===1?Em(e)?29:28:31-r%7%2}Pe("M",["MM",2],"Mo",function(){return this.month()+1});Pe("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Pe("MMMM",0,0,function(e){return this.localeData().months(this,e)});cr("month","M");hr("month",8);be("M",Rt);be("MM",Rt,Yr);be("MMM",function(e,t){return t.monthsShortRegex(e)});be("MMMM",function(e,t){return t.monthsRegex(e)});yt(["M","MM"],function(e,t){t[fo]=Qe(e)-1});yt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[fo]=o:Ke(r).invalidMonth=e});var zJ="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),DB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),NB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,YJ=Sv,GJ=Sv;function KJ(e,t){return e?mn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||NB).test(t)?"format":"standalone"][e.month()]:mn(this._months)?this._months:this._months.standalone}function qJ(e,t){return e?mn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[NB.test(t)?"format":"standalone"][e.month()]:mn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function XJ(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Yn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null))}function ZJ(e,t,r){var n,o,i;if(this._monthsParseExact)return XJ.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Yn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function HB(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Qe(t);else if(t=e.localeData().monthsParse(t),!Bo(t))return e}return r=Math.min(e.date(),Im(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function LB(e){return e!=null?(HB(this,e),ee.updateOffset(this,!0),this):Ug(this,"Month")}function QJ(){return Im(this.year(),this.month())}function JJ(e){return this._monthsParseExact?(it(this,"_monthsRegex")||jB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=YJ),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function eee(e){return this._monthsParseExact?(it(this,"_monthsRegex")||jB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=GJ),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function jB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Yn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Br(t[o]),r[o]=Br(r[o]);for(o=0;o<24;o++)n[o]=Br(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Pe("Y",0,0,function(){var e=this.year();return e<=9999?Wn(e,4):"+"+e});Pe(0,["YY",2],0,function(){return this.year()%100});Pe(0,["YYYY",4],0,"year");Pe(0,["YYYYY",5],0,"year");Pe(0,["YYYYYY",6,!0],0,"year");cr("year","y");hr("year",1);be("Y",$m);be("YY",Rt,Yr);be("YYYY",nE,rE);be("YYYYY",km,Tm);be("YYYYYY",km,Tm);yt(["YYYYY","YYYYYY"],sr);yt("YYYY",function(e,t){t[sr]=e.length===2?ee.parseTwoDigitYear(e):Qe(e)});yt("YY",function(e,t){t[sr]=ee.parseTwoDigitYear(e)});yt("Y",function(e,t){t[sr]=parseInt(e,10)});function Ec(e){return Em(e)?366:365}ee.parseTwoDigitYear=function(e){return Qe(e)+(Qe(e)>68?1900:2e3)};var FB=Pf("FullYear",!0);function tee(){return Em(this.year())}function ree(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function zc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Yg(e,t,r){var n=7+t-r,o=(7+zc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function BB(e,t,r,n,o){var i=(7+r-n)%7,a=Yg(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=Ec(s)+l):l>Ec(e)?(s=e+1,u=l-Ec(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Yc(e,t,r){var n=Yg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Lo(a,t,r)):o>Lo(e.year(),t,r)?(i=o-Lo(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Lo(e,t,r){var n=Yg(e,t,r),o=Yg(e+1,t,r);return(Ec(e)-n+o)/7}Pe("w",["ww",2],"wo","week");Pe("W",["WW",2],"Wo","isoWeek");cr("week","w");cr("isoWeek","W");hr("week",5);hr("isoWeek",5);be("w",Rt);be("ww",Rt,Yr);be("W",Rt);be("WW",Rt,Yr);Cv(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Qe(e)});function nee(e){return Yc(e,this._week.dow,this._week.doy).week}var oee={dow:0,doy:6};function iee(){return this._week.dow}function aee(){return this._week.doy}function lee(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function see(e){var t=Yc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Pe("d",0,"do","day");Pe("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Pe("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Pe("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Pe("e",0,0,"weekday");Pe("E",0,0,"isoWeekday");cr("day","d");cr("weekday","e");cr("isoWeekday","E");hr("day",11);hr("weekday",11);hr("isoWeekday",11);be("d",Rt);be("e",Rt);be("E",Rt);be("dd",function(e,t){return t.weekdaysMinRegex(e)});be("ddd",function(e,t){return t.weekdaysShortRegex(e)});be("dddd",function(e,t){return t.weekdaysRegex(e)});Cv(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Ke(r).invalidWeekday=e});Cv(["d","e","E"],function(e,t,r,n){t[n]=Qe(e)});function uee(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function fee(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function oE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var cee="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),VB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),hee="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),dee=Sv,vee=Sv,yee=Sv;function gee(e,t){var r=mn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?oE(r,this._week.dow):e?r[e.day()]:r}function pee(e){return e===!0?oE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function mee(e){return e===!0?oE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function bee(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Yn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1||(o=Wt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Wt.call(this._minWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function wee(e,t,r){var n,o,i;if(this._weekdaysParseExact)return bee.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Yn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function See(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=uee(e,this.localeData()),this.add(e-t,"d")):t}function Cee(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function _ee(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=fee(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Oee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||iE.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=dee),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Ree(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||iE.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=vee),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Eee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||iE.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=yee),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function iE(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Yn([2e3,1]).day(i),l=Br(this.weekdaysMin(a,"")),s=Br(this.weekdaysShort(a,"")),u=Br(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function aE(){return this.hours()%12||12}function Tee(){return this.hours()||24}Pe("H",["HH",2],0,"hour");Pe("h",["hh",2],0,aE);Pe("k",["kk",2],0,Tee);Pe("hmm",0,0,function(){return""+aE.apply(this)+Wn(this.minutes(),2)});Pe("hmmss",0,0,function(){return""+aE.apply(this)+Wn(this.minutes(),2)+Wn(this.seconds(),2)});Pe("Hmm",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)});Pe("Hmmss",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)+Wn(this.seconds(),2)});function WB(e,t){Pe(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}WB("a",!0);WB("A",!1);cr("hour","h");hr("hour",13);function UB(e,t){return t._meridiemParse}be("a",UB);be("A",UB);be("H",Rt);be("h",Rt);be("k",Rt);be("HH",Rt,Yr);be("hh",Rt,Yr);be("kk",Rt,Yr);be("hmm",MB);be("hmmss",xB);be("Hmm",MB);be("Hmmss",xB);yt(["H","HH"],Qt);yt(["k","kk"],function(e,t,r){var n=Qe(e);t[Qt]=n===24?0:n});yt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});yt(["h","hh"],function(e,t,r){t[Qt]=Qe(e),Ke(r).bigHour=!0});yt("hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n)),Ke(r).bigHour=!0});yt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n,2)),t[co]=Qe(e.substr(o)),Ke(r).bigHour=!0});yt("Hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n))});yt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n,2)),t[co]=Qe(e.substr(o))});function Pee(e){return(e+"").toLowerCase().charAt(0)==="p"}var kee=/[ap]\.?m?\.?/i,$ee=Pf("Hours",!0);function Aee(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var zB={calendar:wJ,longDateFormat:OJ,invalidDate:EJ,ordinal:PJ,dayOfMonthOrdinalParse:kJ,relativeTime:AJ,months:zJ,monthsShort:DB,week:oee,weekdays:cee,weekdaysMin:hee,weekdaysShort:VB,meridiemParse:kee},Et={},Uf={},Gc;function Iee(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function $1(e){return e&&e.toLowerCase().replace("_","-")}function Mee(e){for(var t=0,r,n,o,i;t<e.length;){for(i=$1(e[t]).split("-"),r=i.length,n=$1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=Mm(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&Iee(i,n)>=r-1)break;r--}t++}return Gc}function xee(e){return e.match("^[^/\\\\]*$")!=null}function Mm(e){var t=null,r;if(Et[e]===void 0&&typeof module<"u"&&module&&module.exports&&xee(e))try{t=Gc._abbr,r=require,r("./locale/"+e),yi(t)}catch{Et[e]=null}return Et[e]}function yi(e,t){var r;return e&&(Tr(t)?r=Yo(e):r=lE(e,t),r?Gc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Gc._abbr}function lE(e,t){if(t!==null){var r,n=zB;if(t.abbr=e,Et[e]!=null)TB("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Et[e]._config;else if(t.parentLocale!=null)if(Et[t.parentLocale]!=null)n=Et[t.parentLocale]._config;else if(r=Mm(t.parentLocale),r!=null)n=r._config;else return Uf[t.parentLocale]||(Uf[t.parentLocale]=[]),Uf[t.parentLocale].push({name:e,config:t}),null;return Et[e]=new J0(IC(n,t)),Uf[e]&&Uf[e].forEach(function(o){lE(o.name,o.config)}),yi(e),Et[e]}else return delete Et[e],null}function Dee(e,t){if(t!=null){var r,n,o=zB;Et[e]!=null&&Et[e].parentLocale!=null?Et[e].set(IC(Et[e]._config,t)):(n=Mm(e),n!=null&&(o=n._config),t=IC(o,t),n==null&&(t.abbr=e),r=new J0(t),r.parentLocale=Et[e],Et[e]=r),yi(e)}else Et[e]!=null&&(Et[e].parentLocale!=null?(Et[e]=Et[e].parentLocale,e===yi()&&yi(e)):Et[e]!=null&&delete Et[e]);return Et[e]}function Yo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Gc;if(!mn(e)){if(t=Mm(e),t)return t;e=[e]}return Mee(e)}function Nee(){return MC(Et)}function sE(e){var t,r=e._a;return r&&Ke(e).overflow===-2&&(t=r[fo]<0||r[fo]>11?fo:r[Fn]<1||r[Fn]>Im(r[sr],r[fo])?Fn:r[Qt]<0||r[Qt]>24||r[Qt]===24&&(r[gn]!==0||r[co]!==0||r[ua]!==0)?Qt:r[gn]<0||r[gn]>59?gn:r[co]<0||r[co]>59?co:r[ua]<0||r[ua]>999?ua:-1,Ke(e)._overflowDayOfYear&&(t<sr||t>Fn)&&(t=Fn),Ke(e)._overflowWeeks&&t===-1&&(t=VJ),Ke(e)._overflowWeekday&&t===-1&&(t=WJ),Ke(e).overflow=t),e}var Hee=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Lee=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,jee=/Z|[+-]\d\d(?::?\d\d)?/,ly=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],fw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Fee=/^\/?Date\((-?\d+)/i,Bee=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Vee={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function YB(e){var t,r,n=e._i,o=Hee.exec(n)||Lee.exec(n),i,a,l,s,u=ly.length,f=fw.length;if(o){for(Ke(e).iso=!0,t=0,r=u;t<r;t++)if(ly[t][1].exec(o[1])){a=ly[t][0],i=ly[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(fw[t][1].exec(o[3])){l=(o[2]||" ")+fw[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(jee.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),fE(e)}else e._isValid=!1}function Wee(e,t,r,n,o,i){var a=[Uee(e),DB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Uee(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function zee(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Yee(e,t,r){if(e){var n=VB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Ke(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Gee(e,t,r){if(e)return Vee[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function GB(e){var t=Bee.exec(zee(e._i)),r;if(t){if(r=Wee(t[4],t[3],t[2],t[5],t[6],t[7]),!Yee(t[1],r,e))return;e._a=r,e._tzm=Gee(t[8],t[9],t[10]),e._d=zc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Ke(e).rfc2822=!0}else e._isValid=!1}function Kee(e){var t=Fee.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(YB(e),e._isValid===!1)delete e._isValid;else return;if(GB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ee.createFromInputFallback(e)}ee.createFromInputFallback=rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Wl(e,t,r){return e??t??r}function qee(e){var t=new Date(ee.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function uE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=qee(e),e._w&&e._a[Fn]==null&&e._a[fo]==null&&Xee(e),e._dayOfYear!=null&&(a=Wl(e._a[sr],o[sr]),(e._dayOfYear>Ec(a)||e._dayOfYear===0)&&(Ke(e)._overflowDayOfYear=!0),r=zc(a,0,e._dayOfYear),e._a[fo]=r.getUTCMonth(),e._a[Fn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Qt]===24&&e._a[gn]===0&&e._a[co]===0&&e._a[ua]===0&&(e._nextDay=!0,e._a[Qt]=0),e._d=(e._useUTC?zc:ree).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Qt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Ke(e).weekdayMismatch=!0)}}function Xee(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=Wl(t.GG,e._a[sr],Yc(_t(),1,4).year),n=Wl(t.W,1),o=Wl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Yc(_t(),i,a),r=Wl(t.gg,e._a[sr],u.year),n=Wl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Lo(r,i,a)?Ke(e)._overflowWeeks=!0:s!=null?Ke(e)._overflowWeekday=!0:(l=BB(r,n,o,i,a),e._a[sr]=l.year,e._dayOfYear=l.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function fE(e){if(e._f===ee.ISO_8601){YB(e);return}if(e._f===ee.RFC_2822){GB(e);return}e._a=[],Ke(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=PB(e._f,e._locale).match(eE)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(jJ(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Ke(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),Jl[i]?(n?Ke(e).empty=!1:Ke(e).unusedTokens.push(i),BJ(i,n,e)):e._strict&&!n&&Ke(e).unusedTokens.push(i);Ke(e).charsLeftOver=l-s,t.length>0&&Ke(e).unusedInput.push(t),e._a[Qt]<=12&&Ke(e).bigHour===!0&&e._a[Qt]>0&&(Ke(e).bigHour=void 0),Ke(e).parsedDateParts=e._a.slice(0),Ke(e).meridiem=e._meridiem,e._a[Qt]=Zee(e._locale,e._a[Qt],e._meridiem),u=Ke(e).era,u!==null&&(e._a[sr]=e._locale.erasConvertYear(u,e._a[sr])),uE(e),sE(e)}function Zee(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Qee(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){Ke(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=Q0({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],fE(t),Z0(t)&&(a=!0),i+=Ke(t).charsLeftOver,i+=Ke(t).unusedTokens.length*10,Ke(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));hi(e,r||t)}function Jee(e){if(!e._d){var t=tE(e._i),r=t.day===void 0?t.date:t.day;e._a=RB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),uE(e)}}function ete(e){var t=new wv(sE(KB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function KB(e){var t=e._i,r=e._f;return e._locale=e._locale||Yo(e._l),t===null||r===void 0&&t===""?Rm({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),bn(t)?new wv(sE(t)):(bv(t)?e._d=t:mn(r)?Qee(e):r?fE(e):tte(e),Z0(e)||(e._d=null),e))}function tte(e){var t=e._i;Tr(t)?e._d=new Date(ee.now()):bv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Kee(e):mn(t)?(e._a=RB(t.slice(0),function(r){return parseInt(r,10)}),uE(e)):Ha(t)?Jee(e):Bo(t)?e._d=new Date(t):ee.createFromInputFallback(e)}function qB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ha(e)&&X0(e)||mn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,ete(i)}function _t(e,t,r,n){return qB(e,t,r,n,!1)}var rte=rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_t.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Rm()}),nte=rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_t.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Rm()});function XB(e,t){var r,n;if(t.length===1&&mn(t[0])&&(t=t[0]),!t.length)return _t();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function ote(){var e=[].slice.call(arguments,0);return XB("isBefore",e)}function ite(){var e=[].slice.call(arguments,0);return XB("isAfter",e)}var ate=function(){return Date.now?Date.now():+new Date},zf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function lte(e){var t,r=!1,n,o=zf.length;for(t in e)if(it(e,t)&&!(Wt.call(zf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[zf[n]]){if(r)return!1;parseFloat(e[zf[n]])!==Qe(e[zf[n]])&&(r=!0)}return!0}function ste(){return this._isValid}function ute(){return On(NaN)}function xm(e){var t=tE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=lte(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Yo(),this._bubble()}function ag(e){return e instanceof xm}function DC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function fte(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Qe(e[a])!==Qe(t[a]))&&i++;return i+o}function ZB(e,t){Pe(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Wn(~~(r/60),2)+t+Wn(~~r%60,2)})}ZB("Z",":");ZB("ZZ","");be("Z",Am);be("ZZ",Am);yt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=cE(Am,e)});var cte=/([\+\-]|\d\d)/gi;function cE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(cte)||["-",0,0],i=+(o[1]*60)+Qe(o[2]),i===0?0:o[0]==="+"?i:-i)}function hE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(bn(e)||bv(e)?e.valueOf():_t(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ee.updateOffset(r,!1),r):_t(e).local()}function NC(e){return-Math.round(e._d.getTimezoneOffset())}ee.updateOffset=function(){};function hte(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=cE(Am,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=NC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?eV(this,On(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:NC(this)}function dte(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function vte(e){return this.utcOffset(0,e)}function yte(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(NC(this),"m")),this}function gte(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=cE(HJ,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function pte(e){return this.isValid()?(e=e?_t(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function mte(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bte(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Q0(e,this),e=KB(e),e._a?(t=e._isUTC?Yn(e._a):_t(e._a),this._isDSTShifted=this.isValid()&&fte(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function wte(){return this.isValid()?!this._isUTC:!1}function Ste(){return this.isValid()?this._isUTC:!1}function QB(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Cte=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,_te=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function On(e,t){var r=e,n=null,o,i,a;return ag(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Bo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Cte.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Qe(n[Fn])*o,h:Qe(n[Qt])*o,m:Qe(n[gn])*o,s:Qe(n[co])*o,ms:Qe(DC(n[ua]*1e3))*o}):(n=_te.exec(e))?(o=n[1]==="-"?-1:1,r={y:Vi(n[2],o),M:Vi(n[3],o),w:Vi(n[4],o),d:Vi(n[5],o),h:Vi(n[6],o),m:Vi(n[7],o),s:Vi(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=Ote(_t(r.from),_t(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new xm(r),ag(e)&&it(e,"_locale")&&(i._locale=e._locale),ag(e)&&it(e,"_isValid")&&(i._isValid=e._isValid),i}On.fn=xm.prototype;On.invalid=ute;function Vi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function A1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Ote(e,t){var r;return e.isValid()&&t.isValid()?(t=hE(t,e),e.isBefore(t)?r=A1(e,t):(r=A1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function JB(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(TB(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=On(r,n),eV(this,o,e),this}}function eV(e,t,r,n){var o=t._milliseconds,i=DC(t._days),a=DC(t._months);e.isValid()&&(n=n??!0,a&&HB(e,Ug(e,"Month")+a*r),i&&$B(e,"Date",Ug(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&ee.updateOffset(e,i||a))}var Rte=JB(1,"add"),Ete=JB(-1,"subtract");function tV(e){return typeof e=="string"||e instanceof String}function Tte(e){return bn(e)||bv(e)||tV(e)||Bo(e)||kte(e)||Pte(e)||e===null||e===void 0}function Pte(e){var t=Ha(e)&&!X0(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||it(e,i);return t&&r}function kte(e){var t=mn(e),r=!1;return t&&(r=e.filter(function(n){return!Bo(n)&&tV(e)}).length===0),t&&r}function $te(e){var t=Ha(e)&&!X0(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||it(e,i);return t&&r}function Ate(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Ite(e,t){arguments.length===1&&(arguments[0]?Tte(arguments[0])?(e=arguments[0],t=void 0):$te(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||_t(),n=hE(r,this).startOf("day"),o=ee.calendarFormat(this,n)||"sameElse",i=t&&(Gn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,_t(r)))}function Mte(){return new wv(this)}function xte(e,t){var r=bn(e)?e:_t(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function Dte(e,t){var r=bn(e)?e:_t(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function Nte(e,t,r,n){var o=bn(e)?e:_t(e),i=bn(t)?t:_t(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function Hte(e,t){var r=bn(e)?e:_t(e),n;return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function Lte(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function jte(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Fte(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=hE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=nn(t),t){case"year":i=lg(this,n)/12;break;case"month":i=lg(this,n);break;case"quarter":i=lg(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Zr(i)}function lg(e,t){if(e.date()<t.date())return-lg(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Bte(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Vte(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?ig(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Gn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ig(r,"Z")):ig(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Wte(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Ute(e){e||(e=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var t=ig(this,e);return this.localeData().postformat(t)}function zte(e,t){return this.isValid()&&(bn(e)&&e.isValid()||_t(e).isValid())?On({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Yte(e){return this.from(_t(),e)}function Gte(e,t){return this.isValid()&&(bn(e)&&e.isValid()||_t(e).isValid())?On({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Kte(e){return this.to(_t(),e)}function rV(e){var t;return e===void 0?this._locale._abbr:(t=Yo(e),t!=null&&(this._locale=t),this)}var nV=rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function oV(){return this._locale}var Gg=1e3,es=60*Gg,Kg=60*es,iV=(365*400+97)*24*Kg;function ts(e,t){return(e%t+t)%t}function aV(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-iV:new Date(e,t,r).valueOf()}function lV(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-iV:Date.UTC(e,t,r)}function qte(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?lV:aV,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ts(t+(this._isUTC?0:this.utcOffset()*es),Kg);break;case"minute":t=this._d.valueOf(),t-=ts(t,es);break;case"second":t=this._d.valueOf(),t-=ts(t,Gg);break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function Xte(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?lV:aV,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Kg-ts(t+(this._isUTC?0:this.utcOffset()*es),Kg)-1;break;case"minute":t=this._d.valueOf(),t+=es-ts(t,es)-1;break;case"second":t=this._d.valueOf(),t+=Gg-ts(t,Gg)-1;break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function Zte(){return this._d.valueOf()-(this._offset||0)*6e4}function Qte(){return Math.floor(this.valueOf()/1e3)}function Jte(){return new Date(this.valueOf())}function ere(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function tre(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function rre(){return this.isValid()?this.toISOString():null}function nre(){return Z0(this)}function ore(){return hi({},Ke(this))}function ire(){return Ke(this).overflow}function are(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pe("N",0,0,"eraAbbr");Pe("NN",0,0,"eraAbbr");Pe("NNN",0,0,"eraAbbr");Pe("NNNN",0,0,"eraName");Pe("NNNNN",0,0,"eraNarrow");Pe("y",["y",1],"yo","eraYear");Pe("y",["yy",2],0,"eraYear");Pe("y",["yyy",3],0,"eraYear");Pe("y",["yyyy",4],0,"eraYear");be("N",dE);be("NN",dE);be("NNN",dE);be("NNNN",pre);be("NNNNN",mre);yt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Ke(r).era=o:Ke(r).invalidEra=e});be("y",kf);be("yy",kf);be("yyy",kf);be("yyyy",kf);be("yo",bre);yt(["y","yy","yyy","yyyy"],sr);yt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[sr]=r._locale.eraYearOrdinalParse(e,o):t[sr]=parseInt(e,10)});function lre(e,t){var r,n,o,i=this._eras||Yo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=ee(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=ee(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function sre(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function ure(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ee(e.since).year():ee(e.since).year()+(t-e.offset)*r}function fre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function cre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function hre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function dre(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-ee(o[e].since).year())*r+o[e].offset;return this.year()}function vre(e){return it(this,"_erasNameRegex")||vE.call(this),e?this._erasNameRegex:this._erasRegex}function yre(e){return it(this,"_erasAbbrRegex")||vE.call(this),e?this._erasAbbrRegex:this._erasRegex}function gre(e){return it(this,"_erasNarrowRegex")||vE.call(this),e?this._erasNarrowRegex:this._erasRegex}function dE(e,t){return t.erasAbbrRegex(e)}function pre(e,t){return t.erasNameRegex(e)}function mre(e,t){return t.erasNarrowRegex(e)}function bre(e,t){return t._eraYearOrdinalRegex||kf}function vE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Br(a[o].name)),e.push(Br(a[o].abbr)),r.push(Br(a[o].narrow)),n.push(Br(a[o].name)),n.push(Br(a[o].abbr)),n.push(Br(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pe(0,["gg",2],0,function(){return this.weekYear()%100});Pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Dm(e,t){Pe(0,[e,e.length],0,t)}Dm("gggg","weekYear");Dm("ggggg","weekYear");Dm("GGGG","isoWeekYear");Dm("GGGGG","isoWeekYear");cr("weekYear","gg");cr("isoWeekYear","GG");hr("weekYear",1);hr("isoWeekYear",1);be("G",$m);be("g",$m);be("GG",Rt,Yr);be("gg",Rt,Yr);be("GGGG",nE,rE);be("gggg",nE,rE);be("GGGGG",km,Tm);be("ggggg",km,Tm);Cv(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Qe(e)});Cv(["gg","GG"],function(e,t,r,n){t[n]=ee.parseTwoDigitYear(e)});function wre(e){return sV.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Sre(e){return sV.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Cre(){return Lo(this.year(),1,4)}function _re(){return Lo(this.isoWeekYear(),1,4)}function Ore(){var e=this.localeData()._week;return Lo(this.year(),e.dow,e.doy)}function Rre(){var e=this.localeData()._week;return Lo(this.weekYear(),e.dow,e.doy)}function sV(e,t,r,n,o){var i;return e==null?Yc(this,n,o).year:(i=Lo(e,n,o),t>i&&(t=i),Ere.call(this,e,t,r,n,o))}function Ere(e,t,r,n,o){var i=BB(e,t,r,n,o),a=zc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Pe("Q",0,"Qo","quarter");cr("quarter","Q");hr("quarter",7);be("Q",AB);yt("Q",function(e,t){t[fo]=(Qe(e)-1)*3});function Tre(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Pe("D",["DD",2],"Do","date");cr("date","D");hr("date",9);be("D",Rt);be("DD",Rt,Yr);be("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Fn);yt("Do",function(e,t){t[Fn]=Qe(e.match(Rt)[0])});var uV=Pf("Date",!0);Pe("DDD",["DDDD",3],"DDDo","dayOfYear");cr("dayOfYear","DDD");hr("dayOfYear",4);be("DDD",Pm);be("DDDD",IB);yt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Qe(e)});function Pre(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Pe("m",["mm",2],0,"minute");cr("minute","m");hr("minute",14);be("m",Rt);be("mm",Rt,Yr);yt(["m","mm"],gn);var kre=Pf("Minutes",!1);Pe("s",["ss",2],0,"second");cr("second","s");hr("second",15);be("s",Rt);be("ss",Rt,Yr);yt(["s","ss"],co);var $re=Pf("Seconds",!1);Pe("S",0,0,function(){return~~(this.millisecond()/100)});Pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pe(0,["SSS",3],0,"millisecond");Pe(0,["SSSS",4],0,function(){return this.millisecond()*10});Pe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});cr("millisecond","ms");hr("millisecond",16);be("S",Pm,AB);be("SS",Pm,Yr);be("SSS",Pm,IB);var di,fV;for(di="SSSS";di.length<=9;di+="S")be(di,kf);function Are(e,t){t[ua]=Qe(("0."+e)*1e3)}for(di="S";di.length<=9;di+="S")yt(di,Are);fV=Pf("Milliseconds",!1);Pe("z",0,0,"zoneAbbr");Pe("zz",0,0,"zoneName");function Ire(){return this._isUTC?"UTC":""}function Mre(){return this._isUTC?"Coordinated Universal Time":""}var ne=wv.prototype;ne.add=Rte;ne.calendar=Ite;ne.clone=Mte;ne.diff=Fte;ne.endOf=Xte;ne.format=Ute;ne.from=zte;ne.fromNow=Yte;ne.to=Gte;ne.toNow=Kte;ne.get=DJ;ne.invalidAt=ire;ne.isAfter=xte;ne.isBefore=Dte;ne.isBetween=Nte;ne.isSame=Hte;ne.isSameOrAfter=Lte;ne.isSameOrBefore=jte;ne.isValid=nre;ne.lang=nV;ne.locale=rV;ne.localeData=oV;ne.max=nte;ne.min=rte;ne.parsingFlags=ore;ne.set=NJ;ne.startOf=qte;ne.subtract=Ete;ne.toArray=ere;ne.toObject=tre;ne.toDate=Jte;ne.toISOString=Vte;ne.inspect=Wte;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=rre;ne.toString=Bte;ne.unix=Qte;ne.valueOf=Zte;ne.creationData=are;ne.eraName=fre;ne.eraNarrow=cre;ne.eraAbbr=hre;ne.eraYear=dre;ne.year=FB;ne.isLeapYear=tee;ne.weekYear=wre;ne.isoWeekYear=Sre;ne.quarter=ne.quarters=Tre;ne.month=LB;ne.daysInMonth=QJ;ne.week=ne.weeks=lee;ne.isoWeek=ne.isoWeeks=see;ne.weeksInYear=Ore;ne.weeksInWeekYear=Rre;ne.isoWeeksInYear=Cre;ne.isoWeeksInISOWeekYear=_re;ne.date=uV;ne.day=ne.days=See;ne.weekday=Cee;ne.isoWeekday=_ee;ne.dayOfYear=Pre;ne.hour=ne.hours=$ee;ne.minute=ne.minutes=kre;ne.second=ne.seconds=$re;ne.millisecond=ne.milliseconds=fV;ne.utcOffset=hte;ne.utc=vte;ne.local=yte;ne.parseZone=gte;ne.hasAlignedHourOffset=pte;ne.isDST=mte;ne.isLocal=wte;ne.isUtcOffset=Ste;ne.isUtc=QB;ne.isUTC=QB;ne.zoneAbbr=Ire;ne.zoneName=Mre;ne.dates=rn("dates accessor is deprecated. Use date instead.",uV);ne.months=rn("months accessor is deprecated. Use month instead",LB);ne.years=rn("years accessor is deprecated. Use year instead",FB);ne.zone=rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",dte);ne.isDSTShifted=rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bte);function xre(e){return _t(e*1e3)}function Dre(){return _t.apply(null,arguments).parseZone()}function cV(e){return e}var at=J0.prototype;at.calendar=SJ;at.longDateFormat=RJ;at.invalidDate=TJ;at.ordinal=$J;at.preparse=cV;at.postformat=cV;at.relativeTime=IJ;at.pastFuture=MJ;at.set=bJ;at.eras=lre;at.erasParse=sre;at.erasConvertYear=ure;at.erasAbbrRegex=yre;at.erasNameRegex=vre;at.erasNarrowRegex=gre;at.months=KJ;at.monthsShort=qJ;at.monthsParse=ZJ;at.monthsRegex=eee;at.monthsShortRegex=JJ;at.week=nee;at.firstDayOfYear=aee;at.firstDayOfWeek=iee;at.weekdays=gee;at.weekdaysMin=mee;at.weekdaysShort=pee;at.weekdaysParse=wee;at.weekdaysRegex=Oee;at.weekdaysShortRegex=Ree;at.weekdaysMinRegex=Eee;at.isPM=Pee;at.meridiem=Aee;function qg(e,t,r,n){var o=Yo(),i=Yn().set(n,t);return o[r](i,e)}function hV(e,t,r){if(Bo(e)&&(t=e,e=void 0),e=e||"",t!=null)return qg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=qg(e,n,r,"month");return o}function yE(e,t,r,n){typeof e=="boolean"?(Bo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Bo(t)&&(r=t,t=void 0),t=t||"");var o=Yo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return qg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=qg(t,(a+i)%7,n,"day");return l}function Nre(e,t){return hV(e,t,"months")}function Hre(e,t){return hV(e,t,"monthsShort")}function Lre(e,t,r){return yE(e,t,r,"weekdays")}function jre(e,t,r){return yE(e,t,r,"weekdaysShort")}function Fre(e,t,r){return yE(e,t,r,"weekdaysMin")}yi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Qe(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ee.lang=rn("moment.lang is deprecated. Use moment.locale instead.",yi);ee.langData=rn("moment.langData is deprecated. Use moment.localeData instead.",Yo);var Zn=Math.abs;function Bre(){var e=this._data;return this._milliseconds=Zn(this._milliseconds),this._days=Zn(this._days),this._months=Zn(this._months),e.milliseconds=Zn(e.milliseconds),e.seconds=Zn(e.seconds),e.minutes=Zn(e.minutes),e.hours=Zn(e.hours),e.months=Zn(e.months),e.years=Zn(e.years),this}function dV(e,t,r,n){var o=On(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Vre(e,t){return dV(this,e,t,1)}function Wre(e,t){return dV(this,e,t,-1)}function I1(e){return e<0?Math.floor(e):Math.ceil(e)}function Ure(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=I1(HC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Zr(e/1e3),n.seconds=o%60,i=Zr(o/60),n.minutes=i%60,a=Zr(i/60),n.hours=a%24,t+=Zr(a/24),s=Zr(vV(t)),r+=s,t-=I1(HC(s)),l=Zr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function vV(e){return e*4800/146097}function HC(e){return e*146097/4800}function zre(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=nn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+vV(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(HC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function Yre(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function Go(e){return function(){return this.as(e)}}var Gre=Go("ms"),Kre=Go("s"),qre=Go("m"),Xre=Go("h"),Zre=Go("d"),Qre=Go("w"),Jre=Go("M"),ene=Go("Q"),tne=Go("y");function rne(){return On(this)}function nne(e){return e=nn(e),this.isValid()?this[e+"s"]():NaN}function ll(e){return function(){return this.isValid()?this._data[e]:NaN}}var one=ll("milliseconds"),ine=ll("seconds"),ane=ll("minutes"),lne=ll("hours"),sne=ll("days"),une=ll("months"),fne=ll("years");function cne(){return Zr(this.days()/7)}var ao=Math.round,ql={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function hne(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function dne(e,t,r,n){var o=On(e).abs(),i=ao(o.as("s")),a=ao(o.as("m")),l=ao(o.as("h")),s=ao(o.as("d")),u=ao(o.as("M")),f=ao(o.as("w")),c=ao(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,hne.apply(null,h)}function vne(e){return e===void 0?ao:typeof e=="function"?(ao=e,!0):!1}function yne(e,t){return ql[e]===void 0?!1:t===void 0?ql[e]:(ql[e]=t,e==="s"&&(ql.ss=t-1),!0)}function gne(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=ql,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},ql,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=dne(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var cw=Math.abs;function vl(e){return(e>0)-(e<0)||+e}function Nm(){if(!this.isValid())return this.localeData().invalidDate();var e=cw(this._milliseconds)/1e3,t=cw(this._days),r=cw(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Zr(e/60),o=Zr(n/60),e%=60,n%=60,i=Zr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=vl(this._months)!==vl(l)?"-":"",f=vl(this._days)!==vl(l)?"-":"",c=vl(this._milliseconds)!==vl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var nt=xm.prototype;nt.isValid=ste;nt.abs=Bre;nt.add=Vre;nt.subtract=Wre;nt.as=zre;nt.asMilliseconds=Gre;nt.asSeconds=Kre;nt.asMinutes=qre;nt.asHours=Xre;nt.asDays=Zre;nt.asWeeks=Qre;nt.asMonths=Jre;nt.asQuarters=ene;nt.asYears=tne;nt.valueOf=Yre;nt._bubble=Ure;nt.clone=rne;nt.get=nne;nt.milliseconds=one;nt.seconds=ine;nt.minutes=ane;nt.hours=lne;nt.days=sne;nt.weeks=cne;nt.months=une;nt.years=fne;nt.humanize=gne;nt.toISOString=Nm;nt.toString=Nm;nt.toJSON=Nm;nt.locale=rV;nt.localeData=oV;nt.toIsoString=rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Nm);nt.lang=nV;Pe("X",0,0,"unix");Pe("x",0,0,"valueOf");be("x",$m);be("X",LJ);yt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});yt("x",function(e,t,r){r._d=new Date(Qe(e))});//! moment.js
ee.version="2.29.4";pJ(_t);ee.fn=ne;ee.min=ote;ee.max=ite;ee.now=ate;ee.utc=Yn;ee.unix=xre;ee.months=Nre;ee.isDate=bv;ee.locale=yi;ee.invalid=Rm;ee.duration=On;ee.isMoment=bn;ee.weekdays=Lre;ee.parseZone=Dre;ee.localeData=Yo;ee.isDuration=ag;ee.monthsShort=Hre;ee.weekdaysMin=Fre;ee.defineLocale=lE;ee.updateLocale=Dee;ee.locales=Nee;ee.weekdaysShort=jre;ee.normalizeUnits=nn;ee.relativeTimeRounding=vne;ee.relativeTimeThreshold=yne;ee.calendarFormat=Ate;ee.prototype=ne;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const pne=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));var mne=TypeError,bne=9007199254740991,yV=function(e){if(e>bne)throw mne("Maximum allowed index exceeded");return e},wne=$e,Sne=je,Cne=Ef,_ne=Yt,One=Ir,Rne=en,M1=yV,x1=Rf,Ene=$0,Tne=vv,Pne=wt,kne=Zd,gV=Pne("isConcatSpreadable"),$ne=kne>=51||!Sne(function(){var e=[];return e[gV]=!1,e.concat()[0]!==e}),Ane=function(e){if(!_ne(e))return!1;var t=e[gV];return t!==void 0?!!t:Cne(e)},Ine=!$ne||!Tne("concat");wne({target:"Array",proto:!0,arity:1,forced:Ine},{concat:function(t){var r=One(this),n=Ene(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],Ane(u))for(s=Rne(u),M1(o+s),a=0;a<s;a++,o++)a in u&&x1(n,o,u[a]);else M1(o+1),x1(n,o++,u);return n.length=o,n}});var Mne=Yt,xne=Un,Dne=wt,Nne=Dne("match"),gE=function(e){var t;return Mne(e)&&((t=e[Nne])!==void 0?!!t:xne(e)=="RegExp")},Hne=gE,Lne=TypeError,pE=function(e){if(Hne(e))throw Lne("The method doesn't accept regular expressions");return e},jne=wt,Fne=jne("match"),mE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[Fne]=!1,"/./"[e](t)}catch{}}return!1},Bne=$e,Vne=Ye,Wne=pE,Une=Ar,D1=Kt,zne=mE,Yne=Vne("".indexOf);Bne({target:"String",proto:!0,forced:!zne("includes")},{includes:function(t){return!!~Yne(D1(Une(this)),D1(Wne(t)),arguments.length>1?arguments[1]:void 0)}});var Gne=Uo,Kne=yv,qne=wt,Xne=Gt,N1=qne("species"),pV=function(e){var t=Gne(e);Xne&&t&&!t[N1]&&Kne(t,N1,{configurable:!0,get:function(){return this}})},Zne=Of,Qne=yv,H1=w0,Jne=hv,eoe=T0,toe=_n,roe=E0,noe=d0,sy=v0,ooe=pV,Yf=Gt,L1=fv.fastKey,mV=zo,j1=mV.set,hw=mV.getterFor,bV={getConstructor:function(e,t,r,n){var o=e(function(u,f){eoe(u,i),j1(u,{type:t,index:Zne(null),first:void 0,last:void 0,size:0}),Yf||(u.size=0),toe(f)||roe(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=hw(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,y;return d?d.value=c:(h.last=d={index:y=L1(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),Yf?h.size++:u.size++,y!=="F"&&(h.index[y]=d)),u},s=function(u,f){var c=a(u),h=L1(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return H1(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,Yf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),Yf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=Jne(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),H1(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),Yf&&Qne(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=hw(t),i=hw(n);noe(e,t,function(a,l){j1(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,sy(void 0,!0)):l=="keys"?sy(s.key,!1):l=="values"?sy(s.value,!1):sy([s.key,s.value],!1)},r?"entries":"values",!r,!0),ooe(t)}},ioe=cm,aoe=bV;ioe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},aoe);var F1=jt,loe=cB,soe=_n,uoe=wt,foe=uoe("species"),coe=function(e,t){var r=F1(e).constructor,n;return r===void 0||soe(n=F1(r)[foe])?t:loe(n)},hoe=al,Gf=Zt,bE=Ye,doe=ym,voe=jt,yoe=_n,goe=gE,B1=Ar,poe=coe,moe=N0,boe=rl,dw=Kt,woe=tl,V1=S0,W1=gm,Soe=vm,Coe=D0,_oe=je,yl=Coe.UNSUPPORTED_Y,U1=4294967295,Ooe=Math.min,wV=[].push,Roe=bE(/./.exec),gl=bE(wV),Kf=bE("".slice),Eoe=!_oe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});doe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=dw(B1(this)),l=i===void 0?U1:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!goe(o))return Gf(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=Gf(Soe,c,a))&&(d=c.lastIndex,!(d>f&&(gl(s,Kf(a,f,h.index)),h.length>1&&h.index<a.length&&hoe(wV,s,V1(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!Roe(c,""))&&gl(s,""):gl(s,Kf(a,f)),s.length>l?V1(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Gf(t,this,o,i)}:n=t,[function(i,a){var l=B1(this),s=yoe(i)?void 0:woe(i,e);return s?Gf(s,i,l,a):Gf(n,dw(l),i,a)},function(o,i){var a=voe(this),l=dw(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=poe(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(yl?"g":"y"),h=new u(yl?"^(?:"+a.source+")":a,c),d=i===void 0?U1:i>>>0;if(d===0)return[];if(l.length===0)return W1(h,l)===null?[l]:[];for(var v=0,y=0,m=[];y<l.length;){h.lastIndex=yl?0:y;var w=W1(h,yl?Kf(l,y):l),C;if(w===null||(C=Ooe(boe(h.lastIndex+(yl?y:0)),l.length))===v)y=moe(l,y,f);else{if(gl(m,Kf(l,v,y)),m.length===d)return m;for(var S=1;S<=w.length-1;S++)if(gl(m,w[S]),m.length===d)return m;y=v=C}}return gl(m,Kf(l,v)),m}]},!Eoe,yl);function SV(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function LC(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Tc(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function Ft(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Wr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function We(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function A(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function CV(e){return Ft(e,function(t,r){return t+r},0)}function Toe(e){return Ft(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function Poe(e){return Ft(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function koe(e){return e.length?CV(e)/e.length:0}function _V(e){return Ft(e,function(t,r){return t.concat(Array.isArray(r)?_V(r):r)},[])}function wE(e){var t=[];return A(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function jC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function $oe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return l.includes(s)})}),a}function Aoe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return A(i,function(l){A(l,function(s){a.has(s)||a.add(s)})}),Array.from(a)}function FC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const Ioe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:koe,arrayEach:A,arrayFilter:Wr,arrayFlatten:_V,arrayMap:We,arrayMax:Toe,arrayMin:Poe,arrayReduce:Ft,arraySum:CV,arrayUnique:wE,extendArray:LC,getDifferenceOfArrays:jC,getIntersectionOfArrays:$oe,getUnionOfArrays:Aoe,pivot:Tc,stringToArray:FC,to2dArray:SV},Symbol.toStringTag,{value:"Module"}));function dt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=Ft(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var z1,Y1,G1,K1,q1,X1;function rs(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function BC(e){"@babel/helpers - typeof";return BC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BC(e)}function Dt(e){var t;switch(BC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ve(e){return typeof e<"u"}function mt(e){return typeof e>"u"}function Xt(e){return e===null||e===""||mt(e)}function OV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var bc="length",Pc=function(t){return parseInt(t,16)},Z1=function(t){return parseInt(t,10)},Xg=function(t,r,n){return t.substr(r,n)},kc=function(t){return t.codePointAt(0)-65},VC=function(t){return"".concat(t).replace(/\-/g,"")},Moe=function(t){return Pc(Xg(VC(t),Pc("12"),kc("F")))/(Pc(Xg(VC(t),kc("B"),~~![][bc]))||9)},xoe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},Q1=!1,J1={invalid:function(){return dt(z1||(z1=rs([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(Y1||(Y1=rs([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return dt(G1||(G1=rs([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},eA={invalid:function(){return dt(K1||(K1=rs([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(q1||(q1=rs([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return dt(X1||(X1=rs([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function RV(e,t){var r=!Xt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="13.0.0",i,a="invalid",l="invalid";e=VC(e||"");var s=Doe(e);if(r||n||s)if(s){var u=ee("22/06/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=Moe(e);i=ee((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(xoe()&&(a="valid",l="valid"),!Q1&&a!=="valid"){var h=J1[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](J1[a]({keyValidityDate:i,hotVersion:o})),Q1=!0}if(l!=="valid"&&t.parentNode){var d=eA[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=eA[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function Doe(e){var t=[][bc],r=t;if(e[bc]!==kc("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=kc(o.shift());i;i=kc(o.shift()||"A"))--i<""[bc]?r=r|(Z1("".concat(Z1(Pc(n)+(Pc(Xg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Xg(e,i,i?o[bc]===1?9:8:6);return r===t}const Noe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:RV,isDefined:ve,isEmpty:Xt,isRegExp:OV,isUndefined:mt,stringify:Dt},Symbol.toStringTag,{value:"Module"}));var Hoe=Ir,tA=Jd,Loe=en,joe=function(t){for(var r=Hoe(this),n=Loe(r),o=arguments.length,i=tA(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:tA(a,n);l>i;)r[i++]=t;return r},Foe=$e,Boe=joe,Voe=rv;Foe({target:"Array",proto:!0},{fill:Boe});Voe("fill");var Woe=$e,Uoe=Ir,EV=tv,zoe=je,Yoe=zoe(function(){EV(1)});Woe({target:"Object",stat:!0,forced:Yoe},{keys:function(t){return EV(Uoe(t))}});var Goe=il.forEach,Koe=Tf,qoe=Koe("forEach"),Xoe=qoe?[].forEach:function(t){return Goe(this,t,arguments.length>1?arguments[1]:void 0)},rA=vt,nA=gF,Zoe=pF,vw=Xoe,Qoe=nl,TV=function(e){if(e&&e.forEach!==vw)try{Qoe(e,"forEach",vw)}catch{e.forEach=vw}};for(var yw in nA)nA[yw]&&TV(rA[yw]&&rA[yw].prototype);TV(Zoe);function oA(e,t,r){return t=Joe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Joe(e){var t=eie(e,"string");return Vo(t)==="symbol"?t:String(t)}function eie(e,t){if(Vo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vo(e){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(e)}function ys(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},ze(e,function(r,n){n!=="__children"&&(r&&Vo(r)==="object"&&!Array.isArray(r)?t[n]=ys(r):Array.isArray(r)?r.length&&Vo(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[ys(r[0])]:t[n]=[]:t[n]=null)})),t}function Ko(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function zt(e,t,r){var n=Array.isArray(r);return ze(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function _v(e,t){ze(t,function(r,n){t[n]&&Vo(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),_v(e[n],t[n])):e[n]=t[n]})}function fr(e){return Vo(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Sr(e){var t={};return ze(e,function(r,n){t[n]=r}),t}function gt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return A(r,function(o){e.MIXINS.push(o.MIXIN_NAME),ze(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(y){var m=y;return(Array.isArray(m)||Ue(m))&&(m=fr(m)),m};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function Hm(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function Kn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function ze(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function PV(e,t){var r=t.split("."),n=e;return ze(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function sg(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(xt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function Lm(e){if(!Ue(e))return 0;var t=function r(n){var o=0;return Ue(n)?ze(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Fa(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},oA(t,n,e),oA(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const tie=Object.freeze(Object.defineProperty({__proto__:null,clone:Sr,createObjectPropListener:Fa,deepClone:fr,deepExtend:_v,deepObjectSize:Lm,defineGetter:Kn,duckSchema:ys,extend:zt,getProperty:PV,hasOwnProperty:xt,inherit:Ko,isObject:Ue,isObjectEqual:Hm,mixin:gt,objectEach:ze,setProperty:sg},Symbol.toStringTag,{value:"Module"}));var kr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Ur={chrome:kr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:kr(function(e){return/CriOS/.test(e)}),edge:kr(function(e){return/Edge/.test(e)}),edgeWebKit:kr(function(e){return/EdgiOS/.test(e)}),firefox:kr(function(e){return/Firefox/.test(e)}),firefoxWebKit:kr(function(e){return/FxiOS/.test(e)}),ie:kr(function(e){return/Trident/.test(e)}),ie9:kr(function(){return!!document.documentMode}),mobile:kr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:kr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},$f={mac:kr(function(e){return/^Mac/.test(e)}),win:kr(function(e){return/^Win/.test(e)}),linux:kr(function(e){return/^Linux/.test(e)}),ios:kr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function kV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;ze(Ur,function(i){var a=i.test;return void a(r,o)})}function $V(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;ze($f,function(n){var o=n.test;return void o(r)})}kV();$V();function SE(){return Ur.chrome.value}function AV(){return Ur.chromeWebKit.value}function ug(){return Ur.firefox.value}function IV(){return Ur.firefoxWebKit.value}function MV(){return Ur.safari.value}function xV(){return Ur.edge.value}function rie(){return Ur.edgeWebKit.value}function DV(){return Ur.ie.value}function NV(){return Ur.ie9.value}function nie(){return Ur.ie.value||Ur.edge.value}function pn(){return Ur.mobile.value}function CE(){return $f.ios.value}function _E(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&$f.mac.value}function WC(){return $f.win.value}function Zg(){return $f.mac.value}function oie(){return $f.linux.value}const iie=Object.freeze(Object.defineProperty({__proto__:null,isChrome:SE,isChromeWebKit:AV,isEdge:xV,isEdgeWebKit:rie,isFirefox:ug,isFirefoxWebKit:IV,isIE:DV,isIE9:NV,isIOS:CE,isIpadOS:_E,isLinuxOS:oie,isMSBrowser:nie,isMacOS:Zg,isMobileBrowser:pn,isSafari:MV,isWindowsOS:WC,setBrowserMeta:kV,setPlatformMeta:$V},Symbol.toStringTag,{value:"Module"}));var me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:ug()?182:174,AUDIO_MUTE:ug()?181:173,AUDIO_UP:ug()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},aie=[me.ALT,me.ARROW_DOWN,me.ARROW_LEFT,me.ARROW_RIGHT,me.ARROW_UP,me.AUDIO_DOWN,me.AUDIO_MUTE,me.AUDIO_UP,me.BACKSPACE,me.CAPS_LOCK,me.DELETE,me.END,me.ENTER,me.ESCAPE,me.F1,me.F2,me.F3,me.F4,me.F5,me.F6,me.F7,me.F8,me.F9,me.F10,me.F11,me.F12,me.F13,me.F14,me.F15,me.F16,me.F17,me.F18,me.F19,me.HOME,me.INSERT,me.MEDIA_NEXT,me.MEDIA_PLAY_PAUSE,me.MEDIA_PREV,me.MEDIA_STOP,me.NULL,me.NUM_LOCK,me.PAGE_DOWN,me.PAGE_UP,me.PAUSE,me.SCROLL_LOCK,me.SHIFT,me.TAB];function HV(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function OE(e){return aie.includes(e)}function lie(e){var t=[];return Zg()?t.push(me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX):t.push(me.CONTROL),t.includes(e)}function LV(e){return[me.CONTROL,me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX].includes(e)}function gs(e,t){var r=t.split("|"),n=!1;return A(r,function(o){if(e===me[o])return n=!0,!1}),n}const sie=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:me,isCtrlKey:lie,isCtrlMetaKey:LV,isFunctionKey:OE,isKey:gs,isPrintableChar:HV},Symbol.toStringTag,{value:"Module"}));function wn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function la(e){return e.isImmediatePropagationEnabled===!1}function $i(e){return e.button===2}function jm(e){return e.button===0}const uie=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:la,isLeftClick:jm,isRightClick:$i,stopImmediatePropagation:wn},Symbol.toStringTag,{value:"Module"}));var fie=_r.f,cie=function(e,t,r){r in e||fie(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},hie=Gt,RE=vt,Ov=Ye,die=lm,vie=P0,yie=nl,gie=ol.f,iA=Di,pie=gE,aA=Kt,mie=mB,jV=D0,bie=cie,wie=tn,Sie=je,Cie=Nt,_ie=zo.enforce,Oie=pV,Rie=wt,FV=TF,BV=PF,Eie=Rie("match"),gi=RE.RegExp,Ul=gi.prototype,Tie=RE.SyntaxError,Pie=Ov(Ul.exec),Qg=Ov("".charAt),lA=Ov("".replace),sA=Ov("".indexOf),kie=Ov("".slice),$ie=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,La=/a/g,gw=/a/g,Aie=new gi(La)!==La,VV=jV.MISSED_STICKY,Iie=jV.UNSUPPORTED_Y,Mie=hie&&(!Aie||VV||FV||BV||Sie(function(){return gw[Eie]=!1,gi(La)!=La||gi(gw)==gw||gi(La,"i")!="/a/i"})),xie=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Qg(e,r),i==="\\"){n+=i+Qg(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},Die=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=Qg(e,r),f==="\\")f=f+Qg(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":Pie($ie,kie(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||Cie(i,u))throw new Tie("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(die("RegExp",Mie)){for(var Wi=function(t,r){var n=iA(Ul,this),o=pie(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Wi)return t;if((o||iA(Ul,t))&&(t=t.source,i&&(r=mie(l))),t=t===void 0?"":aA(t),r=r===void 0?"":aA(r),l=t,FV&&"dotAll"in La&&(u=!!r&&sA(r,"s")>-1,u&&(r=lA(r,/s/g,""))),s=r,VV&&"sticky"in La&&(f=!!r&&sA(r,"y")>-1,f&&Iie&&(r=lA(r,/y/g,""))),BV&&(c=Die(t),t=c[0],a=c[1]),h=vie(gi(t,r),n?this:Ul,Wi),(u||f||a.length)&&(d=_ie(h),u&&(d.dotAll=!0,d.raw=Wi(xie(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{yie(h,"source",l===""?"(?:)":l)}catch{}return h},uA=gie(gi),fA=0;uA.length>fA;)bie(Wi,gi,uA[fA++]);Ul.constructor=Wi,Wi.prototype=Ul,wie(RE,"RegExp",Wi,{constructor:!0})}Oie("RegExp");var Nie=$e,Hie=Ye,Lie=Xd,jie=zr,Fie=Tf,Bie=Hie([].join),Vie=Lie!=Object,Wie=Vie||!Fie("join",",");Nie({target:"Array",proto:!0,forced:Wie},{join:function(t){return Bie(jie(this),t===void 0?",":t)}});function UC(e){"@babel/helpers - typeof";return UC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UC(e)}function Fm(e){return window.requestAnimationFrame(e)}function WV(){return!!document.documentElement.classList}function UV(){return!!document.createTextNode("test").textContent}function zV(){return!!window.getComputedStyle}function Kc(e){window.cancelAnimationFrame(e)}function EE(){return"ontouchstart"in window}var zC;function Uie(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),zC=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function TE(){return zC===void 0&&Uie(),zC}var pl;function YV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return pl||((typeof Intl>"u"?"undefined":UC(Intl))==="object"?pl=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?pl=function(n,o){return"".concat(n).localeCompare(o)}:pl=function(n,o){return n===o?0:n>o?-1:1},pl)}var qf;function GV(){if(qf!==void 0)return qf;try{var e={get passive(){qf=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{qf=!1}return qf}const zie=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Kc,getComparisonFunction:YV,hasCaptionProblem:TE,isClassListSupported:WV,isGetComputedStyleSupported:zV,isPassiveEventSupported:GV,isTextContentSupported:UV,isTouchSupported:EE,requestAnimationFrame:Fm},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function ui(e){"@babel/helpers - typeof";return ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(e)}function YC(e,t){return YC=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},YC(e,t)}function Yie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fg(e,t,r){return Yie()?fg=Reflect.construct:fg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&YC(u,a.prototype),u},fg.apply(null,arguments)}function fn(e){return Gie(e)||Kie(e)||qie(e)||Xie()}function Gie(e){if(Array.isArray(e))return GC(e)}function Kie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qie(e,t){if(e){if(typeof e=="string")return GC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GC(e,t)}}function GC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Zie=Object.hasOwnProperty,cA=Object.setPrototypeOf,Qie=Object.isFrozen,Jie=Object.getPrototypeOf,eae=Object.getOwnPropertyDescriptor,Cr=Object.freeze,Sn=Object.seal,tae=Object.create,KV=typeof Reflect<"u"&&Reflect,Jg=KV.apply,KC=KV.construct;Jg||(Jg=function(t,r,n){return t.apply(r,n)});Cr||(Cr=function(t){return t});Sn||(Sn=function(t){return t});KC||(KC=function(t,r){return fg(t,fn(r))});var rae=Jr(Array.prototype.forEach),hA=Jr(Array.prototype.pop),Xf=Jr(Array.prototype.push),cg=Jr(String.prototype.toLowerCase),pw=Jr(String.prototype.toString),nae=Jr(String.prototype.match),ln=Jr(String.prototype.replace),oae=Jr(String.prototype.indexOf),iae=Jr(String.prototype.trim),vr=Jr(RegExp.prototype.test),mw=aae(TypeError);function Jr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Jg(e,t,n)}}function aae(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return KC(e,r)}}function Xe(e,t,r){r=r||cg,cA&&cA(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(Qie(t)||(t[n]=i),o=i)}e[o]=!0}return e}function Ui(e){var t=tae(null),r;for(r in e)Jg(Zie,e,[r])===!0&&(t[r]=e[r]);return t}function uy(e,t){for(;e!==null;){var r=eae(e,t);if(r){if(r.get)return Jr(r.get);if(typeof r.value=="function")return Jr(r.value)}e=Jie(e)}function n(o){return console.warn("fallback value for",o),null}return n}var dA=Cr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),bw=Cr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ww=Cr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),lae=Cr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Sw=Cr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),sae=Cr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),vA=Cr(["#text"]),yA=Cr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Cw=Cr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gA=Cr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),fy=Cr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),uae=Sn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),fae=Sn(/<%[\w\W]*|[\w\W]*%>/gm),cae=Sn(/\${[\w\W]*}/gm),hae=Sn(/^data-[\-\w.\u00B7-\uFFFF]/),dae=Sn(/^aria-[\-\w]+$/),vae=Sn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yae=Sn(/^(?:\w+script|data):/i),gae=Sn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),pae=Sn(/^html$/i),mae=function(){return typeof window>"u"?null:window},bae=function(t,r){if(ui(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function qV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mae(),t=function(H){return qV(H)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,y=uy(v,"cloneNode"),m=uy(v,"nextSibling"),w=uy(v,"childNodes"),C=uy(v,"parentNode");if(typeof i=="function"){var S=n.createElement("template");S.content&&S.content.ownerDocument&&(n=S.content.ownerDocument)}var R=bae(d,r),O=R?R.createHTML(""):"",j=n,U=j.implementation,q=j.createNodeIterator,G=j.createDocumentFragment,X=j.getElementsByTagName,Q=r.importNode,oe={};try{oe=Ui(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof C=="function"&&U&&typeof U.createHTMLDocument<"u"&&oe!==9;var ue=uae,he=fae,Oe=cae,we=hae,$=dae,k=yae,g=gae,p=vae,b=null,T=Xe({},[].concat(fn(dA),fn(bw),fn(ww),fn(Sw),fn(vA))),E=null,B=Xe({},[].concat(fn(yA),fn(Cw),fn(gA),fn(fy))),x=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Z=null,re=!0,ie=!0,se=!1,_e=!0,Se=!1,z=!1,Ne=!1,Be=!1,ke=!1,Ie=!1,Ae=!1,_=!0,P=!1,I="user-content-",F=!0,M=!1,V={},N=null,D=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),W=null,L=Xe({},["audio","video","img","source","image","track"]),Y=null,le=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",He="http://www.w3.org/1999/xhtml",Ze=He,st=!1,Ge=null,Me=Xe({},[pe,Re,He],pw),De,dr=["application/xhtml+xml","text/html"],Bt="text/html",Ve,Je=null,St=n.createElement("form"),ut=function(H){return H instanceof RegExp||H instanceof Function},ft=function(H){Je&&Je===H||((!H||ui(H)!=="object")&&(H={}),H=Ui(H),De=dr.indexOf(H.PARSER_MEDIA_TYPE)===-1?De=Bt:De=H.PARSER_MEDIA_TYPE,Ve=De==="application/xhtml+xml"?pw:cg,b="ALLOWED_TAGS"in H?Xe({},H.ALLOWED_TAGS,Ve):T,E="ALLOWED_ATTR"in H?Xe({},H.ALLOWED_ATTR,Ve):B,Ge="ALLOWED_NAMESPACES"in H?Xe({},H.ALLOWED_NAMESPACES,pw):Me,Y="ADD_URI_SAFE_ATTR"in H?Xe(Ui(le),H.ADD_URI_SAFE_ATTR,Ve):le,W="ADD_DATA_URI_TAGS"in H?Xe(Ui(L),H.ADD_DATA_URI_TAGS,Ve):L,N="FORBID_CONTENTS"in H?Xe({},H.FORBID_CONTENTS,Ve):D,K="FORBID_TAGS"in H?Xe({},H.FORBID_TAGS,Ve):{},Z="FORBID_ATTR"in H?Xe({},H.FORBID_ATTR,Ve):{},V="USE_PROFILES"in H?H.USE_PROFILES:!1,re=H.ALLOW_ARIA_ATTR!==!1,ie=H.ALLOW_DATA_ATTR!==!1,se=H.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=H.SAFE_FOR_TEMPLATES||!1,z=H.WHOLE_DOCUMENT||!1,ke=H.RETURN_DOM||!1,Ie=H.RETURN_DOM_FRAGMENT||!1,Ae=H.RETURN_TRUSTED_TYPE||!1,Be=H.FORCE_BODY||!1,_=H.SANITIZE_DOM!==!1,P=H.SANITIZE_NAMED_PROPS||!1,F=H.KEEP_CONTENT!==!1,M=H.IN_PLACE||!1,p=H.ALLOWED_URI_REGEXP||p,Ze=H.NAMESPACE||He,x=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&ut(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&ut(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(ie=!1),Ie&&(ke=!0),V&&(b=Xe({},fn(vA)),E=[],V.html===!0&&(Xe(b,dA),Xe(E,yA)),V.svg===!0&&(Xe(b,bw),Xe(E,Cw),Xe(E,fy)),V.svgFilters===!0&&(Xe(b,ww),Xe(E,Cw),Xe(E,fy)),V.mathMl===!0&&(Xe(b,Sw),Xe(E,gA),Xe(E,fy))),H.ADD_TAGS&&(b===T&&(b=Ui(b)),Xe(b,H.ADD_TAGS,Ve)),H.ADD_ATTR&&(E===B&&(E=Ui(E)),Xe(E,H.ADD_ATTR,Ve)),H.ADD_URI_SAFE_ATTR&&Xe(Y,H.ADD_URI_SAFE_ATTR,Ve),H.FORBID_CONTENTS&&(N===D&&(N=Ui(N)),Xe(N,H.FORBID_CONTENTS,Ve)),F&&(b["#text"]=!0),z&&Xe(b,["html","head","body"]),b.table&&(Xe(b,["tbody"]),delete K.tbody),Cr&&Cr(H),Je=H)},et=Xe({},["mi","mo","mn","ms","mtext"]),qo=Xe({},["foreignobject","desc","title","annotation-xml"]),vb=Xe({},["title","style","font","a","script"]),ji=Xe({},bw);Xe(ji,ww),Xe(ji,lae);var Hf=Xe({},Sw);Xe(Hf,sae);var AY=function(H){var ae=C(H);(!ae||!ae.tagName)&&(ae={namespaceURI:Ze,tagName:"template"});var de=cg(H.tagName),lt=cg(ae.tagName);return Ge[H.namespaceURI]?H.namespaceURI===Re?ae.namespaceURI===He?de==="svg":ae.namespaceURI===pe?de==="svg"&&(lt==="annotation-xml"||et[lt]):!!ji[de]:H.namespaceURI===pe?ae.namespaceURI===He?de==="math":ae.namespaceURI===Re?de==="math"&&qo[lt]:!!Hf[de]:H.namespaceURI===He?ae.namespaceURI===Re&&!qo[lt]||ae.namespaceURI===pe&&!et[lt]?!1:!Hf[de]&&(vb[de]||!ji[de]):!!(De==="application/xhtml+xml"&&Ge[H.namespaceURI]):!1},qn=function(H){Xf(t.removed,{element:H});try{H.parentNode.removeChild(H)}catch{try{H.outerHTML=O}catch{H.remove()}}},yb=function(H,ae){try{Xf(t.removed,{attribute:ae.getAttributeNode(H),from:ae})}catch{Xf(t.removed,{attribute:null,from:ae})}if(ae.removeAttribute(H),H==="is"&&!E[H])if(ke||Ie)try{qn(ae)}catch{}else try{ae.setAttribute(H,"")}catch{}},ak=function(H){var ae,de;if(Be)H="<remove></remove>"+H;else{var lt=nae(H,/^[\r\n\t ]+/);de=lt&&lt[0]}De==="application/xhtml+xml"&&Ze===He&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");var Rr=R?R.createHTML(H):H;if(Ze===He)try{ae=new h().parseFromString(Rr,De)}catch{}if(!ae||!ae.documentElement){ae=U.createDocument(Ze,"template",null);try{ae.documentElement.innerHTML=st?O:Rr}catch{}}var ir=ae.body||ae.documentElement;return H&&de&&ir.insertBefore(n.createTextNode(de),ir.childNodes[0]||null),Ze===He?X.call(ae,z?"html":"body")[0]:z?ae.documentElement:ir},lk=function(H){return q.call(H.ownerDocument||H,H,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},IY=function(H){return H instanceof c&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof f)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},Lf=function(H){return ui(a)==="object"?H instanceof a:H&&ui(H)==="object"&&typeof H.nodeType=="number"&&typeof H.nodeName=="string"},Xn=function(H,ae,de){J[H]&&rae(J[H],function(lt){lt.call(t,ae,de,Je)})},sk=function(H){var ae;if(Xn("beforeSanitizeElements",H,null),IY(H)||vr(/[\u0080-\uFFFF]/,H.nodeName))return qn(H),!0;var de=Ve(H.nodeName);if(Xn("uponSanitizeElement",H,{tagName:de,allowedTags:b}),H.hasChildNodes()&&!Lf(H.firstElementChild)&&(!Lf(H.content)||!Lf(H.content.firstElementChild))&&vr(/<[/\w]/g,H.innerHTML)&&vr(/<[/\w]/g,H.textContent)||de==="select"&&vr(/<template/i,H.innerHTML))return qn(H),!0;if(!b[de]||K[de]){if(!K[de]&&fk(de)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de)))return!1;if(F&&!N[de]){var lt=C(H)||H.parentNode,Rr=w(H)||H.childNodes;if(Rr&&lt)for(var ir=Rr.length,or=ir-1;or>=0;--or)lt.insertBefore(y(Rr[or],!0),m(H))}return qn(H),!0}return H instanceof l&&!AY(H)||(de==="noscript"||de==="noembed")&&vr(/<\/no(script|embed)/i,H.innerHTML)?(qn(H),!0):(Se&&H.nodeType===3&&(ae=H.textContent,ae=ln(ae,ue," "),ae=ln(ae,he," "),ae=ln(ae,Oe," "),H.textContent!==ae&&(Xf(t.removed,{element:H.cloneNode()}),H.textContent=ae)),Xn("afterSanitizeElements",H,null),!1)},uk=function(H,ae,de){if(_&&(ae==="id"||ae==="name")&&(de in n||de in St))return!1;if(!(ie&&!Z[ae]&&vr(we,ae))){if(!(re&&vr($,ae))){if(!E[ae]||Z[ae]){if(!(fk(H)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,H)||x.tagNameCheck instanceof Function&&x.tagNameCheck(H))&&(x.attributeNameCheck instanceof RegExp&&vr(x.attributeNameCheck,ae)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(ae))||ae==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de))))return!1}else if(!Y[ae]){if(!vr(p,ln(de,g,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&H!=="script"&&oae(de,"data:")===0&&W[H])){if(!(se&&!vr(k,ln(de,g,"")))){if(de)return!1}}}}}}return!0},fk=function(H){return H.indexOf("-")>0},ck=function(H){var ae,de,lt,Rr;Xn("beforeSanitizeAttributes",H,null);var ir=H.attributes;if(ir){var or={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:E};for(Rr=ir.length;Rr--;){ae=ir[Rr];var Vv=ae,er=Vv.name,gb=Vv.namespaceURI;if(de=er==="value"?ae.value:iae(ae.value),lt=Ve(er),or.attrName=lt,or.attrValue=de,or.keepAttr=!0,or.forceKeepAttr=void 0,Xn("uponSanitizeAttribute",H,or),de=or.attrValue,!or.forceKeepAttr&&(yb(er,H),!!or.keepAttr)){if(!_e&&vr(/\/>/i,de)){yb(er,H);continue}Se&&(de=ln(de,ue," "),de=ln(de,he," "),de=ln(de,Oe," "));var hk=Ve(H.nodeName);if(uk(hk,lt,de)){if(P&&(lt==="id"||lt==="name")&&(yb(er,H),de=I+de),R&&ui(d)==="object"&&typeof d.getAttributeType=="function"&&!gb)switch(d.getAttributeType(hk,lt)){case"TrustedHTML":de=R.createHTML(de);break;case"TrustedScriptURL":de=R.createScriptURL(de);break}try{gb?H.setAttributeNS(gb,er,de):H.setAttribute(er,de),hA(t.removed)}catch{}}}}Xn("afterSanitizeAttributes",H,null)}},MY=function Ee(H){var ae,de=lk(H);for(Xn("beforeSanitizeShadowDOM",H,null);ae=de.nextNode();)Xn("uponSanitizeShadowNode",ae,null),!sk(ae)&&(ae.content instanceof o&&Ee(ae.content),ck(ae));Xn("afterSanitizeShadowDOM",H,null)};return t.sanitize=function(Ee){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,de,lt,Rr,ir;if(st=!Ee,st&&(Ee="<!-->"),typeof Ee!="string"&&!Lf(Ee)){if(typeof Ee.toString!="function")throw mw("toString is not a function");if(Ee=Ee.toString(),typeof Ee!="string")throw mw("dirty is not a string, aborting")}if(!t.isSupported){if(ui(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(Lf(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Ne||ft(H),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var or=Ve(Ee.nodeName);if(!b[or]||K[or])throw mw("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)ae=ak("<!---->"),de=ae.ownerDocument.importNode(Ee,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?ae=de:ae.appendChild(de);else{if(!ke&&!Se&&!z&&Ee.indexOf("<")===-1)return R&&Ae?R.createHTML(Ee):Ee;if(ae=ak(Ee),!ae)return ke?null:Ae?O:""}ae&&Be&&qn(ae.firstChild);for(var Vv=lk(M?Ee:ae);lt=Vv.nextNode();)lt.nodeType===3&&lt===Rr||sk(lt)||(lt.content instanceof o&&MY(lt.content),ck(lt),Rr=lt);if(Rr=null,M)return Ee;if(ke){if(Ie)for(ir=G.call(ae.ownerDocument);ae.firstChild;)ir.appendChild(ae.firstChild);else ir=ae;return(E.shadowroot||E.shadowrootmod)&&(ir=Q.call(r,ir,!0)),ir}var er=z?ae.outerHTML:ae.innerHTML;return z&&b["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&vr(pae,ae.ownerDocument.doctype.name)&&(er="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+er),Se&&(er=ln(er,ue," "),er=ln(er,he," "),er=ln(er,Oe," ")),R&&Ae?R.createHTML(er):er},t.setConfig=function(Ee){ft(Ee),Ne=!0},t.clearConfig=function(){Je=null,Ne=!1},t.isValidAttribute=function(Ee,H,ae){Je||ft({});var de=Ve(Ee),lt=Ve(H);return uk(de,lt,ae)},t.addHook=function(Ee,H){typeof H=="function"&&(J[Ee]=J[Ee]||[],Xf(J[Ee],H))},t.removeHook=function(Ee){if(J[Ee])return hA(J[Ee])},t.removeHooks=function(Ee){J[Ee]&&(J[Ee]=[])},t.removeAllHooks=function(){J={}},t}var wae=qV();function ur(e){return e[0].toUpperCase()+e.substr(1)}function Sae(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=Dt(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function PE(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function kE(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function $E(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function qC(e){return Bm("".concat(e),{ALLOWED_TAGS:[]})}function Bm(e,t){return wae.sanitize(e,t)}const Cae=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Sae,isPercentValue:kE,randomString:PE,sanitize:Bm,stripTags:qC,substitute:$E,toUpperCaseFirst:ur},Symbol.toStringTag,{value:"Module"}));function pA(e){return Eae(e)||Rae(e)||Oae(e)||_ae()}function _ae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oae(e,t){if(e){if(typeof e=="string")return XC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XC(e,t)}}function Rae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Eae(e){if(Array.isArray(e))return XC(e)}function XC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XV(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function ZV(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function qc(e){return ZV(e)&&e.parent}function Tae(e){return!!Object.getPrototypeOf(e.parent)}function pi(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function wc(e,t,r){for(var n=[],o=e;o&&(o=pi(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function mi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function QV(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function li(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var ZC,QC,JC;function cy(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(WV()){var mA=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};ZC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},QC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=cy(o),o.length>0)if(mA(n)){var i;(i=t.classList).add.apply(i,pA(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},JC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=cy(o),o.length>0)if(mA(n)){var i;(i=t.classList).remove.apply(i,pA(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var _w=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};ZC=function(t,r){return t.className!==void 0&&_w(r).test(t.className)},QC=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=cy(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!_w(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},JC=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=cy(i);i[n];)o=o.replace(_w(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return ZC(e,t)}function te(e,t){QC(e,t)}function Le(e,t){JC(e,t)}function AE(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)AE(t[r])}function Cn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var JV=/(<(.*)>|&(.*);)/;function sl(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;JV.test(t)?e.innerHTML=r?Bm(t):t:Ai(e,t)}function Ai(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?UV?r.textContent=t:r.data=t:(Cn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function ps(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ps(r.host.impl);if(r.host)return ps(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Ut(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(TE()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function ms(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Ba(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Xc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?ms(t):e.scrollTop}function ep(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Ba(t):e.scrollLeft}function Zc(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=zV(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function Va(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ii(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function bs(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ii(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function Pae(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ii(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ct(e){return e.offsetWidth}function Tt(e){return TE()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function ho(e){return e.clientHeight||e.innerHeight}function $c(e){return e.clientWidth||e.innerWidth}function kae(e,t,r){e.addEventListener(t,r,!1)}function $ae(e,t,r){e.removeEventListener(t,r,!1)}function IE(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function eW(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function tW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function e_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Rv(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var Ow;function Aae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Jt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ow===void 0&&(Ow=Aae(e)),Ow}function rW(e){return e.offsetWidth!==e.clientWidth}function nW(e){return e.offsetHeight!==e.clientHeight}function Vm(e,t,r){NV()?(e.style.top=r,e.style.left=t):MV()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Iae(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function Ev(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Qc(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Wm(e){return Qc(e)&&e.hasAttribute("data-hot-input")===!1}function oW(e){var t=e.ownerDocument.activeElement;Wm(t)||e.select()}function ME(e){return!e.parentNode}function iW(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const Mae=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:JV,addClass:te,addEvent:kae,clearTextSelection:e_,closest:pi,closestDown:wc,empty:Cn,fastInnerHTML:sl,fastInnerText:Ai,getCaretPosition:IE,getComputedStyle:Ii,getCssTransform:Iae,getFrameElement:ZV,getParent:XV,getParentWindow:qc,getScrollLeft:ep,getScrollTop:Xc,getScrollableElement:Zc,getScrollbarWidth:Jt,getSelectionEndPosition:eW,getSelectionText:tW,getStyle:bs,getTrimmingContainer:Va,getWindowScrollLeft:Ba,getWindowScrollTop:ms,hasAccessToParentWindow:Tae,hasClass:xe,hasHorizontalScrollbar:nW,hasVerticalScrollbar:rW,index:QV,innerHeight:ho,innerWidth:$c,isChildOf:mi,isDetached:ME,isInput:Qc,isOutsideInput:Wm,isVisible:ps,matchesCSSRules:Pae,observeVisibilityChangeOnce:iW,offset:Ut,outerHeight:Tt,outerWidth:ct,overlayContainsElement:li,removeClass:Le,removeEvent:$ae,removeTextNodes:AE,resetCssTransform:Ev,selectElementIfAllowed:oW,setCaretPosition:Rv,setOverlayPosition:Vm},Symbol.toStringTag,{value:"Module"}));var xae=cm,Dae=bV;xae("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Dae);var Nae=Gt,Hae=Ef,Lae=TypeError,jae=Object.getOwnPropertyDescriptor,Fae=Nae&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Bae=Fae?function(e,t){if(Hae(e)&&!jae(e,"length").writable)throw Lae("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Vae=$e,Wae=Ir,Uae=Jd,zae=Ni,Yae=en,Gae=Bae,Kae=yV,qae=$0,Xae=Rf,Rw=CF,Zae=vv,Qae=Zae("splice"),Jae=Math.max,ele=Math.min;Vae({target:"Array",proto:!0,forced:!Qae},{splice:function(t,r){var n=Wae(this),o=Yae(n),i=Uae(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=ele(Jae(zae(r),0),o-i)),Kae(o+l-s),u=qae(n,s),f=0;f<s;f++)c=i+f,c in n&&Xae(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:Rw(n,h);for(f=o;f>o-s+l;f--)Rw(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:Rw(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return Gae(n,o-s+l),u}});function bt(){if(ve(console)){var e;(e=console).warn.apply(e,arguments)}}function xE(){if(ve(console)){var e;(e=console).error.apply(e,arguments)}}var tle=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",rle=TypeError,aW=function(e,t){if(e<t)throw rle("Not enough arguments");return e},lW=vt,nle=al,ole=Ot,ile=tle,ale=Ja,lle=pv,sle=aW,ule=lW.Function,fle=/MSIE .\./.test(ale)||ile&&function(){var e=lW.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),DE=function(e,t){var r=t?2:1;return fle?function(n,o){var i=sle(arguments.length,1)>r,a=ole(n)?n:ule(n),l=i?lle(arguments,r):[],s=i?function(){nle(a,this,l)}:a;return t?e(s,o):e(s)}:e},cle=$e,sW=vt,hle=DE,bA=hle(sW.setInterval,!0);cle({global:!0,bind:!0,forced:sW.setInterval!==bA},{setInterval:bA});var dle=$e,uW=vt,vle=DE,wA=vle(uW.setTimeout,!0);dle({global:!0,bind:!0,forced:uW.setTimeout!==wA},{setTimeout:wA});var yle=$e,gle=Ye,ple=Ef,mle=gle([].reverse),SA=[1,2];yle({target:"Array",proto:!0,forced:String(SA)===String(SA.reverse())},{reverse:function(){return ple(this)&&(this.length=this.length),mle(this)}});function pt(e){return typeof e=="function"}function fW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,s),r=0,o=void 0},h)),n}return i}function ble(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=fW(e,t),o=r;function i(){o=r}function a(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return o?(o-=1,e.apply(this,s)):n.apply(this,s)}return a.clearHits=i,a}function NE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function wle(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return Ft(o,function(u,f){return f(u)},n.apply(this,l))}}function HE(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function cW(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function Sle(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a.reverse()),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function tp(e,t,r,n,o,i,a,l){return ve(l)?e.call(t,r,n,o,i,a,l):ve(a)?e.call(t,r,n,o,i,a):ve(i)?e.call(t,r,n,o,i):ve(o)?e.call(t,r,n,o):ve(n)?e.call(t,r,n):ve(r)?e.call(t,r):e.call(t)}const Cle=Object.freeze(Object.defineProperty({__proto__:null,curry:cW,curryRight:Sle,debounce:NE,fastCall:tp,isFunction:pt,partial:HE,pipe:wle,throttle:fW,throttleAfterHits:ble},Symbol.toStringTag,{value:"Module"}));function Jc(e){"@babel/helpers - typeof";return Jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jc(e)}var CA;function _le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rle(n.key),n)}}function Ole(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rle(e){var t=Ele(e,"string");return Jc(t)==="symbol"?t:String(t)}function Ele(e,t){if(Jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tle(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ml=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Ple=dt(CA||(CA=Tle([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Ew=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Tw=new Map([]),hW=function(){function e(){_le(this,e),this.globalBucket=this.createEmptyBucket()}return Ole(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return A(ml,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))A(n,function(s){return o.add(r,s,i)});else{Ew.has(r)&&bt($E(Ple,{hookName:r,removedInVersion:Ew.get(r)})),Tw.has(r)&&bt(Tw.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&A(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?A(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=tp(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],y=v?v.length:0,m=0;if(y)for(;m<y;){if(!v[m]||v[m].skip){m+=1;continue}var w=tp(v[m],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[m]&&v[m].runOnce&&this.remove(n,v[m],r),m+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ze(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||ml.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&ml.splice(ml.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Tw.has(r)||Ew.has(r)}},{key:"isRegistered",value:function(r){return ml.indexOf(r)>=0}},{key:"getRegistered",value:function(){return ml}}],[{key:"getSingleton",value:function(){return $le()}}]),e}(),kle=new hW;function $le(){return kle}const ge=hW;function OA(e){return xle(e)||Mle(e)||Ile(e)||Ale()}function Ale(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ile(e,t){if(e){if(typeof e=="string")return t_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t_(e,t)}}function Mle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xle(e){if(Array.isArray(e))return t_(e)}function t_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Pw=new Map;function on(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Pw.has(e)||Pw.set(e,new Map);var t=Pw.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return OA(t.keys())}function a(){return OA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var r_=new WeakMap,Tv=on("editors"),Dle=Tv.register,dW=Tv.getItem,vW=Tv.hasItem,Nle=Tv.getNames;Tv.getValues;function Hle(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ge.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function yW(e,t){var r;if(typeof e=="function")r_.get(e)||Pr(null,e),r=r_.get(e);else if(typeof e=="string")r=dW(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function rp(e){if(typeof e=="function")return e;if(!vW(e))throw Error('No registered editor found under "'.concat(e,'" name'));return dW(e).getConstructor()}function Pr(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new Hle(t);typeof e=="string"&&Dle(e,r),r_.set(t,r)}function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}function Lle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fle(n.key),n)}}function jle(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fle(e){var t=Ble(e,"string");return eh(t)==="symbol"?t:String(t)}function Ble(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hg=0,Vle=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Lle(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return jle(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,Wle(s))}return typeof a!="boolean"&&!GV()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),hg+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),hg-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),hg-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function Wle(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),wn(this)},e}const Pt=Vle;function Ule(){return hg}function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function zle(e,t){return qle(e)||Kle(e,t)||Gle(e,t)||Yle()}function Yle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gle(e,t){if(e){if(typeof e=="string")return EA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EA(e,t)}}function EA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function qle(e){if(Array.isArray(e))return e}function Xle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qle(n.key),n)}}function Zle(e,t,r){return t&&TA(e.prototype,t),r&&TA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qle(e){var t=Jle(e,"string");return th(t)==="symbol"?t:String(t)}function Jle(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Um="editorManager.navigation",Ac="editorManager.handlingEditor",n_=function(){function e(t,r,n){var o=this;Xle(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Pt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return Zle(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:Ac};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),wn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=zle(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&Wm(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=yW(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!OE(o)&&!LV(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ve(n.instance.getSelected())},group:Um};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),PA=new WeakMap;n_.getInstance=function(e,t,r){var n=PA.get(e);return n||(n=new n_(e,t,r),PA.set(e,n)),n};const ese=n_;var tse="hooksRefRegisterer",gW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;A(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;ze(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Kn(gW,"MIXIN_NAME",tse,{writable:!1,enumerable:!1});const rse=gW;function ws(e){"@babel/helpers - typeof";return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function nse(e,t){return lse(e)||ase(e,t)||ise(e,t)||ose()}function ose(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ise(e,t){if(e){if(typeof e=="string")return kA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kA(e,t)}}function kA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ase(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lse(e){if(Array.isArray(e))return e}function sse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o_(e,t)}function o_(e,t){return o_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o_(e,t)}function use(e){var t=hse();return function(){var n=np(e),o;if(t){var i=np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fse(this,o)}}function fse(e,t){if(t&&(ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cse(e)}function cse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function np(e){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(e)}function $A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dse(n.key),n)}}function IA(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dse(e){var t=vse(e,"string");return ws(t)==="symbol"?t:String(t)}function vse(e,t){if(ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yse="base",tr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),i_="baseEditor",Af=function(){function e(t){$A(this,e),this.hot=t,this.instance=t,this.state=tr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return IA(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=tr.VIRGIN}},{key:"extend",value:function(){return function(r){sse(o,r);var n=use(o);function o(){return $A(this,o),n.apply(this,arguments)}return IA(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=nse(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),y={runOnlyIf:function(){return ve(o.hot.getSelected())},group:i_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===tr.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=tr.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:Dt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(i_),u.removeShortcutsByGroup(Um),this.state===tr.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===tr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=tr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=tr.FINISHED,i.discardEditor(c)}):(this.state=tr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=tr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===tr.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=tr.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=tr.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===tr.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Ut(n),u=ct(n),f=Ut(this.hot.rootElement),c=ct(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,y=d!==l?d.scrollLeft:0,m=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,C=w.wtTable,S=C.name,R=["master","inline_start"].includes(S)?v:0,O=["master","top","bottom"].includes(S)?y:0,j=s.top===f.top?0:1,U=s.top-f.top-j-R,q=0;this.hot.isRtl()?q=l.innerWidth-s.left-u-m-1+O:q=s.left-f.left-1-O,["top","top_inline_start_corner"].includes(S)&&(U+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(q+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var G=this.hot.hasColHeaders(),X=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),oe=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=oe-this.hot.view._wt.getSetting("fixedRowsBottom");(G&&X<=0||X===J)&&(U+=1),Q<=0&&(q+=1);var ue=a.rowsRenderCalculator.startPosition,he=a.columnsRenderCalculator.startPosition,Oe=Math.abs(i.inlineStartOverlay.getScrollPosition()),we=i.topOverlay.getScrollPosition(),$=Jt(this.hot.rootDocument),k=n.offsetTop+ue-we,g=0;if(this.hot.isRtl()){var p=n.offsetLeft;p>=0?g=C.getWidth()-n.offsetLeft:g=Math.abs(p),g+=he-Oe-u}else g=n.offsetLeft+he-Oe;var b=Ii(this.TD,this.hot.rootWindow),T=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",E=parseInt(b[T],10)>0?0:1,B=parseInt(b.borderTopWidth,10)>0?0:1,x=ct(n)+E,K=Tt(n)+B,Z=rW(h)?$:0,re=nW(d)?$:0,ie=this.hot.view.maximumVisibleElementWidth(g)-Z+E,se=Math.max(this.hot.view.maximumVisibleElementHeight(k)-re+B,23);return{top:U,start:q,height:K,maxHeight:se,width:x,maxWidth:ie}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return yse}}]),e}();gt(Af,rse);var gse=$e,pse=il.map,mse=vv,bse=mse("map");gse({target:"Array",proto:!0,forced:!bse},{map:function(t){return pse(this,t,arguments.length>1?arguments[1]:void 0)}});function wse(e){return Ose(e)||_se(e)||Cse(e)||Sse()}function Sse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cse(e,t){if(e){if(typeof e=="string")return a_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a_(e,t)}}function _se(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ose(e){if(Array.isArray(e))return a_(e)}function a_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l_(e){"@babel/helpers - typeof";return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function wr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=l_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(wse(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function pW(e){return wr(e,[","])}function Ce(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function op(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function LE(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const Rse=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:wr,isNumericLike:pW,rangeEach:Ce,rangeEachReverse:op,valueAccordingPercent:LE},Symbol.toStringTag,{value:"Module"}));function Ese(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,y){d.addEventListener(v,y,!1)},a=function(d,v,y){d.removeEventListener(v,y,!1)},l=function(d){var v,y;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(d.maxHeight);isNaN(y)||(e.maxHeight=y)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(d.minWidth);isNaN(m)||(e.minWidth=m)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,y){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,y){f(d,v,y)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function MA(e,t){for(var r=IE(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}Rv(t,o)}function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function xA(e,t){return $se(e)||kse(e,t)||Pse(e,t)||Tse()}function Tse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pse(e,t){if(e){if(typeof e=="string")return DA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DA(e,t)}}function DA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $se(e){if(Array.isArray(e))return e}function Ase(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mse(n.key),n)}}function Ise(e,t,r){return t&&NA(e.prototype,t),r&&NA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mse(e){var t=xse(e,"string");return Ss(t)==="symbol"?t:String(t)}function xse(e,t){if(Ss(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ic(){return typeof Reflect<"u"&&Reflect.get?Ic=Reflect.get.bind():Ic=function(t,r,n){var o=Dse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ic.apply(this,arguments)}function Dse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wa(e),e!==null););return e}function Nse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s_(e,t)}function s_(e,t){return s_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},s_(e,t)}function Hse(e){var t=jse();return function(){var n=Wa(e),o;if(t){var i=Wa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lse(this,o)}}function Lse(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mW(e)}function mW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wa(e){return Wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wa(e)}var Fse="ht_editor_visible",hy="ht_editor_hidden",HA="textEditor",Bse="text",ul=function(e){Nse(r,e);var t=Hse(r);function r(n){var o;return Ase(this,r),o=t.call(this,n),o.eventManager=new Pt(mW(o)),o.autoResize=Ese(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return Ise(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(Ic(Wa(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==tr.FINISHED&&this.hideEditableElement();var d=!h;d&&!pn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===tr.VIRGIN&&(this.TEXTAREA.value="",Ic(Wa(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),Rv(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,hy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(DV()||xV())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,hy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Ce(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,hy)&&Le(this.TEXTAREA_PARENT,hy),i?(this.layerClass=Fse,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==tr.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ii(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ii(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),y=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),m=s-v,w=f-y,C=u-v,S=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,C),minHeight:Math.min(w,S),maxWidth:C,maxHeight:S},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),CE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ve(o.hot.getSelected())},group:HA},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:Ac,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:Ac,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:Ac,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=xA(c,1),d=h[0];MA(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=xA(c,1),d=h[0];MA(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Um),i.removeShortcutsByGroup(HA),i.removeShortcutsByGroup(i_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[me.ARROW_UP,me.ARROW_RIGHT,me.ARROW_DOWN,me.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return Bse}}]),r}(Af);function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function Vse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Use(n.key),n)}}function Wse(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Use(e){var t=zse(e,"string");return Cs(t)==="symbol"?t:String(t)}function zse(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hn(){return typeof Reflect<"u"&&Reflect.get?hn=Reflect.get.bind():hn=function(t,r,n){var o=Yse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hn.apply(this,arguments)}function Yse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fr(e),e!==null););return e}function Gse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u_(e,t)}function u_(e,t){return u_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u_(e,t)}function Kse(e){var t=Zse();return function(){var n=Fr(e),o;if(t){var i=Fr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qse(this,o)}}function qse(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xse(e)}function Xse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fr(e)}var jA="handsontableEditor",Qse="handsontable",jE=function(e){Gse(r,e);var t=Kse(r);function r(){return Vse(this,r),t.apply(this,arguments)}return Wse(r,[{key:"open",value:function(){hn(Fr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Rv(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),hn(Fr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){hn(Fr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var y=this.getSourceData(v.row,v.col);y!==void 0&&f.setValue(y),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&zt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||hn(Fr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){hn(Fr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}hn(Fr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");hn(Fr(r.prototype),"registerShortcuts",this).call(this);var l={group:jA,relativeToGroup:Um,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),wn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){hn(Fr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(jA)}}],[{key:"EDITOR_TYPE",get:function(){return Qse}}]),r}(ul),Jse="base";function If(e,t,r,n,o,i,a){var l=[],s=[];a.className&&te(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Le(t,s),te(t,l)}If.RENDERER_TYPE=Jse;var eue="text";function Hi(e,t,r,n,o,i,a){If.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Dt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Cn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ai(t,l)}Hi.RENDERER_TYPE=eue;function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function tue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bW(n.key),n)}}function rue(e,t,r){return t&&FA(e.prototype,t),r&&FA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,r,n){var o=nue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function nue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function oue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f_(e,t)}function f_(e,t){return f_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},f_(e,t)}function iue(e){var t=lue();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return aue(this,o)}}function aue(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c_(e)}function c_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}function sue(e,t,r){return t=bW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bW(e){var t=uue(e,"string");return _s(t)==="symbol"?t:String(t)}function uue(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kw=new WeakMap,fue="autocomplete",FE=function(e){oue(r,e);var t=iue(r);function r(n){var o;return tue(this,r),o=t.call(this,n),sue(c_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,y;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=qC(Dt(a[v])),l)y=d.indexOf(i);else{var m=this.cellProperties.locale;y=d.toLocaleLowerCase(m).indexOf(i.toLocaleLowerCase(m))}y!==-1&&(h=d.length-y-f,s.push({baseIndex:v,index:y,charsLeft:h,value:d}))}for(s.sort(function(w,C){if(C.index===-1)return-1;if(w.index===-1)return 1;if(w.index<C.index)return-1;if(C.index<w.index)return 1;if(w.index===C.index){if(w.charsLeft<C.charsLeft)return-1;if(w.charsLeft>C.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],kw.set(c_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return rue(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ve(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){fa(vo(r.prototype),"createElements",this).call(this),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=kw.get(this);fa(vo(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Jt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[ct(this.TEXTAREA)-2]:void 0,width:l?ct(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,y,m){Hi(f,c,h,d,v,y,m);var w=o.cellProperties,C=w.filteringCaseSensitive,S=w.allowHtml,R=w.locale,O=o.query,j=Dt(y),U,q;j&&!S&&(U=C===!0?j.indexOf(O):j.toLocaleLowerCase(R).indexOf(O.toLocaleLowerCase(R)),U!==-1&&(q=j.substr(U,O.length),j=j.replace(q,"<strong>".concat(q,"</strong>")))),c.innerHTML=j},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),fa(vo(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){fa(vo(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=IE(this.TEXTAREA),a=eW(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,y=c.length;v<y&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Tc([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),Rv(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Va(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Ut(this.TEXTAREA),s=Tt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Tt(this.hot.view._wt.wtTable.THEAD),h=Ut(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,y=u>v&&d>v;return y?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(y?d:v,u),y}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=We(o,function(s){return Dt(s)}),l=We(a,function(s){return i?s:qC(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===me.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===me.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=kw.get(this);if(a.skipOne=!1,HV(o.keyCode)||o.keyCode===me.BACKSPACE||o.keyCode===me.DELETE||o.keyCode===me.INSERT){var l=10;if(o.keyCode===me.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return fue}}]),r}(jE);function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function cue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,due(n.key),n)}}function hue(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function due(e){var t=vue(e,"string");return Os(t)==="symbol"?t:String(t)}function vue(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h_(e,t)}function h_(e,t){return h_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},h_(e,t)}function gue(e){var t=bue();return function(){var n=ip(e),o;if(t){var i=ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pue(this,o)}}function pue(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mue(e)}function mue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ip(e){return ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ip(e)}var wue="checkbox",wW=function(e){yue(r,e);var t=gue(r);function r(){return cue(this,r),t.apply(this,arguments)}return hue(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return wue}}]),r}(Af),SW={exports:{}};const Sue=xY(pne);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=Sue}catch{}e.exports=n(o)}})(Zy,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function($,k,g,p){o?$.addEventListener(k,g,!!p):$.attachEvent("on"+k,g)},s=function($,k,g,p){o?$.removeEventListener(k,g,!!p):$.detachEvent("on"+k,g)},u=function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},f=function($,k){return(" "+$.className+" ").indexOf(" "+k+" ")!==-1},c=function($,k){f($,k)||($.className=$.className===""?k:$.className+" "+k)},h=function($,k){$.className=u((" "+$.className+" ").replace(" "+k+" "," "))},d=function($){return/Array/.test(Object.prototype.toString.call($))},v=function($){return/Date/.test(Object.prototype.toString.call($))&&!isNaN($.getTime())},y=function($){var k=$.getDay();return k===0||k===6},m=function($){return $%4===0&&$%100!==0||$%400===0},w=function($,k){return[31,m($)?29:28,31,30,31,30,31,31,30,31,30,31][k]},C=function($){v($)&&$.setHours(0,0,0,0)},S=function($,k){return $.getTime()===k.getTime()},R=function($,k,g){var p,b;for(p in k)b=$[p]!==void 0,b&&typeof k[p]=="object"&&k[p]!==null&&k[p].nodeName===void 0?v(k[p])?g&&($[p]=new Date(k[p].getTime())):d(k[p])?g&&($[p]=k[p].slice(0)):$[p]=R({},k[p],g):(g||!b)&&($[p]=k[p]);return $},O=function($,k,g){var p;i.createEvent?(p=i.createEvent("HTMLEvents"),p.initEvent(k,!0,!1),p=R(p,g),$.dispatchEvent(p)):i.createEventObject&&(p=i.createEventObject(),p=R(p,g),$.fireEvent("on"+k,p))},j=function($){return $.month<0&&($.year-=Math.ceil(Math.abs($.month)/12),$.month+=12),$.month>11&&($.year+=Math.floor(Math.abs($.month)/12),$.month-=12),$},U={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},q=function($,k,g){for(k+=$.firstDay;k>=7;)k-=7;return g?$.i18n.weekdaysShort[k]:$.i18n.weekdays[k]},G=function($){var k=[],g="false";if($.isEmpty)if($.showDaysInNextAndPreviousMonths)k.push("is-outside-current-month"),$.enableSelectionDaysInNextAndPreviousMonths||k.push("is-selection-disabled");else return'<td class="is-empty"></td>';return $.isDisabled&&k.push("is-disabled"),$.isToday&&k.push("is-today"),$.isSelected&&(k.push("is-selected"),g="true"),$.hasEvent&&k.push("has-event"),$.isInRange&&k.push("is-inrange"),$.isStartRange&&k.push("is-startrange"),$.isEndRange&&k.push("is-endrange"),'<td data-day="'+$.day+'" class="'+k.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+$.year+'" data-pika-month="'+$.month+'" data-pika-day="'+$.day+'">'+$.day+"</button></td>"},X=function($,k){$.setHours(0,0,0,0);var g=$.getDate(),p=$.getDay(),b=k,T=b-1,E=7,B=function(ie){return(ie+E-1)%E};$.setDate(g+T-B(p));var x=new Date($.getFullYear(),0,b),K=24*60*60*1e3,Z=($.getTime()-x.getTime())/K,re=1+Math.round((Z-T+B(x.getDay()))/E);return re},Q=function($,k,g,p){var b=new Date(g,k,$),T=n?r(b).isoWeek():X(b,p);return'<td class="pika-week">'+T+"</td>"},oe=function($,k,g,p){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(k?$.reverse():$).join("")+"</tr>"},J=function($){return"<tbody>"+$.join("")+"</tbody>"},ue=function($){var k,g=[];for($.showWeekNumber&&g.push("<th></th>"),k=0;k<7;k++)g.push('<th scope="col"><abbr title="'+q($,k)+'">'+q($,k,!0)+"</abbr></th>");return"<thead><tr>"+($.isRTL?g.reverse():g).join("")+"</tr></thead>"},he=function($,k,g,p,b,T){var E,B,x,K=$._o,Z=g===K.minYear,re=g===K.maxYear,ie='<div id="'+T+'" class="pika-title" role="heading" aria-live="assertive">',se,_e,Se=!0,z=!0;for(x=[],E=0;E<12;E++)x.push('<option value="'+(g===b?E-k:12+E-k)+'"'+(E===p?' selected="selected"':"")+(Z&&E<K.minMonth||re&&E>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[E]+"</option>");for(se='<div class="pika-label">'+K.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+x.join("")+"</select></div>",d(K.yearRange)?(E=K.yearRange[0],B=K.yearRange[1]+1):(E=g-K.yearRange,B=1+g+K.yearRange),x=[];E<B&&E<=K.maxYear;E++)E>=K.minYear&&x.push('<option value="'+E+'"'+(E===g?' selected="selected"':"")+">"+E+"</option>");return _e='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+x.join("")+"</select></div>",K.showMonthAfterYear?ie+=_e+se:ie+=se+_e,Z&&(p===0||K.minMonth>=p)&&(Se=!1),re&&(p===11||K.maxMonth<=p)&&(z=!1),k===0&&(ie+='<button class="pika-prev'+(Se?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),k===$._o.numberOfMonths-1&&(ie+='<button class="pika-next'+(z?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),ie+="</div>"},Oe=function($,k,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ue($)+J(k)+"</table>"},we=function($){var k=this,g=k.config($);k._onMouseDown=function(b){if(k._v){b=b||window.event;var T=b.target||b.srcElement;if(T)if(f(T,"is-disabled")||(f(T,"pika-button")&&!f(T,"is-empty")&&!f(T.parentNode,"is-disabled")?(k.setDate(new Date(T.getAttribute("data-pika-year"),T.getAttribute("data-pika-month"),T.getAttribute("data-pika-day"))),g.bound&&a(function(){k.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):f(T,"pika-prev")?k.prevMonth():f(T,"pika-next")&&k.nextMonth()),f(T,"pika-select"))k._c=!0;else if(b.preventDefault)b.preventDefault();else return b.returnValue=!1,!1}},k._onChange=function(b){b=b||window.event;var T=b.target||b.srcElement;T&&(f(T,"pika-select-month")?k.gotoMonth(T.value):f(T,"pika-select-year")&&k.gotoYear(T.value))},k._onKeyChange=function(b){if(b=b||window.event,k.isVisible())switch(b.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:k.adjustDate("subtract",1);break;case 38:k.adjustDate("subtract",7);break;case 39:k.adjustDate("add",1);break;case 40:k.adjustDate("add",7);break;case 8:case 46:k.setDate(null);break}},k._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var b=r(g.field.value,g.format,g.formatStrict);return b&&b.isValid()?b.toDate():null}else return new Date(Date.parse(g.field.value))},k._onInputChange=function(b){var T;b.firedBy!==k&&(T=k._parseFieldValue(),v(T)&&k.setDate(T),k._v||k.show())},k._onInputFocus=function(){k.show()},k._onInputClick=function(){k.show()},k._onInputBlur=function(){var b=i.activeElement;do if(f(b,"pika-single"))return;while(b=b.parentNode);k._c||(k._b=a(function(){k.hide()},50)),k._c=!1},k._onClick=function(b){b=b||window.event;var T=b.target||b.srcElement,E=T;if(T){!o&&f(T,"pika-select")&&(T.onchange||(T.setAttribute("onchange","return;"),l(T,"change",k._onChange)));do if(f(E,"pika-single")||E===g.trigger)return;while(E=E.parentNode);k._v&&T!==g.trigger&&E!==g.trigger&&k.hide()}},k.el=i.createElement("div"),k.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),l(k.el,"mousedown",k._onMouseDown,!0),l(k.el,"touchend",k._onMouseDown,!0),l(k.el,"change",k._onChange),g.keyboardInput&&l(i,"keydown",k._onKeyChange),g.field&&(g.container?g.container.appendChild(k.el):g.bound?i.body.appendChild(k.el):g.field.parentNode.insertBefore(k.el,g.field.nextSibling),l(g.field,"change",k._onInputChange),g.defaultDate||(g.defaultDate=k._parseFieldValue(),g.setDefaultDate=!0));var p=g.defaultDate;v(p)?g.setDefaultDate?k.setDate(p,!0):k.gotoDate(p):k.gotoDate(new Date),g.bound?(this.hide(),k.el.className+=" is-bound",l(g.trigger,"click",k._onInputClick),l(g.trigger,"focus",k._onInputFocus),l(g.trigger,"blur",k._onInputBlur)):this.show()};return we.prototype={config:function($){this._o||(this._o=R({},U,!0));var k=R(this._o,$,!0);k.isRTL=!!k.isRTL,k.field=k.field&&k.field.nodeName?k.field:null,k.theme=typeof k.theme=="string"&&k.theme?k.theme:null,k.bound=!!(k.bound!==void 0?k.field&&k.bound:k.field),k.trigger=k.trigger&&k.trigger.nodeName?k.trigger:k.field,k.disableWeekends=!!k.disableWeekends,k.disableDayFn=typeof k.disableDayFn=="function"?k.disableDayFn:null;var g=parseInt(k.numberOfMonths,10)||1;if(k.numberOfMonths=g>4?4:g,v(k.minDate)||(k.minDate=!1),v(k.maxDate)||(k.maxDate=!1),k.minDate&&k.maxDate&&k.maxDate<k.minDate&&(k.maxDate=k.minDate=!1),k.minDate&&this.setMinDate(k.minDate),k.maxDate&&this.setMaxDate(k.maxDate),d(k.yearRange)){var p=new Date().getFullYear()-10;k.yearRange[0]=parseInt(k.yearRange[0],10)||p,k.yearRange[1]=parseInt(k.yearRange[1],10)||p}else k.yearRange=Math.abs(parseInt(k.yearRange,10))||U.yearRange,k.yearRange>100&&(k.yearRange=100);return k},toString:function($){return $=$||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,$):n?r(this._d).format($):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function($,k){n&&r.isMoment($)&&this.setDate($.toDate(),k)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function($,k){if(!$)return this._d=null,this._o.field&&(this._o.field.value="",O(this._o.field,"change",{firedBy:this})),this.draw();if(typeof $=="string"&&($=new Date(Date.parse($))),!!v($)){var g=this._o.minDate,p=this._o.maxDate;v(g)&&$<g?$=g:v(p)&&$>p&&($=p),this._d=new Date($.getTime()),C(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),O(this._o.field,"change",{firedBy:this})),!k&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function($){var k=!0;if(v($)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),b=$.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),k=b<g.getTime()||p.getTime()<b}k&&(this.calendars=[{month:$.getMonth(),year:$.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function($,k){var g=this.getDate()||new Date,p=parseInt(k)*24*60*60*1e3,b;$==="add"?b=new Date(g.valueOf()+p):$==="subtract"&&(b=new Date(g.valueOf()-p)),this.setDate(b)},adjustCalendars:function(){this.calendars[0]=j(this.calendars[0]);for(var $=1;$<this._o.numberOfMonths;$++)this.calendars[$]=j({month:this.calendars[0].month+$,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function($){isNaN($)||(this.calendars[0].month=parseInt($,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function($){isNaN($)||(this.calendars[0].year=parseInt($,10),this.adjustCalendars())},setMinDate:function($){$ instanceof Date?(C($),this._o.minDate=$,this._o.minYear=$.getFullYear(),this._o.minMonth=$.getMonth()):(this._o.minDate=U.minDate,this._o.minYear=U.minYear,this._o.minMonth=U.minMonth,this._o.startRange=U.startRange),this.draw()},setMaxDate:function($){$ instanceof Date?(C($),this._o.maxDate=$,this._o.maxYear=$.getFullYear(),this._o.maxMonth=$.getMonth()):(this._o.maxDate=U.maxDate,this._o.maxYear=U.maxYear,this._o.maxMonth=U.maxMonth,this._o.endRange=U.endRange),this.draw()},setStartRange:function($){this._o.startRange=$},setEndRange:function($){this._o.endRange=$},draw:function($){if(!(!this._v&&!$)){var k=this._o,g=k.minYear,p=k.maxYear,b=k.minMonth,T=k.maxMonth,E="",B;this._y<=g&&(this._y=g,!isNaN(b)&&this._m<b&&(this._m=b)),this._y>=p&&(this._y=p,!isNaN(T)&&this._m>T&&(this._m=T));for(var x=0;x<k.numberOfMonths;x++)B="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),E+='<div class="pika-lendar">'+he(this,x,this.calendars[x].year,this.calendars[x].month,this.calendars[0].year,B)+this.render(this.calendars[x].year,this.calendars[x].month,B)+"</div>";this.el.innerHTML=E,k.bound&&k.field.type!=="hidden"&&a(function(){k.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),k.bound&&k.field.setAttribute("aria-label",k.ariaLabel)}},adjustPosition:function(){var $,k,g,p,b,T,E,B,x,K,Z,re;if(!this._o.container){if(this.el.style.position="absolute",$=this._o.trigger,k=$,g=this.el.offsetWidth,p=this.el.offsetHeight,b=window.innerWidth||i.documentElement.clientWidth,T=window.innerHeight||i.documentElement.clientHeight,E=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Z=!0,re=!0,typeof $.getBoundingClientRect=="function")K=$.getBoundingClientRect(),B=K.left+window.pageXOffset,x=K.bottom+window.pageYOffset;else for(B=k.offsetLeft,x=k.offsetTop+k.offsetHeight;k=k.offsetParent;)B+=k.offsetLeft,x+=k.offsetTop;(this._o.reposition&&B+g>b||this._o.position.indexOf("right")>-1&&B-g+$.offsetWidth>0)&&(B=B-g+$.offsetWidth,Z=!1),(this._o.reposition&&x+p>T+E||this._o.position.indexOf("top")>-1&&x-p-$.offsetHeight>0)&&(x=x-p-$.offsetHeight,re=!1),this.el.style.left=B+"px",this.el.style.top=x+"px",c(this.el,Z?"left-aligned":"right-aligned"),c(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,Z?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function($,k,g){var p=this._o,b=new Date,T=w($,k),E=new Date($,k,1).getDay(),B=[],x=[];C(b),p.firstDay>0&&(E-=p.firstDay,E<0&&(E+=7));for(var K=k===0?11:k-1,Z=k===11?0:k+1,re=k===0?$-1:$,ie=k===11?$+1:$,se=w(re,K),_e=T+E,Se=_e;Se>7;)Se-=7;_e+=7-Se;for(var z=!1,Ne=0,Be=0;Ne<_e;Ne++){var ke=new Date($,k,1+(Ne-E)),Ie=v(this._d)?S(ke,this._d):!1,Ae=S(ke,b),_=p.events.indexOf(ke.toDateString())!==-1,P=Ne<E||Ne>=T+E,I=1+(Ne-E),F=k,M=$,V=p.startRange&&S(p.startRange,ke),N=p.endRange&&S(p.endRange,ke),D=p.startRange&&p.endRange&&p.startRange<ke&&ke<p.endRange,W=p.minDate&&ke<p.minDate||p.maxDate&&ke>p.maxDate||p.disableWeekends&&y(ke)||p.disableDayFn&&p.disableDayFn(ke);P&&(Ne<E?(I=se+I,F=K,M=re):(I=I-T,F=Z,M=ie));var L={day:I,month:F,year:M,hasEvent:_,isSelected:Ie,isToday:Ae,isDisabled:W,isEmpty:P,isStartRange:V,isEndRange:N,isInRange:D,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&Ie&&(z=!0),x.push(G(L)),++Be===7&&(p.showWeekNumber&&x.unshift(Q(Ne-E,k,$,p.firstWeekOfYearMinDays)),B.push(oe(x,p.isRTL,p.pickWholeWeek,z)),x=[],Be=0,z=!1)}return Oe(p,B,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var $=this._v;$!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,$!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var $=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),$.keyboardInput&&s(i,"keydown",this._onKeyChange),$.field&&(s($.field,"change",this._onInputChange),$.bound&&(s($.trigger,"click",this._onInputClick),s($.trigger,"focus",this._onInputFocus),s($.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},we})})(SW);var Cue=SW.exports;const VA=lj(Cue);function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function _ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rue(n.key),n)}}function Oue(e,t,r){return t&&WA(e.prototype,t),r&&WA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rue(e){var t=Eue(e,"string");return Rs(t)==="symbol"?t:String(t)}function Eue(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function so(){return typeof Reflect<"u"&&Reflect.get?so=Reflect.get.bind():so=function(t,r,n){var o=Tue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},so.apply(this,arguments)}function Tue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vn(e),e!==null););return e}function Pue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d_(e,t)}function d_(e,t){return d_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},d_(e,t)}function kue(e){var t=Iue();return function(){var n=vn(e),o;if(t){var i=vn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ue(this,o)}}function $ue(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aue(e)}function Aue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vn(e){return vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vn(e)}var CW="date",UA="dateEditor",_W=function(e){Pue(r,e);var t=kue(r);function r(n){var o;return _ue(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return Oue(r,[{key:"init",value:function(){var o=this;if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof VA!="function")throw new Error("You need to include Pikaday to your project.");so(vn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){so(vn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new Pt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){so(vn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");so(vn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:UA})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(UA),so(vn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}so(vn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?OE(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new VA(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Tt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-ct(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&_v(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ee(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return CW}}]),r}(ul);function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function Mue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Due(n.key),n)}}function xue(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Due(e){var t=Nue(e,"string");return Es(t)==="symbol"?t:String(t)}function Nue(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dg(){return typeof Reflect<"u"&&Reflect.get?dg=Reflect.get.bind():dg=function(t,r,n){var o=Hue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},dg.apply(this,arguments)}function Hue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ts(e),e!==null););return e}function Lue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v_(e,t)}function v_(e,t){return v_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},v_(e,t)}function jue(e){var t=Vue();return function(){var n=Ts(e),o;if(t){var i=Ts(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Fue(this,o)}}function Fue(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bue(e)}function Bue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ts(e){return Ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ts(e)}var Wue="dropdown",BE=function(e){Lue(r,e);var t=jue(r);function r(){return Mue(this,r),t.apply(this,arguments)}return xue(r,[{key:"prepare",value:function(o,i,a,l,s,u){dg(Ts(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Wue}}]),r}(FE);ge.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===BE&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function Uue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yue(n.key),n)}}function zue(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yue(e){var t=Gue(e,"string");return Ps(t)==="symbol"?t:String(t)}function Gue(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},y_(e,t)}function que(e){var t=Que();return function(){var n=ap(e),o;if(t){var i=ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Xue(this,o)}}function Xue(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zue(e)}function Zue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Que(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ap(e)}var Jue="numeric",OW=function(e){Kue(r,e);var t=que(r);function r(){return Uue(this,r),t.apply(this,arguments)}return zue(r,null,[{key:"EDITOR_TYPE",get:function(){return Jue}}]),r}(ul);function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function efe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rfe(n.key),n)}}function tfe(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rfe(e){var t=nfe(e,"string");return ks(t)==="symbol"?t:String(t)}function nfe(e,t){if(ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vg(){return typeof Reflect<"u"&&Reflect.get?vg=Reflect.get.bind():vg=function(t,r,n){var o=ofe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vg.apply(this,arguments)}function ofe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$s(e),e!==null););return e}function ife(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g_(e,t)}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},g_(e,t)}function afe(e){var t=ufe();return function(){var n=$s(e),o;if(t){var i=$s(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lfe(this,o)}}function lfe(e,t){if(t&&(ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sfe(e)}function sfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ufe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $s(e){return $s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$s(e)}var ffe="password",RW=function(e){ife(r,e);var t=afe(r);function r(){return efe(this,r),t.apply(this,arguments)}return tfe(r,[{key:"createElements",value:function(){vg($s(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Cn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return ffe}}]),r}(ul);function Ua(e){"@babel/helpers - typeof";return Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(e)}function cfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dfe(n.key),n)}}function hfe(e,t,r){return t&&KA(e.prototype,t),r&&KA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dfe(e){var t=vfe(e,"string");return Ua(t)==="symbol"?t:String(t)}function vfe(e,t){if(Ua(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ua(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yg(){return typeof Reflect<"u"&&Reflect.get?yg=Reflect.get.bind():yg=function(t,r,n){var o=yfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},yg.apply(this,arguments)}function yfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=As(e),e!==null););return e}function gfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},p_(e,t)}function pfe(e){var t=wfe();return function(){var n=As(e),o;if(t){var i=As(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mfe(this,o)}}function mfe(e,t){if(t&&(Ua(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bfe(e)}function bfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function As(e){return As=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},As(e)}var $w="ht_editor_visible",qA="selectEditor",Sfe="select",Cfe=function(e){gfe(r,e);var t=pfe(r);function r(){return cfe(this,r),t.apply(this,arguments)}return hfe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,$w)&&Le(this.select,$w),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;yg(As(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),Cn(this.select),ze(h,function(d,v){var y=f.hot.rootDocument.createElement("OPTION");y.value=v,sl(y,d),f.select.appendChild(y)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Ua(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===tr.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",te(this.select,$w)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:qA};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(qA)}}],[{key:"EDITOR_TYPE",get:function(){return Sfe}}]),r}(Af);function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function _fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rfe(n.key),n)}}function Ofe(e,t,r){return t&&XA(e.prototype,t),r&&XA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rfe(e){var t=Efe(e,"string");return Is(t)==="symbol"?t:String(t)}function Efe(e,t){if(Is(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Is(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gg(){return typeof Reflect<"u"&&Reflect.get?gg=Reflect.get.bind():gg=function(t,r,n){var o=Tfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gg.apply(this,arguments)}function Tfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ms(e),e!==null););return e}function Pfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function kfe(e){var t=Ife();return function(){var n=Ms(e),o;if(t){var i=Ms(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $fe(this,o)}}function $fe(e,t){if(t&&(Is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Afe(e)}function Afe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ife(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ms(e){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ms(e)}var Mfe="time",EW=function(e){Pfe(r,e);var t=kfe(r);function r(){return _fe(this,r),t.apply(this,arguments)}return Ofe(r,[{key:"prepare",value:function(o,i,a,l,s,u){gg(Ms(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return Mfe}}]),r}(ul);function xfe(){Pr(Af),Pr(FE),Pr(wW),Pr(_W),Pr(BE),Pr(jE),Pr(OW),Pr(RW),Pr(Cfe),Pr(ul),Pr(EW)}var Dfe="html";function VE(e,t,r,n,o,i,a){If.apply(this,[e,t,r,n,o,i,a]),sl(t,i??"",!1)}VE.RENDERER_TYPE=Dfe;var Nfe="autocomplete";function Mf(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?VE:Hi,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),te(t,"htAutocomplete"),!e.acArrowListener){var f=new Pt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Mf.RENDERER_TYPE=Nfe;var ZA=new WeakMap,QA=new WeakMap,Hfe="htBadValue",xs="data-row",Ds="data-col",Lfe="checkboxRenderer",TW="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===TW){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function WE(e,t,r,n,o,i,a){var l=e.rootDocument;If.apply(this,[e,t,r,n,o,i,a]),jfe(e);var s=Ffe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Cn(t),i===a.checkedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Xt(i)?te(s,"noValue"):(s.style.display="none",te(s,Hfe),f=!0),s.setAttribute(xs,r),s.setAttribute(Ds,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=Bfe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),ZA.has(e)||(ZA.set(e,!0),v());function v(){var w=e.getShortcutManager(),C=w.getContext("grid"),S={group:Lfe};C.addShortcuts([{keys:[["space"]],callback:function(){return y(),!m()}},{keys:[["enter"]],callback:function(){return y(),!m()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!m()},relativeToGroup:Ac,position:"before"}],S)}function y(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=e.getSelectedRange();if(C)for(var S=0;S<C.length;S++){for(var R=C[S].getTopStartCorner(),O=R.row,j=R.col,U=C[S].getBottomEndCorner(),q=U.row,G=U.col,X=[],Q=O;Q<=q;Q+=1)for(var oe=j;oe<=G;oe+=1){var J=e.getCellMeta(Q,oe);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var ue=e.getDataAtCell(Q,oe);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ue)?X.push([Q,oe,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ue)&&X.push([Q,oe,J.checkedTemplate]):X.push([Q,oe,J.uncheckedTemplate])}}X.length>0&&e.setDataAtCell(X)}}function m(){var w=e.getSelectedRange();if(w){for(var C=0;C<w.length;C++)for(var S=w[C].getTopStartCorner(),R=w[C].getBottomEndCorner(),O=S.row;O<=R.row;O++)for(var j=S.col;j<=R.col;j++){var U=e.getCellMeta(O,j);if(U.type!=="checkbox")return!1;var q=e.getCell(O,j);if(q==null)return!0;var G=q.querySelectorAll("input[type=checkbox]");if(G.length>0&&!U.readOnly)return!0}return!1}}}WE.RENDERER_TYPE=TW;function jfe(e){var t=QA.get(e);if(!t){var r=e.rootElement;t=new Pt(e),t.addEventListener(r,"click",function(n){return Wfe(n,e)}),t.addEventListener(r,"mouseup",function(n){return Vfe(n,e)}),t.addEventListener(r,"change",function(n){return Ufe(n,e)}),QA.set(e,t)}return t}function Ffe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function Bfe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function Vfe(e,t){var r=e.target;UE(r)&&(!r.hasAttribute(xs)||!r.hasAttribute(Ds)||setTimeout(t.listen,10))}function Wfe(e,t){var r=e.target;if(UE(r)&&!(!r.hasAttribute(xs)||!r.hasAttribute(Ds))){var n=parseInt(r.getAttribute(xs),10),o=parseInt(r.getAttribute(Ds),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function Ufe(e,t){var r=e.target;if(UE(r)&&!(!r.hasAttribute(xs)||!r.hasAttribute(Ds))){var n=parseInt(r.getAttribute(xs),10),o=parseInt(r.getAttribute(Ds),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function UE(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function dy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var PW={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof dy=="function"&&dy;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof dy=="function"&&dy,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function C(G){var X=0|G;return 0<G||G===X?X:X-1}function S(G){for(var X,Q,oe=1,J=G.length,ue=G[0]+"";oe<J;){for(X=G[oe++]+"",Q=d-X.length;Q--;X="0"+X);ue+=X}for(J=ue.length;ue.charCodeAt(--J)===48;);return ue.slice(0,J+1||1)}function R(G,X){var Q,oe,J=G.c,ue=X.c,he=G.s,Oe=X.s,we=G.e,$=X.e;if(!he||!Oe)return null;if(Q=J&&!J[0],oe=ue&&!ue[0],Q||oe)return Q?oe?0:-Oe:he;if(he!=Oe)return he;if(Q=he<0,oe=we==$,!J||!ue)return oe?0:!J^Q?1:-1;if(!oe)return $<we^Q?1:-1;for(Oe=(we=J.length)<($=ue.length)?we:$,he=0;he<Oe;he++)if(J[he]!=ue[he])return J[he]>ue[he]^Q?1:-1;return we==$?0:$<we^Q?1:-1}function O(G,X,Q,oe){if(G<X||Q<G||G!==(G<0?s(G):u(G)))throw Error(f+(oe||"Argument")+(typeof G=="number"?G<X||Q<G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(G))}function j(G){var X=G.c.length-1;return C(G.e/d)==X&&G.c[X]%2!=0}function U(G,X){return(1<G.length?G.charAt(0)+"."+G.slice(1):G)+(X<0?"e":"e+")+X}function q(G,X,Q){var oe,J;if(X<0){for(J=Q+".";++X;J+=Q);G=J+G}else if(++X>(oe=G.length)){for(J=Q,X-=oe;--X;J+=Q);G+=J}else X<oe&&(G=G.slice(0,X)+"."+G.slice(X));return G}(a=function G(X){var Q,oe,J,ue,he,Oe,we,$,k,g,p=z.prototype={constructor:z,toString:null,valueOf:null},b=new z(1),T=20,E=4,B=-7,x=21,K=-1e7,Z=1e7,re=!1,ie=1,se=0,_e={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Se="0123456789abcdefghijklmnopqrstuvwxyz";function z(_,P){var I,F,M,V,N,D,W,L,Y=this;if(!(Y instanceof z))return new z(_,P);if(P==null){if(_ instanceof z)return Y.s=_.s,Y.e=_.e,void(Y.c=(_=_.c)?_.slice():_);if((D=typeof _=="number")&&0*_==0){if(Y.s=1/_<0?(_=-_,-1):1,_===~~_){for(V=0,N=_;10<=N;N/=10,V++);return Y.e=V,void(Y.c=[_])}L=String(_)}else{if(L=String(_),!l.test(L))return J(Y,L,D);Y.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(V=L.indexOf("."))&&(L=L.replace(".","")),0<(N=L.search(/e/i))?(V<0&&(V=N),V+=+L.slice(N+1),L=L.substring(0,N)):V<0&&(V=L.length)}else{if(O(P,2,Se.length,"Base"),L=String(_),P==10)return Ie(Y=new z(_ instanceof z?_:L),T+Y.e+1,E);if(D=typeof _=="number"){if(0*_!=0)return J(Y,L,D,P);if(Y.s=1/_<0?(L=L.slice(1),-1):1,z.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(c+_);D=!1}else Y.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(I=Se.slice(0,P),V=N=0,W=L.length;N<W;N++)if(I.indexOf(F=L.charAt(N))<0){if(F=="."){if(V<N){V=W;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,N=-1,V=0;continue}return J(Y,String(_),D,P)}-1<(V=(L=oe(L,P,10,Y.s)).indexOf("."))?L=L.replace(".",""):V=L.length}for(N=0;L.charCodeAt(N)===48;N++);for(W=L.length;L.charCodeAt(--W)===48;);if(L=L.slice(N,++W)){if(W-=N,D&&z.DEBUG&&15<W&&(v<_||_!==u(_)))throw Error(c+Y.s*_);if(Z<(V=V-N-1))Y.c=Y.e=null;else if(V<K)Y.c=[Y.e=0];else{if(Y.e=V,Y.c=[],N=(V+1)%d,V<0&&(N+=d),N<W){for(N&&Y.c.push(+L.slice(0,N)),W-=d;N<W;)Y.c.push(+L.slice(N,N+=d));L=L.slice(N),N=d-L.length}else N-=W;for(;N--;L+="0");Y.c.push(+L)}}else Y.c=[Y.e=0]}function Ne(_,P,I,F){var M,V,N,D,W;if(I==null?I=E:O(I,0,8),!_.c)return _.toString();if(M=_.c[0],N=_.e,P==null)W=S(_.c),W=F==1||F==2&&(N<=B||x<=N)?U(W,N):q(W,N,"0");else if(V=(_=Ie(new z(_),P,I)).e,D=(W=S(_.c)).length,F==1||F==2&&(P<=V||V<=B)){for(;D<P;W+="0",D++);W=U(W,V)}else if(P-=N,W=q(W,V,"0"),D<V+1){if(0<--P)for(W+=".";P--;W+="0");}else if(0<(P+=V-D))for(V+1==D&&(W+=".");P--;W+="0");return _.s<0&&M?"-"+W:W}function Be(_,P){for(var I,F=1,M=new z(_[0]);F<_.length;F++){if(!(I=new z(_[F])).s){M=I;break}P.call(M,I)&&(M=I)}return M}function ke(_,P,I){for(var F=1,M=P.length;!P[--M];P.pop());for(M=P[0];10<=M;M/=10,F++);return(I=F+I*d-1)>Z?_.c=_.e=null:_.c=I<K?[_.e=0]:(_.e=I,P),_}function Ie(_,P,I,F){var M,V,N,D,W,L,Y,le=_.c,pe=y;if(le){e:{for(M=1,D=le[0];10<=D;D/=10,M++);if((V=P-M)<0)V+=d,N=P,Y=(W=le[L=0])/pe[M-N-1]%10|0;else if((L=s((V+1)/d))>=le.length){if(!F)break e;for(;le.length<=L;le.push(0));W=Y=0,N=(V%=d)-d+(M=1)}else{for(W=D=le[L],M=1;10<=D;D/=10,M++);Y=(N=(V%=d)-d+M)<0?0:W/pe[M-N-1]%10|0}if(F=F||P<0||le[L+1]!=null||(N<0?W:W%pe[M-N-1]),F=I<4?(Y||F)&&(I==0||I==(_.s<0?3:2)):5<Y||Y==5&&(I==4||F||I==6&&(0<V?0<N?W/pe[M-N]:0:le[L-1])%10&1||I==(_.s<0?8:7)),P<1||!le[0])return le.length=0,F?(P-=_.e+1,le[0]=pe[(d-P%d)%d],_.e=-P||0):le[0]=_.e=0,_;if(V==0?(le.length=L,D=1,L--):(le.length=L+1,D=pe[d-V],le[L]=0<N?u(W/pe[M-N]%pe[N])*D:0),F)for(;;){if(L==0){for(V=1,N=le[0];10<=N;N/=10,V++);for(N=le[0]+=D,D=1;10<=N;N/=10,D++);V!=D&&(_.e++,le[0]==h&&(le[0]=1));break}if(le[L]+=D,le[L]!=h)break;le[L--]=0,D=1}for(V=le.length;le[--V]===0;le.pop());}_.e>Z?_.c=_.e=null:_.e<K&&(_.c=[_.e=0])}return _}function Ae(_){var P,I=_.e;return I===null?_.toString():(P=S(_.c),P=I<=B||x<=I?U(P,I):q(P,I,"0"),_.s<0?"-"+P:P)}return z.clone=G,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(_){var P,I;if(_!=null){if(typeof _!="object")throw Error(f+"Object expected: "+_);if(_.hasOwnProperty(P="DECIMAL_PLACES")&&(O(I=_[P],0,w,P),T=I),_.hasOwnProperty(P="ROUNDING_MODE")&&(O(I=_[P],0,8,P),E=I),_.hasOwnProperty(P="EXPONENTIAL_AT")&&((I=_[P])&&I.pop?(O(I[0],-w,0,P),O(I[1],0,w,P),B=I[0],x=I[1]):(O(I,-w,w,P),B=-(x=I<0?-I:I))),_.hasOwnProperty(P="RANGE"))if((I=_[P])&&I.pop)O(I[0],-w,-1,P),O(I[1],1,w,P),K=I[0],Z=I[1];else{if(O(I,-w,w,P),!I)throw Error(f+P+" cannot be zero: "+I);K=-(Z=I<0?-I:I)}if(_.hasOwnProperty(P="CRYPTO")){if((I=_[P])!==!!I)throw Error(f+P+" not true or false: "+I);if(I){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!I,Error(f+"crypto unavailable");re=I}else re=I}if(_.hasOwnProperty(P="MODULO_MODE")&&(O(I=_[P],0,9,P),ie=I),_.hasOwnProperty(P="POW_PRECISION")&&(O(I=_[P],0,w,P),se=I),_.hasOwnProperty(P="FORMAT")){if(typeof(I=_[P])!="object")throw Error(f+P+" not an object: "+I);_e=I}if(_.hasOwnProperty(P="ALPHABET")){if(typeof(I=_[P])!="string"||/^.$|[+-.\s]|(.).*\1/.test(I))throw Error(f+P+" invalid: "+I);Se=I}}return{DECIMAL_PLACES:T,ROUNDING_MODE:E,EXPONENTIAL_AT:[B,x],RANGE:[K,Z],CRYPTO:re,MODULO_MODE:ie,POW_PRECISION:se,FORMAT:_e,ALPHABET:Se}},z.isBigNumber=function(_){return _ instanceof z||_&&_._isBigNumber===!0||!1},z.maximum=z.max=function(){return Be(arguments,p.lt)},z.minimum=z.min=function(){return Be(arguments,p.gt)},z.random=(ue=9007199254740992,he=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(_){var P,I,F,M,V,N=0,D=[],W=new z(b);if(_==null?_=T:O(_,0,w),M=s(_/d),re)if(crypto.getRandomValues){for(P=crypto.getRandomValues(new Uint32Array(M*=2));N<M;)9e15<=(V=131072*P[N]+(P[N+1]>>>11))?(I=crypto.getRandomValues(new Uint32Array(2)),P[N]=I[0],P[N+1]=I[1]):(D.push(V%1e14),N+=2);N=M/2}else{if(!crypto.randomBytes)throw re=!1,Error(f+"crypto unavailable");for(P=crypto.randomBytes(M*=7);N<M;)9e15<=(V=281474976710656*(31&P[N])+1099511627776*P[N+1]+4294967296*P[N+2]+16777216*P[N+3]+(P[N+4]<<16)+(P[N+5]<<8)+P[N+6])?crypto.randomBytes(7).copy(P,N):(D.push(V%1e14),N+=7);N=M/7}if(!re)for(;N<M;)(V=he())<9e15&&(D[N++]=V%1e14);for(M=D[--N],_%=d,M&&_&&(V=y[d-_],D[N]=u(M/V)*V);D[N]===0;D.pop(),N--);if(N<0)D=[F=0];else{for(F=-1;D[0]===0;D.splice(0,1),F-=d);for(N=1,V=D[0];10<=V;V/=10,N++);N<d&&(F-=d-N)}return W.e=F,W.c=D,W}),z.sum=function(){for(var _=1,P=arguments,I=new z(P[0]);_<P.length;)I=I.plus(P[_++]);return I},oe=function(){var _="0123456789";function P(I,F,M,V){for(var N,D,W=[0],L=0,Y=I.length;L<Y;){for(D=W.length;D--;W[D]*=F);for(W[0]+=V.indexOf(I.charAt(L++)),N=0;N<W.length;N++)W[N]>M-1&&(W[N+1]==null&&(W[N+1]=0),W[N+1]+=W[N]/M|0,W[N]%=M)}return W.reverse()}return function(I,F,M,V,N){var D,W,L,Y,le,pe,Re,He,Ze=I.indexOf("."),st=T,Ge=E;for(0<=Ze&&(Y=se,se=0,I=I.replace(".",""),pe=(He=new z(F)).pow(I.length-Ze),se=Y,He.c=P(q(S(pe.c),pe.e,"0"),10,M,_),He.e=He.c.length),L=Y=(Re=P(I,F,M,N?(D=Se,_):(D=_,Se))).length;Re[--Y]==0;Re.pop());if(!Re[0])return D.charAt(0);if(Ze<0?--L:(pe.c=Re,pe.e=L,pe.s=V,Re=(pe=Q(pe,He,st,Ge,M)).c,le=pe.r,L=pe.e),Ze=Re[W=L+st+1],Y=M/2,le=le||W<0||Re[W+1]!=null,le=Ge<4?(Ze!=null||le)&&(Ge==0||Ge==(pe.s<0?3:2)):Y<Ze||Ze==Y&&(Ge==4||le||Ge==6&&1&Re[W-1]||Ge==(pe.s<0?8:7)),W<1||!Re[0])I=le?q(D.charAt(1),-st,D.charAt(0)):D.charAt(0);else{if(Re.length=W,le)for(--M;++Re[--W]>M;)Re[W]=0,W||(++L,Re=[1].concat(Re));for(Y=Re.length;!Re[--Y];);for(Ze=0,I="";Ze<=Y;I+=D.charAt(Re[Ze++]));I=q(I,L,D.charAt(0))}return I}}(),Q=function(){function _(F,M,V){var N,D,W,L,Y=0,le=F.length,pe=M%m,Re=M/m|0;for(F=F.slice();le--;)Y=((D=pe*(W=F[le]%m)+(N=Re*W+(L=F[le]/m|0)*pe)%m*m+Y)/V|0)+(N/m|0)+Re*L,F[le]=D%V;return Y&&(F=[Y].concat(F)),F}function P(F,M,V,N){var D,W;if(V!=N)W=N<V?1:-1;else for(D=W=0;D<V;D++)if(F[D]!=M[D]){W=F[D]>M[D]?1:-1;break}return W}function I(F,M,V,N){for(var D=0;V--;)F[V]-=D,D=F[V]<M[V]?1:0,F[V]=D*N+F[V]-M[V];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,M,V,N,D){var W,L,Y,le,pe,Re,He,Ze,st,Ge,Me,De,dr,Bt,Ve,Je,St,ut=F.s==M.s?1:-1,ft=F.c,et=M.c;if(!(ft&&ft[0]&&et&&et[0]))return new z(F.s&&M.s&&(ft?!et||ft[0]!=et[0]:et)?ft&&ft[0]==0||!et?0*ut:ut/0:NaN);for(st=(Ze=new z(ut)).c=[],ut=V+(L=F.e-M.e)+1,D||(D=h,L=C(F.e/d)-C(M.e/d),ut=ut/d|0),Y=0;et[Y]==(ft[Y]||0);Y++);if(et[Y]>(ft[Y]||0)&&L--,ut<0)st.push(1),le=!0;else{for(Bt=ft.length,Je=et.length,ut+=2,1<(pe=u(D/(et[Y=0]+1)))&&(et=_(et,pe,D),ft=_(ft,pe,D),Je=et.length,Bt=ft.length),dr=Je,Me=(Ge=ft.slice(0,Je)).length;Me<Je;Ge[Me++]=0);St=et.slice(),St=[0].concat(St),Ve=et[0],et[1]>=D/2&&Ve++;do{if(pe=0,(W=P(et,Ge,Je,Me))<0){if(De=Ge[0],Je!=Me&&(De=De*D+(Ge[1]||0)),1<(pe=u(De/Ve)))for(D<=pe&&(pe=D-1),He=(Re=_(et,pe,D)).length,Me=Ge.length;P(Re,Ge,He,Me)==1;)pe--,I(Re,Je<He?St:et,He,D),He=Re.length,W=1;else pe==0&&(W=pe=1),He=(Re=et.slice()).length;if(He<Me&&(Re=[0].concat(Re)),I(Ge,Re,Me,D),Me=Ge.length,W==-1)for(;P(et,Ge,Je,Me)<1;)pe++,I(Ge,Je<Me?St:et,Me,D),Me=Ge.length}else W===0&&(pe++,Ge=[0]);st[Y++]=pe,Ge[0]?Ge[Me++]=ft[dr]||0:(Ge=[ft[dr]],Me=1)}while((dr++<Bt||Ge[0]!=null)&&ut--);le=Ge[0]!=null,st[0]||st.splice(0,1)}if(D==h){for(Y=1,ut=st[0];10<=ut;ut/=10,Y++);Ie(Ze,V+(Ze.e=Y+L*d-1)+1,N,le)}else Ze.e=L,Ze.r=+le;return Ze}}(),Oe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,we=/^([^.]+)\.$/,$=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(_,P,I,F){var M,V=I?P:P.replace(g,"");if(k.test(V))_.s=isNaN(V)?null:V<0?-1:1,_.c=_.e=null;else{if(!I&&(V=V.replace(Oe,function(N,D,W){return M=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,F&&F!=M?N:D}),F&&(M=F,V=V.replace(we,"$1").replace($,"0.$1")),P!=V))return new z(V,M);if(z.DEBUG)throw Error(f+"Not a"+(F?" base "+F:"")+" number: "+P);_.c=_.e=_.s=null}},p.absoluteValue=p.abs=function(){var _=new z(this);return _.s<0&&(_.s=1),_},p.comparedTo=function(_,P){return R(this,new z(_,P))},p.decimalPlaces=p.dp=function(_,P){var I,F,M;if(_!=null)return O(_,0,w),P==null?P=E:O(P,0,8),Ie(new z(this),_+this.e+1,P);if(!(I=this.c))return null;if(F=((M=I.length-1)-C(this.e/d))*d,M=I[M])for(;M%10==0;M/=10,F--);return F<0&&(F=0),F},p.dividedBy=p.div=function(_,P){return Q(this,new z(_,P),T,E)},p.dividedToIntegerBy=p.idiv=function(_,P){return Q(this,new z(_,P),0,1)},p.exponentiatedBy=p.pow=function(_,P){var I,F,M,V,N,D,W,L,Y=this;if((_=new z(_)).c&&!_.isInteger())throw Error(f+"Exponent not an integer: "+Ae(_));if(P!=null&&(P=new z(P)),N=14<_.e,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!_.c||!_.c[0])return L=new z(Math.pow(+Ae(Y),N?2-j(_):+Ae(_))),P?L.mod(P):L;if(D=_.s<0,P){if(P.c?!P.c[0]:!P.s)return new z(NaN);(F=!D&&Y.isInteger()&&P.isInteger())&&(Y=Y.mod(P))}else{if(9<_.e&&(0<Y.e||Y.e<-1||(Y.e==0?1<Y.c[0]||N&&24e7<=Y.c[1]:Y.c[0]<8e13||N&&Y.c[0]<=9999975e7)))return V=Y.s<0&&j(_)?-0:0,-1<Y.e&&(V=1/V),new z(D?1/V:V);se&&(V=s(se/d+2))}for(W=N?(I=new z(.5),D&&(_.s=1),j(_)):(M=Math.abs(+Ae(_)))%2,L=new z(b);;){if(W){if(!(L=L.times(Y)).c)break;V?L.c.length>V&&(L.c.length=V):F&&(L=L.mod(P))}if(M){if((M=u(M/2))===0)break;W=M%2}else if(Ie(_=_.times(I),_.e+1,1),14<_.e)W=j(_);else{if((M=+Ae(_))==0)break;W=M%2}Y=Y.times(Y),V?Y.c&&Y.c.length>V&&(Y.c.length=V):F&&(Y=Y.mod(P))}return F?L:(D&&(L=b.div(L)),P?L.mod(P):V?Ie(L,se,E,void 0):L)},p.integerValue=function(_){var P=new z(this);return _==null?_=E:O(_,0,8),Ie(P,P.e+1,_)},p.isEqualTo=p.eq=function(_,P){return R(this,new z(_,P))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(_,P){return 0<R(this,new z(_,P))},p.isGreaterThanOrEqualTo=p.gte=function(_,P){return(P=R(this,new z(_,P)))===1||P===0},p.isInteger=function(){return!!this.c&&C(this.e/d)>this.c.length-2},p.isLessThan=p.lt=function(_,P){return R(this,new z(_,P))<0},p.isLessThanOrEqualTo=p.lte=function(_,P){return(P=R(this,new z(_,P)))===-1||P===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(_,P){var I,F,M,V,N=this,D=N.s;if(P=(_=new z(_,P)).s,!D||!P)return new z(NaN);if(D!=P)return _.s=-P,N.plus(_);var W=N.e/d,L=_.e/d,Y=N.c,le=_.c;if(!W||!L){if(!Y||!le)return Y?(_.s=-P,_):new z(le?N:NaN);if(!Y[0]||!le[0])return le[0]?(_.s=-P,_):new z(Y[0]?N:E==3?-0:0)}if(W=C(W),L=C(L),Y=Y.slice(),D=W-L){for((M=(V=D<0)?(D=-D,Y):(L=W,le)).reverse(),P=D;P--;M.push(0));M.reverse()}else for(F=(V=(D=Y.length)<(P=le.length))?D:P,D=P=0;P<F;P++)if(Y[P]!=le[P]){V=Y[P]<le[P];break}if(V&&(M=Y,Y=le,le=M,_.s=-_.s),0<(P=(F=le.length)-(I=Y.length)))for(;P--;Y[I++]=0);for(P=h-1;D<F;){if(Y[--F]<le[F]){for(I=F;I&&!Y[--I];Y[I]=P);--Y[I],Y[F]+=h}Y[F]-=le[F]}for(;Y[0]==0;Y.splice(0,1),--L);return Y[0]?ke(_,Y,L):(_.s=E==3?-1:1,_.c=[_.e=0],_)},p.modulo=p.mod=function(_,P){var I,F,M=this;return _=new z(_,P),!M.c||!_.s||_.c&&!_.c[0]?new z(NaN):!_.c||M.c&&!M.c[0]?new z(M):(ie==9?(F=_.s,_.s=1,I=Q(M,_,0,3),_.s=F,I.s*=F):I=Q(M,_,0,ie),(_=M.minus(I.times(_))).c[0]||ie!=1||(_.s=M.s),_)},p.multipliedBy=p.times=function(_,P){var I,F,M,V,N,D,W,L,Y,le,pe,Re,He,Ze,st,Ge=this,Me=Ge.c,De=(_=new z(_,P)).c;if(!(Me&&De&&Me[0]&&De[0]))return!Ge.s||!_.s||Me&&!Me[0]&&!De||De&&!De[0]&&!Me?_.c=_.e=_.s=null:(_.s*=Ge.s,Me&&De?(_.c=[0],_.e=0):_.c=_.e=null),_;for(F=C(Ge.e/d)+C(_.e/d),_.s*=Ge.s,(W=Me.length)<(le=De.length)&&(He=Me,Me=De,De=He,M=W,W=le,le=M),M=W+le,He=[];M--;He.push(0));for(Ze=h,st=m,M=le;0<=--M;){for(I=0,pe=De[M]%st,Re=De[M]/st|0,V=M+(N=W);M<V;)I=((L=pe*(L=Me[--N]%st)+(D=Re*L+(Y=Me[N]/st|0)*pe)%st*st+He[V]+I)/Ze|0)+(D/st|0)+Re*Y,He[V--]=L%Ze;He[V]=I}return I?++F:He.splice(0,1),ke(_,He,F)},p.negated=function(){var _=new z(this);return _.s=-_.s||null,_},p.plus=function(_,P){var I,F=this,M=F.s;if(P=(_=new z(_,P)).s,!M||!P)return new z(NaN);if(M!=P)return _.s=-P,F.minus(_);var V=F.e/d,N=_.e/d,D=F.c,W=_.c;if(!V||!N){if(!D||!W)return new z(M/0);if(!D[0]||!W[0])return W[0]?_:new z(D[0]?F:0*M)}if(V=C(V),N=C(N),D=D.slice(),M=V-N){for((I=0<M?(N=V,W):(M=-M,D)).reverse();M--;I.push(0));I.reverse()}for((M=D.length)-(P=W.length)<0&&(I=W,W=D,D=I,P=M),M=0;P;)M=(D[--P]=D[P]+W[P]+M)/h|0,D[P]=h===D[P]?0:D[P]%h;return M&&(D=[M].concat(D),++N),ke(_,D,N)},p.precision=p.sd=function(_,P){var I,F,M;if(_!=null&&_!==!!_)return O(_,1,w),P==null?P=E:O(P,0,8),Ie(new z(this),_,P);if(!(I=this.c))return null;if(F=(M=I.length-1)*d+1,M=I[M]){for(;M%10==0;M/=10,F--);for(M=I[0];10<=M;M/=10,F++);}return _&&this.e+1>F&&(F=this.e+1),F},p.shiftedBy=function(_){return O(_,-v,v),this.times("1e"+_)},p.squareRoot=p.sqrt=function(){var _,P,I,F,M,V=this,N=V.c,D=V.s,W=V.e,L=T+4,Y=new z("0.5");if(D!==1||!N||!N[0])return new z(!D||D<0&&(!N||N[0])?NaN:N?V:1/0);if((I=(D=Math.sqrt(+Ae(V)))==0||D==1/0?(((P=S(N)).length+W)%2==0&&(P+="0"),D=Math.sqrt(+P),W=C((W+1)/2)-(W<0||W%2),new z(P=D==1/0?"1e"+W:(P=D.toExponential()).slice(0,P.indexOf("e")+1)+W)):new z(D+"")).c[0]){for((D=(W=I.e)+L)<3&&(D=0);;)if(M=I,I=Y.times(M.plus(Q(V,M,L,1))),S(M.c).slice(0,D)===(P=S(I.c)).slice(0,D)){if(I.e<W&&--D,(P=P.slice(D-3,D+1))!="9999"&&(F||P!="4999")){+P&&(+P.slice(1)||P.charAt(0)!="5")||(Ie(I,I.e+T+2,1),_=!I.times(I).eq(V));break}if(!F&&(Ie(M,M.e+T+2,0),M.times(M).eq(V))){I=M;break}L+=4,D+=4,F=1}}return Ie(I,I.e+T+1,E,_)},p.toExponential=function(_,P){return _!=null&&(O(_,0,w),_++),Ne(this,_,P,1)},p.toFixed=function(_,P){return _!=null&&(O(_,0,w),_=_+this.e+1),Ne(this,_,P)},p.toFormat=function(_,P,I){var F;if(I==null)_!=null&&P&&typeof P=="object"?(I=P,P=null):_&&typeof _=="object"?(I=_,_=P=null):I=_e;else if(typeof I!="object")throw Error(f+"Argument not an object: "+I);if(F=this.toFixed(_,P),this.c){var M,V=F.split("."),N=+I.groupSize,D=+I.secondaryGroupSize,W=I.groupSeparator||"",L=V[0],Y=V[1],le=this.s<0,pe=le?L.slice(1):L,Re=pe.length;if(D&&(M=N,N=D,Re-=D=M),0<N&&0<Re){for(M=Re%N||N,L=pe.substr(0,M);M<Re;M+=N)L+=W+pe.substr(M,N);0<D&&(L+=W+pe.slice(M)),le&&(L="-"+L)}F=Y?L+(I.decimalSeparator||"")+((D=+I.fractionGroupSize)?Y.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):Y):L}return(I.prefix||"")+F+(I.suffix||"")},p.toFraction=function(_){var P,I,F,M,V,N,D,W,L,Y,le,pe,Re=this,He=Re.c;if(_!=null&&(!(D=new z(_)).isInteger()&&(D.c||D.s!==1)||D.lt(b)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Ae(D));if(!He)return new z(Re);for(P=new z(b),L=I=new z(b),F=W=new z(b),pe=S(He),V=P.e=pe.length-Re.e-1,P.c[0]=y[(N=V%d)<0?d+N:N],_=!_||0<D.comparedTo(P)?0<V?P:L:D,N=Z,Z=1/0,D=new z(pe),W.c[0]=0;Y=Q(D,P,0,1),(M=I.plus(Y.times(F))).comparedTo(_)!=1;)I=F,F=M,L=W.plus(Y.times(M=L)),W=M,P=D.minus(Y.times(M=P)),D=M;return M=Q(_.minus(I),F,0,1),W=W.plus(M.times(L)),I=I.plus(M.times(F)),W.s=L.s=Re.s,le=Q(L,F,V*=2,E).minus(Re).abs().comparedTo(Q(W,I,V,E).minus(Re).abs())<1?[L,F]:[W,I],Z=N,le},p.toNumber=function(){return+Ae(this)},p.toPrecision=function(_,P){return _!=null&&O(_,1,w),Ne(this,_,P,2)},p.toString=function(_){var P,I=this,F=I.s,M=I.e;return M===null?F?(P="Infinity",F<0&&(P="-"+P)):P="NaN":(P=_==null?M<=B||x<=M?U(S(I.c),M):q(S(I.c),M,"0"):_===10?q(S((I=Ie(new z(I),T+M+1,E)).c),I.e,"0"):(O(_,2,Se.length,"Base"),oe(q(S(I.c),M,"0"),10,_,F,!0)),F<0&&I.c[0]&&(P="-"+P)),P},p.valueOf=p.toJSON=function(){return Ae(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),X!=null&&z.set(X),z}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(C,S){return function(R){if(Array.isArray(R))return R}(C)||function(R,O){var j=[],U=!0,q=!1,G=void 0;try{for(var X,Q=R[Symbol.iterator]();!(U=(X=Q.next()).done)&&(j.push(X.value),!O||j.length!==O);U=!0);}catch(oe){q=!0,G=oe}finally{try{U||Q.return==null||Q.return()}finally{if(q)throw G}}return j}(C,S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},R=2<arguments.length?arguments[2]:void 0;if(typeof S=="string"&&(S=s.parseFormat(S)),!l.validateFormat(S))return"ERROR: invalid format";var O=S.prefix||"",j=S.postfix||"",U=function(q,G,X){switch(G.output){case"currency":return G=w(G,a.currentCurrencyDefaultFormat()),function(Se,z,Ne){var Be=Ne.currentCurrency(),ke=Object.assign({},c,z),Ie=void 0,Ae="",_=!!ke.totalLength||!!ke.forceAverage||ke.average,P=z.currencyPosition||Be.position,I=z.currencySymbol||Be.symbol;ke.spaceSeparated&&(Ae=" "),P==="infix"&&(Ie=Ae+I+Ae);var F=m({instance:Se,providedFormat:z,state:Ne,decimalSeparator:Ie});return P==="prefix"&&(F=Se._value<0&&ke.negative==="sign"?"-".concat(Ae).concat(I).concat(F.slice(1)):I+Ae+F),P&&P!=="postfix"||(F=F+(Ae=_?"":Ae)+I),F}(q,G,a);case"percent":return G=w(G,a.currentPercentageDefaultFormat()),function(Se,z,Ne,Be){var ke=z.prefixSymbol,Ie=m({instance:Be(100*Se._value),providedFormat:z,state:Ne}),Ae=Object.assign({},c,z);return ke?"%".concat(Ae.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Ae.spaceSeparated?" ":"","%")}(q,G,a,X);case"byte":return G=w(G,a.currentByteDefaultFormat()),b=q,E=a,B=X,x=(T=G).base||"binary",K=f[x],Z=d(b._value,K.suffixes,K.scale),re=Z.value,ie=Z.suffix,se=m({instance:B(re),providedFormat:T,state:E,defaults:E.currentByteDefaultFormat()}),_e=E.currentAbbreviations(),"".concat(se).concat(_e.spaced?" ":"").concat(ie);case"time":return G=w(G,a.currentTimeDefaultFormat()),$=q,k=Math.floor($._value/60/60),g=Math.floor(($._value-60*k*60)/60),p=Math.round($._value-60*k*60-60*g),"".concat(k,":").concat(g<10?"0":"").concat(g,":").concat(p<10?"0":"").concat(p);case"ordinal":return G=w(G,a.currentOrdinalDefaultFormat()),Q=q,oe=G,ue=(J=a).currentOrdinal(),he=Object.assign({},c,oe),Oe=m({instance:Q,providedFormat:oe,state:J}),we=ue(Q._value),"".concat(Oe).concat(he.spaceSeparated?" ":"").concat(we);case"number":default:return m({instance:q,providedFormat:G,numbro:X})}var Q,oe,J,ue,he,Oe,we,$,k,g,p,b,T,E,B,x,K,Z,re,ie,se,_e}(C,S,R);return U=(U=O+U)+j}function d(C,S,R){var O=S[0],j=Math.abs(C);if(R<=j){for(var U=1;U<S.length;++U){var q=Math.pow(R,U),G=Math.pow(R,U+1);if(q<=j&&j<G){O=S[U],C/=q;break}}O===S[0]&&(C/=Math.pow(R,S.length-1),O=S[S.length-1])}return{value:C,suffix:O}}function v(C){for(var S="",R=0;R<C;R++)S+="0";return S}function y(C,S){return C.toString().indexOf("e")!==-1?function(R,O){var j=R.toString(),U=i(j.split("e"),2),q=U[0],G=U[1],X=i(q.split("."),2),Q=X[0],oe=X[1],J=oe===void 0?"":oe;if(0<+G)j=Q+J+v(G-J.length);else{var ue=".";ue=+Q<0?"-0".concat(ue):"0".concat(ue);var he=(v(-G-1)+Math.abs(Q)+J).substr(0,O);he.length<O&&(he+=v(O-he.length)),j=ue+he}return 0<+G&&0<O&&(j+=".".concat(v(O))),j}(C,S):(Math.round(+"".concat(C,"e+").concat(S))/Math.pow(10,S)).toFixed(S)}function m(C){var S=C.instance,R=C.providedFormat,O=C.state,j=O===void 0?a:O,U=C.decimalSeparator,q=C.defaults,G=q===void 0?j.currentDefaults():q,X=S._value;if(X===0&&j.hasZeroFormat())return j.getZeroFormat();if(!isFinite(X))return X.toString();var Q,oe,J,ue,he,Oe,we,$,k=Object.assign({},c,G,R),g=k.totalLength,p=g?0:k.characteristic,b=k.optionalCharacteristic,T=k.forceAverage,E=!!g||!!T||k.average,B=g?-1:E&&R.mantissa===void 0?0:k.mantissa,x=!g&&(R.optionalMantissa===void 0?B===-1:k.optionalMantissa),K=k.trimMantissa,Z=k.thousandSeparated,re=k.spaceSeparated,ie=k.negative,se=k.forceSign,_e=k.exponential,Se="";if(E){var z=function(_){var P=_.value,I=_.forceAverage,F=_.abbreviations,M=_.spaceSeparated,V=M!==void 0&&M,N=_.totalLength,D=N===void 0?0:N,W="",L=Math.abs(P),Y=-1;if(L>=Math.pow(10,12)&&!I||I==="trillion"?(W=F.trillion,P/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!I||I==="billion"?(W=F.billion,P/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!I||I==="million"?(W=F.million,P/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!I||I==="thousand")&&(W=F.thousand,P/=Math.pow(10,3)),W&&(W=(V?" ":"")+W),D){var le=P.toString().split(".")[0];Y=Math.max(D-le.length,0)}return{value:P,abbreviation:W,mantissaPrecision:Y}}({value:X,forceAverage:T,abbreviations:j.currentAbbreviations(),spaceSeparated:re,totalLength:g});X=z.value,Se+=z.abbreviation,g&&(B=z.mantissaPrecision)}if(_e){var Ne=(oe=(Q={value:X,characteristicPrecision:p}).value,J=Q.characteristicPrecision,ue=J===void 0?0:J,he=i(oe.toExponential().split("e"),2),Oe=he[0],we=he[1],$=+Oe,ue&&1<ue&&($*=Math.pow(10,ue-1),we=0<=(we=+we-(ue-1))?"+".concat(we):we),{value:$,abbreviation:"e".concat(we)});X=Ne.value,Se=Ne.abbreviation+Se}var Be,ke,Ie,Ae=function(_,P,I,F,M){if(F===-1)return _;var V=y(P,F),N=i(V.toString().split("."),2),D=N[0],W=N[1],L=W===void 0?"":W;if(L.match(/^0+$/)&&(I||M))return D;var Y=L.match(/0+$/);return M&&Y?"".concat(D,".").concat(L.toString().slice(0,Y.index)):V.toString()}(X.toString(),X,x,B,K);return Ae=function(_,P,I,F,M){var V=F.currentDelimiters(),N=V.thousands;M=M||V.decimal;var D=V.thousandsSize||3,W=_.toString(),L=W.split(".")[0],Y=W.split(".")[1];return I&&(P<0&&(L=L.slice(1)),function(le,pe){for(var Re=[],He=0,Ze=le;0<Ze;Ze--)He===pe&&(Re.unshift(Ze),He=0),He++;return Re}(L.length,D).forEach(function(le,pe){L=L.slice(0,le+pe)+N+L.slice(le+pe)}),P<0&&(L="-".concat(L))),W=Y?L+M+Y:L}(Ae=function(_,P,I,F){var M=_,V=i(M.toString().split("."),2),N=V[0],D=V[1];if(N.match(/^-?0$/)&&I)return D?"".concat(N.replace("0",""),".").concat(D):N.replace("0","");if(N.length<F)for(var W=F-N.length,L=0;L<W;L++)M="0".concat(M);return M.toString()}(Ae,0,b,p),X,Z,j,U),(E||_e)&&(Ae=Ae+Se),(se||X<0)&&(Be=Ae,Ie=ie,Ae=(ke=X)===0?Be:+Be==0?Be.replace("-",""):0<ke?"+".concat(Be):Ie==="sign"?Be:"(".concat(Be.replace("-",""),")")),Ae}function w(C,S){if(!C)return S;var R=Object.keys(C);return R.length===1&&R[0]==="output"?S:C}n.exports=function(C){return{format:function(){for(var S=arguments.length,R=new Array(S),O=0;O<S;O++)R[O]=arguments[O];return h.apply(void 0,R.concat([C]))},getByteUnit:function(){for(var S=arguments.length,R=new Array(S),O=0;O<S;O++)R[O]=arguments[O];return function(j){var U=f.general;return d(j._value,U.suffixes,U.scale).suffix}.apply(void 0,R.concat([C]))},getBinaryByteUnit:function(){for(var S=arguments.length,R=new Array(S),O=0;O<S;O++)R[O]=arguments[O];return function(j){var U=f.binary;return d(j._value,U.suffixes,U.scale).suffix}.apply(void 0,R.concat([C]))},getDecimalByteUnit:function(){for(var S=arguments.length,R=new Array(S),O=0;O<S;O++)R[O]=arguments[O];return function(j){var U=f.decimal;return d(j._value,U.suffixes,U.scale).suffix}.apply(void 0,R.concat([C]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(y){u=y}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(y){y=l.parseFormat(y),a.validateFormat(y)&&(h=y)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(y){return c=typeof y=="string"?y:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(y){if(y){if(f[y])return f[y];throw new Error('Unknown tag "'.concat(y,'"'))}return v()},s.registerLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(y))throw new Error("Invalid language data");f[y.languageTag]=y,m&&d(y.languageTag)},s.setLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[y]){var w=y.split("-")[0],C=Object.keys(f).find(function(S){return S.split("-")[0]===w});return f[C]?void d(C):void d(m)}d(y)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(m,w){for(var C=0;C<w.length;C++){var S=w[C];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(m,S.key,S)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(y),u=r("./unformatting"),f=r("./formatting")(y),c=r("./manipulating")(y),h=r("./parsing"),d=function(){function m(S){(function(R,O){if(!(R instanceof O))throw new TypeError("Cannot call a class as a function")})(this,m),this._value=S}var w,C;return w=m,(C=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,S)}},{key:"formatCurrency",value:function(S){return typeof S=="string"&&(S=h.parseFormat(S)),(S=f.formatOrDefault(S,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,S)}},{key:"formatTime",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return S.output="time",f.format(this,S)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(S){return c.difference(this,S)}},{key:"add",value:function(S){return c.add(this,S)}},{key:"subtract",value:function(S){return c.subtract(this,S)}},{key:"multiply",value:function(S){return c.multiply(this,S)}},{key:"divide",value:function(S){return c.divide(this,S)}},{key:"set",value:function(S){return c.set(this,v(S))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,C),m}();function v(m){var w=m;return y.isNumbro(m)?w=m._value:typeof m=="string"?w=y.unformat(m):isNaN(m)&&(w=NaN),w}function y(m){return new d(v(m))}y.version="2.1.2",y.isNumbro=function(m){return m instanceof d},y.language=a.currentLanguage,y.registerLanguage=a.registerLanguage,y.setLanguage=a.setLanguage,y.languages=a.languages,y.languageData=a.languageData,y.zeroFormat=a.setZeroFormat,y.defaultFormat=a.currentDefaults,y.setDefaults=a.setDefaults,y.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=s.loadLanguagesInNode,y.unformat=u.unformat,n.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,y,m,w,C,S,R,O,j,U,q,G,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=X,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=X,function(Q,oe){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):Q.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):Q.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,X),h=X,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=X,(y=i.split(".")[0].match(/0+/))&&(v.characteristic=y[0].length),function(Q,oe){if(Q.indexOf(".")!==-1){var J=Q.split(".")[0];oe.optionalCharacteristic=J.indexOf("0")===-1}}(i,X),m=X,i.indexOf("a")!==-1&&(m.average=!0),C=X,(w=i).indexOf("K")!==-1?C.forceAverage="thousand":w.indexOf("M")!==-1?C.forceAverage="million":w.indexOf("B")!==-1?C.forceAverage="billion":w.indexOf("T")!==-1&&(C.forceAverage="trillion"),function(Q,oe){var J=Q.split(".")[1];if(J){var ue=J.match(/0+/);ue&&(oe.mantissa=ue[0].length)}}(i,X),R=X,(S=i).match(/\[\.]/)?R.optionalMantissa=!0:S.match(/\./)&&(R.optionalMantissa=!1),O=X,i.indexOf(",")!==-1&&(O.thousandSeparated=!0),j=X,i.indexOf(" ")!==-1&&(j.spaceSeparated=!0),q=X,(U=i).match(/^\+?\([^)]*\)$/)&&(q.negative="parenthesis"),U.match(/^\+?-/)&&(q.negative="sign"),G=X,i.match(/^\+/)&&(G.forceSign=!0),X)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function y(m,w){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=3<arguments.length?arguments[3]:void 0,R=4<arguments.length?arguments[4]:void 0,O=5<arguments.length?arguments[5]:void 0,j=6<arguments.length?arguments[6]:void 0;if(!isNaN(+m))return+m;var U="",q=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(q!==m)return-1*y(q,w,C,S,R,O,j);for(var G=0;G<i.length;G++){var X=i[G];if((U=m.replace(X.key,""))!==m)return y(U,w,C,S,R,O,j)*X.factor}if((U=m.replace("%",""))!==m)return y(U,w,C,S,R,O,j)/100;var Q=parseFloat(m);if(!isNaN(Q)){var oe=S(Q);if(oe&&oe!=="."&&(U=m.replace(new RegExp("".concat(a(oe),"$")),""))!==m)return y(U,w,C,S,R,O,j);var J={};Object.keys(O).forEach(function(g){J[O[g]]=g});for(var ue=Object.keys(J).sort().reverse(),he=ue.length,Oe=0;Oe<he;Oe++){var we=ue[Oe],$=J[we];if((U=m.replace(we,""))!==m){var k=void 0;switch($){case"thousand":k=Math.pow(10,3);break;case"million":k=Math.pow(10,6);break;case"billion":k=Math.pow(10,9);break;case"trillion":k=Math.pow(10,12)}return y(U,w,C,S,R,O,j)*k}}}}(function(y,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=y.replace(w,"");return C=(C=C.replace(new RegExp("([0-9])".concat(a(m.thousands),"([0-9])"),"g"),"$1$2")).replace(m.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),y=d.currentCurrency().symbol,m=d.currentOrdinal(),w=d.getZeroFormat(),C=d.currentAbbreviations(),S=void 0;if(typeof s=="string")S=function(R,O){if(!R.indexOf(":")||O.thousands===":")return!1;var j=R.split(":");if(j.length!==3)return!1;var U=+j[0],q=+j[1],G=+j[2];return!isNaN(U)&&!isNaN(q)&&!isNaN(G)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,y,m,w,C,u);else{if(typeof s!="number")return;S=s}if(S!==void 0)return S}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(y){if(Array.isArray(y)){for(var m=0,w=new Array(y.length);m<y.length;m++)w[m]=y[m];return w}}(v)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,y,m){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],C=Object.keys(v).map(function(S){if(!y[S])return console.error("".concat(m," Invalid key: ").concat(S)),!1;var R=v[S],O=y[S];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!h(R,u,"[Validate ".concat(S,"]"),!0))return!1}else if(a(R)!==O.type)return console.error("".concat(m," ").concat(S,' type mismatched: "').concat(O.type,'" expected, "').concat(a(R),'" provided')),!1;if(O.restrictions&&O.restrictions.length)for(var j=O.restrictions.length,U=0;U<j;U++){var q=O.restrictions[U],G=q.restriction,X=q.message;if(!G(R,v))return console.error("".concat(m," ").concat(S," invalid value: ").concat(X)),!1}return O.restriction&&!O.restriction(R,v)?(console.error("".concat(m," ").concat(S," invalid value: ").concat(O.message)),!1):O.validValues&&O.validValues.indexOf(R)===-1?(console.error("".concat(m," ").concat(S," invalid value: must be among ").concat(JSON.stringify(O.validValues),', "').concat(R,'" provided')),!1):!(O.children&&!h(R,O.children,"[Validate ".concat(S,"]")))});return w||C.push.apply(C,i(Object.keys(y).map(function(S){var R=y[S];if(typeof R=="string"&&(R={type:R}),R.mandatory){var O=R.mandatory;if(typeof O=="function"&&(O=O(v)),O&&v[S]===void 0)return console.error("".concat(m,' Missing mandatory key "').concat(S,'"')),!1}return!0}))),C.reduce(function(S,R){return S&&R},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,y){var m=c(v),w=d(y);return m&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(PW);var zfe=PW.exports;const zi=lj(zfe);var Yfe="numeric";function zE(e,t,r,n,o,i,a){var l=i;if(wr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!zi.languages()[u]){var d=u.replace("-",""),v=zi.allLanguages?zi.allLanguages[u]:zi[d];v&&zi.registerLanguage(v)}zi.setLanguage(u),l=zi(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Hi(e,t,r,n,o,l,a)}zE.RENDERER_TYPE=Yfe;var Gfe="password";function YE(e,t,r,n,o,i,a){Hi.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Ce(l-1,function(){u+=s}),sl(t,u)}YE.RENDERER_TYPE=Gfe;var Kfe="time";function GE(e,t,r,n,o,i,a){Hi.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}GE.RENDERER_TYPE=Kfe;var Pv=on("renderers"),qfe=Pv.register,Xfe=Pv.getItem,kW=Pv.hasItem,Zfe=Pv.getNames;Pv.getValues;function lp(e){if(typeof e=="function")return e;if(!kW(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Xfe(e)}function Hn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),qfe(e,t)}function Qfe(){Hn(Mf),Hn(If),Hn(WE),Hn(VE),Hn(zE),Hn(YE),Hn(Hi),Hn(GE)}var Jfe="autocomplete";function zm(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,JA(r,t)):JA(r,t)(this.source):t(!0)}zm.VALIDATOR_TYPE=Jfe;function JA(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var ece=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},tce=Zt,rce=ym,nce=jt,oce=_n,ice=Ar,eI=ece,tI=Kt,ace=tl,lce=gm;rce("search",function(e,t,r){return[function(o){var i=ice(this),a=oce(o)?void 0:ace(o,e);return a?tce(a,o,i):new RegExp(o)[e](tI(i))},function(n){var o=nce(this),i=tI(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;eI(l,0)||(o.lastIndex=0);var s=lce(o,i);return eI(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function $W(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const sce=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:$W},Symbol.toStringTag,{value:"Module"}));var uce="date";function KE(e,t){var r=yW(CW,this.instance),n=e,o=!0;n==null&&(n="");var i=ee(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=ee(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=fce(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}KE.VALIDATOR_TYPE=uce;function fce(e,t){var r=ee($W(e)),n=ee(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var cce="numeric";function qE(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:wr(e))}qE.VALIDATOR_TYPE=cce;var hce=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],dce="time";function XE(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=ee(o,hce,!0).isValid()?ee(o):ee(o,r),l=a.isValid(),s=ee(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}XE.VALIDATOR_TYPE=dce;var kv=on("validators"),vce=kv.register,yce=kv.getItem,AW=kv.hasItem,gce=kv.getNames;kv.getValues;function ZE(e){if(typeof e=="function")return e;if(!AW(e))throw Error('No registered validator found under "'.concat(e,'" name'));return yce(e)}function Xl(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),vce(e,t)}function pce(){Xl(zm),Xl(KE),Xl(qE),Xl(XE)}var mce="autocomplete",bce={CELL_TYPE:mce,editor:FE,renderer:Mf,validator:zm},wce="checkbox",Sce={CELL_TYPE:wce,editor:wW,renderer:WE},Cce="date",_ce={CELL_TYPE:Cce,editor:_W,renderer:Mf,validator:KE},Oce="dropdown",Rce={CELL_TYPE:Oce,editor:BE,renderer:Mf,validator:zm},Ece="handsontable",Tce={CELL_TYPE:Ece,editor:jE,renderer:Mf},Pce="numeric",kce={CELL_TYPE:Pce,editor:OW,renderer:zE,validator:qE,dataType:"number"},$ce="password",Ace={CELL_TYPE:$ce,editor:RW,renderer:YE,copyable:!1},Ice="text",IW={CELL_TYPE:Ice,editor:ul,renderer:Hi},Mce="time",xce={CELL_TYPE:Mce,editor:EW,renderer:GE,validator:XE},$v=on("cellTypes"),Dce=$v.register,Nce=$v.getItem,MW=$v.hasItem,Hce=$v.getNames;$v.getValues;function QE(e){if(!MW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Nce(e)}function cn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Pr(e,n),o&&Hn(e,o),i&&Xl(e,i),Dce(e,t)}function Lce(){cn(bce),cn(Sce),cn(_ce),cn(Rce),cn(Tce),cn(kce),cn(Ace),cn(IW),cn(xce)}var jce=cm,Fce=fF;jce("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Fce);function Bce(e){return Uce(e)||Wce(e)||xW(e)||Vce()}function Vce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uce(e){if(Array.isArray(e))return b_(e)}function zce(e,t){return Kce(e)||Gce(e,t)||xW(e,t)||Yce()}function Yce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xW(e,t){if(e){if(typeof e=="string")return b_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b_(e,t)}}function b_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Kce(e){if(Array.isArray(e))return e}var w_="asc",qce="desc",rI=new Map([[w_,[-1,1]],[qce,[1,-1]]]),Xce=function(t){return"The priority '".concat(t,"' is already declared in a map.")},Zce=function(t){return"The priority '".concat(t,"' is not a number.")};function Qce(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=pt(t)?t:Xce,r=pt(r)?r:Zce;function o(a,l){if(!wr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w_,l=rI.get(a)||rI.get(w_),s=zce(l,2),u=s[0],f=s[1];return Bce(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}function Jce(e){return rhe(e)||the(e)||DW(e)||ehe()}function ehe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function the(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rhe(e){if(Array.isArray(e))return S_(e)}function nI(e,t){return ihe(e)||ohe(e,t)||DW(e,t)||nhe()}function nhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DW(e,t){if(e){if(typeof e=="string")return S_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S_(e,t)}}function S_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ohe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ihe(e){if(Array.isArray(e))return e}var ahe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function Ym(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=pt(t)?t:ahe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var y=nI(v,2),m=y[0],w=y[1];return f===w?m:!1})||[null],h=nI(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return Jce(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function lhe(e){return che(e)||fhe(e)||uhe(e)||she()}function she(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uhe(e,t){if(e){if(typeof e=="string")return C_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C_(e,t)}}function fhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function che(e){if(Array.isArray(e))return C_(e)}function C_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hhe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function dhe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=pt(t)?t:hhe;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return lhe(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function vhe(e,t){return phe(e)||ghe(e,t)||NW(e,t)||yhe()}function yhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ghe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function phe(e){if(Array.isArray(e))return e}function oI(e){return whe(e)||bhe(e)||NW(e)||mhe()}function mhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NW(e,t){if(e){if(typeof e=="string")return __(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return __(e,t)}}function bhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function whe(e){if(Array.isArray(e))return __(e)}function __(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var JE=function(t){return'There is already registered "'.concat(t,'" plugin.')},She=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Che=function(t){return'The priority "'.concat(t,'" is not a number.')},HW=Qce({errorPriorityExists:She,errorPriorityNaN:Che}),LW=dhe({errorItemExists:JE}),O_=Ym({errorIdExists:JE});function eT(){return[].concat(oI(HW.getItems()),oI(LW.getItems()))}function Av(e){var t=ur(e);return O_.getItem(t)}function _he(e){return!!Av(e)}function tt(e,t,r){var n=Rhe(e,t,r),o=vhe(n,3);e=o[0],t=o[1],r=o[2],Av(e)===void 0&&Ohe(e,t,r)}function Ohe(e,t,r){var n=ur(e);if(O_.hasItem(n))throw new Error(JE(n));r===void 0?LW.addItem(n):HW.addItem(r,n),O_.addItem(n,t)}function Rhe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function Ehe(e,t){return $he(e)||khe(e,t)||Phe(e,t)||The()}function The(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Phe(e,t){if(e){if(typeof e=="string")return iI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iI(e,t)}}function iI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function khe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $he(e){if(Array.isArray(e))return e}function Ahe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mhe(n.key),n)}}function Ihe(e,t,r){return t&&aI(e.prototype,t),r&&aI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mhe(e){var t=xhe(e,"string");return rh(t)==="symbol"?t:String(t)}function xhe(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dhe(e,t){Nhe(e,t),t.add(e)}function Nhe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var lI=new Map([["plugin",_he],["cell-type",MW],["editor",vW],["renderer",kW],["validator",AW]]),Lhe="base",Yi=new WeakMap,Aw=[],En=null,sI=new WeakSet,ot=function(){function e(t){var r=this;Ahe(this,e),Dhe(this,sI),Kn(this,"hot",t,{writable:!1}),Yi.set(this,{hooks:{}}),En=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Ihe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=Ehe(f,2),h=c[0],d=c[1];if(!lI.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));lI.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Aw.push(a)}}En||(En=eT()),En.indexOf("UndoRedo")>=0&&En.splice(En.indexOf("UndoRedo"),1),En.indexOf(this.pluginName)>=0&&En.splice(En.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=En.length===0;if(l){if(Aw.length>0){var s=["".concat(Aw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Yi.get(this).hooks[r]=Yi.get(this).hooks[r]||[];var o=Yi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Yi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;A(Yi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Yi.get(this).hooks;ze(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){A(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=Hhe(this,sI,jhe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ze(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Lhe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function jhe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function Fhe(e,t){return Uhe(e)||Whe(e,t)||Vhe(e,t)||Bhe()}function Bhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vhe(e,t){if(e){if(typeof e=="string")return uI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uI(e,t)}}function uI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Whe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Uhe(e){if(Array.isArray(e))return e}function zhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ghe(n.key),n)}}function Yhe(e,t,r){return t&&fI(e.prototype,t),r&&fI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ghe(e){var t=Khe(e,"string");return nh(t)==="symbol"?t:String(t)}function Khe(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qhe=function(){function e(t){zhe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Yhe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),A(this.rows,function(n){r(n.row,Tt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),A(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){A(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),A(i,function(l){var s=Fhe(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){A(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),te(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return te(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const tT=qhe;function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function Xhe(e,t,r){return t=jW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jW(n.key),n)}}function Qhe(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jW(e){var t=Jhe(e,"string");return oh(t)==="symbol"?t:String(t)}function Jhe(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ede=function(){function e(t){Zhe(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return Qhe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return Ce(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return Ce(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ue(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(Dt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var y=a.get(v);if(y.needed){var m=s.indexOf(c)>-1;(!m||i.allowDuplicates||d)&&(y.strings.push(Xhe({value:c},l,u)),s.push(c),y.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const FW=ede;var sa=1,lr=2;function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function tde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nde(n.key),n)}}function rde(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nde(e){var t=ode(e,"string");return ih(t)==="symbol"?t:String(t)}function ode(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bl=new WeakMap,ide=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;tde(this,e),bl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return rde(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=bl.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,y=h>0?v+1:v,m=0;m<d;m++)if(i=this._getColumnWidth(m),r<=h&&u!==lr&&(this.startColumn=m,a=i),r>=h&&r+(u===lr?i:0)<=h+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,a=i),this.endColumn=m),o.push(r),r+=i,l=i,u!==lr&&(this.endColumn=m),r>=h+v){n=!1;break}var w=c+v-y,C=u===lr?0:l,S=u===lr?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+C||-1*s.scrollOffset-s.viewportWidth>-1*S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var R=o[this.endColumn]+i-o[this.startColumn-1];if((R<=v||u!==lr)&&(this.startColumn-=1),R>v)break}u===sa&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=bl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=bl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=bl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=bl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const rT=ide;function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function ade(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sde(n.key),n)}}function lde(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sde(e){var t=ude(e,"string");return ah(t)==="symbol"?t:String(t)}function ude(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vI=new WeakMap,fde=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;ade(this,e),vI.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return lde(e,[{key:"calculate",value:function(){for(var r=vI.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,y=0,m=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==lr&&(this.startRow=w,y=v),c>=l&&c+(n===lr?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,y=v),this.endRow=w),d.push(c),c+=v,m=v,n!==lr&&(this.endRow=w),c>=l+u-f){h=!1;break}var C=a+u-f,S=n===lr?y:0,R=n===lr?0:m;if(C<S||a>d.at(-1)+R?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var O=d[this.endRow]+v-d[this.startRow-1];if((O<=u-f||n!==lr)&&(this.startRow-=1),O>=u-f)break}n===sa&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const BW=fde;function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function cde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VW(n.key),n)}}function hde(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dde(e,t,r){vde(e,t),t.set(e,r)}function vde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gI(e,t,r){return t=VW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VW(e){var t=yde(e,"string");return lh(t)==="symbol"?t:String(t)}function yde(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zf(e,t){var r=WW(e,t,"get");return gde(e,r)}function gde(e,t){return t.get?t.get.call(e):t.value}function pde(e,t,r){var n=WW(e,t,"set");return mde(e,n,r),r}function WW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mde(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gi=new WeakMap,bde=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;cde(this,e),gI(this,"row",null),gI(this,"col",null),dde(this,Gi,{writable:!0,value:!1}),pde(this,Gi,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return hde(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Zf(this,Gi)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Zf(this,Gi)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Zf(this,Gi)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Zf(this,Gi)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Zf(this,Gi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const sp=bde;function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function wde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UW(n.key),n)}}function Sde(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cde(e,t,r){_de(e,t),t.set(e,r)}function _de(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iw(e,t,r){return t=UW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UW(e){var t=Ode(e,"string");return sh(t)==="symbol"?t:String(t)}function Ode(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tn(e,t){var r=zW(e,t,"get");return Rde(e,r)}function Rde(e,t){return t.get?t.get.call(e):t.value}function Ede(e,t,r){var n=zW(e,t,"set");return Tde(e,n,r),r}function zW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Tde(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gr=new WeakMap,Pde=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;wde(this,e),Iw(this,"highlight",null),Iw(this,"from",null),Iw(this,"to",null),Cde(this,Gr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Ede(this,Gr,o)}return Sde(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Tn(this,Gr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Tn(this,Gr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Tn(this,Gr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Tn(this,Gr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Tn(this,Gr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Tn(this,Gr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Tn(this,Gr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Tn(this,Gr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof sp))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Tn(this,Gr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new sp(r,n,Tn(this,Gr))}}]),e}();const nT=Pde;function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function kde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ade(n.key),n)}}function $de(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ade(e){var t=Ide(e,"string");return uh(t)==="symbol"?t:String(t)}function Ide(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wl=new WeakMap,Mde=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;kde(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,wl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return $de(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};pn()?n():(EE()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=wl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=wc(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=wl.get(this),o=this.domBindings.rootDocument.activeElement,i=HE(XV,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=wc(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&mi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=wc(r.target,["TD","TH"],n),i=wc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&mi(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=wl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=wl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ve(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];CE()&&(AV()||IV())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=wl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const YW=Mde;function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function xde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nde(n.key),n)}}function Dde(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nde(e){var t=Hde(e,"string");return fh(t)==="symbol"?t:String(t)}function Hde(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lde=function(){function e(t,r,n){xde(this,e),this.offset=t,this.total=r,this.countTH=n}return Dde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const jde=Lde;function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function Fde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vde(n.key),n)}}function Bde(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vde(e){var t=Wde(e,"string");return ch(t)==="symbol"?t:String(t)}function Wde(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ude=function(){function e(t,r,n){Fde(this,e),this.offset=t,this.total=r,this.countTH=n}return Bde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const zde=Ude;var Yde=0,up=1,fp=2;function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function Gde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qde(n.key),n)}}function Kde(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qde(e){var t=Xde(e,"string");return hh(t)==="symbol"?t:String(t)}function Xde(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CI=function(){function e(){Gde(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Kde(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function Zde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jde(n.key),n)}}function Qde(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jde(e){var t=eve(e,"string");return dh(t)==="symbol"?t:String(t)}function eve(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tve=function(){function e(){Zde(this,e),this.size=new CI,this.workingSpace=Yde,this.sharedSize=null}return Qde(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof CI}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=up,r.workingSpace=fp,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=fp,r.workingSpace=up,this.sharedSize=r.getViewSize()}}]),e}();function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function rve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ove(n.key),n)}}function nve(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ove(e){var t=ive(e,"string");return vh(t)==="symbol"?t:String(t)}function ive(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GW=function(){function e(t,r,n){rve(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new tve,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return nve(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(up))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(fp)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(up);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(fp)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}function ave(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sve(n.key),n)}}function lve(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sve(e){var t=uve(e,"string");return Ns(t)==="symbol"?t:String(t)}function uve(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R_(e,t)}function R_(e,t){return R_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},R_(e,t)}function cve(e){var t=vve();return function(){var n=cp(e),o;if(t){var i=cp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hve(this,o)}}function hve(e,t){if(t&&(Ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dve(e)}function dve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cp(e){return cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cp(e)}var KW=function(e){fve(r,e);var t=cve(r);function r(){return ave(this,r),t.apply(this,arguments)}return lve(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(GW);function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function yve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pve(n.key),n)}}function gve(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pve(e){var t=mve(e,"string");return yh(t)==="symbol"?t:String(t)}function mve(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bve=function(){function e(t){yve(this,e),this.nodeType=t.toUpperCase()}return gve(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function wve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cve(n.key),n)}}function Sve(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cve(e){var t=_ve(e,"string");return gh(t)==="symbol"?t:String(t)}function _ve(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iv=function(){function e(t,r){wve(this,e),this.nodesPool=typeof t=="string"?new bve(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Sve(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function Ove(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eve(n.key),n)}}function Rve(e,t,r){return t&&PI(e.prototype,t),r&&PI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eve(e){var t=Tve(e,"string");return Hs(t)==="symbol"?t:String(t)}function Tve(e,t){if(Hs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E_(e,t)}function E_(e,t){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},E_(e,t)}function kve(e){var t=Ive();return function(){var n=hp(e),o;if(t){var i=hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ve(this,o)}}function $ve(e,t){if(t&&(Hs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ave(e)}function Ave(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ive(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hp(e){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hp(e)}var Mve=function(e){Pve(r,e);var t=kve(r);function r(){var n;return Ove(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Rve(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new KW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<l;y++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),a[y](c,m,y)}d.end()}}}]),r}(Iv);function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function xve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nve(n.key),n)}}function Dve(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nve(e){var t=Hve(e,"string");return Ls(t)==="symbol"?t:String(t)}function Hve(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T_(e,t)}function T_(e,t){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T_(e,t)}function jve(e){var t=Vve();return function(){var n=dp(e),o;if(t){var i=dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Fve(this,o)}}function Fve(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bve(e)}function Bve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dp(e){return dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dp(e)}var Wve=function(e){Lve(r,e);var t=jve(r);function r(n){return xve(this,r),t.call(this,null,n)}return Dve(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Cn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(Iv);function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function Uve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yve(n.key),n)}}function zve(e,t,r){return t&&$I(e.prototype,t),r&&$I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yve(e){var t=Gve(e,"string");return js(t)==="symbol"?t:String(t)}function Gve(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P_(e,t)}function P_(e,t){return P_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},P_(e,t)}function qve(e){var t=Qve();return function(){var n=vp(e),o;if(t){var i=vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Xve(this,o)}}function Xve(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zve(e)}function Zve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vp(e)}var Jve=function(e){Kve(r,e);var t=qve(r);function r(n){return Uve(this,r),t.call(this,null,n)}return zve(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&te(d,"rowHeader")}}]),r}(Iv);function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}var AI;function eye(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function tye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function II(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nye(n.key),n)}}function rye(e,t,r){return t&&II(e.prototype,t),r&&II(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nye(e){var t=oye(e,"string");return Fs(t)==="symbol"?t:String(t)}function oye(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k_(e,t)}function k_(e,t){return k_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},k_(e,t)}function aye(e){var t=uye();return function(){var n=yp(e),o;if(t){var i=yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lye(this,o)}}function lye(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sye(e)}function sye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yp(e){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yp(e)}var MI=!1,fye=function(e){iye(r,e);var t=aye(r);function r(n){var o;return tye(this,r),o=t.call(this,"TR",n),o.orderView=new GW(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return rye(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!MI&&o>1e3&&(MI=!0,bt(dt(AI||(AI=eye([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Iv);function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function cye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dye(n.key),n)}}function hye(e,t,r){return t&&xI(e.prototype,t),r&&xI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dye(e){var t=vye(e,"string");return Bs(t)==="symbol"?t:String(t)}function vye(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}function $_(e,t){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$_(e,t)}function gye(e){var t=bye();return function(){var n=gp(e),o;if(t){var i=gp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pye(this,o)}}function pye(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mye(e)}function mye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gp(e){return gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gp(e)}var wye=function(e){yye(r,e);var t=gye(r);function r(){var n;return cye(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return hye(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new KW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var y=h.getCurrentNode(),m=this.table.renderedColumnToSource(v);xe(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(f,m,y)}h.end()}}}]),r}(Iv);function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Sye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ye(n.key),n)}}function Cye(e,t,r){return t&&DI(e.prototype,t),r&&DI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ye(e){var t=Oye(e,"string");return ph(t)==="symbol"?t:String(t)}function Oye(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rye=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Sye(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Cye(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function Eye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pye(n.key),n)}}function Tye(e,t,r){return t&&NI(e.prototype,t),r&&NI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pye(e){var t=kye(e,"string");return mh(t)==="symbol"?t:String(t)}function kye(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ye=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;Eye(this,e),this.renderer=new Rye(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Mve,columnHeaders:new Wve(n),colGroup:new Jve(o),rows:new fye(i),cells:new wye}),this.renderer.setAxisUtils(a,l)}return Tye(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function Aye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mye(n.key),n)}}function Iye(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mye(e){var t=xye(e,"string");return bh(t)==="symbol"?t:String(t)}function xye(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dye=function(){function e(t,r){Aye(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Iye(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Jt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Nye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lye(n.key),n)}}function Hye(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lye(e){var t=jye(e,"string");return wh(t)==="symbol"?t:String(t)}function jye(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fye=function(){function e(t,r){Nye(this,e),this.dataAccessObject=t,this.wtSettings=r}return Hye(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function Bye(e){return Uye(e)||Wye(e)||qW(e)||Vye()}function Vye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uye(e){if(Array.isArray(e))return A_(e)}function zye(e,t){return Kye(e)||Gye(e,t)||qW(e,t)||Yye()}function Yye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qW(e,t){if(e){if(typeof e=="string")return A_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A_(e,t)}}function A_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Kye(e){if(Array.isArray(e))return e}function qye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XW(n.key),n)}}function Xye(e,t,r){return t&&jI(e.prototype,t),r&&jI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pn(e,t,r){return t=XW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XW(e){var t=Zye(e,"string");return Sh(t)==="symbol"?t:String(t)}function Zye(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qye=function(){function e(t,r,n,o,i){var a=this;qye(this,e),Pn(this,"wtSettings",null),Pn(this,"domBindings",void 0),Pn(this,"TBODY",null),Pn(this,"THEAD",null),Pn(this,"COLGROUP",null),Pn(this,"hasTableHeight",!0),Pn(this,"hasTableWidth",!0),Pn(this,"isTableVisible",!1),Pn(this,"tableOffset",0),Pn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,AE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new Fye(this.dataAccessObject,this.wtSettings),this.columnUtils=new Dye(this.dataAccessObject,this.wtSettings),this.tableRenderer=new $ye({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Xye(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Ut(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var y=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,m!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ut(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new zde(w,l,h),this.columnFilter=new jde(C,s,f);var S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var R={};this.wtSettings.getSetting("beforeDraw",!0,R),S=R.skipRender!==!0}if(S){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Bn)||this.is(bi))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var O;if(this.isMaster&&(O=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Bn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var j=ct(this.hider),U=ct(this.TABLE);j!==0&&U!==j&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),O!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Bn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var q=!1;return this.isMaster&&(q=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(q=i.bottomOverlay.resetFixedPosition()||q),q=i.inlineStartOverlay.resetFixedPosition()||q,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),q?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=ho(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Bn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Le(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,y=0;y<v;y++)l.includes(d[y])||l.push(d[y]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var m=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var w=0;w<m.length;w++)l.push(m[w]);for(var C=l.length,S=0;S<C;S++)this.removeClassFromCells(l[S])}for(var R=0;R<a;R++)i[R].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=zye(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=pi(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=QV(o),l=n.cellIndex;if(li(Ga,n,this.wtRootElement)||li(za,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(li(bi,n,this.wtRootElement)||li(Bn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return li(Ga,n,this.wtRootElement)||li(Ya,n,this.wtRootElement)||li(bi,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=ho(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=ho(u):a=ho(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ct(this.TABLE)}},{key:"getHeight",value:function(){return Tt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ct(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Tt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return ps(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=pt(r)?r():null;return Array.isArray(n)?(n=Bye(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const xf=Qye;var Jye="stickyRowsBottom",ZW={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(ZW,"MIXIN_NAME",Jye,{writable:!1,enumerable:!1});const QW=ZW;var ege="stickyColumnsStart",JW={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Kn(JW,"MIXIN_NAME",ege,{writable:!1,enumerable:!1});const oT=JW;function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}function FI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rge(n.key),n)}}function tge(e,t,r){return t&&FI(e.prototype,t),r&&FI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rge(e){var t=nge(e,"string");return Vs(t)==="symbol"?t:String(t)}function nge(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ige(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I_(e,t)}function I_(e,t){return I_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},I_(e,t)}function age(e){var t=uge();return function(){var n=pp(e),o;if(t){var i=pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lge(this,o)}}function lge(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sge(e)}function sge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pp(e){return pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pp(e)}var iT=function(e){ige(r,e);var t=age(r);function r(n,o,i,a){return oge(this,r),t.call(this,n,o,i,a,bi)}return tge(r)}(xf);gt(iT,QW);gt(iT,oT);const fge=iT;var za="top",Bn="bottom",Ya="inline_start",Ga="top_inline_start_corner",bi="bottom_inline_start_corner",cge=[za,Bn,Ya,Ga,bi],hge=new Map([[za,"ht_clone_".concat(za)],[Bn,"ht_clone_".concat(Bn)],[Ya,"ht_clone_".concat(Ya," ht_clone_left")],[Ga,"ht_clone_".concat(Ga," ht_clone_top_left_corner")],[bi,"ht_clone_".concat(bi," ht_clone_bottom_left_corner")]]),dge=Yt,vge=Math.floor,yge=Number.isInteger||function(t){return!dge(t)&&isFinite(t)&&vge(t)===t},gge=$e,pge=yge;gge({target:"Number",stat:!0},{isInteger:pge});function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}function mge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e2(n.key),n)}}function bge(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mw(e,t,r){return t=e2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e2(e){var t=wge(e,"string");return Ch(t)==="symbol"?t:String(t)}function wge(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sge=function(){function e(t){mge(this,e),Mw(this,"dataAccessObject",void 0),Mw(this,"lastScrolledColumnPos",-1),Mw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return bge(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var y=!1;return s===-1?y=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(y=v.scrollTo(r,f?r>u:o)),y&&(this.lastScrolledRowPos=r),y}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Ut(o.wtRootElement),c=ho(o.hider),h=ho(s),d=Xc(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var y=a;y>0;y--)if(v+=n.sumCellSizes(y-1,y),f.top+c-v<=d){u=y;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=Xc(l,l);if(u.top>f){for(var c=ho(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=$c(o.hider),c=$c(l),h=Math.abs(ep(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var y=Ut(i.wtRootElement);c=y.left}var m=Math.abs(ep(s,s));if(c>m){for(var w=$c(s),C=a.getRowHeaderWidth(),S=1;S<=l;S++)if(C+=o.sumCellSizes(S-1,S),c+C-m>=w){u=S-2;break}}}return u}}]),e}();const Cge=Sge;function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function _ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t2(n.key),n)}}function Oge(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sn(e,t,r){return t=t2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t2(e){var t=Rge(e,"string");return _h(t)==="symbol"?t:String(t)}function Rge(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aT=function(){function e(t,r){_ge(this,e),sn(this,"wtTable",void 0),sn(this,"wtScroll",void 0),sn(this,"wtViewport",void 0),sn(this,"wtOverlays",void 0),sn(this,"selections",void 0),sn(this,"wtEvent",void 0),sn(this,"guid","wt_".concat(PE())),sn(this,"drawInterrupted",!1),sn(this,"drawn",!1),sn(this,"domBindings",void 0),sn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Cge(this.createScrollDao())}return Oge(e,[{key:"eventManager",get:function(){return new Pt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ai(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new sp(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new nT(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r2(n.key),n)}}function Ege(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M_(e,t)}function M_(e,t){return M_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},M_(e,t)}function kge(e){var t=Age();return function(){var n=mp(e),o;if(t){var i=mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ge(this,o)}}function $ge(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pg(e)}function pg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Age(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mp(e){return mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mp(e)}function UI(e,t,r){return t=r2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r2(e){var t=Ige(e,"string");return Ws(t)==="symbol"?t:String(t)}function Ige(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mge=function(e){Pge(r,e);var t=kge(r);function r(n,o,i){var a;Tge(this,r),a=t.call(this,n,o),UI(pg(a),"cloneSource",void 0),UI(pg(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",pg(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new YW(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Ege(r)}(aT);function Oh(e){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}function xge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n2(n.key),n)}}function Dge(e,t,r){return t&&zI(e.prototype,t),r&&zI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nge(e,t,r){return t=n2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n2(e){var t=Hge(e,"string");return Oh(t)==="symbol"?t:String(t)}function Hge(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mv=function(){function e(t,r,n,o,i){xge(this,e),Nge(this,"wtSettings",null),Kn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=Va(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Dge(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Va(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Zc(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){bt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Jt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(cge.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(hge.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===za||u==="vertical"&&this.type===Ya?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Zc(r.TABLE),new Mge(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;A([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function mg(e,t,r){return o2()?mg=Reflect.construct.bind():mg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&bp(u,a.prototype),u},mg.apply(null,arguments)}function Lge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fge(n.key),n)}}function jge(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fge(e){var t=Bge(e,"string");return Us(t)==="symbol"?t:String(t)}function Bge(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bp(e,t)}function bp(e,t){return bp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bp(e,t)}function Wge(e){var t=o2();return function(){var n=wp(e),o;if(t){var i=wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uge(this,o)}}function Uge(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zge(e)}function zge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wp(e){return wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wp(e)}var Yge=function(e){Vge(r,e);var t=Wge(r);function r(n,o,i,a,l,s){var u;return Lge(this,r),u=t.call(this,n,o,bi,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return jge(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return mg(fge,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else Ev(i),this.repositionOverlay();var s=Tt(this.clone.wtTable.TABLE),u=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}}]),r}(Mv),Gge="calculatedColumns",i2={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Kn(i2,"MIXIN_NAME",Gge,{writable:!1,enumerable:!1});const lT=i2;function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qge(n.key),n)}}function Kge(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qge(e){var t=Xge(e,"string");return zs(t)==="symbol"?t:String(t)}function Xge(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function Jge(e){var t=rpe();return function(){var n=Sp(e),o;if(t){var i=Sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return epe(this,o)}}function epe(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tpe(e)}function tpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sp(e){return Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sp(e)}var sT=function(e){Qge(r,e);var t=Jge(r);function r(n,o,i,a){return Zge(this,r),t.call(this,n,o,i,a,Bn)}return Kge(r)}(xf);gt(sT,QW);gt(sT,lT);const npe=sT;function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function bg(e,t,r){return l2()?bg=Reflect.construct.bind():bg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Cp(u,a.prototype),u},bg.apply(null,arguments)}function ope(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s2(n.key),n)}}function ipe(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ape(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cp(e,t)}function Cp(e,t){return Cp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Cp(e,t)}function lpe(e){var t=l2();return function(){var n=_p(e),o;if(t){var i=_p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return spe(this,o)}}function spe(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a2(e)}function a2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _p(e){return _p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_p(e)}function upe(e,t,r){return t=s2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s2(e){var t=fpe(e,"string");return Ys(t)==="symbol"?t:String(t)}function fpe(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cpe=function(e){ape(r,e);var t=lpe(r);function r(n,o,i,a){var l;return ope(this,r),l=t.call(this,n,o,Bn,i,a),upe(a2(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return ipe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return bg(npe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Ba(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Jt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var y=Tt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),h.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Xc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(te(u,"innerBorderBottom"),s=!f):(Le(u,"innerBorderBottom"),s=f)}return s}}]),r}(Mv),hpe="calculatedRows",u2={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Kn(u2,"MIXIN_NAME",hpe,{writable:!1,enumerable:!1});const f2=u2;function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vpe(n.key),n)}}function dpe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vpe(e){var t=ype(e,"string");return Gs(t)==="symbol"?t:String(t)}function ype(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ppe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D_(e,t)}function D_(e,t){return D_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},D_(e,t)}function mpe(e){var t=Spe();return function(){var n=Op(e),o;if(t){var i=Op(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bpe(this,o)}}function bpe(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wpe(e)}function wpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Spe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Op(e)}var uT=function(e){ppe(r,e);var t=mpe(r);function r(n,o,i,a){return gpe(this,r),t.call(this,n,o,i,a,Ya)}return dpe(r)}(xf);gt(uT,f2);gt(uT,oT);const Cpe=uT;function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function wg(e,t,r){return c2()?wg=Reflect.construct.bind():wg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Rp(u,a.prototype),u},wg.apply(null,arguments)}function _pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rpe(n.key),n)}}function Ope(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rpe(e){var t=Epe(e,"string");return Ks(t)==="symbol"?t:String(t)}function Epe(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rp(e,t)}function Rp(e,t){return Rp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Rp(e,t)}function Ppe(e){var t=c2();return function(){var n=Ep(e),o;if(t){var i=Ep(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kpe(this,o)}}function kpe(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $pe(e)}function $pe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ep(e)}var Ape=function(e){Tpe(r,e);var t=Ppe(r);function r(n,o,i,a){return _pe(this,r),t.call(this,n,o,Ya,i,a)}return Ope(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return wg(Cpe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Vm(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),Ev(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,ms(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=ct(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(ep(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Le(i,"emptyRows"):te(i,"emptyRows");var u=!1;if(l&&!a.length)te(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(te(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(Le(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(Mv),Ipe="stickyRowsTop",h2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(h2,"MIXIN_NAME",Ipe,{writable:!1,enumerable:!1});const d2=h2;function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xpe(n.key),n)}}function Mpe(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xpe(e){var t=Dpe(e,"string");return qs(t)==="symbol"?t:String(t)}function Dpe(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Npe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N_(e,t)}function N_(e,t){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N_(e,t)}function Lpe(e){var t=Bpe();return function(){var n=Tp(e),o;if(t){var i=Tp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jpe(this,o)}}function jpe(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fpe(e)}function Fpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tp(e)}var fT=function(e){Hpe(r,e);var t=Lpe(r);function r(n,o,i,a){return Npe(this,r),t.call(this,n,o,i,a,Ga)}return Mpe(r)}(xf);gt(fT,d2);gt(fT,oT);const Vpe=fT;function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function Sg(e,t,r){return v2()?Sg=Reflect.construct.bind():Sg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Pp(u,a.prototype),u},Sg.apply(null,arguments)}function Wpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y2(n.key),n)}}function Upe(e,t,r){return t&&QI(e.prototype,t),r&&QI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pp(e,t)}function Pp(e,t){return Pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Pp(e,t)}function Ype(e){var t=v2();return function(){var n=kp(e),o;if(t){var i=kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Gpe(this,o)}}function Gpe(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H_(e)}function H_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kp(e){return kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kp(e)}function JI(e,t,r){return t=y2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y2(e){var t=Kpe(e,"string");return Xs(t)==="symbol"?t:String(t)}function Kpe(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qpe=function(e){zpe(r,e);var t=Ype(r);function r(n,o,i,a,l,s){var u;return Wpe(this,r),u=t.call(this,n,o,Ga,i,a),JI(H_(u),"topOverlay",void 0),JI(H_(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return Upe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Sg(Vpe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();Vm(o,"".concat(i,"px"),"".concat(a,"px"))}else Ev(o);var l=Tt(this.clone.wtTable.TABLE),s=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(Mv);function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zpe(n.key),n)}}function Xpe(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zpe(e){var t=Qpe(e,"string");return Zs(t)==="symbol"?t:String(t)}function Qpe(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L_(e,t)}function L_(e,t){return L_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},L_(e,t)}function tme(e){var t=ome();return function(){var n=$p(e),o;if(t){var i=$p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rme(this,o)}}function rme(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nme(e)}function nme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ome(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $p(e){return $p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$p(e)}var cT=function(e){eme(r,e);var t=tme(r);function r(n,o,i,a){return Jpe(this,r),t.call(this,n,o,i,a,za)}return Xpe(r)}(xf);gt(cT,d2);gt(cT,lT);const ime=cT;function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function Cg(e,t,r){return p2()?Cg=Reflect.construct.bind():Cg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Ap(u,a.prototype),u},Cg.apply(null,arguments)}function ame(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m2(n.key),n)}}function lme(e,t,r){return t&&tM(e.prototype,t),r&&tM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ap(e,t)}function Ap(e,t){return Ap=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ap(e,t)}function ume(e){var t=p2();return function(){var n=Ip(e),o;if(t){var i=Ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fme(this,o)}}function fme(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g2(e)}function g2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}function cme(e,t,r){return t=m2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m2(e){var t=hme(e,"string");return Qs(t)==="symbol"?t:String(t)}function hme(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dme=function(e){sme(r,e);var t=ume(r);function r(n,o,i,a){var l;return ame(this,r),l=t.call(this,n,o,za,i,a),cme(g2(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return lme(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Cg(ime,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),Vm(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),Ev(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Ba(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Tt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Jt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Xc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Le(a,"emptyColumns"):te(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(te(a,"innerBorderTop"),s=!h):(Le(a,"innerBorderTop"),s=h)}}return s}}]),r}(Mv);function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function fi(e,t,r){return vme()?fi=Reflect.construct.bind():fi=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&j_(u,a.prototype),u},fi.apply(null,arguments)}function vme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function j_(e,t){return j_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},j_(e,t)}function yme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b2(n.key),n)}}function gme(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qn(e,t,r){return t=b2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b2(e){var t=pme(e,"string");return Rh(t)==="symbol"?t:String(t)}function pme(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mme=function(){function e(t,r,n,o,i,a){var l=this;yme(this,e),Qn(this,"wot",null),Qn(this,"topOverlay",null),Qn(this,"bottomOverlay",null),Qn(this,"inlineStartOverlay",null),Qn(this,"topInlineStartCornerOverlay",null),Qn(this,"bottomInlineStartCornerOverlay",null),Qn(this,"browserLineHeight",void 0),Qn(this,"wtSettings",null),Qn(this,"resizeObserver",new ResizeObserver(function(h){Fm(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Jt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Zc(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return gme(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=fi(dme,r),this.bottomOverlay=fi(cpe,r),this.inlineStartOverlay=fi(Ape,r),this.topInlineStartCornerOverlay=fi(qpe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=fi(Yge,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!SE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var y=v.clone.wtTable.holder;r.eventManager.addEventListener(y,"wheel",function(m){return r.onCloneWheel(m,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=gs(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Zc(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,y=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<y,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return A(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const bme=mme;function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function wme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w2(n.key),n)}}function Sme(e,t,r){return t&&nM(e.prototype,t),r&&nM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oM(e,t,r){return t=w2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w2(e){var t=Cme(e,"string");return Eh(t)==="symbol"?t:String(t)}function Cme(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _me=function(){function e(t){var r=this;wme(this,e),oM(this,"settings",{}),oM(this,"defaults",Object.freeze(this.getDefaults())),ze(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return Sme(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ai(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?ze(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Js(e){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Js(e)}function Ome(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eme(n.key),n)}}function Rme(e,t,r){return t&&iM(e.prototype,t),r&&iM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eme(e){var t=Tme(e,"string");return Js(t)==="symbol"?t:String(t)}function Tme(e,t){if(Js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F_(e,t)}function F_(e,t){return F_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},F_(e,t)}function kme(e){var t=Ime();return function(){var n=Mp(e),o;if(t){var i=Mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $me(this,o)}}function $me(e,t){if(t&&(Js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ame(e)}function Ame(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ime(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}var hT=function(e){Pme(r,e);var t=kme(r);function r(n,o,i,a){return Ome(this,r),t.call(this,n,o,i,a,"master")}return Rme(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Va(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=bs(o,"height",i),u=bs(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,y=d.height,m=["auto","hidden","scroll"];if(l&&m.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var C=parseInt(Ii(w,i).height,10);l.removeChild(w),C===0&&(y=0)}y=Math.min(y,h),f.height=s==="auto"?"auto":"".concat(y,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:y>0,this.hasTableWidth=v>0}this.isTableVisible=ps(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(xf);gt(hT,f2);gt(hT,lT);const Mme=hT;function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function xme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nme(n.key),n)}}function Dme(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nme(e){var t=Hme(e,"string");return Th(t)==="symbol"?t:String(t)}function Hme(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lme=function(){function e(t,r,n,o,i){var a=this;xme(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Dme(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Tt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,y;if(u)return ct(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(y=bs(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,a.clientWidth);var m=r.getSetting("stretchH");return m==="none"||!m?Math.max(v,ct(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Ut(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Tt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=ct(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sa,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===sa?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Jt(this.domBindings.rootDocument),new BW({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sa,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new rT({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(lr),i=this.createColumnsCalculator(lr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(sa),this.columnsRenderCalculator=this.createColumnsCalculator(sa)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(lr),this.columnsVisibleCalculator=this.createColumnsCalculator(lr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){ze(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const jme=Lme;function eu(e){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function Fme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vme(n.key),n)}}function Bme(e,t,r){return t&&lM(e.prototype,t),r&&lM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vme(e){var t=Wme(e,"string");return eu(t)==="symbol"?t:String(t)}function Wme(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ume(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B_(e,t)}function B_(e,t){return B_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},B_(e,t)}function zme(e){var t=Gme();return function(){var n=xp(e),o;if(t){var i=xp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Yme(this,o)}}function Yme(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V_(e)}function V_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xp(e){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xp(e)}var Kme=function(e){Ume(r,e);var t=zme(r);function r(n,o){var i;Fme(this,r),i=t.call(this,n,new _me(o));var a=i.wtSettings.getSetting("facade",V_(i));return i.wtTable=new Mme(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new jme(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new YW(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new bme(V_(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return Bme(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];ze(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Le(this.wtTable.wtRootElement.parentNode,a),te(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(aT);function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function qme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zme(n.key),n)}}function Xme(e,t,r){return t&&sM(e.prototype,t),r&&sM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zme(e){var t=Qme(e,"string");return Ph(t)==="symbol"?t:String(t)}function Qme(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jme=function(){function e(t){qme(this,e),t instanceof aT?this._wot=t:this._initFromSettings(t)}return Xme(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new Kme(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),S2=Gt,ebe=je,C2=Ye,tbe=uv,rbe=tv,nbe=zr,obe=iv.f,_2=C2(obe),ibe=C2([].push),abe=S2&&ebe(function(){var e=Object.create(null);return e[2]=2,!_2(e,2)}),uM=function(e){return function(t){for(var r=nbe(t),n=rbe(r),o=abe&&tbe(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!S2||(o?s in r:_2(r,s)))&&ibe(l,e?[s,r[s]]:r[s]);return l}},lbe={entries:uM(!0),values:uM(!1)},sbe=$e,ube=lbe.values;sbe({target:"Object",stat:!0},{values:function(t){return ube(t)}});function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function xw(e,t){return dbe(e)||hbe(e,t)||cbe(e,t)||fbe()}function fbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cbe(e,t){if(e){if(typeof e=="string")return fM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fM(e,t)}}function fM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dbe(e){if(Array.isArray(e))return e}function vbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gbe(n.key),n)}}function ybe(e,t,r){return t&&cM(e.prototype,t),r&&cM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gbe(e){var t=pbe(e,"string");return kh(t)==="symbol"?t:String(t)}function pbe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mbe=function(){function e(t,r){vbe(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return ybe(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),wn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),pn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};ze(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};ze(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,y=parseInt(c.borderWidth,10),m=parseInt(c.width,10),w=parseInt(h.width,10),C=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-m-1,10),"px"),c[u]="".concat(parseInt(i-m-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var R=Math.min(parseInt(i+a,10),C-m-y*2),O=Math.min(parseInt(i+a-w/4,10),C-w-y*2);d[u]="".concat(R,"px"),v[u]="".concat(O,"px");var j=Math.min(parseInt(o+l,10),S-m-y*2),U=Math.min(parseInt(o+l-w/4,10),S-w-y*2);d.top="".concat(j,"px"),v.top="".concat(U,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var y=o.rowFilter.renderedToSource(v);if(y>=r[0]&&y<=r[2]){l=y,c=r[0];break}}for(var m=d-1;m>=0;m-=1){var w=o.rowFilter.renderedToSource(m);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var C=o.getRenderedColumnsCount(),S=0;S<C;S+=1){var R=o.columnFilter.renderedToSource(S);if(R>=r[1]&&R<=r[3]){u=R,h=r[1];break}}for(var O=C-1;O>=0;O-=1){var j=o.columnFilter.renderedToSource(O);if(j>=r[1]&&j<=r[3]){f=j;break}}if(l===void 0||u===void 0){this.disappear();return}var U=o.getCell(this.wot.createCellCoords(l,u)),q=l!==s||u!==f,G=q?o.getCell(this.wot.createCellCoords(s,f)):U,X=Ut(U),Q=q?Ut(G):X,oe=Ut(o.TABLE),J=ct(o.TABLE),ue=X.top,he=X.left,Oe=this.wot.wtSettings.getSetting("rtlMode"),we=0,$=0;if(Oe){var k=ct(U),g=a.innerWidth-oe.left-J;$=he+k-Q.left,we=a.innerWidth-he-k-g-1}else $=Q.left+ct(G)-he,we=he-oe.left-1;if(this.isEntireColumnSelected(l,s)){var p=this.getDimensionsFromHeader("columns",u,f,c,oe),b=null;if(p){var T=xw(p,3);b=T[0],we=T[1],$=T[2]}b&&(U=b)}var E=ue-oe.top-1,B=Q.top+Tt(G)-ue;if(this.isEntireRowSelected(u,f)){var x=this.getDimensionsFromHeader("rows",l,s,h,oe),K=null;if(x){var Z=xw(x,3);K=Z[0],E=Z[1],B=Z[2]}K&&(U=K)}var re=Ii(U,a);parseInt(re.borderTopWidth,10)>0&&(E+=1,B=B>0?B-1:0),parseInt(re[Oe?"borderRightWidth":"borderLeftWidth"],10)>0&&(we+=1,$=$>0?$-1:0);var ie=Oe?"right":"left";this.topStyle.top="".concat(E,"px"),this.topStyle[ie]="".concat(we,"px"),this.topStyle.width="".concat($,"px"),this.topStyle.display="block",this.startStyle.top="".concat(E,"px"),this.startStyle[ie]="".concat(we,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var se=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(E+B-se,"px"),this.bottomStyle[ie]="".concat(we,"px"),this.bottomStyle.width="".concat($,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(E,"px"),this.endStyle[ie]="".concat(we+$-se,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var _e=this.settings.border.cornerVisible;_e=typeof _e=="function"?_e(this.settings.layerLevel):_e;var Se=this.wot.getSetting("onModifyGetCellCoords",s,f),z=s,Ne=f;if(Se&&Array.isArray(Se)){var Be=xw(Se,4);z=Be[2],Ne=Be[3]}if(pn()||!_e||this.isPartRange(z,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(E+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ie]="".concat(we+$+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ke=Va(o.TABLE),Ie=ke===a;Ie&&(ke=i.documentElement);var Ae=parseInt(this.cornerDefaultStyle.width,10)/2,_=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var P=Ie?G.getBoundingClientRect().left:G.offsetLeft,I=!1,F=0;Oe?(F=P-parseInt(this.cornerDefaultStyle.width,10)/2,I=F<0):(F=P+ct(G)+parseInt(this.cornerDefaultStyle.width,10)/2,I=F>=$c(ke)),I&&(this.cornerStyle[ie]="".concat(Math.floor(we+$+this.cornerCenterPointOffset-Ae),"px"),this.cornerStyle[Oe?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ie?G.getBoundingClientRect().top:G.offsetTop,V=M+Tt(G)+parseInt(this.cornerDefaultStyle.height,10)/2,N=V>=ho(ke);N&&(this.cornerStyle.top="".concat(Math.floor(E+B+this.cornerCenterPointOffset-_),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}pn()&&this.updateMultipleSelectionHandlesPosition(s,f,E,we,$,B)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,y=null,m=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Tt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return ct.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(y=u(n,w-i),m=u(o,w-i),!y||!m)return!1;var C=Ut(y),S=Ut(m);return y&&m&&(h=C[v]-a[v]-1,d=S[v]+f(m)-C[v]),[y,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?te(this[r],"hidden"):(xe(this[r],"hidden")&&Le(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?te(this[r],"hidden"):Le(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",pn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const bbe=mbe;function wbe(e,t){return Obe(e)||_be(e,t)||Cbe(e,t)||Sbe()}function Sbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cbe(e,t){if(e){if(typeof e=="string")return hM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hM(e,t)}}function hM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _be(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Obe(e){if(Array.isArray(e))return e}function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function Rbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tbe(n.key),n)}}function Ebe(e,t,r){return t&&dM(e.prototype,t),r&&dM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tbe(e){var t=Pbe(e,"string");return tu(t)==="symbol"?t:String(t)}function Pbe(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kbe=function(){function e(t,r){Rbe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Ebe(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new bbe(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(tu(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),te(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=wbe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,m=c.selectionType,w=m===void 0||["active-header","header"].includes(m);if(w&&s!==null&&f!==null)for(var C=0,S=0;S<o;S+=1){var R=r.wtTable.columnFilter.renderedToSource(S);if(R>=s&&R<=f){var O=r.wtTable.getColumnHeaders(R),j=O.length-1;y&&O.length>1&&(O=[O[j]]);for(var U=0;U<O.length;U+=1){var q=[],G=O[U];h&&q.push(h),d&&q.push(d),U=y?j:U;var X=r.getSetting("onBeforeHighlightingColumnHeader",R,U,{selectionType:m,columnCursor:C,selectionWidth:f-s+1,classNames:q});X!==R&&(G=r.wtTable.getColumnHeader(X,U)),te(G,q)}C+=1}}if(l!==null&&u!==null)for(var Q=0,oe=0;oe<n;oe+=1){var J=r.wtTable.rowFilter.renderedToSource(oe);if(w&&J>=l&&J<=u){var ue=r.wtTable.getRowHeaders(J),he=ue.length-1;y&&ue.length>1&&(ue=[ue[he]]);for(var Oe=0;Oe<ue.length;Oe+=1){var we=[],$=ue[Oe];h&&we.push(h),v&&we.push(v),Oe=y?he:Oe;var k=r.getSetting("onBeforeHighlightingRowHeader",J,Oe,{selectionType:m,rowCursor:Q,selectionHeight:u-l+1,classNames:we});k!==J&&($=r.wtTable.getRowHeader(k,Oe)),te($,we)}Q+=1}if(s!==null&&f!==null)for(var g=0;g<o;g+=1){var p=r.wtTable.columnFilter.renderedToSource(g);J>=l&&J<=u&&p>=s&&p<=f?this.settings.className&&this.addClassAtCoords(r,J,p,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,p,v):p>=s&&p<=f&&d&&this.addClassAtCoords(r,J,p,d);var b=r.getSetting("onAfterDrawSelection",J,p,this.settings.layerLevel);typeof b=="string"&&this.addClassAtCoords(r,J,p,b)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const $be=kbe;var Abe=$e,Ibe=il.findIndex,Mbe=rv,W_="findIndex",O2=!0;W_ in[]&&Array(1)[W_](function(){O2=!1});Abe({target:"Array",proto:!0,forced:O2},{findIndex:function(t){return Ibe(this,t,arguments.length>1?arguments[1]:void 0)}});Mbe(W_);var xbe="localHooks",R2={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)tp(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Kn(R2,"MIXIN_NAME",xbe,{writable:!1,enumerable:!1});const Mr=R2;function $h(e){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}function Dbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hbe(n.key),n)}}function Nbe(e,t,r){return t&&vM(e.prototype,t),r&&vM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hbe(e){var t=Lbe(e,"string");return $h(t)==="symbol"?t:String(t)}function Lbe(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fl=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Dbe(this,e),this.indexedValues=[],this.initValueOrFn=t}return Nbe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,pt(this.initValueOrFn)?Ce(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Ce(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();gt(fl,Mr);function Dw(e){return Vbe(e)||Bbe(e)||Fbe(e)||jbe()}function jbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fbe(e,t){if(e){if(typeof e=="string")return U_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U_(e,t)}}function Bbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vbe(e){if(Array.isArray(e))return U_(e)}function U_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dT(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Dw(e.slice(0,o)),Dw(r.map(function(i,a){return pt(n)?n(i,a):n})),Dw(o===void 0?[]:e.slice(o)))}function vT(e,t){return Wr(e,function(r,n){return t.includes(n)===!1})}function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function Wbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zbe(n.key),n)}}function Ube(e,t,r){return t&&yM(e.prototype,t),r&&yM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zbe(e){var t=Ybe(e,"string");return ru(t)==="symbol"?t:String(t)}function Ybe(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mc(){return typeof Reflect<"u"&&Reflect.get?Mc=Reflect.get.bind():Mc=function(t,r,n){var o=Gbe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mc.apply(this,arguments)}function Gbe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ka(e),e!==null););return e}function Kbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z_(e,t)}function z_(e,t){return z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},z_(e,t)}function qbe(e){var t=Qbe();return function(){var n=Ka(e),o;if(t){var i=Ka(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Xbe(this,o)}}function Xbe(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zbe(e)}function Zbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ka(e){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ka(e)}var Li=function(e){Kbe(r,e);var t=qbe(r);function r(){return Wbe(this,r),t.apply(this,arguments)}return Ube(r,[{key:"insert",value:function(o,i){this.indexedValues=dT(this.indexedValues,o,i,this.initValueOrFn),Mc(Ka(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=vT(this.indexedValues,o),Mc(Ka(r.prototype),"remove",this).call(this,o)}}]),r}(fl);function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function Jbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,twe(n.key),n)}}function ewe(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function twe(e){var t=rwe(e,"string");return nu(t)==="symbol"?t:String(t)}function rwe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y_(e,t)}function Y_(e,t){return Y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Y_(e,t)}function owe(e){var t=lwe();return function(){var n=Dp(e),o;if(t){var i=Dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iwe(this,o)}}function iwe(e,t){if(t&&(nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return awe(e)}function awe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dp(e){return Dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dp(e)}var Gm=function(e){nwe(r,e);var t=owe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Jbe(this,r),t.call(this,n)}return ewe(r,[{key:"getHiddenIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Li);function Nw(e){return cwe(e)||fwe(e)||uwe(e)||swe()}function swe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uwe(e,t){if(e){if(typeof e=="string")return G_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G_(e,t)}}function fwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cwe(e){if(Array.isArray(e))return G_(e)}function G_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yT(e,t,r){return[].concat(Nw(e.slice(0,t)),Nw(r),Nw(e.slice(t)))}function Ah(e,t){return Wr(e,function(r){return t.includes(r)===!1})}function gT(e,t){return We(e,function(r){return r-t.filter(function(n){return n<r}).length})}function pT(e,t){var r=t[0],n=t.length;return We(e,function(o){return o>=r?o+n:o})}function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function hwe(e){return gwe(e)||ywe(e)||vwe(e)||dwe()}function dwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vwe(e,t){if(e){if(typeof e=="string")return K_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K_(e,t)}}function ywe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gwe(e){if(Array.isArray(e))return K_(e)}function K_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T2(n.key),n)}}function mwe(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uo(){return typeof Reflect<"u"&&Reflect.get?uo=Reflect.get.bind():uo=function(t,r,n){var o=bwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},uo.apply(this,arguments)}function bwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yn(e),e!==null););return e}function wwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q_(e,t)}function q_(e,t){return q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},q_(e,t)}function Swe(e){var t=_we();return function(){var n=yn(e),o;if(t){var i=yn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Cwe(this,o)}}function Cwe(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E2(e)}function E2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _we(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yn(e){return yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yn(e)}function Owe(e,t,r){return t=T2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T2(e){var t=Rwe(e,"string");return ou(t)==="symbol"?t:String(t)}function Rwe(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Km=function(e){wwe(r,e);var t=Swe(r);function r(){var n;pwe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Owe(E2(n),"orderOfIndexes",[]),n}return mwe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=hwe(Array(o.length).keys()),uo(yn(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=Ah(this.orderOfIndexes,[o]),pt(this.initValueOrFn)?uo(yn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):uo(yn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,uo(yn(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=dT(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=pT(this.orderOfIndexes,i),uo(yn(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=vT(this.indexedValues,o),this.orderOfIndexes=Ah(this.orderOfIndexes,o),this.orderOfIndexes=gT(this.orderOfIndexes,o),uo(yn(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(fl);function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function Ewe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pwe(n.key),n)}}function Twe(e,t,r){return t&&mM(e.prototype,t),r&&mM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pwe(e){var t=kwe(e,"string");return iu(t)==="symbol"?t:String(t)}function kwe(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $we(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X_(e,t)}function X_(e,t){return X_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},X_(e,t)}function Awe(e){var t=xwe();return function(){var n=Np(e),o;if(t){var i=Np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Iwe(this,o)}}function Iwe(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mwe(e)}function Mwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Np(e)}var xv=function(e){$we(r,e);var t=Awe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Ewe(this,r),t.call(this,n)}return Twe(r,[{key:"getTrimmedIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Li),bM=new Map([["indexesSequence",{getListWithInsertedItems:yT,getListWithRemovedItems:Ah}],["physicallyIndexed",{getListWithInsertedItems:dT,getListWithRemovedItems:vT}]]),P2=function(t){if(bM.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return bM.get(t)};function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function Dwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hwe(n.key),n)}}function Nwe(e,t,r){return t&&wM(e.prototype,t),r&&wM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hwe(e){var t=Lwe(e,"string");return au(t)==="symbol"?t:String(t)}function Lwe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xc(){return typeof Reflect<"u"&&Reflect.get?xc=Reflect.get.bind():xc=function(t,r,n){var o=jwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xc.apply(this,arguments)}function jwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qa(e),e!==null););return e}function Fwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z_(e,t)}function Z_(e,t){return Z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Z_(e,t)}function Bwe(e){var t=Uwe();return function(){var n=qa(e),o;if(t){var i=qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vwe(this,o)}}function Vwe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wwe(e)}function Wwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qa(e){return qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qa(e)}var k2=function(e){Fwe(r,e);var t=Bwe(r);function r(){return Dwe(this,r),t.call(this,function(n){return n})}return Nwe(r,[{key:"insert",value:function(o,i){var a=pT(this.indexedValues,i);this.indexedValues=yT(a,o,i),xc(qa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Ah(this.indexedValues,o);this.indexedValues=gT(i,o),xc(qa(r.prototype),"remove",this).call(this,o)}}]),r}(fl),SM=new Map([["hiding",Gm],["index",fl],["linkedPhysicalIndexToValue",Km],["physicalIndexToValue",Li],["trimming",xv]]);function zwe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!SM.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(SM.get(e))(t)}function Ih(e){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ih(e)}function Ywe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kwe(n.key),n)}}function Gwe(e,t,r){return t&&CM(e.prototype,t),r&&CM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kwe(e){var t=qwe(e,"string");return Ih(t)==="symbol"?t:String(t)}function qwe(e,t){if(Ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q_=0,mT=function(){function e(){Ywe(this,e),this.collection=new Map}return Gwe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),Q_+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);ve(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),Q_-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return mt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();gt(mT,Mr);function Xwe(){return Q_}function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function Zwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jwe(n.key),n)}}function Qwe(e,t,r){return t&&_M(e.prototype,t),r&&_M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jwe(e){var t=eSe(e,"string");return lu(t)==="symbol"?t:String(t)}function eSe(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J_(e,t)}function J_(e,t){return J_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},J_(e,t)}function rSe(e){var t=iSe();return function(){var n=Hp(e),o;if(t){var i=Hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nSe(this,o)}}function nSe(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oSe(e)}function oSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hp(e){return Hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hp(e)}var OM=function(e){tSe(r,e);var t=rSe(r);function r(n,o){var i;return Zwe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return Qwe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=We(this.get(),function(c){return c.getValues()}),a=[],l=ve(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return We(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ve(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(mT);function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function aSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sSe(n.key),n)}}function lSe(e,t,r){return t&&RM(e.prototype,t),r&&RM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sSe(e){var t=uSe(e,"string");return Mh(t)==="symbol"?t:String(t)}function uSe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fSe(e,t,r){cSe(e,t),t.set(e,r)}function cSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hSe(e,t,r){var n=$2(e,t,"set");return dSe(e,n,r),r}function dSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function vSe(e,t){var r=$2(e,t,"get");return ySe(e,r)}function $2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ySe(e,t){return t.get?t.get.call(e):t.value}var Hw=new WeakMap,A2=function(){function e(){aSe(this,e),fSe(this,Hw,{writable:!0,value:[]})}return lSe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(vSe(this,Hw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){hSe(this,Hw,r)}}]),e}();gt(A2,Mr);function EM(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function gSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mSe(n.key),n)}}function pSe(e,t,r){return t&&TM(e.prototype,t),r&&TM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mSe(e){var t=bSe(e,"string");return xh(t)==="symbol"?t:String(t)}function bSe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qf(e,t,r){wSe(e,t),t.set(e,r)}function wSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(e,t){var r=I2(e,t,"get");return SSe(e,r)}function SSe(e,t){return t.get?t.get.call(e):t.value}function vy(e,t,r){var n=I2(e,t,"set");return CSe(e,n,r),r}function I2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function CSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var yy=new WeakMap,Jf=new WeakMap,gy=new WeakMap,py=new WeakMap,my=new WeakMap,_Se=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;gSe(this,e),Qf(this,yy,{writable:!0,value:new Set}),Qf(this,Jf,{writable:!0,value:[]}),Qf(this,gy,{writable:!0,value:[]}),Qf(this,py,{writable:!0,value:!1}),Qf(this,my,{writable:!0,value:!1}),vy(this,my,r??!1)}return pSe(e,[{key:"createObserver",value:function(){var r=this,n=new A2;return Kr(this,yy).add(n),n.addLocalHook("unsubscribe",function(){Kr(r,yy).delete(n)}),n._writeInitialChanges(EM(Kr(this,Jf),Kr(this,gy))),n}},{key:"emit",value:function(r){var n=Kr(this,gy);(!Kr(this,py)||Kr(this,Jf).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Kr(this,my)):vy(this,Jf,new Array(r.length).fill(Kr(this,my))),Kr(this,py)||(vy(this,py,!0),n=Kr(this,Jf)));var o=EM(n,r);Kr(this,yy).forEach(function(i){return i._write(o)}),vy(this,gy,r)}}]),e}();function Dh(e){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function Lw(e){return TSe(e)||ESe(e)||RSe(e)||OSe()}function OSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RSe(e,t){if(e){if(typeof e=="string")return eO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eO(e,t)}}function ESe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TSe(e){if(Array.isArray(e))return eO(e)}function eO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Se(n.key),n)}}function kSe(e,t,r){return t&&PM(e.prototype,t),r&&PM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Se(e){var t=ASe(e,"string");return Dh(t)==="symbol"?t:String(t)}function ASe(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tO=function(){function e(){var t=this;PSe(this,e),this.indexesSequence=new k2,this.trimmingMapsCollection=new OM(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new OM(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new mT,this.hidingChangesObservable=new _Se({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return kSe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,zwe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof xv?this.trimmingMapsCollection.register(r,n):n instanceof Gm?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ve(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ve(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ve(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ve(n)?n:null}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Lw(new Array(r).keys()),this.notHiddenIndexesCache=Lw(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=Lw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=We(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=Ah(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(yT(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ve(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=We(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();gt(tO,Mr);function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function kM(e,t){return DSe(e)||xSe(e,t)||MSe(e,t)||ISe()}function ISe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MSe(e,t){if(e){if(typeof e=="string")return $M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $M(e,t)}}function $M(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function DSe(e){if(Array.isArray(e))return e}function NSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LSe(n.key),n)}}function HSe(e,t,r){return t&&AM(e.prototype,t),r&&AM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LSe(e){var t=jSe(e,"string");return su(t)==="symbol"?t:String(t)}function jSe(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(t,r,n){var o=FSe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function FSe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function BSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function VSe(e){var t=USe();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WSe(this,o)}}function WSe(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M2(e)}function M2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function USe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}ge.getSingleton().register("modifyAutoColumnSizeSeed");var ec="autoColumnSize",zSe=10,jw=new WeakMap,YSe="autoColumnSize",GSe=function(e){BSe(r,e);var t=VSe(r);function r(n){var o;return NSe(this,r),o=t.call(this,n),jw.set(M2(o),{cachedColumnHeaders:[]}),o.ghostTable=new tT(o.hot),o.samplesGenerator=new FW(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Li,o.hot.columnIndexMapper.registerMap(YSe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return HSe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[ec]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[ec];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),ca(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),ca(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;ca(yo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Ce(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);A(h,function(d){var v=kM(d,2),y=v[0],m=v[1];return o.ghostTable.addColumn(y,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Kc(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Fm(c):(Kc(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[ec],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[ec],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ue(o)&&(i=o.syncLimit,kE(i)?i=LE(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,rT.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=jw.get(this),a=i.cachedColumnHeaders,l=Ft(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){A(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=We(o,function(l){var s=kM(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){jw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Wr(o,function(l){var s;return ve((s=l.address)===null||s===void 0?void 0:s.col)}),a=We(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),ca(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ec}},{key:"PLUGIN_PRIORITY",get:function(){return zSe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ot),ha={horizontal:"horizontal",vertical:"vertical"};function KSe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function qSe(e){var t={};return e===!0?(t.directions=Object.keys(ha),t.autoInsertRow=!0):Ue(e)?(ve(e.autoInsertRow)?e.direction===ha.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ve(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(ha)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function XSe(e){return JSe(e)||QSe(e)||x2(e)||ZSe()}function ZSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JSe(e){if(Array.isArray(e))return nO(e)}function eCe(e,t){return nCe(e)||rCe(e,t)||x2(e,t)||tCe()}function tCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x2(e,t){if(e){if(typeof e=="string")return nO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nO(e,t)}}function nO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function nCe(e){if(Array.isArray(e))return e}function oCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aCe(n.key),n)}}function iCe(e,t,r){return t&&IM(e.prototype,t),r&&IM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aCe(e){var t=lCe(e,"string");return uu(t)==="symbol"?t:String(t)}function lCe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=sCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function sCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function uCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function fCe(e){var t=hCe();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cCe(this,o)}}function cCe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D2(e)}function D2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");var MM="autofill",dCe=20,vCe=["fillHandle"],yCe="insert_row_below",gCe=200,pCe=function(e){uCe(r,e);var t=fCe(r);function r(n){var o;return oCe(this,r),o=t.call(this,n),o.eventManager=new Pt(D2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return iCe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),da(go(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),da(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),da(go(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],y=[];return A(h,function(m){for(var w=m.startRow;w<=m.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var C=m.startCol;C<=m.endCol;C+=1)v.indexOf(C)===-1&&v.push(C)}),A(d,function(m){var w=[];A(v,function(C){w.push(o.hot.getCopyableData(m,C))}),y.push(w)}),y}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=eCe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),m=KSe(v,y,function(we,$){return o.hot._createCellCoords(we,$)}),w=m.directionOfDrag,C=m.startOfDragCoords,S=m.endOfDragCoords;if(C&&C.row>-1&&C.col>-1){var R=this.getSelectionData(),O=c.clone(),j=this.hot._createCellRange(C,C,S),U=this.hot.runHooks("beforeAutofill",R,O,j,w);if(U===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var q=U,G=U;if(["up","left"].indexOf(w)>-1&&!(G.length===1&&G[0].length===0))if(q=[],w==="up")for(var X=S.row-C.row+1,Q=X%G.length,oe=0;oe<X;oe++)q.push(G[(oe+(G.length-Q))%G.length]);else for(var J=S.col-C.col+1,ue=J%G[0].length,he=0;he<G.length;he++){q.push([]);for(var Oe=0;Oe<J;Oe++)q[he].push(G[he][(Oe+(G[he].length-ue))%G[he].length])}this.hot.populateFromArray(C.row,C.col,q,S.row,S.col,"".concat(this.pluginName,".fill"),null),this.setSelection(y),this.hot.runHooks("afterAutofill",q,O,j,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(ha.vertical)&&this.directions.includes(ha.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(ha.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(ha.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(yCe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},gCe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,XSe(We(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Ut(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Tt(this.hot.table),l=Ut(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+ct(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=qSe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){da(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MM}},{key:"PLUGIN_PRIORITY",get:function(){return dCe}},{key:"SETTING_KEYS",get:function(){return[MM].concat(vCe)}}]),r}(ot);function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function mCe(e,t){return CCe(e)||SCe(e,t)||wCe(e,t)||bCe()}function bCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wCe(e,t){if(e){if(typeof e=="string")return xM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xM(e,t)}}function xM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function CCe(e){if(Array.isArray(e))return e}function _Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RCe(n.key),n)}}function OCe(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RCe(e){var t=ECe(e,"string");return fu(t)==="symbol"?t:String(t)}function ECe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return typeof Reflect<"u"&&Reflect.get?ns=Reflect.get.bind():ns=function(t,r,n){var o=TCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ns.apply(this,arguments)}function TCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function PCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iO(e,t)}function iO(e,t){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iO(e,t)}function kCe(e){var t=ICe();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $Ce(this,o)}}function $Ce(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ACe(e)}function ACe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ICe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}var by="autoRowSize",MCe=40,xCe="autoRowSize",DCe=function(e){PCe(r,e);var t=kCe(r);function r(n){var o;return _Ce(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new tT(o.hot),o.samplesGenerator=new FW(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Li,o.hot.rowIndexMapper.registerMap(xCe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return OCe(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[by];return o===!0||Ue(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),ns(wi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,ns(wi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Ce(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);A(h,function(d){var v=mCe(d,2),y=v[0],m=v[1];return o.ghostTable.addRow(y,m)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){Kc(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Fm(c):(Kc(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[by],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){ps(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[by],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ue(o)&&(i=o.syncLimit,kE(i)?i=LE(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){Ce(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),ns(wi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return by}},{key:"PLUGIN_PRIORITY",get:function(){return MCe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ot);function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function NCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LCe(n.key),n)}}function HCe(e,t,r){return t&&NM(e.prototype,t),r&&NM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LCe(e){var t=jCe(e,"string");return cu(t)==="symbol"?t:String(t)}function jCe(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dc(){return typeof Reflect<"u"&&Reflect.get?Dc=Reflect.get.bind():Dc=function(t,r,n){var o=FCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dc.apply(this,arguments)}function FCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xa(e),e!==null););return e}function BCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function VCe(e){var t=zCe();return function(){var n=Xa(e),o;if(t){var i=Xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return WCe(this,o)}}function WCe(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UCe(e)}function UCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xa(e){return Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xa(e)}var N2=P2("physicallyIndexed"),YCe=N2.getListWithInsertedItems,GCe=N2.getListWithRemovedItems,KCe=function(e){BCe(r,e);var t=VCe(r);function r(){return NCe(this,r),t.call(this,function(n){return n})}return HCe(r,[{key:"insert",value:function(o,i){var a=pT(this.indexedValues,i);this.indexedValues=YCe(a,o,i,this.initValueOrFn),Dc(Xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=GCe(this.indexedValues,o);this.indexedValues=gT(i,o),Dc(Xa(r.prototype),"remove",this).call(this,o)}}]),r}(fl);const qCe=KCe;function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function XCe(e){return e_e(e)||JCe(e)||QCe(e)||ZCe()}function ZCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QCe(e,t){if(e){if(typeof e=="string")return lO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lO(e,t)}}function JCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function e_e(e){if(Array.isArray(e))return lO(e)}function lO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n_e(n.key),n)}}function r_e(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n_e(e){var t=o_e(e,"string");return hu(t)==="symbol"?t:String(t)}function o_e(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nc(){return typeof Reflect<"u"&&Reflect.get?Nc=Reflect.get.bind():Nc=function(t,r,n){var o=i_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Nc.apply(this,arguments)}function i_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Za(e),e!==null););return e}function a_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sO(e,t)}function l_e(e){var t=f_e();return function(){var n=Za(e),o;if(t){var i=Za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return s_e(this,o)}}function s_e(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u_e(e)}function u_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Za(e){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Za(e)}var H2=P2("physicallyIndexed"),c_e=H2.getListWithInsertedItems,h_e=H2.getListWithRemovedItems,d_e=function(e){a_e(r,e);var t=l_e(r);function r(){return t_e(this,r),t.call(this,function(n){return n})}return r_e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=c_e(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),Nc(Za(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=h_e(this.indexedValues,o),Nc(Za(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,XCe(this.getValues()))+1+o}}]),r}(fl);const v_e=d_e;function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function y_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p_e(n.key),n)}}function g_e(e,t,r){return t&&LM(e.prototype,t),r&&LM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p_e(e){var t=m_e(e,"string");return du(t)==="symbol"?t:String(t)}function m_e(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function os(){return typeof Reflect<"u"&&Reflect.get?os=Reflect.get.bind():os=function(t,r,n){var o=b_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},os.apply(this,arguments)}function b_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Si(e),e!==null););return e}function w_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function S_e(e){var t=O_e();return function(){var n=Si(e),o;if(t){var i=Si(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return C_e(this,o)}}function C_e(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return __e(e)}function __e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Si(e)}var Fw="bindRowsWithHeaders",R_e=210,E_e="loose",T_e=new Map([["loose",qCe],["strict",v_e]]),P_e=function(e){w_e(r,e);var t=S_e(r);function r(n){var o;return y_e(this,r),o=t.call(this,n),o.headerIndexes=null,o}return g_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Fw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Fw];typeof i!="string"&&(i=E_e);var a=T_e.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),os(Si(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),os(Si(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){os(Si(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Fw}},{key:"PLUGIN_PRIORITY",get:function(){return R_e}}]),r}(ot);function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function jM(e){return I_e(e)||A_e(e)||$_e(e)||k_e()}function k_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $_e(e,t){if(e){if(typeof e=="string")return fO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fO(e,t)}}function A_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function I_e(e){if(Array.isArray(e))return fO(e)}function fO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function M_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L2(n.key),n)}}function x_e(e,t,r){return t&&FM(e.prototype,t),r&&FM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,r,n){var o=D_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function D_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function N_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cO(e,t)}function cO(e,t){return cO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},cO(e,t)}function H_e(e){var t=j_e();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return L_e(this,o)}}function L_e(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zl(e)}function zl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function F_e(e,t,r){B_e(e,t),t.set(e,r)}function B_e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bw(e,t,r){return t=L2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L2(e){var t=V_e(e,"string");return vu(t)==="symbol"?t:String(t)}function V_e(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BM(e,t){var r=j2(e,t,"get");return W_e(e,r)}function W_e(e,t){return t.get?t.get.call(e):t.value}function Vw(e,t,r){var n=j2(e,t,"set");return U_e(e,n,r),r}function j2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function U_e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ww="collapsibleColumns",z_e=290,Y_e=["nestedHeaders"],Sl="collapsibleIndicator",VM=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Cl=new WeakMap,G_e=function(e){N_e(r,e);var t=H_e(r);function r(){var n;M_e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Bw(zl(n),"nestedHeadersPlugin",null),Bw(zl(n),"eventManager",new Pt(zl(n))),Bw(zl(n),"headerStateManager",null),F_e(zl(n),Cl,{writable:!0,value:null}),n}return x_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ww]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||bt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Vw(this,Cl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),va(po(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}va(po(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Vw(this,Cl,null),this.nestedHeadersPlugin=null,this.clearButtons(),va(po(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};Ce(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;Ce(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(Sl));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(Sl)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(Sl)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!VM.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Wr(o,function(m){var w=m.row;return w<0}),s=l.length>0;A(l,function(m){var w,C=m.row,S=m.col,R=(w=a.headerStateManager.getHeaderSettings(C,S))!==null&&w!==void 0?w:{},O=R.collapsible,j=R.isCollapsed;if(!O||j&&i==="collapse"||!j&&i==="expand")return s=!1,!1});var u=[],f=[];s&&A(l,function(m){var w=m.row,C=m.col,S=a.headerStateManager.triggerNodeModification(i,w,C),R=S.colspanCompensation,O=S.affectedColumns,j=S.rollbackModification;R>0&&(f.push.apply(f,jM(O)),u.push(j))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=wE([].concat(jM(c),f)):i==="expand"&&(h=Wr(c,function(m){return!f.includes(m)}));var d=VM.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){A(u,function(m){m()});return}this.hot.batchExecution(function(){A(f,function(m){BM(a,Cl).setValueAtIndex(a.hot.toPhysicalColumn(m),d.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return BM(this,Cl).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(Sl));if(h)d||(d=this.hot.rootDocument.createElement("div"),te(d,Sl),i.querySelector("div:first-child").appendChild(d)),Le(d,["collapsed","expanded"]),c?(te(d,"collapsed"),Ai(d,"+")):(te(d,"expanded"),Ai(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,Sl)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),wn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Vw(this,Cl,null),va(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ww}},{key:"PLUGIN_PRIORITY",get:function(){return z_e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Ww].concat(Y_e)}}]),r}(ot),K_e=$e,q_e=Gt,X_e=Dj,Z_e=zr,Q_e=zn,J_e=Rf;K_e({target:"Object",stat:!0,sham:!q_e},{getOwnPropertyDescriptors:function(t){for(var r=Z_e(t),n=Q_e.f,o=X_e(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&J_e(i,l,s);return i}});var WM=Gt,eOe=Ye,tOe=Zt,rOe=je,Uw=tv,nOe=lv,oOe=iv,iOe=Ir,aOe=Xd,_l=Object.assign,UM=Object.defineProperty,lOe=eOe([].concat),sOe=!_l||rOe(function(){if(WM&&_l({b:1},_l(UM({},"a",{enumerable:!0,get:function(){UM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),_l({},e)[r]!=7||Uw(_l({},t)).join("")!=n})?function(t,r){for(var n=iOe(t),o=arguments.length,i=1,a=nOe.f,l=oOe.f;o>i;)for(var s=aOe(arguments[i++]),u=a?lOe(Uw(s),a(s)):Uw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!WM||tOe(l,s,h))&&(n[h]=s[h]);return n}:_l,uOe=$e,zM=sOe;uOe({target:"Object",stat:!0,arity:2,forced:Object.assign!==zM},{assign:zM});function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function YM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function fOe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YM(Object(r),!0).forEach(function(n){cOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cOe(e,t,r){return t=F2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GM(e,t){return yOe(e)||vOe(e,t)||dOe(e,t)||hOe()}function hOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dOe(e,t){if(e){if(typeof e=="string")return KM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KM(e,t)}}function KM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yOe(e){if(Array.isArray(e))return e}function gOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F2(n.key),n)}}function pOe(e,t,r){return t&&qM(e.prototype,t),r&&qM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F2(e){var t=mOe(e,"string");return Nh(t)==="symbol"?t:String(t)}function mOe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bOe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],wOe=!1,SOe=!0,COe=!0,_Oe=function(){function e(t,r){gOe(this,e),this.hot=t,this.sortingStates=new Km,this.sortEmptyCells=wOe,this.indicator=SOe,this.headerAction=COe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return pOe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ue(r)&&ze(r,function(o,i){bOe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=GM(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ue(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=GM(o,2),a=i[0],l=i[1];return fOe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ve(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Lp="asc",jp="desc",OOe="colHeader";function ROe(e){if(Ue(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Lp,jp].includes(r)}function EOe(e){if(e.some(function(r){return ROe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function XM(e){if(e!==jp)return e===Lp?jp:Lp}function ZM(e){var t=e.querySelector(".".concat(OOe));return t}function QM(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function hO(e,t,r){return e===-1&&t>=0&&$i(r)===!1}var TOe="ascending",POe="descending",B2="indicatorDisabled",V2="columnSorting",W2="sortAction",U2=new Map([[Lp,TOe],[jp,POe]]);function kOe(e,t,r,n){var o=[V2];if(n&&o.push(W2),r===!1)return o.push(B2),o;var i=e.getSortOrderOfColumn(t);return ve(i)&&o.push(U2.get(i)),o}function $Oe(){return Array.from(U2.values()).concat(W2,B2,V2)}function z2(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Vn:Xt(o)?Xt(i)?Vn:a&&e==="asc"?It:Mt:Xt(i)?a&&e==="asc"?Mt:It:isNaN(o)&&!isNaN(i)?e==="asc"?Mt:It:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?It:Mt:o>i?e==="asc"?Mt:It:Vn}}var Y2="default";function AOe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Vn;if(l){if(Xt(n))return e==="asc"?It:Mt;if(Xt(o))return e==="asc"?Mt:It}return isNaN(i)?Mt:isNaN(a)?It:i<a?e==="asc"?It:Mt:i>a?e==="asc"?Mt:It:Vn}}var IOe="numeric";function MOe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=Xt(a),u=Xt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return Mt;if(s===!1&&u)return It}return h===!1&&d?e==="asc"?It:Mt:h&&d===!1?e==="asc"?Mt:It:h===!1&&d===!1?z2(e,t,r)(a,l):f===o&&c===n?e==="asc"?It:Mt:f===n&&c===o?e==="asc"?Mt:It:Vn}}var xOe="checkbox";function DOe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Vn;if(Xt(n))return Xt(o)?Vn:i&&e==="asc"?It:Mt;if(Xt(o))return i&&e==="asc"?Mt:It;var a=t.dateFormat,l=ee(n,a),s=ee(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?It:Mt:s.isBefore(l)?e==="asc"?Mt:It:Vn:It:Mt}}var NOe="date",bT=on("sorting.compareFunctionFactory"),qm=bT.register,JM=bT.getItem,HOe=bT.hasItem,G2=on("sorting.mainSortComparator"),K2=G2.register,LOe=G2.getItem;function q2(e){return HOe(e)?JM(e):JM(Y2)}qm(IOe,AOe);qm(xOe,MOe);qm(NOe,DOe);qm(Y2,z2);var Vn=0,It=-1,Mt=1;function jOe(e,t){for(var r=LOe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function ex(e){return WOe(e)||VOe(e)||BOe(e)||FOe()}function FOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BOe(e,t){if(e){if(typeof e=="string")return tx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tx(e,t)}}function tx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WOe(e){if(Array.isArray(e))return e}function UOe(e,t){return function(r,n){var o=ex(r),i=o.slice(1),a=ex(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:q2(c.type),m=y(f,c,v)(h,d);return m}(0)}}function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}var zOe=["column"],YOe=["column"];function Ol(e){return XOe(e)||qOe(e)||KOe(e)||GOe()}function GOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KOe(e,t){if(e){if(typeof e=="string")return dO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dO(e,t)}}function qOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XOe(e){if(Array.isArray(e))return dO(e)}function dO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rx(Object(r),!0).forEach(function(n){ZOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZOe(e,t,r){return t=X2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ox(e,t){if(e==null)return{};var r=QOe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function QOe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function JOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ix(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X2(n.key),n)}}function eRe(e,t,r){return t&&ix(e.prototype,t),r&&ix(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X2(e){var t=tRe(e,"string");return yu(t)==="symbol"?t:String(t)}function tRe(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=rRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function rRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function nRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vO(e,t)}function vO(e,t){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vO(e,t)}function oRe(e){var t=lRe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iRe(this,o)}}function iRe(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aRe(e)}function aRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}var yO="columnSorting",sRe=50,ax="append",uRe="replace";K2(yO,UOe);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var Z2=function(e){nRe(r,e);var t=oRe(r);function r(n){var o;return JOe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=yO,o.indexesSequenceCache=null,o}return eRe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new _Oe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Li(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),ya(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=ZM(s);QM(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,ya(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new k2),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ve(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return EOe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=ox(u,zOe);return nx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=We(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=ox(u,YOe);return nx({column:o.hot.toVisualColumn(f)},c)};return ve(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=We(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ve(i)){var a=XM(i);return ve(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:XM()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ax,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(mt(u))return[].concat(Ol(s.slice(0,a)),Ol(s.slice(a+1)));if(i===ax)return[].concat(Ol(s.slice(0,a)),Ol(s.slice(a+1)),[u]);if(i===uRe)return[].concat(Ol(s.slice(0,a)),[u],Ol(s.slice(a+1)))}return ve(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ue(o)){var i=o[this.pluginKey];if(Ue(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):pt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(m){return We(o,function(w){return i.hot.getDataAtCell(m,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=We(a,function(y){return y[0]});jOe(a,this.pluginKey,We(o,function(y){return y.sortOrder}),We(o,function(y){return i.getFirstCellSettings(y.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=We(a,function(y){return y[0]}),d=new Map(We(f,function(y,m){return[y,h[m]]})),v=We(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return d.has(y)?d.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ue(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ue(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ue(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=ZM(i);if(!(QM(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(Le(o,$Oe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];te(o,kOe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){ya(mo(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ve(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){hO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){hO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),ya(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yO}},{key:"PLUGIN_PRIORITY",get:function(){return sRe}}]),r}(ot),fRe=$e,wT=Ye,cRe=Ni,hRe=eB,dRe=q0,lx=je,vRe=RangeError,Q2=String,J2=Math.floor,gO=wT(dRe),sx=wT("".slice),tc=wT(1 .toFixed),Zl=function(e,t,r){return t===0?r:t%2===1?Zl(e,t-1,r*e):Zl(e*e,t/2,r)},yRe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},Rl=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=J2(o/1e7)},zw=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=J2(n/t),n=n%t*1e7},ux=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=Q2(e[t]);r=r===""?n:r+gO("0",7-n.length)+n}return r},gRe=lx(function(){return tc(8e-5,3)!=="0.000"||tc(.9,0)!=="1"||tc(1.255,2)!=="1.25"||tc(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!lx(function(){tc({})});fRe({target:"Number",proto:!0,forced:gRe},{toFixed:function(t){var r=hRe(this),n=cRe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw vRe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return Q2(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=yRe(r*Zl(2,69,1))-69,s=l<0?r*Zl(2,-l,1):r/Zl(2,l,1),s*=4503599627370496,l=52-l,l>0){for(Rl(o,0,s),u=n;u>=7;)Rl(o,1e7,0),u-=7;for(Rl(o,Zl(10,u,1),0),u=l-1;u>=23;)zw(o,1<<23),u-=23;zw(o,1<<u),Rl(o,1,1),zw(o,2),a=ux(o)}else Rl(o,0,s),Rl(o,1<<-l,0),a=ux(o)+gO("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+gO("0",n-f)+a:sx(a,0,f-n)+"."+sx(a,f-n))):a=i+a,a}});function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function pRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bRe(n.key),n)}}function mRe(e,t,r){return t&&fx(e.prototype,t),r&&fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bRe(e){var t=wRe(e,"string");return Hh(t)==="symbol"?t:String(t)}function wRe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SRe=function(){function e(t,r){pRe(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return mRe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),A(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();A(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function y(){return l.hot.removeHook("beforeViewRender",y),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;A(h,function(y){f==="row"&&y.destinationRow>=v&&(y.alterRowOffset=c*o),f==="col"&&y.destinationColumn>=v&&(y.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?A(h,function(y){l.extendEndpointRanges(y,v,i[0],i.length),l.recreatePhysicalRanges(y),l.clearOffsetInformation(y)}):A(h,function(y){l.shiftEndpointCoordinates(y,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){A(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];A(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),A(a,function(l){var s=[];A(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,A(r.ranges,function(o){A(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],A(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],A(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],A(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&A(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),A(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){bt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const CRe=SRe;function Yw(e){return e==null||isNaN(e)}function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}var cx;function _Re(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ORe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ERe(n.key),n)}}function RRe(e,t,r){return t&&hx(e.prototype,t),r&&hx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ERe(e){var t=TRe(e,"string");return gu(t)==="symbol"?t:String(t)}function TRe(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _g(){return typeof Reflect<"u"&&Reflect.get?_g=Reflect.get.bind():_g=function(t,r,n){var o=PRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_g.apply(this,arguments)}function PRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pu(e),e!==null););return e}function kRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pO(e,t)}function pO(e,t){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},pO(e,t)}function $Re(e){var t=MRe();return function(){var n=pu(e),o;if(t){var i=pu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ARe(this,o)}}function ARe(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IRe(e)}function IRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pu(e){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pu(e)}var Gw="columnSummary",xRe=220,DRe=function(e){kRe(r,e);var t=$Re(r);function r(n){var o;return ORe(this,r),o=t.call(this,n),o.endpoints=null,o}return RRe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[Gw],this.endpoints=new CRe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),_g(pu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return ze(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Yw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return ze(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Yw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Yw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return ze(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(dt(cx||(cx=_Re(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return Gw}},{key:"PLUGIN_PRIORITY",get:function(){return xRe}}]),r}(ot);function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function NRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LRe(n.key),n)}}function HRe(e,t,r){return t&&dx(e.prototype,t),r&&dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LRe(e){var t=jRe(e,"string");return Lh(t)==="symbol"?t:String(t)}function jRe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FRe=function(){function e(t,r){NRe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return HRe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ct(this.getInputElement()),height:Tt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(r,e.CLASS_EDITOR),te(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const BRe=FRe;var qe="---------";function VRe(){return{name:qe}}function WRe(e){return We(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function wy(e){return xe(e,"htSeparator")}function URe(e){return xe(e,"htSubmenu")}function Sy(e){return xe(e,"htDisabled")}function Cy(e){return xe(e,"htSelectionDisabled")}function cl(e){var t=e.getSelected();return!t||t[0]<0?null:t}function zRe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function YRe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Ki(e,t){var r={};return A(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function si(e,t,r,n,o){A(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&GRe(a,l,t,r,n,o)})})}function GRe(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=zRe(a.className,n):l=YRe(a.className,n)),i(e,t,"className",l)}function jn(e,t){var r=!1;return Array.isArray(e)&&A(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function lo(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function KRe(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function eU(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function qRe(e,t){var r=e.slice(0);return r.reverse(),r=eU(r,t),r.reverse(),r}function XRe(e){var t=[];return A(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function ZRe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,r=e.slice(0);return r=eU(r,t),r=qRe(r,t),r=XRe(r),r}function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function QRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e0e(n.key),n)}}function JRe(e,t,r){return t&&vx(e.prototype,t),r&&vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e0e(e){var t=t0e(e,"string");return jh(t)==="symbol"?t:String(t)}function t0e(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r0e=250,n0e=250,tU=function(){function e(t){QRe(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return JRe(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},n0e)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r0e;this.showDebounced=NE(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();gt(tU,Mr);const o0e=tU;var rU="ContextMenu:items",Fe=rU,ST="".concat(Fe,".noItems"),CT="".concat(Fe,".insertRowAbove"),_T="".concat(Fe,".insertRowBelow"),OT="".concat(Fe,".insertColumnOnTheLeft"),RT="".concat(Fe,".insertColumnOnTheRight"),ET="".concat(Fe,".removeRow"),TT="".concat(Fe,".removeColumn"),PT="".concat(Fe,".undo"),kT="".concat(Fe,".redo"),$T="".concat(Fe,".readOnly"),AT="".concat(Fe,".clearColumn"),IT="".concat(Fe,".copy"),MT="".concat(Fe,".copyWithHeaders"),xT="".concat(Fe,".copyWithGroupHeaders"),DT="".concat(Fe,".copyHeadersOnly"),NT="".concat(Fe,".cut"),HT="".concat(Fe,".freezeColumn"),LT="".concat(Fe,".unfreezeColumn"),jT="".concat(Fe,".mergeCells"),FT="".concat(Fe,".unmergeCells"),BT="".concat(Fe,".addComment"),VT="".concat(Fe,".editComment"),WT="".concat(Fe,".removeComment"),UT="".concat(Fe,".readOnlyComment"),zT="".concat(Fe,".align"),YT="".concat(Fe,".align.left"),GT="".concat(Fe,".align.center"),KT="".concat(Fe,".align.right"),qT="".concat(Fe,".align.justify"),XT="".concat(Fe,".align.top"),ZT="".concat(Fe,".align.middle"),QT="".concat(Fe,".align.bottom"),JT="".concat(Fe,".borders"),eP="".concat(Fe,".borders.top"),tP="".concat(Fe,".borders.right"),rP="".concat(Fe,".borders.bottom"),nP="".concat(Fe,".borders.left"),oP="".concat(Fe,".borders.remove"),iP="".concat(Fe,".nestedHeaders.insertChildRow"),aP="".concat(Fe,".nestedHeaders.detachFromParent"),lP="".concat(Fe,".hideColumn"),sP="".concat(Fe,".showColumn"),uP="".concat(Fe,".hideRow"),fP="".concat(Fe,".showRow"),Or="Filters:",Ht="".concat(Or,"conditions"),Xm="".concat(Ht,".none"),cP="".concat(Ht,".isEmpty"),hP="".concat(Ht,".isNotEmpty"),dP="".concat(Ht,".isEqualTo"),vP="".concat(Ht,".isNotEqualTo"),yP="".concat(Ht,".beginsWith"),gP="".concat(Ht,".endsWith"),pP="".concat(Ht,".contains"),mP="".concat(Ht,".doesNotContain"),i0e="".concat(Ht,".byValue"),bP="".concat(Ht,".greaterThan"),wP="".concat(Ht,".greaterThanOrEqualTo"),SP="".concat(Ht,".lessThan"),CP="".concat(Ht,".lessThanOrEqualTo"),_P="".concat(Ht,".isBetween"),OP="".concat(Ht,".isNotBetween"),RP="".concat(Ht,".after"),EP="".concat(Ht,".before"),TP="".concat(Ht,".today"),PP="".concat(Ht,".tomorrow"),kP="".concat(Ht,".yesterday"),$P="".concat(Or,"labels.filterByCondition"),AP="".concat(Or,"labels.filterByValue"),IP="".concat(Or,"labels.conjunction"),Zm="".concat(Or,"labels.disjunction"),Fp="".concat(Or,"values.blankCells"),MP="".concat(Or,"buttons.selectAll"),xP="".concat(Or,"buttons.clear"),DP="".concat(Or,"buttons.ok"),NP="".concat(Or,"buttons.cancel"),HP="".concat(Or,"buttons.placeholder.search"),LP="".concat(Or,"buttons.placeholder.value"),jP="".concat(Or,"buttons.placeholder.secondValue");const a0e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:BT,CONTEXTMENU_ITEMS_ALIGNMENT:zT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:QT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:GT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:qT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:YT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:ZT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:KT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:XT,CONTEXTMENU_ITEMS_BORDERS:JT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:rP,CONTEXTMENU_ITEMS_BORDERS_LEFT:nP,CONTEXTMENU_ITEMS_BORDERS_RIGHT:tP,CONTEXTMENU_ITEMS_BORDERS_TOP:eP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:AT,CONTEXTMENU_ITEMS_COPY:IT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:DT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:xT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:MT,CONTEXTMENU_ITEMS_CUT:NT,CONTEXTMENU_ITEMS_EDIT_COMMENT:VT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:HT,CONTEXTMENU_ITEMS_HIDE_COLUMN:lP,CONTEXTMENU_ITEMS_HIDE_ROW:uP,CONTEXTMENU_ITEMS_INSERT_LEFT:OT,CONTEXTMENU_ITEMS_INSERT_RIGHT:RT,CONTEXTMENU_ITEMS_MERGE_CELLS:jT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:aP,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:iP,CONTEXTMENU_ITEMS_NO_ITEMS:ST,CONTEXTMENU_ITEMS_READ_ONLY:$T,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:UT,CONTEXTMENU_ITEMS_REDO:kT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:oP,CONTEXTMENU_ITEMS_REMOVE_COLUMN:TT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:WT,CONTEXTMENU_ITEMS_REMOVE_ROW:ET,CONTEXTMENU_ITEMS_ROW_ABOVE:CT,CONTEXTMENU_ITEMS_ROW_BELOW:_T,CONTEXTMENU_ITEMS_SHOW_COLUMN:sP,CONTEXTMENU_ITEMS_SHOW_ROW:fP,CONTEXTMENU_ITEMS_UNDO:PT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:LT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:FT,CONTEXT_MENU_ITEMS_NAMESPACE:rU,FILTERS_BUTTONS_CANCEL:NP,FILTERS_BUTTONS_CLEAR:xP,FILTERS_BUTTONS_OK:DP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:HP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:jP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:LP,FILTERS_BUTTONS_SELECT_ALL:MP,FILTERS_CONDITIONS_AFTER:RP,FILTERS_CONDITIONS_BEFORE:EP,FILTERS_CONDITIONS_BEGINS_WITH:yP,FILTERS_CONDITIONS_BETWEEN:_P,FILTERS_CONDITIONS_BY_VALUE:i0e,FILTERS_CONDITIONS_CONTAINS:pP,FILTERS_CONDITIONS_EMPTY:cP,FILTERS_CONDITIONS_ENDS_WITH:gP,FILTERS_CONDITIONS_EQUAL:dP,FILTERS_CONDITIONS_GREATER_THAN:bP,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:wP,FILTERS_CONDITIONS_LESS_THAN:SP,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:CP,FILTERS_CONDITIONS_NAMESPACE:Ht,FILTERS_CONDITIONS_NONE:Xm,FILTERS_CONDITIONS_NOT_BETWEEN:OP,FILTERS_CONDITIONS_NOT_CONTAIN:mP,FILTERS_CONDITIONS_NOT_EMPTY:hP,FILTERS_CONDITIONS_NOT_EQUAL:vP,FILTERS_CONDITIONS_TODAY:TP,FILTERS_CONDITIONS_TOMORROW:PP,FILTERS_CONDITIONS_YESTERDAY:kP,FILTERS_DIVS_FILTER_BY_CONDITION:$P,FILTERS_DIVS_FILTER_BY_VALUE:AP,FILTERS_LABELS_CONJUNCTION:IP,FILTERS_LABELS_DISJUNCTION:Zm,FILTERS_NAMESPACE:Or,FILTERS_VALUES_BLANK_CELLS:Fp},Symbol.toStringTag,{value:"Module"}));function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}function Kw(e,t,r){return t=nU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nU(n.key),n)}}function s0e(e,t,r){return t&&yx(e.prototype,t),r&&yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nU(e){var t=u0e(e,"string");return mu(t)==="symbol"?t:String(t)}function u0e(e,t){if(mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=f0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function f0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function c0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mO(e,t)}function mO(e,t){return mO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mO(e,t)}function h0e(e){var t=v0e();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return d0e(this,o)}}function d0e(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oU(e)}function oU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var qw="comments",y0e=60,_y=new WeakMap,kn="comment",El="value",gx="style",Oy="readOnly",g0e=function(e){c0e(r,e);var t=h0e(r);function r(n){var o;return l0e(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,_y.set(oU(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return s0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new BRe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Pt(this)),this.displaySwitch||(this.displaySwitch=new o0e(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),ga(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ga(bo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ga(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=pi(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&pi(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,Kw({},El,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,kn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,El)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,El)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[kn]?l[kn][El]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),y=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var m=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var C=this.hot,S=C.rootWindow,R=C.view._wt,O=R.wtTable,j=R.getCell({row:d,col:v},!0),U=this.getCommentMeta(c,h,gx);U?this.editor.setSize(U.width,U.height):this.editor.resetSize();var q=w?0:O.getStretchedColumnWidth(v),G=y&&!m?Tt(j):0,X=j.getBoundingClientRect(),Q=X.left,oe=X.top,J=X.width,ue=X.height,he=this.editor.getSize(),Oe=he.width,we=he.height,$=this.hot.rootWindow,k=$.innerWidth,g=$.innerHeight,p=this.hot.rootDocument.documentElement,b=Q+S.scrollX+q,T=oe+S.scrollY+G;this.hot.isRtl()&&(b-=Oe+q),this.hot.isLtr()&&Q+J+Oe>k?b=Q+S.scrollX-Oe-1:this.hot.isRtl()&&b<-(p.scrollWidth-p.clientWidth)&&(b=Q+S.scrollX+q+1),oe+we>g&&(T-=we-ue+1),this.editor.setPosition(b,T),this.editor.setReadOnlyState(this.getCommentMeta(c,h,Oy))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,El)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[kn],s;l?(s=fr(l),_v(s,a)):s=a,this.hot.setCellMeta(o,i,kn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[kn])return l[kn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=pi(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=_y.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else mi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[kn]&&i[kn][El]&&te(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=_y.get(this);i.tempEditorDimensions={width:ct(o.target),height:Tt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=_y.get(this),a=ct(o.target),l=Tt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Kw({},gx,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,Oy);o.updateCommentMeta(a,l,Kw({},Oy,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(VT):i.hot.getTranslatedPhrase(BT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(WT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(UT),f=jn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[kn];if(d&&(d=d[Oy]),d)return!0});return f&&(u=lo(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[qw];if(Ue(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ga(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return qw}},{key:"PLUGIN_PRIORITY",get:function(){return y0e}}]),r}(ot);function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function p0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function px(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b0e(n.key),n)}}function m0e(e,t,r){return t&&px(e.prototype,t),r&&px(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b0e(e){var t=w0e(e,"string");return Fh(t)==="symbol"?t:String(t)}function w0e(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S0e=function(){function e(t){p0e(this,e),this.hot=t,this.commands={},this.commonCallback=null}return m0e(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=C0e(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!xt(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),A(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function C0e(e,t){var r;return A(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const iU=S0e;var Xr="alignment";function _0e(){return{key:Xr,name:function(){return this.getTranslatedPhrase(zT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Xr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(YT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(GT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(KT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(qT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:qe},{key:"".concat(Xr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(XT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(ZT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(QT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var Qm="clear_column";function O0e(){return{key:Qm,name:function(){return this.getTranslatedPhrase(AT)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=cl(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var Dv="col_left";function R0e(){return{key:Dv,name:function(){return this.getTranslatedPhrase(OT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=cl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Nv="col_right";function E0e(){return{key:Nv,name:function(){return this.getTranslatedPhrase(RT)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=cl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Hv="make_read_only";function T0e(){return{key:Hv,name:function(){var t=this,r=this.getTranslatedPhrase($T),n=jn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jn(r,function(o,i){return t.getCellMeta(o,i).readOnly});A(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Jm="redo";function P0e(){return{key:Jm,name:function(){return this.getTranslatedPhrase(kT)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function aU(e,t){return I0e(e)||A0e(e,t)||$0e(e,t)||k0e()}function k0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $0e(e,t){if(e){if(typeof e=="string")return mx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mx(e,t)}}function mx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function I0e(e){if(Array.isArray(e))return e}function bO(e){"@babel/helpers - typeof";return bO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bO(e)}var eb=0,tb=1,lU=2,FP=3,M0e=[FP,lU],x0e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Xw=Symbol("root"),bx=Symbol("child");function bu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xw;if(t!==Xw&&t!==bx)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Xw,o=eb;if(r){var i=e[0];if(e.length===0)o=tb;else if(n&&i instanceof nT)o=FP;else if(n&&Array.isArray(i))o=bu(i,bx);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!x0e[s].includes(bO(l))});a&&(o=lU)}}return o}function Bh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!M0e.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===FP,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),mt(u)&&(u=l),mt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function D0e(e){var t=bu(e);if(t===eb||t===tb)return[];var r=Bh(t),n=new Set;A(e,function(a){var l=r(a),s=aU(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function N0e(e){var t=bu(e);if(t===eb||t===tb)return[];var r=Bh(t),n=new Set;A(e,function(a){var l=r(a),s=aU(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Zo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function H0e(e,t){return B0e(e)||F0e(e,t)||j0e(e,t)||L0e()}function L0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j0e(e,t){if(e){if(typeof e=="string")return wx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wx(e,t)}}function wx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function B0e(e){if(Array.isArray(e))return e}var Lv="remove_col";function V0e(){return{key:Lv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=H0e(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(TT,r)},callback:function(){this.alter("remove_col",D0e(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=cl(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function W0e(e,t){return G0e(e)||Y0e(e,t)||z0e(e,t)||U0e()}function U0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z0e(e,t){if(e){if(typeof e=="string")return Sx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sx(e,t)}}function Sx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function G0e(e){if(Array.isArray(e))return e}var rb="remove_row";function K0e(){return{key:rb,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=W0e(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(ET,r)},callback:function(){this.alter("remove_row",N0e(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=cl(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var nb="row_above";function q0e(){return{key:nb,name:function(){return this.getTranslatedPhrase(CT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=cl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var ob="row_below";function X0e(){return{key:ob,name:function(){return this.getTranslatedPhrase(_T)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=cl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Vh="no_items";function Z0e(){return{key:Vh,name:function(){return this.getTranslatedPhrase(ST)},disabled:!0,isCommand:!1}}var ib="undo";function Q0e(){return{key:ib,name:function(){return this.getTranslatedPhrase(PT)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}var yr;function xr(e,t,r){return t=J0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J0e(e){var t=eEe(e,"string");return Wh(t)==="symbol"?t:String(t)}function eEe(e,t){if(Wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tEe=[nb,ob,Dv,Nv,Qm,rb,Lv,ib,Jm,Hv,Xr,qe,Vh],rEe=(yr={},xr(yr,qe,VRe),xr(yr,Vh,Z0e),xr(yr,nb,q0e),xr(yr,ob,X0e),xr(yr,Dv,R0e),xr(yr,Nv,E0e),xr(yr,Qm,O0e),xr(yr,rb,K0e),xr(yr,Lv,V0e),xr(yr,ib,Q0e),xr(yr,Jm,P0e),xr(yr,Hv,T0e),xr(yr,Xr,_0e),yr);function sU(){var e={};return ze(rEe,function(t,r){e[r]=t()}),e}function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function nEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iEe(n.key),n)}}function oEe(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iEe(e){var t=aEe(e,"string");return Uh(t)==="symbol"?t:String(t)}function aEe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lEe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;nEe(this,e),this.hot=t,this.predefinedItems=sU(),this.defaultOrderPattern=r}return oEe(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,ze(r,function(i,a){var l="";i.name===qe?(o[qe]=i,l=qe):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return sEe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function sEe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ue(o)?ze(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ue(i)?zt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):A(o,function(i,a){var l=r[i];!l&&tEe.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ue(i)&&zt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const uU=lEe;function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function uEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cEe(n.key),n)}}function fEe(e,t,r){return t&&_x(e.prototype,t),r&&_x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cEe(e){var t=hEe(e,"string");return zh(t)==="symbol"?t:String(t)}function hEe(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dEe=function(){function e(t,r){uEe(this,e);var n=ms(r),o=Ba(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return fEe(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const vEe=dEe;var yEe=Ja,gEe=/(?:ipad|iphone|ipod).*applewebkit/i.test(yEe),pEe=Un,fU=typeof process<"u"&&pEe(process)=="process",Vr=vt,mEe=al,bEe=hv,Ox=Ot,wEe=Nt,cU=je,Rx=_j,SEe=pv,Ex=om,CEe=aW,_Ee=gEe,OEe=fU,wO=Vr.setImmediate,SO=Vr.clearImmediate,REe=Vr.process,Zw=Vr.Dispatch,EEe=Vr.Function,Tx=Vr.MessageChannel,TEe=Vr.String,Qw=0,Hc={},Px="onreadystatechange",Yh,qi,Jw,eS;cU(function(){Yh=Vr.location});var BP=function(e){if(wEe(Hc,e)){var t=Hc[e];delete Hc[e],t()}},tS=function(e){return function(){BP(e)}},kx=function(e){BP(e.data)},$x=function(e){Vr.postMessage(TEe(e),Yh.protocol+"//"+Yh.host)};(!wO||!SO)&&(wO=function(t){CEe(arguments.length,1);var r=Ox(t)?t:EEe(t),n=SEe(arguments,1);return Hc[++Qw]=function(){mEe(r,void 0,n)},qi(Qw),Qw},SO=function(t){delete Hc[t]},OEe?qi=function(e){REe.nextTick(tS(e))}:Zw&&Zw.now?qi=function(e){Zw.now(tS(e))}:Tx&&!_Ee?(Jw=new Tx,eS=Jw.port2,Jw.port1.onmessage=kx,qi=bEe(eS.postMessage,eS)):Vr.addEventListener&&Ox(Vr.postMessage)&&!Vr.importScripts&&Yh&&Yh.protocol!=="file:"&&!cU($x)?(qi=$x,Vr.addEventListener("message",kx,!1)):Px in Ex("script")?qi=function(e){Rx.appendChild(Ex("script"))[Px]=function(){Rx.removeChild(this),BP(e)}}:qi=function(e){setTimeout(tS(e),0)});var hU={set:wO,clear:SO},PEe=$e,kEe=vt,Ax=hU.clear;PEe({global:!0,bind:!0,enumerable:!0,forced:kEe.clearImmediate!==Ax},{clearImmediate:Ax});var $Ee=$e,dU=vt,Ix=hU.set,AEe=DE,Mx=dU.setImmediate?AEe(Ix,!1):Ix;$Ee({global:!0,bind:!0,enumerable:!0,forced:dU.setImmediate!==Mx},{setImmediate:Mx});var IEe=$e,MEe=q0;IEe({target:"String",proto:!0},{repeat:MEe});var xEe=Zt,DEe=ym,NEe=jt,HEe=_n,LEe=rl,rS=Kt,jEe=Ar,FEe=tl,BEe=N0,xx=gm;DEe("match",function(e,t,r){return[function(o){var i=jEe(this),a=HEe(o)?void 0:FEe(o,e);return a?xEe(a,o,i):new RegExp(o)[e](rS(i))},function(n){var o=NEe(this),i=rS(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return xx(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=xx(o,i))!==null;){var c=rS(f[0]);s[u]=c,c===""&&(o.lastIndex=BEe(i,LEe(o.lastIndex),l)),u++}return u===0?null:s}]});var VEe=al,WEe=zr,UEe=Ni,zEe=en,YEe=Tf,GEe=Math.min,CO=[].lastIndexOf,vU=!!CO&&1/[1].lastIndexOf(1,-0)<0,KEe=YEe("lastIndexOf"),qEe=vU||!KEe,XEe=qEe?function(t){if(vU)return VEe(CO,this,arguments)||0;var r=WEe(this),n=zEe(r),o=n-1;for(arguments.length>1&&(o=GEe(o,UEe(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:CO,ZEe=$e,Dx=XEe;ZEe({target:"Array",proto:!0,forced:Dx!==[].lastIndexOf},{lastIndexOf:Dx});var QEe=el,JEe=Ir,eTe=Xd,tTe=en,rTe=TypeError,Nx=function(e){return function(t,r,n,o){QEe(r);var i=JEe(t),a=eTe(i),l=tTe(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw rTe("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},nTe={left:Nx(!1),right:Nx(!0)},oTe=$e,iTe=nTe.left,aTe=Tf,Hx=Zd,lTe=fU,sTe=!lTe&&Hx>79&&Hx<83,uTe=sTe||!aTe("reduce");oTe({target:"Array",proto:!0,forced:uTe},{reduce:function(t){var r=arguments.length;return iTe(this,t,r,r>1?arguments[1]:void 0)}});function nS(e){return dTe(e)||hTe(e)||cTe(e)||fTe()}function fTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cTe(e,t){if(e){if(typeof e=="string")return _O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _O(e,t)}}function hTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dTe(e){if(Array.isArray(e))return _O(e)}function _O(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},vTe=new RegExp(Object.keys(yU).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function yTe(e){return(e&&e.nodeName||"")==="TABLE"}function OO(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],y=0;y<a;y+=1){var m=!d&&r&&y===0,w="";if(d)w="<th>".concat(e.getColHeader(y-f),"</th>");else if(m)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var C=o[h][y],S=e.getCellMeta(h-c,y-f),R=S.hidden,O=S.rowspan,j=S.colspan;if(!R){var U=[];if(O&&U.push('rowspan="'.concat(O,'"')),j&&U.push('colspan="'.concat(j,'"')),Xt(C))w="<td ".concat(U.join(" "),"></td>");else{var q=C.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(U.join(" "),">").concat(q,"</td>")}}}v.push(w)}var G=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,G):u.splice(-1,0,G)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function RO(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Xt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function gU(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(b){var T=b.match(/<td\b[^>]*?>/g)[0],E=b.substring(T.length,b.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),B="</td>";return"".concat(T).concat(E).concat(B)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!yTe(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(b,T){return b+T.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,y=0;if(i.tHead){var m=Array.from(i.tHead.rows).filter(function(b){var T=b.querySelector("td")!==null;return T&&h.push(b),!T});v=m.length,d=v>0,v>1?r.nestedHeaders=Array.from(m).reduce(function(b,T){var E=Array.from(T.cells).reduce(function(B,x,K){if(s&&K===0)return B;var Z=x.colSpan,re=x.innerHTML,ie=Z>1?{label:re,colspan:Z}:re;return B.push(ie),B},[]);return b.push(E),b},[]):d&&(r.colHeaders=Array.from(m[0].children).reduce(function(b,T,E){return s&&E===0||b.push(T.innerHTML),b},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,nS(Array.from(i.tBodies).reduce(function(b,T){return b.push.apply(b,nS(Array.from(T.rows))),b},[])),nS(c));y=w.length;for(var C=new Array(y),S=0;S<y;S++)C[S]=new Array(f);for(var R=[],O=[],j=0;j<y;j++)for(var U=w[j],q=Array.from(U.cells),G=q.length,X=0;X<G;X++){var Q=q[X],oe=Q.nodeName,J=Q.innerHTML,ue=Q.rowSpan,he=Q.colSpan,Oe=C[j].findIndex(function(b){return b===void 0});if(oe==="TD"){if(ue>1||he>1){for(var we=j;we<j+ue;we++)if(we<y)for(var $=Oe;$<Oe+he;$++)C[we][$]=null;var k=Q.getAttribute("style"),g=k&&k.includes("mso-ignore:colspan");g||R.push({col:Oe,row:j,rowspan:ue,colspan:he})}var p="";l&&/excel/gi.test(l.content)?p=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):p=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[j][Oe]=p.replace(vTe,function(b){return yU[b]})}else O.push(J)}return R.length&&(r.mergeCells=R),O.length&&(r.rowHeaders=O),C.length&&(r.data=C),r}}const gTe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:RO,htmlToGridSettings:gU,instanceToHTML:OO},Symbol.toStringTag,{value:"Module"}));function Lx(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function pTe(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var mTe=new Map([["mousedown",Lx],["mouseover",pTe],["touchstart",Lx]]);function jx(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;mTe.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:jm(e)||e.type==="touchstart",isRightClick:$i(e)})}var pU=new WeakMap,VP=Symbol("rootInstance");function bTe(e){pU.set(e,!0)}function wTe(e){return e===VP}function EO(e){return pU.has(e)}function Gh(e){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function rc(e,t){return _Te(e)||CTe(e,t)||mU(e,t)||STe()}function STe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _Te(e){if(Array.isArray(e))return e}function Fx(e){return ETe(e)||RTe(e)||mU(e)||OTe()}function OTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mU(e,t){if(e){if(typeof e=="string")return TO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TO(e,t)}}function RTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ETe(e){if(Array.isArray(e))return TO(e)}function TO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bU(n.key),n)}}function PTe(e,t,r){return t&&Bx(e.prototype,t),r&&Bx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vx(e,t,r){kTe(e,t),t.set(e,r)}function kTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(e,t,r){return t=bU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bU(e){var t=$Te(e,"string");return Gh(t)==="symbol"?t:String(t)}function $Te(e,t){if(Gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wx(e,t){var r=wU(e,t,"get");return ATe(e,r)}function ATe(e,t){return t.get?t.get.call(e):t.value}function Ux(e,t,r){var n=wU(e,t,"set");return ITe(e,n,r),r}function wU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ITe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Xi=new WeakMap,oS=new WeakMap,iS=new WeakMap,MTe=function(){function e(t){TTe(this,e),Qo(this,"instance",void 0),Qo(this,"eventManager",void 0),Qo(this,"settings",void 0),Qo(this,"THEAD",void 0),Qo(this,"TBODY",void 0),Qo(this,"_wt",void 0),Qo(this,"activeWt",void 0),Vx(this,oS,{writable:!0,value:0}),Vx(this,iS,{writable:!0,value:0}),Qo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Pt(this.instance),this.settings=this.instance.getSettings(),Xi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return PTe(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Xi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),te(o,"handsontable"),r.table=i.createElement("TABLE"),te(r.table,"htCore"),this.instance.getSettings().tableClassName&&te(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Xi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;e_(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&e_(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&jm(u)&&l.finish(),n.mouseDown=!1,(Wm(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!$i(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&$i(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var y=Jt(a);if(a.elementFromPoint(c+y,h)!==v||a.elementFromPoint(c,h+y)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var m=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;m?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Qc(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,Fx(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Xi.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return EO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,Fx(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),Ux(r,iS,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),Ux(r,oS,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=rc(d,2),y=v[0],m=v[1],w=r.instance.runHooks("modifyGetCellCoords",y,m),C=y,S=m;if(Array.isArray(w)){var R=rc(w,2);C=R[0],S=R[1]}var O=r.instance.getCellMeta(C,S),j=r.instance.colToProp(S),U=r.instance.getDataAtRowProp(C,j);r.instance.hasHook("beforeValueRender")&&(U=r.instance.runHooks("beforeValueRender",U,O)),r.instance.runHooks("beforeRenderer",h,y,m,j,U,O),r.instance.getCellRenderer(O)(r.instance,h,y,m,j,U,O),r.instance.runHooks("afterRenderer",h,y,m,j,U,O)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,y),!la(f)&&(jx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,C){return r.instance._createCellCoords(w,C)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!la(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!la(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,y),!la(f)&&(n.mouseDown&&jx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,C){return r.instance._createCellCoords(w,C)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(la(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),y=rc(v,2),m=y[0],w=y[1],C=r.instance.selection.getSelectedRange(),S=C.size();if(S>0){var R=(h??0)+1-S,O=C.peekByIndex(R);d=[O.from.row,O.from.col,O.to.row,O.to.col]}return r.instance.runHooks("afterDrawSelection",m,w,d,h)},onBeforeDrawBorders:function(f,c){var h=rc(f,4),d=h[0],v=h[1],y=h[2],m=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(y),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,y=c>=0?v.getVisualFromRenderableIndex(c):c,m=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",m,y,h);if(Array.isArray(w)){var C=rc(w,4),S=C[0],R=C[1],O=C[2],j=C[3];return[S>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(S,1)):S,R>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(R,1)):R,O>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(O,-1)):O,j>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(j,-1)):j]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var y=Math.ceil(v/h*12);f.startRow=Math.max(d-y,0),f.endRow=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var y=Math.ceil(v/h*6);f.startColumn=Math.max(d-y,0),f.endColumn=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new Jme(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Qc(r))return!0;var n=mi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Xi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){Cn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(Cn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?sl(r,o(n,i)):(Ai(r,String.fromCharCode(160)),te(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Xi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Xi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Wx(this,oS)}},{key:"getRowHeadersCount",value:function(){return Wx(this,iS)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const xTe=MTe;function PO(e){"@babel/helpers - typeof";return PO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PO(e)}var SU="ABCDEFGHIJKLMNOPQRSTUVWXYZ",kO=SU.length;function ab(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%kO,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/kO,10);return r}function DTe(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(kO,n)*(SU.indexOf(e[r])+1);return t-=1,t}function NTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(ab(o)+(n+1));r.push(i)}return r}function HTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=ab(o)+(n+1);r.push(i)}return r}function LTe(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function $O(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function WP(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ue(e[0])&&(t=Lm(e[0]))),t}function CU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function _U(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return PO(t)==="object"&&!Array.isArray(t)&&t!==null}))}const jTe=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:WP,createEmptySpreadsheetData:LTe,createSpreadsheetData:NTe,createSpreadsheetObjectData:HTe,dataRowToChangesArray:$O,isArrayOfArrays:CU,isArrayOfObjects:_U,spreadsheetColumnIndex:DTe,spreadsheetColumnLabel:ab},Symbol.toStringTag,{value:"Module"}));function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function FTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VTe(n.key),n)}}function BTe(e,t,r){return t&&zx(e.prototype,t),r&&zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VTe(e){var t=WTe(e,"string");return Kh(t)==="symbol"?t:String(t)}function WTe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UTe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];FTe(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return BTe(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return A(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):Ce(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ue(s)||pt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;Ce(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):sg(u,d,v)}})}else ze(s,function(h,d){sg(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=Fa(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:sg(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=PV(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=Fa(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Ce(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return WP(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const zTe=UTe;var Yx;function YTe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function GTe(e,t){return ze(t,function(r,n){mt(e[n])&&(e[n]=r)}),e}function OU(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function RU(e){ve(e)&&xE(dt(Yx||(Yx=YTe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function KTe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var EU=on("phraseFormatters"),qTe=EU.register,XTe=EU.getValues;function ZTe(e,t){qTe(e,t)}function QTe(){return XTe()}ZTe("pluralize",KTe);function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}var fe;function ce(e,t,r){return t=JTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JTe(e){var t=ePe(e,"string");return qh(t)==="symbol"?t:String(t)}function ePe(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tPe=(fe={languageCode:"en-US"},ce(fe,ST,"No available options"),ce(fe,CT,"Insert row above"),ce(fe,_T,"Insert row below"),ce(fe,OT,"Insert column left"),ce(fe,RT,"Insert column right"),ce(fe,ET,["Remove row","Remove rows"]),ce(fe,TT,["Remove column","Remove columns"]),ce(fe,PT,"Undo"),ce(fe,kT,"Redo"),ce(fe,$T,"Read only"),ce(fe,AT,"Clear column"),ce(fe,zT,"Alignment"),ce(fe,YT,"Left"),ce(fe,GT,"Center"),ce(fe,KT,"Right"),ce(fe,qT,"Justify"),ce(fe,XT,"Top"),ce(fe,ZT,"Middle"),ce(fe,QT,"Bottom"),ce(fe,HT,"Freeze column"),ce(fe,LT,"Unfreeze column"),ce(fe,JT,"Borders"),ce(fe,eP,"Top"),ce(fe,tP,"Right"),ce(fe,rP,"Bottom"),ce(fe,nP,"Left"),ce(fe,oP,"Remove border(s)"),ce(fe,BT,"Add comment"),ce(fe,VT,"Edit comment"),ce(fe,WT,"Delete comment"),ce(fe,UT,"Read-only comment"),ce(fe,jT,"Merge cells"),ce(fe,FT,"Unmerge cells"),ce(fe,IT,"Copy"),ce(fe,MT,["Copy with header","Copy with headers"]),ce(fe,xT,["Copy with group header","Copy with group headers"]),ce(fe,DT,["Copy header only","Copy headers only"]),ce(fe,NT,"Cut"),ce(fe,iP,"Insert child row"),ce(fe,aP,"Detach from parent"),ce(fe,lP,["Hide column","Hide columns"]),ce(fe,sP,["Show column","Show columns"]),ce(fe,uP,["Hide row","Hide rows"]),ce(fe,fP,["Show row","Show rows"]),ce(fe,Xm,"None"),ce(fe,cP,"Is empty"),ce(fe,hP,"Is not empty"),ce(fe,dP,"Is equal to"),ce(fe,vP,"Is not equal to"),ce(fe,yP,"Begins with"),ce(fe,gP,"Ends with"),ce(fe,pP,"Contains"),ce(fe,mP,"Does not contain"),ce(fe,bP,"Greater than"),ce(fe,wP,"Greater than or equal to"),ce(fe,SP,"Less than"),ce(fe,CP,"Less than or equal to"),ce(fe,_P,"Is between"),ce(fe,OP,"Is not between"),ce(fe,RP,"After"),ce(fe,EP,"Before"),ce(fe,TP,"Today"),ce(fe,PP,"Tomorrow"),ce(fe,kP,"Yesterday"),ce(fe,Fp,"Blank cells"),ce(fe,$P,"Filter by condition"),ce(fe,AP,"Filter by value"),ce(fe,IP,"And"),ce(fe,Zm,"Or"),ce(fe,MP,"Select all"),ce(fe,xP,"Clear"),ce(fe,DP,"OK"),ce(fe,NP,"Cancel"),ce(fe,HP,"Search"),ce(fe,LP,"Value"),ce(fe,jP,"Second value"),fe);const TU=tPe;var AO=TU.languageCode,lb=on("languagesDictionaries"),rPe=lb.register,PU=lb.getItem,nPe=lb.hasItem,oPe=lb.getValues;kU(TU);function kU(e,t){var r=e,n=t;return Ue(e)&&(n=e,r=n.languageCode),iPe(r,n),rPe(r,fr(n)),fr(n)}function iPe(e,t){e!==AO&&GTe(t,PU(AO))}function $U(e){return UP(e)?fr(PU(e)):null}function UP(e){return nPe(e)}function aPe(){return oPe()}function AU(e,t,r){var n=$U(e);if(n===null)return null;var o=n[t];if(mt(o))return null;var i=lPe(o,r);return Array.isArray(i)?i[0]:i}function lPe(e,t){var r=e;return A(QTe(),function(n){r=n(e,t)}),r}function sPe(e){var t=OU(e);return UP(t)||(t=AO,RU(e)),t}var sb="active-header",ub="area",Xh="cell",zP="fill",jv="header",YP="custom-selection";function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function uPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MU(n.key),n)}}function fPe(e,t,r){return t&&Gx(e.prototype,t),r&&Gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Og(){return typeof Reflect<"u"&&Reflect.get?Og=Reflect.get.bind():Og=function(t,r,n){var o=cPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Og.apply(this,arguments)}function cPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Su(e),e!==null););return e}function hPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IO(e,t)}function IO(e,t){return IO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IO(e,t)}function dPe(e){var t=yPe();return function(){var n=Su(e),o;if(t){var i=Su(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vPe(this,o)}}function vPe(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IU(e)}function IU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Su(e)}function gPe(e,t,r){return t=MU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MU(e){var t=pPe(e,"string");return wu(t)==="symbol"?t:String(t)}function pPe(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mPe=function(e){hPe(r,e);var t=dPe(r);function r(n,o){var i;return uPe(this,r),i=t.call(this,n,null),gPe(IU(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return fPe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,Og(Su(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}($be);const Df=mPe;function Zh(e){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zh(e)}var bPe=["activeHeaderClassName"];function Kx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kx(Object(r),!0).forEach(function(n){wPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wPe(e,t,r){return t=SPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SPe(e){var t=CPe(e,"string");return Zh(t)==="symbol"?t:String(t)}function CPe(e,t){if(Zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Pe(e,t){if(e==null)return{};var r=OPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function OPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function RPe(e){var t=e.activeHeaderClassName,r=_Pe(e,bPe),n=new Df(qx(qx({highlightHeaderClassName:t},r),{},{selectionType:sb}));return n}function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}var EPe=["layerLevel","areaCornerVisible"];function Xx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Zx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xx(Object(r),!0).forEach(function(n){TPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TPe(e,t,r){return t=PPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PPe(e){var t=kPe(e,"string");return Qh(t)==="symbol"?t:String(t)}function kPe(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Pe(e,t){if(e==null)return{};var r=APe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function APe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function IPe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=$Pe(e,EPe),o=new Df(Zx(Zx({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:ub}));return o}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var MPe=["cellCornerVisible"];function Qx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Jx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qx(Object(r),!0).forEach(function(n){xPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xPe(e,t,r){return t=DPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DPe(e){var t=NPe(e,"string");return Jh(t)==="symbol"?t:String(t)}function NPe(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HPe(e,t){if(e==null)return{};var r=LPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function LPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function jPe(e){var t=e.cellCornerVisible,r=HPe(e,MPe),n=new Df(Jx(Jx({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Xh}));return n}function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}var FPe=["border","visualCellRange"];function eD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function aS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eD(Object(r),!0).forEach(function(n){BPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BPe(e,t,r){return t=VPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VPe(e){var t=WPe(e,"string");return ed(t)==="symbol"?t:String(t)}function WPe(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UPe(e,t){if(e==null)return{};var r=zPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function zPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function YPe(e){var t=e.border,r=e.visualCellRange,n=UPe(e,FPe),o=new Df(aS(aS(aS({},t),n),{},{selectionType:YP}),r);return o}function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function tD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tD(Object(r),!0).forEach(function(n){GPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GPe(e,t,r){return t=KPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KPe(e){var t=qPe(e,"string");return td(t)==="symbol"?t:String(t)}function qPe(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XPe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function ZPe(e){var t=Object.assign({},(XPe(e),e)),r=new Df(rD(rD({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:zP}));return r}function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}var QPe=["headerClassName","rowClassName","columnClassName"];function nD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function oD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nD(Object(r),!0).forEach(function(n){JPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JPe(e,t,r){return t=eke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eke(e){var t=tke(e,"string");return rd(t)==="symbol"?t:String(t)}function tke(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rke(e,t){if(e==null)return{};var r=nke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function oke(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=rke(e,QPe),i=new Df(oD(oD({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:jv}));return i}function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}function iD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ike(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iD(Object(r),!0).forEach(function(n){ake(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ake(e,t,r){return t=lke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lke(e){var t=ske(e,"string");return nd(t)==="symbol"?t:String(t)}function ske(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xU=on("highlight/types"),Nf=xU.register,uke=xU.getItem;Nf(sb,RPe);Nf(ub,IPe);Nf(Xh,jPe);Nf(YP,YPe);Nf(zP,ZPe);Nf(jv,oke);function Tl(e,t){return uke(e)(ike({type:e},t))}function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function Jo(e){return dke(e)||hke(e)||cke(e)||fke()}function fke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cke(e,t){if(e){if(typeof e=="string")return MO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MO(e,t)}}function hke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dke(e){if(Array.isArray(e))return MO(e)}function MO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aD(Object(r),!0).forEach(function(n){vke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vke(e,t,r){return t=DU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DU(n.key),n)}}function gke(e,t,r){return t&&lD(e.prototype,t),r&&lD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DU(e){var t=pke(e,"string");return od(t)==="symbol"?t:String(t)}function pke(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mke=function(e){function t(r){yke(this,t),this.options=r,this.layerLevel=0,this.cell=Tl(Xh,r),this.fill=Tl(zP,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return gke(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===Xh&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=Tl(ub,nc({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Jo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=Tl(jv,nc({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Jo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=Tl(sb,nc({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Jo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Jo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(Tl(YP,nc(nc({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),A(this.areas.values(),function(n){return void n.clear()}),A(this.headers.values(),function(n){return void n.clear()}),A(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Jo(this.areas.values()),Jo(this.headers.values()),Jo(this.activeHeaders.values()),Jo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const bke=mke;function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function wke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cke(n.key),n)}}function Ske(e,t,r){return t&&sD(e.prototype,t),r&&sD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cke(e){var t=_ke(e,"string");return id(t)==="symbol"?t:String(t)}function _ke(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oke=function(e){function t(r){wke(this,t),this.ranges=[],this.createCellRange=r}return Ske(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Rke=Oke;function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function Eke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pke(n.key),n)}}function Tke(e,t,r){return t&&uD(e.prototype,t),r&&uD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pke(e){var t=kke(e,"string");return ad(t)==="symbol"?t:String(t)}function kke(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NU=function(){function e(t,r){Eke(this,e),this.range=t,this.options=r}return Tke(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),y=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),w=this.options.minSpareCols(),C=this.options.autoWrapRow(),S=this.options.autoWrapCol();s+r>d-1?o&&m>0&&!(y&&s>=d-y-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):S&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):S&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):C&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):C&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var R=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,R.row<0?(c=-1,R.row=0):R.row>0&&R.row>=d&&(c=1,R.row=d-1),R.col<0?(h=-1,R.col=0):R.col>0&&R.col>=v&&(h=1,R.col=v-1),f=this.options.renderableToVisualCoords(R)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),y=v.row,m=v.col,w=this.options.createCellCoords(y+o.row,m+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();gt(NU,Mr);const $ke=NU;function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}var fD;function cD(e,t){return xke(e)||Mke(e,t)||Ike(e,t)||Ake()}function Ake(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ike(e,t){if(e){if(typeof e=="string")return hD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(e,t)}}function hD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xke(e){if(Array.isArray(e))return e}function Dke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Nke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lke(n.key),n)}}function Hke(e,t,r){return t&&dD(e.prototype,t),r&&dD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lke(e){var t=jke(e,"string");return ld(t)==="symbol"?t:String(t)}function jke(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HU=function(){function e(t,r){var n=this;Nke(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Rke(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new bke({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new $ke(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Hke(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&mt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Xh,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(A(this.highlight.getAreas(),function(y){return void y.clear()}),A(this.highlight.getHeaders(),function(y){return void y.clear()}),A(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(ub,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(jv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Fa(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=bu(r);if(o===tb)return!1;if(o===eb)throw new Error(dt(fD||(fD=Dke([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Bh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=cD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=Zo(h,a)&&Zo(d,l)&&Zo(v,a)&&Zo(y,l);return!m});return s&&(this.clear(),A(r,function(u){var f=i(u),c=cD(f,4),h=c[0],d=c[1],v=c[2],y=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,y)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Zo(i,l)&&Zo(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Zo(r,i)&&Zo(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();gt(HU,Mr);const Fke=HU;var Bke=$e,LU=cv,Vke=zn.f,Wke=rl,vD=Kt,Uke=pE,zke=Ar,Yke=mE,yD=LU("".startsWith),Gke=LU("".slice),Kke=Math.min,jU=Yke("startsWith"),qke=!jU&&!!function(){var e=Vke(String.prototype,"startsWith");return e&&!e.writable}();Bke({target:"String",proto:!0,forced:!qke&&!jU},{startsWith:function(t){var r=vD(zke(this));Uke(t);var n=Wke(Kke(arguments.length>1?arguments[1]:void 0,r.length)),o=vD(t);return yD?yD(r,o,n):Gke(r,n,n+o.length)===o}});var gD=/^(\r\n|\n\r|\r|\n)/,Xke=/^[^\t\r\n]+/,pD=/^\t/;function Zke(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(pD))e=e.replace(pD,""),r+=1,t[n][r]="";else if(e.match(gD))e=e.replace(gD,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(Xke);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function Lc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function lS(e){return t$e(e)||e$e(e)||Jke(e)||Qke()}function Qke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jke(e,t){if(e){if(typeof e=="string")return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}}function e$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t$e(e){if(Array.isArray(e))return xO(e)}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function r$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o$e(n.key),n)}}function n$e(e,t,r){return t&&mD(e.prototype,t),r&&mD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o$e(e){var t=i$e(e,"string");return Cu(t)==="symbol"?t:String(t)}function i$e(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a$e=function(){function e(t,r,n){r$e(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return n$e(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=Lm(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ue(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return WP(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Cu(r)==="object"&&!Array.isArray(r)&&ze(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ve(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ve(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ys(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,y=this.getSchema().length,m=[],w=function(){var R=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?R=fr(n.getSchema()):(R=[],Ce(y-1,function(){return R.push(null)})):n.instance.dataType==="function"?R=n.tableMeta.dataSchema(h+c):(R={},_v(R,n.getSchema())),m.push(R),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,m);var C=this.instance.toVisualRow(f);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",C,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),y=this.instance.countCols(),m=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var C=w;m<n&&y<u;){if(typeof c!="number"||c>=y)if(v>0)for(var S=0;S<v;S+=1)typeof s[S]>"u"&&(s[S]=[]),s[S].push(null);else s.push([null]);else for(var R=0;R<v;R++)s[R].splice(w,0,null);m+=1,w+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,m),m>0&&(r==null?this.metaManager.createColumn(null,m):i!=="auto"&&this.metaManager.createColumn(C,n));var O=this.instance.toVisualColumn(C);return this.instance.runHooks("afterCreateCol",O,m,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:C}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ve(this.tableMeta.columns)||ve(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(C,S){return S-C}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var y=0,m=this.instance.countSourceRows();y<m;y++)for(var w=0;w<f;w++)c[y].splice(l[w],1),y===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];LC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return SV(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];LC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(lS(this.dataSource.slice(0,r)),lS(o),lS(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&xt(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=Fa(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=Fa(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&xt(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return Lc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Lc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const l$e=a$e;function s$e(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!xt(t,e)}function fb(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?QE(t.type):t.type;if(e._automaticallyAssignedMetaProps&&ze(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ue(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};ze(n,function(i,a){if(s$e(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),zt(e,o)}}function u$e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Ko(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Rg(e){return Number.isInteger(e)&&e>=0}function Eg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Ry(e){return e==null}function DO(e){"@babel/helpers - typeof";return DO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DO(e)}const FU=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),Xt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),Xt(o)===!1)return DO(o)==="object"?(i=this.getCellMeta(t,r),Hm(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function bD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bD(Object(r),!0).forEach(function(n){f$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function f$e(e,t,r){return t=VU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VU(n.key),n)}}function BU(e,t,r){return t&&SD(e.prototype,t),r&&SD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VU(e){var t=c$e(e,"string");return sd(t)==="symbol"?t:String(t)}function c$e(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h$e(){return BU(function e(){WU(this,e)})}var d$e=function(){function e(t){WU(this,e),this.metaCtor=h$e(),this.meta=this.metaCtor.prototype,zt(this.meta,FU()),this.meta.instance=t}return BU(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;zt(this.meta,r),fb(this.meta,wD(wD({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function v$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g$e(n.key),n)}}function y$e(e,t,r){return t&&CD(e.prototype,t),r&&CD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g$e(e){var t=p$e(e,"string");return ud(t)==="symbol"?t:String(t)}function p$e(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m$e=function(){function e(t){v$e(this,e);var r=t.getMetaConstructor();this.meta=new r}return y$e(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){zt(this.meta,r),fb(this.meta,r,r)}}]),e}();function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function _D(e){return C$e(e)||S$e(e)||w$e(e)||b$e()}function b$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w$e(e,t){if(e){if(typeof e=="string")return NO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NO(e,t)}}function S$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function C$e(e){if(Array.isArray(e))return NO(e)}function NO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R$e(n.key),n)}}function O$e(e,t,r){return t&&OD(e.prototype,t),r&&OD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R$e(e){var t=E$e(e,"string");return fd(t)==="symbol"?t:String(t)}function E$e(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HO=function(e){function t(r){_$e(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return O$e(t,[{key:"obtain",value:function(n){Eg(function(){return Rg(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Eg(function(){return Rg(n)||Ry(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=Ry(n)?this.index.length:n;this.index=[].concat(_D(this.index.slice(0,s)),i,_D(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Eg(function(){return Rg(n)||Ry(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(Ry(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Wr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function T$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k$e(n.key),n)}}function P$e(e,t,r){return t&&RD(e.prototype,t),r&&RD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k$e(e){var t=$$e(e,"string");return cd(t)==="symbol"?t:String(t)}function $$e(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A$e=["data","width"],I$e=function(){function e(t){var r=this;T$e(this,e),this.globalMeta=t,this.metas=new HO(function(){return r._createMeta()})}return P$e(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);zt(o,n),fb(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return u$e(this.globalMeta.getMetaConstructor(),A$e).prototype}}]),e}();function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function M$e(e){return H$e(e)||N$e(e)||D$e(e)||x$e()}function x$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D$e(e,t){if(e){if(typeof e=="string")return LO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LO(e,t)}}function N$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function H$e(e){if(Array.isArray(e))return LO(e)}function LO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ED(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F$e(n.key),n)}}function j$e(e,t,r){return t&&ED(e.prototype,t),r&&ED(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F$e(e){var t=B$e(e,"string");return hd(t)==="symbol"?t:String(t)}function B$e(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var V$e=function(){function e(t){var r=this;L$e(this,e),this.columnMeta=t,this.metas=new HO(function(){return r._createRow()})}return j$e(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);zt(i,o),fb(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,M$e(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){Eg(function(){return Rg(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new HO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function W$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z$e(n.key),n)}}function U$e(e,t,r){return t&&TD(e.prototype,t),r&&TD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z$e(e){var t=Y$e(e,"string");return dd(t)==="symbol"?t:String(t)}function Y$e(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UU=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];W$e(this,e),this.hot=t,this.globalMeta=new d$e(t),this.tableMeta=new m$e(this.globalMeta),this.columnMeta=new I$e(this.globalMeta),this.cellMeta=new V$e(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return U$e(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();gt(UU,Mr);function Bp(e){"@babel/helpers - typeof";return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bp(e)}function PD(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=ur(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":pt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new l$e(o,e,u);if(t(d),Bp(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var y,m=0,w=0;for(m=0,w=h.startRows;m<w;m++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)y=fr(v),e.push(y);else if(o.dataType==="array")y=fr(v[0]),e.push(y);else{y=[];for(var C=0,S=h.startCols;C<S;C++)y.push(null);e.push(y)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Bp(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function G$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q$e(n.key),n)}}function K$e(e,t,r){return t&&kD(e.prototype,t),r&&kD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q$e(e){var t=X$e(e,"string");return vd(t)==="symbol"?t:String(t)}function X$e(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z$e=function(){function e(t){var r=this;G$e(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ge.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return K$e(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=xt(r,"type")?r.type:null,c=pt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function Q$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e1e(n.key),n)}}function J$e(e,t,r){return t&&$D(e.prototype,t),r&&$D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e1e(e){var t=t1e(e,"string");return yd(t)==="symbol"?t:String(t)}function t1e(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r1e=function(){function e(t){Q$e(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return J$e(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),AD=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ey=function(t){return t.map(function(r){var n=r.toLowerCase();return AD.has(n)?AD.get(n):n}).sort().join("+")},n1e=function(t){return t.split("+")},ID=function(t){return t.toLowerCase()},MD;function o1e(e){return l1e(e)||a1e(e)||zU(e)||i1e()}function i1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l1e(e){if(Array.isArray(e))return jO(e)}function s1e(e,t){return c1e(e)||f1e(e,t)||zU(e,t)||u1e()}function u1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zU(e,t){if(e){if(typeof e=="string")return jO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jO(e,t)}}function jO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function c1e(e){if(Array.isArray(e))return e}function h1e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var d1e=function(t){var r=Ym({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,y=v===void 0?function(){return!0}:v,m=f.captureCtrl,w=m===void 0?!1:m,C=f.preventDefault,S=C===void 0?!0:C,R=f.stopPropagation,O=R===void 0?!1:R,j=f.relativeToGroup,U=f.position;if(mt(d))throw new Error("You need to define the shortcut's group.");if(pt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(dt(MD||(MD=h1e([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var q={callback:h,group:d,runOnlyIf:y,captureCtrl:w,preventDefault:S,stopPropagation:O};if(ve(j)){var G=[j,U];q.relativeToGroup=G[0],q.position=G[1]}c.forEach(function(X){var Q=Ey(X),oe=r.hasItem(Q);if(oe){var J=r.getItem(Q),ue=J.findIndex(function(he){return he.group===j});ue!==-1?U==="before"?ue-=1:ue+=1:ue=J.length,J.splice(ue,0,q)}else r.addItem(Q,[q])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){ze(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=Ey(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=s1e(h,2),v=d[0],y=d[1],m=y.filter(function(w){return w.group!==f});m.length===0?i(n1e(v)):(y.length=0,y.push.apply(y,o1e(m)))})},l=function(f){var c=Ey(f),h=r.getItem(c);return ve(h)?h.slice():[]},s=function(f){var c=Ey(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function v1e(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var y1e=["meta","alt","shift","control"],oc=v1e();function g1e(e,t,r,n,o){var i=function(d){return y1e.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return d.altKey&&y.push("alt"),v&&(d.ctrlKey||d.metaKey)?y.push("control/meta"):(d.ctrlKey&&y.push("control"),d.metaKey&&y.push("meta")),d.shiftKey&&y.push("shift"),y},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||la(d))){var y=ID(d.key),m=[];i(y)?oc.press(y):m=a(d);var w=[y].concat(m),C=o(d,w);!C&&(Zg()&&m.includes("meta")||!Zg()&&m.includes("control"))&&o(d,[y].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=ID(d.key);i(v)!==!1&&oc.release(v)}},u=function(){oc.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=qc(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=qc(d)};return{mount:f,unmount:c,isPressed:function(d){return oc.isPressed(d)},releasePressedKeys:function(){return oc.releaseAll()}}}var p1e=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=Ym({errorIdExists:function(y){return'The "'.concat(y,'" context name is already registered.')}}),l="grid",s=function(y){var m=d1e(y);return a.addItem(y,m),m},u=function(){return l},f=function(y){return a.getItem(y)},c=function(y){l=y},h=!1,d=g1e(r,n,o,i,function(v,y){var m=f(u()),w=!1;if(!m.hasShortcut(y))return w;for(var C=m.getShortcuts(y),S=0;S<C.length;S++){var R=C[S],O=R.callback,j=R.runOnlyIf,U=R.preventDefault,q=R.stopPropagation,G=R.captureCtrl;if(j(v)!==!1&&(h=G,w=O(v,y)===!1,h=!1,U&&v.preventDefault(),q&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}};function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(e)}function $n(e,t){return w1e(e)||b1e(e,t)||YU(e,t)||m1e()}function m1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function w1e(e){if(Array.isArray(e))return e}function Pl(e){return _1e(e)||C1e(e)||YU(e)||S1e()}function S1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YU(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function C1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _1e(e){if(Array.isArray(e))return FO(e)}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O1e="gridDefault",sS=null;function GP(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new Pt(a),s,u,f,c,h=!0;wTe(o)&&bTe(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=sPe(t.language);var y=new UU(a,t,[Z$e,r1e]),m=y.getTableMeta(),w=y.getGlobalMeta(),C=Ym();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),EO(this)&&RV(t.licenseKey,e),this.guid="ht_".concat(PE()),this.columnIndexMapper=new tO,this.rowIndexMapper=new tO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterRowSequenceChange",g)}),u=new zTe(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var S=function(p){var b=p.row,T=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,T>=0?a.columnIndexMapper.getRenderableFromVisualIndex(T):T)},R=function(p){var b=p.row,T=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,T>=0?a.columnIndexMapper.getVisualFromRenderableIndex(T):T)},O=new Fke(m,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(p){return s.propToCol(p)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(p,b){return a._createCellCoords(p,b)},createCellRange:function(p,b,T){return a._createCellRange(p,b,T)},visualToRenderableCoords:S,renderableToVisualCoords:R,isDisabledCellSelection:function(p,b){return a.getCellMeta(p,b).disableVisualSelection}});this.selection=O;var j=function(p){var b=p.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",j),this.rowIndexMapper.addLocalHook("cacheUpdated",j),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var p=Fa(!1),b=n.selection.getSelectedRange(),T=b.current(),E=T.from,B=T.to,x=b.size()-1;n.runHooks("afterSelection",E.row,E.col,B.row,B.col,p,x),n.runHooks("afterSelectionByProp",E.row,a.colToProp(E.col),B.row,a.colToProp(B.col),p,x);var K=n.selection.isSelectedByAnyHeader(),Z=n.selection.selectedRange.current(),re=!0;i&&(re=!1),p.isTouched()&&(re=!p.value);var ie=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();re!==!1&&(K?ie?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):Z&&!n.selection.isMultiple()?n.view.scrollViewport(S(Z.from)):n.view.scrollViewport(S(g))),ie&&se?te(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ie?(Le(n.rootElement,"ht__selection--columns"),te(n.rootElement,"ht__selection--rows")):se?(Le(n.rootElement,"ht__selection--rows"),te(n.rootElement,"ht__selection--columns")):Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var p=g.length-1,b=g[p],T=b.from,E=b.to;n.runHooks("afterSelectionEnd",T.row,T.col,E.row,E.col,p),n.runHooks("afterSelectionEndByProp",T.row,a.colToProp(T.col),E.row,a.colToProp(E.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var p=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,p,b){n.runHooks("afterModifyTransformStart",g,p,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,p,b){n.runHooks("afterModifyTransformEnd",g,p,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),f={alter:function(p,b){var T,E,B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0,Z=function(Me){if(Me.length===0)return[];var De=Pl(Me);De.sort(function(Bt,Ve){var Je=$n(Bt,1),St=Je[0],ut=$n(Ve,1),ft=ut[0];return St===ft?0:St>ft?1:-1});var dr=Ft(De,function(Bt,Ve){var Je=$n(Ve,2),St=Je[0],ut=Je[1],ft=Bt[Bt.length-1],et=$n(ft,2),qo=et[0],vb=et[1],ji=qo+vb;if(St<=ji){var Hf=Math.max(ut-(ji-St),0);ft[1]+=Hf}else Bt.push([St,ut]);return Bt},[De[0]]);return dr};switch(p){case"insert_row_below":case"insert_row_above":var re=a.countSourceRows();if(m.maxRows===re)return;var ie=p==="insert_row_below"?"below":"above";b=(T=b)!==null&&T!==void 0?T:ie==="below"?re:0;var se=s.createRow(b,B,{source:x,mode:ie}),_e=se.delta,Se=se.startPhysicalIndex;if(_e){var z=O.selectedRange.current(),Ne=z==null?void 0:z.from,Be=Ne==null?void 0:Ne.row,ke=a.toVisualRow(Se);if(O.isSelectedByCorner())a.selectAll();else if(ve(Be)&&Be>=ke){var Ie=z.to,Ae=Ie.row,_=Ie.col,P=Ne.col;O.isSelectedByRowHeader()&&(P=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(a._createCellCoords(Be+_e,P),!0),O.setRangeEnd(a._createCellCoords(Ae+_e,_))}else a._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var I=p==="insert_col_end"?"end":"start";b=(E=b)!==null&&E!==void 0?E:I==="end"?a.countSourceCols():0;var F=s.createCol(b,B,{source:x,mode:I}),M=F.delta,V=F.startPhysicalIndex;if(M){if(Array.isArray(m.colHeaders)){var N=[a.toVisualColumn(V),0];N.length+=M,Array.prototype.splice.apply(m.colHeaders,N)}var D=O.selectedRange.current(),W=D==null?void 0:D.from,L=W==null?void 0:W.col,Y=a.toVisualColumn(V);if(O.isSelectedByCorner())a.selectAll();else if(ve(L)&&L>=Y){var le=D.to,pe=le.row,Re=le.col,He=W.row;O.isSelectedByColumnHeader()&&(He=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(a._createCellCoords(He,L+M),!0),O.setRangeEnd(a._createCellCoords(pe,Re+M))}else a._refreshBorders()}break;case"remove_row":var Ze=function(Me){var De=0;A(Me,function(dr){var Bt=$n(dr,2),Ve=Bt[0],Je=Bt[1],St=Xt(Ve)?a.countRows()-1:Math.max(Ve-De,0);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ut=s.removeRow(Ve,Je,x);if(ut){var ft=a.countRows(),et=m.fixedRowsTop;et>=St+1&&(m.fixedRowsTop-=Math.min(Je,et-St));var qo=m.fixedRowsBottom;qo&&St>=ft-qo&&(m.fixedRowsBottom-=Math.min(Je,qo)),De+=Je}})};Array.isArray(b)?Ze(Z(b)):Ze([[b,B]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var st=function(Me){var De=0;A(Me,function(dr){var Bt=$n(dr,2),Ve=Bt[0],Je=Bt[1],St=Xt(Ve)?a.countCols()-1:Math.max(Ve-De,0),ut=a.toPhysicalColumn(St);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ft=s.removeCol(Ve,Je,x);if(ft){var et=m.fixedColumnsStart;et>=St+1&&(m.fixedColumnsStart-=Math.min(Je,et-St)),Array.isArray(m.colHeaders)&&(typeof ut>"u"&&(ut=-1),m.colHeaders.splice(ut,Je)),De+=Je}})};Array.isArray(b)?st(Z(b)):st([[b,B]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(p,'"'))}K||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var p=m.minRows,b=m.minSpareRows,T=m.minCols,E=m.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&O.deselect(),p){var B=a.countRows();B<p&&s.createRow(B,p-B,{source:"auto"})}if(b){var x=a.countEmptyRows(!0);if(x<b){var K=b-x,Z=Math.min(K,m.maxRows-a.countSourceRows());s.createRow(a.countRows(),Z,{source:"auto"})}}{var re;(T||E)&&(re=a.countEmptyCols(!0));var ie=a.countCols();if(T&&!m.columns&&ie<T){var se=T-ie;re+=se,s.createCol(ie,se,{source:"auto"})}if(E&&!m.columns&&a.dataType==="array"&&re<E){ie=a.countCols();var _e=E-re,Se=Math.min(_e,m.maxCols-ie);s.createCol(ie,Se,{source:"auto"})}}if(O.isSelected()){var z=a.countRows(),Ne=a.countCols();A(O.selectedRange,function(Be){var ke=!1,Ie=Be.from.row,Ae=Be.from.col,_=Be.to.row,P=Be.to.col;Ie>z-1?(Ie=z-1,ke=!0,_>Ie&&(_=Ie)):_>z-1&&(_=z-1,ke=!0,Ie>_&&(Ie=_)),Ae>Ne-1?(Ae=Ne-1,ke=!0,P>Ae&&(P=Ae)):P>Ne-1&&(P=Ne-1,ke=!0,Ae>P&&(Ae=P)),ke&&a.selectCell(Ie,Ae,_,P)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(p,b,T,E,B){var x,K,Z,re,ie=[],se={},_e=[],Se=p.row,z=p.col;if(K=b.length,K===0)return!1;var Ne=0,Be=0;switch(Ue(T)&&(Ne=T.col-z+1,Be=T.row-Se+1),B){case"shift_down":var ke=Tc(b),Ie=ke.length,Ae=Math.max(Ie,Ne),_=a.getData().slice(Se),P=Tc(_).slice(z,z+Ae);for(Z=0;Z<Ae;Z+=1)if(Z<Ie){for(x=0,K=ke[Z].length;x<Be-K;x+=1)ke[Z].push(ke[Z][x%K]);Z<P.length?_e.push(ke[Z].concat(P[Z])):_e.push(ke[Z].concat(new Array(_.length).fill(null)))}else _e.push(ke[Z%Ie].concat(P[Z]));a.populateFromArray(Se,z,Tc(_e));break;case"shift_right":var I=b.length,F=Math.max(I,Be),M=a.getData().slice(Se).map(function(Ve){return Ve.slice(z)});for(x=0;x<F;x+=1)if(x<I){for(Z=0,re=b[x].length;Z<Ne-re;Z+=1)b[x].push(b[x][Z%re]);if(x<M.length)for(var V=0;V<M[x].length;V+=1)b[x].push(M[x][V]);else{var N;(N=b[x]).push.apply(N,Pl(new Array(M[0].length).fill(null)))}}else b.push(b[x%K].slice(0,F).concat(M[x]));a.populateFromArray(Se,z,b);break;case"overwrite":default:se.row=p.row,se.col=p.col;var D=0,W=0,L=!0,Y,le=function(Je){var St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ut=b[Je%b.length];return St!==null?ut[St%ut.length]:ut},pe=b.length,Re=T?T.row-p.row+1:0;for(T?K=Re:K=Math.max(pe,Re),x=0;x<K&&!(T&&se.row>T.row&&Re>pe||!m.allowInsertRow&&se.row>a.countRows()-1||se.row>=m.maxRows);x++){var He=x-D,Ze=le(He).length,st=T?T.col-p.col+1:0;if(T?re=st:re=Math.max(Ze,st),se.col=p.col,Y=a.getCellMeta(se.row,se.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&Y.skipRowOnPaste){D+=1,se.row+=1,K+=1;continue}for(W=0,Z=0;Z<re&&!(T&&se.col>T.col&&st>Ze||!m.allowInsertColumn&&se.col>a.countCols()-1||se.col>=m.maxCols);Z++){if(Y=a.getCellMeta(se.row,se.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&Y.skipColumnOnPaste){W+=1,se.col+=1,re+=1;continue}if(Y.readOnly&&E!=="UndoRedo.undo"){se.col+=1;continue}var Ge=Z-W,Me=le(He,Ge),De=a.getDataAtCell(se.row,se.col);if(Me!==null&&Er(Me)==="object")if(Array.isArray(Me)&&De===null&&(De=[]),De===null||Er(De)!=="object")L=!1;else{var dr=ys(Array.isArray(De)?De:De[0]||De),Bt=ys(Array.isArray(Me)?Me:Me[0]||Me);Hm(dr,Bt)||Array.isArray(dr)&&Array.isArray(Bt)?Me=fr(Me):L=!1}else De!==null&&Er(De)==="object"&&(L=!1);L&&ie.push([se.row,se.col,Me]),L=!0,se.col+=1}se.row+=1}a.setDataAtCell(ie,null,null,E||"populateFromArray");break}}};function U(g){var p=OU(g);UP(p)?(a.runHooks("beforeLanguageChange",p),w.language=p,a.runHooks("afterLanguageChange",p)):RU(g)}function q(g,p){var b=g==="className"?a.rootElement:a.table;if(h)te(b,p);else{var T=[],E=[];w[g]&&(T=Array.isArray(w[g])?w[g]:FC(w[g])),p&&(E=Array.isArray(p)?p:FC(p));var B=jC(T,E),x=jC(E,T);B.length&&Le(b,B),x.length&&te(b,x)}w[g]=p}this.init=function(){u.setData(m.data),a.runHooks("beforeInit"),(pn()||_E())&&te(a.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new xTe(this),c=ese.getInstance(a,m,O),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&iW(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Er(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function G(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function X(g){var p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function Q(g,p,b){if(g.length){var T=a.getActiveEditor(),E=new G,B=!0;E.onQueueEmpty=function(Se){T&&B&&T.cancelChanges(),b(Se)};for(var x=g.length-1;x>=0;x--){var K=$n(g[x],4),Z=K[0],re=K[1],ie=K[3],se=s.propToCol(re),_e=a.getCellMeta(Z,se);_e.type==="numeric"&&typeof ie=="string"&&pW(ie)&&(g[x][3]=X(ie)),a.getCellValidator(_e)&&(E.addValidatorToQueue(),a.validateCell(g[x][3],_e,function(Se,z){return function(Ne){if(typeof Ne!="boolean")throw new Error("Validation error: result is not boolean");if(Ne===!1&&z.allowInvalid===!1){B=!1,g.splice(Se,1),z.valid=!0;var Be=a.getCell(z.visualRow,z.visualCol);Be!==null&&Le(Be,m.invalidCellClassName)}E.removeValidatorFormQueue()}}(x,_e),p))}E.checkIfQueueIsEmpty()}}function oe(g,p){var b=g.length-1;if(!(b<0)){for(;b>=0;b--){var T=!1;if(g[b]===null){g.splice(b,1);continue}if(!((g[b][2]===null||g[b][2]===void 0)&&(g[b][3]===null||g[b][3]===void 0))){if(m.allowInsertRow)for(;g[b][0]>a.countRows()-1;){var E=s.createRow(void 0,void 0,{source:p}),B=E.delta;if(B===0){T=!0;break}}if(a.dataType==="array"&&(!m.columns||m.columns.length===0)&&m.allowInsertColumn)for(;s.propToCol(g[b][1])>a.countCols()-1;){var x=s.createCol(void 0,void 0,{source:p}),K=x.delta;if(K===0){T=!0;break}}T||s.set(g[b][0],g[b][1],g[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,p),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,p||"edit");var Z=a.getActiveEditor();Z&&ve(Z.refreshValue)&&Z.refreshValue()}}this._createCellCoords=function(g,p){return a.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,b){return a.view._wt.createCellRange(g,p,b)},this.validateCell=function(g,p,b,T){var E=a.getCellValidator(p);function B(x){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!K||p.hidden===!0){b(x);return}var Z=p.visualCol,re=p.visualRow,ie=a.getCell(re,Z,!0);if(ie&&ie.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(re),_e=a.columnIndexMapper.getRenderableFromVisualIndex(Z);a.view._wt.getSetting("cellRenderer",se,_e,ie)}b(x)}OV(E)&&(E=function(x){return function(K,Z){Z(x.test(K))}}(E)),pt(E)?(g=a.runHooks("beforeValidate",g,p.visualRow,p.prop,T),a._registerImmediate(function(){E.call(p,g,function(x){a&&(x=a.runHooks("afterValidate",x,g,p.visualRow,p.prop,T),p.valid=x,B(x),a.runHooks("postAfterValidate",x,g,p.visualRow,p.prop,T))})})):a._registerImmediate(function(){p.valid=!0,B(p.valid,!1)})};function J(g,p,b){return Array.isArray(g)?g:[[g,p,b]]}function ue(g,p){var b=a.getActiveEditor(),T=a.runHooks("beforeChange",g,p||"edit"),E=g.filter(function(B){return B!==null});return T===!1||E.length===0?(b&&b.cancelChanges(),[]):E}this.setDataAtCell=function(g,p,b,T){var E=J(g,p,b),B=[],x=T,K,Z,re;for(K=0,Z=E.length;K<Z;K++){if(Er(E[K])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof E[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");E[K][1]>=this.countCols()?re=E[K][1]:re=s.colToProp(E[K][1]),B.push([E[K][0],re,u.getAtCell(this.toPhysicalRow(E[K][0]),E[K][1]),E[K][2]])}!x&&Er(g)==="object"&&(x=p);var ie=ue(B,T);a.runHooks("afterSetDataAtCell",ie,x),Q(ie,x,function(){oe(ie,x)})},this.setDataAtRowProp=function(g,p,b,T){var E=J(g,p,b),B=[],x=T,K,Z;for(K=0,Z=E.length;K<Z;K++)B.push([E[K][0],E[K][1],u.getAtCell(this.toPhysicalRow(E[K][0]),E[K][1]),E[K][2]]);!x&&Er(g)==="object"&&(x=p);var re=ue(B,T);a.runHooks("afterSetDataAtRowProp",re,x),Q(re,x,function(){oe(re,x)})},this.listen=function(){a&&!a.isListening()&&(sS=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(sS=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return sS===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,p)},this.populateFromArray=function(g,p,b,T,E,B,x){if(!(Er(b)==="object"&&Er(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var K=typeof T=="number"?a._createCellCoords(T,E):null;return f.populateFromArray(a._createCellCoords(g,p),b,K,B,x)},this.spliceCol=function(g,p,b){for(var T,E=arguments.length,B=new Array(E>3?E-3:0),x=3;x<E;x++)B[x-3]=arguments[x];return(T=s).spliceCol.apply(T,[g,p,b].concat(B))},this.spliceRow=function(g,p,b){for(var T,E=arguments.length,B=new Array(E>3?E-3:0),x=3;x<E;x++)B[x-3]=arguments[x];return(T=s).spliceRow.apply(T,[g,p,b].concat(B))},this.getSelected=function(){if(O.isSelected())return We(O.getSelectedRange(),function(g){var p=g.from,b=g.to;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){var g=this.getSelected(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){var p=this;if(!(!O.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];A(O.getSelectedRange(),function(T){var E=T.getTopStartCorner(),B=T.getBottomEndCorner();Ce(E.row,B.row,function(x){Ce(E.col,B.col,function(K){p.getCellMeta(x,K).readOnly||b.push([x,K,null])})})}),b.length>0&&this.setDataAtCell(b,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=g();return this.resumeExecution(p),b},this.batch=function(g){this.suspendRender(),this.suspendExecution();var p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),p=g.width,b=g.height,T=a.rootElement.getBoundingClientRect(),E=T.width,B=T.height,x=E!==p||B!==b,K=a.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:E,height:B},x)===!1;K||((x||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(E,B),a.render()),a.runHooks("afterRefreshDimensions",{width:p,height:b},{width:E,height:B},x))}},this.updateData=function(g,p){var b=this;PD(g,function(T){s=T},function(T){s=T,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:p,metaManager:y,firstRun:h})},this.loadData=function(g,p){PD(g,function(b){s=b},function(){y.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:p,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var g=m.columns,p=0;if(Array.isArray(g))p=g.length;else if(pt(g))if(a.dataType==="array")for(var b=this.countSourceCols(),T=0;T<b;T+=1)g(T)&&(p+=1);else(a.dataType==="object"||a.dataType==="function")&&(p=s.colToPropCache.length);else if(ve(m.dataSchema)){var E=s.getSchema();p=Array.isArray(E)?E.length:Lm(E)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,b,T){return mt(g)?s.getAll():s.getRange(a._createCellCoords(g,p),a._createCellCoords(b,T),s.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,b,T){return s.getCopyableText(a._createCellCoords(g,p),a._createCellCoords(b,T))},this.getCopyableData=function(g,p){return s.getCopyable(g,s.colToProp(p))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),T=!1,E,B;if(ve(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ve(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ve(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(E in g)E==="data"||(E==="language"?U(g.language):E==="className"?q("className",g.className):E==="tableClassName"&&a.table?(q("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(E)||ge.getSingleton().isDeprecated(E)?(pt(g[E])||Array.isArray(g[E]))&&(g[E].initialHook=!0,a.addHook(E,g[E])):!p&&xt(g,E)&&(w[E]=g[E]));g.data===void 0&&m.data===void 0?b(null,"updateSettings"):g.data!==void 0?b(g.data,"updateSettings"):g.columns!==void 0&&(s.createMap(),a.initIndexMappers());var x=a.countCols(),K=m.columns;if(K&&pt(K)&&(T=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),x>0)for(E=0,B=0;E<x;E++){if(K){var Z=T?K(E):K[B];Z&&y.updateColumnMeta(B,Z)}B+=1}ve(g.cell)&&ze(g.cell,function(z){a.setCellMetaObject(z.row,z.col,z)}),a.runHooks("afterCellMetaReset");var re=a.rootElement.style.height;re!==""&&(re=parseInt(a.rootElement.style.height,10));var ie=g.height;if(pt(ie)&&(ie=ie()),p){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ie===null){var _e=a.rootElement.getAttribute("data-initialstyle");_e&&(_e.indexOf("height")>-1||_e.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",_e):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ie!==void 0&&(a.rootElement.style.height=isNaN(ie)?"".concat(ie):"".concat(ie,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var Se=g.width;pt(Se)&&(Se=Se()),a.rootElement.style.width=isNaN(Se)?"".concat(Se):"".concat(Se,"px")}p||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!p&&a.view&&(re===""||ie===""||ie===void 0)&&re!==ie&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(m.getValue){if(pt(m.getValue))return m.getValue.call(a);if(g)return a.getData()[g[0][0]][m.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return m},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,b,T,E){f.alter(g,p,b,T,E)},this.getCell=function(g,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,T=p,E=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;T=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;E=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return E===null||T===null?null:a.view.getCellAtCoords(a._createCellCoords(E,T),b)},this.getCoords=function(g){var p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;var b=p.row,T=p.col,E=b,B=T;return b>=0&&(E=this.rowIndexMapper.getVisualFromRenderableIndex(b)),T>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(T)),a._createCellCoords(E,B)},this.colToProp=function(g){return s.colToProp(g)},this.propToCol=function(g){return s.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,p){return s.get(g,s.colToProp(p))},this.getDataAtRowProp=function(g,p){return s.get(g,p)},this.getDataAtCol=function(g){for(var p=[],b=s.getRange(a._createCellCoords(0,g),a._createCellCoords(m.data.length-1,g),s.DESTINATION_RENDERER),T=0;T<b.length;T+=1)for(var E=0;E<b[T].length;E+=1)p.push(b[T][E]);return p},this.getDataAtProp=function(g){for(var p=[],b=s.getRange(a._createCellCoords(0,s.propToCol(g)),a._createCellCoords(m.data.length-1,s.propToCol(g)),s.DESTINATION_RENDERER),T=0;T<b.length;T+=1)for(var E=0;E<b[T].length;E+=1)p.push(b[T][E]);return p},this.getSourceData=function(g,p,b,T){var E;return g===void 0?E=u.getData():E=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(b,T)),E},this.getSourceDataArray=function(g,p,b,T){var E;return g===void 0?E=u.getData(!0):E=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(b,T),!0),E},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,b,T){var E=J(g,p,b),B=this.hasHook("afterSetSourceDataAtCell"),x=[];B&&A(E,function(Z){var re=$n(Z,3),ie=re[0],se=re[1],_e=re[2];x.push([ie,se,u.getAtCell(ie,se),_e])}),A(E,function(Z){var re=$n(Z,3),ie=re[0],se=re[1],_e=re[2];u.setAtCell(ie,se,_e)}),B&&this.runHooks("afterSetSourceDataAtCell",x,T),this.render();var K=a.getActiveEditor();K&&ve(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return u.getAtCell(g,p)},this.getDataAtRow=function(g){var p=s.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),s.DESTINATION_RENDERER);return p[0]||[]},this.getDataType=function(g,p,b,T){var E=this,B=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,b,T],x=B[0],K=B[1],Z=B[2],re=B[3],ie=null,se=null;Z===void 0&&(Z=x),re===void 0&&(re=K);var _e="mixed";return Ce(Math.max(Math.min(x,Z),0),Math.max(x,Z),function(Se){var z=!0;return Ce(Math.max(Math.min(K,re),0),Math.max(K,re),function(Ne){var Be=E.getCellMeta(Se,Ne);return se=Be.type,ie?z=ie===se:ie=se,z}),_e=z?se:"mixed",z}),_e},this.removeCellMeta=function(g,p,b){var T=[this.toPhysicalRow(g),this.toPhysicalColumn(p)],E=T[0],B=T[1],x=y.getCellMetaKeyValue(E,B,b),K=a.runHooks("beforeRemoveCellMeta",g,p,b,x);K!==!1&&(y.removeCellMeta(E,B,b),a.runHooks("afterRemoveCellMeta",g,p,b,x)),x=null},this.spliceCellsMeta=function(g){for(var p=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=arguments.length,E=new Array(T>2?T-2:0),B=2;B<T;B++)E[B-2]=arguments[B];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&y.removeRow(this.toPhysicalRow(g),b),E.length>0&&A(E.reverse(),function(x){y.createRow(p.toPhysicalRow(g)),A(x,function(K,Z){return p.setCellMetaObject(g,Z,K)})}),a.render()},this.setCellMetaObject=function(g,p,b){var T=this;Er(b)==="object"&&ze(b,function(E,B){T.setCellMeta(g,p,B,E)})},this.setCellMeta=function(g,p,b,T){var E=a.runHooks("beforeSetCellMeta",g,p,b,T);if(E!==!1){var B=g,x=p;g<this.countRows()&&(B=this.toPhysicalRow(g)),p<this.countCols()&&(x=this.toPhysicalColumn(p)),y.setCellMeta(B,x,b,T),a.runHooks("afterSetCellMeta",g,p,b,T)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,p){var b=this.toPhysicalRow(g),T=this.toPhysicalColumn(p);return b===null&&(b=g),T===null&&(T=p),y.getCellMeta(b,T,{visualRow:g,visualColumn:p})},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||m.columns)},this.getCellRenderer=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).renderer:g.renderer;return typeof b=="string"?lp(b):mt(b)?lp("text"):b},this.getCellEditor=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).editor:g.editor;return typeof b=="string"?rp(b):mt(b)?rp("text"):b},this.getCellValidator=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).validator:g.validator;return typeof b=="string"?ZE(b):b},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,b){var T=new G;g&&(T.onQueueEmpty=g);for(var E=a.countRows()-1;E>=0;){if(p!==void 0&&p.indexOf(E)===-1){E-=1;continue}for(var B=a.countCols()-1;B>=0;){if(b!==void 0&&b.indexOf(B)===-1){B-=1;continue}T.addValidatorToQueue(),a.validateCell(a.getDataAtCell(E,B),a.getCellMeta(E,B),function(x){if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(T.valid=!1),T.removeValidatorFormQueue()},"validateCells"),B-=1}E-=1}T.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var p=m.rowHeaders,b=g;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(p=[],Ce(a.countRows()-1,function(T){p.push(a.getRowHeader(T))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:pt(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!m.rowHeaders},this.hasColHeaders=function(){if(m.colHeaders!==void 0&&m.colHeaders!==null)return!!m.colHeaders;for(var g=0,p=a.countCols();g<p;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",g);if(b===void 0){for(var T=[],E=a.countCols(),B=0;B<E;B++)T.push(a.getColHeader(B));return T}var x=m.colHeaders,K=function(se){for(var _e=[],Se=a.countCols(),z=0;z<Se;z++)pt(m.columns)&&m.columns(z)&&_e.push(z);return _e[se]},Z=a.toPhysicalColumn(b),re=K(Z);return m.colHeaders===!1?x=null:m.columns&&pt(m.columns)&&m.columns(re)&&m.columns(re).title?x=m.columns(re).title:m.columns&&m.columns[Z]&&m.columns[Z].title?x=m.columns[Z].title:Array.isArray(m.colHeaders)&&m.colHeaders[Z]!==void 0?x=m.colHeaders[Z]:pt(m.colHeaders)?x=m.colHeaders(Z):m.colHeaders&&typeof m.colHeaders!="string"&&typeof m.colHeaders!="number"&&(x=ab(b)),x=a.runHooks("modifyColumnHeaderValue",x,g,p),x},this._getColWidthFromSettings=function(g){var p;if(g>=0){var b=a.getCellMeta(0,g);p=b.width}if((p===void 0||p===m.width)&&(p=m.colWidths),p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g){var p=a._getColWidthFromSettings(g);return p=a.runHooks("modifyColWidth",p,g),p===void 0&&(p=rT.DEFAULT_WIDTH),p},this._getRowHeightFromSettings=function(g){var p=m.rowHeights;if(p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(g){var p=a._getRowHeightFromSettings(g);return p=a.runHooks("modifyRowHeight",p,g),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var g=m.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return op(a.countRows()-1,function(b){if(a.isEmptyRow(b))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return op(a.countCols()-1,function(b){if(a.isEmptyCol(b))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return m.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return m.isEmptyCol.call(a,g)},this.selectCell=function(g,p,b,T){var E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mt(g)||mt(p)?!1:this.selectCells([[g,p,b,T]],E,B)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&(i=!0);var T=O.selectCells(g);return T&&b&&a.listen(),i=!1,T},this.selectColumns=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return O.selectColumns(g,p)},this.selectRows=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return O.selectRows(g,p)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=g&&this.hasRowHeaders(),b=g&&this.hasColHeaders();i=!0,O.selectAll(p,b),i=!1};var he=function(p,b){return p.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(g,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=!b,x=!T,K=g,Z=p;if(E){var re=Number.isInteger(g),ie=Number.isInteger(p),se=re?he(this.rowIndexMapper,g):void 0,_e=ie?he(this.columnIndexMapper,p):void 0;if(se===null||_e===null)return!1;K=re?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,Z=ie?a.columnIndexMapper.getRenderableFromVisualIndex(_e):void 0}var Se=Number.isInteger(K),z=Number.isInteger(Z);return Se&&z?a.view.scrollViewport(a._createCellCoords(K,Z),B,T,b,x):Se&&z===!1?a.view.scrollViewportVertically(K,B,b):z&&Se===!1?a.view.scrollViewportHorizontally(Z,T,x):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),EO(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Cn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),C.getItems().forEach(function(p){var b=$n(p,2),T=b[1];T.destroy()}),C.clear(),a.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(a),ze(a,function(p,b,T){pt(p)?T[b]=Oe(b):b!=="guid"&&(T[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,O=null,c=null,a=null};function Oe(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){var p=ur(g);return p==="UndoRedo"?this.undoRedo:C.getItem(p)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,p){ge.getSingleton().add(g,p,a)},this.hasHook=function(g){return ge.getSingleton().has(g,a)||ge.getSingleton().has(g)},this.addHookOnce=function(g,p){ge.getSingleton().once(g,p,a)},this.removeHook=function(g,p){ge.getSingleton().remove(g,p,a)},this.runHooks=function(g,p,b,T,E,B,x){return ge.getSingleton().run(a,g,p,b,T,E,B,x)},this.getTranslatedPhrase=function(g,p){return AU(m.language,g,p)},this.toHTML=function(){return OO(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",OO(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=g;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){A(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){A(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(g),a.view.render(),p&&O.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var we=p1e({handleEvent:function(p){var b=a.isListening(),T=(p==null?void 0:p.key)!==void 0;return b&&T},beforeKeyDown:function(p){return n.runHooks("beforeKeyDown",p)},afterKeyDown:function(p){n.isDestroyed||a.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we};var $=we.addContext("grid"),k={runOnlyIf:function(){return ve(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:O1e};we.setActiveContextName("grid"),$.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var p=a.getSelectedRange(),b=p[p.length-1].highlight,T=b.row,E=b.col,B=a.getDataAtCell(T,E),x=new Map,K=0;K<p.length;K++)p[K].forAll(function(Z,re){if(Z>=0&&re>=0&&(Z!==T||re!==E)){var ie=a.getCellMeta(Z,re),se=ie.readOnly;se||x.set("".concat(Z,"x").concat(re),[Z,re,B])}});a.setDataAtCell(Array.from(x.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){O.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){O.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,T=p.to,E=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);O.setRangeStart(b.clone()),O.setRangeEnd(a._createCellCoords(E,T.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){O.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){O.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,T=p.to,E=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);O.setRangeStart(b.clone()),O.setRangeEnd(a._createCellCoords(E,T.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){O.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,T=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Pl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));O.setRangeStart(a._createCellCoords(b,T))}},{keys:[["ArrowLeft","Shift"]],callback:function(){O.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),T=b.from,E=b.to,B=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Pl(a.isRtl()?[a.countCols()-1,-1]:[0,1]));O.setRangeStart(T.clone()),O.setRangeEnd(a._createCellCoords(E.row,B))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){O.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,T=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Pl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));O.setRangeStart(a._createCellCoords(b,T))}},{keys:[["ArrowRight","Shift"]],callback:function(){O.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),T=b.from,E=b.to,B=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,Pl(a.isRtl()?[0,1]:[a.countCols()-1,-1]));O.setRangeStart(T.clone()),O.setRangeEnd(a._createCellCoords(E.row,B))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,T=a.columnIndexMapper.getNearestNotHiddenIndex(p,1);O.setRangeStart(a._createCellCoords(b,T))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){O.setRangeEnd(a._createCellCoords(O.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),T=a.rowIndexMapper.getNearestNotHiddenIndex(p,1),E=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);O.setRangeStart(a._createCellCoords(T,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){O.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){O.setRangeEnd(a._createCellCoords(O.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-p-1,-1),T=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);O.setRangeStart(a._createCellCoords(b,T))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){O.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,T=Math.max(b.row-a.countVisibleRows(),0),E=a.rowIndexMapper.getNearestNotHiddenIndex(T,1);if(E!==null){var B=a._createCellCoords(E,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.max(B.row-x,0);O.setRangeEnd(B),a.scrollViewportTo(K)}}},{keys:[["PageDown"]],callback:function(){O.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,T=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),E=a.rowIndexMapper.getNearestNotHiddenIndex(T,-1);if(E!==null){var B=a._createCellCoords(E,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.min(B.row-x,a.countRows()-1);O.setRangeEnd(B),a.scrollViewportTo(K)}}},{keys:[["Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;O.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;O.transformStart(-b.row,-b.col)}}],k),eT().forEach(function(g){var p=Av(g);C.addItem(g,new p(n))}),ge.getSingleton().run(a,"construct")}function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function xD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function DD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xD(Object(r),!0).forEach(function(n){R1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R1e(e,t,r){return t=GU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ND(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GU(n.key),n)}}function T1e(e,t,r){return t&&ND(e.prototype,t),r&&ND(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GU(e){var t=P1e(e,"string");return gd(t)==="symbol"?t:String(t)}function P1e(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HD=215,KU="menu",k1e=KU,qU=function(){function e(t,r){E1e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:HD,container:this.hot.rootDocument.documentElement},this.eventManager=new Pt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return T1e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=qc(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=NE(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||HD,i=!1,a=Wr(this.menuItems,function(d){return d.key===Vh&&(i=!0),KRe(d,r.hot)});if(a.length<1&&!i)a.push(sU()[Vh]);else if(a.length===0)return;a=ZRe(a,qe);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ve(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,y,m,w,C,S){return r.menuItemRenderer(v,y,m,w,C,S)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,y){r.isAllSubMenusClosed()?n(y.row):r.openSubMenu(y.row)},rowHeights:function(v){return a[v].name===qe?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),WC()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!WC()||!$i(v))&&l&&r.hasSelectedItem()&&(pn()||_E()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new GP(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(k1e),c={group:KU},h=DD(DD({},c),{},{runOnlyIf:function(v){return Qc(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var y=r.openSubMenu(v[0]);y&&y.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(y[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!URe(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;A(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?WRe(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===qe||l===!0||a}},{key:"setPosition",value:function(r){var n=new vEe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);wy(r)||Sy(r)||Cy(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);wy(n)||Sy(n)||Cy(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(wy(i)||Sy(i)||Cy(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(wy(i)||Sy(i)||Cy(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return xt(w,"submenu")},h=function(w){return new RegExp(qe,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},y=l;typeof y=="function"&&(y=y.call(this.hot)),Cn(n),te(f,"htItemWrapper"),n.appendChild(f),h(u)?te(n,"htSeparator"):typeof u.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,y))):sl(f,y),d(u)?(te(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(te(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(te(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Le(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(pt(o)&&(o=o.call(this.hot),o===null||mt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),te(i,"htMenu ".concat(this.options.className)),o&&te(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=Ft(n,function(s,u){return s+(u.name===qe?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!mi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!mi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&mi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();gt(qU,Mr);const KP=qU;function _u(e){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u(e)}function $1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I1e(n.key),n)}}function A1e(e,t,r){return t&&LD(e.prototype,t),r&&LD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I1e(e){var t=M1e(e,"string");return _u(t)==="symbol"?t:String(t)}function M1e(e,t){if(_u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=x1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function x1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function D1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BO(e,t)}function BO(e,t){return BO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},BO(e,t)}function N1e(e){var t=L1e();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return H1e(this,o)}}function H1e(e,t){if(t&&(_u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XU(e)}function XU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}var Ty="contextMenu",j1e=70;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var ZU=function(e){D1e(r,e);var t=N1e(r);function r(n){var o;return $1e(this,r),o=t.call(this,n),o.eventManager=new Pt(XU(o)),o.commandExecutor=new iU(o.hot),o.itemsFactory=null,o.menu=null,o}return A1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ty]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Ty];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new KP(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),pa(wo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pa(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),pa(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-ms(o.view),a=f-Ba(o.view)}else i=-1*ms(this.menu.hotMenu.rootWindow),a=-1*Ba(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new uU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Ty],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),pa(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ty}},{key:"PLUGIN_PRIORITY",get:function(){return j1e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[nb,ob,qe,Dv,Nv,qe,rb,Lv,qe,ib,Jm,qe,Hv,qe,Xr]}}]),r}(ot);ZU.SEPARATOR={name:qe};function F1e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(IT)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function B1e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(DT,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function V1e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(xT,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function W1e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(MT,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function U1e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(NT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function z1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G1e(n.key),n)}}function Y1e(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function G1e(e){var t=K1e(e,"string");return pd(t)==="symbol"?t:String(t)}function K1e(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q1e=function(){function e(){z1e(this,e),this.data={}}return Y1e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z1e(n.key),n)}}function X1e(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z1e(e){var t=Q1e(e,"string");return md(t)==="symbol"?t:String(t)}function Q1e(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var eAe=X1e(function e(){J1e(this,e),this.clipboardData=new q1e});function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function tAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nAe(n.key),n)}}function rAe(e,t,r){return t&&BD(e.prototype,t),r&&BD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nAe(e){var t=oAe(e,"string");return bd(t)==="symbol"?t:String(t)}function oAe(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qP=function(){function e(t){tAe(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Pt(this),this.listenersCount=new WeakSet,this.container=t}return rAe(e,[{key:"useSecondaryElement",value:function(){var r=lAe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),VD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),VD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",pn()||oW(this.mainElement)}}]),e}();gt(qP,Mr);var Vp=new WeakMap;function iAe(e){var t=new qP(e),r=Vp.get(e);return r=isNaN(r)?0:r,Vp.set(e,r+1),t}function aAe(e){e.eventManager.clear()}var uS=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function VD(e,t,r){e.addEventListener(t,"copy",uS("copy",r)),e.addEventListener(t,"cut",uS("cut",r)),e.addEventListener(t,"paste",uS("paste",r))}var Wp=new WeakMap;function lAe(e){var t=Wp.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Wp.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function WD(e){if(e instanceof qP){var t=Vp.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),aAe(e),t<=0){t=0;var r=Wp.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Wp.delete(e.container)),e.mainElement=null}Vp.set(e.container,t)}}function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function sAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fAe(n.key),n)}}function uAe(e,t,r){return t&&UD(e.prototype,t),r&&UD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fAe(e){var t=cAe(e,"string");return wd(t)==="symbol"?t:String(t)}function cAe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zD(e,t){QU(e,t),t.add(e)}function kl(e,t,r){QU(e,t),t.set(e,r)}function QU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Py(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function mr(e,t){var r=JU(e,t,"get");return hAe(e,r)}function hAe(e,t){return t.get?t.get.call(e):t.value}function $l(e,t,r){var n=JU(e,t,"set");return dAe(e,n,r),r}function JU(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function dAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ei=new WeakMap,fS=new WeakMap,ic=new WeakMap,VO=new WeakMap,WO=new WeakMap,ac=new WeakMap,ky=new WeakSet,YD=new WeakSet,vAe=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;sAe(this,e),zD(this,YD),zD(this,ky),kl(this,ei,{writable:!0,value:void 0}),kl(this,fS,{writable:!0,value:void 0}),kl(this,ic,{writable:!0,value:void 0}),kl(this,VO,{writable:!0,value:void 0}),kl(this,WO,{writable:!0,value:void 0}),kl(this,ac,{writable:!0,value:void 0}),$l(this,fS,r),$l(this,ic,n),$l(this,VO,o),$l(this,WO,i),$l(this,ac,a)}return uAe(e,[{key:"setSelectedRange",value:function(r){$l(this,ei,r)}},{key:"getCellsRange",value:function(){if(mr(this,fS).call(this)===0||mr(this,ic).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.row,o=r.col,i=mr(this,ei).getBottomEndCorner(),a=i.row,l=i.col,s=Py(this,YD,yAe).call(this,n,a),u=Py(this,ky,cS).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(mr(this,ic).call(this)===0||mr(this,ac).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.col,o=mr(this,ei).getBottomEndCorner(),i=o.col,a=Py(this,ky,cS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(mr(this,ic).call(this)===0||mr(this,ac).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.col,o=mr(this,ei).getBottomEndCorner(),i=o.col,a=Py(this,ky,cS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-mr(this,ac).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function cS(e,t){return Math.min(t,Math.max(e+mr(this,WO).call(this)-1,e))}function yAe(e,t){return Math.min(t,Math.max(e+mr(this,VO).call(this)-1,e))}function ez(e){var t=[],r=[];return A(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Ce(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);Ce(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function gAe(e,t){return wAe(e)||bAe(e,t)||mAe(e,t)||pAe()}function pAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mAe(e,t){if(e){if(typeof e=="string")return GD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GD(e,t)}}function GD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wAe(e){if(Array.isArray(e))return e}function Qa(e){"@babel/helpers - typeof";return Qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qa(e)}function SAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rz(n.key),n)}}function CAe(e,t,r){return t&&KD(e.prototype,t),r&&KD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=_Ae(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function _Ae(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function OAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UO(e,t)}function RAe(e){var t=TAe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return EAe(this,o)}}function EAe(e,t){if(t&&(Qa(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pr(e)}function pr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function PAe(e,t){tz(e,t),t.add(e)}function Zi(e,t,r){tz(e,t),t.set(e,r)}function tz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(e,t,r){return t=rz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rz(e){var t=kAe(e,"string");return Qa(t)==="symbol"?t:String(t)}function kAe(e,t){if(Qa(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qa(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ae(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Dr(e,t){var r=nz(e,t,"get");return AAe(e,r)}function AAe(e,t){return t.get?t.get.call(e):t.value}function Jn(e,t,r){var n=nz(e,t,"set");return IAe(e,n,r),r}function nz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function IAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");var $y="copyPaste",MAe=80,xAe=["fragmentSelection"],qD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),hS=new WeakMap,dS=new WeakMap,vS=new WeakMap,Il=new WeakMap,Ay=new WeakMap,Iy=new WeakMap,Ml=new WeakMap,XD=new WeakSet,DAe=function(e){OAe(r,e);var t=RAe(r);function r(){var n;SAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),PAe(pr(n),XD),Al(pr(n),"columnsLimit",1/0),Al(pr(n),"rowsLimit",1/0),Al(pr(n),"pasteMode","overwrite"),Al(pr(n),"uiContainer",n.hot.rootDocument.body),Zi(pr(n),hS,{writable:!0,value:!1}),Zi(pr(n),dS,{writable:!0,value:!1}),Zi(pr(n),vS,{writable:!0,value:!1}),Zi(pr(n),Il,{writable:!0,value:"cells-only"}),Zi(pr(n),Ay,{writable:!0,value:!1}),Zi(pr(n),Iy,{writable:!0,value:!1}),Zi(pr(n),Ml,{writable:!0,value:new vAe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Al(pr(n),"copyableRanges",[]),Al(pr(n),"focusableElement",void 0),n}return CAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$y]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[$y];if(Qa(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Jn(this,hS,!!a.copyColumnHeaders),Jn(this,dS,!!a.copyColumnGroupHeaders),Jn(this,vS,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=iAe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),ma(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ma(So(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&WD(this.focusableElement),ma(So(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Jn(this,Il,o),Jn(this,Ay,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Jn(this,Iy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return Lc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=ez(o),s=l.rows,u=l.columns;return A(s,function(f){var c=[];A(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new eAe;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){Dr(this,Ml).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);Dr(this,Il)==="column-headers-only"?i.set("headers",Dr(this,Ml).getMostBottomColumnHeadersRange()):(Dr(this,Il)==="with-column-headers"?i.set("headers",Dr(this,Ml).getMostBottomColumnHeadersRange()):Dr(this,Il)==="with-column-group-headers"&&i.set("headers",Dr(this,Ml).getAllColumnHeadersRange()),i.set("cells",Dr(this,Ml).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,y=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,y=f,m=c,w=f,C=c;s.length<a||y<=d;){var S=this.hot.getCellMeta(y,c),R=S.skipRowOnPaste,O=S.visualRow;if(y=O+1,R!==!0){w=O,m=c;for(var j=[],U=s.length%a;j.length<l||m<=v;){var q=this.hot.getCellMeta(f,m),G=q.skipColumnOnPaste,X=q.visualCol;if(m=X+1,G!==!0){C=X;var Q=j.length%l;j.push(o[U][Q])}}s.push(j)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,C]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,Ay)||this.isEditorOpened())){this.setCopyableText(),Jn(this,Ay,!1);var i=this.getRangedData(this.copyableRanges),a=$Ae(this,XD,NAe).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=Lc(i);if(o&&o.clipboardData){var u=RO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[qD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Jn(this,Il,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,Iy)||this.isEditorOpened())){this.setCopyableText(),Jn(this,Iy,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=Lc(i);if(o&&o.clipboardData){var s=RO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[qD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=Bm(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=gU(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=Zke(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=gAe(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},F1e(this)),Dr(this,hS)&&o.items.push(W1e(this)),Dr(this,dS)&&o.items.push(V1e(this)),Dr(this,vS)&&o.items.push(B1e(this)),o.items.push(U1e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&tW())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(WD(this.focusableElement),this.focusableElement=null),ma(So(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $y}},{key:"SETTING_KEYS",get:function(){return[$y].concat(xAe)}},{key:"PLUGIN_PRIORITY",get:function(){return MAe}}]),r}(ot);function NAe(e){for(var t=ez(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function oz(e,t){return"border_row".concat(e,"col").concat(t)}function Sc(){return{width:1,color:"#000"}}function Co(){return{hide:!0}}function HAe(){return{width:1,color:"#000",cornerVisible:!1}}function yS(e){if(ve(e.start)||ve(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ve(e.end)||ve(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function lc(e){return ve(e.start)&&(e.left=e.start),ve(e.end)&&(e.right=e.end),e}function gS(e,t){return{id:oz(e,t),border:HAe(),row:e,col:t,top:Co(),bottom:Co(),start:Co(),end:Co()}}function LAe(e,t){return xt(t,"border")&&t.border&&(e.border=t.border),xt(t,"top")&&ve(t.top)&&(t.top?(Ue(t.top)||(t.top=Sc()),e.top=t.top):(t.top=Co(),e.top=t.top)),xt(t,"bottom")&&ve(t.bottom)&&(t.bottom?(Ue(t.bottom)||(t.bottom=Sc()),e.bottom=t.bottom):(t.bottom=Co(),e.bottom=t.bottom)),xt(t,"start")&&ve(t.start)&&(t.start?(Ue(t.start)||(t.start=Sc()),e.start=t.start):(t.start=Co(),e.start=t.start)),xt(t,"end")&&ve(t.end)&&(t.end?(Ue(t.end)||(t.end=Sc()),e.end=t.end):(t.end=Co(),e.end=t.end)),e}function Wo(e,t){var r=!1;return A(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!xt(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function cb(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function jAe(e){return e.some(function(t){return ve(t.left)||ve(t.right)})}function FAe(e){return e.some(function(t){return ve(t.start)||ve(t.end)})}var BAe=new Map([["left","start"],["right","end"]]);function VAe(e){var t;return(t=BAe.get(e))!==null&&t!==void 0?t:e}function WAe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(rP),n=Wo(this,"bottom");return n&&(r=cb(r)),r},callback:function(r,n){var o=Wo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function UAe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(nP),o=Wo(this,t);return o&&(n=cb(n)),n},callback:function(n,o){var i=Wo(this,t);e.prepareBorder(o,t,i)}}}function zAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(oP)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Wo(this)}}}function YAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(tP),o=Wo(this,t);return o&&(n=cb(n)),n},callback:function(n,o){var i=Wo(this,t);e.prepareBorder(o,t,i)}}}function GAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(eP),n=Wo(this,"top");return n&&(r=cb(r)),r},callback:function(r,n){var o=Wo(this,"top");e.prepareBorder(n,"top",o)}}}function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function ZD(e,t){return ZAe(e)||XAe(e,t)||qAe(e,t)||KAe()}function KAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qAe(e,t){if(e){if(typeof e=="string")return QD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QD(e,t)}}function QD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZAe(e){if(Array.isArray(e))return e}function QAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,az(n.key),n)}}function JAe(e,t,r){return t&&JD(e.prototype,t),r&&JD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=eIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function eIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function tIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function rIe(e){var t=oIe();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nIe(this,o)}}function nIe(e,t){if(t&&(Ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iz(e)}function iz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}function iIe(e,t,r){return t=az(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function az(e){var t=aIe(e,"string");return Ou(t)==="symbol"?t:String(t)}function aIe(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var My="customBorders",lIe=90,sIe=function(e){tIe(r,e);var t=rIe(r);function r(){var n;QAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),iIe(iz(n),"savedBorders",[]),n}return JAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[My]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),ba(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),ba(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),ba(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=yS(i));var u=bu(o),f=Bh(u);A(o,function(c){for(var h=f(c),d=ZD(h,4),v=d[0],y=d[1],m=d[2],w=d[3],C=function(O){for(var j=function(G){A(l,function(X){a.prepareBorderFromCustomAdded(O,G,s,VAe(X))})},U=y;U<=w;U+=1)j(U)},S=v;S<=m;S+=1)C(S)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=bu(o),l=Bh(a),s=[];return A(o,function(u){for(var f=l(u),c=ZD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=function(S){for(var R=function(U){A(i.savedBorders,function(q){q.row===S&&q.col===U&&s.push(lc(q))})},O=d;O<=y;O+=1)R(O)},w=h;w<=v;w+=1)m(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(A(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=gS(o,i);a&&(f=LAe(f,a),A(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",lc(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);Ce(o.from.row,l,function(u){Ce(o.from.col,s,function(f){var c=gS(u,f),h=0;u===o.from.row&&xt(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&xt(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&xt(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&xt(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",lc(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=oz(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=gS(o,i):s=yS(s),l){s[a]=Co();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",lc(s))}}else{s[a]=Sc();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",lc(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;A(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Ce(u.col,f.col,function(c){Ce(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":Ce(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":Ce(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":Ce(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":Ce(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;A(o,function(a){var l=yS(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return Ft(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=We(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;A(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;A(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=We(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):A(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return A(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return ze(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):A(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&ze(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[My];if(Array.isArray(o)){var i=fr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=jAe(o),a=FAe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[My]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(JT)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[GAe(this),YAe(this),WAe(this),UAe(this),zAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){ba(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return My}},{key:"PLUGIN_PRIORITY",get:function(){return lIe}}]),r}(ot);function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function uIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cIe(n.key),n)}}function fIe(e,t,r){return t&&eN(e.prototype,t),r&&eN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cIe(e){var t=hIe(e,"string");return Ru(t)==="symbol"?t:String(t)}function hIe(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=dIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function dIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function vIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YO(e,t)}function yIe(e){var t=pIe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gIe(this,o)}}function gIe(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lz(e)}function lz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}var tN="dragToScroll",mIe=100,bIe=function(e){vIe(r,e);var t=yIe(r);function r(n){var o;return uIe(this,r),o=t.call(this,n),o.eventManager=new Pt(lz(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return fIe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),wa(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),wa(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=qc(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!$i(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){wa(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tN}},{key:"PLUGIN_PRIORITY",get:function(){return mIe}}]),r}(ot);function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function wIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CIe(n.key),n)}}function SIe(e,t,r){return t&&rN(e.prototype,t),r&&rN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CIe(e){var t=_Ie(e,"string");return Eu(t)==="symbol"?t:String(t)}function _Ie(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=OIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function OIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function RIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function EIe(e){var t=PIe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TIe(this,o)}}function TIe(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sz(e)}function sz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");var pS="dropdownMenu",kIe=230,mS="changeType",uz=function(e){RIe(r,e);var t=EIe(r);function r(n){var o;return wIe(this,r),o=t.call(this,n),o.eventManager=new Pt(sz(o)),o.commandExecutor=new iU(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return SIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[pS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new uU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[pS],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),Sa(Ro(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new KP(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Sa(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Sa(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,mS)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(mS));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=mS,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Sa(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pS}},{key:"PLUGIN_PRIORITY",get:function(){return kIe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Dv,Nv,qe,Lv,qe,Qm,qe,Hv,qe,Xr]}}]),r}(ot);uz.SEPARATOR={name:qe};function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function $Ie(e,t){return xIe(e)||MIe(e,t)||IIe(e,t)||AIe()}function AIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IIe(e,t){if(e){if(typeof e=="string")return nN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nN(e,t)}}function nN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xIe(e){if(Array.isArray(e))return e}function DIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HIe(n.key),n)}}function NIe(e,t,r){return t&&oN(e.prototype,t),r&&oN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HIe(e){var t=LIe(e,"string");return Sd(t)==="symbol"?t:String(t)}function LIe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jIe=function(){function e(t){DIe(this,e),this.hot=t,this.options={}}return NIe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return Ce(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(Ce(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();Ce(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();Ce(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=$Ie(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const FIe=jIe;function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function BIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WIe(n.key),n)}}function VIe(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WIe(e){var t=UIe(e,"string");return Cd(t)==="symbol"?t:String(t)}function UIe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zIe=function(){function e(t,r){BIe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return VIe(e,[{key:"_mergeOptions",value:function(r){var n=Sr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=zt(Sr(e.DEFAULT_OPTIONS),n),n=zt(n,r),n.filename=$E(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const YIe=zIe;function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function GIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qIe(n.key),n)}}function KIe(e,t,r){return t&&aN(e.prototype,t),r&&aN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qIe(e){var t=XIe(e,"string");return Tu(t)==="symbol"?t:String(t)}function XIe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KO(e,t)}function QIe(e){var t=tMe();return function(){var n=Up(e),o;if(t){var i=Up(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return JIe(this,o)}}function JIe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eMe(e)}function eMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Up(e){return Up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Up(e)}var rMe=String.fromCharCode(13),nMe=String.fromCharCode(34),oMe=String.fromCharCode(10),iMe=function(e){ZIe(r,e);var t=QIe(r);function r(){return GIe(this,r),t.apply(this,arguments)}return KIe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=We(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),A(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Dt(o);return a!==""&&(i||a.indexOf(rMe)>=0||a.indexOf(nMe)>=0||a.indexOf(oMe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(YIe);const aMe=iMe;function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function lMe(e,t,r){return t=sMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sMe(e){var t=uMe(e,"string");return _d(t)==="symbol"?t:String(t)}function uMe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fMe="csv",qO=lMe({},fMe,aMe);function cMe(e,t,r){return typeof qO[e]=="function"?new qO[e](t,r):null}function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function hMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vMe(n.key),n)}}function dMe(e,t,r){return t&&lN(e.prototype,t),r&&lN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vMe(e){var t=yMe(e,"string");return Pu(t)==="symbol"?t:String(t)}function yMe(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},XO(e,t)}function pMe(e){var t=wMe();return function(){var n=zp(e),o;if(t){var i=zp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mMe(this,o)}}function mMe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bMe(e)}function bMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zp(e){return zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zp(e)}var SMe="exportFile",CMe=240,_Me=function(e){gMe(r,e);var t=pMe(r);function r(){return hMe(this,r),t.apply(this,arguments)}return dMe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return cMe(o,new FIe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return SMe}},{key:"PLUGIN_PRIORITY",get:function(){return CMe}}]),r}(ot);function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function OMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EMe(n.key),n)}}function RMe(e,t,r){return t&&sN(e.prototype,t),r&&sN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EMe(e){var t=TMe(e,"string");return Od(t)==="symbol"?t:String(t)}function TMe(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fz=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;OMe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Km)}return RMe(e,[{key:"reset",value:function(){A(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();gt(fz,Mr);const hb=fz;var Rd={};function Mi(e,t){if(!Rd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Rd[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function Ca(e){if(!Rd[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Rd[e].descriptor}function qt(e,t,r){r.key=e,Rd[e]={condition:t,descriptor:r}}var rr="none";function PMe(){return!0}qt(rr,PMe,{name:Xm,inputsCount:0,showOperators:!1});var jc="empty";function kMe(e){return Xt(e.value)}qt(jc,kMe,{name:cP,inputsCount:0,showOperators:!0});var Tg="not_empty";function $Me(e,t){return!Mi(jc,t)(e)}qt(Tg,$Me,{name:hP,inputsCount:0,showOperators:!0});function AMe(e,t){return DMe(e)||xMe(e,t)||MMe(e,t)||IMe()}function IMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MMe(e,t){if(e){if(typeof e=="string")return uN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uN(e,t)}}function uN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function DMe(e){if(Array.isArray(e))return e}var Fc="eq";function NMe(e,t){var r=AMe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale)===Dt(n)}qt(Fc,NMe,{name:dP,inputsCount:1,showOperators:!0});var Pg="neq";function HMe(e,t){return!Mi(Fc,t)(e)}qt(Pg,HMe,{name:vP,inputsCount:1,showOperators:!0});function LMe(e,t){return VMe(e)||BMe(e,t)||FMe(e,t)||jMe()}function jMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FMe(e,t){if(e){if(typeof e=="string")return fN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fN(e,t)}}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function VMe(e){if(Array.isArray(e))return e}var cz="gt";function WMe(e,t){var r=LMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}qt(cz,WMe,{name:bP,inputsCount:1,showOperators:!0});function UMe(e,t){return KMe(e)||GMe(e,t)||YMe(e,t)||zMe()}function zMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YMe(e,t){if(e){if(typeof e=="string")return cN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cN(e,t)}}function cN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function KMe(e){if(Array.isArray(e))return e}var hz="gte";function qMe(e,t){var r=UMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}qt(hz,qMe,{name:wP,inputsCount:1,showOperators:!0});function XMe(e,t){return exe(e)||JMe(e,t)||QMe(e,t)||ZMe()}function ZMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QMe(e,t){if(e){if(typeof e=="string")return hN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hN(e,t)}}function hN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function exe(e){if(Array.isArray(e))return e}var dz="lt";function txe(e,t){var r=XMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}qt(dz,txe,{name:SP,inputsCount:1,showOperators:!0});function rxe(e,t){return axe(e)||ixe(e,t)||oxe(e,t)||nxe()}function nxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oxe(e,t){if(e){if(typeof e=="string")return dN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dN(e,t)}}function dN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ixe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function axe(e){if(Array.isArray(e))return e}var vz="lte";function lxe(e,t){var r=rxe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}qt(vz,lxe,{name:CP,inputsCount:1,showOperators:!0});function sxe(e,t){return hxe(e)||cxe(e,t)||fxe(e,t)||uxe()}function uxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fxe(e,t){if(e){if(typeof e=="string")return vN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vN(e,t)}}function vN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hxe(e){if(Array.isArray(e))return e}var XP="date_after";function dxe(e,t){var r=sxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}qt(XP,dxe,{name:RP,inputsCount:1,showOperators:!0});function vxe(e,t){return mxe(e)||pxe(e,t)||gxe(e,t)||yxe()}function yxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gxe(e,t){if(e){if(typeof e=="string")return yN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yN(e,t)}}function yN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function mxe(e){if(Array.isArray(e))return e}var ZP="date_before";function bxe(e,t){var r=vxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}qt(ZP,bxe,{name:EP,inputsCount:1,showOperators:!0});function wxe(e,t){return Oxe(e)||_xe(e,t)||Cxe(e,t)||Sxe()}function Sxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cxe(e,t){if(e){if(typeof e=="string")return gN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gN(e,t)}}function gN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _xe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Oxe(e){if(Array.isArray(e))return e}var Yp="between";function Rxe(e,t){var r=wxe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=Mi(ZP,[a]),f=Mi(XP,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}qt(Yp,Rxe,{name:_P,inputsCount:2,showOperators:!0});var yz="not_between";function Exe(e,t){return!Mi(Yp,t)(e)}qt(yz,Exe,{name:OP,inputsCount:2,showOperators:!0});function Txe(e,t){return Axe(e)||$xe(e,t)||kxe(e,t)||Pxe()}function Pxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kxe(e,t){if(e){if(typeof e=="string")return pN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pN(e,t)}}function pN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $xe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Axe(e){if(Array.isArray(e))return e}var gz="begins_with";function Ixe(e,t){var r=Txe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Dt(n))}qt(gz,Ixe,{name:yP,inputsCount:1,showOperators:!0});var Mxe=$e,pz=cv,xxe=zn.f,Dxe=rl,mN=Kt,Nxe=pE,Hxe=Ar,Lxe=mE,bN=pz("".endsWith),jxe=pz("".slice),Fxe=Math.min,mz=Lxe("endsWith"),Bxe=!mz&&!!function(){var e=xxe(String.prototype,"endsWith");return e&&!e.writable}();Mxe({target:"String",proto:!0,forced:!Bxe&&!mz},{endsWith:function(t){var r=mN(Hxe(this));Nxe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:Fxe(Dxe(n),o),a=mN(t);return bN?bN(r,a,i):jxe(r,i-a.length,i)===a}});function Vxe(e,t){return Yxe(e)||zxe(e,t)||Uxe(e,t)||Wxe()}function Wxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uxe(e,t){if(e){if(typeof e=="string")return wN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wN(e,t)}}function wN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Yxe(e){if(Array.isArray(e))return e}var bz="ends_with";function Gxe(e,t){var r=Vxe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Dt(n))}qt(bz,Gxe,{name:gP,inputsCount:1,showOperators:!0});function Kxe(e,t){return Qxe(e)||Zxe(e,t)||Xxe(e,t)||qxe()}function qxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xxe(e,t){if(e){if(typeof e=="string")return SN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SN(e,t)}}function SN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Qxe(e){if(Array.isArray(e))return e}var QP="contains";function Jxe(e,t){var r=Kxe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Dt(n))>=0}qt(QP,Jxe,{name:pP,inputsCount:1,showOperators:!0});var wz="not_contains";function eDe(e,t){return!Mi(QP,t)(e)}qt(wz,eDe,{name:mP,inputsCount:1,showOperators:!0});var Sz="date_tomorrow";function tDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}qt(Sz,tDe,{name:PP,inputsCount:0});var Cz="date_today";function rDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().startOf("day"),"d"):!1}qt(Cz,rDe,{name:TP,inputsCount:0});var _z="date_yesterday";function nDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}qt(_z,nDe,{name:kP,inputsCount:0});YV();function oDe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var ZO=new Set([1]).has(1),iDe=ZO&&typeof Array.from=="function";function Fv(e){var t=e;return ZO&&(t=new Set(t)),function(r){var n;return ZO?n=t.has(r):n=!!~t.indexOf(r),n}}function Oz(e){return e??""}function QO(e){var t=e;return iDe?t=Array.from(new Set(t)):t=wE(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function CN(e,t,r,n){var o=[],i=e===t,a;return i||(a=Fv(t)),A(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:oDe(l,r)};n&&n(u),o.push(u)}),o}function Rz(e,t){return uDe(e)||sDe(e,t)||lDe(e,t)||aDe()}function aDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lDe(e,t){if(e){if(typeof e=="string")return _N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _N(e,t)}}function _N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function uDe(e){if(Array.isArray(e))return e}var _a="by_value";function fDe(e,t){var r=Rz(t,1),n=r[0];return n(e.value)}qt(_a,fDe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=Rz(t,1),n=r[0];return[Fv(n)]},showOperators:!1});var Ed={};function cDe(e){if(!Ed[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Ed[e].func;return function(r,n){return t(r,n)}}function hDe(e){return Ed[e].name}function JP(e,t,r){Ed[e]={name:t,func:r}}var Ci="conjunction",dDe=IP;function vDe(e,t){return e.every(function(r){return r.func(t)})}JP(Ci,dDe,vDe);var Gp="disjunction",yDe=Zm;function gDe(e,t){return e.some(function(r){return r.func(t)})}JP(Gp,yDe,gDe);var ek="disjunctionWithExtraCondition",pDe=Zm;function mDe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}JP(ek,pDe,mDe);function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}var sc;function bS(e,t,r){return t=bDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bDe(e){var t=wDe(e,"string");return Td(t)==="symbol"?t:String(t)}function wDe(e,t){if(Td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SDe="numeric",Ez="text",CDe="date",ON=(sc={},bS(sc,SDe,[rr,qe,jc,Tg,qe,Fc,Pg,qe,cz,hz,dz,vz,Yp,yz]),bS(sc,Ez,[rr,qe,jc,Tg,qe,Fc,Pg,qe,gz,bz,qe,QP,wz]),bS(sc,CDe,[rr,qe,jc,Tg,qe,Fc,Pg,qe,ZP,XP,Yp,qe,Sz,Cz,_z]),sc);function _De(e){var t=[],r=e;return ON[r]||(r=Ez),A(ON[r],function(n){var o;n===qe?o={name:qe}:o=Sr(Ca(n)),t.push(o)}),t}function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}function ODe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EDe(n.key),n)}}function RDe(e,t,r){return t&&RN(e.prototype,t),r&&RN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EDe(e){var t=TDe(e,"string");return Pd(t)==="symbol"?t:String(t)}function TDe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wS="built",SS="building",EN=["click","input","keydown","keypress","keyup","focus","blur","change"],Tz=function(){function e(t,r){ODe(this,e),this.hot=t,this.eventManager=new Pt(this),this.options=zt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return RDe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===SS?this._element:this.buildState===wS?(this.update(),this._element):(this.buildState=SS,this.build(),this.buildState=wS,this._element)}},{key:"isBuilt",value:function(){return this.buildState===wS}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Or)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=SS),this.options.className&&te(this._element,this.options.className),this.options.children.length)A(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);ze(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),A(EN,function(i){return n(o,i)})}else A(EN,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Sr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();gt(Tz,Mr);const _i=Tz;function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function PDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$De(n.key),n)}}function kDe(e,t,r){return t&&TN(e.prototype,t),r&&TN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $De(e){var t=ADe(e,"string");return ku(t)==="symbol"?t:String(t)}function ADe(e,t){if(ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kg(){return typeof Reflect<"u"&&Reflect.get?kg=Reflect.get.bind():kg=function(t,r,n){var o=IDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},kg.apply(this,arguments)}function IDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$u(e),e!==null););return e}function MDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JO(e,t)}function JO(e,t){return JO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JO(e,t)}function xDe(e){var t=NDe();return function(){var n=$u(e),o;if(t){var i=$u(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DDe(this,o)}}function DDe(e,t){if(t&&(ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pz(e)}function Pz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $u(e){return $u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$u(e)}var xy=new WeakMap,HDe=function(e){MDe(r,e);var t=xDe(r);function r(n,o){var i;return PDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),xy.set(Pz(i),{}),i.registerHooks(),i}return kDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){kg($u(r.prototype),"build",this).call(this);var o=xy.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,te(this._element,"htUIInput"),te(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=xy.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&xy.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return Sr({placeholder:"",type:"text",tagName:"input"})}}]),r}(_i);const is=HDe;function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function LDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FDe(n.key),n)}}function jDe(e,t,r){return t&&PN(e.prototype,t),r&&PN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FDe(e){var t=BDe(e,"string");return Au(t)==="symbol"?t:String(t)}function BDe(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function as(){return typeof Reflect<"u"&&Reflect.get?as=Reflect.get.bind():as=function(t,r,n){var o=VDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},as.apply(this,arguments)}function VDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oi(e),e!==null););return e}function WDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eR(e,t)}function eR(e,t){return eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eR(e,t)}function UDe(e){var t=YDe();return function(){var n=Oi(e),o;if(t){var i=Oi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zDe(this,o)}}function zDe(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kz(e)}function kz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oi(e){return Oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oi(e)}var Dy=new WeakMap,GDe=function(e){WDe(r,e);var t=UDe(r);function r(n,o){var i;return LDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Dy.set(kz(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return jDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return A(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;as(Oi(r.prototype),"build",this).call(this),this.menu=new KP(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new _i(this.hot,{className:"htUISelectCaption"}),a=new _i(this.hot,{className:"htUISelectDropdown"}),l=Dy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,A([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(Xm),Dy.get(this).captionElement.textContent=o,as(Oi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==qe&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=Dy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),as(Oi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUISelect",wrapIt:!1})}}]),r}(_i);const kN=GDe;function Iu(e){"@babel/helpers - typeof";return Iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(e)}function KDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XDe(n.key),n)}}function qDe(e,t,r){return t&&$N(e.prototype,t),r&&$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XDe(e){var t=ZDe(e,"string");return Iu(t)==="symbol"?t:String(t)}function ZDe(e,t){if(Iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $g(){return typeof Reflect<"u"&&Reflect.get?$g=Reflect.get.bind():$g=function(t,r,n){var o=QDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$g.apply(this,arguments)}function QDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mu(e),e!==null););return e}function JDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function eNe(e){var t=nNe();return function(){var n=Mu(e),o;if(t){var i=Mu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tNe(this,o)}}function tNe(e,t){if(t&&(Iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rNe(e)}function rNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mu(e){return Mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mu(e)}var oNe=function(e){JDe(r,e);var t=eNe(r);function r(n,o){var i;return KDe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new kN(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new is(i.hot,{placeholder:LP})),i.elements.push(new is(i.hot,{placeholder:jP})),i.registerHooks(),i}return qDe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),A(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=Sr(o.command);a.name.startsWith(Ht)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),A(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||Ca(rr),i=[];return A(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=Ca(o?o.name:rr);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||A(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof kN})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof is})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&te(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[Ca(rr)];if(o!==null){var a=o.visualIndex;i=_De(this.hot.getDataType(0,a,this.hot.countRows(),a))}A(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),$g(Mu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){A(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){gs(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),wn(o)):gs(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wn(o))}}]),r}(hb);const CS=oNe;function xu(e){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}function iNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lNe(n.key),n)}}function aNe(e,t,r){return t&&AN(e.prototype,t),r&&AN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lNe(e){var t=sNe(e,"string");return xu(t)==="symbol"?t:String(t)}function sNe(e,t){if(xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ag(){return typeof Reflect<"u"&&Reflect.get?Ag=Reflect.get.bind():Ag=function(t,r,n){var o=uNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ag.apply(this,arguments)}function uNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Du(e),e!==null););return e}function fNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rR(e,t)}function cNe(e){var t=dNe();return function(){var n=Du(e),o;if(t){var i=Du(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hNe(this,o)}}function hNe(e,t){if(t&&(xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $z(e)}function $z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(e){return Du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Du(e)}var Ny=new WeakMap,vNe=function(e){fNe(r,e);var t=cNe(r);function r(n,o){var i;return iNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Ny.set($z(i),{}),i}return aNe(r,[{key:"build",value:function(){Ag(Du(r.prototype),"build",this).call(this);var o=Ny.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Ny.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Ny.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Sr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(_i);const IN=vNe;function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}var MN;function yNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function gNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mNe(n.key),n)}}function pNe(e,t,r){return t&&xN(e.prototype,t),r&&xN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mNe(e){var t=bNe(e,"string");return Nu(t)==="symbol"?t:String(t)}function bNe(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nR(e,t)}function SNe(e){var t=ONe();return function(){var n=Kp(e),o;if(t){var i=Kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CNe(this,o)}}function CNe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ne(e)}function _Ne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ONe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kp(e){return Kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kp(e)}var DN=0,RNe=function(e){wNe(r,e);var t=SNe(r);function r(n,o){var i;return gNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return pNe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[Ci,Gp];A(i,function(a){var l=new IN(o.hot,{name:"operator",label:{htmlFor:a,textContent:hDe(a)},value:a,checked:a===i[DN],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(dt(MN||(MN=yNe(["Radio button with index "," doesn't exist."])),o));A(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof IN&&i.isChecked()});return o?o.getValue():Ci}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&A(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ci,i=arguments.length>1?arguments[1]:void 0,a=o;a===ek&&(a=Gp),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(DN)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(hb);const ENe=RNe;var TNe=Ye,PNe=Ar,NN=Kt,kNe=/"/g,$Ne=TNe("".replace),ANe=function(e,t,r,n){var o=NN(PNe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+$Ne(NN(n),kNe,"&quot;")+'"'),i+">"+o+"</"+t+">"},INe=je,MNe=function(e){return INe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},xNe=$e,DNe=ANe,NNe=MNe;xNe({target:"String",proto:!0,forced:NNe("link")},{link:function(t){return DNe(this,"a","href",t)}});function Hu(e){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hu(e)}function HNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jNe(n.key),n)}}function LNe(e,t,r){return t&&HN(e.prototype,t),r&&HN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jNe(e){var t=FNe(e,"string");return Hu(t)==="symbol"?t:String(t)}function FNe(e,t){if(Hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ig(){return typeof Reflect<"u"&&Reflect.get?Ig=Reflect.get.bind():Ig=function(t,r,n){var o=BNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ig.apply(this,arguments)}function BNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Lu(e),e!==null););return e}function VNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function WNe(e){var t=zNe();return function(){var n=Lu(e),o;if(t){var i=Lu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return UNe(this,o)}}function UNe(e,t){if(t&&(Hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Az(e)}function Az(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lu(e){return Lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lu(e)}var _S=new WeakMap,YNe=function(e){VNe(r,e);var t=WNe(r);function r(n,o){var i;return HNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),_S.set(Az(i),{}),i}return LNe(r,[{key:"build",value:function(){Ig(Lu(r.prototype),"build",this).call(this);var o=_S.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(_S.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Sr({href:"#",tagName:"a"})}}]),r}(_i);const LN=YNe;function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function jN(e){return XNe(e)||qNe(e)||KNe(e)||GNe()}function GNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KNe(e,t){if(e){if(typeof e=="string")return iR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iR(e,t)}}function qNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XNe(e){if(Array.isArray(e))return iR(e)}function iR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JNe(n.key),n)}}function QNe(e,t,r){return t&&FN(e.prototype,t),r&&FN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JNe(e){var t=eHe(e,"string");return ju(t)==="symbol"?t:String(t)}function eHe(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ls(){return typeof Reflect<"u"&&Reflect.get?ls=Reflect.get.bind():ls=function(t,r,n){var o=tHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ls.apply(this,arguments)}function tHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ri(e),e!==null););return e}function rHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aR(e,t)}function nHe(e){var t=iHe();return function(){var n=Ri(e),o;if(t){var i=Ri(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return oHe(this,o)}}function oHe(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iz(e)}function Iz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ri(e){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ri(e)}var aHe=new WeakMap,lHe="multipleSelect.itemBox",sHe=function(e){rHe(r,e);var t=nHe(r);function r(n,o){var i;return ZNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),aHe.set(Iz(i),{}),i.searchInput=new is(i.hot,{placeholder:HP,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new LN(i.hot,{textContent:MP,className:"htUISelectAll"}),i.clearAllUI=new LN(i.hot,{textContent:xP,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return QNe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return jN(this.items)}},{key:"getValue",value:function(){return fHe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;ls(Ri(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new _i(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),te(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,y,m,w,C,S){v.title=S.instance.getDataAtRowProp(y,S.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Jt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:lHe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(uHe(this.items,this.options.value)),ls(Ri(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,ls(Ri(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=jN(this.items):l=Wr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=HE(gs,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(wn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push($O(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push($O(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUIMultipleSelect",value:[]})}}]),r}(_i);const BN=sHe;function uHe(e,t){var r=Fv(t);return We(e,function(n){return n.checked=r(n.value),n})}function fHe(e){var t=[];return A(e,function(r){r.checked&&t.push(r.value)}),t}function Fu(e){"@babel/helpers - typeof";return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fu(e)}function cHe(e,t){return yHe(e)||vHe(e,t)||dHe(e,t)||hHe()}function hHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dHe(e,t){if(e){if(typeof e=="string")return VN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VN(e,t)}}function VN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yHe(e){if(Array.isArray(e))return e}function gHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mHe(n.key),n)}}function pHe(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mHe(e){var t=bHe(e,"string");return Fu(t)==="symbol"?t:String(t)}function bHe(e,t){if(Fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mg(){return typeof Reflect<"u"&&Reflect.get?Mg=Reflect.get.bind():Mg=function(t,r,n){var o=wHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mg.apply(this,arguments)}function wHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bu(e),e!==null););return e}function SHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lR(e,t)}function CHe(e){var t=RHe();return function(){var n=Bu(e),o;if(t){var i=Bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _He(this,o)}}function _He(e,t){if(t&&(Fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OHe(e)}function OHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bu(e){return Bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bu(e)}var EHe=function(e){SHe(r,e);var t=CHe(r);function r(n,o){var i;return gHe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new BN(i.hot)),i.registerHooks(),i}return pHe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===_a){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?rr:_a},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Wr(u,function(j){return j.name===_a}),v=cHe(d,1),y=v[0],m={},w=i.hot.getTranslatedPhrase(Fp);if(y){var C=QO(We(c(s,h),function(j){return j.value}));f&&(y.args[0]=f);var S=[],R=CN(C,y.args[0],w,function(j){j.checked&&S.push(j.value)}),O=o.editedConditionStack.column;m.locale=i.hot.getCellMeta(0,O).locale,m.args=[S],m.command=Ca(_a),m.itemsSnapshot=R}else m.args=[],m.command=Ca(rr);i.state.setValueAtIndex(s,m)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof BN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(Fp),i=QO(this._getColumnVisibleValues()),a=CN(i,i,o);this.getMultipleSelectElement().setItems(a),Mg(Bu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){gs(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:We(this.hot.getDataAtCol(o.visualIndex),function(i){return Oz(i)})}}]),r}(hb);const THe=EHe;function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function PHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$He(n.key),n)}}function kHe(e,t,r){return t&&UN(e.prototype,t),r&&UN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $He(e){var t=AHe(e,"string");return Vu(t)==="symbol"?t:String(t)}function AHe(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function MHe(e){var t=NHe();return function(){var n=qp(e),o;if(t){var i=qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xHe(this,o)}}function xHe(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DHe(e)}function DHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qp(e){return qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qp(e)}var HHe=function(e){IHe(r,e);var t=MHe(r);function r(n,o){var i;return PHe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new is(i.hot,{type:"button",value:DP,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new is(i.hot,{type:"button",value:NP,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return kHe(r,[{key:"registerHooks",value:function(){var o=this;A(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(hb);const LHe=HHe;function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}var zN,YN;function GN(e,t){return VHe(e)||BHe(e,t)||FHe(e,t)||jHe()}function jHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FHe(e,t){if(e){if(typeof e=="string")return KN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KN(e,t)}}function KN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function VHe(e){if(Array.isArray(e))return e}function qN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function WHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zHe(n.key),n)}}function UHe(e,t,r){return t&&XN(e.prototype,t),r&&XN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zHe(e){var t=YHe(e,"string");return kd(t)==="symbol"?t:String(t)}function YHe(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZN="ConditionCollection.filteringStates",Mz=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;WHe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Km,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(ZN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return UHe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ci;return r.length?cDe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ci,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=We(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(dt(zN||(zN=qN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(mt(Ed[o]))throw new Error(dt(YN||(YN=qN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:Mi(s,l)}]},i):f.push({name:s,args:l,func:Mi(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=GN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Ft(this.filteringStates.getEntries(),function(r,n){var o=GN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:We(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),A(r,function(o){A(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(ZN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();gt(Mz,Mr);const xz=Mz;function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function GHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qHe(n.key),n)}}function KHe(e,t,r){return t&&QN(e.prototype,t),r&&QN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qHe(e){var t=XHe(e,"string");return $d(t)==="symbol"?t:String(t)}function XHe(e,t){if($d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZHe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};GHe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return KHe(e,[{key:"filter",value:function(){var r=this,n=[];return A(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return A(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return A(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const Dz=ZHe;function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function QHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eLe(n.key),n)}}function JHe(e,t,r){return t&&JN(e.prototype,t),r&&JN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eLe(e){var t=tLe(e,"string");return Ad(t)==="symbol"?t:String(t)}function tLe(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nz=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};QHe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return JHe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,A(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=cW(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new xz(o.hot,!1),y=[].concat(c,d);v.importAllConditions(y);var m=o.columnDataFactory(h),w;v.isEmpty()?w=m:w=new Dz(v,function(S){return o.columnDataFactory(S)}).filter(),w=We(w,function(S){return S.meta.visualRow});var C=Fv(w);return v.destroy(),Wr(m,function(S){return C(S.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;A(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),ze(this,function(n,o){r[o]=null})}}]),e}();gt(Nz,Mr);const rLe=Nz;function Wu(e){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wu(e)}var eH;function nLe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function oLe(e,t){return sLe(e)||lLe(e,t)||aLe(e,t)||iLe()}function iLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aLe(e,t){if(e){if(typeof e=="string")return tH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tH(e,t)}}function tH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function sLe(e){if(Array.isArray(e))return e}function uLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cLe(n.key),n)}}function fLe(e,t,r){return t&&rH(e.prototype,t),r&&rH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cLe(e){var t=hLe(e,"string");return Wu(t)==="symbol"?t:String(t)}function hLe(e,t){if(Wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ss(){return typeof Reflect<"u"&&Reflect.get?ss=Reflect.get.bind():ss=function(t,r,n){var o=dLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ss.apply(this,arguments)}function dLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ei(e),e!==null););return e}function vLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function yLe(e){var t=pLe();return function(){var n=Ei(e),o;if(t){var i=Ei(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gLe(this,o)}}function gLe(e,t){if(t&&(Wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hz(e)}function Hz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ei(e)}var nH="filters",mLe=250,bLe=function(e){vLe(r,e);var t=yLe(r);function r(n){var o;return uLe(this,r),o=t.call(this,n),o.eventManager=new Pt(Hz(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return fLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new xv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase($P),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(AP),":")};if(!this.components.get("filter_by_condition")){var f=new CS(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ENe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new CS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new THe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new LHe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new xz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new rLe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),ss(Ei(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}ss(Ei(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ci,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=We(i.filter(),function(h){return h.meta.visualRow});var c=Fv(l);Ce(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),A(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return A(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,y=c.visualRow,m=c.type,w=c.instance,C=c.dateFormat,S=c.locale,R=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:y,type:m,instance:w,dateFormat:C,locale:S},value:Oz(R)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&A(o,function(a){var l=oLe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=QO(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:qe}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Gp&&i.command.key!==rr&&a.command.key!==rr&&l.command.key!==rr?s=ek:l.command.key!==rr&&(i.command.key===rr||a.command.key===rr)&&(s=Ci),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==rr&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==rr&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==rr&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===CS&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?te(i,"htFiltersActive"):Le(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Dz(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===_a}),f=l.filter(function(h){return h.name!==_a});if(u.length>=2||f.length>=3)bt(dt(eH||(eH=nLe([`The filter conditions have been applied properly, but couldnât be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnât be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return A(l,function(u){A(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),ss(Ei(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nH}},{key:"PLUGIN_PRIORITY",get:function(){return mLe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ot);function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function oH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Bc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oH(Object(r),!0).forEach(function(n){wLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wLe(e,t,r){return t=SLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SLe(e){var t=CLe(e,"string");return Id(t)==="symbol"?t:String(t)}function CLe(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lz="internal-use-in-handsontable",fR={licenseKey:Lz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function jz(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[ar])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Fz(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function _Le(e){var t,r=e[ar],n=Fz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=jz(e);return Bc(Bc(Bc({},fR),n),o)}function OLe(e){var t,r=e[ar],n=Fz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=jz(e);return Bc(Bc({},n),o)}function RLe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var iH;function ELe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function cR(e){"@babel/helpers - typeof";return cR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cR(e)}function db(){var e="engine_relationship",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function tk(){var e="shared_engine_usage",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function TLe(e){var t=e.getSettings(),r=t[ar],n=r==null?void 0:r.engine;if(r===!0||mt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return PLe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(cR(n)==="object"&&mt(n.hyperformula)){var i=db(),a=tk().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Lz}),(n.getConfig().leapYear1900!==fR.leapYear1900||Hm(n.getConfig().nullDate,fR.nullDate)===!1)&&bt(dt(iH||(iH=ELe(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function PLe(e,t,r){var n=t[ar],o=_Le(t),i=db(),a=tk();kLe(e,n.functions),$Le(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),ALe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function aH(e){var t,r=db(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function lH(e,t){if(e){var r=db(),n=r.get(e),o=tk(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function kLe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){bt(a.message)}})}function $Le(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){bt(n.message)}}}function ALe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){bt(l.message)}}),e.resumeEvaluation())}function ILe(e,t){return(mt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var Bz="DD/MM/YYYY";function Vz(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function MLe(e){return Vz(e)?e.substr(1):e}function xLe(e){return typeof e=="string"&&e.startsWith("=")}function OS(e,t){return typeof e=="string"&&t==="date"}function sH(e,t){return ee(e,t,!0).isValid()}function uH(e,t){return ee(e,t,!0).format(Bz)}function DLe(e,t){return ee(e,Bz,!0).format(t)}function fH(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return ee(n).format(t)}function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function NLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LLe(n.key),n)}}function HLe(e,t,r){return t&&cH(e.prototype,t),r&&cH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LLe(e){var t=jLe(e,"string");return Md(t)==="symbol"?t:String(t)}function jLe(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qi(e,t,r){FLe(e,t),t.set(e,r)}function FLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(e,t){var r=Wz(e,t,"get");return BLe(e,r)}function BLe(e,t){return t.get?t.get.call(e):t.value}function ti(e,t,r){var n=Wz(e,t,"set");return VLe(e,n,r),r}function Wz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function VLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var uc=new WeakMap,ri=new WeakMap,Nr=new WeakMap,Hy=new WeakMap,RS=new WeakMap,ES=new WeakMap,Ly=new WeakMap,WLe=function(){function e(t,r,n){NLe(this,e),Qi(this,uc,{writable:!0,value:void 0}),Qi(this,ri,{writable:!0,value:void 0}),Qi(this,Nr,{writable:!0,value:void 0}),Qi(this,Hy,{writable:!0,value:[]}),Qi(this,RS,{writable:!0,value:[]}),Qi(this,ES,{writable:!0,value:void 0}),Qi(this,Ly,{writable:!0,value:[]}),ti(this,uc,t),ti(this,ri,r),ti(this,Nr,n)}return HLe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return ti(this,Ly,r.map(function(o){var i=Ct(n,ri).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),Ct(this,Ly)}},{key:"getRemovedHfIndexes",value:function(){return Ct(this,Ly)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=Ct(this,ri).getIndexesSequence(),o=Ct(this,ri).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(ur(Ct(this,uc)),"s");Ct(this,Nr).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&Ct(n,Nr).getEngine()[i](Ct(n,Nr).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(ti(this,RS,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),ti(this,ES,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=Ct(this,ri).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!Ct(this,Nr).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Ct(this,RS),Ct(this,ES)));Ct(this,Nr).getSheetId()===null?Ct(this,Nr).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(ur(Ct(this,uc)),"Order");return function(o){if(!Ct(r,Nr).isPerformingUndoRedo()){var i=Ct(r,ri).getIndexesSequence();if(o==="update"){var a=Ct(r,Hy).map(function(c){return i.indexOf(c)}),l=Ct(r,Nr).getEngine().getSheetDimensions(Ct(r,Nr).getSheetId()),s;Ct(r,uc)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);Ct(r,Nr).getEngine()[n](Ct(r,Nr).getSheetId(),a)}ti(r,Hy,i)}}}},{key:"init",value:function(){ti(this,Hy,Ct(this,ri).getIndexesSequence())}}]),e}();const hH=WLe;function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function ULe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YLe(n.key),n)}}function zLe(e,t,r){return t&&dH(e.prototype,t),r&&dH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YLe(e){var t=GLe(e,"string");return xd(t)==="symbol"?t:String(t)}function GLe(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ji(e,t,r){KLe(e,t),t.set(e,r)}function KLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eo(e,t){var r=Uz(e,t,"get");return qLe(e,r)}function qLe(e,t){return t.get?t.get.call(e):t.value}function ea(e,t,r){var n=Uz(e,t,"set");return XLe(e,n,r),r}function Uz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function XLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var jy=new WeakMap,Fy=new WeakMap,TS=new WeakMap,PS=new WeakMap,kS=new WeakMap,$S=new WeakMap,AS=new WeakMap,ZLe=function(){function e(t,r,n){ULe(this,e),Ji(this,jy,{writable:!0,value:void 0}),Ji(this,Fy,{writable:!0,value:void 0}),Ji(this,TS,{writable:!0,value:void 0}),Ji(this,PS,{writable:!0,value:!1}),Ji(this,kS,{writable:!0,value:!1}),Ji(this,$S,{writable:!0,value:null}),Ji(this,AS,{writable:!0,value:null}),ea(this,jy,new hH("row",t,this)),ea(this,Fy,new hH("column",r,this)),ea(this,TS,n)}return zLe(e,[{key:"getForAxis",value:function(r){return r==="row"?eo(this,jy):eo(this,Fy)}},{key:"setPerformUndo",value:function(r){ea(this,PS,r)}},{key:"setPerformRedo",value:function(r){ea(this,kS,r)}},{key:"isPerformingUndoRedo",value:function(){return eo(this,PS)||eo(this,kS)}},{key:"getSheetId",value:function(){return eo(this,AS)}},{key:"getEngine",value:function(){return eo(this,$S)}},{key:"getPostponeAction",value:function(){return eo(this,TS)}},{key:"setupSyncEndpoint",value:function(r,n){ea(this,$S,r),ea(this,AS,n),eo(this,jy).init(),eo(this,Fy).init()}}]),e}();const QLe=ZLe;function JLe(e){return rje(e)||tje(e)||zz(e)||eje()}function eje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rje(e){if(Array.isArray(e))return hR(e)}function xi(e){"@babel/helpers - typeof";return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(e)}function xl(e,t){return ije(e)||oje(e,t)||zz(e,t)||nje()}function nje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zz(e,t){if(e){if(typeof e=="string")return hR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hR(e,t)}}function hR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ije(e){if(Array.isArray(e))return e}function aje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yz(n.key),n)}}function lje(e,t,r){return t&&vH(e.prototype,t),r&&vH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oa(){return typeof Reflect<"u"&&Reflect.get?Oa=Reflect.get.bind():Oa=function(t,r,n){var o=sje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oa.apply(this,arguments)}function sje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function uje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dR(e,t)}function dR(e,t){return dR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dR(e,t)}function fje(e){var t=hje();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cje(this,o)}}function cje(e,t){if(t&&(xi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nn(e)}function Nn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}function Dl(e,t,r){return t=Yz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yz(e){var t=dje(e,"string");return xi(t)==="symbol"?t:String(t)}function dje(e,t){if(xi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IS(e,t,r){vje(e,t),t.set(e,r)}function vje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ni(e,t,r){var n=Gz(e,t,"set");return yje(e,n,r),r}function yje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Nl(e,t){var r=Gz(e,t,"get");return gje(e,r)}function Gz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function gje(e,t){return t.get?t.get.call(e):t.value}var ar="formulas",pje=["maxRows","maxColumns","language"],mje=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");var Hl=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},to=new WeakMap,MS=new WeakMap,fc=new WeakMap,bje=function(e){uje(r,e);var t=fje(r);function r(){var n;aje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),IS(Nn(n),to,{writable:!0,value:!1}),IS(Nn(n),MS,{writable:!0,value:!1}),IS(Nn(n),fc,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Dl(Nn(n),"staticRegister",on("formulas")),Dl(Nn(n),"engine",null),Dl(Nn(n),"sheetName",null),Dl(Nn(n),"indexSyncer",null),Dl(Nn(n),"rowAxisSyncer",null),Dl(Nn(n),"columnAxisSyncer",null),n}return lje(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ar]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=TLe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){bt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new QLe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),Nl(this,fc).forEach(function(l){var s=xl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),Oa(Eo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;Nl(this,fc).forEach(function(i){var a=xl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),lH(this.engine,this.hot),this.engine=null,Oa(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=OLe(this.hot.getSettings());RLe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[ar];if(ve(a)&&ve(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[ar].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}Oa(Eo(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;Nl(this,fc).forEach(function(i){var a,l=xl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),ni(this,fc,null),lH(this.engine,this.hot),this.engine=null,Oa(Eo(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ve(i)&&!CU(i))return bt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return bt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return bt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){xE("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(ur(ar),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),aH(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,y=h.sheet;return ve(y)?"".concat(y,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ve(d)===!1||ve(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=l(u);if(y!==void 0&&!s.has(m)){var w=aH(i.engine).get(y);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){bt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return OS(a,s.type)&&(sH(a,s.dateFormat)?a=uH(a,s.dateFormat):xLe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&wr(f)&&(f=fH(f,u.dateFormat)),xi(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,y=d.col,m=a.getBottomEndCorner(),w=m.row,C=m.col,S={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},R={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(C),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(R)===!1)return!1;for(var O=this.engine.getFillRangeData(S,R),j=S.start,U=j.row,q=j.col,G=S.end,X=G.row,Q=G.col,oe=X-U+1,J=Q-q+1,ue=0;ue<O.length;ue+=1)for(var he=0;he<O[ue].length;he+=1){var Oe=O[ue][he],we=ue%oe,$=he%J,k=this.hot.getCellMeta(we,$);OS(Oe,k.type)&&(Oe.startsWith("'")?O[ue][he]=Oe.slice(1):this.isFormulaCellType(we,$,this.sheetId)===!1&&(O[ue][he]=DLe(Oe,k.dateFormat)))}return O}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ur(ar))||ni(this,MS,mt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;OS(u,c.type)&&(a=!0,sH(u,h)?i[s][f]=uH(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(ni(this,to,!0),this.engine.setSheetContent(this.sheetId,i),ni(this,to,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ur(ar)))if(this.sheetName=ILe(this.engine,this.hot.getSettings()[ar].sheetName),Nl(this,MS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){ni(this,to,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),ni(this,to,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||Nl(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){Vz(a.value)&&(a.value=MLe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&wr(h)&&(h=fH(h,d.dateFormat));var v=xi(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||Nl(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!Hl(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=xl(f,4),h=c[0],d=c[1],v=c[3],y=a.hot.propToCol(d),m=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(y),C={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:a.sheetId};m!==null&&w!==null?a.syncChangeWithEngine(h,y,v):l.push([h,y,v]),s.push({address:C})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=xl(c,3),d=h[0],v=h[1],y=h[2];a.syncChangeWithEngine(d,v,y)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!Hl(i)){var l=[],s=[];o.forEach(function(u){var f=xl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(wr(v)){var y={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(y)){bt("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),l.push.apply(l,JLe(a.engine.setCellContents(y,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!Hl(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!Hl(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!Hl(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!Hl(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;ni(this,to,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());ni(this,to,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return ar}},{key:"PLUGIN_PRIORITY",get:function(){return mje}},{key:"SETTING_KEYS",get:function(){return[ar].concat(pje)}}]),r}(ot);function wje(e,t){return Oje(e)||_je(e,t)||Cje(e,t)||Sje()}function Sje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cje(e,t){if(e){if(typeof e=="string")return yH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yH(e,t)}}function yH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _je(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Oje(e){if(Array.isArray(e))return e}function Rje(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=wje(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(lP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function By(e){return kje(e)||Pje(e)||Tje(e)||Eje()}function Eje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tje(e,t){if(e){if(typeof e=="string")return vR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vR(e,t)}}function Pje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kje(e){if(Array.isArray(e))return vR(e)}function vR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $je(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(sP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenColumns(),function(C){return n.toPhysicalColumn(C)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,By(y.filter(function(C){return o.includes(C)})))}}else if(u===0&&u<a)h.push.apply(h,By(c.slice(0,a)));else if(u===null)h.push.apply(h,By(c.slice(0,this.countCols())));else{var m=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,By(c.slice(l+1)))}return A(h,function(C){t.push(n.toVisualColumn(C))}),t.length===0}}}function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function Aje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mje(n.key),n)}}function Ije(e,t,r){return t&&gH(e.prototype,t),r&&gH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mje(e){var t=xje(e,"string");return Uu(t)==="symbol"?t:String(t)}function xje(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ra(){return typeof Reflect<"u"&&Reflect.get?Ra=Reflect.get.bind():Ra=function(t,r,n){var o=Dje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ra.apply(this,arguments)}function Dje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function Nje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yR(e,t)}function yR(e,t){return yR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yR(e,t)}function Hje(e){var t=jje();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lje(this,o)}}function Lje(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gR(e)}function gR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}function pH(e,t,r){Fje(e,t),t.set(e,r)}function Fje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(e,t){var r=Kz(e,t,"get");return Bje(e,r)}function Bje(e,t){return t.get?t.get.call(e):t.value}function cc(e,t,r){var n=Kz(e,t,"set");return Vje(e,n,r),r}function Kz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Vje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");var xS="hiddenColumns",Wje=310,An=new WeakMap,In=new WeakMap,Uje=function(e){Nje(r,e);var t=Hje(r);function r(){var n;Aje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),pH(gR(n),An,{writable:!0,value:{}}),pH(gR(n),In,{writable:!0,value:null}),n}return Ije(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[xS];Ue(i)&&(cc(this,An,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),cc(this,In,new Gm),Hr(this,In).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Hr(this,In)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Ra(To(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ra(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),cc(this,An,{}),Ra(To(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Hr(this,In).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualColumn(y)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Hr(this,In).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){Hr(i,In).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return We(Hr(this,In).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Hr(this,In).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Hr(this,An).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Hr(this,An).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Hr(this,An).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Hr(this,An).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},Rje(this),$je(this))}},{key:"onMapInit",value:function(){Array.isArray(Hr(this,An).columns)&&this.hideColumns(Hr(this,An).columns)}},{key:"destroy",value:function(){cc(this,An,null),cc(this,In,null),Ra(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xS}},{key:"PLUGIN_PRIORITY",get:function(){return Wje}}]),r}(ot);function zje(e,t){return qje(e)||Kje(e,t)||Gje(e,t)||Yje()}function Yje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gje(e,t){if(e){if(typeof e=="string")return mH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mH(e,t)}}function mH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function qje(e){if(Array.isArray(e))return e}function Xje(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=zje(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(uP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Vy(e){return eFe(e)||Jje(e)||Qje(e)||Zje()}function Zje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qje(e,t){if(e){if(typeof e=="string")return pR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pR(e,t)}}function Jje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eFe(e){if(Array.isArray(e))return pR(e)}function pR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tFe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(fP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenRows(),function(C){return n.toPhysicalRow(C)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Vy(y.filter(function(C){return o.includes(C)})))}}else if(u===0&&u<a)h.push.apply(h,Vy(c.slice(0,a)));else if(u===null)h.push.apply(h,Vy(c.slice(0,this.countRows())));else{var m=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,Vy(c.slice(l+1)))}return A(h,function(C){t.push(n.toVisualRow(C))}),t.length===0}}}function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function rFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oFe(n.key),n)}}function nFe(e,t,r){return t&&bH(e.prototype,t),r&&bH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oFe(e){var t=iFe(e,"string");return zu(t)==="symbol"?t:String(t)}function iFe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ea(){return typeof Reflect<"u"&&Reflect.get?Ea=Reflect.get.bind():Ea=function(t,r,n){var o=aFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ea.apply(this,arguments)}function aFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function lFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mR(e,t)}function mR(e,t){return mR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mR(e,t)}function sFe(e){var t=fFe();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uFe(this,o)}}function uFe(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bR(e)}function bR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}function wH(e,t,r){cFe(e,t),t.set(e,r)}function cFe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(e,t){var r=qz(e,t,"get");return hFe(e,r)}function hFe(e,t){return t.get?t.get.call(e):t.value}function hc(e,t,r){var n=qz(e,t,"set");return dFe(e,n,r),r}function qz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function dFe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");var DS="hiddenRows",vFe=320,ro=new WeakMap,Mn=new WeakMap,yFe=function(e){lFe(r,e);var t=sFe(r);function r(){var n;rFe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),wH(bR(n),ro,{writable:!0,value:{}}),wH(bR(n),Mn,{writable:!0,value:null}),n}return nFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[DS];Ue(i)&&(hc(this,ro,i),mt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),hc(this,Mn,new Gm),qr(this,Mn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,qr(this,Mn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Ea(Po(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ea(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),hc(this,ro,{}),Ea(Po(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=qr(this,Mn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualRow(y)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&qr(this,Mn).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){qr(i,Mn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return We(qr(this,Mn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return qr(this,Mn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(qr(this,ro).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(qr(this,ro).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!qr(this,ro).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},Xje(this),tFe(this))}},{key:"onMapInit",value:function(){Array.isArray(qr(this,ro).rows)&&this.hideRows(qr(this,ro).rows)}},{key:"destroy",value:function(){hc(this,ro,null),hc(this,Mn,null),Ea(Po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DS}},{key:"PLUGIN_PRIORITY",get:function(){return vFe}}]),r}(ot);function gFe(e,t){return wFe(e)||bFe(e,t)||mFe(e,t)||pFe()}function pFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mFe(e,t){if(e){if(typeof e=="string")return SH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(e,t)}}function SH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wFe(e){if(Array.isArray(e))return e}function SFe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(HT)},callback:function(r,n){var o=gFe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function CFe(e,t){return EFe(e)||RFe(e,t)||OFe(e,t)||_Fe()}function _Fe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OFe(e,t){if(e){if(typeof e=="string")return CH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CH(e,t)}}function CH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function EFe(e){if(Array.isArray(e))return e}function TFe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(LT)},callback:function(r,n){var o=CFe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function PFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Fe(n.key),n)}}function kFe(e,t,r){return t&&_H(e.prototype,t),r&&_H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Fe(e){var t=AFe(e,"string");return Yu(t)==="symbol"?t:String(t)}function AFe(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function us(){return typeof Reflect<"u"&&Reflect.get?us=Reflect.get.bind():us=function(t,r,n){var o=IFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},us.apply(this,arguments)}function IFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ti(e),e!==null););return e}function MFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wR(e,t)}function wR(e,t){return wR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},wR(e,t)}function xFe(e){var t=NFe();return function(){var n=Ti(e),o;if(t){var i=Ti(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DFe(this,o)}}function DFe(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xz(e)}function Xz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ti(e){return Ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ti(e)}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");var OH="manualColumnFreeze",HFe=110,dc=new WeakMap,LFe=function(e){MFe(r,e);var t=xFe(r);function r(n){var o;return PFe(this,r),o=t.call(this,n),dc.set(Xz(o),{afterFirstUse:!1}),o}return kFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[OH]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),us(Ti(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=dc.get(this);o.afterFirstUse=!1,us(Ti(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),us(Ti(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=dc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=dc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},SFe(this),TFe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=dc.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return OH}},{key:"PLUGIN_PRIORITY",get:function(){return HFe}}]),r}(ot);function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function jFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BFe(n.key),n)}}function FFe(e,t,r){return t&&RH(e.prototype,t),r&&RH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BFe(e){var t=VFe(e,"string");return Dd(t)==="symbol"?t:String(t)}function VFe(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NS=0,EH=1,TH=2,Ll="px",WFe=function(){function e(t){jFe(this,e),this.hot=t,this._element=null,this.state=NS,this.inlineProperty=t.isRtl()?"right":"left"}return FFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=TH}},{key:"build",value:function(){this.state===NS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=EH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=NS}},{key:"isAppended",value:function(){return this.state===TH}},{key:"isBuilt",value:function(){return this.state>=EH}},{key:"setPosition",value:function(r,n){wr(r)&&(this._element.style.top=r+Ll),wr(n)&&(this._element.style[this.inlineProperty]=n+Ll)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){wr(r)&&(this._element.style.width=r+Ll),wr(n)&&(this._element.style.height=n+Ll)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){wr(r)&&(this._element.style.marginTop=r+Ll),wr(n)&&(this._element.style["margin".concat(ur(this.inlineProperty))]=n+Ll)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ur(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const Zz=WFe;function Gu(e){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function UFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YFe(n.key),n)}}function zFe(e,t,r){return t&&PH(e.prototype,t),r&&PH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YFe(e){var t=GFe(e,"string");return Gu(t)==="symbol"?t:String(t)}function GFe(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xg(){return typeof Reflect<"u"&&Reflect.get?xg=Reflect.get.bind():xg=function(t,r,n){var o=KFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xg.apply(this,arguments)}function KFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ku(e),e!==null););return e}function qFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SR(e,t)}function SR(e,t){return SR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},SR(e,t)}function XFe(e){var t=JFe();return function(){var n=Ku(e),o;if(t){var i=Ku(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZFe(this,o)}}function ZFe(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QFe(e)}function QFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ku(e){return Ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ku(e)}var eBe="ht__manualColumnMove--backlight",tBe=function(e){qFe(r,e);var t=XFe(r);function r(){return UFe(this,r),t.apply(this,arguments)}return zFe(r,[{key:"build",value:function(){xg(Ku(r.prototype),"build",this).call(this),te(this._element,eBe)}}]),r}(Zz);const rBe=tBe;function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function nBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iBe(n.key),n)}}function oBe(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iBe(e){var t=aBe(e,"string");return qu(t)==="symbol"?t:String(t)}function aBe(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dg(){return typeof Reflect<"u"&&Reflect.get?Dg=Reflect.get.bind():Dg=function(t,r,n){var o=lBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dg.apply(this,arguments)}function lBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xu(e),e!==null););return e}function sBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CR(e,t)}function CR(e,t){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CR(e,t)}function uBe(e){var t=hBe();return function(){var n=Xu(e),o;if(t){var i=Xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fBe(this,o)}}function fBe(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cBe(e)}function cBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xu(e){return Xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xu(e)}var dBe="ht__manualColumnMove--guideline",vBe=function(e){sBe(r,e);var t=uBe(r);function r(){return nBe(this,r),t.apply(this,arguments)}return oBe(r,[{key:"build",value:function(){Dg(Xu(r.prototype),"build",this).call(this),te(this._element,dBe)}}]),r}(Zz);const yBe=vBe;function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function gBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mBe(n.key),n)}}function pBe(e,t,r){return t&&$H(e.prototype,t),r&&$H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mBe(e){var t=bBe(e,"string");return Zu(t)==="symbol"?t:String(t)}function bBe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ta(){return typeof Reflect<"u"&&Reflect.get?Ta=Reflect.get.bind():Ta=function(t,r,n){var o=wBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ta.apply(this,arguments)}function wBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function SBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_R(e,t)}function _R(e,t){return _R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_R(e,t)}function CBe(e){var t=OBe();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _Be(this,o)}}function _Be(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OR(e)}function OR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");var HS="manualColumnMove",RBe=120,oi=new WeakMap,AH="ht__manualColumnMove",Wy="show-ui",LS="on-moving--columns",jS="after-selection--columns",EBe=function(e){SBe(r,e);var t=CBe(r);function r(n){var o;return gBe(this,r),o=t.call(this,n),oi.set(OR(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new Pt(OR(o)),o.backlight=new rBe(n),o.guideline=new yBe(n),o}return pBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[HS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,AH),Ta(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Ta(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,AH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Ta(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=oi.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=oi.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[HS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Ce(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=oi.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,y=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,w=ct(this.hot.rootElement),C=m.innerWidth-o.rootElementOffset-w;y=m.innerWidth-o.target.eventPageX-C-(l.scrollX===void 0?s:0)}else y=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=y){var S=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=S+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var R=y,O=u;y+d+h>=f?R=f-d-h:y+h<c+v&&(R=c+v+Math.abs(h)),u>=f-1?O=f-1:O===0?O=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(O-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,R),this.guideline.setPosition(null,O)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=oi.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Le(this.hot.rootElement,[LS,Wy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=f.from,m=f.to,w=Math.min(y.col,m.col),C=Math.max(y.col,m.col);if(i.row<0&&i.col>=w&&i.col<=C){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,C),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Ut(this.hot.rootElement).left;var S=c.hasRowHeaders?-1:0,R=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,O=i.col<c.fixedColumnsStart,j=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),U=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),q=this.getColumnsWidth(w,i.col-1)+U,G=this.getColumnsWidth(S,w-1)+(O?j:0)+q;this.backlight.setPosition(R,G),this.backlight.setSize(this.getColumnsWidth(w,C),s.hider.offsetHeight-R),this.backlight.setOffset(null,-q),te(this.hot.rootElement,LS)}else Le(this.hot.rootElement,jS),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=oi.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=oi.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Le(this.hot.rootElement,Wy):te(this.hot.rootElement,Wy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=oi.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,Le(this.hot.rootElement,[LS,Wy,jS]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,jS),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Ta(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return HS}},{key:"PLUGIN_PRIORITY",get:function(){return RBe}}]),r}(ot);function Qu(e){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}function TBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kBe(n.key),n)}}function PBe(e,t,r){return t&&IH(e.prototype,t),r&&IH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kBe(e){var t=$Be(e,"string");return Qu(t)==="symbol"?t:String(t)}function $Be(e,t){if(Qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pa(){return typeof Reflect<"u"&&Reflect.get?Pa=Reflect.get.bind():Pa=function(t,r,n){var o=ABe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pa.apply(this,arguments)}function ABe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function IBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RR(e,t)}function RR(e,t){return RR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},RR(e,t)}function MBe(e){var t=DBe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xBe(this,o)}}function xBe(e,t){if(t&&(Qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ER(e)}function ER(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}var Uy="manualColumnResize",NBe=130,MH="manualColumnWidths",FS=new WeakMap,HBe=function(e){IBe(r,e);var t=MBe(r);function r(n){var o;TBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Pt(ER(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,FS.set(ER(o),{config:void 0}),te(o.handle,"manualColumnResizer"),te(o.guide,"manualColumnResizerGuide"),o}return PBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Uy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Li,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),Pa($o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Pa($o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=FS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Pa($o(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",MH,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",MH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=FS.get(this),a=this.hot.getSettings()[Uy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Tt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();A(v,function(y){var m=y.getTopStartCorner().col,w=y.getBottomEndCorner().col;Ce(m,w,function(C){i.selectedCols.includes(C)||i.selectedCols.push(C)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Tt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!pi(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!ME(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,A(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[Uy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Pa($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Uy}},{key:"PLUGIN_PRIORITY",get:function(){return NBe}}]),r}(ot);function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}function LBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FBe(n.key),n)}}function jBe(e,t,r){return t&&xH(e.prototype,t),r&&xH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FBe(e){var t=BBe(e,"string");return Nd(t)==="symbol"?t:String(t)}function BBe(e,t){if(Nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BS=0,DH=1,NH=2,jl="px",VBe=function(){function e(t){LBe(this,e),this.hot=t,this._element=null,this.state=BS}return jBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=NH}},{key:"build",value:function(){this.state===BS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=DH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=BS}},{key:"isAppended",value:function(){return this.state===NH}},{key:"isBuilt",value:function(){return this.state>=DH}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+jl),n!==void 0&&(this._element.style.left=n+jl)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+jl),n&&(this._element.style.height=n+jl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+jl),n&&(this._element.style.marginLeft=n+jl)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const Qz=VBe;function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function WBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zBe(n.key),n)}}function UBe(e,t,r){return t&&HH(e.prototype,t),r&&HH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zBe(e){var t=YBe(e,"string");return Ju(t)==="symbol"?t:String(t)}function YBe(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ng(){return typeof Reflect<"u"&&Reflect.get?Ng=Reflect.get.bind():Ng=function(t,r,n){var o=GBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ng.apply(this,arguments)}function GBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ef(e),e!==null););return e}function KBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TR(e,t)}function TR(e,t){return TR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},TR(e,t)}function qBe(e){var t=QBe();return function(){var n=ef(e),o;if(t){var i=ef(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XBe(this,o)}}function XBe(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZBe(e)}function ZBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ef(e){return ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ef(e)}var JBe="ht__manualRowMove--backlight",eVe=function(e){KBe(r,e);var t=qBe(r);function r(){return WBe(this,r),t.apply(this,arguments)}return UBe(r,[{key:"build",value:function(){Ng(ef(r.prototype),"build",this).call(this),te(this._element,JBe)}}]),r}(Qz);const tVe=eVe;function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function rVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oVe(n.key),n)}}function nVe(e,t,r){return t&&LH(e.prototype,t),r&&LH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oVe(e){var t=iVe(e,"string");return tf(t)==="symbol"?t:String(t)}function iVe(e,t){if(tf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hg(){return typeof Reflect<"u"&&Reflect.get?Hg=Reflect.get.bind():Hg=function(t,r,n){var o=aVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hg.apply(this,arguments)}function aVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=rf(e),e!==null););return e}function lVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PR(e,t)}function PR(e,t){return PR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PR(e,t)}function sVe(e){var t=cVe();return function(){var n=rf(e),o;if(t){var i=rf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uVe(this,o)}}function uVe(e,t){if(t&&(tf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fVe(e)}function fVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rf(e){return rf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rf(e)}var hVe="ht__manualRowMove--guideline",dVe=function(e){lVe(r,e);var t=sVe(r);function r(){return rVe(this,r),t.apply(this,arguments)}return nVe(r,[{key:"build",value:function(){Hg(rf(r.prototype),"build",this).call(this),te(this._element,hVe)}}]),r}(Qz);const vVe=dVe;function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function yVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pVe(n.key),n)}}function gVe(e,t,r){return t&&jH(e.prototype,t),r&&jH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pVe(e){var t=mVe(e,"string");return nf(t)==="symbol"?t:String(t)}function mVe(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(){return typeof Reflect<"u"&&Reflect.get?ka=Reflect.get.bind():ka=function(t,r,n){var o=bVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ka.apply(this,arguments)}function bVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function wVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kR(e,t)}function kR(e,t){return kR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kR(e,t)}function SVe(e){var t=_Ve();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CVe(this,o)}}function CVe(e,t){if(t&&(nf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $R(e)}function $R(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");var VS="manualRowMove",OVe=140,ii=new WeakMap,FH="ht__manualRowMove",zy="show-ui",WS="on-moving--rows",US="after-selection--rows",RVe=function(e){wVe(r,e);var t=SVe(r);function r(n){var o;return yVe(this,r),o=t.call(this,n),ii.set($R(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new Pt($R(o)),o.backlight=new tVe(n),o.guideline=new vVe(n),o}return gVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[VS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,FH),ka(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ka(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,FH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ka(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=ii.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=ii.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[VS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return Ce(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=ii.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Ut(c),d=Va(c),v=u.holder.scrollTop,y;this.hot.rootWindow===d?y=d.scrollY:y=d.scrollTop;var m=h.top-y,w=o.target.eventPageY-m+v,C=u.hider.offsetHeight,S=u.TBODY.offsetTop,R=this.backlight.getOffset().top,O=this.backlight.getSize().height,j=f.offsetHeight/2,U=f.offsetHeight,q=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),G=w>=q+j;this.isFixedRowTop(i.row)&&(q+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:G?(o.target.row=i.row+1,q+=i.row===0?U-1:U):o.target.row=i.row;var X=w,Q=q;w+O+R>=C?X=C-O-R:w+R<S&&(X=S+Math.abs(R)),q>=C-1&&(Q=C-1),this.backlight.setPosition(X),this.guideline.setPosition(Q)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=ii.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Le(this.hot.rootElement,[WS,zy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&y&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var m=h.from,w=h.to,C=Math.min(m.row,w.row),S=Math.max(m.row,w.row);if(i.col<0&&i.row>=C&&i.row<=S){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var R=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,R),this.backlight.setSize(u.hider.offsetWidth-R,this.getRowsHeight(C,S)),this.backlight.setOffset((this.getRowsHeight(C,i.row-1)+o.offsetY)*-1,null),te(this.hot.rootElement,WS),this.refreshPositions()}else Le(this.hot.rootElement,US),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ii.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ii.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Le(this.hot.rootElement,zy):te(this.hot.rootElement,zy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ii.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Le(this.hot.rootElement,[WS,zy,US]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,US),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ka(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return VS}},{key:"PLUGIN_PRIORITY",get:function(){return OVe}}]),r}(ot);function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function EVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PVe(n.key),n)}}function TVe(e,t,r){return t&&BH(e.prototype,t),r&&BH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PVe(e){var t=kVe(e,"string");return of(t)==="symbol"?t:String(t)}function kVe(e,t){if(of(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(of(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $a(){return typeof Reflect<"u"&&Reflect.get?$a=Reflect.get.bind():$a=function(t,r,n){var o=$Ve(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$a.apply(this,arguments)}function $Ve(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function AVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AR(e,t)}function AR(e,t){return AR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},AR(e,t)}function IVe(e){var t=xVe();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MVe(this,o)}}function MVe(e,t){if(t&&(of(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IR(e)}function IR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}var Yy="manualRowResize",DVe=30,VH="manualRowHeights",zS=new WeakMap,NVe=function(e){AVe(r,e);var t=IVe(r);function r(n){var o;EVe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Pt(IR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,zS.set(IR(o),{config:void 0}),te(o.handle,"manualRowResizer"),te(o.guide,"manualRowResizerGuide"),o}return TVe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Yy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Li,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),$a(Io(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$a(Io(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=zS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),$a(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",VH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",VH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,BW.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=ct(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var m=this.hot.getSelectedRange();A(m,function(w){var C=w.getTopStartCorner().row,S=w.getBottomStartCorner().row;Ce(C,S,function(R){i.selectedRows.includes(R)||i.selectedRows.push(R)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(ct(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=pi(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!ME(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),A(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[Yy]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=zS.get(this),a=this.hot.getSettings()[Yy],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){$a(Io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Yy}},{key:"PLUGIN_PRIORITY",get:function(){return DVe}}]),r}(ot);function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}var WH,UH,zH,YH;function Gy(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function HVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jVe(n.key),n)}}function LVe(e,t,r){return t&&GH(e.prototype,t),r&&GH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jVe(e){var t=FVe(e,"string");return Hd(t)==="symbol"?t:String(t)}function FVe(e,t){if(Hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BVe=function(){function e(t,r,n,o,i,a){HVe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return LVe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return dt(WH||(WH=Gy(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return dt(UH||(UH=Gy(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return dt(zH||(zH=Gy(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return dt(YH||(YH=Gy(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const Ln=BVe;function MR(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}var KH;function VVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qH(e){return YVe(e)||zVe(e)||UVe(e)||WVe()}function WVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UVe(e,t){if(e){if(typeof e=="string")return xR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xR(e,t)}}function zVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YVe(e){if(Array.isArray(e))return xR(e)}function xR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qVe(n.key),n)}}function KVe(e,t,r){return t&&XH(e.prototype,t),r&&XH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qVe(e){var t=XVe(e,"string");return Ld(t)==="symbol"?t:String(t)}function XVe(e,t){if(Ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZVe=function(){function e(t){GVe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return KVe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return A(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return A(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return A(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new Ln(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(bt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];A(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,A(o,function(a,l){Ce(0,a.rowspan-1,function(s){Ce(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),A(o,function(a){MR.apply(void 0,qH(a))}),A(i,function(a){MR.apply(void 0,qH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return A(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}A(this.mergedCells,function(l){l.shift(a,n)}),op(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return dt(KH||(KH=VVe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const QVe=ZVe;function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}function ta(e,t){return rWe(e)||tWe(e,t)||eWe(e,t)||JVe()}function JVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eWe(e,t){if(e){if(typeof e=="string")return ZH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZH(e,t)}}function ZH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rWe(e){if(Array.isArray(e))return e}function nWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iWe(n.key),n)}}function oWe(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iWe(e){var t=aWe(e,"string");return jd(t)==="symbol"?t:String(t)}function aWe(e,t){if(jd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lWe=function(){function e(t){nWe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return oWe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=ta(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,y=Math.floor(l/v)*v,m=l-y,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var C=w.row+w.rowspan-u-m,S=a[2]+C;S>=this.plugin.hot.countRows()?a[2]-=m:a[2]+=m?C:0}else if(o==="right"){var R=w.col+w.colspan-f-m,O=a[3]+R;O>=this.plugin.hot.countCols()?a[3]-=m:a[3]+=m?R:0}else if(o==="up"){var j=c-m-w.row+1,U=a[0]+j;U<0?a[0]+=m:a[0]-=m?j:0}else if(o==="left"){var q=h-m-w.col+1,G=a[1]+q;G<0?a[1]+=m:a[1]-=m?q:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),zt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=ta(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ta(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=ta(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ta(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=ta(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),y=c?u-l+1:f-s+1,m=Math.floor(v/y)*y,w=v-m,C=null,S=null,R=null;switch(o){case"up":C="includesVertically",R=h-w+1;break;case"left":C="includesHorizontally",R=h-w+1;break;case"down":C="includesVertically",R=d+w-1;break;case"right":C="includesHorizontally",R=d+w-1;break}return A(i,function(O){O[C](R)&&O.isFarther(S,o)&&(S=O)}),S}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return A(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=ta(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const sWe=lWe;function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function uWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cWe(n.key),n)}}function fWe(e,t,r){return t&&JH(e.prototype,t),r&&JH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cWe(e){var t=hWe(e,"string");return Fd(t)==="symbol"?t:String(t)}function hWe(e,t){if(Fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dWe=function(){function e(t){uWe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return fWe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const vWe=dWe;function yWe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(FT)}return this.getTranslatedPhrase(jT)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Ln.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function gWe(e,t){return bWe(e)||mWe(e,t)||Jz(e,t)||pWe()}function pWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bWe(e){if(Array.isArray(e))return e}function wWe(e){return _We(e)||CWe(e)||Jz(e)||SWe()}function SWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jz(e,t){if(e){if(typeof e=="string")return DR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DR(e,t)}}function CWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _We(e){if(Array.isArray(e))return DR(e)}function DR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EWe(n.key),n)}}function RWe(e,t,r){return t&&eL(e.prototype,t),r&&eL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EWe(e){var t=TWe(e,"string");return af(t)==="symbol"?t:String(t)}function TWe(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fs(){return typeof Reflect<"u"&&Reflect.get?fs=Reflect.get.bind():fs=function(t,r,n){var o=PWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fs.apply(this,arguments)}function PWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pi(e),e!==null););return e}function kWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NR(e,t)}function NR(e,t){return NR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},NR(e,t)}function $We(e){var t=IWe();return function(){var n=Pi(e),o;if(t){var i=Pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return AWe(this,o)}}function AWe(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eY(e)}function eY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pi(e)}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");var Cc="mergeCells",MWe=150,tL=new WeakMap,rL=Cc,xWe=function(e){kWe(r,e);var t=$We(r);function r(n){var o;return OWe(this,r),o=t.call(this,n),tL.set(eY(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return RWe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Cc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new QVe(this),this.autofillCalculations=new sWe(this),this.selectionCalculations=new vWe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),fs(Pi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),fs(Pi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[Cc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),fs(Pi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(SE()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=wWe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=bs(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=bs(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(Ln.containsNegativeValues(o)?(bt(Ln.NEGATIVE_VALUES_WARNING(o)),i=!1):Ln.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(bt(Ln.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Ln.isSingleCell(o)?(bt(Ln.IS_SINGLE_CELL(o)),i=!1):Ln.containsZeroSpan(o)&&(bt(Ln.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(A(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),Ce(l.row,l.row+l.rowspan-1,function(c){Ce(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Ce(0,f.rowspan-1,function(v){Ce(0,f.colspan-1,function(y){var m=null;c[v]||(c[v]=[]),v===0&&y===0?m=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+y,"hidden",!0),c[v][y]=m})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),A(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),Ce(0,s.rowspan-1,function(u){Ce(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Cc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:rL})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(rL)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=tL.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var y=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:y.row-u.row,col:y.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=Sr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=Sr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=Sr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),A(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},yWe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ue(l)?Sr(l):void 0;if(Ue(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,y=s.rowspan,m=this.translateMergedCellToRenderable(h,y,d,v),w=gWe(m,2),C=w[0],S=w[1],R=f.getRenderableFromVisualIndex(i),O=c.getRenderableFromVisualIndex(a),j=C-R+1,U=S-O+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,j),s.colspan=Math.min(s.colspan,U)}MR(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);A(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,y=l.col===0;(s&&h||u&&d||c&&v||f&&y)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Cc}},{key:"PLUGIN_PRIORITY",get:function(){return MWe}}]),r}(ot);function nL(e){return LWe(e)||HWe(e)||NWe(e)||DWe()}function DWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NWe(e,t){if(e){if(typeof e=="string")return oL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oL(e,t)}}function oL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function LWe(e){if(Array.isArray(e))return e}function jWe(e,t){return function(r,n){var o=nL(r),i=o.slice(1),a=nL(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:q2(c.type),m=y(f,c,v)(h,d);if(m===Vn){var w=u+1;if(typeof t[w]<"u")return s(w)}return m}(0)}}var iL;function FWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aL(){bt(dt(iL||(iL=FWe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var tY="sort";function BWe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(tY,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function VWe(e){var t=e.className.split(" "),r=new RegExp("^".concat(tY,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function WWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zWe(n.key),n)}}function UWe(e,t,r){return t&&lL(e.prototype,t),r&&lL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zWe(e){var t=YWe(e,"string");return lf(t)==="symbol"?t:String(t)}function YWe(e,t){if(lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jr(){return typeof Reflect<"u"&&Reflect.get?jr=Reflect.get.bind():jr=function(t,r,n){var o=GWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jr.apply(this,arguments)}function GWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=br(e),e!==null););return e}function KWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HR(e,t)}function HR(e,t){return HR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HR(e,t)}function qWe(e){var t=QWe();return function(){var n=br(e),o;if(t){var i=br(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XWe(this,o)}}function XWe(e,t){if(t&&(lf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZWe(e)}function ZWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},br(e)}var LR="multiColumnSorting",JWe=170,e2e="append",sL="columnSorting";K2(LR,jWe);var t2e=function(e){KWe(r,e);var t=qWe(r);function r(n){var o;return WWe(this,r),o=t.call(this,n),o.pluginKey=LR,o}return UWe(r,[{key:"isEnabled",value:function(){return jr(br(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sL]&&aL(),jr(br(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){jr(br(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){jr(br(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){jr(br(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return jr(br(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return jr(br(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){jr(br(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=jr(br(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),Le(o,VWe(o)),this.enabled!==!1&&te(o,BWe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[sL]&&aL(),jr(br(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){hO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,e2e))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return LR}},{key:"PLUGIN_PRIORITY",get:function(){return JWe}}]),r}(Z2);function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function r2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o2e(n.key),n)}}function n2e(e,t,r){return t&&uL(e.prototype,t),r&&uL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o2e(e){var t=i2e(e,"string");return sf(t)==="symbol"?t:String(t)}function i2e(e,t){if(sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lg(){return typeof Reflect<"u"&&Reflect.get?Lg=Reflect.get.bind():Lg=function(t,r,n){var o=a2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Lg.apply(this,arguments)}function a2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uf(e),e!==null););return e}function l2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jR(e,t)}function jR(e,t){return jR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},jR(e,t)}function s2e(e){var t=c2e();return function(){var n=uf(e),o;if(t){var i=uf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return u2e(this,o)}}function u2e(e,t){if(t&&(sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f2e(e)}function f2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uf(e){return uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uf(e)}var h2e="multipleSelectionHandles",d2e=160,v2e=function(e){l2e(r,e);var t=s2e(r);function r(n){var o;return r2e(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return n2e(r,[{key:"isEnabled",value:function(){return pn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Pt(this)),this.registerListeners(),Lg(uf(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,y;if(i.dragged.length!==0){var m=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!m||m===i.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(f=i.hot.getCoords(m),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),y=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),y.start!==null&&i.hot.selection.setRangeStart(y.start),i.hot.selection.setRangeEnd(y.end),i.lastSetCell=m),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return h2e}},{key:"PLUGIN_PRIORITY",get:function(){return d2e}}]),r}(ot);function FR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,y=e.isRoot,m=y===void 0?!1:y,w=e.isPlaceholder,C=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:m,isPlaceholder:C}}function rY(){return{label:"",isPlaceholder:!0}}function fL(e){return m2e(e)||p2e(e)||g2e(e)||y2e()}function y2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g2e(e,t){if(e){if(typeof e=="string")return BR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BR(e,t)}}function p2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m2e(e){if(Array.isArray(e))return BR(e)}function BR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b2e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;A(e,function(o){var i=[],a=0;r.push(i),A(o,function(l){var s=FR();if(Ue(l)){var u=l.label,f=l.colspan;s.label=Dt(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=Dt(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(rY());return!c})});var n=Math.max.apply(Math,fL(We(r,function(o){return o.length})));return A(r,function(o){if(o.length<n){var i=We(new Array(n-o.length),function(){return FR()});o.splice.apply(o,[o.length,0].concat(fL(i)))}}),r}function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}var w2e=["row","col"];function cL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function S2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cL(Object(r),!0).forEach(function(n){C2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C2e(e,t,r){return t=nY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _2e(e,t){if(e==null)return{};var r=O2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function R2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nY(n.key),n)}}function E2e(e,t,r){return t&&hL(e.prototype,t),r&&hL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nY(e){var t=T2e(e,"string");return Bd(t)==="symbol"?t:String(t)}function T2e(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YS(e,t,r){P2e(e,t),t.set(e,r)}function P2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(e,t){var r=oY(e,t,"get");return k2e(e,r)}function k2e(e,t){return t.get?t.get.call(e):t.value}function vc(e,t,r){var n=oY(e,t,"set");return $2e(e,n,r),r}function oY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var dL=["label","collapsible"],no=new WeakMap,ra=new WeakMap,GS=new WeakMap,A2e=function(){function e(){R2e(this,e),YS(this,no,{writable:!0,value:[]}),YS(this,ra,{writable:!0,value:0}),YS(this,GS,{writable:!0,value:1/0})}return E2e(e,[{key:"setColumnsLimit",value:function(r){vc(this,GS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];vc(this,no,b2e(r,un(this,GS))),vc(this,ra,un(this,no).length)}},{key:"getData",value:function(){return un(this,no)}},{key:"mergeWith",value:function(r){var n=this;A(r,function(o){var i=o.row,a=o.col,l=_2e(o,w2e),s=n.getHeaderSettings(i,a);s!==null&&zt(s,l,dL)})}},{key:"map",value:function(r){A(un(this,no),function(n){A(n,function(o){var i=r(S2e({},o));Ue(i)&&zt(o,i,dL)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=un(this,ra)||r<0)return null;var i=un(this,no)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=un(this,ra)||r<0)return i;for(var a=un(this,no)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return un(this,ra)}},{key:"getColumnsCount",value:function(){return un(this,ra)>0?un(this,no)[0].length:0}},{key:"clear",value:function(){vc(this,no,[]),vc(this,ra,0)}}]),e}();function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vd(e)}function vL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vL(Object(r),!0).forEach(function(n){jg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iY(n.key),n)}}function M2e(e,t,r){return t&&gL(e.prototype,t),r&&gL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jg(e,t,r){return t=iY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iY(e){var t=x2e(e,"string");return Vd(t)==="symbol"?t:String(t)}function x2e(e,t){if(Vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D2e(e){return j2e(e)||L2e(e)||H2e(e)||N2e()}function N2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H2e(e,t){if(e){if(typeof e=="string")return VR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VR(e,t)}}function L2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function j2e(e){if(Array.isArray(e))return VR(e)}function VR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var F2e="DF-pre-order";function aY(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=aY.call(this.childs[n],e,t)}return r}var B2e="DF-post-order";function lY(e,t){for(var r=0;r<this.childs.length;r++){var n=lY.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var sY="BF";function V2e(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,D2e(o.childs)),e.call(t,o)!==!1&&n()}}n()}var W2e=sY,pL=new Map([[F2e,aY],[B2e,lY],[sY,V2e]]),mL=function(){function e(t){I2e(this,e),jg(this,"data",{}),jg(this,"parent",null),jg(this,"childs",[]),this.data=t}return M2e(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(yL({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=yL({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W2e;if(!pL.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));pL.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Wd(e){"@babel/helpers - typeof";return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wd(e)}function bL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bL(Object(r),!0).forEach(function(n){U2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U2e(e,t,r){return t=uY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z2e(e,t){return q2e(e)||K2e(e,t)||G2e(e,t)||Y2e()}function Y2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G2e(e,t){if(e){if(typeof e=="string")return SL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SL(e,t)}}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function q2e(e){if(Array.isArray(e))return e}function X2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uY(n.key),n)}}function Z2e(e,t,r){return t&&CL(e.prototype,t),r&&CL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uY(e){var t=Q2e(e,"string");return Wd(t)==="symbol"?t:String(t)}function Q2e(e,t){if(Wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KS(e,t,r){J2e(e,t),t.set(e,r)}function J2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(e,t){var r=fY(e,t,"get");return eUe(e,r)}function eUe(e,t){return t.get?t.get.call(e):t.value}function tUe(e,t,r){var n=fY(e,t,"set");return rUe(e,n,r),r}function fY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function rUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Fl=new WeakMap,na=new WeakMap,Bl=new WeakMap,nUe=function(){function e(t){X2e(this,e),KS(this,Fl,{writable:!0,value:new Map}),KS(this,na,{writable:!0,value:new Map}),KS(this,Bl,{writable:!0,value:null}),tUe(this,Bl,t)}return Z2e(e,[{key:"getRoots",value:function(){return Array.from(gr(this,Fl).values())}},{key:"getRootByColumn",value:function(r){var n;return gr(this,na).has(r)&&(n=gr(this,Fl).get(gr(this,na).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-gr(this,na).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;gr(this,na).clear(),A(gr(this,Fl),function(o){for(var i=z2e(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)gr(r,na).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=gr(this,Bl).getColumnsCount(),n=0;n<r;){var o=gr(this,Bl).getHeaderSettings(0,n),i=new mL;gr(this,Fl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=gr(this,Bl).getHeadersSettings(o,n,a);o+=1,A(l,function(s){var u=wL(wL({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new mL(u),r.addChild(f)),o<gr(i,Bl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){gr(this,Fl).clear(),gr(this,na).clear()}}]),e}();function cY(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Xp(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function Zp(e){return Xp(e,"origColspan")===e.data.origColspan}function rk(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Zp(e);if(n)return rk(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)A(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,cY(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Zp(c)&&(h.isCollapsed=Xp(c,"isCollapsed"))}),{rollbackModification:function(){return nk(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function nk(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Zp(e);if(o)return nk(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)A(i,function(h){cY(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=Xp(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):Zp(h)&&(d.isCollapsed=Xp(h,"isCollapsed"))}),{rollbackModification:function(){return rk(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var _L;function oUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function iUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(_L||(_L=oUe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var OL;function aUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(OL||(OL=aUe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var RL=new Map([["collapse",nk],["expand",rk],["hide-column",iUe],["show-column",lUe]]);function sUe(e,t,r){if(!RL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return RL.get(e)(t,r)}var uUe=["crossHiddenColumns"];function fUe(e,t){if(e==null)return{};var r=cUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Ky(e){var t=[];return A(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=dUe(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(rY());else{var d=hUe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function hUe(e){var t=FR(e);t.crossHiddenColumns;var r=fUe(t,uUe);return r}function dUe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function Ud(e){"@babel/helpers - typeof";return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}var vUe=["row"];function EL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function TL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EL(Object(r),!0).forEach(function(n){yUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yUe(e,t,r){return t=hY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gUe(e,t){if(e==null)return{};var r=pUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function mUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hY(n.key),n)}}function bUe(e,t,r){return t&&PL(e.prototype,t),r&&PL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hY(e){var t=wUe(e,"string");return Ud(t)==="symbol"?t:String(t)}function wUe(e,t){if(Ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qS(e,t,r){SUe(e,t),t.set(e,r)}function SUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yc(e,t,r){var n=dY(e,t,"set");return CUe(e,n,r),r}function CUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Lt(e,t){var r=dY(e,t,"get");return _Ue(e,r)}function dY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _Ue(e,t){return t.get?t.get.call(e):t.value}var xn=new WeakMap,Lr=new WeakMap,oa=new WeakMap,OUe=function(){function e(){mUe(this,e),qS(this,xn,{writable:!0,value:new A2e}),qS(this,Lr,{writable:!0,value:new nUe(Lt(this,xn))}),qS(this,oa,{writable:!0,value:[[]]})}return bUe(e,[{key:"setState",value:function(r){Lt(this,xn).setData(r);var n=!1;try{Lt(this,Lr).buildTree()}catch{Lt(this,Lr).clear(),Lt(this,xn).clear(),n=!0}return yc(this,oa,Ky(Lt(this,Lr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Lt(this,xn).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=We(r,function(i){var a=i.row,l=gUe(i,vUe);return TL({row:a<0?n.rowCoordsToLevel(a):a},l)});Lt(this,xn).mergeWith(o),Lt(this,Lr).buildTree(),yc(this,oa,Ky(Lt(this,Lr).getRoots()))}},{key:"mapState",value:function(r){Lt(this,xn).map(r),Lt(this,Lr).buildTree(),yc(this,oa,Ky(Lt(this,Lr).getRoots()))}},{key:"mapNodes",value:function(r){return Ft(Lt(this,Lr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Lt(this,Lr).getNode(n,o),a;return i&&(a=sUe(r,i,o),yc(this,oa,Ky(Lt(this,Lr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Lt(this,oa)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Lt(this,Lr).getNode(r,n);return o?TL({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Lt(this,xn).getLayersCount()}},{key:"getColumnsCount",value:function(){return Lt(this,xn).getColumnsCount()}},{key:"clear",value:function(){yc(this,oa,[]),Lt(this,xn).clear(),Lt(this,Lr).clear()}}]),e}();function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}function RUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vY(n.key),n)}}function EUe(e,t,r){return t&&kL(e.prototype,t),r&&kL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gc(e,t,r){return t=vY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vY(e){var t=TUe(e,"string");return zd(t)==="symbol"?t:String(t)}function TUe(e,t){if(zd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PUe=function(){function e(t,r){RUe(this,e),gc(this,"hot",void 0),gc(this,"nestedHeaderSettingsGetter",void 0),gc(this,"layersCount",0),gc(this,"container",void 0),gc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return EUe(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),y=this.nestedHeaderSettingsGetter(f,d);if(y&&(!y.isPlaceholder||y.isHidden)){var m=y.label;s&&(m+='<button class="changeType"></button>'),sl(v,m),v.colSpan=y.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const kUe=PUe;function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}var $L,AL;function IL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $Ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ML(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yY(n.key),n)}}function AUe(e,t,r){return t&&ML(e.prototype,t),r&&ML(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aa(){return typeof Reflect<"u"&&Reflect.get?Aa=Reflect.get.bind():Aa=function(t,r,n){var o=IUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Aa.apply(this,arguments)}function IUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mo(e),e!==null););return e}function MUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WR(e,t)}function WR(e,t){return WR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},WR(e,t)}function xUe(e){var t=NUe();return function(){var n=Mo(e),o;if(t){var i=Mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return DUe(this,o)}}function DUe(e,t){if(t&&(ff(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _c(e)}function _c(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mo(e)}function xL(e,t,r){return t=yY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yY(e){var t=HUe(e,"string");return ff(t)==="symbol"?t:String(t)}function HUe(e,t){if(ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DL(e,t,r){LUe(e,t),t.set(e,r)}function LUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qy(e,t,r){var n=gY(e,t,"set");return jUe(e,n,r),r}function jUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function $t(e,t){var r=gY(e,t,"get");return FUe(e,r)}function gY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function FUe(e,t){return t.get?t.get.call(e):t.value}var NL="nestedHeaders",BUe=280,Vt=new WeakMap,ai=new WeakMap,VUe=function(e){MUe(r,e);var t=xUe(r);function r(){var n;$Ue(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),DL(_c(n),Vt,{writable:!0,value:new OUe}),DL(_c(n),ai,{writable:!0,value:null}),xL(_c(n),"ghostTable",new kUe(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),xL(_c(n),"detectedOverlappedHeaders",!1),n}return AUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NL]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&bt(dt($L||($L=IL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),Aa(Mo(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;$t(this,Vt).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=$t(this,Vt).setState(a)),this.detectedOverlappedHeaders&&bt(dt(AL||(AL=IL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(u,s)}),!$t(this,ai)&&this.enabled&&qy(this,ai,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Aa(Mo(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),$t(this,Vt).clear(),$t(this,ai).unsubscribe(),qy(this,ai,null),this.ghostTable.clear(),Aa(Mo(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return $t(this,Vt)}},{key:"getLayersCount",value:function(){return $t(this,Vt).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return $t(this,Vt).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Le(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Le(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Le(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),Le(s,"hiddenHeader");var v=(u=$t(i,Vt).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},y=v.colspan,m=v.isHidden,w=v.isPlaceholder;if(w||m)te(s,"hiddenHeader");else if(y>1){var C,S,R=h._wt.wtOverlays,O=(C=R.topInlineStartCornerOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),j=(S=R.inlineStartOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),U=O||j?Math.min(y,a-l):y;U>1&&s.setAttribute("colspan",U)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=$t(this,Vt).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=$t(this,Vt).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=$t(this,Vt).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===jv){if(!d)return l.columnIndex}else f===sb&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,y=c-d+1;if(f>=0||y===1)break;for(var m=c;m<=d;m++)for(var w=f;w<=h;w++){var C,S=v+w,R=m-c;if(R!==0){var O=(C=$t(this,Vt).getHeaderTreeNodeData(w,m))===null||C===void 0?void 0:C.isRoot;O===!1&&(o[S][R]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(jm(o)||$i(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),y=h.from;l.column=!0,l.cell=!0;var m=[];i.col<y.col?m.push(v.col,f):i.col>y.col?m.push(d.col,f+c-1):m.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<$t(this,Vt).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=$t(this,Vt).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=$t(this,Vt).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),wr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?$t(this,Vt).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=$t(this,Vt).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){qy(this,Vt,null),$t(this,ai)!==null&&($t(this,ai).unsubscribe(),qy(this,ai,null)),Aa(Mo(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return $t(this,Vt).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return NL}},{key:"PLUGIN_PRIORITY",get:function(){return BUe}}]),r}(ot);function HL(e){return YUe(e)||zUe(e)||UUe(e)||WUe()}function WUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UUe(e,t){if(e){if(typeof e=="string")return UR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UR(e,t)}}function zUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YUe(e){if(Array.isArray(e))return UR(e)}function UR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function GUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qUe(n.key),n)}}function KUe(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qUe(e){var t=XUe(e,"string");return cf(t)==="symbol"?t:String(t)}function XUe(e,t){if(cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZUe=function(){function e(t,r){GUe(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return KUe(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&A(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&A(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return ze(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(A(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||cf(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Ce(r[0],r[2],function(w){var C=n.translateTrimmedRow(w);a.push(n.getDataObject(C))}),Ce(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];A(o,function(l){a.push(i.getDataObject(l))}),A(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(HL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(HL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const QUe=ZUe;function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}function jL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eze(n.key),n)}}function JUe(e,t,r){return t&&jL(e.prototype,t),r&&jL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eze(e){var t=tze(e,"string");return Yd(t)==="symbol"?t:String(t)}function tze(e,t){if(Yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var nze=JUe(function e(t,r){rze(this,e),this.hot=r,this.plugin=t});const ok=nze;function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function oze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aze(n.key),n)}}function ize(e,t,r){return t&&FL(e.prototype,t),r&&FL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aze(e){var t=lze(e,"string");return hf(t)==="symbol"?t:String(t)}function lze(e,t){if(hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zR(e,t)}function zR(e,t){return zR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zR(e,t)}function uze(e){var t=hze();return function(){var n=Qp(e),o;if(t){var i=Qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fze(this,o)}}function fze(e,t){if(t&&(hf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cze(e)}function cze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qp(e)}var dze=function(e){sze(r,e);var t=uze(r);function r(n,o){var i;return oze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return ize(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(A(c,function(y){y&&u.removeChild(y)}),te(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Ce(0,l-1,function(){var y=h.createElement("SPAN");te(y,r.CSS_CLASSES.emptyIndicator),u.appendChild(y)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");te(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(ok);const pY=dze;function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function BL(e){return pze(e)||gze(e)||yze(e)||vze()}function vze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yze(e,t){if(e){if(typeof e=="string")return YR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YR(e,t)}}function gze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pze(e){if(Array.isArray(e))return YR(e)}function YR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wze(n.key),n)}}function bze(e,t,r){return t&&VL(e.prototype,t),r&&VL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wze(e){var t=Sze(e,"string");return df(t)==="symbol"?t:String(t)}function Sze(e,t){if(df(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GR(e,t)}function GR(e,t){return GR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GR(e,t)}function _ze(e){var t=Eze();return function(){var n=Jp(e),o;if(t){var i=Jp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Oze(this,o)}}function Oze(e,t){if(t&&(df(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rze(e)}function Rze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jp(e){return Jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jp(e)}var Tze=function(e){Cze(r,e);var t=_ze(r);function r(n,o){var i;return mze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),A(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){Ce(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return bze(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&A(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,BL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&A(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,BL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&A(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,pY.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),wn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(ok);const Pze=Tze;function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function kze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Aze(n.key),n)}}function $ze(e,t,r){return t&&WL(e.prototype,t),r&&WL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aze(e){var t=Ize(e,"string");return vf(t)==="symbol"?t:String(t)}function Ize(e,t){if(vf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KR(e,t)}function KR(e,t){return KR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KR(e,t)}function xze(e){var t=Nze();return function(){var n=em(e),o;if(t){var i=em(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Dze(this,o)}}function Dze(e,t){if(t&&(vf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mY(e)}function mY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function em(e){return em=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},em(e)}var UL=new WeakMap,Hze=function(e){Mze(r,e);var t=xze(r);function r(n,o){var i;return kze(this,r),i=t.call(this,n,o),UL.set(mY(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return $ze(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(iP)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(aP)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,o.items.length-1,function(l){if(l===0)return A(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=UL.get(this);return Ce(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(ok);const Lze=Hze;function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}var zL;function YL(e){return Vze(e)||Bze(e)||Fze(e)||jze()}function jze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fze(e,t){if(e){if(typeof e=="string")return qR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qR(e,t)}}function Bze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vze(e){if(Array.isArray(e))return qR(e)}function qR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wze(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Uze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yze(n.key),n)}}function zze(e,t,r){return t&&GL(e.prototype,t),r&&GL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yze(e){var t=Gze(e,"string");return Gd(t)==="symbol"?t:String(t)}function Gze(e,t){if(Gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kze=function(){function e(t){Uze(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return zze(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(m){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(m);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),y=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,y),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return mt(i)&&(bt(dt(zL||(zL=Wze([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,YL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,YL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function qze(e){return Jze(e)||Qze(e)||Zze(e)||Xze()}function Xze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zze(e,t){if(e){if(typeof e=="string")return XR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XR(e,t)}}function Qze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jze(e){if(Array.isArray(e))return XR(e)}function XR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rYe(n.key),n)}}function tYe(e,t,r){return t&&KL(e.prototype,t),r&&KL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rYe(e){var t=nYe(e,"string");return yf(t)==="symbol"?t:String(t)}function nYe(e,t){if(yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ia(){return typeof Reflect<"u"&&Reflect.get?Ia=Reflect.get.bind():Ia=function(t,r,n){var o=oYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ia.apply(this,arguments)}function oYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xo(e),e!==null););return e}function iYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZR(e,t)}function ZR(e,t){return ZR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZR(e,t)}function aYe(e){var t=sYe();return function(){var n=xo(e),o;if(t){var i=xo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lYe(this,o)}}function lYe(e,t){if(t&&(yf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bY(e)}function bY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xo(e){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xo(e)}var XS="nestedRows",uYe=300,oo=new WeakMap,fYe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",cYe=function(e){iYe(r,e);var t=aYe(r);function r(n){var o;return eYe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,oo.set(bY(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return tYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[XS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new xv),this.dataManager=new QUe(this,this.hot),this.collapsingUI=new Pze(this,this.hot),this.headersUI=new pY(this,this.hot),this.contextMenuUI=new Lze(this,this.hot),this.rowMoveController=new Kze(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),Ia(xo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Ia(xo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),Ia(xo(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=oo.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=oo.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=oo.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=oo.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=oo.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,qze(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=oo.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){Ia(xo(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!_U(o)){xE(fYe),this.hot.getSettings()[XS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return XS}},{key:"PLUGIN_PRIORITY",get:function(){return uYe}}]),r}(ot);function Kd(e){"@babel/helpers - typeof";return Kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kd(e)}function hYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vYe(n.key),n)}}function dYe(e,t,r){return t&&qL(e.prototype,t),r&&qL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vYe(e){var t=yYe(e,"string");return Kd(t)==="symbol"?t:String(t)}function yYe(e,t){if(Kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gYe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;hYe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return dYe(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;A(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const pYe=gYe;function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function mYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wYe(n.key),n)}}function bYe(e,t,r){return t&&XL(e.prototype,t),r&&XL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wYe(e){var t=SYe(e,"string");return gf(t)==="symbol"?t:String(t)}function SYe(e,t){if(gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ma(){return typeof Reflect<"u"&&Reflect.get?Ma=Reflect.get.bind():Ma=function(t,r,n){var o=CYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ma.apply(this,arguments)}function CYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Do(e),e!==null););return e}function _Ye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QR(e,t)}function QR(e,t){return QR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QR(e,t)}function OYe(e){var t=TYe();return function(){var n=Do(e),o;if(t){var i=Do(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return RYe(this,o)}}function RYe(e,t){if(t&&(gf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EYe(e)}function EYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Do(e){return Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Do(e)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");var ZL="persistentState",PYe=0,kYe=function(e){_Ye(r,e);var t=OYe(r);function r(n){var o;return mYe(this,r),o=t.call(this,n),o.storage=void 0,o}return bYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ZL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new pYe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Ma(Do(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Ma(Do(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ma(Do(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Ma(Do(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ZL}},{key:"PLUGIN_PRIORITY",get:function(){return PYe}}]),r}(ot);function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function $Ye(e){return xYe(e)||MYe(e)||IYe(e)||AYe()}function AYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IYe(e,t){if(e){if(typeof e=="string")return JR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JR(e,t)}}function MYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xYe(e){if(Array.isArray(e))return JR(e)}function JR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HYe(n.key),n)}}function NYe(e,t,r){return t&&QL(e.prototype,t),r&&QL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HYe(e){var t=LYe(e,"string");return pf(t)==="symbol"?t:String(t)}function LYe(e,t){if(pf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xa(){return typeof Reflect<"u"&&Reflect.get?xa=Reflect.get.bind():xa=function(t,r,n){var o=jYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xa.apply(this,arguments)}function jYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=No(e),e!==null););return e}function FYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e0(e,t)}function e0(e,t){return e0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},e0(e,t)}function BYe(e){var t=UYe();return function(){var n=No(e),o;if(t){var i=No(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return VYe(this,o)}}function VYe(e,t){if(t&&(pf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WYe(e)}function WYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function No(e){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},No(e)}var ZS="search",zYe=190,YYe="htSearchResult",GYe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},KYe=function(t,r,n){return mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||mt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},qYe=function(e){FYe(r,e);var t=BYe(r);function r(n){var o;return DYe(this,r),o=t.call(this,n),o.callback=GYe,o.queryMethod=KYe,o.searchResultClass=YYe,o}return NYe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[ZS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[ZS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),xa(No(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),xa(No(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),xa(No(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Ce(0,s-1,function(h){Ce(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),y=i.hot.getCellMeta(h,d),m=y.search.callback||a,w=y.search.queryMethod||l,C=w(o,v,y);if(C){var S={row:h,col:d,data:v};f.push(S)}m&&m(c,h,d,v,C)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ue(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,$Ye(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){xa(No(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ZS}},{key:"PLUGIN_PRIORITY",get:function(){return zYe}}]),r}(ot);function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function XYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QYe(n.key),n)}}function ZYe(e,t,r){return t&&JL(e.prototype,t),r&&JL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QYe(e){var t=JYe(e,"string");return mf(t)==="symbol"?t:String(t)}function JYe(e,t){if(mf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cs(){return typeof Reflect<"u"&&Reflect.get?cs=Reflect.get.bind():cs=function(t,r,n){var o=eGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cs.apply(this,arguments)}function eGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ki(e),e!==null););return e}function tGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t0(e,t)}function t0(e,t){return t0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},t0(e,t)}function rGe(e){var t=iGe();return function(){var n=ki(e),o;if(t){var i=ki(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nGe(this,o)}}function nGe(e,t){if(t&&(mf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oGe(e)}function oGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ki(e){return ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ki(e)}var aGe="touchScroll",lGe=200,sGe=function(e){tGe(r,e);var t=rGe(r);function r(n){var o;return XYe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return ZYe(r,[{key:"isEnabled",value:function(){return EE()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),cs(ki(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,cs(ki(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){cs(ki(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,A(this.clones,function(o){te(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,A(this.clones,function(i){Le(i,"hide-tween"),te(i,"show-tween")}),this.hot._registerTimeout(function(){A(o.clones,function(i){Le(i,"show-tween")})},400),A(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return aGe}},{key:"PLUGIN_PRIORITY",get:function(){return lGe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ot);function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function uGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ej(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cGe(n.key),n)}}function fGe(e,t,r){return t&&ej(e.prototype,t),r&&ej(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cGe(e){var t=hGe(e,"string");return bf(t)==="symbol"?t:String(t)}function hGe(e,t){if(bf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Da(){return typeof Reflect<"u"&&Reflect.get?Da=Reflect.get.bind():Da=function(t,r,n){var o=dGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Da.apply(this,arguments)}function dGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ho(e),e!==null););return e}function vGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r0(e,t)}function r0(e,t){return r0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},r0(e,t)}function yGe(e){var t=mGe();return function(){var n=Ho(e),o;if(t){var i=Ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gGe(this,o)}}function gGe(e,t){if(t&&(bf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pGe(e)}function pGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ho(e){return Ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ho(e)}var Xy="trimRows",bGe=330,wGe=function(e){vGe(r,e);var t=yGe(r);function r(n){var o;return uGe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return fGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Xy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new xv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Da(Ho(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[Xy];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Da(Ho(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Da(Ho(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(A(o,function(c){s[c]=!1}),l=Ft(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[Xy];Array.isArray(i)&&this.hot.batchExecution(function(){A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Da(Ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Xy}},{key:"PLUGIN_PRIORITY",get:function(){return bGe}}]),r}(ot);function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function wY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SGe(n.key),n)}}function SY(e,t,r){return t&&tj(e.prototype,t),r&&tj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SGe(e){var t=CGe(e,"string");return wf(t)==="symbol"?t:String(t)}function CGe(e,t){if(wf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n0(e,t)}function n0(e,t){return n0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},n0(e,t)}function _Y(e){var t=RGe();return function(){var n=tm(e),o;if(t){var i=tm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _Ge(this,o)}}function _Ge(e,t){if(t&&(wf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OGe(e)}function OGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tm(e)}function EGe(e){return kGe(e)||PGe(e)||RY(e)||TGe()}function TGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kGe(e){if(Array.isArray(e))return o0(e)}function OY(e,t){return IGe(e)||AGe(e,t)||RY(e,t)||$Ge()}function $Ge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RY(e,t){if(e){if(typeof e=="string")return o0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o0(e,t)}}function o0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function IGe(e){if(Array.isArray(e))return e}var EY="undoRedo",MGe="undoRedo";function ye(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=OY(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(EGe(h)),c},[]);A(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ye.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ye.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=fr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ye.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ye.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Ce(s.length-1,function(y){var m=[],w=s[y];Ce(u,u+(n-1),function(C){m.push(w[e.toPhysicalColumn(C)])}),f.push(m)}),Ce(n-1,function(y){h.push(e.toPhysicalColumn(u+y))}),Array.isArray(e.getSettings().colHeaders)&&Ce(n-1,function(y){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+y)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ye.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ye.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ye.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ye.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ye.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ye.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ye.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ye.prototype.isEnabled=function(){return this.enabled};ye.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,NGe(e),this.registerShortcuts(),e.addHook("afterChange",TY)}};ye.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,HGe(e),this.unregisterShortcuts(),e.removeHook("afterChange",TY)}};ye.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ye.Action=function(){};ye.Action.prototype.undo=function(){};ye.Action.prototype.redo=function(){};ye.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Ko(ye.ChangeAction,ye.Action);ye.ChangeAction.prototype.undo=function(e,t){for(var r=fr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=OY(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ye.ChangeAction.prototype.redo=function(e,t){for(var r=fr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ye.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Ko(ye.CreateRowAction,ye.Action);ye.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ye.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ye.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Ko(ye.RemoveRowAction,ye.Action);ye.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ye.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ye.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Ko(ye.CreateColumnAction,ye.Action);ye.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ye.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ye.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Ko(ye.RemoveColumnAction,ye.Action);ye.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(We(this.data[s],i));var u=We(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(e.getSourceDataArray(),function(c,h){A(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&A(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ye.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ye.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ye.CellAlignmentAction.prototype.undo=function(e,t){var r=this;A(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ye.CellAlignmentAction.prototype.redo=function(e,t){si(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Ko(ye.FiltersAction,ye.Action);ye.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ye.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var xGe=function(e){CY(r,e);var t=_Y(r);function r(n,o){var i;wY(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return SY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ye.Action);ye.MergeCellsAction=xGe;var DGe=function(e){CY(r,e);var t=_Y(r);function r(n,o){var i;return wY(this,r),i=t.call(this),i.cellRange=o,i}return SY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ye.Action);ye.UnmergeCellsAction=DGe;ye.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Ko(ye.RowMoveAction,ye.Action);ye.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ye.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ye.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ye.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:EY};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ye.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(EY)};function TY(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function NGe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function HGe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Bv=ge.getSingleton();Bv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Bv.register("beforeUndo");Bv.register("afterUndo");Bv.register("beforeRedo");Bv.register("afterRedo");ye.PLUGIN_KEY=MGe;ye.SETTING_KEYS=!0;function LGe(){tt(GSe),tt(pCe),tt(DCe),tt(P_e),tt(G_e),tt(Z2),tt(DRe),tt(g0e),tt(ZU),tt(DAe),tt(sIe),tt(bIe),tt(uz),tt(_Me),tt(bLe),tt(bje),tt(Uje),tt(yFe),tt(LFe),tt(EBe),tt(HBe),tt(RVe),tt(NVe),tt(xWe),tt(t2e),tt(v2e),tt(VUe),tt(cYe),tt(kYe),tt(qYe),tt(sGe),tt(wGe),tt(ye)}function PY(){xfe(),Qfe(),pce(),Lce(),LGe()}var jGe=$e,FGe=je,BGe=fm.f,VGe=FGe(function(){return!Object.getOwnPropertyNames(1)});jGe({target:"Object",stat:!0,forced:VGe},{getOwnPropertyNames:BGe});cn(IW);Te.editors={BaseEditor:Af};function Te(e,t){var r=new GP(e,t||{},VP);return r.init(),r}Te.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new GP(e,t,VP)};Te.DefaultSettings=FU();Te.hooks=ge.getSingleton();Te.CellCoords=sp;Te.CellRange=nT;Te.packageName="handsontable";Te.buildDate="22/06/2023 12:51:08";Te.version="13.0.0";Te.languages={dictionaryKeys:a0e,getLanguageDictionary:$U,getLanguagesDictionaries:aPe,registerLanguageDictionary:kU,getTranslatedPhrase:AU};function WGe(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var l,s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];a=(l=o[r]).call.apply(l,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var QS,JS,eC,tC,rC;PY();WGe(Te);Te.__GhostTable=tT;Te._getListenersCounter=Ule;Te._getRegisteredMapsCounter=Xwe;Te.EventManager=Pt;var UGe=[Ioe,iie,jTe,sce,zie,Cle,Noe,Rse,tie,Cae,sie,gTe],zGe=[Mae,uie];Te.helper={};Te.dom={};A(UGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.helper[t]=e[t])})});A(zGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.dom[t]=e[t])})});Te.cellTypes=(QS=Te.cellTypes)!==null&&QS!==void 0?QS:{};A(Hce(),function(e){Te.cellTypes[e]=QE(e)});Te.cellTypes.registerCellType=cn;Te.cellTypes.getCellType=QE;Te.editors=(JS=Te.editors)!==null&&JS!==void 0?JS:{};A(Nle(),function(e){Te.editors["".concat(ur(e),"Editor")]=rp(e)});Te.editors.registerEditor=Pr;Te.editors.getEditor=rp;Te.renderers=(eC=Te.renderers)!==null&&eC!==void 0?eC:{};A(Zfe(),function(e){var t=lp(e);e==="base"&&(Te.renderers.cellDecorator=t),Te.renderers["".concat(ur(e),"Renderer")]=t});Te.renderers.registerRenderer=Hn;Te.renderers.getRenderer=lp;Te.validators=(tC=Te.validators)!==null&&tC!==void 0?tC:{};A(gce(),function(e){Te.validators["".concat(ur(e),"Validator")]=ZE(e)});Te.validators.registerValidator=Xl;Te.validators.getValidator=ZE;Te.plugins=(rC=Te.plugins)!==null&&rC!==void 0?rC:{};A(eT(),function(e){Te.plugins[e]=Av(e)});Te.plugins["".concat(ur(ot.PLUGIN_KEY),"Plugin")]=ot;Te.plugins.registerPlugin=tt;Te.plugins.getPlugin=Av;const rj="selected",nj="odd",YGe=(e,t,r,n,o,i)=>{if(r!==0)return;const a=e.parentElement;if(a===null)return;i.instance.getSourceDataAtRow(t).checked?Te.dom.addClass(a,rj):Te.dom.removeClass(a,rj),t%2===0?Te.dom.addClass(a,nj):Te.dom.removeClass(a,nj)},GGe=function(t,r){const n=document.createElement("input"),o=this.getSourceDataAtRow(t);n.type="checkbox",n.checked=!!o.checked,Te.dom.empty(r),r.appendChild(n)};function KGe(e,t,r){if(t<0||!r.firstChild)return;const n=e.isRtl()?"htRight":"htLeft";Te.dom.addClass(r.firstChild,n)}const qGe=function(t,r){const n=t.target;r.col===-1&&t.target&&n.nodeName==="INPUT"&&(t.preventDefault(),this.setSourceDataAtCell(r.row,"checked",!n.checked))},XGe=(...e)=>{const[t,r,n,o,i,a,l]=e;If(...e),a?r.innerHTML='<div class="circle critical"></div>':r.innerHTML='<div class="circle"></div>'};var hs=Symbol("unassigned"),ZGe="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function rm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function kY(e){var t=Te.hooks.getRegistered(),r={};Object.assign(r,Te.DefaultSettings);for(var n in r)r[n]={default:hs};for(var o=0;o<t.length;o++)r[t[o]]={default:hs};return r.settings={default:hs},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function $Y(e){var t={},r=e.settings;if(r!==hs)for(var n in r)rm(r,n)&&r[n]!==hs&&(t[n]=r[n]);for(var o in e)rm(e,o)&&o!=="settings"&&e[o]!==hs&&(t[o]=e[o]);return t}function oj(e,t){var r=$Y(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)rm(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!ij(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)rm(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!ij(t[l],o[l]))&&(i[l]=o[l]);return i}function ij(e,t){return JSON.stringify(e)===JSON.stringify(t)}var QGe="13.0.0",ik=sj({name:"HotTable",props:kY("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=oj(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(ZGe),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=oj(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=DY(new Te.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:QGe}),JGe=["id"];function e3e(e,t,r,n,o,i){return Yl(),Oc("div",{id:e.id},[NY(e.$slots,"default")],8,JGe)}ik.render=e3e;ik.__file="src/HotTable.vue";function aj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function t3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aj(Object(r),!0).forEach(function(n){r3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r3e(e,t,r){return t=o3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n3e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o3e(e){var t=n3e(e,"string");return typeof t=="symbol"?t:String(t)}var At=sj({name:"HotColumn",props:kY("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=$Y(this.$props),r=t3e({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});At.__file="src/HotColumn.vue";const nC={__name:"Table",props:["tableOptions"],setup(e){const t=e;PY();const r=ia(()=>KGe),n=ia(()=>YGe),o=ia(()=>GGe),i=ia(()=>qGe),a=ia(()=>t.tableOptions.data),l=ia(()=>XGe);return HY(()=>{}),(s,u)=>(Yl(),LY(ht(ik),{data:a.value,style:{width:"100%"},height:400,colWidths:e.tableOptions.colWidths,colHeaders:e.tableOptions.colHeaders,dropdownMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:r.value,beforeRenderer:n.value,afterGetRowHeader:o.value,afterOnCellMouseDown:i.value,manualRowMove:!0,readOnly:!0,licenseKey:"non-commercial-and-evaluation"},{default:Dn(()=>[e.tableOptions.tableName=="one"?(Yl(),Oc(pb,{key:0},[rt(ht(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),rt(ht(At),{data:"Code"}),rt(ht(At),{data:"Name"}),rt(ht(At),{data:"Duration(Baseline)"}),rt(ht(At),{data:"Duration(New)"}),rt(ht(At),{data:"Ratio"})],64)):mb("",!0),e.tableOptions.tableName=="two"?(Yl(),Oc(pb,{key:1},[rt(ht(At),{data:"ID",style:{display:"flex","justify-content":"center"}}),rt(ht(At),{data:"Code"}),rt(ht(At),{data:"Type"}),rt(ht(At),{data:"Name"}),rt(ht(At),{data:"Distribution"}),rt(ht(At),{data:"Max"}),rt(ht(At),{data:"Span"})],64)):mb("",!0),e.tableOptions.tableName=="three"?(Yl(),Oc(pb,{key:2},[rt(ht(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),rt(ht(At),{data:"Task Code"}),rt(ht(At),{data:"Resource Name"}),rt(ht(At),{data:"Task Name"}),rt(ht(At),{data:"Duration(Old)"}),rt(ht(At),{data:"Duration(New)"}),rt(ht(At),{data:"Units(Old)"}),rt(ht(At),{data:"Units(New)"}),rt(ht(At),{data:"Total Planned Units"})],64)):mb("",!0)]),_:1},8,["data","colWidths","colHeaders","afterGetColHeader","beforeRenderer","afterGetRowHeader","afterOnCellMouseDown"]))}};const i3e={class:"optimize-content"},a3e={class:"content-row"},l3e={style:{"text-transform":"capitalize",color:"rgba(130, 181, 199, 0.9)"}},s3e={class:"chip primary"},u3e={class:"chip primary"},f3e={class:"content-box"},c3e={class:"sub-content"},h3e={class:"content-row"},d3e=zY('<div class="legend" data-v-017ada31><div style="display:flex;justify-content:flex-start;align-items:center;margin-right:10px;" data-v-017ada31><div class="circle critical" data-v-017ada31></div> Critical </div><div style="display:flex;justify-content:flex-start;align-items:center;" data-v-017ada31><div class="circle" data-v-017ada31></div> Non-Critical </div></div>',1),v3e={class:"table"},y3e={class:"sub-content"},g3e={class:"content-row"},p3e={class:"table"},m3e={class:"sub-content"},b3e={class:"content-row"},w3e={class:"table"},S3e={class:"content-box"},C3e={class:"content-row"},_3e={__name:"optimizedReport",setup(e){let t=dk();function r(S){let R="";for(const O in S){const j=S[O];R+=`- Task named "${j["Task Name"]}" with task code "${j["Task Code"]}" is associated with the resource named "<span style="color: red;">${j["Resource Name"]}</span>", with a total planned allocation of "${j["Total Planned Units"]}" units. Before optimization, the task had a duration of "${j["Duration(Old)"]}" hours with an allocation rate of "${j["Units(Old)"]}" unit per hour. After optimization, the task's duration was reduced to "${j["Duration(New)"]}" hours, and the allocation rate increased to "${j["Units(New)"]}" units per hour.This task is marked as critical. 

`}return R}function n(S){GY.preview(S,r(y.value))}FY(()=>{}),BY(()=>{n(t.value)});let o=dk(!1);const i=VY();function a(){h.SummaryData.group=="baseline"&&(console.log("è§¦å"),h.SummaryData.group="Balanced");let S=`${h.SummaryData.group}-${h.file.name.split(".")[0]}_FrontlineExport.${h.file.name.split(".")[1]}`;vk.getProjectReport(S,h.truefile)}function l(){h.SummaryData.group=="baseline"&&(h.SummaryData.group="Balanced");let S=`${h.SummaryData.group}-${h.file.name.split(".")[0]}_FrontlineExport.${h.file.name.split(".")[1]}`;vk.getExcelReport(S,h.truefile)}function s(){i.push({name:"optimizedSummary"}),h.active=2}WY((S,R)=>{S.name=="InputData"&&c()});function u(R){if(!R)return"0.00";var R=Math.round(parseFloat(R)*100)/100,O=R.toString().split(".");if(O.length==1)return R=R.toString()+".00",R;if(O.length>1)return O[1].length<2&&(R=R.toString()+"0"),R}function f(R){if(!R)return"0.0";var R=Math.round(parseFloat(R)*10)/10,O=R.toString().split(".");return O.length==1&&(R=R.toString()+".0"),R}function c(){h.taskData=[],Object.keys(h.dataArray).forEach(S=>{h.dataArray[S].all=[],h.dataArray[S].data=[]}),h.end.data=!1}const h=UY();let d=h.selectedData.tasks.filter(S=>S.durationRatio!==1).map(S=>(S.critical?S.critical=!0:S.critical=!1,{Critical:S.critical,Code:S.ID,Name:S.name,"Duration(Baseline)":f(S.remainingDuration),"Duration(New)":f(S.newDuration),Ratio:u(S.durationRatio)})),v=h.selectedData.newResources.filter(S=>S.ID!="-65535").map(S=>({ID:S.id,Code:S.ID,Type:S.type,Name:S.name,Distribution:f(S.distribution.min),Max:u(S.distribution.max),Span:u(S.distribution.span)})),y=ia(()=>h.selectedData.tasks.filter(O=>Object.keys(O.resources).length!==0).flatMap(O=>{let j=Object.values(O.resources),U=h.selectedData.tasks.find(q=>q.id==O.id);return j.map(q=>{var G;return{Critical:U.critical,"Task Code":U.ID,"Resource Name":(G=h.selectedData.newResources.find(X=>X.id==q.resourceId))==null?void 0:G.name,"Task Name":U.name,"Duration(Old)":f(U.plannedDuration),"Duration(New)":f(U.newDuration),"Units(Old)":u(q.plannedUnitsPerHour),"Units(New)":u(Number(q.newUnitsPerHour)),"Total Planned Units":u(q.remainingUnits)}})}));const m=bb({data:d,colWidths:[100,245,250,150,170,170],colHeaders:["Critical","Code","Name","Duration(Baseline)","Duration(New)","Ratio"],tableName:"one"}),w=bb({data:v,colWidths:[100,245,250,250,100,200,100,100],colHeaders:["ID","Code","Type","Name","Distribution","Max","Span"],tableName:"two"}),C=bb({data:y.value,colWidths:[100,245,250,150,110,110,110,110,150],colHeaders:["Critical","Task Code","Resource Name","Task Name","Duration(Old)","Duration(New)","Units(Old)","Units(New)","Total Planned Units"],tableName:"three"});return(S,R)=>{const O=YY,j=jf("v-card-text"),U=jf("v-btn"),q=jf("v-card-actions"),G=jf("v-card"),X=jf("v-dialog");return Yl(),Oc("div",i3e,[kt("div",a3e,[kt("h2",null,[Fi(an(S.$t("optimizedReport.title[0]"))+"Â  ",1),kt("span",l3e,an(ht(h).SummaryData.group),1),kt("div",s3e,[kt("small",null,an(ht(h).setting.Steps)+" "+an(S.$t("optimizedReport.title[1]")),1)]),kt("div",u3e,[kt("small",null,an(`${ht(h).setting.Ratio[0]*100}% - ${ht(h).setting.Ratio[1]*100}% ${S.$t("optimizedReport.title[2]")}`),1)])]),rt(O,{onClick:R[0]||(R[0]=()=>{wb(o)?o.value=!0:o=!0}),class:"row-btn"},{default:Dn(()=>[Fi(an(S.$t("optimizedReport.btn[1]")),1)]),_:1})]),kt("div",f3e,[kt("div",c3e,[kt("div",h3e,[kt("h3",null,an(S.$t("optimizedReport.tableName[0]")),1)]),d3e,kt("div",v3e,[rt(nC,{tableOptions:m},null,8,["tableOptions"])])]),kt("div",y3e,[kt("div",g3e,[kt("h3",null,an(S.$t("optimizedReport.tableName[1]")),1)]),kt("div",p3e,[rt(nC,{tableOptions:w},null,8,["tableOptions"])])]),kt("div",m3e,[kt("div",b3e,[kt("h3",null,an(S.$t("optimizedReport.tableName[2]")),1)]),kt("div",w3e,[rt(nC,{tableOptions:C},null,8,["tableOptions"])])])]),kt("div",S3e,[kt("div",{class:"md",ref_key:"mDom",ref:t},null,512)]),kt("div",C3e,[rt(O,{onClick:s,class:"back"},{default:Dn(()=>[Fi(an(S.$t("optimizedReport.btn[0]")),1)]),_:1}),rt(O,{onClick:R[1]||(R[1]=()=>{wb(o)?o.value=!0:o=!0}),class:"report"},{default:Dn(()=>[Fi(an(S.$t("optimizedReport.btn[1]")),1)]),_:1})]),rt(X,{modelValue:ht(o),"onUpdate:modelValue":R[4]||(R[4]=Q=>wb(o)?o.value=Q:o=Q),width:"auto"},{default:Dn(()=>[rt(G,{style:{"border-radius":"50px",width:"400px"}},{default:Dn(()=>[rt(j,{style:{"text-align":"center"}},{default:Dn(()=>[Fi(" Export Optimized File ")]),_:1}),rt(q,{style:{"justify-content":"center"}},{default:Dn(()=>[rt(U,{color:"rgb(64, 170, 151)",onClick:R[2]||(R[2]=()=>{a()})},{default:Dn(()=>[Fi("Original Format")]),_:1}),rt(U,{color:"rgb(64, 170, 151)",onClick:R[3]||(R[3]=()=>{l()})},{default:Dn(()=>[Fi("EXCEL")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},k3e=jY(_3e,[["__scopeId","data-v-017ada31"]]);export{k3e as default};
