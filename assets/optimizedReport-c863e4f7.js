import{aM as Jy,aN as HY,aO as aj,f as lj,aP as LY,p as ua,q as Jl,y as jY,h as ia,aK as FY,B as BY,C as Dn,M as eg,R as Je,t as ft,A as wb,ak as sj,al as uj,L as fa,an as VY,ao as WY,v as pt,aq as fj,ar as cj,aa as UY,aQ as zY,as as YY,ad as Sb,aJ as GY,aG as Uv,am as Bf,af as Fi,z as an,aB as KY,ag as qY,aR as XY,ai as ZY}from"./index-1ad3b00c.js";import{c as zv,L as QY,i as JY}from"./luckyexcel.umd-61d474fe.js";import"./index-f7adadce.js";import"./index.min-135486a5.js";var je=function(e){try{return!!e()}catch{return!0}},eG=je,Xd=!eG(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),hj=Xd,dj=Function.prototype,iC=dj.call,tG=hj&&dj.bind.bind(iC,iC),Ye=hj?tG:function(e){return function(){return iC.apply(e,arguments)}},vj=Ye,rG=vj({}.toString),nG=vj("".slice),Un=function(e){return nG(rG(e),8,-1)},oG=Ye,iG=je,aG=Un,Cb=Object,lG=oG("".split),Zd=iG(function(){return!Cb("z").propertyIsEnumerable(0)})?function(e){return aG(e)=="String"?lG(e,""):Cb(e)}:Cb,_n=function(e){return e==null},sG=_n,uG=TypeError,Ar=function(e){if(sG(e))throw uG("Can't call method on "+e);return e},fG=Zd,cG=Ar,zr=function(e){return fG(cG(e))},Yv=function(e){return e&&e.Math==Math&&e},vt=Yv(typeof globalThis=="object"&&globalThis)||Yv(typeof window=="object"&&window)||Yv(typeof self=="object"&&self)||Yv(typeof Jy=="object"&&Jy)||function(){return this}()||Jy||Function("return this")(),yj={exports:{}},hG=!1,vk=vt,dG=Object.defineProperty,a0=function(e,t){try{dG(vk,e,{value:t,configurable:!0,writable:!0})}catch{vk[e]=t}return t},vG=vt,yG=a0,yk="__core-js_shared__",gG=vG[yk]||yG(yk,{}),l0=gG,gk=l0;(yj.exports=function(e,t){return gk[e]||(gk[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.0",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.0/LICENSE",source:"https://github.com/zloirock/core-js"});var _f=yj.exports,pG=Ar,mG=Object,Ir=function(e){return mG(pG(e))},bG=Ye,wG=Ir,SG=bG({}.hasOwnProperty),Nt=Object.hasOwn||function(t,r){return SG(wG(t),r)},CG=Ye,_G=0,OG=Math.random(),RG=CG(1 .toString),am=function(e){return"Symbol("+(e===void 0?"":e)+")_"+RG(++_G+OG,36)},tl=typeof navigator<"u"&&String(navigator.userAgent)||"",gj=vt,_b=tl,pk=gj.process,mk=gj.Deno,bk=pk&&pk.versions||mk&&mk.version,wk=bk&&bk.v8,dn,Wg;wk&&(dn=wk.split("."),Wg=dn[0]>0&&dn[0]<4?1:+(dn[0]+dn[1]));!Wg&&_b&&(dn=_b.match(/Edge\/(\d+)/),(!dn||dn[1]>=74)&&(dn=_b.match(/Chrome\/(\d+)/),dn&&(Wg=+dn[1])));var Qd=Wg,Sk=Qd,EG=je,TG=vt,PG=TG.String,Of=!!Object.getOwnPropertySymbols&&!EG(function(){var e=Symbol();return!PG(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Sk&&Sk<41}),kG=Of,pj=kG&&!Symbol.sham&&typeof Symbol.iterator=="symbol",$G=vt,AG=_f,Ck=Nt,IG=am,MG=Of,xG=pj,Kl=$G.Symbol,Ob=AG("wks"),DG=xG?Kl.for||Kl:Kl&&Kl.withoutSetter||IG,St=function(e){return Ck(Ob,e)||(Ob[e]=MG&&Ck(Kl,e)?Kl[e]:DG("Symbol."+e)),Ob[e]},aC=typeof document=="object"&&document.all,NG=typeof aC>"u"&&aC!==void 0,mj={all:aC,IS_HTMLDDA:NG},bj=mj,HG=bj.all,Rt=bj.IS_HTMLDDA?function(e){return typeof e=="function"||e===HG}:function(e){return typeof e=="function"},_k=Rt,wj=mj,LG=wj.all,Yt=wj.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:_k(e)||e===LG}:function(e){return typeof e=="object"?e!==null:_k(e)},jG=Yt,FG=String,BG=TypeError,jt=function(e){if(jG(e))return e;throw BG(FG(e)+" is not an object")},s0={},VG=je,Gt=!VG(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),WG=Gt,UG=je,Sj=WG&&UG(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),_r={},zG=vt,Ok=Yt,lC=zG.document,YG=Ok(lC)&&Ok(lC.createElement),lm=function(e){return YG?lC.createElement(e):{}},GG=Gt,KG=je,qG=lm,Cj=!GG&&!KG(function(){return Object.defineProperty(qG("div"),"a",{get:function(){return 7}}).a!=7}),XG=Xd,Gv=Function.prototype.call,Zt=XG?Gv.bind(Gv):function(){return Gv.apply(Gv,arguments)},Rb=vt,ZG=Rt,QG=function(e){return ZG(e)?e:void 0},Uo=function(e,t){return arguments.length<2?QG(Rb[e]):Rb[e]&&Rb[e][t]},JG=Ye,Di=JG({}.isPrototypeOf),e3=Uo,t3=Rt,r3=Di,n3=pj,o3=Object,Jd=n3?function(e){return typeof e=="symbol"}:function(e){var t=e3("Symbol");return t3(t)&&r3(t.prototype,o3(e))},i3=String,Rf=function(e){try{return i3(e)}catch{return"Object"}},a3=Rt,l3=Rf,s3=TypeError,rl=function(e){if(a3(e))return e;throw s3(l3(e)+" is not a function")},u3=rl,f3=_n,nl=function(e,t){var r=e[t];return f3(r)?void 0:u3(r)},Eb=Zt,Tb=Rt,Pb=Yt,c3=TypeError,_j=function(e,t){var r,n;if(t==="string"&&Tb(r=e.toString)&&!Pb(n=Eb(r,e))||Tb(r=e.valueOf)&&!Pb(n=Eb(r,e))||t!=="string"&&Tb(r=e.toString)&&!Pb(n=Eb(r,e)))return n;throw c3("Can't convert object to primitive value")},h3=Zt,Rk=Yt,Ek=Jd,d3=nl,v3=_j,y3=St,g3=TypeError,p3=y3("toPrimitive"),Oj=function(e,t){if(!Rk(e)||Ek(e))return e;var r=d3(e,p3),n;if(r){if(t===void 0&&(t="default"),n=h3(r,e,t),!Rk(n)||Ek(n))return n;throw g3("Can't convert object to primitive value")}return t===void 0&&(t="number"),v3(e,t)},m3=Oj,b3=Jd,sm=function(e){var t=m3(e,"string");return b3(t)?t:t+""},w3=Gt,S3=Cj,C3=Sj,Kv=jt,Tk=sm,_3=TypeError,kb=Object.defineProperty,O3=Object.getOwnPropertyDescriptor,$b="enumerable",Ab="configurable",Ib="writable";_r.f=w3?C3?function(t,r,n){if(Kv(t),r=Tk(r),Kv(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Ib in n&&!n[Ib]){var o=O3(t,r);o&&o[Ib]&&(t[r]=n.value,n={configurable:Ab in n?n[Ab]:o[Ab],enumerable:$b in n?n[$b]:o[$b],writable:!1})}return kb(t,r,n)}:kb:function(t,r,n){if(Kv(t),r=Tk(r),Kv(n),S3)try{return kb(t,r,n)}catch{}if("get"in n||"set"in n)throw _3("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var R3=Math.ceil,E3=Math.floor,T3=Math.trunc||function(t){var r=+t;return(r>0?E3:R3)(r)},P3=T3,Ni=function(e){var t=+e;return t!==t||t===0?0:P3(t)},k3=Ni,$3=Math.max,A3=Math.min,ev=function(e,t){var r=k3(e);return r<0?$3(r+t,0):A3(r,t)},I3=Ni,M3=Math.min,ol=function(e){return e>0?M3(I3(e),9007199254740991):0},x3=ol,en=function(e){return x3(e.length)},D3=zr,N3=ev,H3=en,Pk=function(e){return function(t,r,n){var o=D3(t),i=H3(o),a=N3(n,i),l;if(e&&r!=r){for(;i>a;)if(l=o[a++],l!=l)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},u0={includes:Pk(!0),indexOf:Pk(!1)},tv={},L3=Ye,Mb=Nt,j3=zr,F3=u0.indexOf,B3=tv,kk=L3([].push),Rj=function(e,t){var r=j3(e),n=0,o=[],i;for(i in r)!Mb(B3,i)&&Mb(r,i)&&kk(o,i);for(;t.length>n;)Mb(r,i=t[n++])&&(~F3(o,i)||kk(o,i));return o},f0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],V3=Rj,W3=f0,rv=Object.keys||function(t){return V3(t,W3)},U3=Gt,z3=Sj,Y3=_r,G3=jt,K3=zr,q3=rv;s0.f=U3&&!z3?Object.defineProperties:function(t,r){G3(t);for(var n=K3(r),o=q3(r),i=o.length,a=0,l;i>a;)Y3.f(t,l=o[a++],n[l]);return t};var X3=Uo,Ej=X3("document","documentElement"),Z3=_f,Q3=am,$k=Z3("keys"),um=function(e){return $k[e]||($k[e]=Q3(e))},J3=jt,eK=s0,Ak=f0,tK=tv,rK=Ej,nK=lm,oK=um,Ik=">",Mk="<",sC="prototype",uC="script",Tj=oK("IE_PROTO"),xb=function(){},Pj=function(e){return Mk+uC+Ik+e+Mk+"/"+uC+Ik},xk=function(e){e.write(Pj("")),e.close();var t=e.parentWindow.Object;return e=null,t},iK=function(){var e=nK("iframe"),t="java"+uC+":",r;return e.style.display="none",rK.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(Pj("document.F=Object")),r.close(),r.F},qv,tg=function(){try{qv=new ActiveXObject("htmlfile")}catch{}tg=typeof document<"u"?document.domain&&qv?xk(qv):iK():xk(qv);for(var e=Ak.length;e--;)delete tg[sC][Ak[e]];return tg()};tK[Tj]=!0;var Ef=Object.create||function(t,r){var n;return t!==null?(xb[sC]=J3(t),n=new xb,xb[sC]=null,n[Tj]=t):n=tg(),r===void 0?n:eK.f(n,r)},aK=St,lK=Ef,sK=_r.f,fC=aK("unscopables"),cC=Array.prototype;cC[fC]==null&&sK(cC,fC,{configurable:!0,value:lK(null)});var nv=function(e){cC[fC][e]=!0},ov={},uK=vt,fK=Rt,Dk=uK.WeakMap,kj=fK(Dk)&&/native code/.test(String(Dk)),iv=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},cK=Gt,hK=_r,dK=iv,il=cK?function(e,t,r){return hK.f(e,t,dK(1,r))}:function(e,t,r){return e[t]=r,e},vK=kj,$j=vt,yK=Yt,gK=il,Db=Nt,Nb=l0,pK=um,mK=tv,Nk="Object already initialized",hC=$j.TypeError,bK=$j.WeakMap,Ug,Wc,zg,wK=function(e){return zg(e)?Wc(e):Ug(e,{})},SK=function(e){return function(t){var r;if(!yK(t)||(r=Wc(t)).type!==e)throw hC("Incompatible receiver, "+e+" required");return r}};if(vK||Nb.state){var Rn=Nb.state||(Nb.state=new bK);Rn.get=Rn.get,Rn.has=Rn.has,Rn.set=Rn.set,Ug=function(e,t){if(Rn.has(e))throw hC(Nk);return t.facade=e,Rn.set(e,t),t},Wc=function(e){return Rn.get(e)||{}},zg=function(e){return Rn.has(e)}}else{var vl=pK("state");mK[vl]=!0,Ug=function(e,t){if(Db(e,vl))throw hC(Nk);return t.facade=e,gK(e,vl,t),t},Wc=function(e){return Db(e,vl)?e[vl]:{}},zg=function(e){return Db(e,vl)}}var zo={set:Ug,get:Wc,has:zg,enforce:wK,getterFor:SK},zn={},av={},Aj={}.propertyIsEnumerable,Ij=Object.getOwnPropertyDescriptor,CK=Ij&&!Aj.call({1:2},1);av.f=CK?function(t){var r=Ij(this,t);return!!r&&r.enumerable}:Aj;var _K=Gt,OK=Zt,RK=av,EK=iv,TK=zr,PK=sm,kK=Nt,$K=Cj,Hk=Object.getOwnPropertyDescriptor;zn.f=_K?Hk:function(t,r){if(t=TK(t),r=PK(r),$K)try{return Hk(t,r)}catch{}if(kK(t,r))return EK(!OK(RK.f,t,r),t[r])};var Mj={exports:{}},dC=Gt,AK=Nt,xj=Function.prototype,IK=dC&&Object.getOwnPropertyDescriptor,c0=AK(xj,"name"),MK=c0&&function(){}.name==="something",xK=c0&&(!dC||dC&&IK(xj,"name").configurable),lv={EXISTS:c0,PROPER:MK,CONFIGURABLE:xK},DK=Ye,NK=Rt,vC=l0,HK=DK(Function.toString);NK(vC.inspectSource)||(vC.inspectSource=function(e){return HK(e)});var Dj=vC.inspectSource,h0=Ye,LK=je,jK=Rt,Xv=Nt,yC=Gt,FK=lv.CONFIGURABLE,BK=Dj,Nj=zo,VK=Nj.enforce,WK=Nj.get,Lk=String,rg=Object.defineProperty,UK=h0("".slice),zK=h0("".replace),YK=h0([].join),GK=yC&&!LK(function(){return rg(function(){},"length",{value:8}).length!==8}),KK=String(String).split("String"),qK=Mj.exports=function(e,t,r){UK(Lk(t),0,7)==="Symbol("&&(t="["+zK(Lk(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Xv(e,"name")||FK&&e.name!==t)&&(yC?rg(e,"name",{value:t,configurable:!0}):e.name=t),GK&&r&&Xv(r,"arity")&&e.length!==r.arity&&rg(e,"length",{value:r.arity});try{r&&Xv(r,"constructor")&&r.constructor?yC&&rg(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=VK(e);return Xv(n,"source")||(n.source=YK(KK,typeof t=="string"?t:"")),e};Function.prototype.toString=qK(function(){return jK(this)&&WK(this).source||BK(this)},"toString");var Hj=Mj.exports,XK=Rt,ZK=_r,QK=Hj,JK=a0,tn=function(e,t,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:t;if(XK(r)&&QK(r,i,n),n.global)o?e[t]=r:JK(t,r);else{try{n.unsafe?e[t]&&(o=!0):delete e[t]}catch{}o?e[t]=r:ZK.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},al={},e4=Rj,t4=f0,r4=t4.concat("length","prototype");al.f=Object.getOwnPropertyNames||function(t){return e4(t,r4)};var sv={};sv.f=Object.getOwnPropertySymbols;var n4=Uo,o4=Ye,i4=al,a4=sv,l4=jt,s4=o4([].concat),Lj=n4("Reflect","ownKeys")||function(t){var r=i4.f(l4(t)),n=a4.f;return n?s4(r,n(t)):r},jk=Nt,u4=Lj,f4=zn,c4=_r,jj=function(e,t,r){for(var n=u4(t),o=c4.f,i=f4.f,a=0;a<n.length;a++){var l=n[a];!jk(e,l)&&!(r&&jk(r,l))&&o(e,l,i(t,l))}},h4=je,d4=Rt,v4=/#|\.prototype\./,uv=function(e,t){var r=g4[y4(e)];return r==m4?!0:r==p4?!1:d4(t)?h4(t):!!t},y4=uv.normalize=function(e){return String(e).replace(v4,".").toLowerCase()},g4=uv.data={},p4=uv.NATIVE="N",m4=uv.POLYFILL="P",fm=uv,Hb=vt,b4=zn.f,w4=il,S4=tn,C4=a0,_4=jj,O4=fm,$e=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,l,s,u,f;if(n?a=Hb:o?a=Hb[r]||C4(r,{}):a=(Hb[r]||{}).prototype,a)for(l in t){if(u=t[l],e.dontCallGetSet?(f=b4(a,l),s=f&&f.value):s=a[l],i=O4(n?l:r+(o?".":"#")+l,e.forced),!i&&s!==void 0){if(typeof u==typeof s)continue;_4(u,s)}(e.sham||s&&s.sham)&&w4(u,"sham",!0),S4(a,l,u,e)}},R4=je,Fj=!R4(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),E4=Nt,T4=Rt,P4=Ir,k4=um,$4=Fj,Fk=k4("IE_PROTO"),gC=Object,A4=gC.prototype,fv=$4?gC.getPrototypeOf:function(e){var t=P4(e);if(E4(t,Fk))return t[Fk];var r=t.constructor;return T4(r)&&t instanceof r?r.prototype:t instanceof gC?A4:null},I4=je,M4=Rt,x4=Yt,Bk=fv,D4=tn,N4=St,pC=N4("iterator"),Bj=!1,Ba,Lb,jb;[].keys&&(jb=[].keys(),"next"in jb?(Lb=Bk(Bk(jb)),Lb!==Object.prototype&&(Ba=Lb)):Bj=!0);var H4=!x4(Ba)||I4(function(){var e={};return Ba[pC].call(e)!==e});H4&&(Ba={});M4(Ba[pC])||D4(Ba,pC,function(){return this});var Vj={IteratorPrototype:Ba,BUGGY_SAFARI_ITERATORS:Bj},L4=_r.f,j4=Nt,F4=St,Vk=F4("toStringTag"),cm=function(e,t,r){e&&!r&&(e=e.prototype),e&&!j4(e,Vk)&&L4(e,Vk,{configurable:!0,value:t})},B4=Vj.IteratorPrototype,V4=Ef,W4=iv,U4=cm,z4=ov,Y4=function(){return this},G4=function(e,t,r,n){var o=t+" Iterator";return e.prototype=V4(B4,{next:W4(+!n,r)}),U4(e,o,!1),z4[o]=Y4,e},K4=Ye,q4=rl,X4=function(e,t,r){try{return K4(q4(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},Z4=Rt,Q4=String,J4=TypeError,e6=function(e){if(typeof e=="object"||Z4(e))return e;throw J4("Can't set "+Q4(e)+" as a prototype")},t6=X4,r6=jt,n6=e6,d0=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=t6(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return r6(o),n6(i),e?r(o,i):o.__proto__=i,o}}():void 0),o6=$e,i6=Zt,Wj=lv,a6=Rt,l6=G4,Wk=fv,Uk=d0,s6=cm,u6=il,Fb=tn,f6=St,c6=ov,Uj=Vj,h6=Wj.PROPER,d6=Wj.CONFIGURABLE,zk=Uj.IteratorPrototype,Zv=Uj.BUGGY_SAFARI_ITERATORS,Vf=f6("iterator"),Yk="keys",Wf="values",Gk="entries",v6=function(){return this},v0=function(e,t,r,n,o,i,a){l6(r,t,n);var l=function(w){if(w===o&&h)return h;if(!Zv&&w in f)return f[w];switch(w){case Yk:return function(){return new r(this,w)};case Wf:return function(){return new r(this,w)};case Gk:return function(){return new r(this,w)}}return function(){return new r(this)}},s=t+" Iterator",u=!1,f=e.prototype,c=f[Vf]||f["@@iterator"]||o&&f[o],h=!Zv&&c||l(o),d=t=="Array"&&f.entries||c,v,y,m;if(d&&(v=Wk(d.call(new e)),v!==Object.prototype&&v.next&&(Wk(v)!==zk&&(Uk?Uk(v,zk):a6(v[Vf])||Fb(v,Vf,v6)),s6(v,s,!0))),h6&&o==Wf&&c&&c.name!==Wf&&(d6?u6(f,"name",Wf):(u=!0,h=function(){return i6(c,this)})),o)if(y={values:l(Wf),keys:i?h:l(Yk),entries:l(Gk)},a)for(m in y)(Zv||u||!(m in f))&&Fb(f,m,y[m]);else o6({target:t,proto:!0,forced:Zv||u},y);return f[Vf]!==h&&Fb(f,Vf,h,{name:o}),c6[t]=h,y},y0=function(e,t){return{value:e,done:t}},y6=zr,g0=nv,Kk=ov,zj=zo,g6=_r.f,p6=v0,Qv=y0,m6=Gt,Yj="Array Iterator",b6=zj.set,w6=zj.getterFor(Yj),S6=p6(Array,"Array",function(e,t){b6(this,{type:Yj,target:y6(e),index:0,kind:t})},function(){var e=w6(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Qv(void 0,!0)):r=="keys"?Qv(n,!1):r=="values"?Qv(t[n],!1):Qv([n,t[n]],!1)},"values"),qk=Kk.Arguments=Kk.Array;g0("keys");g0("values");g0("entries");if(m6&&qk.name!=="values")try{g6(qk,"name",{value:"values"})}catch{}var C6=St,_6=C6("toStringTag"),Gj={};Gj[_6]="z";var p0=String(Gj)==="[object z]",O6=p0,R6=Rt,ng=Un,E6=St,T6=E6("toStringTag"),P6=Object,k6=ng(function(){return arguments}())=="Arguments",$6=function(e,t){try{return e[t]}catch{}},hm=O6?ng:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=$6(t=P6(e),T6))=="string"?r:k6?ng(t):(n=ng(t))=="Object"&&R6(t.callee)?"Arguments":n},A6=p0,I6=hm,M6=A6?{}.toString:function(){return"[object "+I6(this)+"]"},x6=p0,D6=tn,N6=M6;x6||D6(Object.prototype,"toString",N6,{unsafe:!0});var H6=hm,L6=String,Kt=function(e){if(H6(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return L6(e)},m0=Ye,j6=Ni,F6=Kt,B6=Ar,V6=m0("".charAt),Xk=m0("".charCodeAt),W6=m0("".slice),Zk=function(e){return function(t,r){var n=F6(B6(t)),o=j6(r),i=n.length,a,l;return o<0||o>=i?e?"":void 0:(a=Xk(n,o),a<55296||a>56319||o+1===i||(l=Xk(n,o+1))<56320||l>57343?e?V6(n,o):a:e?W6(n,o,o+2):(a-55296<<10)+(l-56320)+65536)}},b0={codeAt:Zk(!1),charAt:Zk(!0)},U6=b0.charAt,z6=Kt,Kj=zo,Y6=v0,Qk=y0,qj="String Iterator",G6=Kj.set,K6=Kj.getterFor(qj);Y6(String,"String",function(e){G6(this,{type:qj,string:z6(e),index:0})},function(){var t=K6(this),r=t.string,n=t.index,o;return n>=r.length?Qk(void 0,!0):(o=U6(r,n),t.index+=o.length,Qk(o,!1))});var q6=je,w0=!q6(function(){return Object.isExtensible(Object.preventExtensions({}))}),X6=tn,S0=function(e,t,r){for(var n in t)X6(e,n,t[n],r);return e},Xj={exports:{}},dm={},Z6=sm,Q6=_r,J6=iv,Tf=function(e,t,r){var n=Z6(t);n in e?Q6.f(e,n,J6(0,r)):e[n]=r},Jk=ev,e8=en,t8=Tf,r8=Array,n8=Math.max,C0=function(e,t,r){for(var n=e8(e),o=Jk(t,n),i=Jk(r===void 0?n:r,n),a=r8(n8(i-o,0)),l=0;o<i;o++,l++)t8(a,l,e[o]);return a.length=l,a},o8=Un,i8=zr,Zj=al.f,a8=C0,Qj=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l8=function(e){try{return Zj(e)}catch{return a8(Qj)}};dm.f=function(t){return Qj&&o8(t)=="Window"?l8(t):Zj(i8(t))};var s8=je,u8=s8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),f8=je,c8=Yt,h8=Un,e$=u8,og=Object.isExtensible,d8=f8(function(){og(1)}),v8=d8||e$?function(t){return!c8(t)||e$&&h8(t)=="ArrayBuffer"?!1:og?og(t):!0}:og,y8=$e,g8=Ye,p8=tv,m8=Yt,_0=Nt,b8=_r.f,t$=al,w8=dm,O0=v8,S8=am,C8=w0,Jj=!1,jo=S8("meta"),_8=0,R0=function(e){b8(e,jo,{value:{objectID:"O"+_8++,weakData:{}}})},O8=function(e,t){if(!m8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!_0(e,jo)){if(!O0(e))return"F";if(!t)return"E";R0(e)}return e[jo].objectID},R8=function(e,t){if(!_0(e,jo)){if(!O0(e))return!0;if(!t)return!1;R0(e)}return e[jo].weakData},E8=function(e){return C8&&Jj&&O0(e)&&!_0(e,jo)&&R0(e),e},T8=function(){P8.enable=function(){},Jj=!0;var e=t$.f,t=g8([].splice),r={};r[jo]=1,e(r).length&&(t$.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===jo){t(o,i,1);break}return o},y8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:w8.f}))},P8=Xj.exports={enable:T8,fastKey:O8,getWeakData:R8,onFreeze:E8};p8[jo]=!0;var cv=Xj.exports,k8=Un,$8=Ye,hv=function(e){if(k8(e)==="Function")return $8(e)},r$=hv,A8=rl,I8=Xd,M8=r$(r$.bind),dv=function(e,t){return A8(e),t===void 0?e:I8?M8(e,t):function(){return e.apply(t,arguments)}},x8=St,D8=ov,N8=x8("iterator"),H8=Array.prototype,eF=function(e){return e!==void 0&&(D8.Array===e||H8[N8]===e)},L8=hm,n$=nl,j8=_n,F8=ov,B8=St,V8=B8("iterator"),E0=function(e){if(!j8(e))return n$(e,V8)||n$(e,"@@iterator")||F8[L8(e)]},W8=Zt,U8=rl,z8=jt,Y8=Rf,G8=E0,K8=TypeError,tF=function(e,t){var r=arguments.length<2?G8(e):t;if(U8(r))return z8(W8(r,e));throw K8(Y8(e)+" is not iterable")},q8=Zt,o$=jt,X8=nl,rF=function(e,t,r){var n,o;o$(e);try{if(n=X8(e,"return"),!n){if(t==="throw")throw r;return r}n=q8(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return o$(n),r},Z8=dv,Q8=Zt,J8=jt,e5=Rf,t5=eF,r5=en,i$=Di,n5=tF,o5=E0,a$=rF,i5=TypeError,ig=function(e,t){this.stopped=e,this.result=t},l$=ig.prototype,T0=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),s=Z8(t,n),u,f,c,h,d,v,y,m=function(S){return u&&a$(u,"normal",S),new ig(!0,S)},w=function(S){return o?(J8(S),l?s(S[0],S[1],m):s(S[0],S[1])):l?s(S,m):s(S)};if(i)u=e.iterator;else if(a)u=e;else{if(f=o5(e),!f)throw i5(e5(e)+" is not iterable");if(t5(f)){for(c=0,h=r5(e);h>c;c++)if(d=w(e[c]),d&&i$(l$,d))return d;return new ig(!1)}u=n5(e,f)}for(v=i?e.next:u.next;!(y=Q8(v,u)).done;){try{d=w(y.value)}catch(S){a$(u,"throw",S)}if(typeof d=="object"&&d&&i$(l$,d))return d}return new ig(!1)},a5=Di,l5=TypeError,P0=function(e,t){if(a5(t,e))return e;throw l5("Incorrect invocation")},s5=St,nF=s5("iterator"),oF=!1;try{var u5=0,s$={next:function(){return{done:!!u5++}},return:function(){oF=!0}};s$[nF]=function(){return this},Array.from(s$,function(){throw 2})}catch{}var iF=function(e,t){if(!t&&!oF)return!1;var r=!1;try{var n={};n[nF]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},f5=Rt,c5=Yt,u$=d0,k0=function(e,t,r){var n,o;return u$&&f5(n=t.constructor)&&n!==r&&c5(o=n.prototype)&&o!==r.prototype&&u$(e,o),e},h5=$e,d5=vt,v5=Ye,f$=fm,y5=tn,g5=cv,p5=T0,m5=P0,b5=Rt,w5=_n,Bb=Yt,Vb=je,S5=iF,C5=cm,_5=k0,vm=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=d5[e],l=a&&a.prototype,s=a,u={},f=function(w){var S=v5(l[w]);y5(l,w,w=="add"?function(k){return S(this,k===0?0:k),this}:w=="delete"?function(C){return o&&!Bb(C)?!1:S(this,C===0?0:C)}:w=="get"?function(k){return o&&!Bb(k)?void 0:S(this,k===0?0:k)}:w=="has"?function(k){return o&&!Bb(k)?!1:S(this,k===0?0:k)}:function(k,_){return S(this,k===0?0:k,_),this})},c=f$(e,!b5(a)||!(o||l.forEach&&!Vb(function(){new a().entries().next()})));if(c)s=r.getConstructor(t,e,n,i),g5.enable();else if(f$(e,!0)){var h=new s,d=h[i](o?{}:-0,1)!=h,v=Vb(function(){h.has(1)}),y=S5(function(w){new a(w)}),m=!o&&Vb(function(){for(var w=new a,S=5;S--;)w[i](S,S);return!w.has(-0)});y||(s=t(function(w,S){m5(w,l);var C=_5(new a,w,s);return w5(S)||p5(S,C[i],{that:C,AS_ENTRIES:n}),C}),s.prototype=l,l.constructor=s),(v||m)&&(f("delete"),f("has"),n&&f("get")),(m||d)&&f(i),o&&l.clear&&delete l.clear}return u[e]=s,h5({global:!0,constructor:!0,forced:s!=a},u),C5(s,e),o||r.setStrong(s,e,n),s},O5=Un,Pf=Array.isArray||function(t){return O5(t)=="Array"},R5=Ye,E5=je,aF=Rt,T5=hm,P5=Uo,k5=Dj,lF=function(){},$5=[],sF=P5("Reflect","construct"),$0=/^\s*(?:class|function)\b/,A5=R5($0.exec),I5=!$0.exec(lF),Uf=function(t){if(!aF(t))return!1;try{return sF(lF,$5,t),!0}catch{return!1}},uF=function(t){if(!aF(t))return!1;switch(T5(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return I5||!!A5($0,k5(t))}catch{return!0}};uF.sham=!0;var ym=!sF||E5(function(){var e;return Uf(Uf.call)||!Uf(Object)||!Uf(function(){e=!0})||e})?uF:Uf,c$=Pf,M5=ym,x5=Yt,D5=St,N5=D5("species"),h$=Array,H5=function(e){var t;return c$(e)&&(t=e.constructor,M5(t)&&(t===h$||c$(t.prototype))?t=void 0:x5(t)&&(t=t[N5],t===null&&(t=void 0))),t===void 0?h$:t},L5=H5,A0=function(e,t){return new(L5(e))(t===0?0:t)},j5=dv,F5=Ye,B5=Zd,V5=Ir,W5=en,U5=A0,d$=F5([].push),Xo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,l=e==5||i;return function(s,u,f,c){for(var h=V5(s),d=B5(h),v=j5(u,f),y=W5(d),m=0,w=c||U5,S=t?w(s,y):r||a?w(s,0):void 0,C,k;y>m;m++)if((l||m in d)&&(C=d[m],k=v(C,m,h),e))if(t)S[m]=k;else if(k)switch(e){case 3:return!0;case 5:return C;case 6:return m;case 2:d$(S,C)}else switch(e){case 4:return!1;case 7:d$(S,C)}return i?-1:n||o?o:S}},ll={forEach:Xo(0),map:Xo(1),filter:Xo(2),some:Xo(3),every:Xo(4),find:Xo(5),findIndex:Xo(6),filterReject:Xo(7)},z5=Ye,v$=S0,Jv=cv.getWeakData,Y5=P0,G5=jt,K5=_n,Wb=Yt,q5=T0,fF=ll,y$=Nt,cF=zo,X5=cF.set,Z5=cF.getterFor,Q5=fF.find,J5=fF.findIndex,e7=z5([].splice),t7=0,ey=function(e){return e.frozen||(e.frozen=new hF)},hF=function(){this.entries=[]},Ub=function(e,t){return Q5(e.entries,function(r){return r[0]===t})};hF.prototype={get:function(e){var t=Ub(this,e);if(t)return t[1]},has:function(e){return!!Ub(this,e)},set:function(e,t){var r=Ub(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=J5(this.entries,function(r){return r[0]===e});return~t&&e7(this.entries,t,1),!!~t}};var dF={getConstructor:function(e,t,r,n){var o=e(function(s,u){Y5(s,i),X5(s,{type:t,id:t7++,frozen:void 0}),K5(u)||q5(u,s[n],{that:s,AS_ENTRIES:r})}),i=o.prototype,a=Z5(t),l=function(s,u,f){var c=a(s),h=Jv(G5(u),!0);return h===!0?ey(c).set(u,f):h[c.id]=f,s};return v$(i,{delete:function(s){var u=a(this);if(!Wb(s))return!1;var f=Jv(s);return f===!0?ey(u).delete(s):f&&y$(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!Wb(u))return!1;var c=Jv(u);return c===!0?ey(f).has(u):c&&y$(c,f.id)}}),v$(i,r?{get:function(u){var f=a(this);if(Wb(u)){var c=Jv(u);return c===!0?ey(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return l(this,u,f)}}:{add:function(u){return l(this,u,!0)}}),o}},r7=w0,g$=vt,ag=Ye,p$=S0,n7=cv,o7=vm,vF=dF,ty=Yt,ry=zo.enforce,i7=je,a7=kj,vv=Object,l7=Array.isArray,ny=vv.isExtensible,yF=vv.isFrozen,s7=vv.isSealed,gF=vv.freeze,u7=vv.seal,m$={},b$={},f7=!g$.ActiveXObject&&"ActiveXObject"in g$,zf,pF=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},mF=o7("WeakMap",pF,vF),Ul=mF.prototype,lg=ag(Ul.set),c7=function(){return r7&&i7(function(){var e=gF([]);return lg(new mF,e,1),!yF(e)})};if(a7)if(f7){zf=vF.getConstructor(pF,"WeakMap",!0),n7.enable();var w$=ag(Ul.delete),oy=ag(Ul.has),S$=ag(Ul.get);p$(Ul,{delete:function(e){if(ty(e)&&!ny(e)){var t=ry(this);return t.frozen||(t.frozen=new zf),w$(this,e)||t.frozen.delete(e)}return w$(this,e)},has:function(t){if(ty(t)&&!ny(t)){var r=ry(this);return r.frozen||(r.frozen=new zf),oy(this,t)||r.frozen.has(t)}return oy(this,t)},get:function(t){if(ty(t)&&!ny(t)){var r=ry(this);return r.frozen||(r.frozen=new zf),oy(this,t)?S$(this,t):r.frozen.get(t)}return S$(this,t)},set:function(t,r){if(ty(t)&&!ny(t)){var n=ry(this);n.frozen||(n.frozen=new zf),oy(this,t)?lg(this,t,r):n.frozen.set(t,r)}else lg(this,t,r);return this}})}else c7()&&p$(Ul,{set:function(t,r){var n;return l7(t)&&(yF(t)?n=m$:s7(t)&&(n=b$)),lg(this,t,r),n==m$&&gF(t),n==b$&&u7(t),this}});var bF={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},h7=lm,zb=h7("span").classList,C$=zb&&zb.constructor&&zb.constructor.prototype,wF=C$===Object.prototype?void 0:C$,_$=vt,SF=bF,d7=wF,bc=S6,Yb=il,CF=St,Gb=CF("iterator"),O$=CF("toStringTag"),Kb=bc.values,_F=function(e,t){if(e){if(e[Gb]!==Kb)try{Yb(e,Gb,Kb)}catch{e[Gb]=Kb}if(e[O$]||Yb(e,O$,t),SF[t]){for(var r in bc)if(e[r]!==bc[r])try{Yb(e,r,bc[r])}catch{e[r]=bc[r]}}}};for(var qb in SF)_F(_$[qb]&&_$[qb].prototype,qb);_F(d7,"DOMTokenList");var v7=je,kf=function(e,t){var r=[][e];return!!r&&v7(function(){r.call(null,t||function(){return 1},1)})},y7=$e,g7=hv,p7=u0.indexOf,m7=kf,mC=g7([].indexOf),OF=!!mC&&1/mC([1],1,-0)<0,b7=OF||!m7("indexOf");y7({target:"Array",proto:!0,forced:b7},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return OF?mC(this,t,r)||0:p7(this,t,r)}});var R$=Rf,w7=TypeError,RF=function(e,t){if(!delete e[t])throw w7("Cannot delete property "+R$(t)+" of "+R$(e))},E$=C0,S7=Math.floor,bC=function(e,t){var r=e.length,n=S7(r/2);return r<8?C7(e,t):_7(e,bC(E$(e,0,n),t),bC(E$(e,n),t),t)},C7=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},_7=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,l=0;a<o||l<i;)e[a+l]=a<o&&l<i?n(t[a],r[l])<=0?t[a++]:r[l++]:a<o?t[a++]:r[l++];return e},O7=bC,R7=tl,T$=R7.match(/firefox\/(\d+)/i),E7=!!T$&&+T$[1],T7=tl,P7=/MSIE|Trident/.test(T7),k7=tl,P$=k7.match(/AppleWebKit\/(\d+)\./),$7=!!P$&&+P$[1],A7=$e,EF=Ye,I7=rl,M7=Ir,k$=en,x7=RF,$$=Kt,I0=je,D7=O7,N7=kf,A$=E7,H7=P7,I$=Qd,M$=$7,ci=[],x$=EF(ci.sort),L7=EF(ci.push),j7=I0(function(){ci.sort(void 0)}),F7=I0(function(){ci.sort(null)}),B7=N7("sort"),TF=!I0(function(){if(I$)return I$<70;if(!(A$&&A$>3)){if(H7)return!0;if(M$)return M$<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)ci.push({k:r+o,v:n})}for(ci.sort(function(i,a){return a.v-i.v}),o=0;o<ci.length;o++)r=ci[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),V7=j7||!F7||!B7||!TF,W7=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:$$(t)>$$(r)?1:-1}};A7({target:"Array",proto:!0,forced:V7},{sort:function(t){t!==void 0&&I7(t);var r=M7(this);if(TF)return t===void 0?x$(r):x$(r,t);var n=[],o=k$(r),i,a;for(a=0;a<o;a++)a in r&&L7(n,r[a]);for(D7(n,W7(t)),i=k$(n),a=0;a<i;)r[a]=n[a++];for(;a<o;)x7(r,a++);return r}});var U7=$e,z7=ll.find,Y7=nv,wC="find",PF=!0;wC in[]&&Array(1)[wC](function(){PF=!1});U7({target:"Array",proto:!0,forced:PF},{find:function(t){return z7(this,t,arguments.length>1?arguments[1]:void 0)}});Y7(wC);var G7=jt,kF=function(){var e=G7(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},M0=je,K7=vt,x0=K7.RegExp,D0=M0(function(){var e=x0("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),q7=D0||M0(function(){return!x0("a","y").sticky}),X7=D0||M0(function(){var e=x0("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),N0={BROKEN_CARET:X7,MISSED_STICKY:q7,UNSUPPORTED_Y:D0},Z7=je,Q7=vt,J7=Q7.RegExp,$F=Z7(function(){var e=J7(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),e9=je,t9=vt,r9=t9.RegExp,AF=e9(function(){var e=r9("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),ql=Zt,gm=Ye,n9=Kt,o9=kF,i9=N0,a9=_f,l9=Ef,s9=zo.get,u9=$F,f9=AF,c9=a9("native-string-replace",String.prototype.replace),Yg=RegExp.prototype.exec,SC=Yg,h9=gm("".charAt),d9=gm("".indexOf),v9=gm("".replace),Xb=gm("".slice),CC=function(){var e=/a/,t=/b*/g;return ql(Yg,e,"a"),ql(Yg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),IF=i9.BROKEN_CARET,_C=/()??/.exec("")[1]!==void 0,y9=CC||_C||IF||u9||f9;y9&&(SC=function(t){var r=this,n=s9(r),o=n9(t),i=n.raw,a,l,s,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=ql(SC,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=IF&&r.sticky,y=ql(o9,r),m=r.source,w=0,S=o;if(v&&(y=v9(y,"y",""),d9(y,"g")===-1&&(y+="g"),S=Xb(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&h9(o,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",S=" "+S,w++),l=new RegExp("^(?:"+m+")",y)),_C&&(l=new RegExp("^"+m+"$(?!\\s)",y)),CC&&(s=r.lastIndex),u=ql(Yg,v?l:r,S),v?u?(u.input=Xb(u.input,w),u[0]=Xb(u[0],w),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:CC&&u&&(r.lastIndex=r.global?u.index+u[0].length:s),_C&&u&&u.length>1&&ql(c9,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=l9(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var pm=SC,g9=$e,D$=pm;g9({target:"RegExp",proto:!0,forced:/./.exec!==D$},{exec:D$});var p9=Xd,MF=Function.prototype,N$=MF.apply,H$=MF.call,sl=typeof Reflect=="object"&&Reflect.apply||(p9?H$.bind(N$):function(){return H$.apply(N$,arguments)}),L$=hv,j$=tn,m9=pm,F$=je,xF=St,b9=il,w9=xF("species"),Zb=RegExp.prototype,mm=function(e,t,r,n){var o=xF(e),i=!F$(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!F$(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[w9]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var l=L$(/./[o]),s=t(o,""[e],function(u,f,c,h,d){var v=L$(u),y=f.exec;return y===m9||y===Zb.exec?i&&!d?{done:!0,value:l(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});j$(String.prototype,e,s[0]),j$(Zb,o,s[1])}n&&b9(Zb[o],"sham",!0)},S9=b0.charAt,H0=function(e,t,r){return t+(r?S9(e,t).length:1)},L0=Ye,C9=Ir,_9=Math.floor,Qb=L0("".charAt),O9=L0("".replace),Jb=L0("".slice),R9=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,E9=/\$([$&'`]|\d{1,2})/g,T9=function(e,t,r,n,o,i){var a=r+e.length,l=n.length,s=E9;return o!==void 0&&(o=C9(o),s=R9),O9(i,s,function(u,f){var c;switch(Qb(f,0)){case"$":return"$";case"&":return e;case"`":return Jb(t,0,r);case"'":return Jb(t,a);case"<":c=o[Jb(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>l){var d=_9(h/10);return d===0?u:d<=l?n[d-1]===void 0?Qb(f,1):n[d-1]+Qb(f,1):u}c=n[h-1]}return c===void 0?"":c})},B$=Zt,P9=jt,k9=Rt,$9=Un,A9=pm,I9=TypeError,bm=function(e,t){var r=e.exec;if(k9(r)){var n=B$(r,e,t);return n!==null&&P9(n),n}if($9(e)==="RegExp")return B$(A9,e,t);throw I9("RegExp#exec called on incompatible receiver")},M9=sl,V$=Zt,wm=Ye,x9=mm,D9=je,N9=jt,H9=Rt,L9=_n,j9=Ni,F9=ol,yl=Kt,B9=Ar,V9=H0,W9=nl,U9=T9,z9=bm,Y9=St,OC=Y9("replace"),G9=Math.max,K9=Math.min,q9=wm([].concat),ew=wm([].push),W$=wm("".indexOf),U$=wm("".slice),X9=function(e){return e===void 0?e:String(e)},Z9=function(){return"a".replace(/./,"$0")==="$0"}(),z$=function(){return/./[OC]?/./[OC]("a","$0")==="":!1}(),Q9=!D9(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});x9("replace",function(e,t,r){var n=z$?"$":"$0";return[function(i,a){var l=B9(this),s=L9(i)?void 0:W9(i,OC);return s?V$(s,i,l,a):V$(t,yl(l),i,a)},function(o,i){var a=N9(this),l=yl(o);if(typeof i=="string"&&W$(i,n)===-1&&W$(i,"$<")===-1){var s=r(t,a,l,i);if(s.done)return s.value}var u=H9(i);u||(i=yl(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=z9(a,l);if(d===null||(ew(h,d),!f))break;var v=yl(d[0]);v===""&&(a.lastIndex=V9(l,F9(a.lastIndex),c))}for(var y="",m=0,w=0;w<h.length;w++){d=h[w];for(var S=yl(d[0]),C=G9(K9(j9(d.index),l.length),0),k=[],_=1;_<d.length;_++)ew(k,X9(d[_]));var N=d.groups;if(u){var V=q9([S],k,C,l);N!==void 0&&ew(V,N);var X=yl(M9(i,void 0,V))}else X=U9(S,l,C,k,N,i);C>=m&&(y+=U$(l,m,C)+X,m=C+S.length)}return y+U$(l,m)}]},!Q9||!Z9||z$);var J9=je,eq=St,tq=Qd,rq=eq("species"),yv=function(e){return tq>=51||!J9(function(){var t=[],r=t.constructor={};return r[rq]=function(){return{foo:1}},t[e](Boolean).foo!==1})},nq=$e,oq=ll.filter,iq=yv,aq=iq("filter");nq({target:"Array",proto:!0,forced:!aq},{filter:function(t){return oq(this,t,arguments.length>1?arguments[1]:void 0)}});var lq=vt,DF=lq,j0={},sq=St;j0.f=sq;var Y$=DF,uq=Nt,fq=j0,cq=_r.f,F0=function(e){var t=Y$.Symbol||(Y$.Symbol={});uq(t,e)||cq(t,e,{value:fq.f(e)})},hq=Zt,dq=Uo,vq=St,yq=tn,NF=function(){var e=dq("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=vq("toPrimitive");t&&!t[n]&&yq(t,n,function(o){return hq(r,this)},{arity:1})},gq=F0,pq=NF;gq("toPrimitive");pq();var mq=jt,bq=_j,wq=TypeError,Sq=function(e){if(mq(this),e==="string"||e==="default")e="string";else if(e!=="number")throw wq("Incorrect hint");return bq(this,e)},Cq=Nt,_q=tn,Oq=Sq,Rq=St,G$=Rq("toPrimitive"),K$=Date.prototype;Cq(K$,G$)||_q(K$,G$,Oq);var q$=Hj,Eq=_r,gv=function(e,t,r){return r.get&&q$(r.get,t,{getter:!0}),r.set&&q$(r.set,t,{setter:!0}),Eq.f(e,t,r)},Sm=$e,B0=vt,V0=Zt,Tq=Ye,ys=Gt,gs=Of,Pq=je,nr=Nt,kq=Di,RC=jt,Cm=zr,W0=sm,$q=Kt,EC=iv,Uc=Ef,HF=rv,Aq=al,LF=dm,Iq=sv,jF=zn,FF=_r,Mq=s0,BF=av,tw=tn,xq=gv,U0=_f,Dq=um,VF=tv,X$=am,Nq=St,Hq=j0,Lq=F0,jq=NF,Fq=cm,WF=zo,_m=ll.forEach,$r=Dq("hidden"),Om="Symbol",zc="prototype",Bq=WF.set,Z$=WF.getterFor(Om),Qr=Object[zc],La=B0.Symbol,wc=La&&La[zc],Vq=B0.TypeError,rw=B0.QObject,UF=jF.f,aa=FF.f,zF=LF.f,Wq=BF.f,YF=Tq([].push),Fo=U0("symbols"),pv=U0("op-symbols"),Uq=U0("wks"),TC=!rw||!rw[zc]||!rw[zc].findChild,PC=ys&&Pq(function(){return Uc(aa({},"a",{get:function(){return aa(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=UF(Qr,t);n&&delete Qr[t],aa(e,t,r),n&&e!==Qr&&aa(Qr,t,n)}:aa,nw=function(e,t){var r=Fo[e]=Uc(wc);return Bq(r,{type:Om,tag:e,description:t}),ys||(r.description=t),r},Rm=function(t,r,n){t===Qr&&Rm(pv,r,n),RC(t);var o=W0(r);return RC(n),nr(Fo,o)?(n.enumerable?(nr(t,$r)&&t[$r][o]&&(t[$r][o]=!1),n=Uc(n,{enumerable:EC(0,!1)})):(nr(t,$r)||aa(t,$r,EC(1,{})),t[$r][o]=!0),PC(t,o,n)):aa(t,o,n)},z0=function(t,r){RC(t);var n=Cm(r),o=HF(n).concat(qF(n));return _m(o,function(i){(!ys||V0(kC,n,i))&&Rm(t,i,n[i])}),t},zq=function(t,r){return r===void 0?Uc(t):z0(Uc(t),r)},kC=function(t){var r=W0(t),n=V0(Wq,this,r);return this===Qr&&nr(Fo,r)&&!nr(pv,r)?!1:n||!nr(this,r)||!nr(Fo,r)||nr(this,$r)&&this[$r][r]?n:!0},GF=function(t,r){var n=Cm(t),o=W0(r);if(!(n===Qr&&nr(Fo,o)&&!nr(pv,o))){var i=UF(n,o);return i&&nr(Fo,o)&&!(nr(n,$r)&&n[$r][o])&&(i.enumerable=!0),i}},KF=function(t){var r=zF(Cm(t)),n=[];return _m(r,function(o){!nr(Fo,o)&&!nr(VF,o)&&YF(n,o)}),n},qF=function(e){var t=e===Qr,r=zF(t?pv:Cm(e)),n=[];return _m(r,function(o){nr(Fo,o)&&(!t||nr(Qr,o))&&YF(n,Fo[o])}),n};gs||(La=function(){if(kq(wc,this))throw Vq("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:$q(arguments[0]),r=X$(t),n=function(o){this===Qr&&V0(n,pv,o),nr(this,$r)&&nr(this[$r],r)&&(this[$r][r]=!1),PC(this,r,EC(1,o))};return ys&&TC&&PC(Qr,r,{configurable:!0,set:n}),nw(r,t)},wc=La[zc],tw(wc,"toString",function(){return Z$(this).tag}),tw(La,"withoutSetter",function(e){return nw(X$(e),e)}),BF.f=kC,FF.f=Rm,Mq.f=z0,jF.f=GF,Aq.f=LF.f=KF,Iq.f=qF,Hq.f=function(e){return nw(Nq(e),e)},ys&&(xq(wc,"description",{configurable:!0,get:function(){return Z$(this).description}}),tw(Qr,"propertyIsEnumerable",kC,{unsafe:!0})));Sm({global:!0,constructor:!0,wrap:!0,forced:!gs,sham:!gs},{Symbol:La});_m(HF(Uq),function(e){Lq(e)});Sm({target:Om,stat:!0,forced:!gs},{useSetter:function(){TC=!0},useSimple:function(){TC=!1}});Sm({target:"Object",stat:!0,forced:!gs,sham:!ys},{create:zq,defineProperty:Rm,defineProperties:z0,getOwnPropertyDescriptor:GF});Sm({target:"Object",stat:!0,forced:!gs},{getOwnPropertyNames:KF});jq();Fq(La,Om);VF[$r]=!0;var Yq=Of,XF=Yq&&!!Symbol.for&&!!Symbol.keyFor,Gq=$e,Kq=Uo,qq=Nt,Xq=Kt,ZF=_f,Zq=XF,ow=ZF("string-to-symbol-registry"),Qq=ZF("symbol-to-string-registry");Gq({target:"Symbol",stat:!0,forced:!Zq},{for:function(e){var t=Xq(e);if(qq(ow,t))return ow[t];var r=Kq("Symbol")(t);return ow[t]=r,Qq[r]=t,r}});var Jq=$e,eX=Nt,tX=Jd,rX=Rf,nX=_f,oX=XF,Q$=nX("symbol-to-string-registry");Jq({target:"Symbol",stat:!0,forced:!oX},{keyFor:function(t){if(!tX(t))throw TypeError(rX(t)+" is not a symbol");if(eX(Q$,t))return Q$[t]}});var iX=Ye,mv=iX([].slice),aX=Ye,J$=Pf,lX=Rt,e1=Un,sX=Kt,t1=aX([].push),uX=function(e){if(lX(e))return e;if(J$(e)){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];typeof o=="string"?t1(r,o):(typeof o=="number"||e1(o)=="Number"||e1(o)=="String")&&t1(r,sX(o))}var i=r.length,a=!0;return function(l,s){if(a)return a=!1,s;if(J$(this))return s;for(var u=0;u<i;u++)if(r[u]===l)return s}}},fX=$e,QF=Uo,JF=sl,cX=Zt,bv=Ye,eB=je,r1=Rt,n1=Jd,tB=mv,hX=uX,dX=Of,vX=String,vi=QF("JSON","stringify"),iy=bv(/./.exec),o1=bv("".charAt),yX=bv("".charCodeAt),gX=bv("".replace),pX=bv(1 .toString),mX=/[\uD800-\uDFFF]/g,i1=/^[\uD800-\uDBFF]$/,a1=/^[\uDC00-\uDFFF]$/,l1=!dX||eB(function(){var e=QF("Symbol")();return vi([e])!="[null]"||vi({a:e})!="{}"||vi(Object(e))!="{}"}),s1=eB(function(){return vi("\uDF06\uD834")!=='"\\udf06\\ud834"'||vi("\uDEAD")!=='"\\udead"'}),bX=function(e,t){var r=tB(arguments),n=hX(t);if(!(!r1(n)&&(e===void 0||n1(e))))return r[1]=function(o,i){if(r1(n)&&(i=cX(n,this,vX(o),i)),!n1(i))return i},JF(vi,null,r)},wX=function(e,t,r){var n=o1(r,t-1),o=o1(r,t+1);return iy(i1,e)&&!iy(a1,o)||iy(a1,e)&&!iy(i1,n)?"\\u"+pX(yX(e,0),16):e};vi&&fX({target:"JSON",stat:!0,arity:3,forced:l1||s1},{stringify:function(t,r,n){var o=tB(arguments),i=JF(l1?bX:vi,null,o);return s1&&typeof i=="string"?gX(i,mX,wX):i}});var SX=$e,CX=Of,_X=je,rB=sv,OX=Ir,RX=!CX||_X(function(){rB.f(1)});SX({target:"Object",stat:!0,forced:RX},{getOwnPropertySymbols:function(t){var r=rB.f;return r?r(OX(t)):[]}});var EX=$e,TX=Gt,PX=vt,ay=Ye,kX=Nt,$X=Rt,AX=Di,IX=Kt,MX=gv,xX=jj,io=PX.Symbol,Bi=io&&io.prototype;if(TX&&$X(io)&&(!("description"in Bi)||io().description!==void 0)){var u1={},ly=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:IX(arguments[0]),r=AX(Bi,this)?new io(t):t===void 0?io():io(t);return t===""&&(u1[r]=!0),r};xX(ly,io),ly.prototype=Bi,Bi.constructor=ly;var DX=String(io("test"))=="Symbol(test)",NX=ay(Bi.valueOf),HX=ay(Bi.toString),LX=/^Symbol\((.*)\)[^)]+$/,jX=ay("".replace),FX=ay("".slice);MX(Bi,"description",{configurable:!0,get:function(){var t=NX(this);if(kX(u1,t))return"";var r=HX(t),n=DX?FX(r,7,-1):jX(r,LX,"$1");return n===""?void 0:n}}),EX({global:!0,constructor:!0,forced:!0},{Symbol:ly})}var BX=Ye,nB=BX(1 .valueOf),oB=`	
\v\f\r                　\u2028\u2029\uFEFF`,VX=Ye,WX=Ar,UX=Kt,$C=oB,f1=VX("".replace),zX=RegExp("^["+$C+"]+"),YX=RegExp("(^|[^"+$C+"])["+$C+"]+$"),iw=function(e){return function(t){var r=UX(WX(t));return e&1&&(r=f1(r,zX,"")),e&2&&(r=f1(r,YX,"$1")),r}},iB={start:iw(1),end:iw(2),trim:iw(3)},GX=$e,aB=hG,KX=Gt,lB=vt,sB=DF,uB=Ye,qX=fm,c1=Nt,XX=k0,ZX=Di,QX=Jd,fB=Oj,JX=je,eZ=al.f,tZ=zn.f,rZ=_r.f,nZ=nB,oZ=iB.trim,Em="Number",es=lB[Em];sB[Em];var Y0=es.prototype,iZ=lB.TypeError,aZ=uB("".slice),sy=uB("".charCodeAt),lZ=function(e){var t=fB(e,"number");return typeof t=="bigint"?t:sZ(t)},sZ=function(e){var t=fB(e,"number"),r,n,o,i,a,l,s,u;if(QX(t))throw iZ("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=oZ(t),r=sy(t,0),r===43||r===45){if(n=sy(t,2),n===88||n===120)return NaN}else if(r===48){switch(sy(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=aZ(t,2),l=a.length,s=0;s<l;s++)if(u=sy(a,s),u<48||u>i)return NaN;return parseInt(a,o)}}return+t},G0=qX(Em,!es(" 0o1")||!es("0b1")||es("+0x1")),uZ=function(e){return ZX(Y0,e)&&JX(function(){nZ(e)})},Tm=function(t){var r=arguments.length<1?0:es(lZ(t));return uZ(this)?XX(Object(r),this,Tm):r};Tm.prototype=Y0;G0&&!aB&&(Y0.constructor=Tm);GX({global:!0,constructor:!0,wrap:!0,forced:G0},{Number:Tm});var fZ=function(e,t){for(var r=KX?eZ(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)c1(t,o=r[n])&&!c1(e,o)&&rZ(e,o,tZ(t,o))};(G0||aB)&&fZ(sB[Em],es);var cZ=$e,hZ=d0;cZ({target:"Object",stat:!0},{setPrototypeOf:hZ});var dZ=$e,vZ=je,yZ=Ir,cB=fv,gZ=Fj,pZ=vZ(function(){cB(1)});dZ({target:"Object",stat:!0,forced:pZ,sham:!gZ},{getPrototypeOf:function(t){return cB(yZ(t))}});var hB=Ye,mZ=rl,bZ=Yt,wZ=Nt,h1=mv,SZ=Xd,dB=Function,CZ=hB([].concat),_Z=hB([].join),aw={},OZ=function(e,t,r){if(!wZ(aw,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";aw[t]=dB("C,a","return new C("+_Z(n,",")+")")}return aw[t](e,r)},RZ=SZ?dB.bind:function(t){var r=mZ(this),n=r.prototype,o=h1(arguments,1),i=function(){var l=CZ(o,h1(arguments));return this instanceof i?OZ(r,l.length,l):r.apply(t,l)};return bZ(n)&&(i.prototype=n),i},EZ=ym,TZ=Rf,PZ=TypeError,vB=function(e){if(EZ(e))return e;throw PZ(TZ(e)+" is not a constructor")},kZ=$e,$Z=Uo,lw=sl,AZ=RZ,d1=vB,IZ=jt,v1=Yt,MZ=Ef,yB=je,K0=$Z("Reflect","construct"),xZ=Object.prototype,DZ=[].push,gB=yB(function(){function e(){}return!(K0(function(){},[],e)instanceof e)}),pB=!yB(function(){K0(function(){})}),y1=gB||pB;kZ({target:"Reflect",stat:!0,forced:y1,sham:y1},{construct:function(t,r){d1(t),IZ(r);var n=arguments.length<3?t:d1(arguments[2]);if(pB&&!gB)return K0(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return lw(DZ,o,r),new(lw(AZ,t,o))}var i=n.prototype,a=MZ(v1(i)?i:xZ),l=lw(t,a,r);return v1(l)?l:a}});var g1=Nt,NZ=function(e){return e!==void 0&&(g1(e,"value")||g1(e,"writable"))},HZ=$e,LZ=Zt,jZ=Yt,FZ=jt,BZ=NZ,VZ=zn,WZ=fv;function mB(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(FZ(e)===r)return e[t];if(n=VZ.f(e,t),n)return BZ(n)?n.value:n.get===void 0?void 0:LZ(n.get,r);if(jZ(o=WZ(e)))return mB(o,t,r)}HZ({target:"Reflect",stat:!0},{get:mB});var UZ=$e,zZ=je,YZ=zr,bB=zn.f,wB=Gt,GZ=!wB||zZ(function(){bB(1)});UZ({target:"Object",stat:!0,forced:GZ,sham:!wB},{getOwnPropertyDescriptor:function(t,r){return bB(YZ(t),r)}});var KZ=F0;KZ("iterator");var qZ=$e,p1=Pf,XZ=ym,ZZ=Yt,m1=ev,QZ=en,JZ=zr,eQ=Tf,tQ=St,rQ=yv,nQ=mv,oQ=rQ("slice"),iQ=tQ("species"),sw=Array,aQ=Math.max;qZ({target:"Array",proto:!0,forced:!oQ},{slice:function(t,r){var n=JZ(this),o=QZ(n),i=m1(t,o),a=m1(r===void 0?o:r,o),l,s,u;if(p1(n)&&(l=n.constructor,XZ(l)&&(l===sw||p1(l.prototype))?l=void 0:ZZ(l)&&(l=l[iQ],l===null&&(l=void 0)),l===sw||l===void 0))return nQ(n,i,a);for(s=new(l===void 0?sw:l)(aQ(a-i,0)),u=0;i<a;i++,u++)i in n&&eQ(s,u,n[i]);return s.length=u,s}});var lQ=Zt,sQ=Nt,uQ=Di,fQ=kF,b1=RegExp.prototype,SB=function(e){var t=e.flags;return t===void 0&&!("flags"in b1)&&!sQ(e,"flags")&&uQ(b1,e)?lQ(fQ,e):t},cQ=lv.PROPER,hQ=tn,dQ=jt,w1=Kt,vQ=je,yQ=SB,q0="toString",gQ=RegExp.prototype,CB=gQ[q0],pQ=vQ(function(){return CB.call({source:"a",flags:"b"})!="/a/b"}),mQ=cQ&&CB.name!=q0;(pQ||mQ)&&hQ(RegExp.prototype,q0,function(){var t=dQ(this),r=w1(t.source),n=w1(yQ(t));return"/"+r+"/"+n},{unsafe:!0});var bQ=Gt,wQ=lv.EXISTS,_B=Ye,SQ=gv,OB=Function.prototype,CQ=_B(OB.toString),RB=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,_Q=_B(RB.exec),OQ="name";bQ&&!wQ&&SQ(OB,OQ,{configurable:!0,get:function(){try{return _Q(RB,CQ(this))[1]}catch{return""}}});var RQ=jt,EQ=rF,TQ=function(e,t,r,n){try{return n?t(RQ(r)[0],r[1]):t(r)}catch(o){EQ(e,"throw",o)}},PQ=dv,kQ=Zt,$Q=Ir,AQ=TQ,IQ=eF,MQ=ym,xQ=en,S1=Tf,DQ=tF,NQ=E0,C1=Array,HQ=function(t){var r=$Q(t),n=MQ(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=PQ(i,o>2?arguments[2]:void 0));var l=NQ(r),s=0,u,f,c,h,d,v;if(l&&!(this===C1&&IQ(l)))for(h=DQ(r,l),d=h.next,f=n?new this:[];!(c=kQ(d,h)).done;s++)v=a?AQ(h,i,[c.value,s],!0):c.value,S1(f,s,v);else for(u=xQ(r),f=n?new this(u):C1(u);u>s;s++)v=a?i(r[s],s):r[s],S1(f,s,v);return f.length=s,f},LQ=$e,jQ=HQ,FQ=iF,BQ=!FQ(function(e){Array.from(e)});LQ({target:"Array",stat:!0,forced:BQ},{from:jQ});var VQ=$e,WQ=w0,UQ=je,zQ=Yt,YQ=cv.onFreeze,AC=Object.freeze,GQ=UQ(function(){AC(1)});VQ({target:"Object",stat:!0,forced:GQ,sham:!WQ},{freeze:function(t){return AC&&zQ(t)?AC(YQ(t)):t}});var KQ=lv.PROPER,qQ=je,_1=oB,O1="​᠎",XQ=function(e){return qQ(function(){return!!_1[e]()||O1[e]()!==O1||KQ&&_1[e].name!==e})},ZQ=$e,QQ=iB.trim,JQ=XQ;ZQ({target:"String",proto:!0,forced:JQ("trim")},{trim:function(){return QQ(this)}});var eJ=$e,tJ=u0.includes,rJ=je,nJ=nv,oJ=rJ(function(){return!Array(1).includes()});eJ({target:"Array",proto:!0,forced:oJ},{includes:function(t){return tJ(this,t,arguments.length>1?arguments[1]:void 0)}});nJ("includes");var iJ=$e,aJ=b0.codeAt;iJ({target:"String",proto:!0},{codePointAt:function(t){return aJ(this,t)}});var lJ=Ni,sJ=Kt,uJ=Ar,fJ=RangeError,X0=function(t){var r=sJ(uJ(this)),n="",o=lJ(t);if(o<0||o==1/0)throw fJ("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},EB=Ye,cJ=ol,R1=Kt,hJ=X0,dJ=Ar,vJ=EB(hJ),yJ=EB("".slice),gJ=Math.ceil,E1=function(e){return function(t,r,n){var o=R1(dJ(t)),i=cJ(r),a=o.length,l=n===void 0?" ":R1(n),s,u;return i<=a||l==""?o:(s=i-a,u=vJ(l,gJ(s/l.length)),u.length>s&&(u=yJ(u,0,s)),e?o+u:u+o)}},pJ={start:E1(!1),end:E1(!0)},mJ=tl,bJ=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(mJ),wJ=$e,SJ=pJ.start,CJ=bJ;wJ({target:"String",proto:!0,forced:CJ},{padStart:function(t){return SJ(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var TB;function ee(){return TB.apply(null,arguments)}function _J(e){TB=e}function mn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function ja(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Z0(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(it(e,t))return!1;return!0}function Tr(e){return e===void 0}function Bo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function wv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function PB(e,t){var r=[],n,o=e.length;for(n=0;n<o;++n)r.push(t(e[n],n));return r}function hi(e,t){for(var r in t)it(t,r)&&(e[r]=t[r]);return it(t,"toString")&&(e.toString=t.toString),it(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Yn(e,t,r,n){return QB(e,t,r,n,!0).utc()}function OJ(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ke(e){return e._pf==null&&(e._pf=OJ()),e._pf}var IC;Array.prototype.some?IC=Array.prototype.some:IC=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function Q0(e){if(e._isValid==null){var t=Ke(e),r=IC.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Pm(e){var t=Yn(NaN);return e!=null?hi(Ke(t),e):Ke(t).userInvalidated=!0,t}var T1=ee.momentProperties=[],uw=!1;function J0(e,t){var r,n,o,i=T1.length;if(Tr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Tr(t._i)||(e._i=t._i),Tr(t._f)||(e._f=t._f),Tr(t._l)||(e._l=t._l),Tr(t._strict)||(e._strict=t._strict),Tr(t._tzm)||(e._tzm=t._tzm),Tr(t._isUTC)||(e._isUTC=t._isUTC),Tr(t._offset)||(e._offset=t._offset),Tr(t._pf)||(e._pf=Ke(t)),Tr(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=T1[r],o=t[n],Tr(o)||(e[n]=o);return e}function Sv(e){J0(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),uw===!1&&(uw=!0,ee.updateOffset(this),uw=!1)}function bn(e){return e instanceof Sv||e!=null&&e._isAMomentObject!=null}function kB(e){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function rn(e,t){var r=!0;return hi(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,e),r){var n=[],o,i,a,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])it(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}kB(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var P1={};function $B(e,t){ee.deprecationHandler!=null&&ee.deprecationHandler(e,t),P1[e]||(kB(t),P1[e]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Gn(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function RJ(e){var t,r;for(r in e)it(e,r)&&(t=e[r],Gn(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function MC(e,t){var r=hi({},e),n;for(n in t)it(t,n)&&(ja(e[n])&&ja(t[n])?(r[n]={},hi(r[n],e[n]),hi(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)it(e,n)&&!it(t,n)&&ja(e[n])&&(r[n]=hi({},r[n]));return r}function eE(e){e!=null&&this.set(e)}var xC;Object.keys?xC=Object.keys:xC=function(e){var t,r=[];for(t in e)it(e,t)&&r.push(t);return r};var EJ={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function TJ(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Gn(n)?n.call(t,r):n}function Wn(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var tE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,uy=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,fw={},ts={};function Pe(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(ts[e]=o),t&&(ts[t[0]]=function(){return Wn(o.apply(this,arguments),t[1],t[2])}),r&&(ts[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function PJ(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function kJ(e){var t=e.match(tE),r,n;for(r=0,n=t.length;r<n;r++)ts[t[r]]?t[r]=ts[t[r]]:t[r]=PJ(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Gn(t[a])?t[a].call(o,e):t[a];return i}}function sg(e,t){return e.isValid()?(t=AB(t,e.localeData()),fw[t]=fw[t]||kJ(t),fw[t](e)):e.localeData().invalidDate()}function AB(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(uy.lastIndex=0;r>=0&&uy.test(e);)e=e.replace(uy,n),uy.lastIndex=0,r-=1;return e}var $J={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function AJ(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(tE).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var IJ="Invalid date";function MJ(){return this._invalidDate}var xJ="%d",DJ=/\d{1,2}/;function NJ(e){return this._ordinal.replace("%d",e)}var HJ={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function LJ(e,t,r,n){var o=this._relativeTime[r];return Gn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function jJ(e,t){var r=this._relativeTime[e>0?"future":"past"];return Gn(r)?r(t):r.replace(/%s/i,t)}var Ec={};function cr(e,t){var r=e.toLowerCase();Ec[r]=Ec[r+"s"]=Ec[t]=e}function nn(e){return typeof e=="string"?Ec[e]||Ec[e.toLowerCase()]:void 0}function rE(e){var t={},r,n;for(n in e)it(e,n)&&(r=nn(n),r&&(t[r]=e[n]));return t}var IB={};function hr(e,t){IB[e]=t}function FJ(e){var t=[],r;for(r in e)it(e,r)&&t.push({unit:r,priority:IB[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function km(e){return e%4===0&&e%100!==0||e%400===0}function Zr(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Qe(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Zr(t)),r}function $f(e,t){return function(r){return r!=null?(MB(this,e,r),ee.updateOffset(this,t),this):Gg(this,e)}}function Gg(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function MB(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&km(e.year())&&e.month()===1&&e.date()===29?(r=Qe(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Dm(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function BJ(e){return e=nn(e),Gn(this[e])?this[e]():this}function VJ(e,t){if(typeof e=="object"){e=rE(e);var r=FJ(e),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](e[r[n].unit])}else if(e=nn(e),Gn(this[e]))return this[e](t);return this}var xB=/\d/,Yr=/\d\d/,DB=/\d{3}/,nE=/\d{4}/,$m=/[+-]?\d{6}/,Et=/\d\d?/,NB=/\d\d\d\d?/,HB=/\d\d\d\d\d\d?/,Am=/\d{1,3}/,oE=/\d{1,4}/,Im=/[+-]?\d{1,6}/,Af=/\d+/,Mm=/[+-]?\d+/,WJ=/Z|[+-]\d\d:?\d\d/gi,xm=/Z|[+-]\d\d(?::?\d\d)?/gi,UJ=/[+-]?\d+(\.\d{1,3})?/,Cv=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Kg;Kg={};function be(e,t,r){Kg[e]=Gn(t)?t:function(n,o){return n&&r?r:t}}function zJ(e,t){return it(Kg,e)?Kg[e](t._strict,t._locale):new RegExp(YJ(e))}function YJ(e){return Br(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Br(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var DC={};function yt(e,t){var r,n=t,o;for(typeof e=="string"&&(e=[e]),Bo(t)&&(n=function(i,a){a[t]=Qe(i)}),o=e.length,r=0;r<o;r++)DC[e[r]]=n}function _v(e,t){yt(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function GJ(e,t,r){t!=null&&it(DC,e)&&DC[e](t,r._a,r,e)}var sr=0,fo=1,Fn=2,Qt=3,gn=4,co=5,ca=6,KJ=7,qJ=8;function XJ(e,t){return(e%t+t)%t}var Wt;Array.prototype.indexOf?Wt=Array.prototype.indexOf:Wt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Dm(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=XJ(t,12);return e+=(t-r)/12,r===1?km(e)?29:28:31-r%7%2}Pe("M",["MM",2],"Mo",function(){return this.month()+1});Pe("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Pe("MMMM",0,0,function(e){return this.localeData().months(this,e)});cr("month","M");hr("month",8);be("M",Et);be("MM",Et,Yr);be("MMM",function(e,t){return t.monthsShortRegex(e)});be("MMMM",function(e,t){return t.monthsRegex(e)});yt(["M","MM"],function(e,t){t[fo]=Qe(e)-1});yt(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[fo]=o:Ke(r).invalidMonth=e});var ZJ="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),LB="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),jB=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,QJ=Cv,JJ=Cv;function eee(e,t){return e?mn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||jB).test(t)?"format":"standalone"][e.month()]:mn(this._months)?this._months:this._months.standalone}function tee(e,t){return e?mn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[jB.test(t)?"format":"standalone"][e.month()]:mn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ree(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Yn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:(o=Wt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Wt.call(this._longMonthsParse,a),o!==-1?o:(o=Wt.call(this._shortMonthsParse,a),o!==-1?o:null))}function nee(e,t,r){var n,o,i;if(this._monthsParseExact)return ree.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Yn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function FB(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Qe(t);else if(t=e.localeData().monthsParse(t),!Bo(t))return e}return r=Math.min(e.date(),Dm(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function BB(e){return e!=null?(FB(this,e),ee.updateOffset(this,!0),this):Gg(this,"Month")}function oee(){return Dm(this.year(),this.month())}function iee(e){return this._monthsParseExact?(it(this,"_monthsRegex")||VB.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=QJ),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function aee(e){return this._monthsParseExact?(it(this,"_monthsRegex")||VB.call(this),e?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=JJ),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function VB(){function e(a,l){return l.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Yn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Br(t[o]),r[o]=Br(r[o]);for(o=0;o<24;o++)n[o]=Br(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}Pe("Y",0,0,function(){var e=this.year();return e<=9999?Wn(e,4):"+"+e});Pe(0,["YY",2],0,function(){return this.year()%100});Pe(0,["YYYY",4],0,"year");Pe(0,["YYYYY",5],0,"year");Pe(0,["YYYYYY",6,!0],0,"year");cr("year","y");hr("year",1);be("Y",Mm);be("YY",Et,Yr);be("YYYY",oE,nE);be("YYYYY",Im,$m);be("YYYYYY",Im,$m);yt(["YYYYY","YYYYYY"],sr);yt("YYYY",function(e,t){t[sr]=e.length===2?ee.parseTwoDigitYear(e):Qe(e)});yt("YY",function(e,t){t[sr]=ee.parseTwoDigitYear(e)});yt("Y",function(e,t){t[sr]=parseInt(e,10)});function Tc(e){return km(e)?366:365}ee.parseTwoDigitYear=function(e){return Qe(e)+(Qe(e)>68?1900:2e3)};var WB=$f("FullYear",!0);function lee(){return km(this.year())}function see(e,t,r,n,o,i,a){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,o,i,a),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,o,i,a),l}function Yc(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function qg(e,t,r){var n=7+t-r,o=(7+Yc(e,0,n).getUTCDay()-t)%7;return-o+n-1}function UB(e,t,r,n,o){var i=(7+r-n)%7,a=qg(e,n,o),l=1+7*(t-1)+i+a,s,u;return l<=0?(s=e-1,u=Tc(s)+l):l>Tc(e)?(s=e+1,u=l-Tc(e)):(s=e,u=l),{year:s,dayOfYear:u}}function Gc(e,t,r){var n=qg(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+Lo(a,t,r)):o>Lo(e.year(),t,r)?(i=o-Lo(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Lo(e,t,r){var n=qg(e,t,r),o=qg(e+1,t,r);return(Tc(e)-n+o)/7}Pe("w",["ww",2],"wo","week");Pe("W",["WW",2],"Wo","isoWeek");cr("week","w");cr("isoWeek","W");hr("week",5);hr("isoWeek",5);be("w",Et);be("ww",Et,Yr);be("W",Et);be("WW",Et,Yr);_v(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Qe(e)});function uee(e){return Gc(e,this._week.dow,this._week.doy).week}var fee={dow:0,doy:6};function cee(){return this._week.dow}function hee(){return this._week.doy}function dee(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function vee(e){var t=Gc(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Pe("d",0,"do","day");Pe("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Pe("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Pe("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Pe("e",0,0,"weekday");Pe("E",0,0,"isoWeekday");cr("day","d");cr("weekday","e");cr("isoWeekday","E");hr("day",11);hr("weekday",11);hr("isoWeekday",11);be("d",Et);be("e",Et);be("E",Et);be("dd",function(e,t){return t.weekdaysMinRegex(e)});be("ddd",function(e,t){return t.weekdaysShortRegex(e)});be("dddd",function(e,t){return t.weekdaysRegex(e)});_v(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:Ke(r).invalidWeekday=e});_v(["d","e","E"],function(e,t,r,n){t[n]=Qe(e)});function yee(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function gee(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function iE(e,t){return e.slice(t,7).concat(e.slice(0,t))}var pee="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),zB="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),mee="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),bee=Cv,wee=Cv,See=Cv;function Cee(e,t){var r=mn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?iE(r,this._week.dow):e?r[e.day()]:r}function _ee(e){return e===!0?iE(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Oee(e){return e===!0?iE(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Ree(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Yn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Wt.call(this._weekdaysParse,a),o!==-1||(o=Wt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Wt.call(this._shortWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Wt.call(this._minWeekdaysParse,a),o!==-1||(o=Wt.call(this._weekdaysParse,a),o!==-1)?o:(o=Wt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function Eee(e,t,r){var n,o,i;if(this._weekdaysParseExact)return Ree.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Yn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Tee(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=yee(e,this.localeData()),this.add(e-t,"d")):t}function Pee(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function kee(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=gee(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function $ee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||aE.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=bee),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Aee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||aE.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=wee),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Iee(e){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||aE.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=See),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function aE(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,l,s,u;for(i=0;i<7;i++)a=Yn([2e3,1]).day(i),l=Br(this.weekdaysMin(a,"")),s=Br(this.weekdaysShort(a,"")),u=Br(this.weekdays(a,"")),t.push(l),r.push(s),n.push(u),o.push(l),o.push(s),o.push(u);t.sort(e),r.sort(e),n.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function lE(){return this.hours()%12||12}function Mee(){return this.hours()||24}Pe("H",["HH",2],0,"hour");Pe("h",["hh",2],0,lE);Pe("k",["kk",2],0,Mee);Pe("hmm",0,0,function(){return""+lE.apply(this)+Wn(this.minutes(),2)});Pe("hmmss",0,0,function(){return""+lE.apply(this)+Wn(this.minutes(),2)+Wn(this.seconds(),2)});Pe("Hmm",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)});Pe("Hmmss",0,0,function(){return""+this.hours()+Wn(this.minutes(),2)+Wn(this.seconds(),2)});function YB(e,t){Pe(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}YB("a",!0);YB("A",!1);cr("hour","h");hr("hour",13);function GB(e,t){return t._meridiemParse}be("a",GB);be("A",GB);be("H",Et);be("h",Et);be("k",Et);be("HH",Et,Yr);be("hh",Et,Yr);be("kk",Et,Yr);be("hmm",NB);be("hmmss",HB);be("Hmm",NB);be("Hmmss",HB);yt(["H","HH"],Qt);yt(["k","kk"],function(e,t,r){var n=Qe(e);t[Qt]=n===24?0:n});yt(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});yt(["h","hh"],function(e,t,r){t[Qt]=Qe(e),Ke(r).bigHour=!0});yt("hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n)),Ke(r).bigHour=!0});yt("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n,2)),t[co]=Qe(e.substr(o)),Ke(r).bigHour=!0});yt("Hmm",function(e,t,r){var n=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n))});yt("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[Qt]=Qe(e.substr(0,n)),t[gn]=Qe(e.substr(n,2)),t[co]=Qe(e.substr(o))});function xee(e){return(e+"").toLowerCase().charAt(0)==="p"}var Dee=/[ap]\.?m?\.?/i,Nee=$f("Hours",!0);function Hee(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var KB={calendar:EJ,longDateFormat:$J,invalidDate:IJ,ordinal:xJ,dayOfMonthOrdinalParse:DJ,relativeTime:HJ,months:ZJ,monthsShort:LB,week:fee,weekdays:pee,weekdaysMin:mee,weekdaysShort:zB,meridiemParse:Dee},Tt={},Yf={},Kc;function Lee(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function k1(e){return e&&e.toLowerCase().replace("_","-")}function jee(e){for(var t=0,r,n,o,i;t<e.length;){for(i=k1(e[t]).split("-"),r=i.length,n=k1(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=Nm(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&Lee(i,n)>=r-1)break;r--}t++}return Kc}function Fee(e){return e.match("^[^/\\\\]*$")!=null}function Nm(e){var t=null,r;if(Tt[e]===void 0&&typeof module<"u"&&module&&module.exports&&Fee(e))try{t=Kc._abbr,r=require,r("./locale/"+e),yi(t)}catch{Tt[e]=null}return Tt[e]}function yi(e,t){var r;return e&&(Tr(t)?r=Yo(e):r=sE(e,t),r?Kc=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Kc._abbr}function sE(e,t){if(t!==null){var r,n=KB;if(t.abbr=e,Tt[e]!=null)$B("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Tt[e]._config;else if(t.parentLocale!=null)if(Tt[t.parentLocale]!=null)n=Tt[t.parentLocale]._config;else if(r=Nm(t.parentLocale),r!=null)n=r._config;else return Yf[t.parentLocale]||(Yf[t.parentLocale]=[]),Yf[t.parentLocale].push({name:e,config:t}),null;return Tt[e]=new eE(MC(n,t)),Yf[e]&&Yf[e].forEach(function(o){sE(o.name,o.config)}),yi(e),Tt[e]}else return delete Tt[e],null}function Bee(e,t){if(t!=null){var r,n,o=KB;Tt[e]!=null&&Tt[e].parentLocale!=null?Tt[e].set(MC(Tt[e]._config,t)):(n=Nm(e),n!=null&&(o=n._config),t=MC(o,t),n==null&&(t.abbr=e),r=new eE(t),r.parentLocale=Tt[e],Tt[e]=r),yi(e)}else Tt[e]!=null&&(Tt[e].parentLocale!=null?(Tt[e]=Tt[e].parentLocale,e===yi()&&yi(e)):Tt[e]!=null&&delete Tt[e]);return Tt[e]}function Yo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Kc;if(!mn(e)){if(t=Nm(e),t)return t;e=[e]}return jee(e)}function Vee(){return xC(Tt)}function uE(e){var t,r=e._a;return r&&Ke(e).overflow===-2&&(t=r[fo]<0||r[fo]>11?fo:r[Fn]<1||r[Fn]>Dm(r[sr],r[fo])?Fn:r[Qt]<0||r[Qt]>24||r[Qt]===24&&(r[gn]!==0||r[co]!==0||r[ca]!==0)?Qt:r[gn]<0||r[gn]>59?gn:r[co]<0||r[co]>59?co:r[ca]<0||r[ca]>999?ca:-1,Ke(e)._overflowDayOfYear&&(t<sr||t>Fn)&&(t=Fn),Ke(e)._overflowWeeks&&t===-1&&(t=KJ),Ke(e)._overflowWeekday&&t===-1&&(t=qJ),Ke(e).overflow=t),e}var Wee=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Uee=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,zee=/Z|[+-]\d\d(?::?\d\d)?/,fy=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],cw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Yee=/^\/?Date\((-?\d+)/i,Gee=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Kee={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function qB(e){var t,r,n=e._i,o=Wee.exec(n)||Uee.exec(n),i,a,l,s,u=fy.length,f=cw.length;if(o){for(Ke(e).iso=!0,t=0,r=u;t<r;t++)if(fy[t][1].exec(o[1])){a=fy[t][0],i=fy[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=f;t<r;t++)if(cw[t][1].exec(o[3])){l=(o[2]||" ")+cw[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(o[4])if(zee.exec(o[4]))s="Z";else{e._isValid=!1;return}e._f=a+(l||"")+(s||""),cE(e)}else e._isValid=!1}function qee(e,t,r,n,o,i){var a=[Xee(e),LB.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Xee(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Zee(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Qee(e,t,r){if(e){var n=zB.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return Ke(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Jee(e,t,r){if(e)return Kee[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function XB(e){var t=Gee.exec(Zee(e._i)),r;if(t){if(r=qee(t[4],t[3],t[2],t[5],t[6],t[7]),!Qee(t[1],r,e))return;e._a=r,e._tzm=Jee(t[8],t[9],t[10]),e._d=Yc.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Ke(e).rfc2822=!0}else e._isValid=!1}function ete(e){var t=Yee.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(qB(e),e._isValid===!1)delete e._isValid;else return;if(XB(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ee.createFromInputFallback(e)}ee.createFromInputFallback=rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function zl(e,t,r){return e??t??r}function tte(e){var t=new Date(ee.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function fE(e){var t,r,n=[],o,i,a;if(!e._d){for(o=tte(e),e._w&&e._a[Fn]==null&&e._a[fo]==null&&rte(e),e._dayOfYear!=null&&(a=zl(e._a[sr],o[sr]),(e._dayOfYear>Tc(a)||e._dayOfYear===0)&&(Ke(e)._overflowDayOfYear=!0),r=Yc(a,0,e._dayOfYear),e._a[fo]=r.getUTCMonth(),e._a[Fn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Qt]===24&&e._a[gn]===0&&e._a[co]===0&&e._a[ca]===0&&(e._nextDay=!0,e._a[Qt]=0),e._d=(e._useUTC?Yc:see).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Qt]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Ke(e).weekdayMismatch=!0)}}function rte(e){var t,r,n,o,i,a,l,s,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,a=4,r=zl(t.GG,e._a[sr],Gc(Ot(),1,4).year),n=zl(t.W,1),o=zl(t.E,1),(o<1||o>7)&&(s=!0)):(i=e._locale._week.dow,a=e._locale._week.doy,u=Gc(Ot(),i,a),r=zl(t.gg,e._a[sr],u.year),n=zl(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(s=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(s=!0)):o=i),n<1||n>Lo(r,i,a)?Ke(e)._overflowWeeks=!0:s!=null?Ke(e)._overflowWeekday=!0:(l=UB(r,n,o,i,a),e._a[sr]=l.year,e._dayOfYear=l.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function cE(e){if(e._f===ee.ISO_8601){qB(e);return}if(e._f===ee.RFC_2822){XB(e);return}e._a=[],Ke(e).empty=!0;var t=""+e._i,r,n,o,i,a,l=t.length,s=0,u,f;for(o=AB(e._f,e._locale).match(tE)||[],f=o.length,r=0;r<f;r++)i=o[r],n=(t.match(zJ(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&Ke(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),s+=n.length),ts[i]?(n?Ke(e).empty=!1:Ke(e).unusedTokens.push(i),GJ(i,n,e)):e._strict&&!n&&Ke(e).unusedTokens.push(i);Ke(e).charsLeftOver=l-s,t.length>0&&Ke(e).unusedInput.push(t),e._a[Qt]<=12&&Ke(e).bigHour===!0&&e._a[Qt]>0&&(Ke(e).bigHour=void 0),Ke(e).parsedDateParts=e._a.slice(0),Ke(e).meridiem=e._meridiem,e._a[Qt]=nte(e._locale,e._a[Qt],e._meridiem),u=Ke(e).era,u!==null&&(e._a[sr]=e._locale.erasConvertYear(u,e._a[sr])),fE(e),uE(e)}function nte(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function ote(e){var t,r,n,o,i,a,l=!1,s=e._f.length;if(s===0){Ke(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<s;o++)i=0,a=!1,t=J0({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],cE(t),Q0(t)&&(a=!0),i+=Ke(t).charsLeftOver,i+=Ke(t).unusedTokens.length*10,Ke(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||a)&&(n=i,r=t,a&&(l=!0));hi(e,r||t)}function ite(e){if(!e._d){var t=rE(e._i),r=t.day===void 0?t.date:t.day;e._a=PB([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),fE(e)}}function ate(e){var t=new Sv(uE(ZB(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function ZB(e){var t=e._i,r=e._f;return e._locale=e._locale||Yo(e._l),t===null||r===void 0&&t===""?Pm({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),bn(t)?new Sv(uE(t)):(wv(t)?e._d=t:mn(r)?ote(e):r?cE(e):lte(e),Q0(e)||(e._d=null),e))}function lte(e){var t=e._i;Tr(t)?e._d=new Date(ee.now()):wv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?ete(e):mn(t)?(e._a=PB(t.slice(0),function(r){return parseInt(r,10)}),fE(e)):ja(t)?ite(e):Bo(t)?e._d=new Date(t):ee.createFromInputFallback(e)}function QB(e,t,r,n,o){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(ja(e)&&Z0(e)||mn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,ate(i)}function Ot(e,t,r,n){return QB(e,t,r,n,!1)}var ste=rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Pm()}),ute=rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ot.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Pm()});function JB(e,t){var r,n;if(t.length===1&&mn(t[0])&&(t=t[0]),!t.length)return Ot();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function fte(){var e=[].slice.call(arguments,0);return JB("isBefore",e)}function cte(){var e=[].slice.call(arguments,0);return JB("isAfter",e)}var hte=function(){return Date.now?Date.now():+new Date},Gf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function dte(e){var t,r=!1,n,o=Gf.length;for(t in e)if(it(e,t)&&!(Wt.call(Gf,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<o;++n)if(e[Gf[n]]){if(r)return!1;parseFloat(e[Gf[n]])!==Qe(e[Gf[n]])&&(r=!0)}return!0}function vte(){return this._isValid}function yte(){return On(NaN)}function Hm(e){var t=rE(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,l=t.hour||0,s=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=dte(t),this._milliseconds=+f+u*1e3+s*6e4+l*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Yo(),this._bubble()}function ug(e){return e instanceof Hm}function NC(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function gte(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&Qe(e[a])!==Qe(t[a]))&&i++;return i+o}function eV(e,t){Pe(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Wn(~~(r/60),2)+t+Wn(~~r%60,2)})}eV("Z",":");eV("ZZ","");be("Z",xm);be("ZZ",xm);yt(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=hE(xm,e)});var pte=/([\+\-]|\d\d)/gi;function hE(e,t){var r=(t||"").match(e),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(pte)||["-",0,0],i=+(o[1]*60)+Qe(o[2]),i===0?0:o[0]==="+"?i:-i)}function dE(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(bn(e)||wv(e)?e.valueOf():Ot(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ee.updateOffset(r,!1),r):Ot(e).local()}function HC(e){return-Math.round(e._d.getTimezoneOffset())}ee.updateOffset=function(){};function mte(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=hE(xm,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=HC(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?nV(this,On(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:HC(this)}function bte(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function wte(e){return this.utcOffset(0,e)}function Ste(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(HC(this),"m")),this}function Cte(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=hE(WJ,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function _te(e){return this.isValid()?(e=e?Ot(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Ote(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Rte(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var e={},t;return J0(e,this),e=ZB(e),e._a?(t=e._isUTC?Yn(e._a):Ot(e._a),this._isDSTShifted=this.isValid()&&gte(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ete(){return this.isValid()?!this._isUTC:!1}function Tte(){return this.isValid()?this._isUTC:!1}function tV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Pte=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,kte=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function On(e,t){var r=e,n=null,o,i,a;return ug(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Bo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=Pte.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:Qe(n[Fn])*o,h:Qe(n[Qt])*o,m:Qe(n[gn])*o,s:Qe(n[co])*o,ms:Qe(NC(n[ca]*1e3))*o}):(n=kte.exec(e))?(o=n[1]==="-"?-1:1,r={y:Vi(n[2],o),M:Vi(n[3],o),w:Vi(n[4],o),d:Vi(n[5],o),h:Vi(n[6],o),m:Vi(n[7],o),s:Vi(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=$te(Ot(r.from),Ot(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Hm(r),ug(e)&&it(e,"_locale")&&(i._locale=e._locale),ug(e)&&it(e,"_isValid")&&(i._isValid=e._isValid),i}On.fn=Hm.prototype;On.invalid=yte;function Vi(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function $1(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function $te(e,t){var r;return e.isValid()&&t.isValid()?(t=dE(t,e),e.isBefore(t)?r=$1(e,t):(r=$1(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function rV(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&($B(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=On(r,n),nV(this,o,e),this}}function nV(e,t,r,n){var o=t._milliseconds,i=NC(t._days),a=NC(t._months);e.isValid()&&(n=n??!0,a&&FB(e,Gg(e,"Month")+a*r),i&&MB(e,"Date",Gg(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&ee.updateOffset(e,i||a))}var Ate=rV(1,"add"),Ite=rV(-1,"subtract");function oV(e){return typeof e=="string"||e instanceof String}function Mte(e){return bn(e)||wv(e)||oV(e)||Bo(e)||Dte(e)||xte(e)||e===null||e===void 0}function xte(e){var t=ja(e)&&!Z0(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||it(e,i);return t&&r}function Dte(e){var t=mn(e),r=!1;return t&&(r=e.filter(function(n){return!Bo(n)&&oV(e)}).length===0),t&&r}function Nte(e){var t=ja(e)&&!Z0(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||it(e,i);return t&&r}function Hte(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Lte(e,t){arguments.length===1&&(arguments[0]?Mte(arguments[0])?(e=arguments[0],t=void 0):Nte(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ot(),n=dE(r,this).startOf("day"),o=ee.calendarFormat(this,n)||"sameElse",i=t&&(Gn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,Ot(r)))}function jte(){return new Sv(this)}function Fte(e,t){var r=bn(e)?e:Ot(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function Bte(e,t){var r=bn(e)?e:Ot(e);return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function Vte(e,t,r,n){var o=bn(e)?e:Ot(e),i=bn(t)?t:Ot(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function Wte(e,t){var r=bn(e)?e:Ot(e),n;return this.isValid()&&r.isValid()?(t=nn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function Ute(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function zte(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Yte(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=dE(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=nn(t),t){case"year":i=fg(this,n)/12;break;case"month":i=fg(this,n);break;case"quarter":i=fg(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Zr(i)}function fg(e,t){if(e.date()<t.date())return-fg(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Gte(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Kte(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?sg(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Gn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",sg(r,"Z")):sg(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function qte(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,o,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+o+i)}function Xte(e){e||(e=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var t=sg(this,e);return this.localeData().postformat(t)}function Zte(e,t){return this.isValid()&&(bn(e)&&e.isValid()||Ot(e).isValid())?On({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Qte(e){return this.from(Ot(),e)}function Jte(e,t){return this.isValid()&&(bn(e)&&e.isValid()||Ot(e).isValid())?On({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ere(e){return this.to(Ot(),e)}function iV(e){var t;return e===void 0?this._locale._abbr:(t=Yo(e),t!=null&&(this._locale=t),this)}var aV=rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function lV(){return this._locale}var Xg=1e3,rs=60*Xg,Zg=60*rs,sV=(365*400+97)*24*Zg;function ns(e,t){return(e%t+t)%t}function uV(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-sV:new Date(e,t,r).valueOf()}function fV(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-sV:Date.UTC(e,t,r)}function tre(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?fV:uV,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ns(t+(this._isUTC?0:this.utcOffset()*rs),Zg);break;case"minute":t=this._d.valueOf(),t-=ns(t,rs);break;case"second":t=this._d.valueOf(),t-=ns(t,Xg);break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function rre(e){var t,r;if(e=nn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?fV:uV,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Zg-ns(t+(this._isUTC?0:this.utcOffset()*rs),Zg)-1;break;case"minute":t=this._d.valueOf(),t+=rs-ns(t,rs)-1;break;case"second":t=this._d.valueOf(),t+=Xg-ns(t,Xg)-1;break}return this._d.setTime(t),ee.updateOffset(this,!0),this}function nre(){return this._d.valueOf()-(this._offset||0)*6e4}function ore(){return Math.floor(this.valueOf()/1e3)}function ire(){return new Date(this.valueOf())}function are(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function lre(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function sre(){return this.isValid()?this.toISOString():null}function ure(){return Q0(this)}function fre(){return hi({},Ke(this))}function cre(){return Ke(this).overflow}function hre(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pe("N",0,0,"eraAbbr");Pe("NN",0,0,"eraAbbr");Pe("NNN",0,0,"eraAbbr");Pe("NNNN",0,0,"eraName");Pe("NNNNN",0,0,"eraNarrow");Pe("y",["y",1],"yo","eraYear");Pe("y",["yy",2],0,"eraYear");Pe("y",["yyy",3],0,"eraYear");Pe("y",["yyyy",4],0,"eraYear");be("N",vE);be("NN",vE);be("NNN",vE);be("NNNN",_re);be("NNNNN",Ore);yt(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var o=r._locale.erasParse(e,n,r._strict);o?Ke(r).era=o:Ke(r).invalidEra=e});be("y",Af);be("yy",Af);be("yyy",Af);be("yyyy",Af);be("yo",Rre);yt(["y","yy","yyy","yyyy"],sr);yt(["yo"],function(e,t,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[sr]=r._locale.eraYearOrdinalParse(e,o):t[sr]=parseInt(e,10)});function dre(e,t){var r,n,o,i=this._eras||Yo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=ee(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=ee(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function vre(e,t,r){var n,o,i=this.eras(),a,l,s;for(e=e.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),s=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(a===e)return i[n];break;case"NNNNN":if(s===e)return i[n];break}else if([a,l,s].indexOf(e)>=0)return i[n]}function yre(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ee(e.since).year():ee(e.since).year()+(t-e.offset)*r}function gre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function pre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function mre(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function bre(){var e,t,r,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until||o[e].until<=n&&n<=o[e].since)return(this.year()-ee(o[e].since).year())*r+o[e].offset;return this.year()}function wre(e){return it(this,"_erasNameRegex")||yE.call(this),e?this._erasNameRegex:this._erasRegex}function Sre(e){return it(this,"_erasAbbrRegex")||yE.call(this),e?this._erasAbbrRegex:this._erasRegex}function Cre(e){return it(this,"_erasNarrowRegex")||yE.call(this),e?this._erasNarrowRegex:this._erasRegex}function vE(e,t){return t.erasAbbrRegex(e)}function _re(e,t){return t.erasNameRegex(e)}function Ore(e,t){return t.erasNarrowRegex(e)}function Rre(e,t){return t._eraYearOrdinalRegex||Af}function yE(){var e=[],t=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)t.push(Br(a[o].name)),e.push(Br(a[o].abbr)),r.push(Br(a[o].narrow)),n.push(Br(a[o].name)),n.push(Br(a[o].abbr)),n.push(Br(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pe(0,["gg",2],0,function(){return this.weekYear()%100});Pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Lm(e,t){Pe(0,[e,e.length],0,t)}Lm("gggg","weekYear");Lm("ggggg","weekYear");Lm("GGGG","isoWeekYear");Lm("GGGGG","isoWeekYear");cr("weekYear","gg");cr("isoWeekYear","GG");hr("weekYear",1);hr("isoWeekYear",1);be("G",Mm);be("g",Mm);be("GG",Et,Yr);be("gg",Et,Yr);be("GGGG",oE,nE);be("gggg",oE,nE);be("GGGGG",Im,$m);be("ggggg",Im,$m);_v(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Qe(e)});_v(["gg","GG"],function(e,t,r,n){t[n]=ee.parseTwoDigitYear(e)});function Ere(e){return cV.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Tre(e){return cV.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Pre(){return Lo(this.year(),1,4)}function kre(){return Lo(this.isoWeekYear(),1,4)}function $re(){var e=this.localeData()._week;return Lo(this.year(),e.dow,e.doy)}function Are(){var e=this.localeData()._week;return Lo(this.weekYear(),e.dow,e.doy)}function cV(e,t,r,n,o){var i;return e==null?Gc(this,n,o).year:(i=Lo(e,n,o),t>i&&(t=i),Ire.call(this,e,t,r,n,o))}function Ire(e,t,r,n,o){var i=UB(e,t,r,n,o),a=Yc(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Pe("Q",0,"Qo","quarter");cr("quarter","Q");hr("quarter",7);be("Q",xB);yt("Q",function(e,t){t[fo]=(Qe(e)-1)*3});function Mre(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Pe("D",["DD",2],"Do","date");cr("date","D");hr("date",9);be("D",Et);be("DD",Et,Yr);be("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Fn);yt("Do",function(e,t){t[Fn]=Qe(e.match(Et)[0])});var hV=$f("Date",!0);Pe("DDD",["DDDD",3],"DDDo","dayOfYear");cr("dayOfYear","DDD");hr("dayOfYear",4);be("DDD",Am);be("DDDD",DB);yt(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Qe(e)});function xre(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Pe("m",["mm",2],0,"minute");cr("minute","m");hr("minute",14);be("m",Et);be("mm",Et,Yr);yt(["m","mm"],gn);var Dre=$f("Minutes",!1);Pe("s",["ss",2],0,"second");cr("second","s");hr("second",15);be("s",Et);be("ss",Et,Yr);yt(["s","ss"],co);var Nre=$f("Seconds",!1);Pe("S",0,0,function(){return~~(this.millisecond()/100)});Pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pe(0,["SSS",3],0,"millisecond");Pe(0,["SSSS",4],0,function(){return this.millisecond()*10});Pe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});cr("millisecond","ms");hr("millisecond",16);be("S",Am,xB);be("SS",Am,Yr);be("SSS",Am,DB);var di,dV;for(di="SSSS";di.length<=9;di+="S")be(di,Af);function Hre(e,t){t[ca]=Qe(("0."+e)*1e3)}for(di="S";di.length<=9;di+="S")yt(di,Hre);dV=$f("Milliseconds",!1);Pe("z",0,0,"zoneAbbr");Pe("zz",0,0,"zoneName");function Lre(){return this._isUTC?"UTC":""}function jre(){return this._isUTC?"Coordinated Universal Time":""}var oe=Sv.prototype;oe.add=Ate;oe.calendar=Lte;oe.clone=jte;oe.diff=Yte;oe.endOf=rre;oe.format=Xte;oe.from=Zte;oe.fromNow=Qte;oe.to=Jte;oe.toNow=ere;oe.get=BJ;oe.invalidAt=cre;oe.isAfter=Fte;oe.isBefore=Bte;oe.isBetween=Vte;oe.isSame=Wte;oe.isSameOrAfter=Ute;oe.isSameOrBefore=zte;oe.isValid=ure;oe.lang=aV;oe.locale=iV;oe.localeData=lV;oe.max=ute;oe.min=ste;oe.parsingFlags=fre;oe.set=VJ;oe.startOf=tre;oe.subtract=Ite;oe.toArray=are;oe.toObject=lre;oe.toDate=ire;oe.toISOString=Kte;oe.inspect=qte;typeof Symbol<"u"&&Symbol.for!=null&&(oe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});oe.toJSON=sre;oe.toString=Gte;oe.unix=ore;oe.valueOf=nre;oe.creationData=hre;oe.eraName=gre;oe.eraNarrow=pre;oe.eraAbbr=mre;oe.eraYear=bre;oe.year=WB;oe.isLeapYear=lee;oe.weekYear=Ere;oe.isoWeekYear=Tre;oe.quarter=oe.quarters=Mre;oe.month=BB;oe.daysInMonth=oee;oe.week=oe.weeks=dee;oe.isoWeek=oe.isoWeeks=vee;oe.weeksInYear=$re;oe.weeksInWeekYear=Are;oe.isoWeeksInYear=Pre;oe.isoWeeksInISOWeekYear=kre;oe.date=hV;oe.day=oe.days=Tee;oe.weekday=Pee;oe.isoWeekday=kee;oe.dayOfYear=xre;oe.hour=oe.hours=Nee;oe.minute=oe.minutes=Dre;oe.second=oe.seconds=Nre;oe.millisecond=oe.milliseconds=dV;oe.utcOffset=mte;oe.utc=wte;oe.local=Ste;oe.parseZone=Cte;oe.hasAlignedHourOffset=_te;oe.isDST=Ote;oe.isLocal=Ete;oe.isUtcOffset=Tte;oe.isUtc=tV;oe.isUTC=tV;oe.zoneAbbr=Lre;oe.zoneName=jre;oe.dates=rn("dates accessor is deprecated. Use date instead.",hV);oe.months=rn("months accessor is deprecated. Use month instead",BB);oe.years=rn("years accessor is deprecated. Use year instead",WB);oe.zone=rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",bte);oe.isDSTShifted=rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Rte);function Fre(e){return Ot(e*1e3)}function Bre(){return Ot.apply(null,arguments).parseZone()}function vV(e){return e}var at=eE.prototype;at.calendar=TJ;at.longDateFormat=AJ;at.invalidDate=MJ;at.ordinal=NJ;at.preparse=vV;at.postformat=vV;at.relativeTime=LJ;at.pastFuture=jJ;at.set=RJ;at.eras=dre;at.erasParse=vre;at.erasConvertYear=yre;at.erasAbbrRegex=Sre;at.erasNameRegex=wre;at.erasNarrowRegex=Cre;at.months=eee;at.monthsShort=tee;at.monthsParse=nee;at.monthsRegex=aee;at.monthsShortRegex=iee;at.week=uee;at.firstDayOfYear=hee;at.firstDayOfWeek=cee;at.weekdays=Cee;at.weekdaysMin=Oee;at.weekdaysShort=_ee;at.weekdaysParse=Eee;at.weekdaysRegex=$ee;at.weekdaysShortRegex=Aee;at.weekdaysMinRegex=Iee;at.isPM=xee;at.meridiem=Hee;function Qg(e,t,r,n){var o=Yo(),i=Yn().set(n,t);return o[r](i,e)}function yV(e,t,r){if(Bo(e)&&(t=e,e=void 0),e=e||"",t!=null)return Qg(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Qg(e,n,r,"month");return o}function gE(e,t,r,n){typeof e=="boolean"?(Bo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Bo(t)&&(r=t,t=void 0),t=t||"");var o=Yo(),i=e?o._week.dow:0,a,l=[];if(r!=null)return Qg(t,(r+i)%7,n,"day");for(a=0;a<7;a++)l[a]=Qg(t,(a+i)%7,n,"day");return l}function Vre(e,t){return yV(e,t,"months")}function Wre(e,t){return yV(e,t,"monthsShort")}function Ure(e,t,r){return gE(e,t,r,"weekdays")}function zre(e,t,r){return gE(e,t,r,"weekdaysShort")}function Yre(e,t,r){return gE(e,t,r,"weekdaysMin")}yi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Qe(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ee.lang=rn("moment.lang is deprecated. Use moment.locale instead.",yi);ee.langData=rn("moment.langData is deprecated. Use moment.localeData instead.",Yo);var Zn=Math.abs;function Gre(){var e=this._data;return this._milliseconds=Zn(this._milliseconds),this._days=Zn(this._days),this._months=Zn(this._months),e.milliseconds=Zn(e.milliseconds),e.seconds=Zn(e.seconds),e.minutes=Zn(e.minutes),e.hours=Zn(e.hours),e.months=Zn(e.months),e.years=Zn(e.years),this}function gV(e,t,r,n){var o=On(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function Kre(e,t){return gV(this,e,t,1)}function qre(e,t){return gV(this,e,t,-1)}function A1(e){return e<0?Math.floor(e):Math.ceil(e)}function Xre(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,l,s;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=A1(LC(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=Zr(e/1e3),n.seconds=o%60,i=Zr(o/60),n.minutes=i%60,a=Zr(i/60),n.hours=a%24,t+=Zr(a/24),s=Zr(pV(t)),r+=s,t-=A1(LC(s)),l=Zr(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function pV(e){return e*4800/146097}function LC(e){return e*146097/4800}function Zre(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=nn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+pV(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(LC(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function Qre(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function Go(e){return function(){return this.as(e)}}var Jre=Go("ms"),ene=Go("s"),tne=Go("m"),rne=Go("h"),nne=Go("d"),one=Go("w"),ine=Go("M"),ane=Go("Q"),lne=Go("y");function sne(){return On(this)}function une(e){return e=nn(e),this.isValid()?this[e+"s"]():NaN}function ul(e){return function(){return this.isValid()?this._data[e]:NaN}}var fne=ul("milliseconds"),cne=ul("seconds"),hne=ul("minutes"),dne=ul("hours"),vne=ul("days"),yne=ul("months"),gne=ul("years");function pne(){return Zr(this.days()/7)}var ao=Math.round,Xl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function mne(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function bne(e,t,r,n){var o=On(e).abs(),i=ao(o.as("s")),a=ao(o.as("m")),l=ao(o.as("h")),s=ao(o.as("d")),u=ao(o.as("M")),f=ao(o.as("w")),c=ao(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||l<=1&&["h"]||l<r.h&&["hh",l]||s<=1&&["d"]||s<r.d&&["dd",s];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,mne.apply(null,h)}function wne(e){return e===void 0?ao:typeof e=="function"?(ao=e,!0):!1}function Sne(e,t){return Xl[e]===void 0?!1:t===void 0?Xl[e]:(Xl[e]=t,e==="s"&&(Xl.ss=t-1),!0)}function Cne(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Xl,o,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Xl,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),o=this.localeData(),i=bne(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var hw=Math.abs;function gl(e){return(e>0)-(e<0)||+e}function jm(){if(!this.isValid())return this.localeData().invalidDate();var e=hw(this._milliseconds)/1e3,t=hw(this._days),r=hw(this._months),n,o,i,a,l=this.asSeconds(),s,u,f,c;return l?(n=Zr(e/60),o=Zr(n/60),e%=60,n%=60,i=Zr(r/12),r%=12,a=e?e.toFixed(3).replace(/\.?0+$/,""):"",s=l<0?"-":"",u=gl(this._months)!==gl(l)?"-":"",f=gl(this._days)!==gl(l)?"-":"",c=gl(this._milliseconds)!==gl(l)?"-":"",s+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(o||n||e?"T":"")+(o?c+o+"H":"")+(n?c+n+"M":"")+(e?c+a+"S":"")):"P0D"}var nt=Hm.prototype;nt.isValid=vte;nt.abs=Gre;nt.add=Kre;nt.subtract=qre;nt.as=Zre;nt.asMilliseconds=Jre;nt.asSeconds=ene;nt.asMinutes=tne;nt.asHours=rne;nt.asDays=nne;nt.asWeeks=one;nt.asMonths=ine;nt.asQuarters=ane;nt.asYears=lne;nt.valueOf=Qre;nt._bubble=Xre;nt.clone=sne;nt.get=une;nt.milliseconds=fne;nt.seconds=cne;nt.minutes=hne;nt.hours=dne;nt.days=vne;nt.weeks=pne;nt.months=yne;nt.years=gne;nt.humanize=Cne;nt.toISOString=jm;nt.toString=jm;nt.toJSON=jm;nt.locale=iV;nt.localeData=lV;nt.toIsoString=rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",jm);nt.lang=aV;Pe("X",0,0,"unix");Pe("x",0,0,"valueOf");be("x",Mm);be("X",UJ);yt("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});yt("x",function(e,t,r){r._d=new Date(Qe(e))});//! moment.js
ee.version="2.29.4";_J(Ot);ee.fn=oe;ee.min=fte;ee.max=cte;ee.now=hte;ee.utc=Yn;ee.unix=Fre;ee.months=Vre;ee.isDate=wv;ee.locale=yi;ee.invalid=Pm;ee.duration=On;ee.isMoment=bn;ee.weekdays=Ure;ee.parseZone=Bre;ee.localeData=Yo;ee.isDuration=ug;ee.monthsShort=Wre;ee.weekdaysMin=Yre;ee.defineLocale=sE;ee.updateLocale=Bee;ee.locales=Vee;ee.weekdaysShort=zre;ee.normalizeUnits=nn;ee.relativeTimeRounding=wne;ee.relativeTimeThreshold=Sne;ee.calendarFormat=Hte;ee.prototype=oe;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const _ne=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));var One=TypeError,Rne=9007199254740991,mV=function(e){if(e>Rne)throw One("Maximum allowed index exceeded");return e},Ene=$e,Tne=je,Pne=Pf,kne=Yt,$ne=Ir,Ane=en,I1=mV,M1=Tf,Ine=A0,Mne=yv,xne=St,Dne=Qd,bV=xne("isConcatSpreadable"),Nne=Dne>=51||!Tne(function(){var e=[];return e[bV]=!1,e.concat()[0]!==e}),Hne=function(e){if(!kne(e))return!1;var t=e[bV];return t!==void 0?!!t:Pne(e)},Lne=!Nne||!Mne("concat");Ene({target:"Array",proto:!0,arity:1,forced:Lne},{concat:function(t){var r=$ne(this),n=Ine(r,0),o=0,i,a,l,s,u;for(i=-1,l=arguments.length;i<l;i++)if(u=i===-1?r:arguments[i],Hne(u))for(s=Ane(u),I1(o+s),a=0;a<s;a++,o++)a in u&&M1(n,o,u[a]);else I1(o+1),M1(n,o++,u);return n.length=o,n}});var jne=Yt,Fne=Un,Bne=St,Vne=Bne("match"),pE=function(e){var t;return jne(e)&&((t=e[Vne])!==void 0?!!t:Fne(e)=="RegExp")},Wne=pE,Une=TypeError,mE=function(e){if(Wne(e))throw Une("The method doesn't accept regular expressions");return e},zne=St,Yne=zne("match"),bE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[Yne]=!1,"/./"[e](t)}catch{}}return!1},Gne=$e,Kne=Ye,qne=mE,Xne=Ar,x1=Kt,Zne=bE,Qne=Kne("".indexOf);Gne({target:"String",proto:!0,forced:!Zne("includes")},{includes:function(t){return!!~Qne(x1(Xne(this)),x1(qne(t)),arguments.length>1?arguments[1]:void 0)}});var Jne=Uo,eoe=gv,toe=St,roe=Gt,D1=toe("species"),wV=function(e){var t=Jne(e);roe&&t&&!t[D1]&&eoe(t,D1,{configurable:!0,get:function(){return this}})},noe=Ef,ooe=gv,N1=S0,ioe=dv,aoe=P0,loe=_n,soe=T0,uoe=v0,cy=y0,foe=wV,Kf=Gt,H1=cv.fastKey,SV=zo,L1=SV.set,dw=SV.getterFor,CV={getConstructor:function(e,t,r,n){var o=e(function(u,f){aoe(u,i),L1(u,{type:t,index:noe(null),first:void 0,last:void 0,size:0}),Kf||(u.size=0),loe(f)||soe(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=dw(t),l=function(u,f,c){var h=a(u),d=s(u,f),v,y;return d?d.value=c:(h.last=d={index:y=H1(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),Kf?h.size++:u.size++,y!=="F"&&(h.index[y]=d)),u},s=function(u,f){var c=a(u),h=H1(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return N1(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,Kf?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=s(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),Kf?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=ioe(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!s(this,f)}}),N1(i,r?{get:function(f){var c=s(this,f);return c&&c.value},set:function(f,c){return l(this,f===0?0:f,c)}}:{add:function(f){return l(this,f=f===0?0:f,f)}}),Kf&&ooe(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=dw(t),i=dw(n);uoe(e,t,function(a,l){L1(this,{type:n,target:a,state:o(a),kind:l,last:void 0})},function(){for(var a=i(this),l=a.kind,s=a.last;s&&s.removed;)s=s.previous;return!a.target||!(a.last=s=s?s.next:a.state.first)?(a.target=void 0,cy(void 0,!0)):l=="keys"?cy(s.key,!1):l=="values"?cy(s.value,!1):cy([s.key,s.value],!1)},r?"entries":"values",!r,!0),foe(t)}},coe=vm,hoe=CV;coe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},hoe);var j1=jt,doe=vB,voe=_n,yoe=St,goe=yoe("species"),poe=function(e,t){var r=j1(e).constructor,n;return r===void 0||voe(n=j1(r)[goe])?t:doe(n)},moe=sl,qf=Zt,wE=Ye,boe=mm,woe=jt,Soe=_n,Coe=pE,F1=Ar,_oe=poe,Ooe=H0,Roe=ol,vw=Kt,Eoe=nl,B1=C0,V1=bm,Toe=pm,Poe=N0,koe=je,pl=Poe.UNSUPPORTED_Y,W1=4294967295,$oe=Math.min,_V=[].push,Aoe=wE(/./.exec),ml=wE(_V),Xf=wE("".slice),Ioe=!koe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});boe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=vw(F1(this)),l=i===void 0?W1:i>>>0;if(l===0)return[];if(o===void 0)return[a];if(!Coe(o))return qf(t,a,o,l);for(var s=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=qf(Toe,c,a))&&(d=c.lastIndex,!(d>f&&(ml(s,Xf(a,f,h.index)),h.length>1&&h.index<a.length&&moe(_V,s,B1(h,1)),v=h[0].length,f=d,s.length>=l)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!Aoe(c,""))&&ml(s,""):ml(s,Xf(a,f)),s.length>l?B1(s,0,l):s}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:qf(t,this,o,i)}:n=t,[function(i,a){var l=F1(this),s=Soe(i)?void 0:Eoe(i,e);return s?qf(s,i,l,a):qf(n,vw(l),i,a)},function(o,i){var a=woe(this),l=vw(o),s=r(n,a,l,i,n!==t);if(s.done)return s.value;var u=_oe(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(pl?"g":"y"),h=new u(pl?"^(?:"+a.source+")":a,c),d=i===void 0?W1:i>>>0;if(d===0)return[];if(l.length===0)return V1(h,l)===null?[l]:[];for(var v=0,y=0,m=[];y<l.length;){h.lastIndex=pl?0:y;var w=V1(h,pl?Xf(l,y):l),S;if(w===null||(S=$oe(Roe(h.lastIndex+(pl?y:0)),l.length))===v)y=Ooe(l,y,f);else{if(ml(m,Xf(l,v,y)),m.length===d)return m;for(var C=1;C<=w.length-1;C++)if(ml(m,w[C]),m.length===d)return m;y=v=S}}return ml(m,Xf(l,v)),m}]},!Ioe,pl);function OV(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function jC(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Pc(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function Ft(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(n&&l&&(o+=1,a=i[o]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function Wr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];t(l,r,n)&&(a+=1,i[a]=l),r+=1}return i}function We(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var l=n[r];a+=1,i[a]=t(l,r,n),r+=1}return i}function A(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function RV(e){return Ft(e,function(t,r){return t+r},0)}function Moe(e){return Ft(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function xoe(e){return Ft(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function Doe(e){return e.length?RV(e)/e.length:0}function EV(e){return Ft(e,function(t,r){return t.concat(Array.isArray(r)?EV(r):r)},[])}function SE(e){var t=[];return A(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function FC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return!l.includes(s)})}),a}function Noe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return A(i,function(l){a=a.filter(function(s){return l.includes(s)})}),a}function Hoe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return A(i,function(l){A(l,function(s){a.has(s)||a.add(s)})}),Array.from(a)}function BC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const Loe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Doe,arrayEach:A,arrayFilter:Wr,arrayFlatten:EV,arrayMap:We,arrayMax:Moe,arrayMin:xoe,arrayReduce:Ft,arraySum:RV,arrayUnique:SE,extendArray:jC,getDifferenceOfArrays:FC,getIntersectionOfArrays:Noe,getUnionOfArrays:Hoe,pivot:Pc,stringToArray:BC,to2dArray:OV},Symbol.toStringTag,{value:"Module"}));function dt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=Ft(e,function(i,a,l){var s=a.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return i+s+u},"");return o.trim()}var U1,z1,Y1,G1,K1,q1;function os(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function VC(e){"@babel/helpers - typeof";return VC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VC(e)}function Dt(e){var t;switch(VC(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function ve(e){return typeof e<"u"}function bt(e){return typeof e>"u"}function Xt(e){return e===null||e===""||bt(e)}function TV(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var Sc="length",kc=function(t){return parseInt(t,16)},X1=function(t){return parseInt(t,10)},Jg=function(t,r,n){return t.substr(r,n)},$c=function(t){return t.codePointAt(0)-65},WC=function(t){return"".concat(t).replace(/\-/g,"")},joe=function(t){return kc(Jg(WC(t),kc("12"),$c("F")))/(kc(Jg(WC(t),$c("B"),~~![][Sc]))||9)},Foe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},Z1=!1,Q1={invalid:function(){return dt(U1||(U1=os([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(z1||(z1=os([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return dt(Y1||(Y1=os([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},J1={invalid:function(){return dt(G1||(G1=os([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return dt(K1||(K1=os([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return dt(q1||(q1=os([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function PV(e,t){var r=!Xt(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="13.0.0",i,a="invalid",l="invalid";e=WC(e||"");var s=Boe(e);if(r||n||s)if(s){var u=ee("22/06/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=joe(e);i=ee((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(a="expired",l="expired"):(a="valid",l="valid")}else n?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(Foe()&&(a="valid",l="valid"),!Z1&&a!=="valid"){var h=Q1[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](Q1[a]({keyValidityDate:i,hotVersion:o})),Z1=!0}if(l!=="valid"&&t.parentNode){var d=J1[l]({keyValidityDate:i,hotVersion:o});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=J1[l]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(v,t.nextSibling)}}}function Boe(e){var t=[][Sc],r=t;if(e[Sc]!==$c("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=$c(o.shift());i;i=$c(o.shift()||"A"))--i<""[Sc]?r=r|(X1("".concat(X1(kc(n)+(kc(Jg(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Jg(e,i,i?o[Sc]===1?9:8:6);return r===t}const Voe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:PV,isDefined:ve,isEmpty:Xt,isRegExp:TV,isUndefined:bt,stringify:Dt},Symbol.toStringTag,{value:"Module"}));var Woe=Ir,eA=ev,Uoe=en,zoe=function(t){for(var r=Woe(this),n=Uoe(r),o=arguments.length,i=eA(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,l=a===void 0?n:eA(a,n);l>i;)r[i++]=t;return r},Yoe=$e,Goe=zoe,Koe=nv;Yoe({target:"Array",proto:!0},{fill:Goe});Koe("fill");var qoe=$e,Xoe=Ir,kV=rv,Zoe=je,Qoe=Zoe(function(){kV(1)});qoe({target:"Object",stat:!0,forced:Qoe},{keys:function(t){return kV(Xoe(t))}});var Joe=ll.forEach,eie=kf,tie=eie("forEach"),rie=tie?[].forEach:function(t){return Joe(this,t,arguments.length>1?arguments[1]:void 0)},tA=vt,rA=bF,nie=wF,yw=rie,oie=il,$V=function(e){if(e&&e.forEach!==yw)try{oie(e,"forEach",yw)}catch{e.forEach=yw}};for(var gw in rA)rA[gw]&&$V(tA[gw]&&tA[gw].prototype);$V(nie);function nA(e,t,r){return t=iie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iie(e){var t=aie(e,"string");return Vo(t)==="symbol"?t:String(t)}function aie(e,t){if(Vo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vo(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vo(e){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(e)}function ps(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},ze(e,function(r,n){n!=="__children"&&(r&&Vo(r)==="object"&&!Array.isArray(r)?t[n]=ps(r):Array.isArray(r)?r.length&&Vo(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[ps(r[0])]:t[n]=[]:t[n]=null)})),t}function Ko(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function zt(e,t,r){var n=Array.isArray(r);return ze(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function Ov(e,t){ze(t,function(r,n){t[n]&&Vo(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Ov(e[n],t[n])):e[n]=t[n]})}function fr(e){return Vo(e)==="object"?JSON.parse(JSON.stringify(e)):e}function Sr(e){var t={};return ze(e,function(r,n){t[n]=r}),t}function gt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return A(r,function(o){e.MIXINS.push(o.MIXIN_NAME),ze(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var l=function(f,c){var h="_".concat(f),d=function(y){var m=y;return(Array.isArray(m)||Ue(m))&&(m=fr(m)),m};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},s=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:l(a,i),set:s(a),configurable:!0})}})}),e}function Fm(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function Kn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function ze(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function AV(e,t){var r=t.split("."),n=e;return ze(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function cg(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(xt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function Bm(e){if(!Ue(e))return 0;var t=function r(n){var o=0;return Ue(n)?ze(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Va(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},nA(t,n,e),nA(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const lie=Object.freeze(Object.defineProperty({__proto__:null,clone:Sr,createObjectPropListener:Va,deepClone:fr,deepExtend:Ov,deepObjectSize:Bm,defineGetter:Kn,duckSchema:ps,extend:zt,getProperty:AV,hasOwnProperty:xt,inherit:Ko,isObject:Ue,isObjectEqual:Fm,mixin:gt,objectEach:ze,setProperty:cg},Symbol.toStringTag,{value:"Module"}));var kr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Ur={chrome:kr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:kr(function(e){return/CriOS/.test(e)}),edge:kr(function(e){return/Edge/.test(e)}),edgeWebKit:kr(function(e){return/EdgiOS/.test(e)}),firefox:kr(function(e){return/Firefox/.test(e)}),firefoxWebKit:kr(function(e){return/FxiOS/.test(e)}),ie:kr(function(e){return/Trident/.test(e)}),ie9:kr(function(){return!!document.documentMode}),mobile:kr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:kr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},If={mac:kr(function(e){return/^Mac/.test(e)}),win:kr(function(e){return/^Win/.test(e)}),linux:kr(function(e){return/^Linux/.test(e)}),ios:kr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function IV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;ze(Ur,function(i){var a=i.test;return void a(r,o)})}function MV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;ze(If,function(n){var o=n.test;return void o(r)})}IV();MV();function CE(){return Ur.chrome.value}function xV(){return Ur.chromeWebKit.value}function hg(){return Ur.firefox.value}function DV(){return Ur.firefoxWebKit.value}function NV(){return Ur.safari.value}function HV(){return Ur.edge.value}function sie(){return Ur.edgeWebKit.value}function LV(){return Ur.ie.value}function jV(){return Ur.ie9.value}function uie(){return Ur.ie.value||Ur.edge.value}function pn(){return Ur.mobile.value}function _E(){return If.ios.value}function OE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&If.mac.value}function UC(){return If.win.value}function ep(){return If.mac.value}function fie(){return If.linux.value}const cie=Object.freeze(Object.defineProperty({__proto__:null,isChrome:CE,isChromeWebKit:xV,isEdge:HV,isEdgeWebKit:sie,isFirefox:hg,isFirefoxWebKit:DV,isIE:LV,isIE9:jV,isIOS:_E,isIpadOS:OE,isLinuxOS:fie,isMSBrowser:uie,isMacOS:ep,isMobileBrowser:pn,isSafari:NV,isWindowsOS:UC,setBrowserMeta:IV,setPlatformMeta:MV},Symbol.toStringTag,{value:"Module"}));var me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:hg()?182:174,AUDIO_MUTE:hg()?181:173,AUDIO_UP:hg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},hie=[me.ALT,me.ARROW_DOWN,me.ARROW_LEFT,me.ARROW_RIGHT,me.ARROW_UP,me.AUDIO_DOWN,me.AUDIO_MUTE,me.AUDIO_UP,me.BACKSPACE,me.CAPS_LOCK,me.DELETE,me.END,me.ENTER,me.ESCAPE,me.F1,me.F2,me.F3,me.F4,me.F5,me.F6,me.F7,me.F8,me.F9,me.F10,me.F11,me.F12,me.F13,me.F14,me.F15,me.F16,me.F17,me.F18,me.F19,me.HOME,me.INSERT,me.MEDIA_NEXT,me.MEDIA_PLAY_PAUSE,me.MEDIA_PREV,me.MEDIA_STOP,me.NULL,me.NUM_LOCK,me.PAGE_DOWN,me.PAGE_UP,me.PAUSE,me.SCROLL_LOCK,me.SHIFT,me.TAB];function FV(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function RE(e){return hie.includes(e)}function die(e){var t=[];return ep()?t.push(me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX):t.push(me.CONTROL),t.includes(e)}function BV(e){return[me.CONTROL,me.COMMAND_LEFT,me.COMMAND_RIGHT,me.COMMAND_FIREFOX].includes(e)}function ms(e,t){var r=t.split("|"),n=!1;return A(r,function(o){if(e===me[o])return n=!0,!1}),n}const vie=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:me,isCtrlKey:die,isCtrlMetaKey:BV,isFunctionKey:RE,isKey:ms,isPrintableChar:FV},Symbol.toStringTag,{value:"Module"}));function wn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function la(e){return e.isImmediatePropagationEnabled===!1}function $i(e){return e.button===2}function Vm(e){return e.button===0}const yie=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:la,isLeftClick:Vm,isRightClick:$i,stopImmediatePropagation:wn},Symbol.toStringTag,{value:"Module"}));var gie=_r.f,pie=function(e,t,r){r in e||gie(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},mie=Gt,EE=vt,Rv=Ye,bie=fm,wie=k0,Sie=il,Cie=al.f,oA=Di,_ie=pE,iA=Kt,Oie=SB,VV=N0,Rie=pie,Eie=tn,Tie=je,Pie=Nt,kie=zo.enforce,$ie=wV,Aie=St,WV=$F,UV=AF,Iie=Aie("match"),gi=EE.RegExp,Yl=gi.prototype,Mie=EE.SyntaxError,xie=Rv(Yl.exec),tp=Rv("".charAt),aA=Rv("".replace),lA=Rv("".indexOf),Die=Rv("".slice),Nie=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Fa=/a/g,pw=/a/g,Hie=new gi(Fa)!==Fa,zV=VV.MISSED_STICKY,Lie=VV.UNSUPPORTED_Y,jie=mie&&(!Hie||zV||WV||UV||Tie(function(){return pw[Iie]=!1,gi(Fa)!=Fa||gi(pw)==pw||gi(Fa,"i")!="/a/i"})),Fie=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=tp(e,r),i==="\\"){n+=i+tp(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},Bie=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,l=!1,s=0,u="",f;r<=t;r++){if(f=tp(e,r),f==="\\")f=f+tp(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":xie(Nie,Die(e,r+1))&&(r+=2,l=!0),n+=f,s++;continue;case(f===">"&&l):if(u===""||Pie(i,u))throw new Mie("Invalid capture group name");i[u]=!0,o[o.length]=[u,s],l=!1,u="";continue}l?u+=f:n+=f}return[n,o]};if(bie("RegExp",jie)){for(var Wi=function(t,r){var n=oA(Yl,this),o=_ie(t),i=r===void 0,a=[],l=t,s,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Wi)return t;if((o||oA(Yl,t))&&(t=t.source,i&&(r=Oie(l))),t=t===void 0?"":iA(t),r=r===void 0?"":iA(r),l=t,WV&&"dotAll"in Fa&&(u=!!r&&lA(r,"s")>-1,u&&(r=aA(r,/s/g,""))),s=r,zV&&"sticky"in Fa&&(f=!!r&&lA(r,"y")>-1,f&&Lie&&(r=aA(r,/y/g,""))),UV&&(c=Bie(t),t=c[0],a=c[1]),h=wie(gi(t,r),n?this:Yl,Wi),(u||f||a.length)&&(d=kie(h),u&&(d.dotAll=!0,d.raw=Wi(Fie(t),s)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==l)try{Sie(h,"source",l===""?"(?:)":l)}catch{}return h},sA=Cie(gi),uA=0;sA.length>uA;)Rie(Wi,gi,sA[uA++]);Yl.constructor=Wi,Wi.prototype=Yl,Eie(EE,"RegExp",Wi,{constructor:!0})}$ie("RegExp");var Vie=$e,Wie=Ye,Uie=Zd,zie=zr,Yie=kf,Gie=Wie([].join),Kie=Uie!=Object,qie=Kie||!Yie("join",",");Vie({target:"Array",proto:!0,forced:qie},{join:function(t){return Gie(zie(this),t===void 0?",":t)}});function zC(e){"@babel/helpers - typeof";return zC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zC(e)}function Wm(e){return window.requestAnimationFrame(e)}function YV(){return!!document.documentElement.classList}function GV(){return!!document.createTextNode("test").textContent}function KV(){return!!window.getComputedStyle}function qc(e){window.cancelAnimationFrame(e)}function TE(){return"ontouchstart"in window}var YC;function Xie(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),YC=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function PE(){return YC===void 0&&Xie(),YC}var bl;function qV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return bl||((typeof Intl>"u"?"undefined":zC(Intl))==="object"?bl=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?bl=function(n,o){return"".concat(n).localeCompare(o)}:bl=function(n,o){return n===o?0:n>o?-1:1},bl)}var Zf;function XV(){if(Zf!==void 0)return Zf;try{var e={get passive(){Zf=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Zf=!1}return Zf}const Zie=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:qc,getComparisonFunction:qV,hasCaptionProblem:PE,isClassListSupported:YV,isGetComputedStyleSupported:KV,isPassiveEventSupported:XV,isTextContentSupported:GV,isTouchSupported:TE,requestAnimationFrame:Wm},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function ui(e){"@babel/helpers - typeof";return ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(e)}function GC(e,t){return GC=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},GC(e,t)}function Qie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dg(e,t,r){return Qie()?dg=Reflect.construct:dg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&GC(u,a.prototype),u},dg.apply(null,arguments)}function fn(e){return Jie(e)||eae(e)||tae(e)||rae()}function Jie(e){if(Array.isArray(e))return KC(e)}function eae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tae(e,t){if(e){if(typeof e=="string")return KC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KC(e,t)}}function KC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var nae=Object.hasOwnProperty,fA=Object.setPrototypeOf,oae=Object.isFrozen,iae=Object.getPrototypeOf,aae=Object.getOwnPropertyDescriptor,Cr=Object.freeze,Sn=Object.seal,lae=Object.create,ZV=typeof Reflect<"u"&&Reflect,rp=ZV.apply,qC=ZV.construct;rp||(rp=function(t,r,n){return t.apply(r,n)});Cr||(Cr=function(t){return t});Sn||(Sn=function(t){return t});qC||(qC=function(t,r){return dg(t,fn(r))});var sae=Jr(Array.prototype.forEach),cA=Jr(Array.prototype.pop),Qf=Jr(Array.prototype.push),vg=Jr(String.prototype.toLowerCase),mw=Jr(String.prototype.toString),uae=Jr(String.prototype.match),ln=Jr(String.prototype.replace),fae=Jr(String.prototype.indexOf),cae=Jr(String.prototype.trim),vr=Jr(RegExp.prototype.test),bw=hae(TypeError);function Jr(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return rp(e,t,n)}}function hae(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return qC(e,r)}}function Xe(e,t,r){r=r||vg,fA&&fA(e,null);for(var n=t.length;n--;){var o=t[n];if(typeof o=="string"){var i=r(o);i!==o&&(oae(t)||(t[n]=i),o=i)}e[o]=!0}return e}function Ui(e){var t=lae(null),r;for(r in e)rp(nae,e,[r])===!0&&(t[r]=e[r]);return t}function hy(e,t){for(;e!==null;){var r=aae(e,t);if(r){if(r.get)return Jr(r.get);if(typeof r.value=="function")return Jr(r.value)}e=iae(e)}function n(o){return console.warn("fallback value for",o),null}return n}var hA=Cr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ww=Cr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Sw=Cr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),dae=Cr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Cw=Cr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),vae=Cr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),dA=Cr(["#text"]),vA=Cr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),_w=Cr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),yA=Cr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),dy=Cr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),yae=Sn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),gae=Sn(/<%[\w\W]*|[\w\W]*%>/gm),pae=Sn(/\${[\w\W]*}/gm),mae=Sn(/^data-[\-\w.\u00B7-\uFFFF]/),bae=Sn(/^aria-[\-\w]+$/),wae=Sn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Sae=Sn(/^(?:\w+script|data):/i),Cae=Sn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_ae=Sn(/^html$/i),Oae=function(){return typeof window>"u"?null:window},Rae=function(t,r){if(ui(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function QV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Oae(),t=function(L){return QV(L)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,l=e.Element,s=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=l.prototype,y=hy(v,"cloneNode"),m=hy(v,"nextSibling"),w=hy(v,"childNodes"),S=hy(v,"parentNode");if(typeof i=="function"){var C=n.createElement("template");C.content&&C.content.ownerDocument&&(n=C.content.ownerDocument)}var k=Rae(d,r),_=k?k.createHTML(""):"",N=n,V=N.implementation,X=N.createNodeIterator,Y=N.createDocumentFragment,q=N.getElementsByTagName,Q=r.importNode,ne={};try{ne=Ui(n).documentMode?n.documentMode:{}}catch{}var J={};t.isSupported=typeof S=="function"&&V&&typeof V.createHTMLDocument<"u"&&ne!==9;var ue=yae,he=gae,Oe=pae,we=mae,$=bae,P=Sae,g=Cae,p=wae,b=null,E=Xe({},[].concat(fn(hA),fn(ww),fn(Sw),fn(Cw),fn(dA))),R=null,B=Xe({},[].concat(fn(vA),fn(_w),fn(yA),fn(dy))),x=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Z=null,re=!0,ie=!0,se=!1,_e=!0,Se=!1,z=!1,Ne=!1,Be=!1,ke=!1,Ie=!1,Ae=!1,O=!0,T=!1,I="user-content-",F=!0,M=!1,W={},H=null,D=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),U=null,j=Xe({},["audio","video","img","source","image","track"]),G=null,le=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",He="http://www.w3.org/1999/xhtml",Ze=He,st=!1,Ge=null,Me=Xe({},[pe,Re,He],mw),De,dr=["application/xhtml+xml","text/html"],Bt="text/html",Ve,et=null,Ct=n.createElement("form"),ut=function(L){return L instanceof RegExp||L instanceof Function},ct=function(L){et&&et===L||((!L||ui(L)!=="object")&&(L={}),L=Ui(L),De=dr.indexOf(L.PARSER_MEDIA_TYPE)===-1?De=Bt:De=L.PARSER_MEDIA_TYPE,Ve=De==="application/xhtml+xml"?mw:vg,b="ALLOWED_TAGS"in L?Xe({},L.ALLOWED_TAGS,Ve):E,R="ALLOWED_ATTR"in L?Xe({},L.ALLOWED_ATTR,Ve):B,Ge="ALLOWED_NAMESPACES"in L?Xe({},L.ALLOWED_NAMESPACES,mw):Me,G="ADD_URI_SAFE_ATTR"in L?Xe(Ui(le),L.ADD_URI_SAFE_ATTR,Ve):le,U="ADD_DATA_URI_TAGS"in L?Xe(Ui(j),L.ADD_DATA_URI_TAGS,Ve):j,H="FORBID_CONTENTS"in L?Xe({},L.FORBID_CONTENTS,Ve):D,K="FORBID_TAGS"in L?Xe({},L.FORBID_TAGS,Ve):{},Z="FORBID_ATTR"in L?Xe({},L.FORBID_ATTR,Ve):{},W="USE_PROFILES"in L?L.USE_PROFILES:!1,re=L.ALLOW_ARIA_ATTR!==!1,ie=L.ALLOW_DATA_ATTR!==!1,se=L.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=L.SAFE_FOR_TEMPLATES||!1,z=L.WHOLE_DOCUMENT||!1,ke=L.RETURN_DOM||!1,Ie=L.RETURN_DOM_FRAGMENT||!1,Ae=L.RETURN_TRUSTED_TYPE||!1,Be=L.FORCE_BODY||!1,O=L.SANITIZE_DOM!==!1,T=L.SANITIZE_NAMED_PROPS||!1,F=L.KEEP_CONTENT!==!1,M=L.IN_PLACE||!1,p=L.ALLOWED_URI_REGEXP||p,Ze=L.NAMESPACE||He,x=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&ut(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(x.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck),L.CUSTOM_ELEMENT_HANDLING&&ut(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(x.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(x.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(ie=!1),Ie&&(ke=!0),W&&(b=Xe({},fn(dA)),R=[],W.html===!0&&(Xe(b,hA),Xe(R,vA)),W.svg===!0&&(Xe(b,ww),Xe(R,_w),Xe(R,dy)),W.svgFilters===!0&&(Xe(b,Sw),Xe(R,_w),Xe(R,dy)),W.mathMl===!0&&(Xe(b,Cw),Xe(R,yA),Xe(R,dy))),L.ADD_TAGS&&(b===E&&(b=Ui(b)),Xe(b,L.ADD_TAGS,Ve)),L.ADD_ATTR&&(R===B&&(R=Ui(R)),Xe(R,L.ADD_ATTR,Ve)),L.ADD_URI_SAFE_ATTR&&Xe(G,L.ADD_URI_SAFE_ATTR,Ve),L.FORBID_CONTENTS&&(H===D&&(H=Ui(H)),Xe(H,L.FORBID_CONTENTS,Ve)),F&&(b["#text"]=!0),z&&Xe(b,["html","head","body"]),b.table&&(Xe(b,["tbody"]),delete K.tbody),Cr&&Cr(L),et=L)},tt=Xe({},["mi","mo","mn","ms","mtext"]),qo=Xe({},["foreignobject","desc","title","annotation-xml"]),pb=Xe({},["title","style","font","a","script"]),ji=Xe({},ww);Xe(ji,Sw),Xe(ji,dae);var jf=Xe({},Cw);Xe(jf,vae);var xY=function(L){var ae=S(L);(!ae||!ae.tagName)&&(ae={namespaceURI:Ze,tagName:"template"});var de=vg(L.tagName),lt=vg(ae.tagName);return Ge[L.namespaceURI]?L.namespaceURI===Re?ae.namespaceURI===He?de==="svg":ae.namespaceURI===pe?de==="svg"&&(lt==="annotation-xml"||tt[lt]):!!ji[de]:L.namespaceURI===pe?ae.namespaceURI===He?de==="math":ae.namespaceURI===Re?de==="math"&&qo[lt]:!!jf[de]:L.namespaceURI===He?ae.namespaceURI===Re&&!qo[lt]||ae.namespaceURI===pe&&!tt[lt]?!1:!jf[de]&&(pb[de]||!ji[de]):!!(De==="application/xhtml+xml"&&Ge[L.namespaceURI]):!1},qn=function(L){Qf(t.removed,{element:L});try{L.parentNode.removeChild(L)}catch{try{L.outerHTML=_}catch{L.remove()}}},mb=function(L,ae){try{Qf(t.removed,{attribute:ae.getAttributeNode(L),from:ae})}catch{Qf(t.removed,{attribute:null,from:ae})}if(ae.removeAttribute(L),L==="is"&&!R[L])if(ke||Ie)try{qn(ae)}catch{}else try{ae.setAttribute(L,"")}catch{}},lk=function(L){var ae,de;if(Be)L="<remove></remove>"+L;else{var lt=uae(L,/^[\r\n\t ]+/);de=lt&&lt[0]}De==="application/xhtml+xml"&&Ze===He&&(L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>");var Rr=k?k.createHTML(L):L;if(Ze===He)try{ae=new h().parseFromString(Rr,De)}catch{}if(!ae||!ae.documentElement){ae=V.createDocument(Ze,"template",null);try{ae.documentElement.innerHTML=st?_:Rr}catch{}}var ir=ae.body||ae.documentElement;return L&&de&&ir.insertBefore(n.createTextNode(de),ir.childNodes[0]||null),Ze===He?q.call(ae,z?"html":"body")[0]:z?ae.documentElement:ir},sk=function(L){return X.call(L.ownerDocument||L,L,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},DY=function(L){return L instanceof c&&(typeof L.nodeName!="string"||typeof L.textContent!="string"||typeof L.removeChild!="function"||!(L.attributes instanceof f)||typeof L.removeAttribute!="function"||typeof L.setAttribute!="function"||typeof L.namespaceURI!="string"||typeof L.insertBefore!="function"||typeof L.hasChildNodes!="function")},Ff=function(L){return ui(a)==="object"?L instanceof a:L&&ui(L)==="object"&&typeof L.nodeType=="number"&&typeof L.nodeName=="string"},Xn=function(L,ae,de){J[L]&&sae(J[L],function(lt){lt.call(t,ae,de,et)})},uk=function(L){var ae;if(Xn("beforeSanitizeElements",L,null),DY(L)||vr(/[\u0080-\uFFFF]/,L.nodeName))return qn(L),!0;var de=Ve(L.nodeName);if(Xn("uponSanitizeElement",L,{tagName:de,allowedTags:b}),L.hasChildNodes()&&!Ff(L.firstElementChild)&&(!Ff(L.content)||!Ff(L.content.firstElementChild))&&vr(/<[/\w]/g,L.innerHTML)&&vr(/<[/\w]/g,L.textContent)||de==="select"&&vr(/<template/i,L.innerHTML))return qn(L),!0;if(!b[de]||K[de]){if(!K[de]&&ck(de)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de)))return!1;if(F&&!H[de]){var lt=S(L)||L.parentNode,Rr=w(L)||L.childNodes;if(Rr&&lt)for(var ir=Rr.length,or=ir-1;or>=0;--or)lt.insertBefore(y(Rr[or],!0),m(L))}return qn(L),!0}return L instanceof l&&!xY(L)||(de==="noscript"||de==="noembed")&&vr(/<\/no(script|embed)/i,L.innerHTML)?(qn(L),!0):(Se&&L.nodeType===3&&(ae=L.textContent,ae=ln(ae,ue," "),ae=ln(ae,he," "),ae=ln(ae,Oe," "),L.textContent!==ae&&(Qf(t.removed,{element:L.cloneNode()}),L.textContent=ae)),Xn("afterSanitizeElements",L,null),!1)},fk=function(L,ae,de){if(O&&(ae==="id"||ae==="name")&&(de in n||de in Ct))return!1;if(!(ie&&!Z[ae]&&vr(we,ae))){if(!(re&&vr($,ae))){if(!R[ae]||Z[ae]){if(!(ck(L)&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,L)||x.tagNameCheck instanceof Function&&x.tagNameCheck(L))&&(x.attributeNameCheck instanceof RegExp&&vr(x.attributeNameCheck,ae)||x.attributeNameCheck instanceof Function&&x.attributeNameCheck(ae))||ae==="is"&&x.allowCustomizedBuiltInElements&&(x.tagNameCheck instanceof RegExp&&vr(x.tagNameCheck,de)||x.tagNameCheck instanceof Function&&x.tagNameCheck(de))))return!1}else if(!G[ae]){if(!vr(p,ln(de,g,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&L!=="script"&&fae(de,"data:")===0&&U[L])){if(!(se&&!vr(P,ln(de,g,"")))){if(de)return!1}}}}}}return!0},ck=function(L){return L.indexOf("-")>0},hk=function(L){var ae,de,lt,Rr;Xn("beforeSanitizeAttributes",L,null);var ir=L.attributes;if(ir){var or={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};for(Rr=ir.length;Rr--;){ae=ir[Rr];var Wv=ae,er=Wv.name,bb=Wv.namespaceURI;if(de=er==="value"?ae.value:cae(ae.value),lt=Ve(er),or.attrName=lt,or.attrValue=de,or.keepAttr=!0,or.forceKeepAttr=void 0,Xn("uponSanitizeAttribute",L,or),de=or.attrValue,!or.forceKeepAttr&&(mb(er,L),!!or.keepAttr)){if(!_e&&vr(/\/>/i,de)){mb(er,L);continue}Se&&(de=ln(de,ue," "),de=ln(de,he," "),de=ln(de,Oe," "));var dk=Ve(L.nodeName);if(fk(dk,lt,de)){if(T&&(lt==="id"||lt==="name")&&(mb(er,L),de=I+de),k&&ui(d)==="object"&&typeof d.getAttributeType=="function"&&!bb)switch(d.getAttributeType(dk,lt)){case"TrustedHTML":de=k.createHTML(de);break;case"TrustedScriptURL":de=k.createScriptURL(de);break}try{bb?L.setAttributeNS(bb,er,de):L.setAttribute(er,de),cA(t.removed)}catch{}}}}Xn("afterSanitizeAttributes",L,null)}},NY=function Ee(L){var ae,de=sk(L);for(Xn("beforeSanitizeShadowDOM",L,null);ae=de.nextNode();)Xn("uponSanitizeShadowNode",ae,null),!uk(ae)&&(ae.content instanceof o&&Ee(ae.content),hk(ae));Xn("afterSanitizeShadowDOM",L,null)};return t.sanitize=function(Ee){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,de,lt,Rr,ir;if(st=!Ee,st&&(Ee="<!-->"),typeof Ee!="string"&&!Ff(Ee)){if(typeof Ee.toString!="function")throw bw("toString is not a function");if(Ee=Ee.toString(),typeof Ee!="string")throw bw("dirty is not a string, aborting")}if(!t.isSupported){if(ui(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Ee=="string")return e.toStaticHTML(Ee);if(Ff(Ee))return e.toStaticHTML(Ee.outerHTML)}return Ee}if(Ne||ct(L),t.removed=[],typeof Ee=="string"&&(M=!1),M){if(Ee.nodeName){var or=Ve(Ee.nodeName);if(!b[or]||K[or])throw bw("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof a)ae=lk("<!---->"),de=ae.ownerDocument.importNode(Ee,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?ae=de:ae.appendChild(de);else{if(!ke&&!Se&&!z&&Ee.indexOf("<")===-1)return k&&Ae?k.createHTML(Ee):Ee;if(ae=lk(Ee),!ae)return ke?null:Ae?_:""}ae&&Be&&qn(ae.firstChild);for(var Wv=sk(M?Ee:ae);lt=Wv.nextNode();)lt.nodeType===3&&lt===Rr||uk(lt)||(lt.content instanceof o&&NY(lt.content),hk(lt),Rr=lt);if(Rr=null,M)return Ee;if(ke){if(Ie)for(ir=Y.call(ae.ownerDocument);ae.firstChild;)ir.appendChild(ae.firstChild);else ir=ae;return(R.shadowroot||R.shadowrootmod)&&(ir=Q.call(r,ir,!0)),ir}var er=z?ae.outerHTML:ae.innerHTML;return z&&b["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&vr(_ae,ae.ownerDocument.doctype.name)&&(er="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+er),Se&&(er=ln(er,ue," "),er=ln(er,he," "),er=ln(er,Oe," ")),k&&Ae?k.createHTML(er):er},t.setConfig=function(Ee){ct(Ee),Ne=!0},t.clearConfig=function(){et=null,Ne=!1},t.isValidAttribute=function(Ee,L,ae){et||ct({});var de=Ve(Ee),lt=Ve(L);return fk(de,lt,ae)},t.addHook=function(Ee,L){typeof L=="function"&&(J[Ee]=J[Ee]||[],Qf(J[Ee],L))},t.removeHook=function(Ee){if(J[Ee])return cA(J[Ee])},t.removeHooks=function(Ee){J[Ee]&&(J[Ee]=[])},t.removeAllHooks=function(){J={}},t}var Eae=QV();function ur(e){return e[0].toUpperCase()+e.substr(1)}function Tae(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=Dt(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function kE(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function $E(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function AE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function XC(e){return Um("".concat(e),{ALLOWED_TAGS:[]})}function Um(e,t){return Eae.sanitize(e,t)}const Pae=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Tae,isPercentValue:$E,randomString:kE,sanitize:Um,stripTags:XC,substitute:AE,toUpperCaseFirst:ur},Symbol.toStringTag,{value:"Module"}));function gA(e){return Iae(e)||Aae(e)||$ae(e)||kae()}function kae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ae(e,t){if(e){if(typeof e=="string")return ZC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZC(e,t)}}function Aae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Iae(e){if(Array.isArray(e))return ZC(e)}function ZC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JV(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function eW(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Xc(e){return eW(e)&&e.parent}function Mae(e){return!!Object.getPrototypeOf(e.parent)}function pi(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&s===i?a=c:a=a.parentNode}return null}function Cc(e,t,r){for(var n=[],o=e;o&&(o=pi(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function mi(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function tW(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function li(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var QC,JC,e_;function vy(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(YV()){var pA=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};QC=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},JC=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=vy(o),o.length>0)if(pA(n)){var i;(i=t.classList).add.apply(i,gA(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},e_=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=vy(o),o.length>0)if(pA(n)){var i;(i=t.classList).remove.apply(i,gA(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var Ow=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};QC=function(t,r){return t.className!==void 0&&Ow(r).test(t.className)},JC=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=vy(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!Ow(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},e_=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=vy(i);i[n];)o=o.replace(Ow(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function xe(e,t){return QC(e,t)}function te(e,t){JC(e,t)}function Le(e,t){e_(e,t)}function IE(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)IE(t[r])}function Cn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var rW=/(<(.*)>|&(.*);)/;function fl(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;rW.test(t)?e.innerHTML=r?Um(t):t:Ai(e,t)}function Ai(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?GV?r.textContent=t:r.data=t:(Cn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function bs(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return bs(r.host.impl);if(r.host)return bs(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Ut(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,l,s;if(PE()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return s=o.getBoundingClientRect(),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function ws(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Wa(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Zc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?ws(t):e.scrollTop}function np(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Wa(t):e.scrollLeft}function Qc(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=KV(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(l=f.overflow,s=f.overflowX,u=f.overflowY,n.includes(l)||n.includes(s)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(l))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(l)))return i;i=i.parentNode}return r}function Ua(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ii(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return n;n=n.parentNode}return r}function Ss(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ii(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function xae(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ii(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ht(e){return e.offsetWidth}function Pt(e){return PE()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function ho(e){return e.clientHeight||e.innerHeight}function Ac(e){return e.clientWidth||e.innerWidth}function Dae(e,t,r){e.addEventListener(t,r,!1)}function Nae(e,t,r){e.removeEventListener(t,r,!1)}function ME(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function nW(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function oW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function t_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Ev(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var Rw;function Hae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function Jt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Rw===void 0&&(Rw=Hae(e)),Rw}function iW(e){return e.offsetWidth!==e.clientWidth}function aW(e){return e.offsetHeight!==e.clientHeight}function zm(e,t,r){jV()?(e.style.top=r,e.style.left=t):NV()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function Lae(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function Tv(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Jc(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function Ym(e){return Jc(e)&&e.hasAttribute("data-hot-input")===!1}function lW(e){var t=e.ownerDocument.activeElement;Ym(t)||e.select()}function xE(e){return!e.parentNode}function sW(e,t){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const jae=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:rW,addClass:te,addEvent:Dae,clearTextSelection:t_,closest:pi,closestDown:Cc,empty:Cn,fastInnerHTML:fl,fastInnerText:Ai,getCaretPosition:ME,getComputedStyle:Ii,getCssTransform:Lae,getFrameElement:eW,getParent:JV,getParentWindow:Xc,getScrollLeft:np,getScrollTop:Zc,getScrollableElement:Qc,getScrollbarWidth:Jt,getSelectionEndPosition:nW,getSelectionText:oW,getStyle:Ss,getTrimmingContainer:Ua,getWindowScrollLeft:Wa,getWindowScrollTop:ws,hasAccessToParentWindow:Mae,hasClass:xe,hasHorizontalScrollbar:aW,hasVerticalScrollbar:iW,index:tW,innerHeight:ho,innerWidth:Ac,isChildOf:mi,isDetached:xE,isInput:Jc,isOutsideInput:Ym,isVisible:bs,matchesCSSRules:xae,observeVisibilityChangeOnce:sW,offset:Ut,outerHeight:Pt,outerWidth:ht,overlayContainsElement:li,removeClass:Le,removeEvent:Nae,removeTextNodes:IE,resetCssTransform:Tv,selectElementIfAllowed:lW,setCaretPosition:Ev,setOverlayPosition:zm},Symbol.toStringTag,{value:"Module"}));var Fae=vm,Bae=CV;Fae("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Bae);var Vae=Gt,Wae=Pf,Uae=TypeError,zae=Object.getOwnPropertyDescriptor,Yae=Vae&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Gae=Yae?function(e,t){if(Wae(e)&&!zae(e,"length").writable)throw Uae("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Kae=$e,qae=Ir,Xae=ev,Zae=Ni,Qae=en,Jae=Gae,ele=mV,tle=A0,rle=Tf,Ew=RF,nle=yv,ole=nle("splice"),ile=Math.max,ale=Math.min;Kae({target:"Array",proto:!0,forced:!ole},{splice:function(t,r){var n=qae(this),o=Qae(n),i=Xae(t,o),a=arguments.length,l,s,u,f,c,h;for(a===0?l=s=0:a===1?(l=0,s=o-i):(l=a-2,s=ale(ile(Zae(r),0),o-i)),ele(o+l-s),u=tle(n,s),f=0;f<s;f++)c=i+f,c in n&&rle(u,f,n[c]);if(u.length=s,l<s){for(f=i;f<o-s;f++)c=f+s,h=f+l,c in n?n[h]=n[c]:Ew(n,h);for(f=o;f>o-s+l;f--)Ew(n,f-1)}else if(l>s)for(f=o-s;f>i;f--)c=f+s-1,h=f+l-1,c in n?n[h]=n[c]:Ew(n,h);for(f=0;f<l;f++)n[f+i]=arguments[f+2];return Jae(n,o-s+l),u}});function wt(){if(ve(console)){var e;(e=console).warn.apply(e,arguments)}}function DE(){if(ve(console)){var e;(e=console).error.apply(e,arguments)}}var lle=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",sle=TypeError,uW=function(e,t){if(e<t)throw sle("Not enough arguments");return e},fW=vt,ule=sl,fle=Rt,cle=lle,hle=tl,dle=mv,vle=uW,yle=fW.Function,gle=/MSIE .\./.test(hle)||cle&&function(){var e=fW.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),NE=function(e,t){var r=t?2:1;return gle?function(n,o){var i=vle(arguments.length,1)>r,a=fle(n)?n:yle(n),l=i?dle(arguments,r):[],s=i?function(){ule(a,this,l)}:a;return t?e(s,o):e(s)}:e},ple=$e,cW=vt,mle=NE,mA=mle(cW.setInterval,!0);ple({global:!0,bind:!0,forced:cW.setInterval!==mA},{setInterval:mA});var ble=$e,hW=vt,wle=NE,bA=wle(hW.setTimeout,!0);ble({global:!0,bind:!0,forced:hW.setTimeout!==bA},{setTimeout:bA});var Sle=$e,Cle=Ye,_le=Pf,Ole=Cle([].reverse),wA=[1,2];Sle({target:"Array",proto:!0,forced:String(wA)===String(wA.reverse())},{reverse:function(){return _le(this)&&(this.length=this.length),Ole(this)}});function mt(e){return typeof e=="function"}function dW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,s),r=0,o=void 0},h)),n}return i}function Rle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=dW(e,t),o=r;function i(){o=r}function a(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return o?(o-=1,e.apply(this,s)):n.apply(this,s)}return a.clearHits=i,a}function HE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,l)},t),n}return o}function Ele(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return Ft(o,function(u,f){return f(u)},n.apply(this,l))}}function LE(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e.apply(this,r.concat(a))}}function vW(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function Tle(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var s=n.concat(a.reverse()),u;return s.length>=t?u=e.apply(this,s):u=r(s),u}}return r([])}function op(e,t,r,n,o,i,a,l){return ve(l)?e.call(t,r,n,o,i,a,l):ve(a)?e.call(t,r,n,o,i,a):ve(i)?e.call(t,r,n,o,i):ve(o)?e.call(t,r,n,o):ve(n)?e.call(t,r,n):ve(r)?e.call(t,r):e.call(t)}const Ple=Object.freeze(Object.defineProperty({__proto__:null,curry:vW,curryRight:Tle,debounce:HE,fastCall:op,isFunction:mt,partial:LE,pipe:Ele,throttle:dW,throttleAfterHits:Rle},Symbol.toStringTag,{value:"Module"}));function eh(e){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eh(e)}var SA;function kle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ale(n.key),n)}}function $le(e,t,r){return t&&CA(e.prototype,t),r&&CA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ale(e){var t=Ile(e,"string");return eh(t)==="symbol"?t:String(t)}function Ile(e,t){if(eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mle(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var wl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],xle=dt(SA||(SA=Mle([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Tw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Pw=new Map([]),yW=function(){function e(){kle(this,e),this.globalBucket=this.createEmptyBucket()}return $le(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return A(wl,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))A(n,function(s){return o.add(r,s,i)});else{Tw.has(r)&&wt(AE(xle,{hookName:r,removedInVersion:Tw.get(r)})),Pw.has(r)&&wt(Pw.get(r));var a=this.getBucket(i);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var l=!1;n.initialHook&&A(a[r],function(s,u){if(s.initialHook)return a[r][u]=n,l=!0,!1}),l||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?A(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]<"u"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,l,s,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=op(f[h],r,o,i,a,l,s,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],y=v?v.length:0,m=0;if(y)for(;m<y;){if(!v[m]||v[m].skip){m+=1;continue}var w=op(v[m],r,o,i,a,l,s,u);w!==void 0&&(o=w),v[m]&&v[m].runOnce&&this.remove(n,v[m],r),m+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ze(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||wl.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&wl.splice(wl.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Pw.has(r)||Tw.has(r)}},{key:"isRegistered",value:function(r){return wl.indexOf(r)>=0}},{key:"getRegistered",value:function(){return wl}}],[{key:"getSingleton",value:function(){return Nle()}}]),e}(),Dle=new yW;function Nle(){return Dle}const ge=yW;function _A(e){return Fle(e)||jle(e)||Lle(e)||Hle()}function Hle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lle(e,t){if(e){if(typeof e=="string")return r_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r_(e,t)}}function jle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fle(e){if(Array.isArray(e))return r_(e)}function r_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var kw=new Map;function on(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";kw.has(e)||kw.set(e,new Map);var t=kw.get(e);function r(l,s){t.set(l,s)}function n(l){return t.get(l)}function o(l){return t.has(l)}function i(){return _A(t.keys())}function a(){return _A(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var n_=new WeakMap,Pv=on("editors"),Ble=Pv.register,gW=Pv.getItem,pW=Pv.hasItem,Vle=Pv.getNames;Pv.getValues;function Wle(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ge.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function mW(e,t){var r;if(typeof e=="function")n_.get(e)||Pr(null,e),r=n_.get(e);else if(typeof e=="string")r=gW(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function ip(e){if(typeof e=="function")return e;if(!pW(e))throw Error('No registered editor found under "'.concat(e,'" name'));return gW(e).getConstructor()}function Pr(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new Wle(t);typeof e=="string"&&Ble(e,r),n_.set(t,r)}function th(e){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(e)}function Ule(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yle(n.key),n)}}function zle(e,t,r){return t&&OA(e.prototype,t),r&&OA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yle(e){var t=Gle(e,"string");return th(t)==="symbol"?t:String(t)}function Gle(e,t){if(th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yg=0,Kle=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ule(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return zle(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function l(s){o.call(this,qle(s))}return typeof a!="boolean"&&!XV()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:l,options:a,eventManager:this}),r.addEventListener(n,l,a),yg+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,l;a;)if(a-=1,l=this.context.eventListeners[a],l.event===n&&l.element===r){if(o&&o!==l.callback||i&&l.eventManager!==this)continue;this.context.eventListeners.splice(a,1),l.element.removeEventListener(l.event,l.callbackProxy,l.options),yg-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),yg-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},l;o.createEvent?(l=o.createEvent("MouseEvents"),l.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):l=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(l):r.fireEvent("on".concat(n),l)}}]),e}();function qle(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),wn(this)},e}const kt=Kle;function Xle(){return yg}function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}function Zle(e,t){return tse(e)||ese(e,t)||Jle(e,t)||Qle()}function Qle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jle(e,t){if(e){if(typeof e=="string")return RA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RA(e,t)}}function RA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ese(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tse(e){if(Array.isArray(e))return e}function rse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ose(n.key),n)}}function nse(e,t,r){return t&&EA(e.prototype,t),r&&EA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ose(e){var t=ise(e,"string");return rh(t)==="symbol"?t:String(t)}function ise(e,t){if(rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gm="editorManager.navigation",Ic="editorManager.handlingEditor",o_=function(){function e(t,r,n){var o=this;rse(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new kt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,l,s){return o.onCellDblClick(a,l,s)})}return nse(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),o=n.getContext("grid"),i=n.getContext("editor"),a={group:Ic};i.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(s,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),o.addShortcuts([{keys:[["F2"]],callback:function(s){r.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(s,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,s,!0):r.moveSelectionAfterEnter(u.includes("shift")),wn(s)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),l=o,s=i;if(Array.isArray(a)){var u=Zle(a,2);l=u[0],s=u[1]}this.cellProperties=this.instance.getCellMeta(l,s);var f=this.instance.rootDocument.activeElement;if(f&&Ym(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(o,i,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(s),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(l),s);this.activeEditor=mW(h,this.instance),this.activeEditor.prepare(o,i,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var i=this.instance.getSelectedRangeLast().highlight,a=i.row,l=i.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(l);this.instance.view.scrollViewport(this.instance._createCellCoords(s,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,o=n.row,i=n.col,a=this.instance,l=a.rowIndexMapper,s=a.columnIndexMapper,u=l.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var o=r.keyCode;if(this.selection.isSelected()){var i=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!RE(o)&&!BV(o)&&!i&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),l=a.getContext("editor"),s={runOnlyIf:function(){return ve(n.instance.getSelected())},group:Gm};l.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],s),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),TA=new WeakMap;o_.getInstance=function(e,t,r){var n=TA.get(e);return n||(n=new o_(e,t,r),TA.set(e,n)),n};const ase=o_;var lse="hooksRefRegisterer",bW={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;A(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;ze(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Kn(bW,"MIXIN_NAME",lse,{writable:!1,enumerable:!1});const sse=bW;function Cs(e){"@babel/helpers - typeof";return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cs(e)}function use(e,t){return dse(e)||hse(e,t)||cse(e,t)||fse()}function fse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cse(e,t){if(e){if(typeof e=="string")return PA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PA(e,t)}}function PA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dse(e){if(Array.isArray(e))return e}function vse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i_(e,t)}function i_(e,t){return i_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},i_(e,t)}function yse(e){var t=mse();return function(){var n=ap(e),o;if(t){var i=ap(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gse(this,o)}}function gse(e,t){if(t&&(Cs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pse(e)}function pse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ap(e){return ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ap(e)}function kA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bse(n.key),n)}}function AA(e,t,r){return t&&$A(e.prototype,t),r&&$A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bse(e){var t=wse(e,"string");return Cs(t)==="symbol"?t:String(t)}function wse(e,t){if(Cs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sse="base",tr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),a_="baseEditor",Mf=function(){function e(t){kA(this,e),this.hot=t,this.instance=t,this.state=tr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return AA(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,l){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=l,this.state=tr.VIRGIN}},{key:"extend",value:function(){return function(r){vse(o,r);var n=yse(o);function o(){return kA(this,o),n.apply(this,arguments)}return AA(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o=this,i,a,l,s;if(n){var u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),l=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];i=f[0],a=f[1],l=f[2],s=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",i,a);if(Array.isArray(c)){var h=use(c,2);i=h[0],a=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),y={runOnlyIf:function(){return ve(o.hot.getSelected())},group:a_};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){o.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){o.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){o.hot.selection.transformStart(0,-1*o.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){o.hot.selection.transformStart(0,o.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(i,a,r,l,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===tr.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,a)),this.state=tr.EDITING,this.isInFullEditMode()){var l=typeof r=="string"?r:Dt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var l=this._closeCallback;this._closeCallback=function(c){l&&l(c),o(c),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),u=s.getContext("editor");if(u.removeShortcutsByGroup(a_),u.removeShortcutsByGroup(Gm),this.state===tr.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===tr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:a=[[f]],this.state=tr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){i.state=tr.FINISHED,i.discardEditor(c)}):(this.state=tr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=tr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===tr.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=tr.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=tr.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===tr.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var o=this.hot.view._wt,i=o.wtOverlays,a=o.wtViewport,l=this.hot.rootWindow,s=Ut(n),u=ht(n),f=Ut(this.hot.rootElement),c=ht(this.hot.rootElement),h=i.topOverlay.holder,d=i.inlineStartOverlay.holder,v=h!==l?h.scrollTop:0,y=d!==l?d.scrollLeft:0,m=l.innerWidth-f.left-c,w=(r=i.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=w.wtTable,C=S.name,k=["master","inline_start"].includes(C)?v:0,_=["master","top","bottom"].includes(C)?y:0,N=s.top===f.top?0:1,V=s.top-f.top-N-k,X=0;this.hot.isRtl()?X=l.innerWidth-s.left-u-m-1+_:X=s.left-f.left-1-_,["top","top_inline_start_corner"].includes(C)&&(V+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(X+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));var Y=this.hot.hasColHeaders(),q=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ne=this.hot.rowIndexMapper.getRenderableIndexesLength(),J=ne-this.hot.view._wt.getSetting("fixedRowsBottom");(Y&&q<=0||q===J)&&(V+=1),Q<=0&&(X+=1);var ue=a.rowsRenderCalculator.startPosition,he=a.columnsRenderCalculator.startPosition,Oe=Math.abs(i.inlineStartOverlay.getScrollPosition()),we=i.topOverlay.getScrollPosition(),$=Jt(this.hot.rootDocument),P=n.offsetTop+ue-we,g=0;if(this.hot.isRtl()){var p=n.offsetLeft;p>=0?g=S.getWidth()-n.offsetLeft:g=Math.abs(p),g+=he-Oe-u}else g=n.offsetLeft+he-Oe;var b=Ii(this.TD,this.hot.rootWindow),E=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",R=parseInt(b[E],10)>0?0:1,B=parseInt(b.borderTopWidth,10)>0?0:1,x=ht(n)+R,K=Pt(n)+B,Z=iW(h)?$:0,re=aW(d)?$:0,ie=this.hot.view.maximumVisibleElementWidth(g)-Z+R,se=Math.max(this.hot.view.maximumVisibleElementHeight(P)-re+B,23);return{top:V,start:X,height:K,maxHeight:se,width:x,maxWidth:ie}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return Sse}}]),e}();gt(Mf,sse);var Cse=$e,_se=ll.map,Ose=yv,Rse=Ose("map");Cse({target:"Array",proto:!0,forced:!Rse},{map:function(t){return _se(this,t,arguments.length>1?arguments[1]:void 0)}});function Ese(e){return $se(e)||kse(e)||Pse(e)||Tse()}function Tse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pse(e,t){if(e){if(typeof e=="string")return l_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l_(e,t)}}function kse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $se(e){if(Array.isArray(e))return l_(e)}function l_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s_(e){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function wr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=s_(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(Ese(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function wW(e){return wr(e,[","])}function Ce(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function lp(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function jE(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const Ase=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:wr,isNumericLike:wW,rangeEach:Ce,rangeEachReverse:lp,valueAccordingPercent:jE},Symbol.toStringTag,{value:"Module"}));function Ise(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,y){d.addEventListener(v,y,!1)},a=function(d,v,y){d.removeEventListener(v,y,!1)},l=function(d){var v,y;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.position="absolute",o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",y=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>y?t.style.height=e.minHeight+"px":e.maxHeight<y?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=y+"px"},s=function(){window.setTimeout(l,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var y=parseInt(d.maxHeight);isNaN(y)||(e.maxHeight=y)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var m=parseInt(d.minWidth);isNaN(m)||(e.minWidth=m)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var w=parseInt(d.maxWidth);isNaN(w)||(e.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,y){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),y&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,y){f(d,v,y)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function IA(e,t){for(var r=ME(t),n=t.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var l=n[a];a!==0&&(i+=n[a-1].length+1);var s=i+l.length;if(e==="home"?o=i:e==="end"&&(o=s),r<=s)break}Ev(t,o)}function _s(e){"@babel/helpers - typeof";return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(e)}function MA(e,t){return Nse(e)||Dse(e,t)||xse(e,t)||Mse()}function Mse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xse(e,t){if(e){if(typeof e=="string")return xA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xA(e,t)}}function xA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Nse(e){if(Array.isArray(e))return e}function Hse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jse(n.key),n)}}function Lse(e,t,r){return t&&DA(e.prototype,t),r&&DA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jse(e){var t=Fse(e,"string");return _s(t)==="symbol"?t:String(t)}function Fse(e,t){if(_s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mc(){return typeof Reflect<"u"&&Reflect.get?Mc=Reflect.get.bind():Mc=function(t,r,n){var o=Bse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mc.apply(this,arguments)}function Bse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=za(e),e!==null););return e}function Vse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u_(e,t)}function u_(e,t){return u_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u_(e,t)}function Wse(e){var t=zse();return function(){var n=za(e),o;if(t){var i=za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Use(this,o)}}function Use(e,t){if(t&&(_s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SW(e)}function SW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function za(e){return za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},za(e)}var Yse="ht_editor_visible",yy="ht_editor_hidden",NA="textEditor",Gse="text",cl=function(e){Vse(r,e);var t=Wse(r);function r(n){var o;return Hse(this,r),o=t.call(this,n),o.eventManager=new kt(SW(o)),o.autoResize=Ise(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return Lse(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement();var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this.state;if(Mc(za(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==tr.FINISHED&&this.hideEditableElement();var d=!h;d&&!pn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===tr.VIRGIN&&(this.TEXTAREA.value="",Mc(za(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),Ev(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),xe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,yy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(LV()||HV())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,yy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Ce(o.length-1,function(a){var l=o[a];if(xe(l,"handsontableEditor"))return i=!0,!1}),xe(this.TEXTAREA_PARENT,yy)&&Le(this.TEXTAREA_PARENT,yy),i?(this.layerClass=Yse,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==tr.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.getEditedCellRect(),a=i.top,l=i.start,s=i.width,u=i.maxWidth,f=i.height,c=i.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(l,"px"),this.showEditableElement();var h=Ii(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ii(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),y=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),m=s-v,w=f-y,S=u-v,C=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,S),minHeight:Math.min(w,C),maxWidth:S,maxHeight:C},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),_E()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={runOnlyIf:function(){return ve(o.hot.getSelected())},group:NA},s=function(){o.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=o.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;o.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(f){return!o.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:Ic,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!o.hot.selection.isMultiple()},relativeToGroup:Ic,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:Ic,position:"before"},{keys:[["PageUp"]],callback:function(){o.hot.selection.transformStart(-o.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){o.hot.selection.transformStart(o.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=MA(c,1),d=h[0];IA(d,o.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=MA(c,1),d=h[0];IA(d,o.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){o.hot._registerTimeout(function(){o.autoResize.resize()},10)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(Gm),i.removeShortcutsByGroup(NA),i.removeShortcutsByGroup(a_)}},{key:"onAfterDocumentKeyDown",value:function(o){var i=[me.ARROW_UP,me.ARROW_RIGHT,me.ARROW_DOWN,me.ARROW_LEFT];i.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return Gse}}]),r}(Mf);function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function Kse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xse(n.key),n)}}function qse(e,t,r){return t&&HA(e.prototype,t),r&&HA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xse(e){var t=Zse(e,"string");return Os(t)==="symbol"?t:String(t)}function Zse(e,t){if(Os(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Os(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hn(){return typeof Reflect<"u"&&Reflect.get?hn=Reflect.get.bind():hn=function(t,r,n){var o=Qse(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hn.apply(this,arguments)}function Qse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fr(e),e!==null););return e}function Jse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f_(e,t)}function f_(e,t){return f_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},f_(e,t)}function eue(e){var t=nue();return function(){var n=Fr(e),o;if(t){var i=Fr(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tue(this,o)}}function tue(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rue(e)}function rue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fr(e)}var LA="handsontableEditor",oue="handsontable",FE=function(e){Jse(r,e);var t=eue(r);function r(){return Kse(this,r),t.apply(this,arguments)}return qse(r,[{key:"open",value:function(){hn(Fr(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Ev(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),hn(Fr(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,l,s,u){hn(Fr(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var y=this.getSourceData(v.row,v.col);y!==void 0&&f.setValue(y),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&zt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||hn(Fr(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){hn(Fr(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var l=this.htEditor.getInstance().getValue();l!==void 0&&this.setValue(l)}hn(Fr(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor");hn(Fr(r.prototype),"registerShortcuts",this).call(this);var l={group:LA,relativeToGroup:Gm,position:"before"},s=function(f,c){var h=o.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),wn(c),o.hot.listen(),o.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),s(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=o.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return s(h,f)},preventDefault:!1}],l)}},{key:"unregisterShortcuts",value:function(){hn(Fr(r.prototype),"unregisterShortcuts",this).call(this);var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(LA)}}],[{key:"EDITOR_TYPE",get:function(){return oue}}]),r}(cl),iue="base";function xf(e,t,r,n,o,i,a){var l=[],s=[];a.className&&te(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Le(t,s),te(t,l)}xf.RENDERER_TYPE=iue;var aue="text";function Hi(e,t,r,n,o,i,a){xf.apply(this,[e,t,r,n,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Dt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Cn(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(r),t.appendChild(s)}else Ai(t,l)}Hi.RENDERER_TYPE=aue;function Rs(e){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rs(e)}function lue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CW(n.key),n)}}function sue(e,t,r){return t&&jA(e.prototype,t),r&&jA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,r,n){var o=uue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ha.apply(this,arguments)}function uue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function fue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c_(e,t)}function c_(e,t){return c_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},c_(e,t)}function cue(e){var t=due();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hue(this,o)}}function hue(e,t){if(t&&(Rs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h_(e)}function h_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function due(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}function vue(e,t,r){return t=CW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CW(e){var t=yue(e,"string");return Rs(t)==="symbol"?t:String(t)}function yue(e,t){if(Rs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $w=new WeakMap,gue="autocomplete",BE=function(e){fue(r,e);var t=cue(r);function r(n){var o;return lue(this,r),o=t.call(this,n),vue(h_(o),"sortByRelevance",function(i,a,l){var s=[],u=[],f=i.length,c=a.length,h,d,v,y;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=XC(Dt(a[v])),l)y=d.indexOf(i);else{var m=this.cellProperties.locale;y=d.toLocaleLowerCase(m).indexOf(i.toLocaleLowerCase(m))}y!==-1&&(h=d.length-y-f,s.push({baseIndex:v,index:y,charsLeft:h,value:d}))}for(s.sort(function(w,S){if(S.index===-1)return-1;if(w.index===-1)return 1;if(w.index<S.index)return-1;if(S.index<w.index)return 1;if(w.index===S.index){if(w.charsLeft<S.charsLeft)return-1;if(w.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=s.length;v<c;v++)u.push(s[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],$w.set(h_(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return sue(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var l=o.stripValueIfNeeded(a);return l===o.TEXTAREA.value});return ve(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){ha(vo(r.prototype),"createElements",this).call(this),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=$w.get(this);ha(vo(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),l=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=Jt();s===0&&i.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(u){return o.onBeforeKeyDown(u)}),a.updateSettings({colWidths:l?[ht(this.TEXTAREA)-2]:void 0,width:l?ht(this.TEXTAREA)+s:void 0,renderer:function(f,c,h,d,v,y,m){Hi(f,c,h,d,v,y,m);var w=o.cellProperties,S=w.filteringCaseSensitive,C=w.allowHtml,k=w.locale,_=o.query,N=Dt(y),V,X;N&&!C&&(V=S===!0?N.indexOf(_):N.toLocaleLowerCase(k).indexOf(_.toLocaleLowerCase(k)),V!==-1&&(X=N.substr(V,_.length),N=N.replace(X,"<strong>".concat(X,"</strong>")))),c.innerHTML=N},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),ha(vo(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){ha(vo(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(l){i.rawChoices=l,i.updateChoicesList(i.stripValuesIfNeeded(l))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=ME(this.TEXTAREA),a=nW(this.TEXTAREA),l=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,u=null,f=null,c=o;l&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(s===!1)h&&(f=u[0]);else{for(var d=[],v=0,y=c.length;v<y&&!(l&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Pc([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),Ev(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Ua(this.hot.view._wt.wtTable.TABLE),i=o===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(i||!i&&(a||a==="horizontal"))return!1;var l=Ut(this.TEXTAREA),s=Pt(this.TEXTAREA),u=this.getDropdownHeight(),f=o.scrollTop,c=Pt(this.hot.view._wt.wtTable.THEAD),h=Ut(o),d=l.top-h.top-c+f,v=o.scrollHeight-d-c-s,y=u>v&&d>v;return y?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(y?d:v,u),y}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,l=0,s=0,u=null;do s=this.htEditor.getRowHeight(l)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=s,l+=1;while(a<o);u=a-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-s)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=We(o,function(s){return Dt(s)}),l=We(a,function(s){return i?s:XC(s)});return l}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},l=!1;return o===me.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(l=!0),o===me.ARROW_UP&&a.row>-1&&(l=!0),l}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=$w.get(this);if(a.skipOne=!1,FV(o.keyCode)||o.keyCode===me.BACKSPACE||o.keyCode===me.DELETE||o.keyCode===me.INSERT){var l=10;if(o.keyCode===me.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(l+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},l)}}}],[{key:"EDITOR_TYPE",get:function(){return gue}}]),r}(FE);function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function pue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bue(n.key),n)}}function mue(e,t,r){return t&&FA(e.prototype,t),r&&FA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bue(e){var t=wue(e,"string");return Es(t)==="symbol"?t:String(t)}function wue(e,t){if(Es(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Es(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d_(e,t)}function d_(e,t){return d_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},d_(e,t)}function Cue(e){var t=Rue();return function(){var n=sp(e),o;if(t){var i=sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _ue(this,o)}}function _ue(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oue(e)}function Oue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sp(e){return sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sp(e)}var Eue="checkbox",_W=function(e){Sue(r,e);var t=Cue(r);function r(){return pue(this,r),t.apply(this,arguments)}return mue(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');xe(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return Eue}}]),r}(Mf),OW={exports:{}};const Tue=HY(_ne);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=Tue}catch{}e.exports=n(o)}})(Jy,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,l=function($,P,g,p){o?$.addEventListener(P,g,!!p):$.attachEvent("on"+P,g)},s=function($,P,g,p){o?$.removeEventListener(P,g,!!p):$.detachEvent("on"+P,g)},u=function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},f=function($,P){return(" "+$.className+" ").indexOf(" "+P+" ")!==-1},c=function($,P){f($,P)||($.className=$.className===""?P:$.className+" "+P)},h=function($,P){$.className=u((" "+$.className+" ").replace(" "+P+" "," "))},d=function($){return/Array/.test(Object.prototype.toString.call($))},v=function($){return/Date/.test(Object.prototype.toString.call($))&&!isNaN($.getTime())},y=function($){var P=$.getDay();return P===0||P===6},m=function($){return $%4===0&&$%100!==0||$%400===0},w=function($,P){return[31,m($)?29:28,31,30,31,30,31,31,30,31,30,31][P]},S=function($){v($)&&$.setHours(0,0,0,0)},C=function($,P){return $.getTime()===P.getTime()},k=function($,P,g){var p,b;for(p in P)b=$[p]!==void 0,b&&typeof P[p]=="object"&&P[p]!==null&&P[p].nodeName===void 0?v(P[p])?g&&($[p]=new Date(P[p].getTime())):d(P[p])?g&&($[p]=P[p].slice(0)):$[p]=k({},P[p],g):(g||!b)&&($[p]=P[p]);return $},_=function($,P,g){var p;i.createEvent?(p=i.createEvent("HTMLEvents"),p.initEvent(P,!0,!1),p=k(p,g),$.dispatchEvent(p)):i.createEventObject&&(p=i.createEventObject(),p=k(p,g),$.fireEvent("on"+P,p))},N=function($){return $.month<0&&($.year-=Math.ceil(Math.abs($.month)/12),$.month+=12),$.month>11&&($.year+=Math.floor(Math.abs($.month)/12),$.month-=12),$},V={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},X=function($,P,g){for(P+=$.firstDay;P>=7;)P-=7;return g?$.i18n.weekdaysShort[P]:$.i18n.weekdays[P]},Y=function($){var P=[],g="false";if($.isEmpty)if($.showDaysInNextAndPreviousMonths)P.push("is-outside-current-month"),$.enableSelectionDaysInNextAndPreviousMonths||P.push("is-selection-disabled");else return'<td class="is-empty"></td>';return $.isDisabled&&P.push("is-disabled"),$.isToday&&P.push("is-today"),$.isSelected&&(P.push("is-selected"),g="true"),$.hasEvent&&P.push("has-event"),$.isInRange&&P.push("is-inrange"),$.isStartRange&&P.push("is-startrange"),$.isEndRange&&P.push("is-endrange"),'<td data-day="'+$.day+'" class="'+P.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+$.year+'" data-pika-month="'+$.month+'" data-pika-day="'+$.day+'">'+$.day+"</button></td>"},q=function($,P){$.setHours(0,0,0,0);var g=$.getDate(),p=$.getDay(),b=P,E=b-1,R=7,B=function(ie){return(ie+R-1)%R};$.setDate(g+E-B(p));var x=new Date($.getFullYear(),0,b),K=24*60*60*1e3,Z=($.getTime()-x.getTime())/K,re=1+Math.round((Z-E+B(x.getDay()))/R);return re},Q=function($,P,g,p){var b=new Date(g,P,$),E=n?r(b).isoWeek():q(b,p);return'<td class="pika-week">'+E+"</td>"},ne=function($,P,g,p){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(P?$.reverse():$).join("")+"</tr>"},J=function($){return"<tbody>"+$.join("")+"</tbody>"},ue=function($){var P,g=[];for($.showWeekNumber&&g.push("<th></th>"),P=0;P<7;P++)g.push('<th scope="col"><abbr title="'+X($,P)+'">'+X($,P,!0)+"</abbr></th>");return"<thead><tr>"+($.isRTL?g.reverse():g).join("")+"</tr></thead>"},he=function($,P,g,p,b,E){var R,B,x,K=$._o,Z=g===K.minYear,re=g===K.maxYear,ie='<div id="'+E+'" class="pika-title" role="heading" aria-live="assertive">',se,_e,Se=!0,z=!0;for(x=[],R=0;R<12;R++)x.push('<option value="'+(g===b?R-P:12+R-P)+'"'+(R===p?' selected="selected"':"")+(Z&&R<K.minMonth||re&&R>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[R]+"</option>");for(se='<div class="pika-label">'+K.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+x.join("")+"</select></div>",d(K.yearRange)?(R=K.yearRange[0],B=K.yearRange[1]+1):(R=g-K.yearRange,B=1+g+K.yearRange),x=[];R<B&&R<=K.maxYear;R++)R>=K.minYear&&x.push('<option value="'+R+'"'+(R===g?' selected="selected"':"")+">"+R+"</option>");return _e='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+x.join("")+"</select></div>",K.showMonthAfterYear?ie+=_e+se:ie+=se+_e,Z&&(p===0||K.minMonth>=p)&&(Se=!1),re&&(p===11||K.maxMonth<=p)&&(z=!1),P===0&&(ie+='<button class="pika-prev'+(Se?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),P===$._o.numberOfMonths-1&&(ie+='<button class="pika-next'+(z?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),ie+="</div>"},Oe=function($,P,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ue($)+J(P)+"</table>"},we=function($){var P=this,g=P.config($);P._onMouseDown=function(b){if(P._v){b=b||window.event;var E=b.target||b.srcElement;if(E)if(f(E,"is-disabled")||(f(E,"pika-button")&&!f(E,"is-empty")&&!f(E.parentNode,"is-disabled")?(P.setDate(new Date(E.getAttribute("data-pika-year"),E.getAttribute("data-pika-month"),E.getAttribute("data-pika-day"))),g.bound&&a(function(){P.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):f(E,"pika-prev")?P.prevMonth():f(E,"pika-next")&&P.nextMonth()),f(E,"pika-select"))P._c=!0;else if(b.preventDefault)b.preventDefault();else return b.returnValue=!1,!1}},P._onChange=function(b){b=b||window.event;var E=b.target||b.srcElement;E&&(f(E,"pika-select-month")?P.gotoMonth(E.value):f(E,"pika-select-year")&&P.gotoYear(E.value))},P._onKeyChange=function(b){if(b=b||window.event,P.isVisible())switch(b.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:P.adjustDate("subtract",1);break;case 38:P.adjustDate("subtract",7);break;case 39:P.adjustDate("add",1);break;case 40:P.adjustDate("add",7);break;case 8:case 46:P.setDate(null);break}},P._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var b=r(g.field.value,g.format,g.formatStrict);return b&&b.isValid()?b.toDate():null}else return new Date(Date.parse(g.field.value))},P._onInputChange=function(b){var E;b.firedBy!==P&&(E=P._parseFieldValue(),v(E)&&P.setDate(E),P._v||P.show())},P._onInputFocus=function(){P.show()},P._onInputClick=function(){P.show()},P._onInputBlur=function(){var b=i.activeElement;do if(f(b,"pika-single"))return;while(b=b.parentNode);P._c||(P._b=a(function(){P.hide()},50)),P._c=!1},P._onClick=function(b){b=b||window.event;var E=b.target||b.srcElement,R=E;if(E){!o&&f(E,"pika-select")&&(E.onchange||(E.setAttribute("onchange","return;"),l(E,"change",P._onChange)));do if(f(R,"pika-single")||R===g.trigger)return;while(R=R.parentNode);P._v&&E!==g.trigger&&R!==g.trigger&&P.hide()}},P.el=i.createElement("div"),P.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),l(P.el,"mousedown",P._onMouseDown,!0),l(P.el,"touchend",P._onMouseDown,!0),l(P.el,"change",P._onChange),g.keyboardInput&&l(i,"keydown",P._onKeyChange),g.field&&(g.container?g.container.appendChild(P.el):g.bound?i.body.appendChild(P.el):g.field.parentNode.insertBefore(P.el,g.field.nextSibling),l(g.field,"change",P._onInputChange),g.defaultDate||(g.defaultDate=P._parseFieldValue(),g.setDefaultDate=!0));var p=g.defaultDate;v(p)?g.setDefaultDate?P.setDate(p,!0):P.gotoDate(p):P.gotoDate(new Date),g.bound?(this.hide(),P.el.className+=" is-bound",l(g.trigger,"click",P._onInputClick),l(g.trigger,"focus",P._onInputFocus),l(g.trigger,"blur",P._onInputBlur)):this.show()};return we.prototype={config:function($){this._o||(this._o=k({},V,!0));var P=k(this._o,$,!0);P.isRTL=!!P.isRTL,P.field=P.field&&P.field.nodeName?P.field:null,P.theme=typeof P.theme=="string"&&P.theme?P.theme:null,P.bound=!!(P.bound!==void 0?P.field&&P.bound:P.field),P.trigger=P.trigger&&P.trigger.nodeName?P.trigger:P.field,P.disableWeekends=!!P.disableWeekends,P.disableDayFn=typeof P.disableDayFn=="function"?P.disableDayFn:null;var g=parseInt(P.numberOfMonths,10)||1;if(P.numberOfMonths=g>4?4:g,v(P.minDate)||(P.minDate=!1),v(P.maxDate)||(P.maxDate=!1),P.minDate&&P.maxDate&&P.maxDate<P.minDate&&(P.maxDate=P.minDate=!1),P.minDate&&this.setMinDate(P.minDate),P.maxDate&&this.setMaxDate(P.maxDate),d(P.yearRange)){var p=new Date().getFullYear()-10;P.yearRange[0]=parseInt(P.yearRange[0],10)||p,P.yearRange[1]=parseInt(P.yearRange[1],10)||p}else P.yearRange=Math.abs(parseInt(P.yearRange,10))||V.yearRange,P.yearRange>100&&(P.yearRange=100);return P},toString:function($){return $=$||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,$):n?r(this._d).format($):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function($,P){n&&r.isMoment($)&&this.setDate($.toDate(),P)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function($,P){if(!$)return this._d=null,this._o.field&&(this._o.field.value="",_(this._o.field,"change",{firedBy:this})),this.draw();if(typeof $=="string"&&($=new Date(Date.parse($))),!!v($)){var g=this._o.minDate,p=this._o.maxDate;v(g)&&$<g?$=g:v(p)&&$>p&&($=p),this._d=new Date($.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),_(this._o.field,"change",{firedBy:this})),!P&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function($){var P=!0;if(v($)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),b=$.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),P=b<g.getTime()||p.getTime()<b}P&&(this.calendars=[{month:$.getMonth(),year:$.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function($,P){var g=this.getDate()||new Date,p=parseInt(P)*24*60*60*1e3,b;$==="add"?b=new Date(g.valueOf()+p):$==="subtract"&&(b=new Date(g.valueOf()-p)),this.setDate(b)},adjustCalendars:function(){this.calendars[0]=N(this.calendars[0]);for(var $=1;$<this._o.numberOfMonths;$++)this.calendars[$]=N({month:this.calendars[0].month+$,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function($){isNaN($)||(this.calendars[0].month=parseInt($,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function($){isNaN($)||(this.calendars[0].year=parseInt($,10),this.adjustCalendars())},setMinDate:function($){$ instanceof Date?(S($),this._o.minDate=$,this._o.minYear=$.getFullYear(),this._o.minMonth=$.getMonth()):(this._o.minDate=V.minDate,this._o.minYear=V.minYear,this._o.minMonth=V.minMonth,this._o.startRange=V.startRange),this.draw()},setMaxDate:function($){$ instanceof Date?(S($),this._o.maxDate=$,this._o.maxYear=$.getFullYear(),this._o.maxMonth=$.getMonth()):(this._o.maxDate=V.maxDate,this._o.maxYear=V.maxYear,this._o.maxMonth=V.maxMonth,this._o.endRange=V.endRange),this.draw()},setStartRange:function($){this._o.startRange=$},setEndRange:function($){this._o.endRange=$},draw:function($){if(!(!this._v&&!$)){var P=this._o,g=P.minYear,p=P.maxYear,b=P.minMonth,E=P.maxMonth,R="",B;this._y<=g&&(this._y=g,!isNaN(b)&&this._m<b&&(this._m=b)),this._y>=p&&(this._y=p,!isNaN(E)&&this._m>E&&(this._m=E));for(var x=0;x<P.numberOfMonths;x++)B="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),R+='<div class="pika-lendar">'+he(this,x,this.calendars[x].year,this.calendars[x].month,this.calendars[0].year,B)+this.render(this.calendars[x].year,this.calendars[x].month,B)+"</div>";this.el.innerHTML=R,P.bound&&P.field.type!=="hidden"&&a(function(){P.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),P.bound&&P.field.setAttribute("aria-label",P.ariaLabel)}},adjustPosition:function(){var $,P,g,p,b,E,R,B,x,K,Z,re;if(!this._o.container){if(this.el.style.position="absolute",$=this._o.trigger,P=$,g=this.el.offsetWidth,p=this.el.offsetHeight,b=window.innerWidth||i.documentElement.clientWidth,E=window.innerHeight||i.documentElement.clientHeight,R=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Z=!0,re=!0,typeof $.getBoundingClientRect=="function")K=$.getBoundingClientRect(),B=K.left+window.pageXOffset,x=K.bottom+window.pageYOffset;else for(B=P.offsetLeft,x=P.offsetTop+P.offsetHeight;P=P.offsetParent;)B+=P.offsetLeft,x+=P.offsetTop;(this._o.reposition&&B+g>b||this._o.position.indexOf("right")>-1&&B-g+$.offsetWidth>0)&&(B=B-g+$.offsetWidth,Z=!1),(this._o.reposition&&x+p>E+R||this._o.position.indexOf("top")>-1&&x-p-$.offsetHeight>0)&&(x=x-p-$.offsetHeight,re=!1),this.el.style.left=B+"px",this.el.style.top=x+"px",c(this.el,Z?"left-aligned":"right-aligned"),c(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,Z?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function($,P,g){var p=this._o,b=new Date,E=w($,P),R=new Date($,P,1).getDay(),B=[],x=[];S(b),p.firstDay>0&&(R-=p.firstDay,R<0&&(R+=7));for(var K=P===0?11:P-1,Z=P===11?0:P+1,re=P===0?$-1:$,ie=P===11?$+1:$,se=w(re,K),_e=E+R,Se=_e;Se>7;)Se-=7;_e+=7-Se;for(var z=!1,Ne=0,Be=0;Ne<_e;Ne++){var ke=new Date($,P,1+(Ne-R)),Ie=v(this._d)?C(ke,this._d):!1,Ae=C(ke,b),O=p.events.indexOf(ke.toDateString())!==-1,T=Ne<R||Ne>=E+R,I=1+(Ne-R),F=P,M=$,W=p.startRange&&C(p.startRange,ke),H=p.endRange&&C(p.endRange,ke),D=p.startRange&&p.endRange&&p.startRange<ke&&ke<p.endRange,U=p.minDate&&ke<p.minDate||p.maxDate&&ke>p.maxDate||p.disableWeekends&&y(ke)||p.disableDayFn&&p.disableDayFn(ke);T&&(Ne<R?(I=se+I,F=K,M=re):(I=I-E,F=Z,M=ie));var j={day:I,month:F,year:M,hasEvent:O,isSelected:Ie,isToday:Ae,isDisabled:U,isEmpty:T,isStartRange:W,isEndRange:H,isInRange:D,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&Ie&&(z=!0),x.push(Y(j)),++Be===7&&(p.showWeekNumber&&x.unshift(Q(Ne-R,P,$,p.firstWeekOfYearMinDays)),B.push(ne(x,p.isRTL,p.pickWholeWeek,z)),x=[],Be=0,z=!1)}return Oe(p,B,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var $=this._v;$!==!1&&(this._o.bound&&s(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,$!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var $=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),$.keyboardInput&&s(i,"keydown",this._onKeyChange),$.field&&(s($.field,"change",this._onInputChange),$.bound&&(s($.trigger,"click",this._onInputClick),s($.trigger,"focus",this._onInputFocus),s($.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},we})})(OW);var Pue=OW.exports;const BA=aj(Pue);function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function kue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Aue(n.key),n)}}function $ue(e,t,r){return t&&VA(e.prototype,t),r&&VA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aue(e){var t=Iue(e,"string");return Ts(t)==="symbol"?t:String(t)}function Iue(e,t){if(Ts(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ts(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function so(){return typeof Reflect<"u"&&Reflect.get?so=Reflect.get.bind():so=function(t,r,n){var o=Mue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},so.apply(this,arguments)}function Mue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vn(e),e!==null););return e}function xue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v_(e,t)}function v_(e,t){return v_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},v_(e,t)}function Due(e){var t=Lue();return function(){var n=vn(e),o;if(t){var i=vn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nue(this,o)}}function Nue(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hue(e)}function Hue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vn(e){return vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vn(e)}var RW="date",WA="dateEditor",EW=function(e){xue(r,e);var t=Due(r);function r(n){var o;return kue(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return $ue(r,[{key:"init",value:function(){var o=this;if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof BA!="function")throw new Error("You need to include Pikaday to your project.");so(vn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){so(vn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new kt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,l,s,u){so(vn(r.prototype),"prepare",this).call(this,o,i,a,l,s,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=this.hot.getShortcutManager(),a=i.getContext("editor");so(vn(r.prototype),"open",this).call(this),this.showDatepicker(o),a.addShortcut({keys:[["Enter"]],callback:function(s){s.stopPropagation()},group:WA})}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()});var a=this.hot.getShortcutManager(),l=a.getContext("editor");l.removeShortcutsByGroup(WA),so(vn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}so(vn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,l=this.instance.view.isMouseDown(),s=o?RE(o.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new BA(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Pt(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=i.right-ht(this.datePicker):f=i.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!l&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ee(u,a,!0).isValid()&&this.$datePicker.setMoment(ee(u,a),!0),!s&&!l&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ov(a,this.cellProperties.datePickerConfig);var l=a.onSelect,s=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ee(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),l&&l()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),s&&s()},a}}],[{key:"EDITOR_TYPE",get:function(){return RW}}]),r}(cl);function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function jue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bue(n.key),n)}}function Fue(e,t,r){return t&&UA(e.prototype,t),r&&UA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bue(e){var t=Vue(e,"string");return Ps(t)==="symbol"?t:String(t)}function Vue(e,t){if(Ps(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ps(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gg(){return typeof Reflect<"u"&&Reflect.get?gg=Reflect.get.bind():gg=function(t,r,n){var o=Wue(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gg.apply(this,arguments)}function Wue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ks(e),e!==null););return e}function Uue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},y_(e,t)}function zue(e){var t=Kue();return function(){var n=ks(e),o;if(t){var i=ks(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Yue(this,o)}}function Yue(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gue(e)}function Gue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ks(e){return ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ks(e)}var que="dropdown",VE=function(e){Uue(r,e);var t=zue(r);function r(){return jue(this,r),t.apply(this,arguments)}return Fue(r,[{key:"prepare",value:function(o,i,a,l,s,u){gg(ks(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return que}}]),r}(BE);ge.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===VE&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function Xue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Que(n.key),n)}}function Zue(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Que(e){var t=Jue(e,"string");return $s(t)==="symbol"?t:String(t)}function Jue(e,t){if($s(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($s(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function efe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g_(e,t)}function g_(e,t){return g_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},g_(e,t)}function tfe(e){var t=ofe();return function(){var n=up(e),o;if(t){var i=up(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rfe(this,o)}}function rfe(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nfe(e)}function nfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ofe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function up(e){return up=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},up(e)}var ife="numeric",TW=function(e){efe(r,e);var t=tfe(r);function r(){return Xue(this,r),t.apply(this,arguments)}return Zue(r,null,[{key:"EDITOR_TYPE",get:function(){return ife}}]),r}(cl);function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function afe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sfe(n.key),n)}}function lfe(e,t,r){return t&&YA(e.prototype,t),r&&YA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sfe(e){var t=ufe(e,"string");return As(t)==="symbol"?t:String(t)}function ufe(e,t){if(As(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(As(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pg(){return typeof Reflect<"u"&&Reflect.get?pg=Reflect.get.bind():pg=function(t,r,n){var o=ffe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pg.apply(this,arguments)}function ffe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Is(e),e!==null););return e}function cfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},p_(e,t)}function hfe(e){var t=yfe();return function(){var n=Is(e),o;if(t){var i=Is(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dfe(this,o)}}function dfe(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vfe(e)}function vfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Is(e){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Is(e)}var gfe="password",PW=function(e){cfe(r,e);var t=hfe(r);function r(){return afe(this,r),t.apply(this,arguments)}return lfe(r,[{key:"createElements",value:function(){pg(Is(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Cn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return gfe}}]),r}(cl);function Ya(e){"@babel/helpers - typeof";return Ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ya(e)}function pfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bfe(n.key),n)}}function mfe(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bfe(e){var t=wfe(e,"string");return Ya(t)==="symbol"?t:String(t)}function wfe(e,t){if(Ya(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ya(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mg(){return typeof Reflect<"u"&&Reflect.get?mg=Reflect.get.bind():mg=function(t,r,n){var o=Sfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},mg.apply(this,arguments)}function Sfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ms(e),e!==null););return e}function Cfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m_(e,t)}function m_(e,t){return m_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},m_(e,t)}function _fe(e){var t=Efe();return function(){var n=Ms(e),o;if(t){var i=Ms(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ofe(this,o)}}function Ofe(e,t){if(t&&(Ya(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rfe(e)}function Rfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Efe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ms(e){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ms(e)}var Aw="ht_editor_visible",KA="selectEditor",Tfe="select",Pfe=function(e){Cfe(r,e);var t=_fe(r);function r(){return pfe(this,r),t.apply(this,arguments)}return mfe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",xe(this.select,Aw)&&Le(this.select,Aw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,l,s,u){var f=this;mg(Ms(r.prototype),"prepare",this).call(this,o,i,a,l,s,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),Cn(this.select),ze(h,function(d,v){var y=f.hot.rootDocument.createElement("OPTION");y.value=v,fl(y,d),f.select.appendChild(y)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,l=o.length;a<l;a++)i[o[a]]=o[a];else Ya(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===tr.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,l=o.width,s=o.height,u=this.select.style;u.height="".concat(s,"px"),u.width="".concat(l,"px"),u.top="".concat(i,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",te(this.select,Aw)}}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("editor"),l={group:KA};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=o.select.selectedIndex-1;u>=0&&(o.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=o.select.selectedIndex+1;u<=o.select.length-1&&(o.select[u].selected=!0)}}],l)}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("editor");i.removeShortcutsByGroup(KA)}}],[{key:"EDITOR_TYPE",get:function(){return Tfe}}]),r}(Mf);function xs(e){"@babel/helpers - typeof";return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xs(e)}function kfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Afe(n.key),n)}}function $fe(e,t,r){return t&&qA(e.prototype,t),r&&qA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Afe(e){var t=Ife(e,"string");return xs(t)==="symbol"?t:String(t)}function Ife(e,t){if(xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bg(){return typeof Reflect<"u"&&Reflect.get?bg=Reflect.get.bind():bg=function(t,r,n){var o=Mfe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bg.apply(this,arguments)}function Mfe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ds(e),e!==null););return e}function xfe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b_(e,t)}function b_(e,t){return b_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},b_(e,t)}function Dfe(e){var t=Lfe();return function(){var n=Ds(e),o;if(t){var i=Ds(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nfe(this,o)}}function Nfe(e,t){if(t&&(xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hfe(e)}function Hfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ds(e){return Ds=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ds(e)}var jfe="time",kW=function(e){xfe(r,e);var t=Dfe(r);function r(){return kfe(this,r),t.apply(this,arguments)}return $fe(r,[{key:"prepare",value:function(o,i,a,l,s,u){bg(Ds(r.prototype),"prepare",this).call(this,o,i,a,l,s,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return jfe}}]),r}(cl);function Ffe(){Pr(Mf),Pr(BE),Pr(_W),Pr(EW),Pr(VE),Pr(FE),Pr(TW),Pr(PW),Pr(Pfe),Pr(cl),Pr(kW)}var Bfe="html";function WE(e,t,r,n,o,i,a){xf.apply(this,[e,t,r,n,o,i,a]),fl(t,i??"",!1)}WE.RENDERER_TYPE=Bfe;var Vfe="autocomplete";function Df(e,t,r,n,o,i,a){var l=e.rootDocument,s=a.allowHtml?WE:Hi,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),te(t,"htAutocomplete"),!e.acArrowListener){var f=new kt(e);e.acArrowListener=function(c){xe(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Df.RENDERER_TYPE=Vfe;var XA=new WeakMap,ZA=new WeakMap,Wfe="htBadValue",Ns="data-row",Hs="data-col",Ufe="checkboxRenderer",$W="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===$W){if(n){var s=n.value,u=n.property,f=r;if(s)f=typeof s=="function"?s(i,a,l,r):s;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function UE(e,t,r,n,o,i,a){var l=e.rootDocument;xf.apply(this,[e,t,r,n,o,i,a]),zfe(e);var s=Yfe(l),u=a.label,f=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Cn(t),i===a.checkedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Xt(i)?te(s,"noValue"):(s.style.display="none",te(s,Wfe),f=!0),s.setAttribute(Ns,r),s.setAttribute(Hs,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=Gfe(l,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}(!u||u&&!u.separated)&&t.appendChild(s),f&&t.appendChild(l.createTextNode("#bad-value#")),XA.has(e)||(XA.set(e,!0),v());function v(){var w=e.getShortcutManager(),S=w.getContext("grid"),C={group:Ufe};S.addShortcuts([{keys:[["space"]],callback:function(){return y(),!m()}},{keys:[["enter"]],callback:function(){return y(),!m()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!m()},relativeToGroup:Ic,position:"before"}],C)}function y(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(S)for(var C=0;C<S.length;C++){for(var k=S[C].getTopStartCorner(),_=k.row,N=k.col,V=S[C].getBottomEndCorner(),X=V.row,Y=V.col,q=[],Q=_;Q<=X;Q+=1)for(var ne=N;ne<=Y;ne+=1){var J=e.getCellMeta(Q,ne);if(J.type!=="checkbox")return;if(J.readOnly!==!0){typeof J.checkedTemplate>"u"&&(J.checkedTemplate=!0),typeof J.uncheckedTemplate>"u"&&(J.uncheckedTemplate=!1);var ue=e.getDataAtCell(Q,ne);w===!1?[J.checkedTemplate,J.checkedTemplate.toString()].includes(ue)?q.push([Q,ne,J.uncheckedTemplate]):[J.uncheckedTemplate,J.uncheckedTemplate.toString(),null,void 0].includes(ue)&&q.push([Q,ne,J.checkedTemplate]):q.push([Q,ne,J.uncheckedTemplate])}}q.length>0&&e.setDataAtCell(q)}}function m(){var w=e.getSelectedRange();if(w){for(var S=0;S<w.length;S++)for(var C=w[S].getTopStartCorner(),k=w[S].getBottomEndCorner(),_=C.row;_<=k.row;_++)for(var N=C.col;N<=k.col;N++){var V=e.getCellMeta(_,N);if(V.type!=="checkbox")return!1;var X=e.getCell(_,N);if(X==null)return!0;var Y=X.querySelectorAll("input[type=checkbox]");if(Y.length>0&&!V.readOnly)return!0}return!1}}}UE.RENDERER_TYPE=$W;function zfe(e){var t=ZA.get(e);if(!t){var r=e.rootElement;t=new kt(e),t.addEventListener(r,"click",function(n){return qfe(n,e)}),t.addEventListener(r,"mouseup",function(n){return Kfe(n,e)}),t.addEventListener(r,"change",function(n){return Xfe(n,e)}),ZA.set(e,t)}return t}function Yfe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function Gfe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function Kfe(e,t){var r=e.target;zE(r)&&(!r.hasAttribute(Ns)||!r.hasAttribute(Hs)||setTimeout(t.listen,10))}function qfe(e,t){var r=e.target;if(zE(r)&&!(!r.hasAttribute(Ns)||!r.hasAttribute(Hs))){var n=parseInt(r.getAttribute(Ns),10),o=parseInt(r.getAttribute(Hs),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function Xfe(e,t){var r=e.target;if(zE(r)&&!(!r.hasAttribute(Ns)||!r.hasAttribute(Hs))){var n=parseInt(r.getAttribute(Ns),10),o=parseInt(r.getAttribute(Hs),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function zE(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var AW={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof zv=="function"&&zv;if(!f&&c)return c(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var l=typeof zv=="function"&&zv,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(r,n,o){(function(i){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function S(Y){var q=0|Y;return 0<Y||Y===q?q:q-1}function C(Y){for(var q,Q,ne=1,J=Y.length,ue=Y[0]+"";ne<J;){for(q=Y[ne++]+"",Q=d-q.length;Q--;q="0"+q);ue+=q}for(J=ue.length;ue.charCodeAt(--J)===48;);return ue.slice(0,J+1||1)}function k(Y,q){var Q,ne,J=Y.c,ue=q.c,he=Y.s,Oe=q.s,we=Y.e,$=q.e;if(!he||!Oe)return null;if(Q=J&&!J[0],ne=ue&&!ue[0],Q||ne)return Q?ne?0:-Oe:he;if(he!=Oe)return he;if(Q=he<0,ne=we==$,!J||!ue)return ne?0:!J^Q?1:-1;if(!ne)return $<we^Q?1:-1;for(Oe=(we=J.length)<($=ue.length)?we:$,he=0;he<Oe;he++)if(J[he]!=ue[he])return J[he]>ue[he]^Q?1:-1;return we==$?0:$<we^Q?1:-1}function _(Y,q,Q,ne){if(Y<q||Q<Y||Y!==(Y<0?s(Y):u(Y)))throw Error(f+(ne||"Argument")+(typeof Y=="number"?Y<q||Q<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function N(Y){var q=Y.c.length-1;return S(Y.e/d)==q&&Y.c[q]%2!=0}function V(Y,q){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(q<0?"e":"e+")+q}function X(Y,q,Q){var ne,J;if(q<0){for(J=Q+".";++q;J+=Q);Y=J+Y}else if(++q>(ne=Y.length)){for(J=Q,q-=ne;--q;J+=Q);Y+=J}else q<ne&&(Y=Y.slice(0,q)+"."+Y.slice(q));return Y}(a=function Y(q){var Q,ne,J,ue,he,Oe,we,$,P,g,p=z.prototype={constructor:z,toString:null,valueOf:null},b=new z(1),E=20,R=4,B=-7,x=21,K=-1e7,Z=1e7,re=!1,ie=1,se=0,_e={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Se="0123456789abcdefghijklmnopqrstuvwxyz";function z(O,T){var I,F,M,W,H,D,U,j,G=this;if(!(G instanceof z))return new z(O,T);if(T==null){if(O instanceof z)return G.s=O.s,G.e=O.e,void(G.c=(O=O.c)?O.slice():O);if((D=typeof O=="number")&&0*O==0){if(G.s=1/O<0?(O=-O,-1):1,O===~~O){for(W=0,H=O;10<=H;H/=10,W++);return G.e=W,void(G.c=[O])}j=String(O)}else{if(j=String(O),!l.test(j))return J(G,j,D);G.s=j.charCodeAt(0)==45?(j=j.slice(1),-1):1}-1<(W=j.indexOf("."))&&(j=j.replace(".","")),0<(H=j.search(/e/i))?(W<0&&(W=H),W+=+j.slice(H+1),j=j.substring(0,H)):W<0&&(W=j.length)}else{if(_(T,2,Se.length,"Base"),j=String(O),T==10)return Ie(G=new z(O instanceof z?O:j),E+G.e+1,R);if(D=typeof O=="number"){if(0*O!=0)return J(G,j,D,T);if(G.s=1/O<0?(j=j.slice(1),-1):1,z.DEBUG&&15<j.replace(/^0\.0*|\./,"").length)throw Error(c+O);D=!1}else G.s=j.charCodeAt(0)===45?(j=j.slice(1),-1):1;for(I=Se.slice(0,T),W=H=0,U=j.length;H<U;H++)if(I.indexOf(F=j.charAt(H))<0){if(F=="."){if(W<H){W=U;continue}}else if(!M&&(j==j.toUpperCase()&&(j=j.toLowerCase())||j==j.toLowerCase()&&(j=j.toUpperCase()))){M=!0,H=-1,W=0;continue}return J(G,String(O),D,T)}-1<(W=(j=ne(j,T,10,G.s)).indexOf("."))?j=j.replace(".",""):W=j.length}for(H=0;j.charCodeAt(H)===48;H++);for(U=j.length;j.charCodeAt(--U)===48;);if(j=j.slice(H,++U)){if(U-=H,D&&z.DEBUG&&15<U&&(v<O||O!==u(O)))throw Error(c+G.s*O);if(Z<(W=W-H-1))G.c=G.e=null;else if(W<K)G.c=[G.e=0];else{if(G.e=W,G.c=[],H=(W+1)%d,W<0&&(H+=d),H<U){for(H&&G.c.push(+j.slice(0,H)),U-=d;H<U;)G.c.push(+j.slice(H,H+=d));j=j.slice(H),H=d-j.length}else H-=U;for(;H--;j+="0");G.c.push(+j)}}else G.c=[G.e=0]}function Ne(O,T,I,F){var M,W,H,D,U;if(I==null?I=R:_(I,0,8),!O.c)return O.toString();if(M=O.c[0],H=O.e,T==null)U=C(O.c),U=F==1||F==2&&(H<=B||x<=H)?V(U,H):X(U,H,"0");else if(W=(O=Ie(new z(O),T,I)).e,D=(U=C(O.c)).length,F==1||F==2&&(T<=W||W<=B)){for(;D<T;U+="0",D++);U=V(U,W)}else if(T-=H,U=X(U,W,"0"),D<W+1){if(0<--T)for(U+=".";T--;U+="0");}else if(0<(T+=W-D))for(W+1==D&&(U+=".");T--;U+="0");return O.s<0&&M?"-"+U:U}function Be(O,T){for(var I,F=1,M=new z(O[0]);F<O.length;F++){if(!(I=new z(O[F])).s){M=I;break}T.call(M,I)&&(M=I)}return M}function ke(O,T,I){for(var F=1,M=T.length;!T[--M];T.pop());for(M=T[0];10<=M;M/=10,F++);return(I=F+I*d-1)>Z?O.c=O.e=null:O.c=I<K?[O.e=0]:(O.e=I,T),O}function Ie(O,T,I,F){var M,W,H,D,U,j,G,le=O.c,pe=y;if(le){e:{for(M=1,D=le[0];10<=D;D/=10,M++);if((W=T-M)<0)W+=d,H=T,G=(U=le[j=0])/pe[M-H-1]%10|0;else if((j=s((W+1)/d))>=le.length){if(!F)break e;for(;le.length<=j;le.push(0));U=G=0,H=(W%=d)-d+(M=1)}else{for(U=D=le[j],M=1;10<=D;D/=10,M++);G=(H=(W%=d)-d+M)<0?0:U/pe[M-H-1]%10|0}if(F=F||T<0||le[j+1]!=null||(H<0?U:U%pe[M-H-1]),F=I<4?(G||F)&&(I==0||I==(O.s<0?3:2)):5<G||G==5&&(I==4||F||I==6&&(0<W?0<H?U/pe[M-H]:0:le[j-1])%10&1||I==(O.s<0?8:7)),T<1||!le[0])return le.length=0,F?(T-=O.e+1,le[0]=pe[(d-T%d)%d],O.e=-T||0):le[0]=O.e=0,O;if(W==0?(le.length=j,D=1,j--):(le.length=j+1,D=pe[d-W],le[j]=0<H?u(U/pe[M-H]%pe[H])*D:0),F)for(;;){if(j==0){for(W=1,H=le[0];10<=H;H/=10,W++);for(H=le[0]+=D,D=1;10<=H;H/=10,D++);W!=D&&(O.e++,le[0]==h&&(le[0]=1));break}if(le[j]+=D,le[j]!=h)break;le[j--]=0,D=1}for(W=le.length;le[--W]===0;le.pop());}O.e>Z?O.c=O.e=null:O.e<K&&(O.c=[O.e=0])}return O}function Ae(O){var T,I=O.e;return I===null?O.toString():(T=C(O.c),T=I<=B||x<=I?V(T,I):X(T,I,"0"),O.s<0?"-"+T:T)}return z.clone=Y,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(O){var T,I;if(O!=null){if(typeof O!="object")throw Error(f+"Object expected: "+O);if(O.hasOwnProperty(T="DECIMAL_PLACES")&&(_(I=O[T],0,w,T),E=I),O.hasOwnProperty(T="ROUNDING_MODE")&&(_(I=O[T],0,8,T),R=I),O.hasOwnProperty(T="EXPONENTIAL_AT")&&((I=O[T])&&I.pop?(_(I[0],-w,0,T),_(I[1],0,w,T),B=I[0],x=I[1]):(_(I,-w,w,T),B=-(x=I<0?-I:I))),O.hasOwnProperty(T="RANGE"))if((I=O[T])&&I.pop)_(I[0],-w,-1,T),_(I[1],1,w,T),K=I[0],Z=I[1];else{if(_(I,-w,w,T),!I)throw Error(f+T+" cannot be zero: "+I);K=-(Z=I<0?-I:I)}if(O.hasOwnProperty(T="CRYPTO")){if((I=O[T])!==!!I)throw Error(f+T+" not true or false: "+I);if(I){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!I,Error(f+"crypto unavailable");re=I}else re=I}if(O.hasOwnProperty(T="MODULO_MODE")&&(_(I=O[T],0,9,T),ie=I),O.hasOwnProperty(T="POW_PRECISION")&&(_(I=O[T],0,w,T),se=I),O.hasOwnProperty(T="FORMAT")){if(typeof(I=O[T])!="object")throw Error(f+T+" not an object: "+I);_e=I}if(O.hasOwnProperty(T="ALPHABET")){if(typeof(I=O[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(I))throw Error(f+T+" invalid: "+I);Se=I}}return{DECIMAL_PLACES:E,ROUNDING_MODE:R,EXPONENTIAL_AT:[B,x],RANGE:[K,Z],CRYPTO:re,MODULO_MODE:ie,POW_PRECISION:se,FORMAT:_e,ALPHABET:Se}},z.isBigNumber=function(O){return O instanceof z||O&&O._isBigNumber===!0||!1},z.maximum=z.max=function(){return Be(arguments,p.lt)},z.minimum=z.min=function(){return Be(arguments,p.gt)},z.random=(ue=9007199254740992,he=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(O){var T,I,F,M,W,H=0,D=[],U=new z(b);if(O==null?O=E:_(O,0,w),M=s(O/d),re)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(M*=2));H<M;)9e15<=(W=131072*T[H]+(T[H+1]>>>11))?(I=crypto.getRandomValues(new Uint32Array(2)),T[H]=I[0],T[H+1]=I[1]):(D.push(W%1e14),H+=2);H=M/2}else{if(!crypto.randomBytes)throw re=!1,Error(f+"crypto unavailable");for(T=crypto.randomBytes(M*=7);H<M;)9e15<=(W=281474976710656*(31&T[H])+1099511627776*T[H+1]+4294967296*T[H+2]+16777216*T[H+3]+(T[H+4]<<16)+(T[H+5]<<8)+T[H+6])?crypto.randomBytes(7).copy(T,H):(D.push(W%1e14),H+=7);H=M/7}if(!re)for(;H<M;)(W=he())<9e15&&(D[H++]=W%1e14);for(M=D[--H],O%=d,M&&O&&(W=y[d-O],D[H]=u(M/W)*W);D[H]===0;D.pop(),H--);if(H<0)D=[F=0];else{for(F=-1;D[0]===0;D.splice(0,1),F-=d);for(H=1,W=D[0];10<=W;W/=10,H++);H<d&&(F-=d-H)}return U.e=F,U.c=D,U}),z.sum=function(){for(var O=1,T=arguments,I=new z(T[0]);O<T.length;)I=I.plus(T[O++]);return I},ne=function(){var O="0123456789";function T(I,F,M,W){for(var H,D,U=[0],j=0,G=I.length;j<G;){for(D=U.length;D--;U[D]*=F);for(U[0]+=W.indexOf(I.charAt(j++)),H=0;H<U.length;H++)U[H]>M-1&&(U[H+1]==null&&(U[H+1]=0),U[H+1]+=U[H]/M|0,U[H]%=M)}return U.reverse()}return function(I,F,M,W,H){var D,U,j,G,le,pe,Re,He,Ze=I.indexOf("."),st=E,Ge=R;for(0<=Ze&&(G=se,se=0,I=I.replace(".",""),pe=(He=new z(F)).pow(I.length-Ze),se=G,He.c=T(X(C(pe.c),pe.e,"0"),10,M,O),He.e=He.c.length),j=G=(Re=T(I,F,M,H?(D=Se,O):(D=O,Se))).length;Re[--G]==0;Re.pop());if(!Re[0])return D.charAt(0);if(Ze<0?--j:(pe.c=Re,pe.e=j,pe.s=W,Re=(pe=Q(pe,He,st,Ge,M)).c,le=pe.r,j=pe.e),Ze=Re[U=j+st+1],G=M/2,le=le||U<0||Re[U+1]!=null,le=Ge<4?(Ze!=null||le)&&(Ge==0||Ge==(pe.s<0?3:2)):G<Ze||Ze==G&&(Ge==4||le||Ge==6&&1&Re[U-1]||Ge==(pe.s<0?8:7)),U<1||!Re[0])I=le?X(D.charAt(1),-st,D.charAt(0)):D.charAt(0);else{if(Re.length=U,le)for(--M;++Re[--U]>M;)Re[U]=0,U||(++j,Re=[1].concat(Re));for(G=Re.length;!Re[--G];);for(Ze=0,I="";Ze<=G;I+=D.charAt(Re[Ze++]));I=X(I,j,D.charAt(0))}return I}}(),Q=function(){function O(F,M,W){var H,D,U,j,G=0,le=F.length,pe=M%m,Re=M/m|0;for(F=F.slice();le--;)G=((D=pe*(U=F[le]%m)+(H=Re*U+(j=F[le]/m|0)*pe)%m*m+G)/W|0)+(H/m|0)+Re*j,F[le]=D%W;return G&&(F=[G].concat(F)),F}function T(F,M,W,H){var D,U;if(W!=H)U=H<W?1:-1;else for(D=U=0;D<W;D++)if(F[D]!=M[D]){U=F[D]>M[D]?1:-1;break}return U}function I(F,M,W,H){for(var D=0;W--;)F[W]-=D,D=F[W]<M[W]?1:0,F[W]=D*H+F[W]-M[W];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,M,W,H,D){var U,j,G,le,pe,Re,He,Ze,st,Ge,Me,De,dr,Bt,Ve,et,Ct,ut=F.s==M.s?1:-1,ct=F.c,tt=M.c;if(!(ct&&ct[0]&&tt&&tt[0]))return new z(F.s&&M.s&&(ct?!tt||ct[0]!=tt[0]:tt)?ct&&ct[0]==0||!tt?0*ut:ut/0:NaN);for(st=(Ze=new z(ut)).c=[],ut=W+(j=F.e-M.e)+1,D||(D=h,j=S(F.e/d)-S(M.e/d),ut=ut/d|0),G=0;tt[G]==(ct[G]||0);G++);if(tt[G]>(ct[G]||0)&&j--,ut<0)st.push(1),le=!0;else{for(Bt=ct.length,et=tt.length,ut+=2,1<(pe=u(D/(tt[G=0]+1)))&&(tt=O(tt,pe,D),ct=O(ct,pe,D),et=tt.length,Bt=ct.length),dr=et,Me=(Ge=ct.slice(0,et)).length;Me<et;Ge[Me++]=0);Ct=tt.slice(),Ct=[0].concat(Ct),Ve=tt[0],tt[1]>=D/2&&Ve++;do{if(pe=0,(U=T(tt,Ge,et,Me))<0){if(De=Ge[0],et!=Me&&(De=De*D+(Ge[1]||0)),1<(pe=u(De/Ve)))for(D<=pe&&(pe=D-1),He=(Re=O(tt,pe,D)).length,Me=Ge.length;T(Re,Ge,He,Me)==1;)pe--,I(Re,et<He?Ct:tt,He,D),He=Re.length,U=1;else pe==0&&(U=pe=1),He=(Re=tt.slice()).length;if(He<Me&&(Re=[0].concat(Re)),I(Ge,Re,Me,D),Me=Ge.length,U==-1)for(;T(tt,Ge,et,Me)<1;)pe++,I(Ge,et<Me?Ct:tt,Me,D),Me=Ge.length}else U===0&&(pe++,Ge=[0]);st[G++]=pe,Ge[0]?Ge[Me++]=ct[dr]||0:(Ge=[ct[dr]],Me=1)}while((dr++<Bt||Ge[0]!=null)&&ut--);le=Ge[0]!=null,st[0]||st.splice(0,1)}if(D==h){for(G=1,ut=st[0];10<=ut;ut/=10,G++);Ie(Ze,W+(Ze.e=G+j*d-1)+1,H,le)}else Ze.e=j,Ze.r=+le;return Ze}}(),Oe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,we=/^([^.]+)\.$/,$=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,J=function(O,T,I,F){var M,W=I?T:T.replace(g,"");if(P.test(W))O.s=isNaN(W)?null:W<0?-1:1,O.c=O.e=null;else{if(!I&&(W=W.replace(Oe,function(H,D,U){return M=(U=U.toLowerCase())=="x"?16:U=="b"?2:8,F&&F!=M?H:D}),F&&(M=F,W=W.replace(we,"$1").replace($,"0.$1")),T!=W))return new z(W,M);if(z.DEBUG)throw Error(f+"Not a"+(F?" base "+F:"")+" number: "+T);O.c=O.e=O.s=null}},p.absoluteValue=p.abs=function(){var O=new z(this);return O.s<0&&(O.s=1),O},p.comparedTo=function(O,T){return k(this,new z(O,T))},p.decimalPlaces=p.dp=function(O,T){var I,F,M;if(O!=null)return _(O,0,w),T==null?T=R:_(T,0,8),Ie(new z(this),O+this.e+1,T);if(!(I=this.c))return null;if(F=((M=I.length-1)-S(this.e/d))*d,M=I[M])for(;M%10==0;M/=10,F--);return F<0&&(F=0),F},p.dividedBy=p.div=function(O,T){return Q(this,new z(O,T),E,R)},p.dividedToIntegerBy=p.idiv=function(O,T){return Q(this,new z(O,T),0,1)},p.exponentiatedBy=p.pow=function(O,T){var I,F,M,W,H,D,U,j,G=this;if((O=new z(O)).c&&!O.isInteger())throw Error(f+"Exponent not an integer: "+Ae(O));if(T!=null&&(T=new z(T)),H=14<O.e,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!O.c||!O.c[0])return j=new z(Math.pow(+Ae(G),H?2-N(O):+Ae(O))),T?j.mod(T):j;if(D=O.s<0,T){if(T.c?!T.c[0]:!T.s)return new z(NaN);(F=!D&&G.isInteger()&&T.isInteger())&&(G=G.mod(T))}else{if(9<O.e&&(0<G.e||G.e<-1||(G.e==0?1<G.c[0]||H&&24e7<=G.c[1]:G.c[0]<8e13||H&&G.c[0]<=9999975e7)))return W=G.s<0&&N(O)?-0:0,-1<G.e&&(W=1/W),new z(D?1/W:W);se&&(W=s(se/d+2))}for(U=H?(I=new z(.5),D&&(O.s=1),N(O)):(M=Math.abs(+Ae(O)))%2,j=new z(b);;){if(U){if(!(j=j.times(G)).c)break;W?j.c.length>W&&(j.c.length=W):F&&(j=j.mod(T))}if(M){if((M=u(M/2))===0)break;U=M%2}else if(Ie(O=O.times(I),O.e+1,1),14<O.e)U=N(O);else{if((M=+Ae(O))==0)break;U=M%2}G=G.times(G),W?G.c&&G.c.length>W&&(G.c.length=W):F&&(G=G.mod(T))}return F?j:(D&&(j=b.div(j)),T?j.mod(T):W?Ie(j,se,R,void 0):j)},p.integerValue=function(O){var T=new z(this);return O==null?O=R:_(O,0,8),Ie(T,T.e+1,O)},p.isEqualTo=p.eq=function(O,T){return k(this,new z(O,T))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(O,T){return 0<k(this,new z(O,T))},p.isGreaterThanOrEqualTo=p.gte=function(O,T){return(T=k(this,new z(O,T)))===1||T===0},p.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},p.isLessThan=p.lt=function(O,T){return k(this,new z(O,T))<0},p.isLessThanOrEqualTo=p.lte=function(O,T){return(T=k(this,new z(O,T)))===-1||T===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(O,T){var I,F,M,W,H=this,D=H.s;if(T=(O=new z(O,T)).s,!D||!T)return new z(NaN);if(D!=T)return O.s=-T,H.plus(O);var U=H.e/d,j=O.e/d,G=H.c,le=O.c;if(!U||!j){if(!G||!le)return G?(O.s=-T,O):new z(le?H:NaN);if(!G[0]||!le[0])return le[0]?(O.s=-T,O):new z(G[0]?H:R==3?-0:0)}if(U=S(U),j=S(j),G=G.slice(),D=U-j){for((M=(W=D<0)?(D=-D,G):(j=U,le)).reverse(),T=D;T--;M.push(0));M.reverse()}else for(F=(W=(D=G.length)<(T=le.length))?D:T,D=T=0;T<F;T++)if(G[T]!=le[T]){W=G[T]<le[T];break}if(W&&(M=G,G=le,le=M,O.s=-O.s),0<(T=(F=le.length)-(I=G.length)))for(;T--;G[I++]=0);for(T=h-1;D<F;){if(G[--F]<le[F]){for(I=F;I&&!G[--I];G[I]=T);--G[I],G[F]+=h}G[F]-=le[F]}for(;G[0]==0;G.splice(0,1),--j);return G[0]?ke(O,G,j):(O.s=R==3?-1:1,O.c=[O.e=0],O)},p.modulo=p.mod=function(O,T){var I,F,M=this;return O=new z(O,T),!M.c||!O.s||O.c&&!O.c[0]?new z(NaN):!O.c||M.c&&!M.c[0]?new z(M):(ie==9?(F=O.s,O.s=1,I=Q(M,O,0,3),O.s=F,I.s*=F):I=Q(M,O,0,ie),(O=M.minus(I.times(O))).c[0]||ie!=1||(O.s=M.s),O)},p.multipliedBy=p.times=function(O,T){var I,F,M,W,H,D,U,j,G,le,pe,Re,He,Ze,st,Ge=this,Me=Ge.c,De=(O=new z(O,T)).c;if(!(Me&&De&&Me[0]&&De[0]))return!Ge.s||!O.s||Me&&!Me[0]&&!De||De&&!De[0]&&!Me?O.c=O.e=O.s=null:(O.s*=Ge.s,Me&&De?(O.c=[0],O.e=0):O.c=O.e=null),O;for(F=S(Ge.e/d)+S(O.e/d),O.s*=Ge.s,(U=Me.length)<(le=De.length)&&(He=Me,Me=De,De=He,M=U,U=le,le=M),M=U+le,He=[];M--;He.push(0));for(Ze=h,st=m,M=le;0<=--M;){for(I=0,pe=De[M]%st,Re=De[M]/st|0,W=M+(H=U);M<W;)I=((j=pe*(j=Me[--H]%st)+(D=Re*j+(G=Me[H]/st|0)*pe)%st*st+He[W]+I)/Ze|0)+(D/st|0)+Re*G,He[W--]=j%Ze;He[W]=I}return I?++F:He.splice(0,1),ke(O,He,F)},p.negated=function(){var O=new z(this);return O.s=-O.s||null,O},p.plus=function(O,T){var I,F=this,M=F.s;if(T=(O=new z(O,T)).s,!M||!T)return new z(NaN);if(M!=T)return O.s=-T,F.minus(O);var W=F.e/d,H=O.e/d,D=F.c,U=O.c;if(!W||!H){if(!D||!U)return new z(M/0);if(!D[0]||!U[0])return U[0]?O:new z(D[0]?F:0*M)}if(W=S(W),H=S(H),D=D.slice(),M=W-H){for((I=0<M?(H=W,U):(M=-M,D)).reverse();M--;I.push(0));I.reverse()}for((M=D.length)-(T=U.length)<0&&(I=U,U=D,D=I,T=M),M=0;T;)M=(D[--T]=D[T]+U[T]+M)/h|0,D[T]=h===D[T]?0:D[T]%h;return M&&(D=[M].concat(D),++H),ke(O,D,H)},p.precision=p.sd=function(O,T){var I,F,M;if(O!=null&&O!==!!O)return _(O,1,w),T==null?T=R:_(T,0,8),Ie(new z(this),O,T);if(!(I=this.c))return null;if(F=(M=I.length-1)*d+1,M=I[M]){for(;M%10==0;M/=10,F--);for(M=I[0];10<=M;M/=10,F++);}return O&&this.e+1>F&&(F=this.e+1),F},p.shiftedBy=function(O){return _(O,-v,v),this.times("1e"+O)},p.squareRoot=p.sqrt=function(){var O,T,I,F,M,W=this,H=W.c,D=W.s,U=W.e,j=E+4,G=new z("0.5");if(D!==1||!H||!H[0])return new z(!D||D<0&&(!H||H[0])?NaN:H?W:1/0);if((I=(D=Math.sqrt(+Ae(W)))==0||D==1/0?(((T=C(H)).length+U)%2==0&&(T+="0"),D=Math.sqrt(+T),U=S((U+1)/2)-(U<0||U%2),new z(T=D==1/0?"1e"+U:(T=D.toExponential()).slice(0,T.indexOf("e")+1)+U)):new z(D+"")).c[0]){for((D=(U=I.e)+j)<3&&(D=0);;)if(M=I,I=G.times(M.plus(Q(W,M,j,1))),C(M.c).slice(0,D)===(T=C(I.c)).slice(0,D)){if(I.e<U&&--D,(T=T.slice(D-3,D+1))!="9999"&&(F||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(Ie(I,I.e+E+2,1),O=!I.times(I).eq(W));break}if(!F&&(Ie(M,M.e+E+2,0),M.times(M).eq(W))){I=M;break}j+=4,D+=4,F=1}}return Ie(I,I.e+E+1,R,O)},p.toExponential=function(O,T){return O!=null&&(_(O,0,w),O++),Ne(this,O,T,1)},p.toFixed=function(O,T){return O!=null&&(_(O,0,w),O=O+this.e+1),Ne(this,O,T)},p.toFormat=function(O,T,I){var F;if(I==null)O!=null&&T&&typeof T=="object"?(I=T,T=null):O&&typeof O=="object"?(I=O,O=T=null):I=_e;else if(typeof I!="object")throw Error(f+"Argument not an object: "+I);if(F=this.toFixed(O,T),this.c){var M,W=F.split("."),H=+I.groupSize,D=+I.secondaryGroupSize,U=I.groupSeparator||"",j=W[0],G=W[1],le=this.s<0,pe=le?j.slice(1):j,Re=pe.length;if(D&&(M=H,H=D,Re-=D=M),0<H&&0<Re){for(M=Re%H||H,j=pe.substr(0,M);M<Re;M+=H)j+=U+pe.substr(M,H);0<D&&(j+=U+pe.slice(M)),le&&(j="-"+j)}F=G?j+(I.decimalSeparator||"")+((D=+I.fractionGroupSize)?G.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):G):j}return(I.prefix||"")+F+(I.suffix||"")},p.toFraction=function(O){var T,I,F,M,W,H,D,U,j,G,le,pe,Re=this,He=Re.c;if(O!=null&&(!(D=new z(O)).isInteger()&&(D.c||D.s!==1)||D.lt(b)))throw Error(f+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Ae(D));if(!He)return new z(Re);for(T=new z(b),j=I=new z(b),F=U=new z(b),pe=C(He),W=T.e=pe.length-Re.e-1,T.c[0]=y[(H=W%d)<0?d+H:H],O=!O||0<D.comparedTo(T)?0<W?T:j:D,H=Z,Z=1/0,D=new z(pe),U.c[0]=0;G=Q(D,T,0,1),(M=I.plus(G.times(F))).comparedTo(O)!=1;)I=F,F=M,j=U.plus(G.times(M=j)),U=M,T=D.minus(G.times(M=T)),D=M;return M=Q(O.minus(I),F,0,1),U=U.plus(M.times(j)),I=I.plus(M.times(F)),U.s=j.s=Re.s,le=Q(j,F,W*=2,R).minus(Re).abs().comparedTo(Q(U,I,W,R).minus(Re).abs())<1?[j,F]:[U,I],Z=H,le},p.toNumber=function(){return+Ae(this)},p.toPrecision=function(O,T){return O!=null&&_(O,1,w),Ne(this,O,T,2)},p.toString=function(O){var T,I=this,F=I.s,M=I.e;return M===null?F?(T="Infinity",F<0&&(T="-"+T)):T="NaN":(T=O==null?M<=B||x<=M?V(C(I.c),M):X(C(I.c),M,"0"):O===10?X(C((I=Ie(new z(I),E+M+1,R)).c),I.e,"0"):(_(O,2,Se.length,"Base"),ne(X(C(I.c),M,"0"),10,O,F,!0)),F<0&&I.c[0]&&(T="-"+T)),T},p.valueOf=p.toJSON=function(){return Ae(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),q!=null&&z.set(q),z}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,C){return function(k){if(Array.isArray(k))return k}(S)||function(k,_){var N=[],V=!0,X=!1,Y=void 0;try{for(var q,Q=k[Symbol.iterator]();!(V=(q=Q.next()).done)&&(N.push(q.value),!_||N.length!==_);V=!0);}catch(ne){X=!0,Y=ne}finally{try{V||Q.return==null||Q.return()}finally{if(X)throw Y}}return N}(S,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),l=r("./validating"),s=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},k=2<arguments.length?arguments[2]:void 0;if(typeof C=="string"&&(C=s.parseFormat(C)),!l.validateFormat(C))return"ERROR: invalid format";var _=C.prefix||"",N=C.postfix||"",V=function(X,Y,q){switch(Y.output){case"currency":return Y=w(Y,a.currentCurrencyDefaultFormat()),function(Se,z,Ne){var Be=Ne.currentCurrency(),ke=Object.assign({},c,z),Ie=void 0,Ae="",O=!!ke.totalLength||!!ke.forceAverage||ke.average,T=z.currencyPosition||Be.position,I=z.currencySymbol||Be.symbol;ke.spaceSeparated&&(Ae=" "),T==="infix"&&(Ie=Ae+I+Ae);var F=m({instance:Se,providedFormat:z,state:Ne,decimalSeparator:Ie});return T==="prefix"&&(F=Se._value<0&&ke.negative==="sign"?"-".concat(Ae).concat(I).concat(F.slice(1)):I+Ae+F),T&&T!=="postfix"||(F=F+(Ae=O?"":Ae)+I),F}(X,Y,a);case"percent":return Y=w(Y,a.currentPercentageDefaultFormat()),function(Se,z,Ne,Be){var ke=z.prefixSymbol,Ie=m({instance:Be(100*Se._value),providedFormat:z,state:Ne}),Ae=Object.assign({},c,z);return ke?"%".concat(Ae.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Ae.spaceSeparated?" ":"","%")}(X,Y,a,q);case"byte":return Y=w(Y,a.currentByteDefaultFormat()),b=X,R=a,B=q,x=(E=Y).base||"binary",K=f[x],Z=d(b._value,K.suffixes,K.scale),re=Z.value,ie=Z.suffix,se=m({instance:B(re),providedFormat:E,state:R,defaults:R.currentByteDefaultFormat()}),_e=R.currentAbbreviations(),"".concat(se).concat(_e.spaced?" ":"").concat(ie);case"time":return Y=w(Y,a.currentTimeDefaultFormat()),$=X,P=Math.floor($._value/60/60),g=Math.floor(($._value-60*P*60)/60),p=Math.round($._value-60*P*60-60*g),"".concat(P,":").concat(g<10?"0":"").concat(g,":").concat(p<10?"0":"").concat(p);case"ordinal":return Y=w(Y,a.currentOrdinalDefaultFormat()),Q=X,ne=Y,ue=(J=a).currentOrdinal(),he=Object.assign({},c,ne),Oe=m({instance:Q,providedFormat:ne,state:J}),we=ue(Q._value),"".concat(Oe).concat(he.spaceSeparated?" ":"").concat(we);case"number":default:return m({instance:X,providedFormat:Y,numbro:q})}var Q,ne,J,ue,he,Oe,we,$,P,g,p,b,E,R,B,x,K,Z,re,ie,se,_e}(S,C,k);return V=(V=_+V)+N}function d(S,C,k){var _=C[0],N=Math.abs(S);if(k<=N){for(var V=1;V<C.length;++V){var X=Math.pow(k,V),Y=Math.pow(k,V+1);if(X<=N&&N<Y){_=C[V],S/=X;break}}_===C[0]&&(S/=Math.pow(k,C.length-1),_=C[C.length-1])}return{value:S,suffix:_}}function v(S){for(var C="",k=0;k<S;k++)C+="0";return C}function y(S,C){return S.toString().indexOf("e")!==-1?function(k,_){var N=k.toString(),V=i(N.split("e"),2),X=V[0],Y=V[1],q=i(X.split("."),2),Q=q[0],ne=q[1],J=ne===void 0?"":ne;if(0<+Y)N=Q+J+v(Y-J.length);else{var ue=".";ue=+Q<0?"-0".concat(ue):"0".concat(ue);var he=(v(-Y-1)+Math.abs(Q)+J).substr(0,_);he.length<_&&(he+=v(_-he.length)),N=ue+he}return 0<+Y&&0<_&&(N+=".".concat(v(_))),N}(S,C):(Math.round(+"".concat(S,"e+").concat(C))/Math.pow(10,C)).toFixed(C)}function m(S){var C=S.instance,k=S.providedFormat,_=S.state,N=_===void 0?a:_,V=S.decimalSeparator,X=S.defaults,Y=X===void 0?N.currentDefaults():X,q=C._value;if(q===0&&N.hasZeroFormat())return N.getZeroFormat();if(!isFinite(q))return q.toString();var Q,ne,J,ue,he,Oe,we,$,P=Object.assign({},c,Y,k),g=P.totalLength,p=g?0:P.characteristic,b=P.optionalCharacteristic,E=P.forceAverage,R=!!g||!!E||P.average,B=g?-1:R&&k.mantissa===void 0?0:P.mantissa,x=!g&&(k.optionalMantissa===void 0?B===-1:P.optionalMantissa),K=P.trimMantissa,Z=P.thousandSeparated,re=P.spaceSeparated,ie=P.negative,se=P.forceSign,_e=P.exponential,Se="";if(R){var z=function(O){var T=O.value,I=O.forceAverage,F=O.abbreviations,M=O.spaceSeparated,W=M!==void 0&&M,H=O.totalLength,D=H===void 0?0:H,U="",j=Math.abs(T),G=-1;if(j>=Math.pow(10,12)&&!I||I==="trillion"?(U=F.trillion,T/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!I||I==="billion"?(U=F.billion,T/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!I||I==="million"?(U=F.million,T/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!I||I==="thousand")&&(U=F.thousand,T/=Math.pow(10,3)),U&&(U=(W?" ":"")+U),D){var le=T.toString().split(".")[0];G=Math.max(D-le.length,0)}return{value:T,abbreviation:U,mantissaPrecision:G}}({value:q,forceAverage:E,abbreviations:N.currentAbbreviations(),spaceSeparated:re,totalLength:g});q=z.value,Se+=z.abbreviation,g&&(B=z.mantissaPrecision)}if(_e){var Ne=(ne=(Q={value:q,characteristicPrecision:p}).value,J=Q.characteristicPrecision,ue=J===void 0?0:J,he=i(ne.toExponential().split("e"),2),Oe=he[0],we=he[1],$=+Oe,ue&&1<ue&&($*=Math.pow(10,ue-1),we=0<=(we=+we-(ue-1))?"+".concat(we):we),{value:$,abbreviation:"e".concat(we)});q=Ne.value,Se=Ne.abbreviation+Se}var Be,ke,Ie,Ae=function(O,T,I,F,M){if(F===-1)return O;var W=y(T,F),H=i(W.toString().split("."),2),D=H[0],U=H[1],j=U===void 0?"":U;if(j.match(/^0+$/)&&(I||M))return D;var G=j.match(/0+$/);return M&&G?"".concat(D,".").concat(j.toString().slice(0,G.index)):W.toString()}(q.toString(),q,x,B,K);return Ae=function(O,T,I,F,M){var W=F.currentDelimiters(),H=W.thousands;M=M||W.decimal;var D=W.thousandsSize||3,U=O.toString(),j=U.split(".")[0],G=U.split(".")[1];return I&&(T<0&&(j=j.slice(1)),function(le,pe){for(var Re=[],He=0,Ze=le;0<Ze;Ze--)He===pe&&(Re.unshift(Ze),He=0),He++;return Re}(j.length,D).forEach(function(le,pe){j=j.slice(0,le+pe)+H+j.slice(le+pe)}),T<0&&(j="-".concat(j))),U=G?j+M+G:j}(Ae=function(O,T,I,F){var M=O,W=i(M.toString().split("."),2),H=W[0],D=W[1];if(H.match(/^-?0$/)&&I)return D?"".concat(H.replace("0",""),".").concat(D):H.replace("0","");if(H.length<F)for(var U=F-H.length,j=0;j<U;j++)M="0".concat(M);return M.toString()}(Ae,0,b,p),q,Z,N,V),(R||_e)&&(Ae=Ae+Se),(se||q<0)&&(Be=Ae,Ie=ie,Ae=(ke=q)===0?Be:+Be==0?Be.replace("-",""):0<ke?"+".concat(Be):Ie==="sign"?Be:"(".concat(Be.replace("-",""),")")),Ae}function w(S,C){if(!S)return C;var k=Object.keys(S);return k.length===1&&k[0]==="output"?C:S}n.exports=function(S){return{format:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return h.apply(void 0,k.concat([S]))},getByteUnit:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return function(N){var V=f.general;return d(N._value,V.suffixes,V.scale).suffix}.apply(void 0,k.concat([S]))},getBinaryByteUnit:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return function(N){var V=f.binary;return d(N._value,V.suffixes,V.scale).suffix}.apply(void 0,k.concat([S]))},getDecimalByteUnit:function(){for(var C=arguments.length,k=new Array(C),_=0;_<C;_++)k[_]=arguments[_];return function(N){var V=f.decimal;return d(N._value,V.suffixes,V.scale).suffix}.apply(void 0,k.concat([S]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),l=r("./parsing"),s={},u=void 0,f={},c=null,h={};function d(y){u=y}function v(){return f[u]}s.languages=function(){return Object.assign({},f)},s.currentLanguage=function(){return u},s.currentCurrency=function(){return v().currency},s.currentAbbreviations=function(){return v().abbreviations},s.currentDelimiters=function(){return v().delimiters},s.currentOrdinal=function(){return v().ordinal},s.currentDefaults=function(){return Object.assign({},v().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),v().timeFormat)},s.setDefaults=function(y){y=l.parseFormat(y),a.validateFormat(y)&&(h=y)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(y){return c=typeof y=="string"?y:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(y){if(y){if(f[y])return f[y];throw new Error('Unknown tag "'.concat(y,'"'))}return v()},s.registerLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(y))throw new Error("Invalid language data");f[y.languageTag]=y,m&&d(y.languageTag)},s.setLanguage=function(y){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[y]){var w=y.split("-")[0],S=Object.keys(f).find(function(C){return C.split("-")[0]===w});return f[S]?void d(S):void d(m)}d(y)},s.registerLanguage(i),u=i.languageTag,n.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return l=i,void a.forEach(function(s){var u=void 0;try{u=r("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(l,s,u){var f=new i(l._value),c=s;return u.isNumbro(s)&&(c=s._value),c=new i(c),l._value=f.minus(c).toNumber(),l}n.exports=function(l){return{add:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(s,u){return a(s,u,l)},multiply:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(s,u){return c=u,h=l,d=new i((f=s)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(s,u){return f=s,h=c=u,l.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(s,u){return f=u,a(h=(c=l)(s._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(m,w){for(var S=0;S<w.length;S++){var C=w[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(m,C.key,C)}}var a=r("./globalState"),l=r("./validating"),s=r("./loading")(y),u=r("./unformatting"),f=r("./formatting")(y),c=r("./manipulating")(y),h=r("./parsing"),d=function(){function m(C){(function(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")})(this,m),this._value=C}var w,S;return w=m,(S=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,C)}},{key:"formatCurrency",value:function(C){return typeof C=="string"&&(C=h.parseFormat(C)),(C=f.formatOrDefault(C,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,C)}},{key:"formatTime",value:function(){var C=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return C.output="time",f.format(this,C)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(C){return c.difference(this,C)}},{key:"add",value:function(C){return c.add(this,C)}},{key:"subtract",value:function(C){return c.subtract(this,C)}},{key:"multiply",value:function(C){return c.multiply(this,C)}},{key:"divide",value:function(C){return c.divide(this,C)}},{key:"set",value:function(C){return c.set(this,v(C))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,S),m}();function v(m){var w=m;return y.isNumbro(m)?w=m._value:typeof m=="string"?w=y.unformat(m):isNaN(m)&&(w=NaN),w}function y(m){return new d(v(m))}y.version="2.1.2",y.isNumbro=function(m){return m instanceof d},y.language=a.currentLanguage,y.registerLanguage=a.registerLanguage,y.setLanguage=a.setLanguage,y.languages=a.languages,y.languageData=a.languageData,y.zeroFormat=a.setZeroFormat,y.defaultFormat=a.currentDefaults,y.setDefaults=a.setDefaults,y.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=s.loadLanguagesInNode,y.unformat=u.unformat,n.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,l,s,u,f,c,h,d,v,y,m,w,S,C,k,_,N,V,X,Y,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=q,i=(s=(a=i).match(/^{([^}]*)}/))?(l.prefix=s[1],a.slice(s[0].length)):a,f=q,function(Q,ne){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(ne.output="byte",ne.base="general"):Q.indexOf("b")!==-1?(ne.output="byte",ne.base="binary"):Q.indexOf("d")!==-1?(ne.output="byte",ne.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(ne.output="ordinal"):ne.output="time";ne.output="percent"}else ne.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,q),h=q,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=q,(y=i.split(".")[0].match(/0+/))&&(v.characteristic=y[0].length),function(Q,ne){if(Q.indexOf(".")!==-1){var J=Q.split(".")[0];ne.optionalCharacteristic=J.indexOf("0")===-1}}(i,q),m=q,i.indexOf("a")!==-1&&(m.average=!0),S=q,(w=i).indexOf("K")!==-1?S.forceAverage="thousand":w.indexOf("M")!==-1?S.forceAverage="million":w.indexOf("B")!==-1?S.forceAverage="billion":w.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(Q,ne){var J=Q.split(".")[1];if(J){var ue=J.match(/0+/);ue&&(ne.mantissa=ue[0].length)}}(i,q),k=q,(C=i).match(/\[\.]/)?k.optionalMantissa=!0:C.match(/\./)&&(k.optionalMantissa=!1),_=q,i.indexOf(",")!==-1&&(_.thousandSeparated=!0),N=q,i.indexOf(" ")!==-1&&(N.spaceSeparated=!0),X=q,(V=i).match(/^\+?\([^)]*\)$/)&&(X.negative="parenthesis"),V.match(/^\+?-/)&&(X.negative="sign"),Y=q,i.match(/^\+/)&&(Y.forceSign=!0),q)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(s,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===h?0:function y(m,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=3<arguments.length?arguments[3]:void 0,k=4<arguments.length?arguments[4]:void 0,_=5<arguments.length?arguments[5]:void 0,N=6<arguments.length?arguments[6]:void 0;if(!isNaN(+m))return+m;var V="",X=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(X!==m)return-1*y(X,w,S,C,k,_,N);for(var Y=0;Y<i.length;Y++){var q=i[Y];if((V=m.replace(q.key,""))!==m)return y(V,w,S,C,k,_,N)*q.factor}if((V=m.replace("%",""))!==m)return y(V,w,S,C,k,_,N)/100;var Q=parseFloat(m);if(!isNaN(Q)){var ne=C(Q);if(ne&&ne!=="."&&(V=m.replace(new RegExp("".concat(a(ne),"$")),""))!==m)return y(V,w,S,C,k,_,N);var J={};Object.keys(_).forEach(function(g){J[_[g]]=g});for(var ue=Object.keys(J).sort().reverse(),he=ue.length,Oe=0;Oe<he;Oe++){var we=ue[Oe],$=J[we];if((V=m.replace(we,""))!==m){var P=void 0;switch($){case"thousand":P=Math.pow(10,3);break;case"million":P=Math.pow(10,6);break;case"billion":P=Math.pow(10,9);break;case"trillion":P=Math.pow(10,12)}return y(V,w,S,C,k,_,N)*P}}}}(function(y,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=y.replace(w,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(m.thousands),"([0-9])"),"g"),"$1$2")).replace(m.decimal,".")}(s,u,f),u,f,c,h,d,v)}n.exports={unformat:function(s,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),y=d.currentCurrency().symbol,m=d.currentOrdinal(),w=d.getZeroFormat(),S=d.currentAbbreviations(),C=void 0;if(typeof s=="string")C=function(k,_){if(!k.indexOf(":")||_.thousands===":")return!1;var N=k.split(":");if(N.length!==3)return!1;var V=+N[0],X=+N[1],Y=+N[2];return!isNaN(V)&&!isNaN(X)&&!isNaN(Y)}(s,v)?(f=s.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):l(s,v,y,m,w,S,u);else{if(typeof s!="number")return;C=s}if(C!==void 0)return C}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(y){if(Array.isArray(y)){for(var m=0,w=new Array(y.length);m<y.length;m++)w[m]=y[m];return w}}(v)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(v)}var l=r("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!l.unformat(v)}function h(v,y,m){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(C){if(!y[C])return console.error("".concat(m," Invalid key: ").concat(C)),!1;var k=v[C],_=y[C];if(typeof _=="string"&&(_={type:_}),_.type==="format"){if(!h(k,u,"[Validate ".concat(C,"]"),!0))return!1}else if(a(k)!==_.type)return console.error("".concat(m," ").concat(C,' type mismatched: "').concat(_.type,'" expected, "').concat(a(k),'" provided')),!1;if(_.restrictions&&_.restrictions.length)for(var N=_.restrictions.length,V=0;V<N;V++){var X=_.restrictions[V],Y=X.restriction,q=X.message;if(!Y(k,v))return console.error("".concat(m," ").concat(C," invalid value: ").concat(q)),!1}return _.restriction&&!_.restriction(k,v)?(console.error("".concat(m," ").concat(C," invalid value: ").concat(_.message)),!1):_.validValues&&_.validValues.indexOf(k)===-1?(console.error("".concat(m," ").concat(C," invalid value: must be among ").concat(JSON.stringify(_.validValues),', "').concat(k,'" provided')),!1):!(_.children&&!h(k,_.children,"[Validate ".concat(C,"]")))});return w||S.push.apply(S,i(Object.keys(y).map(function(C){var k=y[C];if(typeof k=="string"&&(k={type:k}),k.mandatory){var _=k.mandatory;if(typeof _=="function"&&(_=_(v)),_&&v[C]===void 0)return console.error("".concat(m,' Missing mandatory key "').concat(C,'"')),!1}return!0}))),S.reduce(function(C,k){return C&&k},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,y){var m=c(v),w=d(y);return m&&w},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(AW);var Zfe=AW.exports;const zi=aj(Zfe);var Qfe="numeric";function YE(e,t,r,n,o,i,a){var l=i;if(wr(l)){var s=a.numericFormat,u=s&&s.culture||"-",f=s&&s.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!zi.languages()[u]){var d=u.replace("-",""),v=zi.allLanguages?zi.allLanguages[u]:zi[d];v&&zi.registerLanguage(v)}zi.setLanguage(u),l=zi(l).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}Hi(e,t,r,n,o,l,a)}YE.RENDERER_TYPE=Qfe;var Jfe="password";function GE(e,t,r,n,o,i,a){Hi.apply(this,[e,t,r,n,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Ce(l-1,function(){u+=s}),fl(t,u)}GE.RENDERER_TYPE=Jfe;var ece="time";function KE(e,t,r,n,o,i,a){Hi.apply(this,[e,t,r,n,o,i,a]),t.dir="ltr"}KE.RENDERER_TYPE=ece;var kv=on("renderers"),tce=kv.register,rce=kv.getItem,IW=kv.hasItem,nce=kv.getNames;kv.getValues;function fp(e){if(typeof e=="function")return e;if(!IW(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return rce(e)}function Hn(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),tce(e,t)}function oce(){Hn(Df),Hn(xf),Hn(UE),Hn(WE),Hn(YE),Hn(GE),Hn(Hi),Hn(KE)}var ice="autocomplete";function Km(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,QA(r,t)):QA(r,t)(this.source):t(!0)}Km.VALIDATOR_TYPE=ice;function QA(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var ace=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},lce=Zt,sce=mm,uce=jt,fce=_n,cce=Ar,JA=ace,eI=Kt,hce=nl,dce=bm;sce("search",function(e,t,r){return[function(o){var i=cce(this),a=fce(o)?void 0:hce(o,e);return a?lce(a,o,i):new RegExp(o)[e](eI(i))},function(n){var o=uce(this),i=eI(n),a=r(t,o,i);if(a.done)return a.value;var l=o.lastIndex;JA(l,0)||(o.lastIndex=0);var s=dce(o,i);return JA(o.lastIndex,l)||(o.lastIndex=l),s===null?-1:s.index}]});function MW(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const vce=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:MW},Symbol.toStringTag,{value:"Module"}));var yce="date";function qE(e,t){var r=mW(RW,this.instance),n=e,o=!0;n==null&&(n="");var i=ee(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=ee(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var l=gce(n,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}qE.VALIDATOR_TYPE=yce;function gce(e,t){var r=ee(MW(e)),n=ee(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var pce="numeric";function XE(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:wr(e))}XE.VALIDATOR_TYPE=pce;var mce=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],bce="time";function ZE(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=ee(o,mce,!0).isValid()?ee(o):ee(o,r),l=a.isValid(),s=ee(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,s=!0),l||(n=!1),!l&&s&&(n=!0),l&&!s)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}ZE.VALIDATOR_TYPE=bce;var $v=on("validators"),wce=$v.register,Sce=$v.getItem,xW=$v.hasItem,Cce=$v.getNames;$v.getValues;function QE(e){if(typeof e=="function")return e;if(!xW(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Sce(e)}function Zl(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),wce(e,t)}function _ce(){Zl(Km),Zl(qE),Zl(XE),Zl(ZE)}var Oce="autocomplete",Rce={CELL_TYPE:Oce,editor:BE,renderer:Df,validator:Km},Ece="checkbox",Tce={CELL_TYPE:Ece,editor:_W,renderer:UE},Pce="date",kce={CELL_TYPE:Pce,editor:EW,renderer:Df,validator:qE},$ce="dropdown",Ace={CELL_TYPE:$ce,editor:VE,renderer:Df,validator:Km},Ice="handsontable",Mce={CELL_TYPE:Ice,editor:FE,renderer:Df},xce="numeric",Dce={CELL_TYPE:xce,editor:TW,renderer:YE,validator:XE,dataType:"number"},Nce="password",Hce={CELL_TYPE:Nce,editor:PW,renderer:GE,copyable:!1},Lce="text",DW={CELL_TYPE:Lce,editor:cl,renderer:Hi},jce="time",Fce={CELL_TYPE:jce,editor:kW,renderer:KE,validator:ZE},Av=on("cellTypes"),Bce=Av.register,Vce=Av.getItem,NW=Av.hasItem,Wce=Av.getNames;Av.getValues;function JE(e){if(!NW(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Vce(e)}function cn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Pr(e,n),o&&Hn(e,o),i&&Zl(e,i),Bce(e,t)}function Uce(){cn(Rce),cn(Tce),cn(kce),cn(Ace),cn(Mce),cn(Dce),cn(Hce),cn(DW),cn(Fce)}var zce=vm,Yce=dF;zce("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Yce);function Gce(e){return Xce(e)||qce(e)||HW(e)||Kce()}function Kce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xce(e){if(Array.isArray(e))return w_(e)}function Zce(e,t){return ehe(e)||Jce(e,t)||HW(e,t)||Qce()}function Qce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HW(e,t){if(e){if(typeof e=="string")return w_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w_(e,t)}}function w_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ehe(e){if(Array.isArray(e))return e}var S_="asc",the="desc",tI=new Map([[S_,[-1,1]],[the,[1,-1]]]),rhe=function(t){return"The priority '".concat(t,"' is already declared in a map.")},nhe=function(t){return"The priority '".concat(t,"' is not a number.")};function ohe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=mt(t)?t:rhe,r=mt(r)?r:nhe;function o(a,l){if(!wr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,l)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:S_,l=tI.get(a)||tI.get(S_),s=Zce(l,2),u=s[0],f=s[1];return Gce(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}function ihe(e){return she(e)||lhe(e)||LW(e)||ahe()}function ahe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function she(e){if(Array.isArray(e))return C_(e)}function rI(e,t){return che(e)||fhe(e,t)||LW(e,t)||uhe()}function uhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LW(e,t){if(e){if(typeof e=="string")return C_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C_(e,t)}}function C_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function che(e){if(Array.isArray(e))return e}var hhe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function qm(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=mt(t)?t:hhe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function o(f){return r.delete(f)}function i(){r.clear()}function a(f){var c=s().find(function(v){var y=rI(v,2),m=y[0],w=y[1];return f===w?m:!1})||[null],h=rI(c,1),d=h[0];return d}function l(f){return r.get(f)}function s(){return ihe(r)}function u(f){return r.has(f)}return{addItem:n,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function dhe(e){return phe(e)||ghe(e)||yhe(e)||vhe()}function vhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yhe(e,t){if(e){if(typeof e=="string")return __(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return __(e,t)}}function ghe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function phe(e){if(Array.isArray(e))return __(e)}function __(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var mhe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function bhe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=mt(t)?t:mhe;function n(a){if(r.has(a))throw new Error(t(a));r.add(a)}function o(){return dhe(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function whe(e,t){return _he(e)||Che(e,t)||jW(e,t)||She()}function She(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Che(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _he(e){if(Array.isArray(e))return e}function nI(e){return Ehe(e)||Rhe(e)||jW(e)||Ohe()}function Ohe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jW(e,t){if(e){if(typeof e=="string")return O_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O_(e,t)}}function Rhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ehe(e){if(Array.isArray(e))return O_(e)}function O_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var eT=function(t){return'There is already registered "'.concat(t,'" plugin.')},The=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Phe=function(t){return'The priority "'.concat(t,'" is not a number.')},FW=ohe({errorPriorityExists:The,errorPriorityNaN:Phe}),BW=bhe({errorItemExists:eT}),R_=qm({errorIdExists:eT});function tT(){return[].concat(nI(FW.getItems()),nI(BW.getItems()))}function Iv(e){var t=ur(e);return R_.getItem(t)}function khe(e){return!!Iv(e)}function rt(e,t,r){var n=Ahe(e,t,r),o=whe(n,3);e=o[0],t=o[1],r=o[2],Iv(e)===void 0&&$he(e,t,r)}function $he(e,t,r){var n=ur(e);if(R_.hasItem(n))throw new Error(eT(n));r===void 0?BW.addItem(n):FW.addItem(r,n),R_.addItem(n,t)}function Ahe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function Ihe(e,t){return Nhe(e)||Dhe(e,t)||xhe(e,t)||Mhe()}function Mhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xhe(e,t){if(e){if(typeof e=="string")return oI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oI(e,t)}}function oI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Nhe(e){if(Array.isArray(e))return e}function Hhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jhe(n.key),n)}}function Lhe(e,t,r){return t&&iI(e.prototype,t),r&&iI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jhe(e){var t=Fhe(e,"string");return nh(t)==="symbol"?t:String(t)}function Fhe(e,t){if(nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bhe(e,t){Vhe(e,t),t.add(e)}function Vhe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Whe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var aI=new Map([["plugin",khe],["cell-type",NW],["editor",pW],["renderer",IW],["validator",xW]]),Uhe="base",Yi=new WeakMap,Iw=[],En=null,lI=new WeakSet,ot=function(){function e(t){var r=this;Hhe(this,e),Bhe(this,lI),Kn(this,"hot",t,{writable:!1}),Yi.set(this,{hooks:{}}),En=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Lhe(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=Ihe(f,2),h=c[0],d=c[1];if(!aI.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));aI.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Iw.push(a)}}En||(En=tT()),En.indexOf("UndoRedo")>=0&&En.splice(En.indexOf("UndoRedo"),1),En.indexOf(this.pluginName)>=0&&En.splice(En.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var l=En.length===0;if(l){if(Iw.length>0){var s=["".concat(Iw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Yi.get(this).hooks[r]=Yi.get(this).hooks[r]||[];var o=Yi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Yi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;A(Yi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Yi.get(this).hooks;ze(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){A(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=Whe(this,lI,zhe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ze(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Uhe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function zhe(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function oh(e){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oh(e)}function Yhe(e,t){return Xhe(e)||qhe(e,t)||Khe(e,t)||Ghe()}function Ghe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Khe(e,t){if(e){if(typeof e=="string")return sI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sI(e,t)}}function sI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Xhe(e){if(Array.isArray(e))return e}function Zhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jhe(n.key),n)}}function Qhe(e,t,r){return t&&uI(e.prototype,t),r&&uI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jhe(e){var t=ede(e,"string");return oh(t)==="symbol"?t:String(t)}function ede(e,t){if(oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tde=function(){function e(t){Zhe(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Qhe(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),A(this.rows,function(n){r(n.row,Pt(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),A(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){A(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),s.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(l){A(l.strings,function(s){var u=s.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),A(i,function(l){var s=Yhe(l,2),u=s[0],f=s[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){A(a.strings,function(l){var s=l.row,u=n.hot.getCellMeta(s,r);u.col=r,u.row=s;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,s,r,n.hot.colToProp(r),l.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),l=n.createElement("tbody"),s=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&l.appendChild(u),i.appendChild(l),te(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:l,colGroup:s,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return te(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const rT=tde;function ih(e){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ih(e)}function rde(e,t,r){return t=VW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VW(n.key),n)}}function ode(e,t,r){return t&&fI(e.prototype,t),r&&fI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VW(e){var t=ide(e,"string");return ih(t)==="symbol"?t:String(t)}function ide(e,t){if(ih(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ade=function(){function e(t){nde(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return ode(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,l=typeof o=="number"?{from:o,to:o}:o,s=l.from,u=l.to;return Ce(s,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,l=r==="row"?"col":"row",s=[];return Ce(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ue(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(Dt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var y=a.get(v);if(y.needed){var m=s.indexOf(c)>-1;(!m||i.allowDuplicates||d)&&(y.strings.push(rde({value:c},l,u)),s.push(c),y.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const WW=ade;var sa=1,lr=2;function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function lde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ude(n.key),n)}}function sde(e,t,r){return t&&cI(e.prototype,t),r&&cI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ude(e){var t=fde(e,"string");return ah(t)==="symbol"?t:String(t)}function fde(e,t){if(ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sl=new WeakMap,cde=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;lde(this,e),Sl.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return sde(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=0,l=0,s=Sl.get(this),u=s.calculationType,f=s.overrideFn,c=s.scrollOffset,h=Math.max(s.scrollOffset,0),d=s.totalColumns,v=s.viewportWidth,y=h>0?v+1:v,m=0;m<d;m++)if(i=this._getColumnWidth(m),r<=h&&u!==lr&&(this.startColumn=m,a=i),r>=h&&r+(u===lr?i:0)<=h+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=m,a=i),this.endColumn=m),o.push(r),r+=i,l=i,u!==lr&&(this.endColumn=m),r>=h+v){n=!1;break}var w=c+v-y,S=u===lr?0:l,C=u===lr?a:0;if(w<-1*s.inlineStartOffset||c>o.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var k=o[this.endColumn]+i-o[this.startColumn-1];if((k<=v||u!==lr)&&(this.startColumn-=1),k>v)break}u===sa&&this.startColumn!==null&&f&&f(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=Sl.get(this),i=o.totalColumns,a=0,l=0;l<i;l++){var s=this._getColumnWidth(l),u=o.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:a+=s}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=Sl.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var l=Math.round(n*this.stretchAllRatio),s=i.stretchingColumnWidthFn(l,r);s===void 0?this.stretchAllColumnsWidth[r]=l:this.stretchAllColumnsWidth[r]=isNaN(s)?this._getColumnWidth(r):s}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Sl.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Sl.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const nT=cde;function lh(e){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lh(e)}function hde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vde(n.key),n)}}function dde(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vde(e){var t=yde(e,"string");return lh(t)==="symbol"?t:String(t)}function yde(e,t){if(lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dI=new WeakMap,gde=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;hde(this,e),dI.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return dde(e,[{key:"calculate",value:function(){for(var r=dI.get(this),n=r.calculationType,o=r.overrideFn,i=r.rowHeightFn,a=r.scrollOffset,l=Math.max(r.scrollOffset,0),s=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,y=0,m=0,w=0;w<s;w++)if(v=i(w),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=l&&n!==lr&&(this.startRow=w,y=v),c>=l&&c+(n===lr?v:0)<=l+u-f&&(this.startRow===null&&(this.startRow=w,y=v),this.endRow=w),d.push(c),c+=v,m=v,n!==lr&&(this.endRow=w),c>=l+u-f){h=!1;break}var S=a+u-f,C=n===lr?y:0,k=n===lr?0:m;if(S<C||a>d.at(-1)+k?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var _=d[this.endRow]+v-d[this.startRow-1];if((_<=u-f||n!==lr)&&(this.startRow-=1),_>=u-f)break}n===sa&&this.startRow!==null&&o&&o(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const UW=gde;function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function pde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zW(n.key),n)}}function mde(e,t,r){return t&&vI(e.prototype,t),r&&vI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bde(e,t,r){wde(e,t),t.set(e,r)}function wde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yI(e,t,r){return t=zW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zW(e){var t=Sde(e,"string");return sh(t)==="symbol"?t:String(t)}function Sde(e,t){if(sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jf(e,t){var r=YW(e,t,"get");return Cde(e,r)}function Cde(e,t){return t.get?t.get.call(e):t.value}function _de(e,t,r){var n=YW(e,t,"set");return Ode(e,n,r),r}function YW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ode(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gi=new WeakMap,Rde=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;pde(this,e),yI(this,"row",null),yI(this,"col",null),bde(this,Gi,{writable:!0,value:!1}),_de(this,Gi,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return mde(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Jf(this,Gi)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Jf(this,Gi)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Jf(this,Gi)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Jf(this,Gi)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Jf(this,Gi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const cp=Rde;function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}function Ede(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GW(n.key),n)}}function Tde(e,t,r){return t&&gI(e.prototype,t),r&&gI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pde(e,t,r){kde(e,t),t.set(e,r)}function kde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mw(e,t,r){return t=GW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GW(e){var t=$de(e,"string");return uh(t)==="symbol"?t:String(t)}function $de(e,t){if(uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tn(e,t){var r=KW(e,t,"get");return Ade(e,r)}function Ade(e,t){return t.get?t.get.call(e):t.value}function Ide(e,t,r){var n=KW(e,t,"set");return Mde(e,n,r),r}function KW(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Mde(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Gr=new WeakMap,xde=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Ede(this,e),Mw(this,"highlight",null),Mw(this,"from",null),Mw(this,"to",null),Pde(this,Gr,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),Ide(this,Gr,o)}return Tde(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),a=r.getOuterTopStartCorner(),l=r.getOuterBottomEndCorner(),s=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,l.row),c=Math.max(o.col,l.col),h=this._createCellCoords(s,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Tn(this,Gr)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Tn(this,Gr)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Tn(this,Gr)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Tn(this,Gr)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Tn(this,Gr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Tn(this,Gr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Tn(this,Gr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Tn(this,Gr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof cp))return!1;if(n){var o=n.from,i=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(this._createCellCoords(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(this._createCellCoords(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var l=r(i,a);if(l===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Tn(this,Gr))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new cp(r,n,Tn(this,Gr))}}]),e}();const oT=xde;function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function Dde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hde(n.key),n)}}function Nde(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hde(e){var t=Lde(e,"string");return fh(t)==="symbol"?t:String(t)}function Lde(e,t){if(fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cl=new WeakMap,jde=function(){function e(t,r,n,o,i,a){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Dde(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,Cl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return Nde(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};pn()?n():(TE()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=Cl.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],l=a[0],s=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return l===s&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.wtTable.TABLE,i=Cc(r,["TD","TH"],o);return i?(n.coords=this.wtTable.getCoords(i),n.TD=i):xe(r,"wtBorder")&&xe(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):xe(r,"wtBorder")&&xe(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Cl.get(this),o=this.domBindings.rootDocument.activeElement,i=LE(JV,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var l=this.parentCell(a);xe(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,l.coords,l.TD),(r.button===0||this.touchApplied)&&l.TD&&(n.dblClickOrigin[0]=l.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,o=Cc(r.target,["TD","TH"],n),i=this.parent||this;o&&o!==i.lastMouseOver&&mi(o,n)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(o),o))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,o=Cc(r.target,["TD","TH"],n),i=Cc(r.relatedTarget,["TD","TH"],n),a=this.parent||this;o&&o!==i&&mi(o,n)&&(this.callListener("onCellMouseOut",r,this.wtTable.getCoords(o),o),i===null&&(a.lastMouseOver=null))}}},{key:"onMouseUp",value:function(r){var n=Cl.get(this),o=this.parentCell(r.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,o.coords,o.TD),!(r.button!==0&&!this.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(xe(r.target,"corner")?this.callListener("onCellCornerDblClick",r,o.coords,o.TD):this.callListener("onCellDblClick",r,o.coords,o.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Cl.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=ve(i)&&i.row>=0&&i.col>=0,l=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(l){var s=["A","BUTTON","INPUT"];_E()&&(xV()||DV())&&this.selectedCellWasTouched(o)&&!s.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,o,i){var a=this.wtSettings.getSettingPure(r);a&&a(n,o,i,this.facadeGetter())}},{key:"destroy",value:function(){var r=Cl.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const qW=jde;function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function Fde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vde(n.key),n)}}function Bde(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vde(e){var t=Wde(e,"string");return ch(t)==="symbol"?t:String(t)}function Wde(e,t){if(ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ude=function(){function e(t,r,n){Fde(this,e),this.offset=t,this.total=r,this.countTH=n}return Bde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const zde=Ude;function hh(e){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(e)}function Yde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kde(n.key),n)}}function Gde(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kde(e){var t=qde(e,"string");return hh(t)==="symbol"?t:String(t)}function qde(e,t){if(hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xde=function(){function e(t,r,n){Yde(this,e),this.offset=t,this.total=r,this.countTH=n}return Gde(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Zde=Xde;var Qde=0,hp=1,dp=2;function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function Jde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tve(n.key),n)}}function eve(e,t,r){return t&&wI(e.prototype,t),r&&wI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tve(e){var t=rve(e,"string");return dh(t)==="symbol"?t:String(t)}function rve(e,t){if(dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SI=function(){function e(){Jde(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return eve(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function nve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ive(n.key),n)}}function ove(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ive(e){var t=ave(e,"string");return vh(t)==="symbol"?t:String(t)}function ave(e,t){if(vh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lve=function(){function e(){nve(this,e),this.size=new SI,this.workingSpace=Qde,this.sharedSize=null}return ove(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof SI}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=hp,r.workingSpace=dp,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=dp,r.workingSpace=hp,this.sharedSize=r.getViewSize()}}]),e}();function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function sve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fve(n.key),n)}}function uve(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fve(e){var t=cve(e,"string");return yh(t)==="symbol"?t:String(t)}function cve(e,t){if(yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XW=function(){function e(t,r,n){sve(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new lve,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return uve(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(hp))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,l=this.getRenderedChildCount();l<a;){var s=this.nodesPool();!o||o&&n.isPlaceOn(dp)?r.appendChild(s):r.insertBefore(s,r.firstChild),l+=1}for(var u=o&&n.isPlaceOn(hp);l>a;)r.removeChild(u?r.firstChild:r.lastChild),l-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(dp)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Ls(e){"@babel/helpers - typeof";return Ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ls(e)}function hve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vve(n.key),n)}}function dve(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vve(e){var t=yve(e,"string");return Ls(t)==="symbol"?t:String(t)}function yve(e,t){if(Ls(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ls(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E_(e,t)}function E_(e,t){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},E_(e,t)}function pve(e){var t=wve();return function(){var n=vp(e),o;if(t){var i=vp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mve(this,o)}}function mve(e,t){if(t&&(Ls(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bve(e)}function bve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vp(e)}var ZW=function(e){gve(r,e);var t=pve(r);function r(){return hve(this,r),t.apply(this,arguments)}return dve(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(XW);function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function Sve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ve(n.key),n)}}function Cve(e,t,r){return t&&RI(e.prototype,t),r&&RI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ve(e){var t=Ove(e,"string");return gh(t)==="symbol"?t:String(t)}function Ove(e,t){if(gh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rve=function(){function e(t){Sve(this,e),this.nodeType=t.toUpperCase()}return Cve(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function Eve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pve(n.key),n)}}function Tve(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pve(e){var t=kve(e,"string");return ph(t)==="symbol"?t:String(t)}function kve(e,t){if(ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mv=function(){function e(t,r){Eve(this,e),this.nodesPool=typeof t=="string"?new Rve(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Tve(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function $ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ive(n.key),n)}}function Ave(e,t,r){return t&&TI(e.prototype,t),r&&TI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ive(e){var t=Mve(e,"string");return js(t)==="symbol"?t:String(t)}function Mve(e,t){if(js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T_(e,t)}function T_(e,t){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T_(e,t)}function Dve(e){var t=Lve();return function(){var n=yp(e),o;if(t){var i=yp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nve(this,o)}}function Nve(e,t){if(t&&(js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hve(e)}function Hve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yp(e){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yp(e)}var jve=function(e){xve(r,e);var t=Dve(r);function r(){var n;return $ve(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Ave(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new ZW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,l=o.rowHeadersCount,s=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=s.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(l).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<l;y++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),a[y](c,m,y)}d.end()}}}]),r}(Mv);function Fs(e){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(e)}function Fve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vve(n.key),n)}}function Bve(e,t,r){return t&&PI(e.prototype,t),r&&PI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vve(e){var t=Wve(e,"string");return Fs(t)==="symbol"?t:String(t)}function Wve(e,t){if(Fs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P_(e,t)}function P_(e,t){return P_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},P_(e,t)}function zve(e){var t=Kve();return function(){var n=gp(e),o;if(t){var i=gp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Yve(this,o)}}function Yve(e,t){if(t&&(Fs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gve(e)}function Gve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gp(e){return gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gp(e)}var qve=function(e){Uve(r,e);var t=zve(r);function r(n){return Fve(this,r),t.call(this,null,n)}return Bve(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,l=this.rootNode.firstChild;if(i){for(var s=this.table.columnsToRender,u=s+a,f=0,c=i;f<c;f++){for(l=this.rootNode.childNodes[f],l||(l=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(l)),this.renderedNodes=l.childNodes.length;this.renderedNodes<u;)l.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)l.removeChild(l.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else l&&Cn(l)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,l=a.columnHeaderFunctions,s=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<s;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),l[i](h,d,i)}}}]),r}(Mv);function Bs(e){"@babel/helpers - typeof";return Bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bs(e)}function Xve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qve(n.key),n)}}function Zve(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qve(e){var t=Jve(e,"string");return Bs(t)==="symbol"?t:String(t)}function Jve(e,t){if(Bs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k_(e,t)}function k_(e,t){return k_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},k_(e,t)}function tye(e){var t=oye();return function(){var n=pp(e),o;if(t){var i=pp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rye(this,o)}}function rye(e,t){if(t&&(Bs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nye(e)}function nye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pp(e){return pp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pp(e)}var iye=function(e){eye(r,e);var t=tye(r);function r(n){return Xve(this,r),t.call(this,null,n)}return Zve(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=i+a;this.renderedNodes<l;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>l;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,l=0;l<a;l++){var s=this.table.renderedColumnToSource(l),u=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[l].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&te(d,"rowHeader")}}]),r}(Mv);function Vs(e){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(e)}var $I;function aye(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uye(n.key),n)}}function sye(e,t,r){return t&&AI(e.prototype,t),r&&AI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uye(e){var t=fye(e,"string");return Vs(t)==="symbol"?t:String(t)}function fye(e,t){if(Vs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}function $_(e,t){return $_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$_(e,t)}function hye(e){var t=yye();return function(){var n=mp(e),o;if(t){var i=mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dye(this,o)}}function dye(e,t){if(t&&(Vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vye(e)}function vye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mp(e){return mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mp(e)}var II=!1,gye=function(e){cye(r,e);var t=hye(r);function r(n){var o;return lye(this,r),o=t.call(this,"TR",n),o.orderView=new XW(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return sye(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!II&&o>1e3&&(II=!0,wt(dt($I||($I=aye([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Mv);function Ws(e){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ws(e)}function pye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bye(n.key),n)}}function mye(e,t,r){return t&&MI(e.prototype,t),r&&MI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bye(e){var t=wye(e,"string");return Ws(t)==="symbol"?t:String(t)}function wye(e,t){if(Ws(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function A_(e,t){return A_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},A_(e,t)}function Cye(e){var t=Rye();return function(){var n=bp(e),o;if(t){var i=bp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return _ye(this,o)}}function _ye(e,t){if(t&&(Ws(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oye(e)}function Oye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bp(e){return bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bp(e)}var Eye=function(e){Sye(r,e);var t=Cye(r);function r(){var n;return pye(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return mye(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new ZW(o,function(l){return i.nodesPool.obtain(i.sourceRowIndex,l)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,l=o.rows,s=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=l.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=s.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var y=h.getCurrentNode(),m=this.table.renderedColumnToSource(v);xe(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(f,m,y)}h.end()}}}]),r}(Mv);function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function Tye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kye(n.key),n)}}function Pye(e,t,r){return t&&xI(e.prototype,t),r&&xI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kye(e){var t=$ye(e,"string");return mh(t)==="symbol"?t:String(t)}function $ye(e,t){if(mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aye=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Tye(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Pye(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,l=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),l.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=l}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),l=this.rowUtils.getHeight(a);l?i.firstChild.style.height="".concat(l-1,"px"):i.firstChild.style.height=""}}}}]),e}();function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function Iye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xye(n.key),n)}}function Mye(e,t,r){return t&&DI(e.prototype,t),r&&DI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xye(e){var t=Dye(e,"string");return bh(t)==="symbol"?t:String(t)}function Dye(e,t){if(bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nye=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;Iye(this,e),this.renderer=new Aye(r,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new jve,columnHeaders:new qve(n),colGroup:new iye(o),rows:new gye(i),cells:new Eye}),this.renderer.setAxisUtils(a,l)}return Mye(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function wh(e){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wh(e)}function Hye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jye(n.key),n)}}function Lye(e,t,r){return t&&NI(e.prototype,t),r&&NI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jye(e){var t=Fye(e,"string");return wh(t)==="symbol"?t:String(t)}function Fye(e,t){if(wh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bye=function(){function e(t,r){Hye(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Lye(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,o=this.getWidth(r);if(n){var i=n.getStretchedColumnWidth(r,o);i&&(o=i)}return o}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,o=n.wtTable,i=n.wtViewport,a=n.cloneSource,l=a?a.wtTable.holder:o.holder,s=l.offsetHeight<l.scrollHeight?Jt():0,u=r.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function Sh(e){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sh(e)}function Vye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uye(n.key),n)}}function Wye(e,t,r){return t&&HI(e.prototype,t),r&&HI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uye(e){var t=zye(e,"string");return Sh(t)==="symbol"?t:String(t)}function zye(e,t){if(Sh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yye=function(){function e(t,r){Vye(this,e),this.dataAccessObject=t,this.wtSettings=r}return Wye(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),o=this.dataAccessObject.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}();function Ch(e){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(e)}function Gye(e){return Xye(e)||qye(e)||QW(e)||Kye()}function Kye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xye(e){if(Array.isArray(e))return I_(e)}function Zye(e,t){return ege(e)||Jye(e,t)||QW(e,t)||Qye()}function Qye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QW(e,t){if(e){if(typeof e=="string")return I_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I_(e,t)}}function I_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jye(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ege(e){if(Array.isArray(e))return e}function tge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JW(n.key),n)}}function rge(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pn(e,t,r){return t=JW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JW(e){var t=nge(e,"string");return Ch(t)==="symbol"?t:String(t)}function nge(e,t){if(Ch(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oge=function(){function e(t,r,n,o,i){var a=this;tge(this,e),Pn(this,"wtSettings",null),Pn(this,"domBindings",void 0),Pn(this,"TBODY",null),Pn(this,"THEAD",null),Pn(this,"COLGROUP",null),Pn(this,"hasTableHeight",!0),Pn(this,"hasTableWidth",!0),Pn(this,"isTableVisible",!1),Pn(this,"tableOffset",0),Pn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,IE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(l)}),this.rowUtils=new Yye(this.dataAccessObject,this.wtSettings),this.columnUtils=new Bye(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Nye({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return rge(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!xe(n,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,o=this.dataAccessObject,i=o.wtOverlays,a=o.wtViewport,l=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Ut(this.holder),v=a.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var y=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,m!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=i.updateStateOfRendering()),v)this.isMaster&&a.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ut(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var w=l>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Zde(w,l,h),this.columnFilter=new zde(S,s,f);var C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var k={};this.wtSettings.getSetting("beforeDraw",!0,k),C=k.skipRender!==!0}if(C){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Bn)||this.is(bi))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var _;if(this.isMaster&&(_=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Bn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var N=ht(this.hider),V=ht(this.TABLE);N!==0&&V!==N&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),_!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Bn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var X=!1;return this.isMaster&&(X=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(X=i.bottomOverlay.resetFixedPosition()||X),X=i.inlineStartOverlay.resetFixedPosition()||X,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),X?(i.refreshAll(),i.adjustElementsSize()):this.refreshSelections(v),d&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),o=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),a,l,s,u=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.getColumnHeaderHeight(o),l=this.getColumnHeader(n,o),l&&(s=ho(l),(!a&&i<s||a<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,l=i.length;a<l;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Bn))&&!r.getSetting("externalRowCalculator"))for(var o=this.getRenderedRowsCount(),i=0;i<o;i++){var a=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Le(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,o=this.dataAccessObject.selections;if(o){var i=Array.from(o),a=i.length;if(r){for(var l=[],s=0;s<a;s++){for(var u=i[s].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=i[s].classNames,v=d.length,y=0;y<v;y++)l.includes(d[y])||l.push(d[y]);f&&!l.includes(f)&&l.push(f),c&&!l.includes(c)&&l.push(c),h&&!l.includes(h)&&l.push(h)}var m=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var w=0;w<m.length;w++)l.push(m[w]);for(var S=l.length,C=0;C<S;C++)this.removeClassFromCells(l[C])}for(var k=0;k<a;k++)i[k].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=Zye(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var l=this.getRow(n);if(!l&&n>=0)throw new Error("TR was expected to be rendered but is not");var s=l.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(r){var n=null,o=null;if(r<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(r),o=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),o=this.TBODY}return n!==void 0&&o!==void 0?o.childNodes.length<n+1?!1:o.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wtSettings.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],l=a==null?void 0:a.childNodes[i];l&&n.push(l)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=pi(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=tW(o),l=n.cellIndex;if(li(qa,n,this.wtRootElement)||li(Ga,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(li(bi,n,this.wtRootElement)||li(Bn,n,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");a=s-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return li(qa,n,this.wtRootElement)||li(Ka,n,this.wtRootElement)||li(bi,n,this.wtRootElement)?l=this.columnFilter.offsettedTH(l):l=this.columnFilter.visibleRowHeadedColumnToSourceColumn(l),this.wot.createCellCoords(a,l)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),o=ho(this.TBODY)-1,i,a,l,s,u;if(!(n===o&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,l=this.rowFilter.renderedToSource(r),i=this.getRowHeight(l),s=this.getTrForRow(l),u=s.querySelector("th"),u?a=ho(u):a=ho(s)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<a||i<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[l]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ht(this.TABLE)}},{key:"getHeight",value:function(){return Pt(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=ht(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Pt(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return bs(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=mt(r)?r():null;return Array.isArray(n)?(n=Gye(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Nf=oge;var ige="stickyRowsBottom",e2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(e2,"MIXIN_NAME",ige,{writable:!1,enumerable:!1});const t2=e2;var age="stickyColumnsStart",r2={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Kn(r2,"MIXIN_NAME",age,{writable:!1,enumerable:!1});const iT=r2;function Us(e){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(e)}function jI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sge(n.key),n)}}function lge(e,t,r){return t&&jI(e.prototype,t),r&&jI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sge(e){var t=uge(e,"string");return Us(t)==="symbol"?t:String(t)}function uge(e,t){if(Us(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Us(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M_(e,t)}function M_(e,t){return M_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},M_(e,t)}function hge(e){var t=yge();return function(){var n=wp(e),o;if(t){var i=wp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dge(this,o)}}function dge(e,t){if(t&&(Us(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vge(e)}function vge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wp(e){return wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wp(e)}var aT=function(e){cge(r,e);var t=hge(r);function r(n,o,i,a){return fge(this,r),t.call(this,n,o,i,a,bi)}return lge(r)}(Nf);gt(aT,t2);gt(aT,iT);const gge=aT;var Ga="top",Bn="bottom",Ka="inline_start",qa="top_inline_start_corner",bi="bottom_inline_start_corner",pge=[Ga,Bn,Ka,qa,bi],mge=new Map([[Ga,"ht_clone_".concat(Ga)],[Bn,"ht_clone_".concat(Bn)],[Ka,"ht_clone_".concat(Ka," ht_clone_left")],[qa,"ht_clone_".concat(qa," ht_clone_top_left_corner")],[bi,"ht_clone_".concat(bi," ht_clone_bottom_left_corner")]]),bge=Yt,wge=Math.floor,Sge=Number.isInteger||function(t){return!bge(t)&&isFinite(t)&&wge(t)===t},Cge=$e,_ge=Sge;Cge({target:"Number",stat:!0},{isInteger:_ge});function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function Oge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n2(n.key),n)}}function Rge(e,t,r){return t&&FI(e.prototype,t),r&&FI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xw(e,t,r){return t=n2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n2(e){var t=Ege(e,"string");return _h(t)==="symbol"?t:String(t)}function Ege(e,t){if(_h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tge=function(){function e(t){Oge(this,e),xw(this,"dataAccessObject",void 0),xw(this,"lastScrolledColumnPos",-1),xw(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Rge(e,[{key:"scrollViewport",value:function(r,n,o,i,a){var l=this.scrollViewportHorizontally(r.col,o,a),s=this.scrollViewportVertically(r.row,n,i);return l||s}},{key:"scrollViewportHorizontally",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return s===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<s||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,o){var i=this.dataAccessObject,a=i.drawn,l=i.totalRows;if(!a||!Number.isInteger(r)||r<0||r>l)return!1;var s=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&o===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>l-h-1))return!1;var y=!1;return s===-1?y=v.scrollTo(r,f?r>this.lastScrolledRowPos:o):(f&&(r<s||r>u)||!f)&&(y=v.scrollTo(r,f?r>u:o)),y&&(this.lastScrolledRowPos=r),y}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.fixedRowsTop,s=r.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===s){var f=Ut(o.wtRootElement),c=ho(o.hider),h=ho(s),d=Zc(s,s);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,l);for(var y=a;y>0;y--)if(v+=n.sumCellSizes(y-1,y),f.top+c-v<=d){u=y;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,l=r.rootWindow,s=o.getLastVisibleRow();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=Zc(l,l);if(u.top>f){for(var c=ho(l),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){s=d-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,l=r.rootWindow,s=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===l){var u=Ut(o.wtRootElement),f=Ac(o.hider),c=Ac(l),h=Math.abs(np(l,l));if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){s=v;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,o=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,l=r.totalColumns,s=r.rootWindow,u=i.getLastVisibleColumn();if(o.mainTableScrollableElement===s){var f=n.getSetting("rtlMode"),c=null;if(f){var h=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var y=Ut(i.wtRootElement);c=y.left}var m=Math.abs(np(s,s));if(c>m){for(var w=Ac(s),S=a.getRowHeaderWidth(),C=1;C<=l;C++)if(S+=o.sumCellSizes(C-1,C),c+S-m>=w){u=C-2;break}}}return u}}]),e}();const Pge=Tge;function Oh(e){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oh(e)}function kge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o2(n.key),n)}}function $ge(e,t,r){return t&&BI(e.prototype,t),r&&BI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sn(e,t,r){return t=o2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o2(e){var t=Age(e,"string");return Oh(t)==="symbol"?t:String(t)}function Age(e,t){if(Oh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lT=function(){function e(t,r){kge(this,e),sn(this,"wtTable",void 0),sn(this,"wtScroll",void 0),sn(this,"wtViewport",void 0),sn(this,"wtOverlays",void 0),sn(this,"selections",void 0),sn(this,"wtEvent",void 0),sn(this,"guid","wt_".concat(kE())),sn(this,"drawInterrupted",!1),sn(this,"drawn",!1),sn(this,"domBindings",void 0),sn(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Pge(this.createScrollDao())}return $ge(e,[{key:"eventManager",get:function(){return new kt(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(i,a){Ai(a,r[i])}])}}},{key:"createCellCoords",value:function(r,n){return new cp(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,o){return new oT(r,n,o,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<i&&r.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<l&&r.row>=o-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function VI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i2(n.key),n)}}function Ige(e,t,r){return t&&VI(e.prototype,t),r&&VI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},x_(e,t)}function Dge(e){var t=Hge();return function(){var n=Sp(e),o;if(t){var i=Sp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nge(this,o)}}function Nge(e,t){if(t&&(zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wg(e)}function wg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sp(e){return Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sp(e)}function WI(e,t,r){return t=i2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i2(e){var t=Lge(e,"string");return zs(t)==="symbol"?t:String(t)}function Lge(e,t){if(zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jge=function(e){xge(r,e);var t=Dge(r);function r(n,o,i){var a;Mge(this,r),a=t.call(this,n,o),WI(wg(a),"cloneSource",void 0),WI(wg(a),"cloneOverlay",void 0);var l=a.wtSettings.getSetting("facade",wg(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),l,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new qW(l,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Ige(r)}(lT);function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}function Fge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a2(n.key),n)}}function Bge(e,t,r){return t&&UI(e.prototype,t),r&&UI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vge(e,t,r){return t=a2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a2(e){var t=Wge(e,"string");return Rh(t)==="symbol"?t:String(t)}function Wge(e,t){if(Rh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xv=function(){function e(t,r,n,o,i){Fge(this,e),Vge(this,"wtSettings",null),Kn(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,f=a.holder,c=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=Ua(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Bge(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Ua(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Qc(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){wt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.domBindings.rootWindow,a=o<this.wtSettings.getSetting("fixedColumnsStart"),l=n<this.wtSettings.getSetting("fixedRowsTop"),s=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return i?h=this.getRelativeCellPositionWithinWindow(l,a,c,f):h=this.getRelativeCellPositionWithinHolder(l,s,a,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,s=0;if(!n)l=i.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+Jt())),l=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();s=f.top-a.top}else s=i.top;return{start:o.start+l,top:o.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var l={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,u=0;if(o||(s=l.horizontal-a.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=l.vertical-a.top);return{start:i.start-s,top:i.top-u}}},{key:"makeClone",value:function(){if(pge.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),l=o.createElement("TABLE"),s=r.wtRootElement.parentNode;a.className="".concat(mge.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,l.className=r.TABLE.className,a.appendChild(l),s.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ga||u==="vertical"&&this.type===Ka?this.mainTableScrollableElement=i:i.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Qc(r.TABLE),new jge(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;A([o,i,a],function(l){l.width="",l.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Ys(e){"@babel/helpers - typeof";return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(e)}function Sg(e,t,r){return l2()?Sg=Reflect.construct.bind():Sg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Cp(u,a.prototype),u},Sg.apply(null,arguments)}function Uge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yge(n.key),n)}}function zge(e,t,r){return t&&zI(e.prototype,t),r&&zI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yge(e){var t=Gge(e,"string");return Ys(t)==="symbol"?t:String(t)}function Gge(e,t){if(Ys(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ys(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cp(e,t)}function Cp(e,t){return Cp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Cp(e,t)}function qge(e){var t=l2();return function(){var n=_p(e),o;if(t){var i=_p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Xge(this,o)}}function Xge(e,t){if(t&&(Ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zge(e)}function Zge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _p(e){return _p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_p(e)}var Qge=function(e){Kge(r,e);var t=qge(r);function r(n,o,i,a,l,s){var u;return Uge(this,r),u=t.call(this,n,o,bi,i,a),u.bottomOverlay=l,u.inlineStartOverlay=s,u}return zge(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Sg(gge,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!o.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),l=this.bottomOverlay.getOverlayOffset();i.style[this.isRtl()?"right":"left"]="".concat(a,"px"),i.style.bottom="".concat(l,"px")}else Tv(i),this.repositionOverlay();var s=Pt(this.clone.wtTable.TABLE),u=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}}]),r}(xv),Jge="calculatedColumns",s2={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Kn(s2,"MIXIN_NAME",Jge,{writable:!1,enumerable:!1});const sT=s2;function Gs(e){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gs(e)}function YI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tpe(n.key),n)}}function epe(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tpe(e){var t=rpe(e,"string");return Gs(t)==="symbol"?t:String(t)}function rpe(e,t){if(Gs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function npe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ope(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D_(e,t)}function D_(e,t){return D_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},D_(e,t)}function ipe(e){var t=spe();return function(){var n=Op(e),o;if(t){var i=Op(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ape(this,o)}}function ape(e,t){if(t&&(Gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lpe(e)}function lpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function spe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Op(e)}var uT=function(e){ope(r,e);var t=ipe(r);function r(n,o,i,a){return npe(this,r),t.call(this,n,o,i,a,Bn)}return epe(r)}(Nf);gt(uT,t2);gt(uT,sT);const upe=uT;function Ks(e){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function Cg(e,t,r){return f2()?Cg=Reflect.construct.bind():Cg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Rp(u,a.prototype),u},Cg.apply(null,arguments)}function fpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c2(n.key),n)}}function cpe(e,t,r){return t&&GI(e.prototype,t),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rp(e,t)}function Rp(e,t){return Rp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Rp(e,t)}function dpe(e){var t=f2();return function(){var n=Ep(e),o;if(t){var i=Ep(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vpe(this,o)}}function vpe(e,t){if(t&&(Ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u2(e)}function u2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ep(e)}function ype(e,t,r){return t=c2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c2(e){var t=gpe(e,"string");return Ks(t)==="symbol"?t:String(t)}function gpe(e,t){if(Ks(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ks(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ppe=function(e){hpe(r,e);var t=dpe(r);function r(n,o,i,a){var l;return fpe(this,r),l=t.call(this,n,o,Bn,i,a),ype(u2(l),"cachedFixedRowsBottom",-1),l.cachedFixedRowsBottom=l.wtSettings.getSetting("fixedRowsBottom"),l}return cpe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Cg(upe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode;i.style.top="";var a=0,l=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===o&&(!l||l!=="vertical")?(a=this.getOverlayOffset(),i.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-i.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=Jt(l)),s.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Wa(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,l=a.wtTable,s=a.wtSettings,u=s.getSetting("defaultRowHeight"),f=o,c=0;f<i;){var h=l.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,l=this.domBindings,s=l.rootDocument,u=l.rootWindow,f=Jt(s),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,i.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var y=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),h.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;i&&s.offsetHeight!==s.clientHeight&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Zc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s,f=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+l,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,l=this.wtSettings.getSetting("columnHeaders"),s=!1;if((a||i===0)&&l.length>0){var u=this.wot.wtTable.holder.parentNode,f=xe(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),o||this.wtSettings.getSetting("totalRows")===0?(te(u,"innerBorderBottom"),s=!f):(Le(u,"innerBorderBottom"),s=f)}return s}}]),r}(xv),mpe="calculatedRows",h2={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Kn(h2,"MIXIN_NAME",mpe,{writable:!1,enumerable:!1});const d2=h2;function qs(e){"@babel/helpers - typeof";return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qs(e)}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wpe(n.key),n)}}function bpe(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wpe(e){var t=Spe(e,"string");return qs(t)==="symbol"?t:String(t)}function Spe(e,t){if(qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _pe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N_(e,t)}function N_(e,t){return N_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},N_(e,t)}function Ope(e){var t=Tpe();return function(){var n=Tp(e),o;if(t){var i=Tp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rpe(this,o)}}function Rpe(e,t){if(t&&(qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Epe(e)}function Epe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tp(e)}var fT=function(e){_pe(r,e);var t=Ope(r);function r(n,o,i,a){return Cpe(this,r),t.call(this,n,o,i,a,Ka)}return bpe(r)}(Nf);gt(fT,d2);gt(fT,iT);const Ppe=fT;function Xs(e){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(e)}function _g(e,t,r){return v2()?_g=Reflect.construct.bind():_g=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Pp(u,a.prototype),u},_g.apply(null,arguments)}function kpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ape(n.key),n)}}function $pe(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ape(e){var t=Ipe(e,"string");return Xs(t)==="symbol"?t:String(t)}function Ipe(e,t){if(Xs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pp(e,t)}function Pp(e,t){return Pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Pp(e,t)}function xpe(e){var t=v2();return function(){var n=kp(e),o;if(t){var i=kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Dpe(this,o)}}function Dpe(e,t){if(t&&(Xs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Npe(e)}function Npe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kp(e){return kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kp(e)}var Hpe=function(e){Mpe(r,e);var t=xpe(r);function r(n,o,i,a){return kpe(this,r),t.call(this,n,o,Ka,i,a)}return $pe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return _g(Ppe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!this.needFullRender||!o.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,l=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===i&&(!l||l!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),zm(a,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),Tv(a));var u=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(o=-o),this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,ws(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),l=o,s=0;l<i;)s+=this.wot.wtTable.getStretchedColumnWidth(l)||a,l+=1;return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=s),h=Math.min(h,o.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=ht(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalColumns"),i=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style[i]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),l=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=l.wtTable.holder,u=0;if(i){var f=this.wot.wtTable.getColumnWidth(o),c=this.wot.wtViewport.getViewportWidth();f>c&&(i=!1)}return i&&s.offsetWidth!==s.clientWidth&&(u=Jt(this.domBindings.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wtSettings.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.domBindings.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Math.abs(np(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var l=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),u=l-s;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),l=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Le(i,"emptyRows"):te(i,"emptyRows");var u=!1;if(l&&!a.length)te(i,"innerBorderLeft innerBorderInlineStart");else if(!l&&a.length){var f=xe(i,"innerBorderInlineStart");o?(te(i,"innerBorderLeft innerBorderInlineStart"),u=!f):(Le(i,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(xv),Lpe="stickyRowsTop",y2={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(y2,"MIXIN_NAME",Lpe,{writable:!1,enumerable:!1});const g2=y2;function Zs(e){"@babel/helpers - typeof";return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(e)}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fpe(n.key),n)}}function jpe(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fpe(e){var t=Bpe(e,"string");return Zs(t)==="symbol"?t:String(t)}function Bpe(e,t){if(Zs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H_(e,t)}function H_(e,t){return H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},H_(e,t)}function Upe(e){var t=Gpe();return function(){var n=$p(e),o;if(t){var i=$p(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return zpe(this,o)}}function zpe(e,t){if(t&&(Zs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ype(e)}function Ype(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $p(e){return $p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$p(e)}var cT=function(e){Wpe(r,e);var t=Upe(r);function r(n,o,i,a){return Vpe(this,r),t.call(this,n,o,i,a,qa)}return jpe(r)}(Nf);gt(cT,g2);gt(cT,iT);const Kpe=cT;function Qs(e){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(e)}function Og(e,t,r){return p2()?Og=Reflect.construct.bind():Og=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&Ap(u,a.prototype),u},Og.apply(null,arguments)}function qpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m2(n.key),n)}}function Xpe(e,t,r){return t&&ZI(e.prototype,t),r&&ZI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ap(e,t)}function Ap(e,t){return Ap=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ap(e,t)}function Qpe(e){var t=p2();return function(){var n=Ip(e),o;if(t){var i=Ip(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jpe(this,o)}}function Jpe(e,t){if(t&&(Qs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L_(e)}function L_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}function QI(e,t,r){return t=m2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m2(e){var t=eme(e,"string");return Qs(t)==="symbol"?t:String(t)}function eme(e,t){if(Qs(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qs(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tme=function(e){Zpe(r,e);var t=Qpe(r);function r(n,o,i,a,l,s){var u;return qpe(this,r),u=t.call(this,n,o,qa,i,a),QI(L_(u),"topOverlay",void 0),QI(L_(u),"inlineStartOverlay",void 0),u.topOverlay=l,u.inlineStartOverlay=s,u}return Xpe(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Og(Kpe,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();zm(o,"".concat(i,"px"),"".concat(a,"px"))}else Tv(o);var l=Pt(this.clone.wtTable.TABLE),s=ht(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(s,"px"),!1}}]),r}(xv);function Js(e){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Js(e)}function JI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nme(n.key),n)}}function rme(e,t,r){return t&&JI(e.prototype,t),r&&JI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nme(e){var t=ome(e,"string");return Js(t)==="symbol"?t:String(t)}function ome(e,t){if(Js(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Js(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ime(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ame(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j_(e,t)}function j_(e,t){return j_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},j_(e,t)}function lme(e){var t=fme();return function(){var n=Mp(e),o;if(t){var i=Mp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sme(this,o)}}function sme(e,t){if(t&&(Js(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ume(e)}function ume(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mp(e){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mp(e)}var hT=function(e){ame(r,e);var t=lme(r);function r(n,o,i,a){return ime(this,r),t.call(this,n,o,i,a,Ga)}return rme(r)}(Nf);gt(hT,g2);gt(hT,sT);const cme=hT;function eu(e){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(e)}function Rg(e,t,r){return w2()?Rg=Reflect.construct.bind():Rg=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&xp(u,a.prototype),u},Rg.apply(null,arguments)}function hme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S2(n.key),n)}}function dme(e,t,r){return t&&eM(e.prototype,t),r&&eM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xp(e,t)}function xp(e,t){return xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},xp(e,t)}function yme(e){var t=w2();return function(){var n=Dp(e),o;if(t){var i=Dp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gme(this,o)}}function gme(e,t){if(t&&(eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b2(e)}function b2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dp(e){return Dp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dp(e)}function pme(e,t,r){return t=S2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S2(e){var t=mme(e,"string");return eu(t)==="symbol"?t:String(t)}function mme(e,t){if(eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bme=function(e){vme(r,e);var t=yme(r);function r(n,o,i,a){var l;return hme(this,r),l=t.call(this,n,o,Ga,i,a),pme(b2(l),"cachedFixedRowsTop",-1),l.cachedFixedRowsTop=l.wtSettings.getSetting("fixedRowsTop"),l}return dme(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return Rg(cme,i)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode,i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),l=0,s=!1;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=o.offsetHeight;s=c===h,l=this.getOverlayOffset(),zm(o,"0px","".concat(l,"px"))}else l=this.getScrollPosition(),Tv(o);var d=this.adjustHeaderBordersPosition(l,s);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(o){var i=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Wa(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wtSettings.getSetting("defaultRowHeight"),l=o,s=0;l<i;){var u=this.wot.wtTable.getRowHeight(l);s+=u===void 0?a:u,l+=1}return s}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot.wtTable,i=this.domBindings,a=i.rootDocument,l=i.rootWindow,s=Jt(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,o.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,l=this.facadeGetter(),s=Math.abs((o=a==null?void 0:a.getCell().getBorder(l).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var o=this.isRtl()?"right":"left",i=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?i.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):i.style[o]=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,l=this.wtSettings,s=a.cloneSource?a.cloneSource:a,u=s.wtTable.holder,f=this.getTableParentOffset(),c=0;if(i){var h=this.wot.wtTable.getRowHeight(o),d=this.wot.wtViewport.getViewportHeight();h>d&&(i=!1)}if(i&&u.offsetHeight!==u.clientHeight&&(c=Jt(this.domBindings.rootDocument)),i){var v=l.getSetting("fixedRowsBottom"),y=l.getSetting("totalRows");f+=this.sumCellSizes(0,o+1),f-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),f+=1}else f+=this.sumCellSizes(l.getSetting("fixedRowsTop"),o);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Zc(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),u=l-s;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,l=this.wtSettings.getSetting("totalColumns");l?Le(a,"emptyColumns"):te(a,"emptyColumns");var s=!1;if(!i){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=xe(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o||this.wtSettings.getSetting("totalRows")===0?(te(a,"innerBorderTop"),s=!h):(Le(a,"innerBorderTop"),s=h)}}return s}}]),r}(xv);function Eh(e){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(e)}function fi(e,t,r){return wme()?fi=Reflect.construct.bind():fi=function(o,i,a){var l=[null];l.push.apply(l,i);var s=Function.bind.apply(o,l),u=new s;return a&&F_(u,a.prototype),u},fi.apply(null,arguments)}function wme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F_(e,t){return F_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},F_(e,t)}function Sme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C2(n.key),n)}}function Cme(e,t,r){return t&&tM(e.prototype,t),r&&tM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qn(e,t,r){return t=C2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C2(e){var t=_me(e,"string");return Eh(t)==="symbol"?t:String(t)}function _me(e,t){if(Eh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ome=function(){function e(t,r,n,o,i,a){var l=this;Sme(this,e),Qn(this,"wot",null),Qn(this,"topOverlay",null),Qn(this,"bottomOverlay",null),Qn(this,"inlineStartOverlay",null),Qn(this,"topInlineStartCornerOverlay",null),Qn(this,"bottomInlineStartCornerOverlay",null),Qn(this,"browserLineHeight",void 0),Qn(this,"wtSettings",null),Qn(this,"resizeObserver",new ResizeObserver(function(h){Wm(function(){!Array.isArray(h)||!h.length||l.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,f=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Jt(u);var c=f.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:Qc(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return Cme(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,o=r.rootDocument,i=n.getComputedStyle(o.body),a=parseInt(i.lineHeight,10),l=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=a||l}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=fi(bme,r),this.bottomOverlay=fi(ppe,r),this.inlineStartOverlay=fi(Hpe,r),this.topInlineStartCornerOverlay=fi(tme,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=fi(Qge,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==l&&this.eventManager.addEventListener(l,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var s=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||s||!CE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var y=v.clone.wtTable.holder;r.eventManager.addEventListener(y,"wheel",function(m){return r.onCloneWheel(m,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,l=r.target,s=a!==o&&l!==o&&!l.contains(a),u=i!==o&&l!==o&&!l.contains(i);if(!(this.keyPressed&&(s||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=ms(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,o=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(o+=o*this.browserLineHeight,n+=n*this.browserLineHeight);var i=this.scrollVertically(n),a=this.scrollHorizontally(o);return i||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],l=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==l||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Qc(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,o=r.clientHeight,i=n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o),i}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,o=this.wtTable,i=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),l=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),u=o.hider.style;if(u.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,i),"px"),u.height="".concat(s+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var f=o.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=o.holder,v=d.scrollHeight,y=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<y,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=null;return A(n,function(i){i&&i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,function(o){o&&(o.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Rme=Ome;function Th(e){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(e)}function Eme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_2(n.key),n)}}function Tme(e,t,r){return t&&rM(e.prototype,t),r&&rM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nM(e,t,r){return t=_2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _2(e){var t=Pme(e,"string");return Th(t)==="symbol"?t:String(t)}function Pme(e,t){if(Th(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kme=function(){function e(t){var r=this;Eme(this,e),nM(this,"settings",{}),nM(this,"defaults",Object.freeze(this.getDefaults())),ze(this.defaults,function(n,o){if(t[o]!==void 0)r.settings[o]=t[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return Tme(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,i,a){var l=r.getSetting("data",o,i);Ai(a,l??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var o=this;return n===void 0?ze(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function tu(e){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tu(e)}function $me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ime(n.key),n)}}function Ame(e,t,r){return t&&oM(e.prototype,t),r&&oM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ime(e){var t=Mme(e,"string");return tu(t)==="symbol"?t:String(t)}function Mme(e,t){if(tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B_(e,t)}function B_(e,t){return B_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},B_(e,t)}function Dme(e){var t=Lme();return function(){var n=Np(e),o;if(t){var i=Np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nme(this,o)}}function Nme(e,t){if(t&&(tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hme(e)}function Hme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Np(e)}var dT=function(e){xme(r,e);var t=Dme(r);function r(n,o,i,a){return $me(this,r),t.call(this,n,o,i,a,"master")}return Ame(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Ua(this.wtRootElement),i=this.domBindings.rootWindow;if(o===i){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var l=o.parentElement,s=Ss(o,"height",i),u=Ss(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,y=d.height,m=["auto","hidden","scroll"];if(l&&m.includes(u)){var w=o.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",o.nextElementSibling?l.insertBefore(w,o.nextElementSibling):l.appendChild(w);var S=parseInt(Ii(w,i).height,10);l.removeChild(w),S===0&&(y=0)}y=Math.min(y,h),f.height=s==="auto"?"auto":"".concat(y,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:y>0,this.hasTableWidth=v>0}this.isTableVisible=bs(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wtSettings,i=this.dataAccessObject.wtViewport,a="master",l=o.getSetting("columnHeaders"),s=l.length;if(s&&!i.hasOversizedColumnHeadersMarked[a]){for(var u=o.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<s;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);i.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Nf);gt(dT,d2);gt(dT,sT);const jme=dT;function Ph(e){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ph(e)}function Fme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vme(n.key),n)}}function Bme(e,t,r){return t&&iM(e.prototype,t),r&&iM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vme(e){var t=Wme(e,"string");return Ph(t)==="symbol"?t:String(t)}function Wme(e,t){if(Ph(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ume=function(){function e(t,r,n,o,i){var a=this;Fme(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Bme(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,o=0;if(n===this.domBindings.rootWindow)o=r.documentElement.clientHeight;else{var i=Pt(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,o=n.rootDocument,i=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-l:c.left,d=l-h,v,y;if(u)return ht(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,l):v=Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>v)return o.documentElement.clientWidth;if(a!==i&&(y=Ss(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(v,a.clientWidth);var m=r.getSetting("stretchH");return m==="none"||!m?Math.max(v,ht(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=0,i=r;i<n;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Ut(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Pt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var l=0,s=n.length;l<s;l++)a?(this.rowHeaderWidth+=ht(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sa,n=this.wtSettings,o=this.wtTable,i,a,l;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===sa?i=1/0:i=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&s>=0&&(l=this.dataAccessObject.topOverlay.sumCellSizes(0,u),s+=l,i-=l),f&&this.dataAccessObject.bottomOverlay.clone&&(l=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),i-=l),o.holder.clientHeight===o.holder.offsetHeight?a=0:a=Jt(this.domBindings.rootDocument),new UW({viewportSize:i,scrollOffset:s,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return o.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sa,n=this.wtSettings,o=this.wtTable,i=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var l=n.getSetting("fixedColumnsStart");if(l&&a>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);a+=s,i-=s}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new nT({viewportSize:i,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return o.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(lr),i=this.createColumnsCalculator(lr);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(sa),this.columnsRenderCalculator=this.createColumnsCalculator(sa)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(lr),this.columnsVisibleCalculator=this.createColumnsCalculator(lr)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.rowsRenderCalculator,l=a.startRow,s=a.endRow;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=r.isVisibleInTrimmingContainer;if(n===null&&o===null)return!i;var a=this.columnsRenderCalculator,l=a.startColumn,s=a.endColumn;return n<l||n===l&&n>0?!1:!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){ze(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}();const zme=Ume;function ru(e){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ru(e)}function Yme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kme(n.key),n)}}function Gme(e,t,r){return t&&aM(e.prototype,t),r&&aM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kme(e){var t=qme(e,"string");return ru(t)==="symbol"?t:String(t)}function qme(e,t){if(ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V_(e,t)}function V_(e,t){return V_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},V_(e,t)}function Zme(e){var t=Jme();return function(){var n=Hp(e),o;if(t){var i=Hp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qme(this,o)}}function Qme(e,t){if(t&&(ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W_(e)}function W_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hp(e){return Hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hp(e)}var ebe=function(e){Xme(r,e);var t=Zme(r);function r(n,o){var i;Yme(this,r),i=t.call(this,n,new kme(o));var a=i.wtSettings.getSetting("facade",W_(i));return i.wtTable=new jme(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new zme(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new qW(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Rme(W_(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return Gme(r,[{key:"exportSettingsAsClassNames",value:function(){var o=this,i={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],l=[];ze(i,function(s,u){o.wtSettings.getSetting(u).length&&l.push(s),a.push(s)}),Le(this.wtTable.wtRootElement.parentNode,a),te(this.wtTable.wtRootElement.parentNode,l)}},{key:"getViewportDao",value:function(){var o=this;return{get wot(){return o},get topOverlayTrimmingContainer(){return o.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return o.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return o.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return o.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return o.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return o.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return o.wtOverlays.topOverlay},get inlineStartOverlay(){return o.wtOverlays.inlineStartOverlay},get bottomOverlay(){return o.wtOverlays.bottomOverlay}}}}]),r}(lT);function kh(e){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kh(e)}function tbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nbe(n.key),n)}}function rbe(e,t,r){return t&&lM(e.prototype,t),r&&lM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nbe(e){var t=obe(e,"string");return kh(t)==="symbol"?t:String(t)}function obe(e,t){if(kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ibe=function(){function e(t){tbe(this,e),t instanceof lT?this._wot=t:this._initFromSettings(t)}return rbe(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var o=new e(n);return function(){return o}},this._wot=new ebe(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,o){return this._wot.createCellRange(r,n,o)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wot.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wot.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wot.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,o,i,a){return this._wot.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),O2=Gt,abe=je,R2=Ye,lbe=fv,sbe=rv,ube=zr,fbe=av.f,E2=R2(fbe),cbe=R2([].push),hbe=O2&&abe(function(){var e=Object.create(null);return e[2]=2,!E2(e,2)}),sM=function(e){return function(t){for(var r=ube(t),n=sbe(r),o=hbe&&lbe(r)===null,i=n.length,a=0,l=[],s;i>a;)s=n[a++],(!O2||(o?s in r:E2(r,s)))&&cbe(l,e?[s,r[s]]:r[s]);return l}},dbe={entries:sM(!0),values:sM(!1)},vbe=$e,ybe=dbe.values;vbe({target:"Object",stat:!0},{values:function(t){return ybe(t)}});function $h(e){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(e)}function Dw(e,t){return bbe(e)||mbe(e,t)||pbe(e,t)||gbe()}function gbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pbe(e,t){if(e){if(typeof e=="string")return uM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uM(e,t)}}function uM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bbe(e){if(Array.isArray(e))return e}function wbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cbe(n.key),n)}}function Sbe(e,t,r){return t&&fM(e.prototype,t),r&&fM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cbe(e){var t=_be(e,"string");return $h(t)==="symbol"?t:String(t)}function _be(e,t){if($h(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Obe=function(){function e(t,r){wbe(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Sbe(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(s){var u=r.main.childNodes[s];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[s])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),wn(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function l(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function s(u){l(u)&&(o.eventManager.removeEventListener(i,"mousemove",s),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",s)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var l=o[a],s=n.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[l]&&this.settings[l].hide&&(s.className+=" hidden"),i=s.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:r.border.color,i.height=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[l]&&this.settings[l].width?"".concat(this.settings[l].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),pn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};ze(a,function(s,u){r.selectionHandles.styles.bottomHitArea[u]=s,r.selectionHandles.styles.topHitArea[u]=s});var l={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};ze(l,function(s,u){r.selectionHandles.styles.bottom[u]=s,r.selectionHandles.styles.top[u]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,l){var s=this.wot.wtSettings.getSetting("rtlMode"),u=s?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,y=parseInt(c.borderWidth,10),m=parseInt(c.width,10),w=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();c.top="".concat(parseInt(o-m-1,10),"px"),c[u]="".concat(parseInt(i-m-1,10),"px"),h.top="".concat(parseInt(o-w/4*3,10),"px"),h[u]="".concat(parseInt(i-w/4*3,10),"px");var k=Math.min(parseInt(i+a,10),S-m-y*2),_=Math.min(parseInt(i+a-w/4,10),S-w-y*2);d[u]="".concat(k,"px"),v[u]="".concat(_,"px");var N=Math.min(parseInt(o+l,10),C-m-y*2),V=Math.min(parseInt(o+l-w/4,10),C-w-y*2);d.top="".concat(N,"px"),v.top="".concat(V,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,l,s,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var y=o.rowFilter.renderedToSource(v);if(y>=r[0]&&y<=r[2]){l=y,c=r[0];break}}for(var m=d-1;m>=0;m-=1){var w=o.rowFilter.renderedToSource(m);if(w>=r[0]&&w<=r[2]){s=w;break}}for(var S=o.getRenderedColumnsCount(),C=0;C<S;C+=1){var k=o.columnFilter.renderedToSource(C);if(k>=r[1]&&k<=r[3]){u=k,h=r[1];break}}for(var _=S-1;_>=0;_-=1){var N=o.columnFilter.renderedToSource(_);if(N>=r[1]&&N<=r[3]){f=N;break}}if(l===void 0||u===void 0){this.disappear();return}var V=o.getCell(this.wot.createCellCoords(l,u)),X=l!==s||u!==f,Y=X?o.getCell(this.wot.createCellCoords(s,f)):V,q=Ut(V),Q=X?Ut(Y):q,ne=Ut(o.TABLE),J=ht(o.TABLE),ue=q.top,he=q.left,Oe=this.wot.wtSettings.getSetting("rtlMode"),we=0,$=0;if(Oe){var P=ht(V),g=a.innerWidth-ne.left-J;$=he+P-Q.left,we=a.innerWidth-he-P-g-1}else $=Q.left+ht(Y)-he,we=he-ne.left-1;if(this.isEntireColumnSelected(l,s)){var p=this.getDimensionsFromHeader("columns",u,f,c,ne),b=null;if(p){var E=Dw(p,3);b=E[0],we=E[1],$=E[2]}b&&(V=b)}var R=ue-ne.top-1,B=Q.top+Pt(Y)-ue;if(this.isEntireRowSelected(u,f)){var x=this.getDimensionsFromHeader("rows",l,s,h,ne),K=null;if(x){var Z=Dw(x,3);K=Z[0],R=Z[1],B=Z[2]}K&&(V=K)}var re=Ii(V,a);parseInt(re.borderTopWidth,10)>0&&(R+=1,B=B>0?B-1:0),parseInt(re[Oe?"borderRightWidth":"borderLeftWidth"],10)>0&&(we+=1,$=$>0?$-1:0);var ie=Oe?"right":"left";this.topStyle.top="".concat(R,"px"),this.topStyle[ie]="".concat(we,"px"),this.topStyle.width="".concat($,"px"),this.topStyle.display="block",this.startStyle.top="".concat(R,"px"),this.startStyle[ie]="".concat(we,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var se=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(R+B-se,"px"),this.bottomStyle[ie]="".concat(we,"px"),this.bottomStyle.width="".concat($,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(R,"px"),this.endStyle[ie]="".concat(we+$-se,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var _e=this.settings.border.cornerVisible;_e=typeof _e=="function"?_e(this.settings.layerLevel):_e;var Se=this.wot.getSetting("onModifyGetCellCoords",s,f),z=s,Ne=f;if(Se&&Array.isArray(Se)){var Be=Dw(Se,4);z=Be[2],Ne=Be[3]}if(pn()||!_e||this.isPartRange(z,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(R+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ie]="".concat(we+$+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ke=Ua(o.TABLE),Ie=ke===a;Ie&&(ke=i.documentElement);var Ae=parseInt(this.cornerDefaultStyle.width,10)/2,O=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var T=Ie?Y.getBoundingClientRect().left:Y.offsetLeft,I=!1,F=0;Oe?(F=T-parseInt(this.cornerDefaultStyle.width,10)/2,I=F<0):(F=T+ht(Y)+parseInt(this.cornerDefaultStyle.width,10)/2,I=F>=Ac(ke)),I&&(this.cornerStyle[ie]="".concat(Math.floor(we+$+this.cornerCenterPointOffset-Ae),"px"),this.cornerStyle[Oe?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var M=Ie?Y.getBoundingClientRect().top:Y.offsetTop,W=M+Pt(Y)+parseInt(this.cornerDefaultStyle.height,10)/2,H=W>=ho(ke);H&&(this.cornerStyle.top="".concat(Math.floor(R+B+this.cornerCenterPointOffset-O),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}pn()&&this.updateMultipleSelectionHandlesPosition(s,f,R,we,$,B)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var l=this.wot.wtTable,s=l.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,y=null,m=null;switch(r){case"rows":u=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return Pt.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return ht.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(s.classList.contains(c)){var w=this.wot.getSetting("columnHeaders").length;if(y=u(n,w-i),m=u(o,w-i),!y||!m)return!1;var S=Ut(y),C=Ut(m);return y&&m&&(h=S[v]-a[v]-1,d=C[v]+f(m)-S[v]),[y,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?te(this[r],"hidden"):(xe(this[r],"hidden")&&Le(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="start"||r==="end")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?te(this[r],"hidden"):Le(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",pn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const Rbe=Obe;function Ebe(e,t){return $be(e)||kbe(e,t)||Pbe(e,t)||Tbe()}function Tbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pbe(e,t){if(e){if(typeof e=="string")return cM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cM(e,t)}}function cM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $be(e){if(Array.isArray(e))return e}function nu(e){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(e)}function Abe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mbe(n.key),n)}}function Ibe(e,t,r){return t&&hM(e.prototype,t),r&&hM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mbe(e){var t=xbe(e,"string");return nu(t)==="symbol"?t:String(t)}function xbe(e,t){if(nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dbe=function(){function e(t,r){Abe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Ibe(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Rbe(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=r.wtTable.getCell(this.settings.createCellCoords(n,o));if(nu(l)==="object"){var s=i;a&&(s=this.classNameGenerator(l),this.classNames.includes(s)||this.classNames.push(s)),te(l,s)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var l=a>=0?a:n,s=r;l-=1;var u=l===0?r:"".concat(r,"-").concat(l);if(xe(i,u)){var f=l+1;s="".concat(r,"-").concat(f)}else s=o(i,l);return s}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Ebe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,m=c.selectionType,w=m===void 0||["active-header","header"].includes(m);if(w&&s!==null&&f!==null)for(var S=0,C=0;C<o;C+=1){var k=r.wtTable.columnFilter.renderedToSource(C);if(k>=s&&k<=f){var _=r.wtTable.getColumnHeaders(k),N=_.length-1;y&&_.length>1&&(_=[_[N]]);for(var V=0;V<_.length;V+=1){var X=[],Y=_[V];h&&X.push(h),d&&X.push(d),V=y?N:V;var q=r.getSetting("onBeforeHighlightingColumnHeader",k,V,{selectionType:m,columnCursor:S,selectionWidth:f-s+1,classNames:X});q!==k&&(Y=r.wtTable.getColumnHeader(q,V)),te(Y,X)}S+=1}}if(l!==null&&u!==null)for(var Q=0,ne=0;ne<n;ne+=1){var J=r.wtTable.rowFilter.renderedToSource(ne);if(w&&J>=l&&J<=u){var ue=r.wtTable.getRowHeaders(J),he=ue.length-1;y&&ue.length>1&&(ue=[ue[he]]);for(var Oe=0;Oe<ue.length;Oe+=1){var we=[],$=ue[Oe];h&&we.push(h),v&&we.push(v),Oe=y?he:Oe;var P=r.getSetting("onBeforeHighlightingRowHeader",J,Oe,{selectionType:m,rowCursor:Q,selectionHeight:u-l+1,classNames:we});P!==J&&($=r.wtTable.getRowHeader(P,Oe)),te($,we)}Q+=1}if(s!==null&&f!==null)for(var g=0;g<o;g+=1){var p=r.wtTable.columnFilter.renderedToSource(g);J>=l&&J<=u&&p>=s&&p<=f?this.settings.className&&this.addClassAtCoords(r,J,p,this.settings.className,this.settings.markIntersections):J>=l&&J<=u?v&&this.addClassAtCoords(r,J,p,v):p>=s&&p<=f&&d&&this.addClassAtCoords(r,J,p,d);var b=r.getSetting("onAfterDrawSelection",J,p,this.settings.layerLevel);typeof b=="string"&&this.addClassAtCoords(r,J,p,b)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const Nbe=Dbe;var Hbe=$e,Lbe=ll.findIndex,jbe=nv,U_="findIndex",T2=!0;U_ in[]&&Array(1)[U_](function(){T2=!1});Hbe({target:"Array",proto:!0,forced:T2},{findIndex:function(t){return Lbe(this,t,arguments.length>1?arguments[1]:void 0)}});jbe(U_);var Fbe="localHooks",P2={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,l){if(this._localHooks[t])for(var s=this._localHooks[t].length,u=0;u<s;u++)op(this._localHooks[t][u],this,r,n,o,i,a,l)},clearLocalHooks:function(){return this._localHooks={},this}};Kn(P2,"MIXIN_NAME",Fbe,{writable:!1,enumerable:!1});const Mr=P2;function Ah(e){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ah(e)}function Bbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wbe(n.key),n)}}function Vbe(e,t,r){return t&&dM(e.prototype,t),r&&dM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wbe(e){var t=Ube(e,"string");return Ah(t)==="symbol"?t:String(t)}function Ube(e,t){if(Ah(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hl=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Bbe(this,e),this.indexedValues=[],this.initValueOrFn=t}return Vbe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,mt(this.initValueOrFn)?Ce(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Ce(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();gt(hl,Mr);function Nw(e){return Kbe(e)||Gbe(e)||Ybe(e)||zbe()}function zbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ybe(e,t){if(e){if(typeof e=="string")return z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z_(e,t)}}function Gbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kbe(e){if(Array.isArray(e))return z_(e)}function z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vT(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Nw(e.slice(0,o)),Nw(r.map(function(i,a){return mt(n)?n(i,a):n})),Nw(o===void 0?[]:e.slice(o)))}function yT(e,t){return Wr(e,function(r,n){return t.includes(n)===!1})}function ou(e){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(e)}function qbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zbe(n.key),n)}}function Xbe(e,t,r){return t&&vM(e.prototype,t),r&&vM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zbe(e){var t=Qbe(e,"string");return ou(t)==="symbol"?t:String(t)}function Qbe(e,t){if(ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xc(){return typeof Reflect<"u"&&Reflect.get?xc=Reflect.get.bind():xc=function(t,r,n){var o=Jbe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xc.apply(this,arguments)}function Jbe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xa(e),e!==null););return e}function ewe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y_(e,t)}function Y_(e,t){return Y_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Y_(e,t)}function twe(e){var t=owe();return function(){var n=Xa(e),o;if(t){var i=Xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rwe(this,o)}}function rwe(e,t){if(t&&(ou(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nwe(e)}function nwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function owe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xa(e){return Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xa(e)}var Li=function(e){ewe(r,e);var t=twe(r);function r(){return qbe(this,r),t.apply(this,arguments)}return Xbe(r,[{key:"insert",value:function(o,i){this.indexedValues=vT(this.indexedValues,o,i,this.initValueOrFn),xc(Xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=yT(this.indexedValues,o),xc(Xa(r.prototype),"remove",this).call(this,o)}}]),r}(hl);function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function iwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lwe(n.key),n)}}function awe(e,t,r){return t&&yM(e.prototype,t),r&&yM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lwe(e){var t=swe(e,"string");return iu(t)==="symbol"?t:String(t)}function swe(e,t){if(iu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G_(e,t)}function G_(e,t){return G_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},G_(e,t)}function fwe(e){var t=dwe();return function(){var n=Lp(e),o;if(t){var i=Lp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cwe(this,o)}}function cwe(e,t){if(t&&(iu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hwe(e)}function hwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lp(e){return Lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lp(e)}var Xm=function(e){uwe(r,e);var t=fwe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return iwe(this,r),t.call(this,n)}return awe(r,[{key:"getHiddenIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Li);function Hw(e){return pwe(e)||gwe(e)||ywe(e)||vwe()}function vwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ywe(e,t){if(e){if(typeof e=="string")return K_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K_(e,t)}}function gwe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pwe(e){if(Array.isArray(e))return K_(e)}function K_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gT(e,t,r){return[].concat(Hw(e.slice(0,t)),Hw(r),Hw(e.slice(t)))}function Ih(e,t){return Wr(e,function(r){return t.includes(r)===!1})}function pT(e,t){return We(e,function(r){return r-t.filter(function(n){return n<r}).length})}function mT(e,t){var r=t[0],n=t.length;return We(e,function(o){return o>=r?o+n:o})}function au(e){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(e)}function mwe(e){return Cwe(e)||Swe(e)||wwe(e)||bwe()}function bwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wwe(e,t){if(e){if(typeof e=="string")return q_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q_(e,t)}}function Swe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cwe(e){if(Array.isArray(e))return q_(e)}function q_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$2(n.key),n)}}function Owe(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uo(){return typeof Reflect<"u"&&Reflect.get?uo=Reflect.get.bind():uo=function(t,r,n){var o=Rwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},uo.apply(this,arguments)}function Rwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yn(e),e!==null););return e}function Ewe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X_(e,t)}function X_(e,t){return X_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},X_(e,t)}function Twe(e){var t=kwe();return function(){var n=yn(e),o;if(t){var i=yn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Pwe(this,o)}}function Pwe(e,t){if(t&&(au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k2(e)}function k2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yn(e){return yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yn(e)}function $we(e,t,r){return t=$2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $2(e){var t=Awe(e,"string");return au(t)==="symbol"?t:String(t)}function Awe(e,t){if(au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zm=function(e){Ewe(r,e);var t=Twe(r);function r(){var n;_we(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),$we(k2(n),"orderOfIndexes",[]),n}return Owe(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=mwe(Array(o.length).keys()),uo(yn(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=Ih(this.orderOfIndexes,[o]),mt(this.initValueOrFn)?uo(yn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):uo(yn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,uo(yn(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=vT(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=mT(this.orderOfIndexes,i),uo(yn(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=yT(this.indexedValues,o),this.orderOfIndexes=Ih(this.orderOfIndexes,o),this.orderOfIndexes=pT(this.orderOfIndexes,o),uo(yn(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(hl);function lu(e){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lu(e)}function Iwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xwe(n.key),n)}}function Mwe(e,t,r){return t&&pM(e.prototype,t),r&&pM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xwe(e){var t=Dwe(e,"string");return lu(t)==="symbol"?t:String(t)}function Dwe(e,t){if(lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z_(e,t)}function Z_(e,t){return Z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Z_(e,t)}function Hwe(e){var t=Fwe();return function(){var n=jp(e),o;if(t){var i=jp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Lwe(this,o)}}function Lwe(e,t){if(t&&(lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jwe(e)}function jwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jp(e){return jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jp(e)}var Dv=function(e){Nwe(r,e);var t=Hwe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Iwe(this,r),t.call(this,n)}return Mwe(r,[{key:"getTrimmedIndexes",value:function(){return Ft(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}(Li),mM=new Map([["indexesSequence",{getListWithInsertedItems:gT,getListWithRemovedItems:Ih}],["physicallyIndexed",{getListWithInsertedItems:vT,getListWithRemovedItems:yT}]]),A2=function(t){if(mM.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return mM.get(t)};function su(e){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(e)}function Bwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wwe(n.key),n)}}function Vwe(e,t,r){return t&&bM(e.prototype,t),r&&bM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wwe(e){var t=Uwe(e,"string");return su(t)==="symbol"?t:String(t)}function Uwe(e,t){if(su(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dc(){return typeof Reflect<"u"&&Reflect.get?Dc=Reflect.get.bind():Dc=function(t,r,n){var o=zwe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dc.apply(this,arguments)}function zwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Za(e),e!==null););return e}function Ywe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q_(e,t)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q_(e,t)}function Gwe(e){var t=Xwe();return function(){var n=Za(e),o;if(t){var i=Za(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kwe(this,o)}}function Kwe(e,t){if(t&&(su(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qwe(e)}function qwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Za(e){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Za(e)}var I2=function(e){Ywe(r,e);var t=Gwe(r);function r(){return Bwe(this,r),t.call(this,function(n){return n})}return Vwe(r,[{key:"insert",value:function(o,i){var a=mT(this.indexedValues,i);this.indexedValues=gT(a,o,i),Dc(Za(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Ih(this.indexedValues,o);this.indexedValues=pT(i,o),Dc(Za(r.prototype),"remove",this).call(this,o)}}]),r}(hl),wM=new Map([["hiding",Xm],["index",hl],["linkedPhysicalIndexToValue",Zm],["physicalIndexToValue",Li],["trimming",Dv]]);function Zwe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!wM.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(wM.get(e))(t)}function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}function Qwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eSe(n.key),n)}}function Jwe(e,t,r){return t&&SM(e.prototype,t),r&&SM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eSe(e){var t=tSe(e,"string");return Mh(t)==="symbol"?t:String(t)}function tSe(e,t){if(Mh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J_=0,bT=function(){function e(){Qwe(this,e),this.collection=new Map}return Jwe(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),J_+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);ve(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),J_-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return bt(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();gt(bT,Mr);function rSe(){return J_}function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function nSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iSe(n.key),n)}}function oSe(e,t,r){return t&&CM(e.prototype,t),r&&CM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iSe(e){var t=aSe(e,"string");return uu(t)==="symbol"?t:String(t)}function aSe(e,t){if(uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function sSe(e){var t=cSe();return function(){var n=Fp(e),o;if(t){var i=Fp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uSe(this,o)}}function uSe(e,t){if(t&&(uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fSe(e)}function fSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fp(e){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(e)}var _M=function(e){lSe(r,e);var t=sSe(r);function r(n,o){var i;return nSe(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return oSe(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=We(this.get(),function(c){return c.getValues()}),a=[],l=ve(i[0])&&i[0].length||0,s=0;s<l;s+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][s]);a.push(u)}return We(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return ve(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(bT);function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function hSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vSe(n.key),n)}}function dSe(e,t,r){return t&&OM(e.prototype,t),r&&OM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vSe(e){var t=ySe(e,"string");return xh(t)==="symbol"?t:String(t)}function ySe(e,t){if(xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gSe(e,t,r){pSe(e,t),t.set(e,r)}function pSe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mSe(e,t,r){var n=M2(e,t,"set");return bSe(e,n,r),r}function bSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function wSe(e,t){var r=M2(e,t,"get");return SSe(e,r)}function M2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function SSe(e,t){return t.get?t.get.call(e):t.value}var Lw=new WeakMap,x2=function(){function e(){hSe(this,e),gSe(this,Lw,{writable:!0,value:[]})}return dSe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(wSe(this,Lw)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){mSe(this,Lw,r)}}]),e}();gt(x2,Mr);function RM(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function Dh(e){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dh(e)}function CSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OSe(n.key),n)}}function _Se(e,t,r){return t&&EM(e.prototype,t),r&&EM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OSe(e){var t=RSe(e,"string");return Dh(t)==="symbol"?t:String(t)}function RSe(e,t){if(Dh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ec(e,t,r){ESe(e,t),t.set(e,r)}function ESe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(e,t){var r=D2(e,t,"get");return TSe(e,r)}function TSe(e,t){return t.get?t.get.call(e):t.value}function gy(e,t,r){var n=D2(e,t,"set");return PSe(e,n,r),r}function D2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function PSe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var py=new WeakMap,tc=new WeakMap,my=new WeakMap,by=new WeakMap,wy=new WeakMap,kSe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;CSe(this,e),ec(this,py,{writable:!0,value:new Set}),ec(this,tc,{writable:!0,value:[]}),ec(this,my,{writable:!0,value:[]}),ec(this,by,{writable:!0,value:!1}),ec(this,wy,{writable:!0,value:!1}),gy(this,wy,r??!1)}return _Se(e,[{key:"createObserver",value:function(){var r=this,n=new x2;return Kr(this,py).add(n),n.addLocalHook("unsubscribe",function(){Kr(r,py).delete(n)}),n._writeInitialChanges(RM(Kr(this,tc),Kr(this,my))),n}},{key:"emit",value:function(r){var n=Kr(this,my);(!Kr(this,by)||Kr(this,tc).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Kr(this,wy)):gy(this,tc,new Array(r.length).fill(Kr(this,wy))),Kr(this,by)||(gy(this,by,!0),n=Kr(this,tc)));var o=RM(n,r);Kr(this,py).forEach(function(i){return i._write(o)}),gy(this,my,r)}}]),e}();function Nh(e){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nh(e)}function jw(e){return MSe(e)||ISe(e)||ASe(e)||$Se()}function $Se(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ASe(e,t){if(e){if(typeof e=="string")return tO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tO(e,t)}}function ISe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MSe(e){if(Array.isArray(e))return tO(e)}function tO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NSe(n.key),n)}}function DSe(e,t,r){return t&&TM(e.prototype,t),r&&TM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NSe(e){var t=HSe(e,"string");return Nh(t)==="symbol"?t:String(t)}function HSe(e,t){if(Nh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rO=function(){function e(){var t=this;xSe(this,e),this.indexesSequence=new I2,this.trimmingMapsCollection=new _M(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new _M(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new bT,this.hidingChangesObservable=new kSe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return DSe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,Zwe(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof Dv?this.trimmingMapsCollection.register(r,n):n instanceof Xm?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return ve(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return ve(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return ve(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return ve(n)?n:null}},{key:"getNearestNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getPhysicalFromVisualIndex(r);if(i===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),l=-1;return n>0?l=a.findIndex(function(s){return s>r}):l=a.reverse().findIndex(function(s){return s<r}),l===-1?o?this.getNearestNotHiddenIndex(r,-n,!1):null:a[l]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=jw(new Array(r).keys()),this.notHiddenIndexesCache=jw(new Array(r).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=jw(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(r),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=We(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),l=r.length,s=Ih(this.getIndexesSequence(),i),u=a-l;if(n+l<a){var f=s.filter(function(c){return o.isTrimmed(c)===!1})[n];u=s.indexOf(f)}this.indexesChangeSource="move",this.setIndexesSequence(gT(s,u,i)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=ve(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=We(new Array(n).fill(i),function(s,u){return s+u});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,l),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(a,l),this.hidingMapsCollection.insertToEvery(a,l),this.variousMapsCollection.insertToEvery(a,l),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();gt(rO,Mr);function fu(e){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(e)}function PM(e,t){return BSe(e)||FSe(e,t)||jSe(e,t)||LSe()}function LSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jSe(e,t){if(e){if(typeof e=="string")return kM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kM(e,t)}}function kM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function BSe(e){if(Array.isArray(e))return e}function VSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,USe(n.key),n)}}function WSe(e,t,r){return t&&$M(e.prototype,t),r&&$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function USe(e){var t=zSe(e,"string");return fu(t)==="symbol"?t:String(t)}function zSe(e,t){if(fu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,r,n){var o=YSe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function YSe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function GSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function KSe(e){var t=XSe();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qSe(this,o)}}function qSe(e,t){if(t&&(fu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N2(e)}function N2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}ge.getSingleton().register("modifyAutoColumnSizeSeed");var rc="autoColumnSize",ZSe=10,Fw=new WeakMap,QSe="autoColumnSize",JSe=function(e){GSe(r,e);var t=KSe(r);function r(n){var o;return VSe(this,r),o=t.call(this,n),Fw.set(N2(o),{cachedColumnHeaders:[]}),o.ghostTable=new rT(o.hot),o.samplesGenerator=new WW(function(i,a){var l=o.hot.getCellMeta(i,a),s="";l.spanned||(s=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,l,s)),{value:s,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Li,o.hot.columnIndexMapper.registerMap(QSe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),o}return WSe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[rc]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[rc];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,l){return o.getColumnWidth(l,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),da(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),da(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;da(yo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn();a===-1||l===-1||this.calculateColumnsWidth({from:a,to:l},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Ce(s.from,s.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),l||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);A(h,function(d){var v=PM(d,2),y=v[0],m=v[1];return o.ghostTable.addColumn(y,m)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,l=this.hot.countCols()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){qc(s),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Wm(c):(qc(s),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[rc],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[rc],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ue(o)&&(i=o.syncLimit,$E(i)?i=jE(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=i;return l===void 0&&(l=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof l=="number"&&(l=Math.max(l,nT.DEFAULT_WIDTH))),l}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view._wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=Fw.get(this),a=i.cachedColumnHeaders,l=Ft(o,function(s,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&s.push(f),c-1<f?a.push(u):a[f]=u,s},[]);return l}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){A(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=We(o,function(l){var s=PM(l,2),u=s[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var l=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),l=this.getColumnWidth(i,void 0,!1)),l}},{key:"onAfterInit",value:function(){Fw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Wr(o,function(l){var s;return ve((s=l.address)===null||s===void 0?void 0:s.col)}),a=We(i,function(l){return l.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),da(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rc}},{key:"PLUGIN_PRIORITY",get:function(){return ZSe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(ot),va={horizontal:"horizontal",vertical:"vertical"};function eCe(e,t,r){var n,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",n=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",n=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",n=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",n=r(e[2]+1,t[1]),o=r(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function tCe(e){var t={};return e===!0?(t.directions=Object.keys(va),t.autoInsertRow=!0):Ue(e)?(ve(e.autoInsertRow)?e.direction===va.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ve(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(va)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function cu(e){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cu(e)}function rCe(e){return iCe(e)||oCe(e)||H2(e)||nCe()}function nCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iCe(e){if(Array.isArray(e))return oO(e)}function aCe(e,t){return uCe(e)||sCe(e,t)||H2(e,t)||lCe()}function lCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H2(e,t){if(e){if(typeof e=="string")return oO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oO(e,t)}}function oO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function uCe(e){if(Array.isArray(e))return e}function fCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hCe(n.key),n)}}function cCe(e,t,r){return t&&AM(e.prototype,t),r&&AM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hCe(e){var t=dCe(e,"string");return cu(t)==="symbol"?t:String(t)}function dCe(e,t){if(cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,r,n){var o=vCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function vCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function yCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iO(e,t)}function iO(e,t){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iO(e,t)}function gCe(e){var t=mCe();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pCe(this,o)}}function pCe(e,t){if(t&&(cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L2(e)}function L2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");var IM="autofill",bCe=20,wCe=["fillHandle"],SCe="insert_row_below",CCe=200,_Ce=function(e){yCe(r,e);var t=gCe(r);function r(n){var o;return fCe(this,r),o=t.call(this,n),o.eventManager=new kt(L2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return cCe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),ya(go(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),ya(go(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopStartCorner(),l=a.row,s=a.col,u=i.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:l,startCol:s,endRow:f,endCol:c}]),d=[],v=[],y=[];return A(h,function(m){for(var w=m.startRow;w<=m.endRow;w+=1)d.indexOf(w)===-1&&d.push(w);for(var S=m.startCol;S<=m.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),A(d,function(m){var w=[];A(v,function(S){w.push(o.hot.getCopyableData(m,S))}),y.push(w)}),y}},{key:"fillIn",value:function(){var o=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),a=aCe(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,l),Math.min(h.col,s),Math.max(d.row,u),Math.max(d.col,f)],v),m=eCe(v,y,function(we,$){return o.hot._createCellCoords(we,$)}),w=m.directionOfDrag,S=m.startOfDragCoords,C=m.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var k=this.getSelectionData(),_=c.clone(),N=this.hot._createCellRange(S,S,C),V=this.hot.runHooks("beforeAutofill",k,_,N,w);if(V===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var X=V,Y=V;if(["up","left"].indexOf(w)>-1&&!(Y.length===1&&Y[0].length===0))if(X=[],w==="up")for(var q=C.row-S.row+1,Q=q%Y.length,ne=0;ne<q;ne++)X.push(Y[(ne+(Y.length-Q))%Y.length]);else for(var J=C.col-S.col+1,ue=J%Y[0].length,he=0;he<Y.length;he++){X.push([]);for(var Oe=0;Oe<J;Oe++)X[he].push(Y[he][(Oe+(Y[he].length-ue))%Y[he].length])}this.hot.populateFromArray(S.row,S.col,X,C.row,C.col,"".concat(this.pluginName,".fill"),null),this.setSelection(y),this.hot.runHooks("afterAutofill",X,_,N,w),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomEndCorner(),l=o;if(this.directions.includes(va.vertical)&&this.directions.includes(va.horizontal)){var s=i.getTopStartCorner();(a.col<=o.col||s.col>=o.col)&&(l=this.hot._createCellCoords(a.row,o.col)),(a.row<o.row||s.row>o.row)&&(l=this.hot._createCellCoords(o.row,a.col))}else if(this.directions.includes(va.vertical))l=this.hot._createCellCoords(o.row,a.col);else if(this.directions.includes(va.horizontal))l=this.hot._createCellCoords(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(l)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(SCe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},CCe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),l,s=o[2]+1;s<a;s++){for(var u=o[1];u<=o[3];u++){var f=i[s][u];if(f)return-1}var c=i[s][o[1]-1],h=i[s][o[3]+1];(c||h)&&(l=s)}return l}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(o[0],o[1])).add(this.hot._createCellCoords(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,rCe(We(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Ut(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Pt(this.hot.table),l=Ut(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+ht(this.hot.table);return o.clientY>a&&o.clientX<=l}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=tCe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){ya(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return IM}},{key:"PLUGIN_PRIORITY",get:function(){return bCe}},{key:"SETTING_KEYS",get:function(){return[IM].concat(wCe)}}]),r}(ot);function hu(e){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(e)}function OCe(e,t){return PCe(e)||TCe(e,t)||ECe(e,t)||RCe()}function RCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ECe(e,t){if(e){if(typeof e=="string")return MM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MM(e,t)}}function MM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function PCe(e){if(Array.isArray(e))return e}function kCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ACe(n.key),n)}}function $Ce(e,t,r){return t&&xM(e.prototype,t),r&&xM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ACe(e){var t=ICe(e,"string");return hu(t)==="symbol"?t:String(t)}function ICe(e,t){if(hu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function is(){return typeof Reflect<"u"&&Reflect.get?is=Reflect.get.bind():is=function(t,r,n){var o=MCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},is.apply(this,arguments)}function MCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function xCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aO(e,t)}function aO(e,t){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aO(e,t)}function DCe(e){var t=LCe();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return NCe(this,o)}}function NCe(e,t){if(t&&(hu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HCe(e)}function HCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}var Sy="autoRowSize",jCe=40,FCe="autoRowSize",BCe=function(e){xCe(r,e);var t=DCe(r);function r(n){var o;return kCe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new rT(o.hot),o.samplesGenerator=new WW(function(i,a){var l;return i>=0?l=o.hot.getDataAtCell(i,a):i===-1&&(l=o.hot.getColHeader(a)),{value:l}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Li,o.hot.rowIndexMapper.registerMap(FCe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)}),o}return $Ce(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[Sy];return o===!0||Ue(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChangeRender",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),is(wi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,is(wi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,l){return o.onBeforeRowResize(i,a,l)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Ce(s.from,s.to,function(c){if(l||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);A(h,function(d){var v=OCe(d,2),y=v[0],m=v[1];return o.ghostTable.addRow(y,m)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,l=this.hot.countRows()-1,s=null;this.inProgress=!0;var u=function c(){if(!o.hot){qc(s),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,l)},i),a=a+r.CALCULATION_STEP+1,a<l?s=Wm(c):(qc(s),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&o.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<l?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Sy],i=o&&xt(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&xt(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){bs(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Sy],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ue(o)&&(i=o.syncLimit,$E(i)?i=jE(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),l=i;return a!==null&&a>(i||0)&&(l=a),l}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view._wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,l=a.from,s=a.to;this.hot.batchExecution(function(){Ce(Math.min(l,s),Math.max(l,s),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Wr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),l=this.getLastVisibleRow();if(!(a===-1||l===-1)){if(this.calculateRowsHeight({from:a,to:l},void 0,o),i){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-i,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var l=o;return a&&(this.calculateRowsHeight(i,void 0,!0),l=this.getRowHeight(i)),l}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),is(wi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Sy}},{key:"PLUGIN_PRIORITY",get:function(){return jCe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(ot);function du(e){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(e)}function VCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UCe(n.key),n)}}function WCe(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UCe(e){var t=zCe(e,"string");return du(t)==="symbol"?t:String(t)}function zCe(e,t){if(du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nc(){return typeof Reflect<"u"&&Reflect.get?Nc=Reflect.get.bind():Nc=function(t,r,n){var o=YCe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Nc.apply(this,arguments)}function YCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qa(e),e!==null););return e}function GCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function KCe(e){var t=ZCe();return function(){var n=Qa(e),o;if(t){var i=Qa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qCe(this,o)}}function qCe(e,t){if(t&&(du(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XCe(e)}function XCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qa(e){return Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qa(e)}var j2=A2("physicallyIndexed"),QCe=j2.getListWithInsertedItems,JCe=j2.getListWithRemovedItems,e_e=function(e){GCe(r,e);var t=KCe(r);function r(){return VCe(this,r),t.call(this,function(n){return n})}return WCe(r,[{key:"insert",value:function(o,i){var a=mT(this.indexedValues,i);this.indexedValues=QCe(a,o,i,this.initValueOrFn),Nc(Qa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=JCe(this.indexedValues,o);this.indexedValues=pT(i,o),Nc(Qa(r.prototype),"remove",this).call(this,o)}}]),r}(hl);const t_e=e_e;function vu(e){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(e)}function r_e(e){return a_e(e)||i_e(e)||o_e(e)||n_e()}function n_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o_e(e,t){if(e){if(typeof e=="string")return sO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sO(e,t)}}function i_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function a_e(e){if(Array.isArray(e))return sO(e)}function sO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u_e(n.key),n)}}function s_e(e,t,r){return t&&NM(e.prototype,t),r&&NM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u_e(e){var t=f_e(e,"string");return vu(t)==="symbol"?t:String(t)}function f_e(e,t){if(vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hc(){return typeof Reflect<"u"&&Reflect.get?Hc=Reflect.get.bind():Hc=function(t,r,n){var o=c_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hc.apply(this,arguments)}function c_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ja(e),e!==null););return e}function h_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uO(e,t)}function uO(e,t){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uO(e,t)}function d_e(e){var t=g_e();return function(){var n=Ja(e),o;if(t){var i=Ja(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return v_e(this,o)}}function v_e(e,t){if(t&&(vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y_e(e)}function y_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ja(e){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ja(e)}var F2=A2("physicallyIndexed"),p_e=F2.getListWithInsertedItems,m_e=F2.getListWithRemovedItems,b_e=function(e){h_e(r,e);var t=d_e(r);function r(){return l_e(this,r),t.call(this,function(n){return n})}return s_e(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=p_e(this.indexedValues,o,i,function(l,s){return a.getNextValue(s)}),Hc(Ja(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=m_e(this.indexedValues,o),Hc(Ja(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,r_e(this.getValues()))+1+o}}]),r}(hl);const w_e=b_e;function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function S_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,__e(n.key),n)}}function C_e(e,t,r){return t&&HM(e.prototype,t),r&&HM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function __e(e){var t=O_e(e,"string");return yu(t)==="symbol"?t:String(t)}function O_e(e,t){if(yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function as(){return typeof Reflect<"u"&&Reflect.get?as=Reflect.get.bind():as=function(t,r,n){var o=R_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},as.apply(this,arguments)}function R_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Si(e),e!==null););return e}function E_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fO(e,t)}function T_e(e){var t=$_e();return function(){var n=Si(e),o;if(t){var i=Si(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return P_e(this,o)}}function P_e(e,t){if(t&&(yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k_e(e)}function k_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Si(e)}var Bw="bindRowsWithHeaders",A_e=210,I_e="loose",M_e=new Map([["loose",t_e],["strict",w_e]]),x_e=function(e){E_e(r,e);var t=T_e(r);function r(n){var o;return S_e(this,r),o=t.call(this,n),o.headerIndexes=null,o}return C_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Bw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Bw];typeof i!="string"&&(i=I_e);var a=M_e.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(l){return o.onModifyRowHeader(l)}),as(Si(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),as(Si(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){as(Si(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Bw}},{key:"PLUGIN_PRIORITY",get:function(){return A_e}}]),r}(ot);function gu(e){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(e)}function LM(e){return L_e(e)||H_e(e)||N_e(e)||D_e()}function D_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N_e(e,t){if(e){if(typeof e=="string")return cO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cO(e,t)}}function H_e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function L_e(e){if(Array.isArray(e))return cO(e)}function cO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B2(n.key),n)}}function F_e(e,t,r){return t&&jM(e.prototype,t),r&&jM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,r,n){var o=B_e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function B_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function V_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hO(e,t)}function hO(e,t){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hO(e,t)}function W_e(e){var t=z_e();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return U_e(this,o)}}function U_e(e,t){if(t&&(gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gl(e)}function Gl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z_e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}function Y_e(e,t,r){G_e(e,t),t.set(e,r)}function G_e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vw(e,t,r){return t=B2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B2(e){var t=K_e(e,"string");return gu(t)==="symbol"?t:String(t)}function K_e(e,t){if(gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FM(e,t){var r=V2(e,t,"get");return q_e(e,r)}function q_e(e,t){return t.get?t.get.call(e):t.value}function Ww(e,t,r){var n=V2(e,t,"set");return X_e(e,n,r),r}function V2(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function X_e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Uw="collapsibleColumns",Z_e=290,Q_e=["nestedHeaders"],_l="collapsibleIndicator",BM=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Ol=new WeakMap,J_e=function(e){V_e(r,e);var t=W_e(r);function r(){var n;j_e(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Vw(Gl(n),"nestedHeadersPlugin",null),Vw(Gl(n),"eventManager",new kt(Gl(n))),Vw(Gl(n),"headerStateManager",null),Y_e(Gl(n),Ol,{writable:!0,value:null}),n}return F_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Uw]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||wt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Ww(this,Ol,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(l,s,u){return o.onBeforeOnCellMouseDown(l,s,u)}),ga(po(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(i))}ga(po(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ww(this,Ol,null),this.nestedHeadersPlugin=null,this.clearButtons(),ga(po(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var o=this.hot.view._wt.getSetting("columnHeaders").length,i=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,l=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(f){f&&f.parentNode.removeChild(f)};Ce(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=l?l.childNodes[u]:null;Ce(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(_l));s(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(_l)),s(v)),l&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(_l)),s(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(l){var s=l.collapsible,u=l.origColspan,f=l.headerLevel,c=l.columnIndex,h=l.isCollapsed;if(s===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!BM.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(Array.isArray(o)){var l=Wr(o,function(m){var w=m.row;return w<0}),s=l.length>0;A(l,function(m){var w,S=m.row,C=m.col,k=(w=a.headerStateManager.getHeaderSettings(S,C))!==null&&w!==void 0?w:{},_=k.collapsible,N=k.isCollapsed;if(!_||N&&i==="collapse"||!N&&i==="expand")return s=!1,!1});var u=[],f=[];s&&A(l,function(m){var w=m.row,S=m.col,C=a.headerStateManager.triggerNodeModification(i,w,S),k=C.colspanCompensation,_=C.affectedColumns,N=C.rollbackModification;k>0&&(f.push.apply(f,LM(_)),u.push(N))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=SE([].concat(LM(c),f)):i==="expand"&&(h=Wr(c,function(m){return!f.includes(m)}));var d=BM.get(i),v=this.hot.runHooks(d.beforeHook,c,h,s);if(v===!1){A(u,function(m){m()});return}this.hot.batchExecution(function(){A(f,function(m){FM(a,Ol).setValueAtIndex(a.hot.toPhysicalColumn(m),d.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return FM(this,Ol).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(o,i,a){var l,s=(l=this.headerStateManager.getHeaderSettings(a,o))!==null&&l!==void 0?l:{},u=s.collapsible,f=s.origColspan,c=s.isCollapsed,h=u&&f>1&&o>=this.hot.getSettings().fixedColumnsStart,d=i.querySelector(".".concat(_l));if(h)d||(d=this.hot.rootDocument.createElement("div"),te(d,_l),i.querySelector("div:first-child").appendChild(d)),Le(d,["collapsed","expanded"]),c?(te(d,"collapsed"),Ai(d,"+")):(te(d,"expanded"),Ai(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){xe(o.target,_l)&&(xe(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):xe(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),wn(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Ww(this,Ol,null),ga(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Uw}},{key:"PLUGIN_PRIORITY",get:function(){return Z_e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Uw].concat(Q_e)}}]),r}(ot),eOe=$e,tOe=Gt,rOe=Lj,nOe=zr,oOe=zn,iOe=Tf;eOe({target:"Object",stat:!0,sham:!tOe},{getOwnPropertyDescriptors:function(t){for(var r=nOe(t),n=oOe.f,o=rOe(r),i={},a=0,l,s;o.length>a;)s=n(r,l=o[a++]),s!==void 0&&iOe(i,l,s);return i}});var VM=Gt,aOe=Ye,lOe=Zt,sOe=je,zw=rv,uOe=sv,fOe=av,cOe=Ir,hOe=Zd,Rl=Object.assign,WM=Object.defineProperty,dOe=aOe([].concat),vOe=!Rl||sOe(function(){if(VM&&Rl({b:1},Rl(WM({},"a",{enumerable:!0,get:function(){WM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),Rl({},e)[r]!=7||zw(Rl({},t)).join("")!=n})?function(t,r){for(var n=cOe(t),o=arguments.length,i=1,a=uOe.f,l=fOe.f;o>i;)for(var s=hOe(arguments[i++]),u=a?dOe(zw(s),a(s)):zw(s),f=u.length,c=0,h;f>c;)h=u[c++],(!VM||lOe(l,s,h))&&(n[h]=s[h]);return n}:Rl,yOe=$e,UM=vOe;yOe({target:"Object",stat:!0,arity:2,forced:Object.assign!==UM},{assign:UM});function Hh(e){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hh(e)}function zM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gOe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zM(Object(r),!0).forEach(function(n){pOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pOe(e,t,r){return t=W2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YM(e,t){return SOe(e)||wOe(e,t)||bOe(e,t)||mOe()}function mOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bOe(e,t){if(e){if(typeof e=="string")return GM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GM(e,t)}}function GM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SOe(e){if(Array.isArray(e))return e}function COe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W2(n.key),n)}}function _Oe(e,t,r){return t&&KM(e.prototype,t),r&&KM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W2(e){var t=OOe(e,"string");return Hh(t)==="symbol"?t:String(t)}function OOe(e,t){if(Hh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ROe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],EOe=!1,TOe=!0,POe=!0,kOe=function(){function e(t,r){COe(this,e),this.hot=t,this.sortingStates=new Zm,this.sortEmptyCells=EOe,this.indicator=TOe,this.headerAction=POe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return _Oe(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Ue(r)&&ze(r,function(o,i){ROe.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=YM(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ue(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=YM(o,2),a=i[0],l=i[1];return gOe({column:r.hot.toVisualColumn(a)},l)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(ve(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Bp="asc",Vp="desc",$Oe="colHeader";function AOe(e){if(Ue(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Bp,Vp].includes(r)}function IOe(e){if(e.some(function(r){return AOe(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function qM(e){if(e!==Vp)return e===Bp?Vp:Bp}function XM(e){var t=e.querySelector(".".concat($Oe));return t}function ZM(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function dO(e,t,r){return e===-1&&t>=0&&$i(r)===!1}var MOe="ascending",xOe="descending",U2="indicatorDisabled",z2="columnSorting",Y2="sortAction",G2=new Map([[Bp,MOe],[Vp,xOe]]);function DOe(e,t,r,n){var o=[z2];if(n&&o.push(Y2),r===!1)return o.push(U2),o;var i=e.getSortOrderOfColumn(t);return ve(i)&&o.push(G2.get(i)),o}function NOe(){return Array.from(G2.values()).concat(Y2,U2,z2)}function K2(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Vn:Xt(o)?Xt(i)?Vn:a&&e==="asc"?It:Mt:Xt(i)?a&&e==="asc"?Mt:It:isNaN(o)&&!isNaN(i)?e==="asc"?Mt:It:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?It:Mt:o>i?e==="asc"?Mt:It:Vn}}var q2="default";function HOe(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),l=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Vn;if(l){if(Xt(n))return e==="asc"?It:Mt;if(Xt(o))return e==="asc"?Mt:It}return isNaN(i)?Mt:isNaN(a)?It:i<a?e==="asc"?It:Mt:i>a?e==="asc"?Mt:It:Vn}}var LOe="numeric";function jOe(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,l){var s=Xt(a),u=Xt(l),f=s?o:a,c=u?o:l,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(s&&u===!1)return Mt;if(s===!1&&u)return It}return h===!1&&d?e==="asc"?It:Mt:h&&d===!1?e==="asc"?Mt:It:h===!1&&d===!1?K2(e,t,r)(a,l):f===o&&c===n?e==="asc"?It:Mt:f===n&&c===o?e==="asc"?Mt:It:Vn}}var FOe="checkbox";function BOe(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Vn;if(Xt(n))return Xt(o)?Vn:i&&e==="asc"?It:Mt;if(Xt(o))return i&&e==="asc"?Mt:It;var a=t.dateFormat,l=ee(n,a),s=ee(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?e==="asc"?It:Mt:s.isBefore(l)?e==="asc"?Mt:It:Vn:It:Mt}}var VOe="date",wT=on("sorting.compareFunctionFactory"),Qm=wT.register,QM=wT.getItem,WOe=wT.hasItem,X2=on("sorting.mainSortComparator"),Z2=X2.register,UOe=X2.getItem;function Q2(e){return WOe(e)?QM(e):QM(q2)}Qm(LOe,HOe);Qm(FOe,jOe);Qm(VOe,BOe);Qm(q2,K2);var Vn=0,It=-1,Mt=1;function zOe(e,t){for(var r=UOe(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];e.sort(r.apply(void 0,o))}function JM(e){return qOe(e)||KOe(e)||GOe(e)||YOe()}function YOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GOe(e,t){if(e){if(typeof e=="string")return ex(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ex(e,t)}}function ex(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qOe(e){if(Array.isArray(e))return e}function XOe(e,t){return function(r,n){var o=JM(r),i=o.slice(1),a=JM(n),l=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.columnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:Q2(c.type),m=y(f,c,v)(h,d);return m}(0)}}function pu(e){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pu(e)}var ZOe=["column"],QOe=["column"];function El(e){return rRe(e)||tRe(e)||eRe(e)||JOe()}function JOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eRe(e,t){if(e){if(typeof e=="string")return vO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vO(e,t)}}function tRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rRe(e){if(Array.isArray(e))return vO(e)}function vO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tx(Object(r),!0).forEach(function(n){nRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nRe(e,t,r){return t=J2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nx(e,t){if(e==null)return{};var r=oRe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oRe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function iRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ox(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J2(n.key),n)}}function aRe(e,t,r){return t&&ox(e.prototype,t),r&&ox(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J2(e){var t=lRe(e,"string");return pu(t)==="symbol"?t:String(t)}function lRe(e,t){if(pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,r,n){var o=sRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function sRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mo(e),e!==null););return e}function uRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yO(e,t)}function yO(e,t){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},yO(e,t)}function fRe(e){var t=dRe();return function(){var n=mo(e),o;if(t){var i=mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return cRe(this,o)}}function cRe(e,t){if(t&&(pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hRe(e)}function hRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(e){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mo(e)}var gO="columnSorting",vRe=50,ix="append",yRe="replace";Z2(gO,XOe);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var eU=function(e){uRe(r,e);var t=fRe(r);function r(n){var o;return iRe(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=gO,o.indexesSequenceCache=null,o}return aRe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new kOe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Li(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),pa(mo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(l,s){var u=XM(s);ZM(l,s)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,pa(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),l=this.areValidSortConfigs(a),s=this.hot.runHooks("beforeColumnSort",i,a,l);s!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new I2),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),l&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,l?a:i,l),l&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return ve(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return IOe(o)&&o.every(function(a){var l=a.column;return l<=i&&l>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),l=function(u){var f=u.column,c=nx(u,ZOe);return rx({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=We(o,l),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,l=function(u){var f=u.column,c=nx(u,QOe);return rx({column:o.hot.toVisualColumn(f)},c)};return ve(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=We(a.initialConfig,l)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(ve(i)){var a=qM(i);return ve(a)?{column:o,sortOrder:a}:void 0}var l=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<l)return{column:o,sortOrder:qM()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ix,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),l=a!==-1,s=this.getSortConfig(),u=this.getColumnNextConfig(o);if(l){if(bt(u))return[].concat(El(s.slice(0,a)),El(s.slice(a+1)));if(i===ix)return[].concat(El(s.slice(0,a)),El(s.slice(a+1)),[u]);if(i===yRe)return[].concat(El(s.slice(0,a)),[u],El(s.slice(a+1)))}return ve(u)?s.concat(u):s}},{key:"getPluginColumnConfig",value:function(o){if(Ue(o)){var i=o[this.pluginKey];if(Ue(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),l=this.hot.getCellMeta(0,o),s=Object.getPrototypeOf(l);return Array.isArray(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns[o])):mt(s.columns)?Object.assign(a,i,this.getPluginColumnConfig(s.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],l=this.hot.countRows(),s=function(m){return We(o,function(w){return i.hot.getDataAtCell(m,w.column)})},u=0;u<this.getNumberOfRowsToSort(l);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(s(u)));var f=We(a,function(y){return y[0]});zOe(a,this.pluginKey,We(o,function(y){return y.sortOrder}),We(o,function(y){return i.getFirstCellSettings(y.column)}));for(var c=a.length;c<l;c+=1)a.push([c].concat(s(c)));var h=We(a,function(y){return y[0]}),d=new Map(We(f,function(y,m){return[y,h[m]]})),v=We(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return d.has(y)?d.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ue(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ue(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ue(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=XM(i);if(!(ZM(o,i)===!1||a===null)){var l=this.getFirstCellSettings(o)[this.pluginKey],s=l.indicator,u=l.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,s,u)}}},{key:"updateHeaderClasses",value:function(o){if(Le(o,NOe()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];te(o,DOe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){pa(mo(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ve(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],l=a.headerAction;return l&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){dO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){dO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),pa(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gO}},{key:"PLUGIN_PRIORITY",get:function(){return vRe}}]),r}(ot),gRe=$e,ST=Ye,pRe=Ni,mRe=nB,bRe=X0,ax=je,wRe=RangeError,tU=String,rU=Math.floor,pO=ST(bRe),lx=ST("".slice),nc=ST(1 .toFixed),Ql=function(e,t,r){return t===0?r:t%2===1?Ql(e,t-1,r*e):Ql(e*e,t/2,r)},SRe=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},Tl=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=rU(o/1e7)},Yw=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=rU(n/t),n=n%t*1e7},sx=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=tU(e[t]);r=r===""?n:r+pO("0",7-n.length)+n}return r},CRe=ax(function(){return nc(8e-5,3)!=="0.000"||nc(.9,0)!=="1"||nc(1.255,2)!=="1.25"||nc(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!ax(function(){nc({})});gRe({target:"Number",proto:!0,forced:CRe},{toFixed:function(t){var r=mRe(this),n=pRe(t),o=[0,0,0,0,0,0],i="",a="0",l,s,u,f;if(n<0||n>20)throw wRe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return tU(r);if(r<0&&(i="-",r=-r),r>1e-21)if(l=SRe(r*Ql(2,69,1))-69,s=l<0?r*Ql(2,-l,1):r/Ql(2,l,1),s*=4503599627370496,l=52-l,l>0){for(Tl(o,0,s),u=n;u>=7;)Tl(o,1e7,0),u-=7;for(Tl(o,Ql(10,u,1),0),u=l-1;u>=23;)Yw(o,1<<23),u-=23;Yw(o,1<<u),Tl(o,1,1),Yw(o,2),a=sx(o)}else Tl(o,0,s),Tl(o,1<<-l,0),a=sx(o)+pO("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+pO("0",n-f)+a:lx(a,0,f-n)+"."+lx(a,f-n))):a=i+a,a}});function Lh(e){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(e)}function _Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ux(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RRe(n.key),n)}}function ORe(e,t,r){return t&&ux(e.prototype,t),r&&ux(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RRe(e){var t=ERe(e,"string");return Lh(t)==="symbol"?t:String(t)}function ERe(e,t){if(Lh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TRe=function(){function e(t,r){_Re(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return ORe(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),A(i,function(a){var l={};n.assignSetting(a,l,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,l,"reversedRowCoords",!1),n.assignSetting(a,l,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,l,"sourceColumn",a.destinationColumn),n.assignSetting(a,l,"type","sum"),n.assignSetting(a,l,"forceNumeric",!1),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"suppressDataTypeErrors",!0),n.assignSetting(a,l,"customFunction",null),n.assignSetting(a,l,"readOnly",!0),n.assignSetting(a,l,"roundFloat",!1),o.push(l)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();A(a,function(l){i==="row"&&l.destinationRow>=n&&(r==="insert_row"?l.alterRowOffset=o:r==="remove_row"&&(l.alterRowOffset=-1*o)),i==="col"&&l.destinationColumn>=n&&(r==="insert_col"?l.alterColumnOffset=o:r==="remove_col"&&(l.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var l=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function y(){return l.hot.removeHook("beforeViewRender",y),l.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;A(h,function(y){f==="row"&&y.destinationRow>=v&&(y.alterRowOffset=c*o),f==="col"&&y.destinationColumn>=v&&(y.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?A(h,function(y){l.extendEndpointRanges(y,v,i[0],i.length),l.recreatePhysicalRanges(y),l.clearOffsetInformation(y)}):A(h,function(y){l.shiftEndpointCoordinates(y,v)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){A(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];A(o,function(l){var s=[];if(l[1])for(var u=l[0];u<=l[1];u++)s.push(n.hot.toPhysicalRow(u));else s.push(n.hot.toPhysicalRow(l[0]));a.push(s)}),A(a,function(l){var s=[];A(l,function(u,f){f===0?s.push(u):l[f]!==l[f-1]+1&&(s.push(l[f-1]),i.push(s),s=[],s.push(u)),f===l.length-1&&(s.push(u),i.push(s))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,A(r.ranges,function(o){A(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var l=a.alterRowOffset||0,s=a.alterColumnOffset||0;return a.destinationRow+l>=r.hot.countRows()||a.destinationColumn+s>=r.hot.countCols()});i||(this.cellsToSetCache=[],A(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],A(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],A(r,function(i,a,l){"".concat(i[2]||"")!=="".concat(i[3])&&A(n.getAllEndpoints(),function(s,u){n.hot.propToCol(l[a][1])===s.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),A(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var l=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||l.readOnly!==r.readOnly)&&(l.readOnly=r.readOnly,l.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(i,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){wt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const PRe=TRe;function Gw(e){return e==null||isNaN(e)}function mu(e){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mu(e)}var fx;function kRe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IRe(n.key),n)}}function ARe(e,t,r){return t&&cx(e.prototype,t),r&&cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IRe(e){var t=MRe(e,"string");return mu(t)==="symbol"?t:String(t)}function MRe(e,t){if(mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eg(){return typeof Reflect<"u"&&Reflect.get?Eg=Reflect.get.bind():Eg=function(t,r,n){var o=xRe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Eg.apply(this,arguments)}function xRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function DRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mO(e,t)}function mO(e,t){return mO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},mO(e,t)}function NRe(e){var t=jRe();return function(){var n=bu(e),o;if(t){var i=bu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HRe(this,o)}}function HRe(e,t){if(t&&(mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LRe(e)}function LRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var Kw="columnSummary",FRe=220,BRe=function(e){DRe(r,e);var t=NRe(r);function r(n){var o;return $Re(this,r),o=t.call(this,n),o.endpoints=null,o}return ARe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Kw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[Kw],this.endpoints=new PRe(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,l)}),this.addHook("beforeCreateCol",function(i,a,l){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,l)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterCreateRow",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,l)}),this.addHook("afterCreateCol",function(i,a,l){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,l)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(l))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(l))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),Eg(bu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return ze(o.ranges,function(l){a+=i.getPartialSum(l,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,l=o[1]||o[0],s=null,u=0;do{if(s=this.getCellValue(l,i),s=Gw(s)?null:s,s!==null){var f=("".concat(s).split(".")[1]||[]).length||1;f>u&&(u=f)}a+=s||0,l-=1}while(l>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,l=null;return ze(o.ranges,function(s){var u=a.getPartialMinMax(s,o.sourceColumn,i);if(l===null&&u!==null&&(l=u),u!==null)switch(i){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}}),l===null?"Not enough data":l}},{key:"getPartialMinMax",value:function(o,i,a){var l=null,s=o[1]||o[0],u;do{if(u=this.getCellValue(s,i),u=Gw(u)?null:u,l===null)l=u;else if(u!==null)switch(a){case"min":l=Math.min(l,u);break;case"max":l=Math.max(l,u);break}s-=1}while(s>=o[0]);return l}},{key:"countEmpty",value:function(o,i){var a,l=0,s=o[1]||o[0];do a=this.getCellValue(s,i),a=Gw(a)?null:a,a===null&&(l+=1),s-=1;while(s>=o[0]);return l}},{key:"countEntries",value:function(o){var i=this,a=0,l=o.ranges;return ze(l,function(s){var u=s[1]===void 0?1:s[1]-s[0]+1,f=i.countEmpty(s,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),l=this.hot.toVisualColumn(i),s=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&l!==null&&(u=this.hot.getCellMeta(a,l).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(dt(fx||(fx=kRe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return Kw}},{key:"PLUGIN_PRIORITY",get:function(){return FRe}}]),r}(ot);function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function VRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,URe(n.key),n)}}function WRe(e,t,r){return t&&hx(e.prototype,t),r&&hx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function URe(e){var t=zRe(e,"string");return jh(t)==="symbol"?t:String(t)}function zRe(e,t){if(jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YRe=function(){function e(t,r){VRe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return WRe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:ht(this.getInputElement()),height:Pt(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(r,e.CLASS_EDITOR),te(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const GRe=YRe;var qe="---------";function KRe(){return{name:qe}}function qRe(e){return We(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function Cy(e){return xe(e,"htSeparator")}function XRe(e){return xe(e,"htSubmenu")}function _y(e){return xe(e,"htDisabled")}function Oy(e){return xe(e,"htSelectionDisabled")}function dl(e){var t=e.getSelected();return!t||t[0]<0?null:t}function ZRe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function QRe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Ki(e,t){var r={};return A(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function si(e,t,r,n,o){A(e,function(i){i.forAll(function(a,l){a>=0&&l>=0&&JRe(a,l,t,r,n,o)})})}function JRe(e,t,r,n,o,i){var a=o(e,t),l=n;a.className&&(r==="vertical"?l=ZRe(a.className,n):l=QRe(a.className,n)),i(e,t,"className",l)}function jn(e,t){var r=!1;return Array.isArray(e)&&A(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function lo(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function e0e(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function nU(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function t0e(e,t){var r=e.slice(0);return r.reverse(),r=nU(r,t),r.reverse(),r}function r0e(e){var t=[];return A(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function n0e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,r=e.slice(0);return r=nU(r,t),r=t0e(r,t),r=r0e(r),r}function Fh(e){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fh(e)}function o0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a0e(n.key),n)}}function i0e(e,t,r){return t&&dx(e.prototype,t),r&&dx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a0e(e){var t=l0e(e,"string");return Fh(t)==="symbol"?t:String(t)}function l0e(e,t){if(Fh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s0e=250,u0e=250,oU=function(){function e(t){o0e(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return i0e(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},u0e)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s0e;this.showDebounced=HE(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();gt(oU,Mr);const f0e=oU;var iU="ContextMenu:items",Fe=iU,CT="".concat(Fe,".noItems"),_T="".concat(Fe,".insertRowAbove"),OT="".concat(Fe,".insertRowBelow"),RT="".concat(Fe,".insertColumnOnTheLeft"),ET="".concat(Fe,".insertColumnOnTheRight"),TT="".concat(Fe,".removeRow"),PT="".concat(Fe,".removeColumn"),kT="".concat(Fe,".undo"),$T="".concat(Fe,".redo"),AT="".concat(Fe,".readOnly"),IT="".concat(Fe,".clearColumn"),MT="".concat(Fe,".copy"),xT="".concat(Fe,".copyWithHeaders"),DT="".concat(Fe,".copyWithGroupHeaders"),NT="".concat(Fe,".copyHeadersOnly"),HT="".concat(Fe,".cut"),LT="".concat(Fe,".freezeColumn"),jT="".concat(Fe,".unfreezeColumn"),FT="".concat(Fe,".mergeCells"),BT="".concat(Fe,".unmergeCells"),VT="".concat(Fe,".addComment"),WT="".concat(Fe,".editComment"),UT="".concat(Fe,".removeComment"),zT="".concat(Fe,".readOnlyComment"),YT="".concat(Fe,".align"),GT="".concat(Fe,".align.left"),KT="".concat(Fe,".align.center"),qT="".concat(Fe,".align.right"),XT="".concat(Fe,".align.justify"),ZT="".concat(Fe,".align.top"),QT="".concat(Fe,".align.middle"),JT="".concat(Fe,".align.bottom"),eP="".concat(Fe,".borders"),tP="".concat(Fe,".borders.top"),rP="".concat(Fe,".borders.right"),nP="".concat(Fe,".borders.bottom"),oP="".concat(Fe,".borders.left"),iP="".concat(Fe,".borders.remove"),aP="".concat(Fe,".nestedHeaders.insertChildRow"),lP="".concat(Fe,".nestedHeaders.detachFromParent"),sP="".concat(Fe,".hideColumn"),uP="".concat(Fe,".showColumn"),fP="".concat(Fe,".hideRow"),cP="".concat(Fe,".showRow"),Or="Filters:",Ht="".concat(Or,"conditions"),Jm="".concat(Ht,".none"),hP="".concat(Ht,".isEmpty"),dP="".concat(Ht,".isNotEmpty"),vP="".concat(Ht,".isEqualTo"),yP="".concat(Ht,".isNotEqualTo"),gP="".concat(Ht,".beginsWith"),pP="".concat(Ht,".endsWith"),mP="".concat(Ht,".contains"),bP="".concat(Ht,".doesNotContain"),c0e="".concat(Ht,".byValue"),wP="".concat(Ht,".greaterThan"),SP="".concat(Ht,".greaterThanOrEqualTo"),CP="".concat(Ht,".lessThan"),_P="".concat(Ht,".lessThanOrEqualTo"),OP="".concat(Ht,".isBetween"),RP="".concat(Ht,".isNotBetween"),EP="".concat(Ht,".after"),TP="".concat(Ht,".before"),PP="".concat(Ht,".today"),kP="".concat(Ht,".tomorrow"),$P="".concat(Ht,".yesterday"),AP="".concat(Or,"labels.filterByCondition"),IP="".concat(Or,"labels.filterByValue"),MP="".concat(Or,"labels.conjunction"),eb="".concat(Or,"labels.disjunction"),Wp="".concat(Or,"values.blankCells"),xP="".concat(Or,"buttons.selectAll"),DP="".concat(Or,"buttons.clear"),NP="".concat(Or,"buttons.ok"),HP="".concat(Or,"buttons.cancel"),LP="".concat(Or,"buttons.placeholder.search"),jP="".concat(Or,"buttons.placeholder.value"),FP="".concat(Or,"buttons.placeholder.secondValue");const h0e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:VT,CONTEXTMENU_ITEMS_ALIGNMENT:YT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:JT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:KT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:XT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:GT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:QT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:qT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ZT,CONTEXTMENU_ITEMS_BORDERS:eP,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:nP,CONTEXTMENU_ITEMS_BORDERS_LEFT:oP,CONTEXTMENU_ITEMS_BORDERS_RIGHT:rP,CONTEXTMENU_ITEMS_BORDERS_TOP:tP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:IT,CONTEXTMENU_ITEMS_COPY:MT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:NT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:DT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:xT,CONTEXTMENU_ITEMS_CUT:HT,CONTEXTMENU_ITEMS_EDIT_COMMENT:WT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:LT,CONTEXTMENU_ITEMS_HIDE_COLUMN:sP,CONTEXTMENU_ITEMS_HIDE_ROW:fP,CONTEXTMENU_ITEMS_INSERT_LEFT:RT,CONTEXTMENU_ITEMS_INSERT_RIGHT:ET,CONTEXTMENU_ITEMS_MERGE_CELLS:FT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:lP,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:aP,CONTEXTMENU_ITEMS_NO_ITEMS:CT,CONTEXTMENU_ITEMS_READ_ONLY:AT,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:zT,CONTEXTMENU_ITEMS_REDO:$T,CONTEXTMENU_ITEMS_REMOVE_BORDERS:iP,CONTEXTMENU_ITEMS_REMOVE_COLUMN:PT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:UT,CONTEXTMENU_ITEMS_REMOVE_ROW:TT,CONTEXTMENU_ITEMS_ROW_ABOVE:_T,CONTEXTMENU_ITEMS_ROW_BELOW:OT,CONTEXTMENU_ITEMS_SHOW_COLUMN:uP,CONTEXTMENU_ITEMS_SHOW_ROW:cP,CONTEXTMENU_ITEMS_UNDO:kT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:jT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:BT,CONTEXT_MENU_ITEMS_NAMESPACE:iU,FILTERS_BUTTONS_CANCEL:HP,FILTERS_BUTTONS_CLEAR:DP,FILTERS_BUTTONS_OK:NP,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:LP,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:FP,FILTERS_BUTTONS_PLACEHOLDER_VALUE:jP,FILTERS_BUTTONS_SELECT_ALL:xP,FILTERS_CONDITIONS_AFTER:EP,FILTERS_CONDITIONS_BEFORE:TP,FILTERS_CONDITIONS_BEGINS_WITH:gP,FILTERS_CONDITIONS_BETWEEN:OP,FILTERS_CONDITIONS_BY_VALUE:c0e,FILTERS_CONDITIONS_CONTAINS:mP,FILTERS_CONDITIONS_EMPTY:hP,FILTERS_CONDITIONS_ENDS_WITH:pP,FILTERS_CONDITIONS_EQUAL:vP,FILTERS_CONDITIONS_GREATER_THAN:wP,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:SP,FILTERS_CONDITIONS_LESS_THAN:CP,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:_P,FILTERS_CONDITIONS_NAMESPACE:Ht,FILTERS_CONDITIONS_NONE:Jm,FILTERS_CONDITIONS_NOT_BETWEEN:RP,FILTERS_CONDITIONS_NOT_CONTAIN:bP,FILTERS_CONDITIONS_NOT_EMPTY:dP,FILTERS_CONDITIONS_NOT_EQUAL:yP,FILTERS_CONDITIONS_TODAY:PP,FILTERS_CONDITIONS_TOMORROW:kP,FILTERS_CONDITIONS_YESTERDAY:$P,FILTERS_DIVS_FILTER_BY_CONDITION:AP,FILTERS_DIVS_FILTER_BY_VALUE:IP,FILTERS_LABELS_CONJUNCTION:MP,FILTERS_LABELS_DISJUNCTION:eb,FILTERS_NAMESPACE:Or,FILTERS_VALUES_BLANK_CELLS:Wp},Symbol.toStringTag,{value:"Module"}));function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function qw(e,t,r){return t=aU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aU(n.key),n)}}function v0e(e,t,r){return t&&vx(e.prototype,t),r&&vx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aU(e){var t=y0e(e,"string");return wu(t)==="symbol"?t:String(t)}function y0e(e,t){if(wu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,r,n){var o=g0e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function g0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function p0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bO(e,t)}function bO(e,t){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bO(e,t)}function m0e(e){var t=w0e();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return b0e(this,o)}}function b0e(e,t){if(t&&(wu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lU(e)}function lU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w0e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var Xw="comments",S0e=60,Ry=new WeakMap,kn="comment",Pl="value",yx="style",Ey="readOnly",C0e=function(e){p0e(r,e);var t=m0e(r);function r(n){var o;return d0e(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,Ry.set(lU(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return v0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Xw]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new GRe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new kt(this)),this.displaySwitch||(this.displaySwitch=new f0e(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,l,s,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),ma(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ma(bo(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ma(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=pi(o.target,"TD","TBODY");return!!(i&&xe(i,"htCommentCell")&&pi(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var l=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(l,s,qw({},Pl,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:this.hot._createCellCoords(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,kn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,Pl)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,Pl)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var l=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(l[kn]?l[kn][Pl]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:this.hot._createCellCoords(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var l=this.hot,s=l.rowIndexMapper,u=l.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=s.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),y=d===null;this.editor.setPosition(0,0),d===null&&(d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var m=d===null,w=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,C=S.rootWindow,k=S.view._wt,_=k.wtTable,N=k.getCell({row:d,col:v},!0),V=this.getCommentMeta(c,h,yx);V?this.editor.setSize(V.width,V.height):this.editor.resetSize();var X=w?0:_.getStretchedColumnWidth(v),Y=y&&!m?Pt(N):0,q=N.getBoundingClientRect(),Q=q.left,ne=q.top,J=q.width,ue=q.height,he=this.editor.getSize(),Oe=he.width,we=he.height,$=this.hot.rootWindow,P=$.innerWidth,g=$.innerHeight,p=this.hot.rootDocument.documentElement,b=Q+C.scrollX+X,E=ne+C.scrollY+Y;this.hot.isRtl()&&(b-=Oe+X),this.hot.isLtr()&&Q+J+Oe>P?b=Q+C.scrollX-Oe-1:this.hot.isRtl()&&b<-(p.scrollWidth-p.clientWidth)&&(b=Q+C.scrollX+X+1),ne+we>g&&(E-=we-ue+1),this.editor.setPosition(b,E),this.editor.setReadOnlyState(this.getCommentMeta(c,h,Ey))}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Pl)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i)[kn],s;l?(s=fr(l),Ov(s,a)):s=a,this.hot.setCellMeta(o,i,kn,s)}},{key:"getCommentMeta",value:function(o,i,a){var l=this.hot.getCellMeta(o,i);if(l[kn])return l[kn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=pi(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=Ry.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||xe(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var l=this.hot._createCellRange(this.hot.getCoords(o.target));this.displaySwitch.show(l)}else mi(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[kn]&&i[kn][Pl]&&te(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=Ry.get(this);i.tempEditorDimensions={width:ht(o.target),height:Pt(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=Ry.get(this),a=ht(o.target),l=Pt(o.target);(a!==i.tempEditorDimensions.width+1||l!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,qw({},yx,{width:a,height:l}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){a>=0&&l>=0&&o.removeCommentAtCell(a,l,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,l){if(a>=0&&l>=0){var s=!!o.getCommentMeta(a,l,Ey);o.updateCommentMeta(a,l,qw({},Ey,!s))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(WT):i.hot.getTranslatedPhrase(VT)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(UT)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var s=this,u=this.getTranslatedPhrase(zT),f=jn(this.getSelectedRangeLast(),function(c,h){var d=s.getCellMeta(c,h)[kn];if(d&&(d=d[Ey]),d)return!0});return f&&(u=lo(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[Xw];if(Ue(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ma(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Xw}},{key:"PLUGIN_PRIORITY",get:function(){return S0e}}]),r}(ot);function Bh(e){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}function _0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R0e(n.key),n)}}function O0e(e,t,r){return t&&gx(e.prototype,t),r&&gx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R0e(e){var t=E0e(e,"string");return Bh(t)==="symbol"?t:String(t)}function E0e(e,t){if(Bh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T0e=function(){function e(t){_0e(this,e),this.hot=t,this.commands={},this.commonCallback=null}return O0e(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=r.split(":"),s=l[0],u=l.length===2?l[1]:null,f=this.commands[s];if(!f)throw new Error("Menu command '".concat(s,"' not exists."));if(u&&f.submenu&&(f=P0e(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!xt(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(l.join(":")),A(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function P0e(e,t){var r;return A(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}const sU=T0e;var Xr="alignment";function k0e(){return{key:Xr,name:function(){return this.getTranslatedPhrase(YT)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Xr,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(GT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(KT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(qT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(XT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{name:qe},{key:"".concat(Xr,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(ZT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(QT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1},{key:"".concat(Xr,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(JT),n=jn(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ki(r,function(a,l){return t.getCellMeta(a,l).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),si(r,o,i,function(a,l){return t.getCellMeta(a,l)},function(a,l,s,u){return t.setCellMeta(a,l,s,u)}),this.render()},disabled:!1}]}}}var tb="clear_column";function $0e(){return{key:tb,name:function(){return this.getTranslatedPhrase(IT)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=dl(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var Nv="col_left";function A0e(){return{key:Nv,name:function(){return this.getTranslatedPhrase(RT)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Hv="col_right";function I0e(){return{key:Hv,name:function(){return this.getTranslatedPhrase(ET)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Lv="make_read_only";function M0e(){return{key:Lv,name:function(){var t=this,r=this.getTranslatedPhrase(AT),n=jn(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=lo(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=jn(r,function(o,i){return t.getCellMeta(o,i).readOnly});A(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var rb="redo";function x0e(){return{key:rb,name:function(){return this.getTranslatedPhrase($T)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function uU(e,t){return L0e(e)||H0e(e,t)||N0e(e,t)||D0e()}function D0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N0e(e,t){if(e){if(typeof e=="string")return px(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return px(e,t)}}function px(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function H0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function L0e(e){if(Array.isArray(e))return e}function wO(e){"@babel/helpers - typeof";return wO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wO(e)}var nb=0,ob=1,fU=2,BP=3,j0e=[BP,fU],F0e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Zw=Symbol("root"),mx=Symbol("child");function Su(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zw;if(t!==Zw&&t!==mx)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===Zw,o=nb;if(r){var i=e[0];if(e.length===0)o=ob;else if(n&&i instanceof oT)o=BP;else if(n&&Array.isArray(i))o=Su(i,mx);else if(e.length>=2&&e.length<=4){var a=!e.some(function(l,s){return!F0e[s].includes(wO(l))});a&&(o=fU)}}return o}function Vh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!j0e.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===BP,l=a?i.from.row:i[0],s=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof s=="string"&&(s=o(s)),typeof f=="string"&&(f=o(f))),bt(u)&&(u=l),bt(f)&&(f=s),!n){var c=l,h=s,d=u,v=f;l=Math.min(c,d),s=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[l,s,u,f]}}function B0e(e){var t=Su(e);if(t===nb||t===ob)return[];var r=Vh(t),n=new Set;A(e,function(a){var l=r(a),s=uU(l,4),u=s[1],f=s[3],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function V0e(e){var t=Su(e);if(t===nb||t===ob)return[];var r=Vh(t),n=new Set;A(e,function(a){var l=r(a),s=uU(l,3),u=s[0],f=s[2],c=Math.max(u,0),h=f-c+1;A(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,l){return a-l}),i=Ft(o,function(a,l,s,u){return s!==0&&l===u[s-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a},[]);return i}function Zo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function W0e(e,t){return G0e(e)||Y0e(e,t)||z0e(e,t)||U0e()}function U0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z0e(e,t){if(e){if(typeof e=="string")return bx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bx(e,t)}}function bx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function G0e(e){if(Array.isArray(e))return e}var jv="remove_col";function K0e(){return{key:jv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=W0e(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(PT,r)},callback:function(){this.alter("remove_col",B0e(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dl(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function q0e(e,t){return J0e(e)||Q0e(e,t)||Z0e(e,t)||X0e()}function X0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z0e(e,t){if(e){if(typeof e=="string")return wx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wx(e,t)}}function wx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function J0e(e){if(Array.isArray(e))return e}var ib="remove_row";function eEe(){return{key:ib,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=q0e(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(TT,r)},callback:function(){this.alter("remove_row",V0e(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=dl(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var ab="row_above";function tEe(){return{key:ab,name:function(){return this.getTranslatedPhrase(_T)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=dl(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var lb="row_below";function rEe(){return{key:lb,name:function(){return this.getTranslatedPhrase(OT)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=dl(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Wh="no_items";function nEe(){return{key:Wh,name:function(){return this.getTranslatedPhrase(CT)},disabled:!0,isCommand:!1}}var sb="undo";function oEe(){return{key:sb,name:function(){return this.getTranslatedPhrase(kT)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}var yr;function xr(e,t,r){return t=iEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iEe(e){var t=aEe(e,"string");return Uh(t)==="symbol"?t:String(t)}function aEe(e,t){if(Uh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lEe=[ab,lb,Nv,Hv,tb,ib,jv,sb,rb,Lv,Xr,qe,Wh],sEe=(yr={},xr(yr,qe,KRe),xr(yr,Wh,nEe),xr(yr,ab,tEe),xr(yr,lb,rEe),xr(yr,Nv,A0e),xr(yr,Hv,I0e),xr(yr,tb,$0e),xr(yr,ib,eEe),xr(yr,jv,K0e),xr(yr,sb,oEe),xr(yr,rb,x0e),xr(yr,Lv,M0e),xr(yr,Xr,k0e),yr);function cU(){var e={};return ze(sEe,function(t,r){e[r]=t()}),e}function zh(e){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zh(e)}function uEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cEe(n.key),n)}}function fEe(e,t,r){return t&&Sx(e.prototype,t),r&&Sx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cEe(e){var t=hEe(e,"string");return zh(t)==="symbol"?t:String(t)}function hEe(e,t){if(zh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dEe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;uEe(this,e),this.hot=t,this.predefinedItems=cU(),this.defaultOrderPattern=r}return fEe(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,ze(r,function(i,a){var l="";i.name===qe?(o[qe]=i,l=qe):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,l=i.key):(o[i.key]=i,l=i.key),n.defaultOrderPattern.push(l)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return vEe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function vEe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ue(o)?ze(o,function(i,a){var l=r[typeof i=="string"?i:a];l||(l=i),Ue(i)?zt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),n.push(l)}):A(o,function(i,a){var l=r[i];!l&&lEe.indexOf(i)>=0||(l||(l={name:i,key:"".concat(a)}),Ue(i)&&zt(l,i),l.key===void 0&&(l.key=a),n.push(l))}),n}const hU=dEe;function Yh(e){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(e)}function yEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pEe(n.key),n)}}function gEe(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pEe(e){var t=mEe(e,"string");return Yh(t)==="symbol"?t:String(t)}function mEe(e,t){if(Yh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bEe=function(){function e(t,r){yEe(this,e);var n=ws(r),o=Wa(r),i,a,l,s,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),l=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,s=l,i+=n,l+=o):this.type==="event"&&(i=parseInt(t.pageY,10),l=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,s=l-o),this.top=i,this.topRelative=a,this.left=l,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return gEe(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const wEe=bEe;var SEe=tl,CEe=/(?:ipad|iphone|ipod).*applewebkit/i.test(SEe),_Ee=Un,dU=typeof process<"u"&&_Ee(process)=="process",Vr=vt,OEe=sl,REe=dv,_x=Rt,EEe=Nt,vU=je,Ox=Ej,TEe=mv,Rx=lm,PEe=uW,kEe=CEe,$Ee=dU,SO=Vr.setImmediate,CO=Vr.clearImmediate,AEe=Vr.process,Qw=Vr.Dispatch,IEe=Vr.Function,Ex=Vr.MessageChannel,MEe=Vr.String,Jw=0,Lc={},Tx="onreadystatechange",Gh,qi,eS,tS;vU(function(){Gh=Vr.location});var VP=function(e){if(EEe(Lc,e)){var t=Lc[e];delete Lc[e],t()}},rS=function(e){return function(){VP(e)}},Px=function(e){VP(e.data)},kx=function(e){Vr.postMessage(MEe(e),Gh.protocol+"//"+Gh.host)};(!SO||!CO)&&(SO=function(t){PEe(arguments.length,1);var r=_x(t)?t:IEe(t),n=TEe(arguments,1);return Lc[++Jw]=function(){OEe(r,void 0,n)},qi(Jw),Jw},CO=function(t){delete Lc[t]},$Ee?qi=function(e){AEe.nextTick(rS(e))}:Qw&&Qw.now?qi=function(e){Qw.now(rS(e))}:Ex&&!kEe?(eS=new Ex,tS=eS.port2,eS.port1.onmessage=Px,qi=REe(tS.postMessage,tS)):Vr.addEventListener&&_x(Vr.postMessage)&&!Vr.importScripts&&Gh&&Gh.protocol!=="file:"&&!vU(kx)?(qi=kx,Vr.addEventListener("message",Px,!1)):Tx in Rx("script")?qi=function(e){Ox.appendChild(Rx("script"))[Tx]=function(){Ox.removeChild(this),VP(e)}}:qi=function(e){setTimeout(rS(e),0)});var yU={set:SO,clear:CO},xEe=$e,DEe=vt,$x=yU.clear;xEe({global:!0,bind:!0,enumerable:!0,forced:DEe.clearImmediate!==$x},{clearImmediate:$x});var NEe=$e,gU=vt,Ax=yU.set,HEe=NE,Ix=gU.setImmediate?HEe(Ax,!1):Ax;NEe({global:!0,bind:!0,enumerable:!0,forced:gU.setImmediate!==Ix},{setImmediate:Ix});var LEe=$e,jEe=X0;LEe({target:"String",proto:!0},{repeat:jEe});var FEe=Zt,BEe=mm,VEe=jt,WEe=_n,UEe=ol,nS=Kt,zEe=Ar,YEe=nl,GEe=H0,Mx=bm;BEe("match",function(e,t,r){return[function(o){var i=zEe(this),a=WEe(o)?void 0:YEe(o,e);return a?FEe(a,o,i):new RegExp(o)[e](nS(i))},function(n){var o=VEe(this),i=nS(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return Mx(o,i);var l=o.unicode;o.lastIndex=0;for(var s=[],u=0,f;(f=Mx(o,i))!==null;){var c=nS(f[0]);s[u]=c,c===""&&(o.lastIndex=GEe(i,UEe(o.lastIndex),l)),u++}return u===0?null:s}]});var KEe=sl,qEe=zr,XEe=Ni,ZEe=en,QEe=kf,JEe=Math.min,_O=[].lastIndexOf,pU=!!_O&&1/[1].lastIndexOf(1,-0)<0,eTe=QEe("lastIndexOf"),tTe=pU||!eTe,rTe=tTe?function(t){if(pU)return KEe(_O,this,arguments)||0;var r=qEe(this),n=ZEe(r),o=n-1;for(arguments.length>1&&(o=JEe(o,XEe(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:_O,nTe=$e,xx=rTe;nTe({target:"Array",proto:!0,forced:xx!==[].lastIndexOf},{lastIndexOf:xx});var oTe=rl,iTe=Ir,aTe=Zd,lTe=en,sTe=TypeError,Dx=function(e){return function(t,r,n,o){oTe(r);var i=iTe(t),a=aTe(i),l=lTe(i),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw sTe("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(o=r(o,a[s],s,i));return o}},uTe={left:Dx(!1),right:Dx(!0)},fTe=$e,cTe=uTe.left,hTe=kf,Nx=Qd,dTe=dU,vTe=!dTe&&Nx>79&&Nx<83,yTe=vTe||!hTe("reduce");fTe({target:"Array",proto:!0,forced:yTe},{reduce:function(t){var r=arguments.length;return cTe(this,t,r,r>1?arguments[1]:void 0)}});function oS(e){return bTe(e)||mTe(e)||pTe(e)||gTe()}function gTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pTe(e,t){if(e){if(typeof e=="string")return OO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OO(e,t)}}function mTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bTe(e){if(Array.isArray(e))return OO(e)}function OO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var mU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},wTe=new RegExp(Object.keys(mU).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function STe(e){return(e&&e.nodeName||"")==="TABLE"}function RO(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],y=0;y<a;y+=1){var m=!d&&r&&y===0,w="";if(d)w="<th>".concat(e.getColHeader(y-f),"</th>");else if(m)w="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][y],C=e.getCellMeta(h-c,y-f),k=C.hidden,_=C.rowspan,N=C.colspan;if(!k){var V=[];if(_&&V.push('rowspan="'.concat(_,'"')),N&&V.push('colspan="'.concat(N,'"')),Xt(S))w="<td ".concat(V.join(" "),"></td>");else{var X=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w="<td ".concat(V.join(" "),">").concat(X,"</td>")}}}v.push(w)}var Y=["<tr>"].concat(v,["</tr>"]).join("");d?s.splice(1,0,Y):u.splice(-1,0,Y)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function EO(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Xt(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(f){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(f.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function bU(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(b){var E=b.match(/<td\b[^>]*?>/g)[0],R=b.substring(E.length,b.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),B="</td>";return"".concat(E).concat(R).concat(B)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!STe(i))){var l=o.querySelector('meta[name$="enerator"]'),s=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(b,E){return b+E.colSpan},0)-(s?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,y=0;if(i.tHead){var m=Array.from(i.tHead.rows).filter(function(b){var E=b.querySelector("td")!==null;return E&&h.push(b),!E});v=m.length,d=v>0,v>1?r.nestedHeaders=Array.from(m).reduce(function(b,E){var R=Array.from(E.cells).reduce(function(B,x,K){if(s&&K===0)return B;var Z=x.colSpan,re=x.innerHTML,ie=Z>1?{label:re,colspan:Z}:re;return B.push(ie),B},[]);return b.push(R),b},[]):d&&(r.colHeaders=Array.from(m[0].children).reduce(function(b,E,R){return s&&R===0||b.push(E.innerHTML),b},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var w=[].concat(h,oS(Array.from(i.tBodies).reduce(function(b,E){return b.push.apply(b,oS(Array.from(E.rows))),b},[])),oS(c));y=w.length;for(var S=new Array(y),C=0;C<y;C++)S[C]=new Array(f);for(var k=[],_=[],N=0;N<y;N++)for(var V=w[N],X=Array.from(V.cells),Y=X.length,q=0;q<Y;q++){var Q=X[q],ne=Q.nodeName,J=Q.innerHTML,ue=Q.rowSpan,he=Q.colSpan,Oe=S[N].findIndex(function(b){return b===void 0});if(ne==="TD"){if(ue>1||he>1){for(var we=N;we<N+ue;we++)if(we<y)for(var $=Oe;$<Oe+he;$++)S[we][$]=null;var P=Q.getAttribute("style"),g=P&&P.includes("mso-ignore:colspan");g||k.push({col:Oe,row:N,rowspan:ue,colspan:he})}var p="";l&&/excel/gi.test(l.content)?p=J.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):p=J.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[N][Oe]=p.replace(wTe,function(b){return mU[b]})}else _.push(J)}return k.length&&(r.mergeCells=k),_.length&&(r.rowHeaders=_),S.length&&(r.data=S),r}}const CTe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:EO,htmlToGridSettings:bU,instanceToHTML:RO},Symbol.toStringTag,{value:"Module"}));function Hx(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||f)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):f&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!f&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!f&&o.row<0||f&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var c=!i.inInSelection(o),h=r||n&&c;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function _Te(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),u=n.tableProps.countRows();l&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var OTe=new Map([["mousedown",Hx],["mouseover",_Te],["touchstart",Hx]]);function Lx(e,t){var r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;OTe.get(e.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Vm(e)||e.type==="touchstart",isRightClick:$i(e)})}var wU=new WeakMap,WP=Symbol("rootInstance");function RTe(e){wU.set(e,!0)}function ETe(e){return e===WP}function TO(e){return wU.has(e)}function Kh(e){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kh(e)}function oc(e,t){return kTe(e)||PTe(e,t)||SU(e,t)||TTe()}function TTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kTe(e){if(Array.isArray(e))return e}function jx(e){return ITe(e)||ATe(e)||SU(e)||$Te()}function $Te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SU(e,t){if(e){if(typeof e=="string")return PO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PO(e,t)}}function ATe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ITe(e){if(Array.isArray(e))return PO(e)}function PO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CU(n.key),n)}}function xTe(e,t,r){return t&&Fx(e.prototype,t),r&&Fx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bx(e,t,r){DTe(e,t),t.set(e,r)}function DTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(e,t,r){return t=CU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CU(e){var t=NTe(e,"string");return Kh(t)==="symbol"?t:String(t)}function NTe(e,t){if(Kh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vx(e,t){var r=_U(e,t,"get");return HTe(e,r)}function HTe(e,t){return t.get?t.get.call(e):t.value}function Wx(e,t,r){var n=_U(e,t,"set");return LTe(e,n,r),r}function _U(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function LTe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Xi=new WeakMap,iS=new WeakMap,aS=new WeakMap,jTe=function(){function e(t){MTe(this,e),Qo(this,"instance",void 0),Qo(this,"eventManager",void 0),Qo(this,"settings",void 0),Qo(this,"THEAD",void 0),Qo(this,"TBODY",void 0),Qo(this,"_wt",void 0),Qo(this,"activeWt",void 0),Bx(this,iS,{writable:!0,value:0}),Bx(this,aS,{writable:!0,value:0}),Qo(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new kt(this.instance),this.settings=this.instance.getSettings(),Xi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return xTe(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this._wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this._wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this._wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this._wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Xi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),te(o,"handsontable"),r.table=i.createElement("TABLE"),te(r.table,"htCore"),this.instance.getSettings().tableClassName&&te(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Xi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,l=o.selection,s=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;t_(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&t_(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(u){l.isInProgress()&&!u.shiftKey&&l.finish()}),this.eventManager.addEventListener(s,"mouseup",function(u){l.isInProgress()&&Vm(u)&&l.finish(),n.mouseDown=!1,(Ym(a.activeElement)||!l.isSelected()&&!l.isSelectedByAnyHeader()&&!i.contains(u.target)&&!$i(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(u){l.isInProgress()&&$i(u)&&(l.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){l.isInProgress()&&l.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var y=Jt(a);if(a.elementFromPoint(c+y,h)!==v||a.elementFromPoint(c,h+y)!==v)return}else for(;d!==s;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var m=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;m?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Jc(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,o=r.row,i=r.col;return(n=this.instance)._createCellCoords.apply(n,jx(this.translateFromRenderableToVisualIndex(o,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getNearestNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getNearestNotHiddenIndex(r,n),l=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(l))return 0;var s=0;return n<0?s=l+1:n>0&&(s=i-l),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Xi.get(this),o={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return TO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,jx(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),Wx(r,aS,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),Wx(r,iS,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=oc(d,2),y=v[0],m=v[1],w=r.instance.runHooks("modifyGetCellCoords",y,m),S=y,C=m;if(Array.isArray(w)){var k=oc(w,2);S=k[0],C=k[1]}var _=r.instance.getCellMeta(S,C),N=r.instance.colToProp(C),V=r.instance.getDataAtRowProp(S,N);r.instance.hasHook("beforeValueRender")&&(V=r.instance.runHooks("beforeValueRender",V,_)),r.instance.runHooks("beforeRenderer",h,y,m,N,V,_),r.instance.getCellRenderer(_)(r.instance,h,y,m,N,V,_),r.instance.runHooks("afterRenderer",h,y,m,N,V,_)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,y),!la(f)&&(Lx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!la(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!la(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),y={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,y),!la(f)&&(n.mouseDown&&Lx(f,{coords:v,selection:r.instance.selection,controller:y,cellCoordsFactory:function(w,S){return r.instance._createCellCoords(w,S)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(la(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),y=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),y=oc(v,2),m=y[0],w=y[1],S=r.instance.selection.getSelectedRange(),C=S.size();if(C>0){var k=(h??0)+1-C,_=S.peekByIndex(k);d=[_.from.row,_.from.col,_.to.row,_.to.col]}return r.instance.runHooks("afterDrawSelection",m,w,d,h)},onBeforeDrawBorders:function(f,c){var h=oc(f,4),d=h[0],v=h[1],y=h[2],m=h[3],w=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(y),r.instance.columnIndexMapper.getVisualFromRenderableIndex(m)];return r.instance.runHooks("beforeDrawBorders",w,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,y=c>=0?v.getVisualFromRenderableIndex(c):c,m=f>=0?d.getVisualFromRenderableIndex(f):f,w=r.instance.runHooks("modifyGetCellCoords",m,y,h);if(Array.isArray(w)){var S=oc(w,4),C=S[0],k=S[1],_=S[2],N=S[3];return[C>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(C,1)):C,k>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(k,1)):k,_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,-1)):_,N>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(N,-1)):N]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var y=Math.ceil(v/h*12);f.startRow=Math.max(d-y,0),f.endRow=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var y=Math.ceil(v/h*6);f.startColumn=Math.max(d-y,0),f.endColumn=Math.min(v+y,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this._wt=new ibe(o),this.activeWt=this._wt;var i=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),l=a.width,s=a.height;this.setLastSize(l,s),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Jc(r))return!0;var n=mi(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Xi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!xe(o,"relative")){Cn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,l=i.getRowHeader,s=a.createElement("div"),u=a.createElement("span");s.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,l),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;xe(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,o,i):(Cn(n),this.appendColHeader(r,n,o,i))}else{var l=this.instance.rootDocument,s=l.createElement("div"),u=l.createElement("span");s.className="relative",u.className="colHeader",this.updateCellHeader(u,r,o,i),s.appendChild(u),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",r,n,i)}},{key:"updateCellHeader",value:function(r,n,o){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,l=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(xe(r,"colHeader")?a=l.wtTable.columnFilter.sourceToRendered(n):xe(r,"rowHeader")&&(a=l.wtTable.rowFilter.sourceToRendered(n))),a>-1?fl(r,o(n,i)):(Ai(r,String.fromCharCode(160)),te(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Xi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Xi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Vx(this,iS)}},{key:"getRowHeadersCount",value:function(){return Vx(this,aS)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const FTe=jTe;function kO(e){"@babel/helpers - typeof";return kO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kO(e)}var OU="ABCDEFGHIJKLMNOPQRSTUVWXYZ",$O=OU.length;function ub(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%$O,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/$O,10);return r}function BTe(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow($O,n)*(OU.indexOf(e[r])+1);return t-=1,t}function VTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(ub(o)+(n+1));r.push(i)}return r}function WTe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=ub(o)+(n+1);r.push(i)}return r}function UTe(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function AO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,l){n.push([i+t,l,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function UP(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ue(e[0])&&(t=Bm(e[0]))),t}function RU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function EU(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return kO(t)==="object"&&!Array.isArray(t)&&t!==null}))}const zTe=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:UP,createEmptySpreadsheetData:UTe,createSpreadsheetData:VTe,createSpreadsheetObjectData:WTe,dataRowToChangesArray:AO,isArrayOfArrays:RU,isArrayOfObjects:EU,spreadsheetColumnIndex:BTe,spreadsheetColumnLabel:ub},Symbol.toStringTag,{value:"Module"}));function qh(e){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qh(e)}function YTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ux(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KTe(n.key),n)}}function GTe(e,t,r){return t&&Ux(e.prototype,t),r&&Ux(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KTe(e){var t=qTe(e,"string");return qh(t)==="symbol"?t:String(t)}function qTe(e,t){if(qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XTe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];YTe(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return GTe(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return A(this.data,function(i,a){var l=n.getAtCell(a,r);o.push(l)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=n===void 0&&o===void 0,s=null,u=null;if(s=this.modifyRowData(r),Array.isArray(s))u=[],l?s.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,s)}):Ce(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,s)});else if(Ue(s)||mt(s))if(a?u=[]:u={},!l||a){var f=0,c=this.countFirstRowKeys()-1;Ce(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,s);a?u.push(v):cg(u,d,v)}})}else ze(s,function(h,d){cg(u,d,i.getAtPhysicalCell(r,d,s))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=Va(o);this.hot.runHooks("modifySourceData",r,n,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:cg(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=AV(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=Va(i);this.hot.runHooks("modifySourceData",r,n,a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,l=null,s=null,u=null,f=null;n===null||o===null?(a=!0,l=0,u=this.countRows()-1):(l=Math.min(n.row,o.row),s=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Ce(l,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,s,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return UP(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const ZTe=XTe;var zx;function QTe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function JTe(e,t){return ze(t,function(r,n){bt(e[n])&&(e[n]=r)}),e}function TU(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function PU(e){ve(e)&&DE(dt(zx||(zx=QTe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function ePe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var kU=on("phraseFormatters"),tPe=kU.register,rPe=kU.getValues;function nPe(e,t){tPe(e,t)}function oPe(){return rPe()}nPe("pluralize",ePe);function Xh(e){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(e)}var fe;function ce(e,t,r){return t=iPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iPe(e){var t=aPe(e,"string");return Xh(t)==="symbol"?t:String(t)}function aPe(e,t){if(Xh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lPe=(fe={languageCode:"en-US"},ce(fe,CT,"No available options"),ce(fe,_T,"Insert row above"),ce(fe,OT,"Insert row below"),ce(fe,RT,"Insert column left"),ce(fe,ET,"Insert column right"),ce(fe,TT,["Remove row","Remove rows"]),ce(fe,PT,["Remove column","Remove columns"]),ce(fe,kT,"Undo"),ce(fe,$T,"Redo"),ce(fe,AT,"Read only"),ce(fe,IT,"Clear column"),ce(fe,YT,"Alignment"),ce(fe,GT,"Left"),ce(fe,KT,"Center"),ce(fe,qT,"Right"),ce(fe,XT,"Justify"),ce(fe,ZT,"Top"),ce(fe,QT,"Middle"),ce(fe,JT,"Bottom"),ce(fe,LT,"Freeze column"),ce(fe,jT,"Unfreeze column"),ce(fe,eP,"Borders"),ce(fe,tP,"Top"),ce(fe,rP,"Right"),ce(fe,nP,"Bottom"),ce(fe,oP,"Left"),ce(fe,iP,"Remove border(s)"),ce(fe,VT,"Add comment"),ce(fe,WT,"Edit comment"),ce(fe,UT,"Delete comment"),ce(fe,zT,"Read-only comment"),ce(fe,FT,"Merge cells"),ce(fe,BT,"Unmerge cells"),ce(fe,MT,"Copy"),ce(fe,xT,["Copy with header","Copy with headers"]),ce(fe,DT,["Copy with group header","Copy with group headers"]),ce(fe,NT,["Copy header only","Copy headers only"]),ce(fe,HT,"Cut"),ce(fe,aP,"Insert child row"),ce(fe,lP,"Detach from parent"),ce(fe,sP,["Hide column","Hide columns"]),ce(fe,uP,["Show column","Show columns"]),ce(fe,fP,["Hide row","Hide rows"]),ce(fe,cP,["Show row","Show rows"]),ce(fe,Jm,"None"),ce(fe,hP,"Is empty"),ce(fe,dP,"Is not empty"),ce(fe,vP,"Is equal to"),ce(fe,yP,"Is not equal to"),ce(fe,gP,"Begins with"),ce(fe,pP,"Ends with"),ce(fe,mP,"Contains"),ce(fe,bP,"Does not contain"),ce(fe,wP,"Greater than"),ce(fe,SP,"Greater than or equal to"),ce(fe,CP,"Less than"),ce(fe,_P,"Less than or equal to"),ce(fe,OP,"Is between"),ce(fe,RP,"Is not between"),ce(fe,EP,"After"),ce(fe,TP,"Before"),ce(fe,PP,"Today"),ce(fe,kP,"Tomorrow"),ce(fe,$P,"Yesterday"),ce(fe,Wp,"Blank cells"),ce(fe,AP,"Filter by condition"),ce(fe,IP,"Filter by value"),ce(fe,MP,"And"),ce(fe,eb,"Or"),ce(fe,xP,"Select all"),ce(fe,DP,"Clear"),ce(fe,NP,"OK"),ce(fe,HP,"Cancel"),ce(fe,LP,"Search"),ce(fe,jP,"Value"),ce(fe,FP,"Second value"),fe);const $U=lPe;var IO=$U.languageCode,fb=on("languagesDictionaries"),sPe=fb.register,AU=fb.getItem,uPe=fb.hasItem,fPe=fb.getValues;IU($U);function IU(e,t){var r=e,n=t;return Ue(e)&&(n=e,r=n.languageCode),cPe(r,n),sPe(r,fr(n)),fr(n)}function cPe(e,t){e!==IO&&JTe(t,AU(IO))}function MU(e){return zP(e)?fr(AU(e)):null}function zP(e){return uPe(e)}function hPe(){return fPe()}function xU(e,t,r){var n=MU(e);if(n===null)return null;var o=n[t];if(bt(o))return null;var i=dPe(o,r);return Array.isArray(i)?i[0]:i}function dPe(e,t){var r=e;return A(oPe(),function(n){r=n(e,t)}),r}function vPe(e){var t=TU(e);return zP(t)||(t=IO,PU(e)),t}var cb="active-header",hb="area",Zh="cell",YP="fill",Fv="header",GP="custom-selection";function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function yPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yx(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NU(n.key),n)}}function gPe(e,t,r){return t&&Yx(e.prototype,t),r&&Yx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tg(){return typeof Reflect<"u"&&Reflect.get?Tg=Reflect.get.bind():Tg=function(t,r,n){var o=pPe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Tg.apply(this,arguments)}function pPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_u(e),e!==null););return e}function mPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MO(e,t)}function MO(e,t){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},MO(e,t)}function bPe(e){var t=SPe();return function(){var n=_u(e),o;if(t){var i=_u(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wPe(this,o)}}function wPe(e,t){if(t&&(Cu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DU(e)}function DU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _u(e){return _u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_u(e)}function CPe(e,t,r){return t=NU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NU(e){var t=_Pe(e,"string");return Cu(t)==="symbol"?t:String(t)}function _Pe(e,t){if(Cu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OPe=function(e){mPe(r,e);var t=bPe(r);function r(n,o){var i;return yPe(this,r),i=t.call(this,n,null),CPe(DU(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return gPe(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,Tg(_u(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(o){var i=o.from,a=o.to,l=this.getNearestNotHiddenCoords(i,1),s=this.getNearestNotHiddenCoords(a,-1);if(l===null||s===null)return null;if(l.row>s.row||l.col>s.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;l=i,s=a}return this.settings.createCellRange(l,l,s)}},{key:"getNearestNotHiddenCoords",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i,l=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),o.row,i);if(l===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),o.col,a);return s===null?null:this.settings.createCellCoords(l,s)}},{key:"getNearestNotHiddenIndex",value:function(o,i,a){if(i<0)return i;var l=o.getNearestNotHiddenIndex(i,a),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&l===null?-1:l}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return o===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(o.from,o.to),this}},{key:"syncWith",value:function(o){var i=o.getVerticalDirection()==="N-S"?1:-1,a=o.getHorizontalDirection()==="W-E"?1:-1,l=this.getNearestNotHiddenCoords(o.from.clone().normalize(),i,a);if(l!==null&&o.overlaps(l)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(s)}return o.setHighlight(l),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,l=i.row===null||a.row===null,s=i.col===null||a.col===null,u=this.settings.createCellCoords(l?null:Math.min(i.row,a.row),s?null:Math.min(i.col,a.col)),f=this.settings.createCellCoords(l?null:Math.max(i.row,a.row),s?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),l=this.settings.visualToRenderableCoords(i);return this.settings.createCellRange(a,a,l)}}]),r}(Nbe);const Hf=OPe;function Qh(e){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(e)}var RPe=["activeHeaderClassName"];function Gx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Kx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gx(Object(r),!0).forEach(function(n){EPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EPe(e,t,r){return t=TPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TPe(e){var t=PPe(e,"string");return Qh(t)==="symbol"?t:String(t)}function PPe(e,t){if(Qh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kPe(e,t){if(e==null)return{};var r=$Pe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Pe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function APe(e){var t=e.activeHeaderClassName,r=kPe(e,RPe),n=new Hf(Kx(Kx({highlightHeaderClassName:t},r),{},{selectionType:cb}));return n}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var IPe=["layerLevel","areaCornerVisible"];function qx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Xx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qx(Object(r),!0).forEach(function(n){MPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MPe(e,t,r){return t=xPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xPe(e){var t=DPe(e,"string");return Jh(t)==="symbol"?t:String(t)}function DPe(e,t){if(Jh(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NPe(e,t){if(e==null)return{};var r=HPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function LPe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=NPe(e,IPe),o=new Hf(Xx(Xx({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:hb}));return o}function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}var jPe=["cellCornerVisible"];function Zx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zx(Object(r),!0).forEach(function(n){FPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FPe(e,t,r){return t=BPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BPe(e){var t=VPe(e,"string");return ed(t)==="symbol"?t:String(t)}function VPe(e,t){if(ed(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WPe(e,t){if(e==null)return{};var r=UPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function zPe(e){var t=e.cellCornerVisible,r=WPe(e,jPe),n=new Hf(Qx(Qx({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:Zh}));return n}function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}var YPe=["border","visualCellRange"];function Jx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jx(Object(r),!0).forEach(function(n){GPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GPe(e,t,r){return t=KPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KPe(e){var t=qPe(e,"string");return td(t)==="symbol"?t:String(t)}function qPe(e,t){if(td(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XPe(e,t){if(e==null)return{};var r=ZPe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function QPe(e){var t=e.border,r=e.visualCellRange,n=XPe(e,YPe),o=new Hf(lS(lS(lS({},t),n),{},{selectionType:GP}),r);return o}function rd(e){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(e)}function eD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function tD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eD(Object(r),!0).forEach(function(n){JPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JPe(e,t,r){return t=eke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eke(e){var t=tke(e,"string");return rd(t)==="symbol"?t:String(t)}function tke(e,t){if(rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rke(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function nke(e){var t=Object.assign({},(rke(e),e)),r=new Hf(tD(tD({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:YP}));return r}function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}var oke=["headerClassName","rowClassName","columnClassName"];function rD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rD(Object(r),!0).forEach(function(n){ike(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ike(e,t,r){return t=ake(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ake(e){var t=lke(e,"string");return nd(t)==="symbol"?t:String(t)}function lke(e,t){if(nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ske(e,t){if(e==null)return{};var r=uke(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function fke(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=ske(e,oke),i=new Hf(nD(nD({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:Fv}));return i}function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function oD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oD(Object(r),!0).forEach(function(n){hke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hke(e,t,r){return t=dke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dke(e){var t=vke(e,"string");return od(t)==="symbol"?t:String(t)}function vke(e,t){if(od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HU=on("highlight/types"),Lf=HU.register,yke=HU.getItem;Lf(cb,APe);Lf(hb,LPe);Lf(Zh,zPe);Lf(GP,QPe);Lf(YP,nke);Lf(Fv,fke);function kl(e,t){return yke(e)(cke({type:e},t))}function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}function Jo(e){return bke(e)||mke(e)||pke(e)||gke()}function gke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pke(e,t){if(e){if(typeof e=="string")return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}}function mke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bke(e){if(Array.isArray(e))return xO(e)}function xO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ic(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iD(Object(r),!0).forEach(function(n){wke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wke(e,t,r){return t=LU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ske(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LU(n.key),n)}}function Cke(e,t,r){return t&&aD(e.prototype,t),r&&aD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LU(e){var t=_ke(e,"string");return id(t)==="symbol"?t:String(t)}function _ke(e,t){if(id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oke=function(e){function t(r){Ske(this,t),this.options=r,this.layerLevel=0,this.cell=kl(Zh,r),this.fill=kl(YP,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Cke(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===Zh&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=kl(hb,ic({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Jo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=kl(Fv,ic({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Jo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=kl(cb,ic({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Jo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Jo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(kl(GP,ic(ic({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),A(this.areas.values(),function(n){return void n.clear()}),A(this.headers.values(),function(n){return void n.clear()}),A(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Jo(this.areas.values()),Jo(this.headers.values()),Jo(this.activeHeaders.values()),Jo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Rke=Oke;function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function Eke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pke(n.key),n)}}function Tke(e,t,r){return t&&lD(e.prototype,t),r&&lD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pke(e){var t=kke(e,"string");return ad(t)==="symbol"?t:String(t)}function kke(e,t){if(ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ke=function(e){function t(r){Eke(this,t),this.ranges=[],this.createCellRange=r}return Tke(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Ake=$ke;function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function Ike(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xke(n.key),n)}}function Mke(e,t,r){return t&&sD(e.prototype,t),r&&sD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xke(e){var t=Dke(e,"string");return ld(t)==="symbol"?t:String(t)}function Dke(e,t){if(ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jU=function(){function e(t,r){Ike(this,e),this.range=t,this.options=r}return Mke(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.options.createCellCoords(r,n),a=this.range.current().highlight,l=this.options.visualToRenderableCoords(a),s=l.row,u=l.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),s!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),y=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),w=this.options.minSpareCols(),S=this.options.autoWrapRow(),C=this.options.autoWrapCol();s+r>d-1?o&&m>0&&!(y&&s>=d-y-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):C&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):C&&s+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&w>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=s+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&s+i.row>=0&&(i.row=s+i.row===0?d-1:-1,i.col=v-1);var k=this.options.createCellCoords(s+i.row,u+i.col);c=0,h=0,k.row<0?(c=-1,k.row=0):k.row>0&&k.row>=d&&(c=1,k.row=d-1),k.col<0?(h=-1,k.col=0):k.col>0&&k.col>=v&&(h=1,k.col=v-1),f=this.options.renderableToVisualCoords(k)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=this.options.createCellCoords(r,n),i=this.range.current(),a=i.to,l=0,s=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),y=v.row,m=v.col,w=this.options.createCellCoords(y+o.row,m+o.col);l=0,s=0,w.row<0?(l=-1,w.row=0):w.row>0&&w.row>=h&&(l=1,w.row=h-1),w.col<0?(s=-1,w.col=0):w.col>0&&w.col>=d&&(s=1,w.col=d-1),a=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",a,l,s),a}}]),e}();gt(jU,Mr);const Nke=jU;function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}var uD;function fD(e,t){return Fke(e)||jke(e,t)||Lke(e,t)||Hke()}function Hke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lke(e,t){if(e){if(typeof e=="string")return cD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cD(e,t)}}function cD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Fke(e){if(Array.isArray(e))return e}function Bke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Vke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uke(n.key),n)}}function Wke(e,t,r){return t&&hD(e.prototype,t),r&&hD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uke(e){var t=zke(e,"string");return sd(t)==="symbol"?t:String(t)}function zke(e,t){if(sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FU=function(){function e(t,r){var n=this;Vke(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Ake(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new Rke({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},createCellRange:function(i,a,l){return n.tableProps.createCellRange(i,a,l)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Nke(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},createCellCoords:function(i,a){return n.tableProps.createCellCoords(i,a)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Wke(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=bt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=r.row<0,s=r.col<0,u=l&&s,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&bt(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Zh,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(A(this.highlight.getAreas(),function(y){return void y.clear()}),A(this.highlight.getHeaders(),function(y){return void y.clear()}),A(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(a.clear(),l.clear(),s.clear(),this.highlight.isEnabledFor(hb,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Fv,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),l.add(h.from).commit()):l.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&s.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&s.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Va(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),l=this.tableProps.createCellCoords(o-1,i-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(l),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=Su(r);if(o===ob)return!1;if(o===nb)throw new Error(dt(uD||(uD=Bke([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Vh(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),l=this.tableProps.countCols(),s=!r.some(function(u){var f=i(u),c=fD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=Zo(h,a)&&Zo(d,l)&&Zo(v,a)&&Zo(y,l);return!m});return s&&(this.clear(),A(r,function(u){var f=i(u),c=fD(f,4),h=c[0],d=c[1],v=c[2],y=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,y)),n.finish()})),s}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,l=this.tableProps.countCols(),s=this.tableProps.countRows(),u=Zo(i,l)&&Zo(a,l);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,i)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=Zo(r,i)&&Zo(n,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,o)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),l}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();a.commit(),l.commit(),s.commit()}this.highlight.useLayerLevel(o)}}}]),e}();gt(FU,Mr);const Yke=FU;var Gke=$e,BU=hv,Kke=zn.f,qke=ol,dD=Kt,Xke=mE,Zke=Ar,Qke=bE,vD=BU("".startsWith),Jke=BU("".slice),e$e=Math.min,VU=Qke("startsWith"),t$e=!VU&&!!function(){var e=Kke(String.prototype,"startsWith");return e&&!e.writable}();Gke({target:"String",proto:!0,forced:!t$e&&!VU},{startsWith:function(t){var r=dD(Zke(this));Xke(t);var n=qke(e$e(arguments.length>1?arguments[1]:void 0,r.length)),o=dD(t);return vD?vD(r,o,n):Jke(r,n,n+o.length)===o}});var yD=/^(\r\n|\n\r|\r|\n)/,r$e=/^[^\t\r\n]+/,gD=/^\t/;function n$e(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(gD))e=e.replace(gD,""),r+=1,t[n][r]="";else if(e.match(yD))e=e.replace(yD,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,l=!0;l;){var s=e.slice(0,1);s==='"'&&(a+=1),i+=s,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(r$e);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function jc(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function sS(e){return l$e(e)||a$e(e)||i$e(e)||o$e()}function o$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i$e(e,t){if(e){if(typeof e=="string")return DO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DO(e,t)}}function a$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l$e(e){if(Array.isArray(e))return DO(e)}function DO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ou(e){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(e)}function s$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f$e(n.key),n)}}function u$e(e,t,r){return t&&pD(e.prototype,t),r&&pD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f$e(e){var t=c$e(e,"string");return Ou(t)==="symbol"?t:String(t)}function c$e(e,t){if(Ou(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h$e=function(){function e(t,r,n){s$e(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return u$e(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,l=!1;if(typeof n=="function"){var s=Bm(r);i=s>0?s:this.countFirstRowKeys(),l=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=l?n(o):n[o];if(Ue(f)){if(typeof f.data<"u"){var c=l?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return UP(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,l=o,s;return typeof a>"u"&&(a=0,l=""),Ou(r)==="object"&&!Array.isArray(r)&&ze(r,function(u,f){u===null?(s=l+f,i.colToPropCache.push(s),i.propToColCache.set(s,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&ve(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(ve(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ps(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,l=i.mode,s=l===void 0?"above":l,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,o,a);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,y=this.getSchema().length,m=[],w=function(){var k=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?k=fr(n.getSchema()):(k=[],Ce(y-1,function(){return k.push(null)})):n.instance.dataType==="function"?k=n.tableMeta.dataSchema(h+c):(k={},Ov(k,n.getSchema())),m.push(k),c+=1};c<o&&u+c<v;)w();this.instance.rowIndexMapper.insertIndexes(h,c),s==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,m);var S=this.instance.toVisualRow(f);return this.instance.countSourceRows()===m.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):a!=="auto"&&this.metaManager.createRow(f,o)),this.instance.runHooks("afterCreateRow",S,c,a),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,l=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,i);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),y=this.instance.countCols(),m=0,w=d;l==="end"&&(w=Math.min(w+1,f));for(var S=w;m<n&&y<u;){if(typeof c!="number"||c>=y)if(v>0)for(var C=0;C<v;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(var k=0;k<v;k++)s[k].splice(w,0,null);m+=1,w+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,m),m>0&&(r==null?this.metaManager.createColumn(null,m):i!=="auto"&&this.metaManager.createColumn(S,n));var _=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",_,m,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-o,l=this.visualRowsToPhysical(a,o),s=this.instance.countSourceRows();a=(s+a)%s;var u=this.instance.runHooks("beforeRemoveRow",a,l.length,l,i);if(u===!1)return!1;var f=l.length;if(this.filterData(a,f,l),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(l);var c=ve(this.tableMeta.columns)||ve(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=l.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,f,l,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),l=a.slice(0).sort(function(S,C){return C-S}),s=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(s===!1)return!1;for(var u=!0,f=l.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var y=0,m=this.instance.countSourceRows();y<m;y++)for(var w=0;w<f;w++)c[y].splice(l[w],1),y===0&&this.metaManager.removeColumn(l[w],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];jC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return OV(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),l=i.slice(n+o),s=arguments.length,u=new Array(s>3?s-3:0),f=3;f<s;f++)u[f-3]=arguments[f];jC(u,l);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,o){var i=this,a=this.instance.runHooks("beforeDataSplice",r,n,o);if(a!==!1){var l=[].concat(sS(this.dataSource.slice(0,r)),sS(o),sS(this.dataSource.slice(r)));this.dataSource.length=0,l.forEach(function(s){return i.dataSource.push(s)})}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,l){return o.indexOf(l)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var l=null;if(i&&i.hasOwnProperty&&xt(i,n))l=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var s=n.split("."),u=i;if(!u)return null;for(var f=0,c=s.length;f<c;f++)if(u=u[s[f]],typeof u>"u")return null;l=u}else typeof n=="function"&&(l=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=Va(l);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(l=h.value)}return l}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,l=this.dataSource[i],s=this.instance.runHooks("modifyRowData",i);if(l=isNaN(s)?s:l,this.instance.hasHook("modifyData")){var u=Va(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(l&&l.hasOwnProperty&&xt(l,n))l[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=l,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):l[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,l=n,s;a<o&&l;)s=this.instance.toPhysicalRow(a),i.push(s),l-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,l=n;a<o&&l;){var s=this.instance.toPhysicalColumn(a);i.push(s),l-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,l,s,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){s=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(l=Math.min(r.col,n.col);l<=d&&v!==null;l++)s.push(c.call(this,a,this.colToProp(l)));v!==null&&i.push(s)}return i}},{key:"getText",value:function(r,n){return jc(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return jc(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const d$e=h$e;function v$e(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!xt(t,e)}function db(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?JE(t.type):t.type;if(e._automaticallyAssignedMetaProps&&ze(t,function(i,a){return void e._automaticallyAssignedMetaProps.delete(a)}),!!Ue(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var o={};ze(n,function(i,a){if(v$e(a,r)){var l;o[a]=i,(l=e._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),zt(e,o)}}function y$e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Ko(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function Pg(e){return Number.isInteger(e)&&e>=0}function kg(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Ty(e){return e==null}function NO(e){"@babel/helpers - typeof";return NO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NO(e)}const WU=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),Xt(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),Xt(o)===!1)return NO(o)==="object"?(i=this.getCellMeta(t,r),Fm(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function mD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function bD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mD(Object(r),!0).forEach(function(n){g$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g$e(e,t,r){return t=zU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zU(n.key),n)}}function UU(e,t,r){return t&&wD(e.prototype,t),r&&wD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zU(e){var t=p$e(e,"string");return ud(t)==="symbol"?t:String(t)}function p$e(e,t){if(ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m$e(){return UU(function e(){YU(this,e)})}var b$e=function(){function e(t){YU(this,e),this.metaCtor=m$e(),this.meta=this.metaCtor.prototype,zt(this.meta,WU()),this.meta.instance=t}return UU(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;zt(this.meta,r),db(this.meta,bD(bD({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function w$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C$e(n.key),n)}}function S$e(e,t,r){return t&&SD(e.prototype,t),r&&SD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C$e(e){var t=_$e(e,"string");return fd(t)==="symbol"?t:String(t)}function _$e(e,t){if(fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O$e=function(){function e(t){w$e(this,e);var r=t.getMetaConstructor();this.meta=new r}return S$e(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){zt(this.meta,r),db(this.meta,r,r)}}]),e}();function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}function CD(e){return P$e(e)||T$e(e)||E$e(e)||R$e()}function R$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E$e(e,t){if(e){if(typeof e=="string")return HO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HO(e,t)}}function T$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P$e(e){if(Array.isArray(e))return HO(e)}function HO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A$e(n.key),n)}}function $$e(e,t,r){return t&&_D(e.prototype,t),r&&_D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A$e(e){var t=I$e(e,"string");return cd(t)==="symbol"?t:String(t)}function I$e(e,t){if(cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LO=function(e){function t(r){k$e(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return $$e(t,[{key:"obtain",value:function(n){kg(function(){return Pg(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kg(function(){return Pg(n)||Ty(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=[],a=this.data.length,l=0;l<o;l++)i.push(a+l),this.data.push(void 0);var s=Ty(n)?this.index.length:n;this.index=[].concat(CD(this.index.slice(0,s)),i,CD(this.index.slice(s)))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kg(function(){return Pg(n)||Ty(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(Ty(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var l=i[a];typeof l=="number"&&this.holes.add(l)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Wr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var s=n[a];return a+=1,{value:s,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function M$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D$e(n.key),n)}}function x$e(e,t,r){return t&&OD(e.prototype,t),r&&OD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D$e(e){var t=N$e(e,"string");return hd(t)==="symbol"?t:String(t)}function N$e(e,t){if(hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H$e=["data","width"],L$e=function(){function e(t){var r=this;M$e(this,e),this.globalMeta=t,this.metas=new LO(function(){return r._createMeta()})}return x$e(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);zt(o,n),db(o,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return y$e(this.globalMeta.getMetaConstructor(),H$e).prototype}}]),e}();function dd(e){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dd(e)}function j$e(e){return W$e(e)||V$e(e)||B$e(e)||F$e()}function F$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B$e(e,t){if(e){if(typeof e=="string")return jO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jO(e,t)}}function V$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function W$e(e){if(Array.isArray(e))return jO(e)}function jO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y$e(n.key),n)}}function z$e(e,t,r){return t&&RD(e.prototype,t),r&&RD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y$e(e){var t=G$e(e,"string");return dd(t)==="symbol"?t:String(t)}function G$e(e,t){if(dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K$e=function(){function e(t){var r=this;U$e(this,e),this.columnMeta=t,this.metas=new LO(function(){return r._createRow()})}return z$e(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);zt(i,o),db(i,o)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a,l=this.metas.obtain(r).obtain(n);(a=l._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(o),l[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,j$e(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){kg(function(){return Pg(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new LO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function q$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ED(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z$e(n.key),n)}}function X$e(e,t,r){return t&&ED(e.prototype,t),r&&ED(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z$e(e){var t=Q$e(e,"string");return vd(t)==="symbol"?t:String(t)}function Q$e(e,t){if(vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GU=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];q$e(this,e),this.hot=t,this.globalMeta=new b$e(t),this.tableMeta=new O$e(this.globalMeta),this.columnMeta=new L$e(this.globalMeta),this.cellMeta=new K$e(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return X$e(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,l=this.cellMeta.getMeta(r,n);return l.visualRow=i,l.visualCol=a,l.row=r,l.col=n,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();gt(GU,Mr);function Up(e){"@babel/helpers - typeof";return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Up(e)}function TD(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,l=n.internalSource,s=n.source,u=n.metaManager,f=n.firstRun,c=ur(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":mt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(c),e,f,s);var d=new d$e(o,e,u);if(t(d),Up(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var y,m=0,w=0;for(m=0,w=h.startRows;m<w;m++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)y=fr(v),e.push(y);else if(o.dataType==="array")y=fr(v[0]),e.push(y);else{y=[];for(var S=0,C=h.startCols;S<C;S++)y.push(null);e.push(y)}}else throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(Up(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),o.runHooks("after".concat(c),e,f,s),f||(o.runHooks("afterChange",null,l),o.render())}function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function J$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t1e(n.key),n)}}function e1e(e,t,r){return t&&PD(e.prototype,t),r&&PD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function t1e(e){var t=r1e(e,"string");return yd(t)==="symbol"?t:String(t)}function r1e(e,t){if(yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n1e=function(){function e(t){var r=this;J$e(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ge.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return e1e(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,l=r.visualCol,s=this.metaManager.hot,u=s.colToProp(l);r.prop=u,s.runHooks("beforeGetCellMeta",a,l,r);var f=xt(r,"type")?r.type:null,c=mt(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),s.runHooks("afterGetCellMeta",a,l,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function o1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a1e(n.key),n)}}function i1e(e,t,r){return t&&kD(e.prototype,t),r&&kD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a1e(e){var t=l1e(e,"string");return gd(t)==="symbol"?t:String(t)}function l1e(e,t){if(gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s1e=function(){function e(t){o1e(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var o=this.metaManager.hot.isRtl();if(o&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,o,i){if(!i)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return i1e(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,o){var i=n.target,a=n.onChange,l=a===void 0?function(){}:a,s=typeof i=="string",u=s?i:o,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(o,f,l),s&&r.installPropWatcher(i,f,l)})}},{key:"installPropWatcher",value:function(r,n,o){var i=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(l){var s=!i.usageTracker.has(r);i.usageTracker.add(r),o.call(i,r,l,s),this[n]=l},enumerable:!0,configurable:!0})}}]),e}(),$D=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Py=function(t){return t.map(function(r){var n=r.toLowerCase();return $D.has(n)?$D.get(n):n}).sort().join("+")},u1e=function(t){return t.split("+")},AD=function(t){return t.toLowerCase()},ID;function f1e(e){return d1e(e)||h1e(e)||KU(e)||c1e()}function c1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function d1e(e){if(Array.isArray(e))return FO(e)}function v1e(e,t){return p1e(e)||g1e(e,t)||KU(e,t)||y1e()}function y1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KU(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function p1e(e){if(Array.isArray(e))return e}function m1e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var b1e=function(t){var r=qm({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,y=v===void 0?function(){return!0}:v,m=f.captureCtrl,w=m===void 0?!1:m,S=f.preventDefault,C=S===void 0?!0:S,k=f.stopPropagation,_=k===void 0?!1:k,N=f.relativeToGroup,V=f.position;if(bt(d))throw new Error("You need to define the shortcut's group.");if(mt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(dt(ID||(ID=m1e([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var X={callback:h,group:d,runOnlyIf:y,captureCtrl:w,preventDefault:C,stopPropagation:_};if(ve(N)){var Y=[N,V];X.relativeToGroup=Y[0],X.position=Y[1]}c.forEach(function(q){var Q=Py(q),ne=r.hasItem(Q);if(ne){var J=r.getItem(Q),ue=J.findIndex(function(he){return he.group===N});ue!==-1?V==="before"?ue-=1:ue+=1:ue=J.length,J.splice(ue,0,X)}else r.addItem(Q,[X])})},o=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){ze(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},i=function(f){var c=Py(f);r.removeItem(c)},a=function(f){var c=r.getItems();c.forEach(function(h){var d=v1e(h,2),v=d[0],y=d[1],m=y.filter(function(w){return w.group!==f});m.length===0?i(u1e(v)):(y.length=0,y.push.apply(y,f1e(m)))})},l=function(f){var c=Py(f),h=r.getItem(c);return ve(h)?h.slice():[]},s=function(f){var c=Py(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:o,getShortcuts:l,hasShortcut:s,removeShortcutsByKeys:i,removeShortcutsByGroup:a}};function w1e(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var S1e=["meta","alt","shift","control"],ac=w1e();function C1e(e,t,r,n,o){var i=function(d){return S1e.includes(d)},a=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return d.altKey&&y.push("alt"),v&&(d.ctrlKey||d.metaKey)?y.push("control/meta"):(d.ctrlKey&&y.push("control"),d.metaKey&&y.push("meta")),d.shiftKey&&y.push("shift"),y},l=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||la(d))){var y=AD(d.key),m=[];i(y)?ac.press(y):m=a(d);var w=[y].concat(m),S=o(d,w);!S&&(ep()&&m.includes("meta")||!ep()&&m.includes("control"))&&o(d,[y].concat(a(d,!0))),n(d)}}},s=function(d){if(t(d)!==!1){var v=AD(d.key);i(v)!==!1&&ac.release(v)}},u=function(){ac.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",l),d.document.documentElement.addEventListener("keyup",s),d.document.documentElement.addEventListener("blur",u),d=Xc(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",l),d.document.documentElement.removeEventListener("keyup",s),d.document.documentElement.removeEventListener("blur",u),d=Xc(d)};return{mount:f,unmount:c,isPressed:function(d){return ac.isPressed(d)},releasePressedKeys:function(){return ac.releaseAll()}}}var _1e=function(t){var r=t.ownerWindow,n=t.handleEvent,o=t.beforeKeyDown,i=t.afterKeyDown,a=qm({errorIdExists:function(y){return'The "'.concat(y,'" context name is already registered.')}}),l="grid",s=function(y){var m=b1e(y);return a.addItem(y,m),m},u=function(){return l},f=function(y){return a.getItem(y)},c=function(y){l=y},h=!1,d=C1e(r,n,o,i,function(v,y){var m=f(u()),w=!1;if(!m.hasShortcut(y))return w;for(var S=m.getShortcuts(y),C=0;C<S.length;C++){var k=S[C],_=k.callback,N=k.runOnlyIf,V=k.preventDefault,X=k.stopPropagation,Y=k.captureCtrl;if(N(v)!==!1&&(h=Y,w=_(v,y)===!1,h=!1,V&&v.preventDefault(),X&&v.stopPropagation(),w))break}return w});return d.mount(),{addContext:s,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}};function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(e)}function $n(e,t){return E1e(e)||R1e(e,t)||qU(e,t)||O1e()}function O1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function E1e(e){if(Array.isArray(e))return e}function $l(e){return k1e(e)||P1e(e)||qU(e)||T1e()}function T1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qU(e,t){if(e){if(typeof e=="string")return BO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(e,t)}}function P1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function k1e(e){if(Array.isArray(e))return BO(e)}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $1e="gridDefault",uS=null;function KP(e,t){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,l=new kt(a),s,u,f,c,h=!0;ETe(o)&&RTe(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=vPe(t.language);var y=new GU(a,t,[n1e,s1e]),m=y.getTableMeta(),w=y.getGlobalMeta(),S=qm();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),TO(this)&&PV(t.licenseKey,e),this.guid="ht_".concat(kE()),this.columnIndexMapper=new rO,this.rowIndexMapper=new rO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(g){a.runHooks("afterRowSequenceChange",g)}),u=new ZTe(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var C=function(p){var b=p.row,E=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getRenderableFromVisualIndex(b):b,E>=0?a.columnIndexMapper.getRenderableFromVisualIndex(E):E)},k=function(p){var b=p.row,E=p.col;return a._createCellCoords(b>=0?a.rowIndexMapper.getVisualFromRenderableIndex(b):b,E>=0?a.columnIndexMapper.getVisualFromRenderableIndex(E):E)},_=new Yke(m,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(p){return s.propToCol(p)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(p,b){return a._createCellCoords(p,b)},createCellRange:function(p,b,E){return a._createCellRange(p,b,E)},visualToRenderableCoords:C,renderableToVisualCoords:k,isDisabledCellSelection:function(p,b){return a.getCellMeta(p,b).disableVisualSelection}});this.selection=_;var N=function(p){var b=p.hiddenIndexesChanged;b&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",N),this.rowIndexMapper.addLocalHook("cacheUpdated",N),this.selection.addLocalHook("beforeSetRangeStart",function(g){n.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(g){n.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",function(g){n.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=n.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(g){var p=Va(!1),b=n.selection.getSelectedRange(),E=b.current(),R=E.from,B=E.to,x=b.size()-1;n.runHooks("afterSelection",R.row,R.col,B.row,B.col,p,x),n.runHooks("afterSelectionByProp",R.row,a.colToProp(R.col),B.row,a.colToProp(B.col),p,x);var K=n.selection.isSelectedByAnyHeader(),Z=n.selection.selectedRange.current(),re=!0;i&&(re=!1),p.isTouched()&&(re=!p.value);var ie=n.selection.isSelectedByRowHeader(),se=n.selection.isSelectedByColumnHeader();re!==!1&&(K?ie?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(g.row)):se&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(g.col)):Z&&!n.selection.isMultiple()?n.view.scrollViewport(C(Z.from)):n.view.scrollViewport(C(g))),ie&&se?te(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ie?(Le(n.rootElement,"ht__selection--columns"),te(n.rootElement,"ht__selection--rows")):se?(Le(n.rootElement,"ht__selection--rows"),te(n.rootElement,"ht__selection--columns")):Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(g){var p=g.length-1,b=g[p],E=b.from,R=b.to;n.runHooks("afterSelectionEnd",E.row,E.col,R.row,R.col,p),n.runHooks("afterSelectionEndByProp",E.row,a.colToProp(E.col),R.row,a.colToProp(R.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",function(g){var p=n.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("beforeModifyTransformStart",function(g){n.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",function(g,p,b){n.runHooks("afterModifyTransformStart",g,p,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(g){n.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",function(g,p,b){n.runHooks("afterModifyTransformEnd",g,p,b)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Le(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(g){n.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(g){n.alter("insert_col_start",g,1,"auto")}),f={alter:function(p,b){var E,R,B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0,Z=function(Me){if(Me.length===0)return[];var De=$l(Me);De.sort(function(Bt,Ve){var et=$n(Bt,1),Ct=et[0],ut=$n(Ve,1),ct=ut[0];return Ct===ct?0:Ct>ct?1:-1});var dr=Ft(De,function(Bt,Ve){var et=$n(Ve,2),Ct=et[0],ut=et[1],ct=Bt[Bt.length-1],tt=$n(ct,2),qo=tt[0],pb=tt[1],ji=qo+pb;if(Ct<=ji){var jf=Math.max(ut-(ji-Ct),0);ct[1]+=jf}else Bt.push([Ct,ut]);return Bt},[De[0]]);return dr};switch(p){case"insert_row_below":case"insert_row_above":var re=a.countSourceRows();if(m.maxRows===re)return;var ie=p==="insert_row_below"?"below":"above";b=(E=b)!==null&&E!==void 0?E:ie==="below"?re:0;var se=s.createRow(b,B,{source:x,mode:ie}),_e=se.delta,Se=se.startPhysicalIndex;if(_e){var z=_.selectedRange.current(),Ne=z==null?void 0:z.from,Be=Ne==null?void 0:Ne.row,ke=a.toVisualRow(Se);if(_.isSelectedByCorner())a.selectAll();else if(ve(Be)&&Be>=ke){var Ie=z.to,Ae=Ie.row,O=Ie.col,T=Ne.col;_.isSelectedByRowHeader()&&(T=-1),_.getSelectedRange().pop(),_.setRangeStartOnly(a._createCellCoords(Be+_e,T),!0),_.setRangeEnd(a._createCellCoords(Ae+_e,O))}else a._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var I=p==="insert_col_end"?"end":"start";b=(R=b)!==null&&R!==void 0?R:I==="end"?a.countSourceCols():0;var F=s.createCol(b,B,{source:x,mode:I}),M=F.delta,W=F.startPhysicalIndex;if(M){if(Array.isArray(m.colHeaders)){var H=[a.toVisualColumn(W),0];H.length+=M,Array.prototype.splice.apply(m.colHeaders,H)}var D=_.selectedRange.current(),U=D==null?void 0:D.from,j=U==null?void 0:U.col,G=a.toVisualColumn(W);if(_.isSelectedByCorner())a.selectAll();else if(ve(j)&&j>=G){var le=D.to,pe=le.row,Re=le.col,He=U.row;_.isSelectedByColumnHeader()&&(He=-1),_.getSelectedRange().pop(),_.setRangeStartOnly(a._createCellCoords(He,j+M),!0),_.setRangeEnd(a._createCellCoords(pe,Re+M))}else a._refreshBorders()}break;case"remove_row":var Ze=function(Me){var De=0;A(Me,function(dr){var Bt=$n(dr,2),Ve=Bt[0],et=Bt[1],Ct=Xt(Ve)?a.countRows()-1:Math.max(Ve-De,0);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ut=s.removeRow(Ve,et,x);if(ut){var ct=a.countRows(),tt=m.fixedRowsTop;tt>=Ct+1&&(m.fixedRowsTop-=Math.min(et,tt-Ct));var qo=m.fixedRowsBottom;qo&&Ct>=ct-qo&&(m.fixedRowsBottom-=Math.min(et,qo)),De+=et}})};Array.isArray(b)?Ze(Z(b)):Ze([[b,B]]),f.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var st=function(Me){var De=0;A(Me,function(dr){var Bt=$n(dr,2),Ve=Bt[0],et=Bt[1],Ct=Xt(Ve)?a.countCols()-1:Math.max(Ve-De,0),ut=a.toPhysicalColumn(Ct);Number.isInteger(Ve)&&(Ve=Math.max(Ve-De,0));var ct=s.removeCol(Ve,et,x);if(ct){var tt=m.fixedColumnsStart;tt>=Ct+1&&(m.fixedColumnsStart-=Math.min(et,tt-Ct)),Array.isArray(m.colHeaders)&&(typeof ut>"u"&&(ut=-1),m.colHeaders.splice(ut,et)),De+=et}})};Array.isArray(b)?st(Z(b)):st([[b,B]]),f.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(p,'"'))}K||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var p=m.minRows,b=m.minSpareRows,E=m.minCols,R=m.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&_.deselect(),p){var B=a.countRows();B<p&&s.createRow(B,p-B,{source:"auto"})}if(b){var x=a.countEmptyRows(!0);if(x<b){var K=b-x,Z=Math.min(K,m.maxRows-a.countSourceRows());s.createRow(a.countRows(),Z,{source:"auto"})}}{var re;(E||R)&&(re=a.countEmptyCols(!0));var ie=a.countCols();if(E&&!m.columns&&ie<E){var se=E-ie;re+=se,s.createCol(ie,se,{source:"auto"})}if(R&&!m.columns&&a.dataType==="array"&&re<R){ie=a.countCols();var _e=R-re,Se=Math.min(_e,m.maxCols-ie);s.createCol(ie,Se,{source:"auto"})}}if(_.isSelected()){var z=a.countRows(),Ne=a.countCols();A(_.selectedRange,function(Be){var ke=!1,Ie=Be.from.row,Ae=Be.from.col,O=Be.to.row,T=Be.to.col;Ie>z-1?(Ie=z-1,ke=!0,O>Ie&&(O=Ie)):O>z-1&&(O=z-1,ke=!0,Ie>O&&(Ie=O)),Ae>Ne-1?(Ae=Ne-1,ke=!0,T>Ae&&(T=Ae)):T>Ne-1&&(T=Ne-1,ke=!0,Ae>T&&(Ae=T)),ke&&a.selectCell(Ie,Ae,O,T)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(p,b,E,R,B){var x,K,Z,re,ie=[],se={},_e=[],Se=p.row,z=p.col;if(K=b.length,K===0)return!1;var Ne=0,Be=0;switch(Ue(E)&&(Ne=E.col-z+1,Be=E.row-Se+1),B){case"shift_down":var ke=Pc(b),Ie=ke.length,Ae=Math.max(Ie,Ne),O=a.getData().slice(Se),T=Pc(O).slice(z,z+Ae);for(Z=0;Z<Ae;Z+=1)if(Z<Ie){for(x=0,K=ke[Z].length;x<Be-K;x+=1)ke[Z].push(ke[Z][x%K]);Z<T.length?_e.push(ke[Z].concat(T[Z])):_e.push(ke[Z].concat(new Array(O.length).fill(null)))}else _e.push(ke[Z%Ie].concat(T[Z]));a.populateFromArray(Se,z,Pc(_e));break;case"shift_right":var I=b.length,F=Math.max(I,Be),M=a.getData().slice(Se).map(function(Ve){return Ve.slice(z)});for(x=0;x<F;x+=1)if(x<I){for(Z=0,re=b[x].length;Z<Ne-re;Z+=1)b[x].push(b[x][Z%re]);if(x<M.length)for(var W=0;W<M[x].length;W+=1)b[x].push(M[x][W]);else{var H;(H=b[x]).push.apply(H,$l(new Array(M[0].length).fill(null)))}}else b.push(b[x%K].slice(0,F).concat(M[x]));a.populateFromArray(Se,z,b);break;case"overwrite":default:se.row=p.row,se.col=p.col;var D=0,U=0,j=!0,G,le=function(et){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ut=b[et%b.length];return Ct!==null?ut[Ct%ut.length]:ut},pe=b.length,Re=E?E.row-p.row+1:0;for(E?K=Re:K=Math.max(pe,Re),x=0;x<K&&!(E&&se.row>E.row&&Re>pe||!m.allowInsertRow&&se.row>a.countRows()-1||se.row>=m.maxRows);x++){var He=x-D,Ze=le(He).length,st=E?E.col-p.col+1:0;if(E?re=st:re=Math.max(Ze,st),se.col=p.col,G=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&G.skipRowOnPaste){D+=1,se.row+=1,K+=1;continue}for(U=0,Z=0;Z<re&&!(E&&se.col>E.col&&st>Ze||!m.allowInsertColumn&&se.col>a.countCols()-1||se.col>=m.maxCols);Z++){if(G=a.getCellMeta(se.row,se.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&G.skipColumnOnPaste){U+=1,se.col+=1,re+=1;continue}if(G.readOnly&&R!=="UndoRedo.undo"){se.col+=1;continue}var Ge=Z-U,Me=le(He,Ge),De=a.getDataAtCell(se.row,se.col);if(Me!==null&&Er(Me)==="object")if(Array.isArray(Me)&&De===null&&(De=[]),De===null||Er(De)!=="object")j=!1;else{var dr=ps(Array.isArray(De)?De:De[0]||De),Bt=ps(Array.isArray(Me)?Me:Me[0]||Me);Fm(dr,Bt)||Array.isArray(dr)&&Array.isArray(Bt)?Me=fr(Me):j=!1}else De!==null&&Er(De)==="object"&&(j=!1);j&&ie.push([se.row,se.col,Me]),j=!0,se.col+=1}se.row+=1}a.setDataAtCell(ie,null,null,R||"populateFromArray");break}}};function V(g){var p=TU(g);zP(p)?(a.runHooks("beforeLanguageChange",p),w.language=p,a.runHooks("afterLanguageChange",p)):PU(g)}function X(g,p){var b=g==="className"?a.rootElement:a.table;if(h)te(b,p);else{var E=[],R=[];w[g]&&(E=Array.isArray(w[g])?w[g]:BC(w[g])),p&&(R=Array.isArray(p)?p:BC(p));var B=FC(E,R),x=FC(R,E);B.length&&Le(b,B),x.length&&te(b,x)}w[g]=p}this.init=function(){u.setData(m.data),a.runHooks("beforeInit"),(pn()||OE())&&te(a.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new FTe(this),c=ase.getInstance(a,m,_),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&sW(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),Er(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function Y(){var g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function q(g){var p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function Q(g,p,b){if(g.length){var E=a.getActiveEditor(),R=new Y,B=!0;R.onQueueEmpty=function(Se){E&&B&&E.cancelChanges(),b(Se)};for(var x=g.length-1;x>=0;x--){var K=$n(g[x],4),Z=K[0],re=K[1],ie=K[3],se=s.propToCol(re),_e=a.getCellMeta(Z,se);_e.type==="numeric"&&typeof ie=="string"&&wW(ie)&&(g[x][3]=q(ie)),a.getCellValidator(_e)&&(R.addValidatorToQueue(),a.validateCell(g[x][3],_e,function(Se,z){return function(Ne){if(typeof Ne!="boolean")throw new Error("Validation error: result is not boolean");if(Ne===!1&&z.allowInvalid===!1){B=!1,g.splice(Se,1),z.valid=!0;var Be=a.getCell(z.visualRow,z.visualCol);Be!==null&&Le(Be,m.invalidCellClassName)}R.removeValidatorFormQueue()}}(x,_e),p))}R.checkIfQueueIsEmpty()}}function ne(g,p){var b=g.length-1;if(!(b<0)){for(;b>=0;b--){var E=!1;if(g[b]===null){g.splice(b,1);continue}if(!((g[b][2]===null||g[b][2]===void 0)&&(g[b][3]===null||g[b][3]===void 0))){if(m.allowInsertRow)for(;g[b][0]>a.countRows()-1;){var R=s.createRow(void 0,void 0,{source:p}),B=R.delta;if(B===0){E=!0;break}}if(a.dataType==="array"&&(!m.columns||m.columns.length===0)&&m.allowInsertColumn)for(;s.propToCol(g[b][1])>a.countCols()-1;){var x=s.createCol(void 0,void 0,{source:p}),K=x.delta;if(K===0){E=!0;break}}E||s.set(g[b][0],g[b][1],g[b][3])}}a.forceFullRender=!0,f.adjustRowsAndCols(),a.runHooks("beforeChangeRender",g,p),c.lockEditor(),a._refreshBorders(null),c.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",g,p||"edit");var Z=a.getActiveEditor();Z&&ve(Z.refreshValue)&&Z.refreshValue()}}this._createCellCoords=function(g,p){return a.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,b){return a.view._wt.createCellRange(g,p,b)},this.validateCell=function(g,p,b,E){var R=a.getCellValidator(p);function B(x){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!K||p.hidden===!0){b(x);return}var Z=p.visualCol,re=p.visualRow,ie=a.getCell(re,Z,!0);if(ie&&ie.nodeName!=="TH"){var se=a.rowIndexMapper.getRenderableFromVisualIndex(re),_e=a.columnIndexMapper.getRenderableFromVisualIndex(Z);a.view._wt.getSetting("cellRenderer",se,_e,ie)}b(x)}TV(R)&&(R=function(x){return function(K,Z){Z(x.test(K))}}(R)),mt(R)?(g=a.runHooks("beforeValidate",g,p.visualRow,p.prop,E),a._registerImmediate(function(){R.call(p,g,function(x){a&&(x=a.runHooks("afterValidate",x,g,p.visualRow,p.prop,E),p.valid=x,B(x),a.runHooks("postAfterValidate",x,g,p.visualRow,p.prop,E))})})):a._registerImmediate(function(){p.valid=!0,B(p.valid,!1)})};function J(g,p,b){return Array.isArray(g)?g:[[g,p,b]]}function ue(g,p){var b=a.getActiveEditor(),E=a.runHooks("beforeChange",g,p||"edit"),R=g.filter(function(B){return B!==null});return E===!1||R.length===0?(b&&b.cancelChanges(),[]):R}this.setDataAtCell=function(g,p,b,E){var R=J(g,p,b),B=[],x=E,K,Z,re;for(K=0,Z=R.length;K<Z;K++){if(Er(R[K])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[K][1]>=this.countCols()?re=R[K][1]:re=s.colToProp(R[K][1]),B.push([R[K][0],re,u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]])}!x&&Er(g)==="object"&&(x=p);var ie=ue(B,E);a.runHooks("afterSetDataAtCell",ie,x),Q(ie,x,function(){ne(ie,x)})},this.setDataAtRowProp=function(g,p,b,E){var R=J(g,p,b),B=[],x=E,K,Z;for(K=0,Z=R.length;K<Z;K++)B.push([R[K][0],R[K][1],u.getAtCell(this.toPhysicalRow(R[K][0]),R[K][1]),R[K][2]]);!x&&Er(g)==="object"&&(x=p);var re=ue(B,E);a.runHooks("afterSetDataAtRowProp",re,x),Q(re,x,function(){ne(re,x)})},this.listen=function(){a&&!a.isListening()&&(uS=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(uS=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return uS===a.guid},this.destroyEditor=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(g,p)},this.populateFromArray=function(g,p,b,E,R,B,x){if(!(Er(b)==="object"&&Er(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var K=typeof E=="number"?a._createCellCoords(E,R):null;return f.populateFromArray(a._createCellCoords(g,p),b,K,B,x)},this.spliceCol=function(g,p,b){for(var E,R=arguments.length,B=new Array(R>3?R-3:0),x=3;x<R;x++)B[x-3]=arguments[x];return(E=s).spliceCol.apply(E,[g,p,b].concat(B))},this.spliceRow=function(g,p,b){for(var E,R=arguments.length,B=new Array(R>3?R-3:0),x=3;x<R;x++)B[x-3]=arguments[x];return(E=s).spliceRow.apply(E,[g,p,b].concat(B))},this.getSelected=function(){if(_.isSelected())return We(_.getSelectedRange(),function(g){var p=g.from,b=g.to;return[p.row,p.col,b.row,b.col]})},this.getSelectedLast=function(){var g=this.getSelected(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(_.isSelected())return Array.from(_.getSelectedRange())},this.getSelectedRangeLast=function(){var g=this.getSelectedRange(),p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){var p=this;if(!(!_.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];A(_.getSelectedRange(),function(E){var R=E.getTopStartCorner(),B=E.getBottomEndCorner();Ce(R.row,B.row,function(x){Ce(R.col,B.col,function(K){p.getCellMeta(x,K).readOnly||b.push([x,K,null])})})}),b.length>0&&this.setDataAtCell(b,g)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(g){this.suspendRender();var p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=g();return this.resumeExecution(p),b},this.batch=function(g){this.suspendRender(),this.suspendExecution();var p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(a.view){var g=a.view.getLastSize(),p=g.width,b=g.height,E=a.rootElement.getBoundingClientRect(),R=E.width,B=E.height,x=R!==p||B!==b,K=a.runHooks("beforeRefreshDimensions",{width:p,height:b},{width:R,height:B},x)===!1;K||((x||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(R,B),a.render()),a.runHooks("afterRefreshDimensions",{width:p,height:b},{width:R,height:B},x))}},this.updateData=function(g,p){var b=this;TD(g,function(E){s=E},function(E){s=E,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"updateData",source:p,metaManager:y,firstRun:h})},this.loadData=function(g,p){TD(g,function(b){s=b},function(){y.clearCellsCache(),a.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:s,dataSource:u,internalSource:"loadData",source:p,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var g=m.columns,p=0;if(Array.isArray(g))p=g.length;else if(mt(g))if(a.dataType==="array")for(var b=this.countSourceCols(),E=0;E<b;E+=1)g(E)&&(p+=1);else(a.dataType==="object"||a.dataType==="function")&&(p=s.colToPropCache.length);else if(ve(m.dataSchema)){var R=s.getSchema();p=Array.isArray(R)?R.length:Bm(R)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,b,E){return bt(g)?s.getAll():s.getRange(a._createCellCoords(g,p),a._createCellCoords(b,E),s.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,b,E){return s.getCopyableText(a._createCellCoords(g,p),a._createCellCoords(b,E))},this.getCopyableData=function(g,p){return s.getCopyable(g,s.colToProp(p))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),E=!1,R,B;if(ve(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ve(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ve(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in g)R==="data"||(R==="language"?V(g.language):R==="className"?X("className",g.className):R==="tableClassName"&&a.table?(X("tableClassName",g.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(R)||ge.getSingleton().isDeprecated(R)?(mt(g[R])||Array.isArray(g[R]))&&(g[R].initialHook=!0,a.addHook(R,g[R])):!p&&xt(g,R)&&(w[R]=g[R]));g.data===void 0&&m.data===void 0?b(null,"updateSettings"):g.data!==void 0?b(g.data,"updateSettings"):g.columns!==void 0&&(s.createMap(),a.initIndexMappers());var x=a.countCols(),K=m.columns;if(K&&mt(K)&&(E=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),x>0)for(R=0,B=0;R<x;R++){if(K){var Z=E?K(R):K[B];Z&&y.updateColumnMeta(B,Z)}B+=1}ve(g.cell)&&ze(g.cell,function(z){a.setCellMetaObject(z.row,z.col,z)}),a.runHooks("afterCellMetaReset");var re=a.rootElement.style.height;re!==""&&(re=parseInt(a.rootElement.style.height,10));var ie=g.height;if(mt(ie)&&(ie=ie()),p){var se=a.rootElement.getAttribute("style");se&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(ie===null){var _e=a.rootElement.getAttribute("data-initialstyle");_e&&(_e.indexOf("height")>-1||_e.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",_e):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else ie!==void 0&&(a.rootElement.style.height=isNaN(ie)?"".concat(ie):"".concat(ie,"px"),a.rootElement.style.overflow="hidden");if(typeof g.width<"u"){var Se=g.width;mt(Se)&&(Se=Se()),a.rootElement.style.width=isNaN(Se)?"".concat(Se):"".concat(Se,"px")}p||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",g)),f.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,c.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!p&&a.view&&(re===""||ie===""||ie===void 0)&&re!==ie&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var g=a.getSelectedLast();if(m.getValue){if(mt(m.getValue))return m.getValue.call(a);if(g)return a.getData()[g[0][0]][m.getValue]}else if(g)return a.getDataAtCell(g[0],g[1])},this.getSettings=function(){return m},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,b,E,R){f.alter(g,p,b,E,R)},this.getCell=function(g,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=p,R=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return R===null||E===null?null:a.view.getCellAtCoords(a._createCellCoords(R,E),b)},this.getCoords=function(g){var p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;var b=p.row,E=p.col,R=b,B=E;return b>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(b)),E>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(E)),a._createCellCoords(R,B)},this.colToProp=function(g){return s.colToProp(g)},this.propToCol=function(g){return s.propToCol(g)},this.toVisualRow=function(g){return n.rowIndexMapper.getVisualFromPhysicalIndex(g)},this.toVisualColumn=function(g){return n.columnIndexMapper.getVisualFromPhysicalIndex(g)},this.toPhysicalRow=function(g){return n.rowIndexMapper.getPhysicalFromVisualIndex(g)},this.toPhysicalColumn=function(g){return n.columnIndexMapper.getPhysicalFromVisualIndex(g)},this.getDataAtCell=function(g,p){return s.get(g,s.colToProp(p))},this.getDataAtRowProp=function(g,p){return s.get(g,p)},this.getDataAtCol=function(g){for(var p=[],b=s.getRange(a._createCellCoords(0,g),a._createCellCoords(m.data.length-1,g),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var R=0;R<b[E].length;R+=1)p.push(b[E][R]);return p},this.getDataAtProp=function(g){for(var p=[],b=s.getRange(a._createCellCoords(0,s.propToCol(g)),a._createCellCoords(m.data.length-1,s.propToCol(g)),s.DESTINATION_RENDERER),E=0;E<b.length;E+=1)for(var R=0;R<b[E].length;R+=1)p.push(b[E][R]);return p},this.getSourceData=function(g,p,b,E){var R;return g===void 0?R=u.getData():R=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(b,E)),R},this.getSourceDataArray=function(g,p,b,E){var R;return g===void 0?R=u.getData(!0):R=u.getByRange(a._createCellCoords(g,p),a._createCellCoords(b,E),!0),R},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,b,E){var R=J(g,p,b),B=this.hasHook("afterSetSourceDataAtCell"),x=[];B&&A(R,function(Z){var re=$n(Z,3),ie=re[0],se=re[1],_e=re[2];x.push([ie,se,u.getAtCell(ie,se),_e])}),A(R,function(Z){var re=$n(Z,3),ie=re[0],se=re[1],_e=re[2];u.setAtCell(ie,se,_e)}),B&&this.runHooks("afterSetSourceDataAtCell",x,E),this.render();var K=a.getActiveEditor();K&&ve(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return u.getAtCell(g,p)},this.getDataAtRow=function(g){var p=s.getRange(a._createCellCoords(g,0),a._createCellCoords(g,this.countCols()-1),s.DESTINATION_RENDERER);return p[0]||[]},this.getDataType=function(g,p,b,E){var R=this,B=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,b,E],x=B[0],K=B[1],Z=B[2],re=B[3],ie=null,se=null;Z===void 0&&(Z=x),re===void 0&&(re=K);var _e="mixed";return Ce(Math.max(Math.min(x,Z),0),Math.max(x,Z),function(Se){var z=!0;return Ce(Math.max(Math.min(K,re),0),Math.max(K,re),function(Ne){var Be=R.getCellMeta(Se,Ne);return se=Be.type,ie?z=ie===se:ie=se,z}),_e=z?se:"mixed",z}),_e},this.removeCellMeta=function(g,p,b){var E=[this.toPhysicalRow(g),this.toPhysicalColumn(p)],R=E[0],B=E[1],x=y.getCellMetaKeyValue(R,B,b),K=a.runHooks("beforeRemoveCellMeta",g,p,b,x);K!==!1&&(y.removeCellMeta(R,B,b),a.runHooks("afterRemoveCellMeta",g,p,b,x)),x=null},this.spliceCellsMeta=function(g){for(var p=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=arguments.length,R=new Array(E>2?E-2:0),B=2;B<E;B++)R[B-2]=arguments[B];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&y.removeRow(this.toPhysicalRow(g),b),R.length>0&&A(R.reverse(),function(x){y.createRow(p.toPhysicalRow(g)),A(x,function(K,Z){return p.setCellMetaObject(g,Z,K)})}),a.render()},this.setCellMetaObject=function(g,p,b){var E=this;Er(b)==="object"&&ze(b,function(R,B){E.setCellMeta(g,p,B,R)})},this.setCellMeta=function(g,p,b,E){var R=a.runHooks("beforeSetCellMeta",g,p,b,E);if(R!==!1){var B=g,x=p;g<this.countRows()&&(B=this.toPhysicalRow(g)),p<this.countCols()&&(x=this.toPhysicalColumn(p)),y.setCellMeta(B,x,b,E),a.runHooks("afterSetCellMeta",g,p,b,E)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,p){var b=this.toPhysicalRow(g),E=this.toPhysicalColumn(p);return b===null&&(b=g),E===null&&(E=p),y.getCellMeta(b,E,{visualRow:g,visualColumn:p})},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||m.columns)},this.getCellRenderer=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).renderer:g.renderer;return typeof b=="string"?fp(b):bt(b)?fp("text"):b},this.getCellEditor=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).editor:g.editor;return typeof b=="string"?ip(b):bt(b)?ip("text"):b},this.getCellValidator=function(g,p){var b=typeof g=="number"?a.getCellMeta(g,p).validator:g.validator;return typeof b=="string"?QE(b):b},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,b){var E=new Y;g&&(E.onQueueEmpty=g);for(var R=a.countRows()-1;R>=0;){if(p!==void 0&&p.indexOf(R)===-1){R-=1;continue}for(var B=a.countCols()-1;B>=0;){if(b!==void 0&&b.indexOf(B)===-1){B-=1;continue}E.addValidatorToQueue(),a.validateCell(a.getDataAtCell(R,B),a.getCellMeta(R,B),function(x){if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),B-=1}R-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(g){var p=m.rowHeaders,b=g;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(p=[],Ce(a.countRows()-1,function(E){p.push(a.getRowHeader(E))})):Array.isArray(p)&&p[b]!==void 0?p=p[b]:mt(p)?p=p(b):p&&typeof p!="string"&&typeof p!="number"&&(p=b+1),p},this.hasRowHeaders=function(){return!!m.rowHeaders},this.hasColHeaders=function(){if(m.colHeaders!==void 0&&m.colHeaders!==null)return!!m.colHeaders;for(var g=0,p=a.countCols();g<p;g++)if(a.getColHeader(g))return!0;return!1},this.getColHeader=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",g);if(b===void 0){for(var E=[],R=a.countCols(),B=0;B<R;B++)E.push(a.getColHeader(B));return E}var x=m.colHeaders,K=function(se){for(var _e=[],Se=a.countCols(),z=0;z<Se;z++)mt(m.columns)&&m.columns(z)&&_e.push(z);return _e[se]},Z=a.toPhysicalColumn(b),re=K(Z);return m.colHeaders===!1?x=null:m.columns&&mt(m.columns)&&m.columns(re)&&m.columns(re).title?x=m.columns(re).title:m.columns&&m.columns[Z]&&m.columns[Z].title?x=m.columns[Z].title:Array.isArray(m.colHeaders)&&m.colHeaders[Z]!==void 0?x=m.colHeaders[Z]:mt(m.colHeaders)?x=m.colHeaders(Z):m.colHeaders&&typeof m.colHeaders!="string"&&typeof m.colHeaders!="number"&&(x=ub(b)),x=a.runHooks("modifyColumnHeaderValue",x,g,p),x},this._getColWidthFromSettings=function(g){var p;if(g>=0){var b=a.getCellMeta(0,g);p=b.width}if((p===void 0||p===m.width)&&(p=m.colWidths),p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g){var p=a._getColWidthFromSettings(g);return p=a.runHooks("modifyColWidth",p,g),p===void 0&&(p=nT.DEFAULT_WIDTH),p},this._getRowHeightFromSettings=function(g){var p=m.rowHeights;if(p!=null){switch(Er(p)){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(g){var p=a._getRowHeightFromSettings(g);return p=a.runHooks("modifyRowHeight",p,g),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var g=m.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return lp(a.countRows()-1,function(b){if(a.isEmptyRow(b))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return lp(a.countCols()-1,function(b){if(a.isEmptyCol(b))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return m.isEmptyRow.call(a,g)},this.isEmptyCol=function(g){return m.isEmptyCol.call(a,g)},this.selectCell=function(g,p,b,E){var R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return bt(g)||bt(p)?!1:this.selectCells([[g,p,b,E]],R,B)},this.selectCells=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&(i=!0);var E=_.selectCells(g);return E&&b&&a.listen(),i=!1,E},this.selectColumns=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return _.selectColumns(g,p)},this.selectRows=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return _.selectRows(g,p)},this.deselectCell=function(){_.deselect()},this.selectAll=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=g&&this.hasRowHeaders(),b=g&&this.hasColHeaders();i=!0,_.selectAll(p,b),i=!1};var he=function(p,b){return p.getNearestNotHiddenIndex(b,1,!0)};this.scrollViewportTo=function(g,p){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=!b,x=!E,K=g,Z=p;if(R){var re=Number.isInteger(g),ie=Number.isInteger(p),se=re?he(this.rowIndexMapper,g):void 0,_e=ie?he(this.columnIndexMapper,p):void 0;if(se===null||_e===null)return!1;K=re?a.rowIndexMapper.getRenderableFromVisualIndex(se):void 0,Z=ie?a.columnIndexMapper.getRenderableFromVisualIndex(_e):void 0}var Se=Number.isInteger(K),z=Number.isInteger(Z);return Se&&z?a.view.scrollViewport(a._createCellCoords(K,Z),B,E,b,x):Se&&z===!1?a.view.scrollViewportVertically(K,B,b):z&&Se===!1?a.view.scrollViewportHorizontally(Z,E,x):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),TO(a)){var g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Cn(a.rootElement),l.destroy(),c&&c.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(p){var b=$n(p,2),E=b[1];E.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(a),ze(a,function(p,b,E){mt(p)?E[b]=Oe(b):b!=="guid"&&(E[b]=null)}),a.isDestroyed=!0,s&&s.destroy(),s=null,f=null,_=null,c=null,a=null};function Oe(g){return function(){throw new Error('The "'.concat(g,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){var p=ur(g);return p==="UndoRedo"?this.undoRedo:S.getItem(p)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(g)},this.getInstance=function(){return a},this.addHook=function(g,p){ge.getSingleton().add(g,p,a)},this.hasHook=function(g){return ge.getSingleton().has(g,a)||ge.getSingleton().has(g)},this.addHookOnce=function(g,p){ge.getSingleton().once(g,p,a)},this.removeHook=function(g,p){ge.getSingleton().remove(g,p,a)},this.runHooks=function(g,p,b,E,R,B,x){return ge.getSingleton().run(a,g,p,b,E,R,B,x)},this.getTranslatedPhrase=function(g,p){return xU(m.language,g,p)},this.toHTML=function(){return RO(n)},this.toTableElement=function(){var g=n.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",RO(n)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=g;typeof b=="function"&&(b=setTimeout(b,p)),this.timeouts.push(b)},this._clearTimeouts=function(){A(this.timeouts,function(g){clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){A(this.immediates,function(g){clearImmediate(g)})},this._refreshBorders=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(g),a.view.render(),p&&_.isSelected()&&c.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var we=_1e({handleEvent:function(p){var b=a.isListening(),E=(p==null?void 0:p.key)!==void 0;return b&&E},beforeKeyDown:function(p){return n.runHooks("beforeKeyDown",p)},afterKeyDown:function(p){n.isDestroyed||a.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(g){g.ctrlKey===!1&&g.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we};var $=we.addContext("grid"),P={runOnlyIf:function(){return ve(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:$1e};we.setActiveContextName("grid"),$.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var p=a.getSelectedRange(),b=p[p.length-1].highlight,E=b.row,R=b.col,B=a.getDataAtCell(E,R),x=new Map,K=0;K<p.length;K++)p[K].forAll(function(Z,re){if(Z>=0&&re>=0&&(Z!==E||re!==R)){var ie=a.getCellMeta(Z,re),se=ie.readOnly;se||x.set("".concat(Z,"x").concat(re),[Z,re,B])}});a.setDataAtCell(Array.from(x.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){_.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){_.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){_.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,E=p.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);_.setRangeStart(b.clone()),_.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){_.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){_.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){_.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p=a.getSelectedRangeLast(),b=p.from,E=p.to,R=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);_.setRangeStart(b.clone()),_.setRangeEnd(a._createCellCoords(R,E.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){_.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,E=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,$l(a.isRtl()?[a.countCols()-1,-1]:[0,1]));_.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowLeft","Shift"]],callback:function(){_.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),E=b.from,R=b.to,B=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,$l(a.isRtl()?[a.countCols()-1,-1]:[0,1]));_.setRangeStart(E.clone()),_.setRangeEnd(a._createCellCoords(R.row,B))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){_.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast().highlight.row,E=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,$l(a.isRtl()?[0,1]:[a.countCols()-1,-1]));_.setRangeStart(a._createCellCoords(b,E))}},{keys:[["ArrowRight","Shift"]],callback:function(){_.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var p,b=a.getSelectedRangeLast(),E=b.from,R=b.to,B=(p=a.columnIndexMapper).getNearestNotHiddenIndex.apply(p,$l(a.isRtl()?[0,1]:[a.countCols()-1,-1]));_.setRangeStart(E.clone()),_.setRangeEnd(a._createCellCoords(R.row,B))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedColumnsStart,10),b=a.getSelectedRangeLast().highlight.row,E=a.columnIndexMapper.getNearestNotHiddenIndex(p,1);_.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){_.setRangeEnd(a._createCellCoords(_.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsTop,10),b=parseInt(a.getSettings().fixedColumnsStart,10),E=a.rowIndexMapper.getNearestNotHiddenIndex(p,1),R=a.columnIndexMapper.getNearestNotHiddenIndex(b,1);_.setRangeStart(a._createCellCoords(E,R))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){_.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){_.setRangeEnd(a._createCellCoords(_.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var p=parseInt(a.getSettings().fixedRowsBottom,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-p-1,-1),E=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);_.setRangeStart(a._createCellCoords(b,E))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){_.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,E=Math.max(b.row-a.countVisibleRows(),0),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,1);if(R!==null){var B=a._createCellCoords(R,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.max(B.row-x,0);_.setRangeEnd(B),a.scrollViewportTo(K)}}},{keys:[["PageDown"]],callback:function(){_.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var p=a.getSelectedRangeLast(),b=p.to,E=Math.min(b.row+a.countVisibleRows(),a.countRows()-1),R=a.rowIndexMapper.getNearestNotHiddenIndex(E,-1);if(R!==null){var B=a._createCellCoords(R,b.col),x=b.row-a.view.getFirstFullyVisibleRow(),K=Math.min(B.row-x,a.countRows()-1);_.setRangeEnd(B),a.scrollViewportTo(K)}}},{keys:[["Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;_.transformStart(b.row,b.col,!0)}},{keys:[["Shift","Tab"]],callback:function(p){var b=typeof m.tabMoves=="function"?m.tabMoves(p):m.tabMoves;_.transformStart(-b.row,-b.col)}}],P),tT().forEach(function(g){var p=Iv(g);S.addItem(g,new p(n))}),ge.getSingleton().run(a,"construct")}function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function MD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function xD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MD(Object(r),!0).forEach(function(n){A1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function A1e(e,t,r){return t=XU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XU(n.key),n)}}function M1e(e,t,r){return t&&DD(e.prototype,t),r&&DD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XU(e){var t=x1e(e,"string");return pd(t)==="symbol"?t:String(t)}function x1e(e,t){if(pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ND=215,ZU="menu",D1e=ZU,QU=function(){function e(t,r){I1e(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:ND,container:this.hot.rootDocument.documentElement},this.eventManager=new kt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return M1e(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Xc(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=HE(function(d){return r.openSubMenu(d)},300),o=this.options.minWidth||ND,i=!1,a=Wr(this.menuItems,function(d){return d.key===Wh&&(i=!0),e0e(d,r.hot)});if(a.length<1&&!i)a.push(cU()[Wh]);else if(a.length===0)return;a=n0e(a,qe);var l=!1,s={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return ve(v)&&v<o?o:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,y,m,w,S,C){return r.menuItemRenderer(v,y,m,w,S,C)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,y){r.isAllSubMenusClosed()?n(y.row):r.openSubMenu(y.row)},rowHeights:function(v){return a[v].name===qe?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),UC()&&l&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(l=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!UC()||!$i(v))&&l&&r.hasSelectedItem()&&(pn()||OE()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new KP(this.container,s),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(D1e),c={group:ZU},h=xD(xD({},c),{},{runOnlyIf:function(v){return Jc(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var y=r.openSubMenu(v[0]);y&&y.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var y=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(y[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!XRe(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;A(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?qRe(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,l=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===qe||l===!0||a}},{key:"setPosition",value:function(r){var n=new wEe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.right;n+=r.cellWidth+i-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var o=this.parentMenu.container.getBoundingClientRect(),i=o.left;n-=r.left-i}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);Cy(r)||_y(r)||Oy(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);Cy(n)||_y(n)||Oy(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;i&&(Cy(i)||_y(i)||Oy(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;i&&(Cy(i)||_y(i)||Oy(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,l){var s=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(w){return xt(w,"submenu")},h=function(w){return new RegExp(qe,"i").test(w.name)},d=function(w){return w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(s.hot)===!0},v=function(w){return w.disableSelection},y=l;typeof y=="function"&&(y=y.call(this.hot)),Cn(n),te(f,"htItemWrapper"),n.appendChild(f),h(u)?te(n,"htSeparator"):typeof u.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,y))):fl(f,y),d(u)?(te(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(te(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(te(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Le(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(mt(o)&&(o=o.call(this.hot),o===null||bt(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),te(i,"htMenu ".concat(this.options.className)),o&&te(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),l=Ft(n,function(s,u){return s+(u.name===qe?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(l+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!mi(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!mi(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&xe(r.target,"htCore")&&mi(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();gt(QU,Mr);const qP=QU;function Ru(e){"@babel/helpers - typeof";return Ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(e)}function N1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L1e(n.key),n)}}function H1e(e,t,r){return t&&HD(e.prototype,t),r&&HD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L1e(e){var t=j1e(e,"string");return Ru(t)==="symbol"?t:String(t)}function j1e(e,t){if(Ru(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,r,n){var o=F1e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function F1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function B1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VO(e,t)}function VO(e,t){return VO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},VO(e,t)}function V1e(e){var t=U1e();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return W1e(this,o)}}function W1e(e,t){if(t&&(Ru(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JU(e)}function JU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}var ky="contextMenu",z1e=70;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var ez=function(e){B1e(r,e);var t=V1e(r);function r(n){var o;return N1e(this,r),o=t.call(this,n),o.eventManager=new kt(JU(o)),o.commandExecutor=new sU(o.hot),o.itemsFactory=null,o.menu=null,o}return H1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ky]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[ky];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new qP(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(s))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),ba(wo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),ba(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u-ws(o.view),a=f-Wa(o.view)}else i=-1*ws(this.menu.hotMenu.rootWindow),a=-1*Wa(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new hU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[ky],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var l=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",l),this.menu.setMenuItems(l),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,l=i.colHeaders;function s(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!xe(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||l)&&!s(u)&&!(xe(u,"current")&&xe(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ba(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ky}},{key:"PLUGIN_PRIORITY",get:function(){return z1e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[ab,lb,qe,Nv,Hv,qe,ib,jv,qe,sb,rb,qe,Lv,qe,Xr]}}]),r}(ot);ez.SEPARATOR={name:qe};function Y1e(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(MT)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function G1e(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(NT,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function K1e(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(DT,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function q1e(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(xT,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function X1e(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(HT)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function Z1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J1e(n.key),n)}}function Q1e(e,t,r){return t&&LD(e.prototype,t),r&&LD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J1e(e){var t=eAe(e,"string");return md(t)==="symbol"?t:String(t)}function eAe(e,t){if(md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tAe=function(){function e(){Z1e(this,e),this.data={}}return Q1e(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function jD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nAe(n.key),n)}}function rAe(e,t,r){return t&&jD(e.prototype,t),r&&jD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nAe(e){var t=oAe(e,"string");return bd(t)==="symbol"?t:String(t)}function oAe(e,t){if(bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var aAe=rAe(function e(){iAe(this,e),this.clipboardData=new tAe});function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function lAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uAe(n.key),n)}}function sAe(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uAe(e){var t=fAe(e,"string");return wd(t)==="symbol"?t:String(t)}function fAe(e,t){if(wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XP=function(){function e(t){lAe(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new kt(this),this.listenersCount=new WeakSet,this.container=t}return sAe(e,[{key:"useSecondaryElement",value:function(){var r=dAe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),BD(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),BD(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",pn()||lW(this.mainElement)}}]),e}();gt(XP,Mr);var zp=new WeakMap;function cAe(e){var t=new XP(e),r=zp.get(e);return r=isNaN(r)?0:r,zp.set(e,r+1),t}function hAe(e){e.eventManager.clear()}var fS=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function BD(e,t,r){e.addEventListener(t,"copy",fS("copy",r)),e.addEventListener(t,"cut",fS("cut",r)),e.addEventListener(t,"paste",fS("paste",r))}var Yp=new WeakMap;function dAe(e){var t=Yp.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Yp.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function VD(e){if(e instanceof XP){var t=zp.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),hAe(e),t<=0){t=0;var r=Yp.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Yp.delete(e.container)),e.mainElement=null}zp.set(e.container,t)}}function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function vAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gAe(n.key),n)}}function yAe(e,t,r){return t&&WD(e.prototype,t),r&&WD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gAe(e){var t=pAe(e,"string");return Sd(t)==="symbol"?t:String(t)}function pAe(e,t){if(Sd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UD(e,t){tz(e,t),t.add(e)}function Al(e,t,r){tz(e,t),t.set(e,r)}function tz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $y(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function mr(e,t){var r=rz(e,t,"get");return mAe(e,r)}function mAe(e,t){return t.get?t.get.call(e):t.value}function Il(e,t,r){var n=rz(e,t,"set");return bAe(e,n,r),r}function rz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ei=new WeakMap,cS=new WeakMap,lc=new WeakMap,WO=new WeakMap,UO=new WeakMap,sc=new WeakMap,Ay=new WeakSet,zD=new WeakSet,wAe=function(){function e(t){var r=t.countRows,n=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;vAe(this,e),UD(this,zD),UD(this,Ay),Al(this,ei,{writable:!0,value:void 0}),Al(this,cS,{writable:!0,value:void 0}),Al(this,lc,{writable:!0,value:void 0}),Al(this,WO,{writable:!0,value:void 0}),Al(this,UO,{writable:!0,value:void 0}),Al(this,sc,{writable:!0,value:void 0}),Il(this,cS,r),Il(this,lc,n),Il(this,WO,o),Il(this,UO,i),Il(this,sc,a)}return yAe(e,[{key:"setSelectedRange",value:function(r){Il(this,ei,r)}},{key:"getCellsRange",value:function(){if(mr(this,cS).call(this)===0||mr(this,lc).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.row,o=r.col,i=mr(this,ei).getBottomEndCorner(),a=i.row,l=i.col,s=$y(this,zD,SAe).call(this,n,a),u=$y(this,Ay,hS).call(this,o,l),f=a!==s||l!==u;return{isRangeTrimmed:f,startRow:n,startCol:o,endRow:s,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(mr(this,lc).call(this)===0||mr(this,sc).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.col,o=mr(this,ei).getBottomEndCorner(),i=o.col,a=$y(this,Ay,hS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(mr(this,lc).call(this)===0||mr(this,sc).call(this)===0)return null;var r=mr(this,ei).getTopStartCorner(),n=r.col,o=mr(this,ei).getBottomEndCorner(),i=o.col,a=$y(this,Ay,hS).call(this,n,i),l=i!==a;return{isRangeTrimmed:l,startRow:-mr(this,sc).call(this),startCol:n,endRow:-1,endCol:a}}}]),e}();function hS(e,t){return Math.min(t,Math.max(e+mr(this,UO).call(this)-1,e))}function SAe(e,t){return Math.min(t,Math.max(e+mr(this,WO).call(this)-1,e))}function nz(e){var t=[],r=[];return A(e,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Ce(o,i,function(s){t.indexOf(s)===-1&&t.push(s)});var a=Math.min(n.startCol,n.endCol),l=Math.max(n.startCol,n.endCol);Ce(a,l,function(s){r.indexOf(s)===-1&&r.push(s)})}),{rows:t,columns:r}}function CAe(e,t){return EAe(e)||RAe(e,t)||OAe(e,t)||_Ae()}function _Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OAe(e,t){if(e){if(typeof e=="string")return YD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YD(e,t)}}function YD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function EAe(e){if(Array.isArray(e))return e}function el(e){"@babel/helpers - typeof";return el=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},el(e)}function TAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iz(n.key),n)}}function PAe(e,t,r){return t&&GD(e.prototype,t),r&&GD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,r,n){var o=kAe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function kAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function $Ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zO(e,t)}function zO(e,t){return zO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},zO(e,t)}function AAe(e){var t=MAe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return IAe(this,o)}}function IAe(e,t){if(t&&(el(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pr(e)}function pr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function xAe(e,t){oz(e,t),t.add(e)}function Zi(e,t,r){oz(e,t),t.set(e,r)}function oz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(e,t,r){return t=iz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iz(e){var t=DAe(e,"string");return el(t)==="symbol"?t:String(t)}function DAe(e,t){if(el(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(el(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NAe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Dr(e,t){var r=az(e,t,"get");return HAe(e,r)}function HAe(e,t){return t.get?t.get.call(e):t.value}function Jn(e,t,r){var n=az(e,t,"set");return LAe(e,n,r),r}function az(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function LAe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");var Iy="copyPaste",jAe=80,FAe=["fragmentSelection"],KD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),dS=new WeakMap,vS=new WeakMap,yS=new WeakMap,xl=new WeakMap,My=new WeakMap,xy=new WeakMap,Dl=new WeakMap,qD=new WeakSet,BAe=function(e){$Ae(r,e);var t=AAe(r);function r(){var n;TAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),xAe(pr(n),qD),Ml(pr(n),"columnsLimit",1/0),Ml(pr(n),"rowsLimit",1/0),Ml(pr(n),"pasteMode","overwrite"),Ml(pr(n),"uiContainer",n.hot.rootDocument.body),Zi(pr(n),dS,{writable:!0,value:!1}),Zi(pr(n),vS,{writable:!0,value:!1}),Zi(pr(n),yS,{writable:!0,value:!1}),Zi(pr(n),xl,{writable:!0,value:"cells-only"}),Zi(pr(n),My,{writable:!0,value:!1}),Zi(pr(n),xy,{writable:!0,value:!1}),Zi(pr(n),Dl,{writable:!0,value:new wAe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Ml(pr(n),"copyableRanges",[]),Ml(pr(n),"focusableElement",void 0),n}return PAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Iy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[Iy];if(el(a)==="object"){var l,s;this.pasteMode=(l=a.pasteMode)!==null&&l!==void 0?l:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Jn(this,dS,!!a.copyColumnHeaders),Jn(this,vS,!!a.copyColumnGroupHeaders),Jn(this,yS,!!a.copyColumnHeadersOnly),this.uiContainer=(s=a.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=cAe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),wa(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),wa(So(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&VD(this.focusableElement),wa(So(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Jn(this,xl,o),Jn(this,My,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Jn(this,xy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){return jc(this.getRangedData(o))}},{key:"getRangedData",value:function(o){var i=this,a=[],l=nz(o),s=l.rows,u=l.columns;return A(s,function(f){var c=[];A(u,function(h){f<0?c.push(i.hot.getColHeader(h,f)):c.push(i.hot.getCopyableData(f,h))}),a.push(c)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new aAe;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(o){Dr(this,Dl).setSelectedRange(o);var i=new Map([["headers",null],["cells",null]]);Dr(this,xl)==="column-headers-only"?i.set("headers",Dr(this,Dl).getMostBottomColumnHeadersRange()):(Dr(this,xl)==="with-column-headers"?i.set("headers",Dr(this,Dl).getMostBottomColumnHeadersRange()):Dr(this,xl)==="with-column-group-headers"&&i.set("headers",Dr(this,Dl).getAllColumnHeadersRange()),i.set("cells",Dr(this,Dl).getCellsRange())),this.copyableRanges=Array.from(i.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,y=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=i.get("cells");if(a!==null&&a.isRangeTrimmed){var l=a.startRow,s=a.startCol,u=a.endRow,f=a.endCol;this.hot.runHooks("afterCopyLimit",u-l+1,f-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var o,i=(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.TEXTAREA;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o;return(o=this.hot.getActiveEditor())===null||o===void 0?void 0:o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(o.length){for(var a=o.length,l=o[0].length,s=[],u=i.getTopStartCorner(),f=u.row,c=u.col,h=i.getBottomEndCorner(),d=h.row,v=h.col,y=f,m=c,w=f,S=c;s.length<a||y<=d;){var C=this.hot.getCellMeta(y,c),k=C.skipRowOnPaste,_=C.visualRow;if(y=_+1,k!==!0){w=_,m=c;for(var N=[],V=s.length%a;N.length<l||m<=v;){var X=this.hot.getCellMeta(f,m),Y=X.skipColumnOnPaste,q=X.visualCol;if(m=q+1,Y!==!0){S=q;var Q=N.length%l;N.push(o[V][Q])}}s.push(N)}}return this.hot.populateFromArray(f,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,w,S]}}},{key:"onCopy",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,My)||this.isEditorOpened())){this.setCopyableText(),Jn(this,My,!1);var i=this.getRangedData(this.copyableRanges),a=NAe(this,qD,VAe).call(this,this.copyableRanges),l=!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a);if(l){var s=jc(i);if(o&&o.clipboardData){var u=EO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",s),o.clipboardData.setData("text/html",[KD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",i,this.copyableRanges,a)}Jn(this,xl,"cells-only"),o.preventDefault()}}},{key:"onCut",value:function(o){if(!(!this.hot.isListening()&&!Dr(this,xy)||this.isEditorOpened())){this.setCopyableText(),Jn(this,xy,!1);var i=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",i,this.copyableRanges);if(a){var l=jc(i);if(o&&o.clipboardData){var s=EO(i,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[KD,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData<"u"){var a=Um(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var l=bU(a,this.hot.rootDocument);i=l.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=n$e(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var s=this.populateValues(i),u=CAe(s,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},Y1e(this)),Dr(this,dS)&&o.items.push(q1e(this)),Dr(this,vS)&&o.items.push(K1e(this)),Dr(this,yS)&&o.items.push(G1e(this)),o.items.push(X1e(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&oW())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(VD(this.focusableElement),this.focusableElement=null),wa(So(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Iy}},{key:"SETTING_KEYS",get:function(){return[Iy].concat(FAe)}},{key:"PLUGIN_PRIORITY",get:function(){return jAe}}]),r}(ot);function VAe(e){for(var t=nz(e),r=t.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function lz(e,t){return"border_row".concat(e,"col").concat(t)}function _c(){return{width:1,color:"#000"}}function Co(){return{hide:!0}}function WAe(){return{width:1,color:"#000",cornerVisible:!1}}function gS(e){if(ve(e.start)||ve(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(ve(e.end)||ve(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function uc(e){return ve(e.start)&&(e.left=e.start),ve(e.end)&&(e.right=e.end),e}function pS(e,t){return{id:lz(e,t),border:WAe(),row:e,col:t,top:Co(),bottom:Co(),start:Co(),end:Co()}}function UAe(e,t){return xt(t,"border")&&t.border&&(e.border=t.border),xt(t,"top")&&ve(t.top)&&(t.top?(Ue(t.top)||(t.top=_c()),e.top=t.top):(t.top=Co(),e.top=t.top)),xt(t,"bottom")&&ve(t.bottom)&&(t.bottom?(Ue(t.bottom)||(t.bottom=_c()),e.bottom=t.bottom):(t.bottom=Co(),e.bottom=t.bottom)),xt(t,"start")&&ve(t.start)&&(t.start?(Ue(t.start)||(t.start=_c()),e.start=t.start):(t.start=Co(),e.start=t.start)),xt(t,"end")&&ve(t.end)&&(t.end?(Ue(t.end)||(t.end=_c()),e.end=t.end):(t.end=Co(),e.end=t.end)),e}function Wo(e,t){var r=!1;return A(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!xt(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function vb(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function zAe(e){return e.some(function(t){return ve(t.left)||ve(t.right)})}function YAe(e){return e.some(function(t){return ve(t.start)||ve(t.end)})}var GAe=new Map([["left","start"],["right","end"]]);function KAe(e){var t;return(t=GAe.get(e))!==null&&t!==void 0?t:e}function qAe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(nP),n=Wo(this,"bottom");return n&&(r=vb(r)),r},callback:function(r,n){var o=Wo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function XAe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(oP),o=Wo(this,t);return o&&(n=vb(n)),n},callback:function(n,o){var i=Wo(this,t);e.prepareBorder(o,t,i)}}}function ZAe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(iP)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Wo(this)}}}function QAe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(rP),o=Wo(this,t);return o&&(n=vb(n)),n},callback:function(n,o){var i=Wo(this,t);e.prepareBorder(o,t,i)}}}function JAe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(tP),n=Wo(this,"top");return n&&(r=vb(r)),r},callback:function(r,n){var o=Wo(this,"top");e.prepareBorder(n,"top",o)}}}function Eu(e){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(e)}function XD(e,t){return nIe(e)||rIe(e,t)||tIe(e,t)||eIe()}function eIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tIe(e,t){if(e){if(typeof e=="string")return ZD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZD(e,t)}}function ZD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function nIe(e){if(Array.isArray(e))return e}function oIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uz(n.key),n)}}function iIe(e,t,r){return t&&QD(e.prototype,t),r&&QD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,r,n){var o=aIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function aIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function lIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YO(e,t)}function sIe(e){var t=fIe();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uIe(this,o)}}function uIe(e,t){if(t&&(Eu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sz(e)}function sz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}function cIe(e,t,r){return t=uz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uz(e){var t=hIe(e,"string");return Eu(t)==="symbol"?t:String(t)}function hIe(e,t){if(Eu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dy="customBorders",dIe=90,vIe=function(e){lIe(r,e);var t=sIe(r);function r(){var n;oIe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),cIe(sz(n),"savedBorders",[]),n}return iIe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Dy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),Sa(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Sa(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Sa(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,l=["top","bottom","start","end"],s=null;i&&(this.checkSettingsCohesion([i]),l=Object.keys(i),s=gS(i));var u=Su(o),f=Vh(u);A(o,function(c){for(var h=f(c),d=XD(h,4),v=d[0],y=d[1],m=d[2],w=d[3],S=function(_){for(var N=function(Y){A(l,function(q){a.prepareBorderFromCustomAdded(_,Y,s,KAe(q))})},V=y;V<=w;V+=1)N(V)},C=v;C<=m;C+=1)S(C)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=Su(o),l=Vh(a),s=[];return A(o,function(u){for(var f=l(u),c=XD(f,4),h=c[0],d=c[1],v=c[2],y=c[3],m=function(C){for(var k=function(V){A(i.savedBorders,function(X){X.row===C&&X.col===V&&s.push(uc(X))})},_=d;_<=y;_+=1)k(_)},w=h;w<=v;w+=1)m(w)}),s}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(A(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var l=this.hot._createCellRange(this.hot._createCellCoords(o.row,o.col)),s=this.checkCustomSelections(o,l,i);s||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:l})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,l){var s=this.hot.countRows(),u=this.hot.countCols();if(!(o>=s||i>=u)){var f=pS(o,i);a&&(f=UAe(f,a),A(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(o,i,"borders",uc(f)),this.insertBorderIntoSettings(f,l)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o,i){var a=this,l=Math.min(o.to.row,this.hot.countRows()-1),s=Math.min(o.to.col,this.hot.countCols()-1);Ce(o.from.row,l,function(u){Ce(o.from.col,s,function(f){var c=pS(u,f),h=0;u===o.from.row&&xt(i,"top")&&(h+=1,c.top=i.top),u===o.to.row&&xt(i,"bottom")&&(h+=1,c.bottom=i.bottom),f===o.from.col&&xt(i,"start")&&(h+=1,c.start=i.start),f===o.to.col&&xt(i,"end")&&(h+=1,c.end=i.end),h>0&&(a.hot.setCellMeta(u,f,"borders",uc(c)),a.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=lz(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,l){var s=this.hot.getCellMeta(o,i).borders;if(!s||s.border===void 0?s=pS(o,i):s=gS(s),l){s[a]=Co();var u=this.countHide(s);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(s,a,l);f||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",uc(s))}}else{s[a]=_c();var c=this.checkCustomSelectionsFromContextMenu(s,a,l);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(o,i,"borders",uc(s))}}},{key:"prepareBorder",value:function(o,i,a){var l=this;A(o,function(s){var u=s.start,f=s.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?l.removeAllBorders(u.row,u.col):l.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Ce(u.col,f.col,function(c){Ce(u.row,f.row,function(h){l.removeAllBorders(h,c)})});break;case"top":Ce(u.col,f.col,function(c){l.setBorder(u.row,c,i,a)});break;case"bottom":Ce(u.col,f.col,function(c){l.setBorder(f.row,c,i,a)});break;case"start":Ce(u.row,f.row,function(c){l.setBorder(c,u.col,i,a)});break;case"end":Ce(u.row,f.row,function(c){l.setBorder(c,f.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;A(o,function(a){var l=gS(a);a.range?i.prepareBorderFromCustomAddedRange(a.range,l):i.prepareBorderFromCustomAdded(a.row,a.col,l)})}},{key:"countHide",value:function(o){var i=o.top,a=o.bottom,l=o.start,s=o.end,u=[i,a,l,s];return Ft(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=We(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;A(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;A(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=We(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,l=this.countHide(o);return l===4?(this.spliceBorder(o.id),a=!0):A(this.savedBorders,function(s,u){if(o.id===s.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var l=!1;return A(this.hot.selection.highlight.customSelections,function(s){if(o.id===s.settings.id)return ze(s.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),l=!0,!1}),l}},{key:"checkCustomSelections",value:function(o,i,a){var l=this.countHide(o),s=!1;return l===4?(this.removeAllBorders(o.row,o.col),s=!0):A(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&ze(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[Dy];if(Array.isArray(o)){var i=fr(o);this.checkSettingsCohesion(i),i.length||(this.savedBorders=i),this.createCustomBorders(i)}else o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(o){var i=zAe(o),a=YAe(o);if(i&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&i)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(o){this.hot.getSettings()[Dy]&&o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(eP)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[JAe(this),QAe(this),qAe(this),XAe(this),ZAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Sa(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dy}},{key:"PLUGIN_PRIORITY",get:function(){return dIe}}]),r}(ot);function Tu(e){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tu(e)}function yIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pIe(n.key),n)}}function gIe(e,t,r){return t&&JD(e.prototype,t),r&&JD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pIe(e){var t=mIe(e,"string");return Tu(t)==="symbol"?t:String(t)}function mIe(e,t){if(Tu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ca(){return typeof Reflect<"u"&&Reflect.get?Ca=Reflect.get.bind():Ca=function(t,r,n){var o=bIe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function bIe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function wIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},GO(e,t)}function SIe(e){var t=_Ie();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CIe(this,o)}}function CIe(e,t){if(t&&(Tu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fz(e)}function fz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Ie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}var eN="dragToScroll",OIe=100,RIe=function(e){wIe(r,e);var t=SIe(r);function r(n){var o;return yIe(this,r),o=t.call(this,n),o.eventManager=new kt(fz(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return gIe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[eN]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),Ca(Oo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ca(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Ca(Oo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,l=0;i<this.boundaries.top?l=i-this.boundaries.top:i>this.boundaries.bottom&&(l=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,l)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(l){return o.onMouseMove(l)}),a=Xc(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!$i(o)){var i=this.hot.view._wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,l){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),l<0?i.scrollTop-=20:l>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){this.isListening()&&this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){Ca(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return eN}},{key:"PLUGIN_PRIORITY",get:function(){return OIe}}]),r}(ot);function Pu(e){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pu(e)}function EIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PIe(n.key),n)}}function TIe(e,t,r){return t&&tN(e.prototype,t),r&&tN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PIe(e){var t=kIe(e,"string");return Pu(t)==="symbol"?t:String(t)}function kIe(e,t){if(Pu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _a(){return typeof Reflect<"u"&&Reflect.get?_a=Reflect.get.bind():_a=function(t,r,n){var o=$Ie(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_a.apply(this,arguments)}function $Ie(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function AIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KO(e,t)}function IIe(e){var t=xIe();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return MIe(this,o)}}function MIe(e,t){if(t&&(Pu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cz(e)}function cz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");var mS="dropdownMenu",DIe=230,bS="changeType",hz=function(e){AIe(r,e);var t=IIe(r);function r(n){var o;return EIe(this,r),o=t.call(this,n),o.eventManager=new kt(cz(o)),o.commandExecutor=new sU(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return TIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[mS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new hU(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[mS],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),_a(Ro(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var l=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new qP(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",l),o.menu.setMenuItems(l),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var s,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(s=o.executeCommand).call.apply(s,[o].concat(f))}),A(l,function(s){return o.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_a(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),_a(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){this.menu&&(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=this.commandExecutor).execute.apply(i,[o].concat(l))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),xe(o.target,bS)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var l=this.hot.rootWindow.frameElement,s=l.getBoundingClientRect(),u=s.top,f=s.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(a){var l=a.parentNode.childNodes,s=Array.prototype.indexOf.call(l,a);if(!(o<0||s!==l.length-1)){var u=i.querySelector(".".concat(bS));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=bS,f.type="button",f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),_a(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return mS}},{key:"PLUGIN_PRIORITY",get:function(){return DIe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Nv,Hv,qe,jv,qe,tb,qe,Lv,qe,Xr]}}]),r}(ot);hz.SEPARATOR={name:qe};function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function NIe(e,t){return FIe(e)||jIe(e,t)||LIe(e,t)||HIe()}function HIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LIe(e,t){if(e){if(typeof e=="string")return rN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rN(e,t)}}function rN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function FIe(e){if(Array.isArray(e))return e}function BIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WIe(n.key),n)}}function VIe(e,t,r){return t&&nN(e.prototype,t),r&&nN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WIe(e){var t=UIe(e,"string");return Cd(t)==="symbol"?t:String(t)}function UIe(e,t){if(Cd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zIe=function(){function e(t){BIe(this,e),this.hot=t,this.options={}}return VIe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,l=n.endCol,s=this.options,u=[];return Ce(o,a,function(f){var c=[];!s.exportHiddenRows&&r._isHiddenRow(f)||(Ce(i,l,function(h){!s.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,l=this.hot.getRowHeader();Ce(i,a,function(s){!r.options.exportHiddenRows&&r._isHiddenRow(s)||n.push(l[s])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,l=this.hot.getColHeader();Ce(i,a,function(s){!r.options.exportHiddenColumns&&r._isHiddenColumn(s)||n.push(l[s])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=NIe(this.options.range,4),i=o[0],a=i===void 0?0:i,l=o[1],s=l===void 0?0:l,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),s=Math.max(s,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:s,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const YIe=zIe;function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function GIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qIe(n.key),n)}}function KIe(e,t,r){return t&&oN(e.prototype,t),r&&oN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qIe(e){var t=XIe(e,"string");return _d(t)==="symbol"?t:String(t)}function XIe(e,t){if(_d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZIe=function(){function e(t,r){GIe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return KIe(e,[{key:"_mergeOptions",value:function(r){var n=Sr(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=zt(Sr(e.DEFAULT_OPTIONS),n),n=zt(n,r),n.filename=AE(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const QIe=ZIe;function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function JIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tMe(n.key),n)}}function eMe(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tMe(e){var t=rMe(e,"string");return ku(t)==="symbol"?t:String(t)}function rMe(e,t){if(ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qO(e,t)}function qO(e,t){return qO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qO(e,t)}function oMe(e){var t=lMe();return function(){var n=Gp(e),o;if(t){var i=Gp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iMe(this,o)}}function iMe(e,t){if(t&&(ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aMe(e)}function aMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gp(e){return Gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gp(e)}var sMe=String.fromCharCode(13),uMe=String.fromCharCode(34),fMe=String.fromCharCode(10),cMe=function(e){nMe(r,e);var t=oMe(r);function r(){return JIe(this,r),t.apply(this,arguments)}return eMe(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),l=this.dataProvider.getColumnHeaders(),s=l.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return s&&(l=We(l,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=l.join(i.columnDelimiter),c+=i.rowDelimiter),A(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Dt(o);return a!==""&&(i||a.indexOf(sMe)>=0||a.indexOf(uMe)>=0||a.indexOf(fMe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(QIe);const hMe=cMe;function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function dMe(e,t,r){return t=vMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vMe(e){var t=yMe(e,"string");return Od(t)==="symbol"?t:String(t)}function yMe(e,t){if(Od(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gMe="csv",XO=dMe({},gMe,hMe);function pMe(e,t,r){return typeof XO[e]=="function"?new XO[e](t,r):null}function $u(e){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(e)}function mMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wMe(n.key),n)}}function bMe(e,t,r){return t&&aN(e.prototype,t),r&&aN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wMe(e){var t=SMe(e,"string");return $u(t)==="symbol"?t:String(t)}function SMe(e,t){if($u(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZO(e,t)}function ZO(e,t){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ZO(e,t)}function _Me(e){var t=EMe();return function(){var n=Kp(e),o;if(t){var i=Kp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return OMe(this,o)}}function OMe(e,t){if(t&&($u(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RMe(e)}function RMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kp(e){return Kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kp(e)}var TMe="exportFile",PMe=240,kMe=function(e){CMe(r,e);var t=_Me(r);function r(){return mMe(this,r),t.apply(this,arguments)}return bMe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,l=a.rootDocument,s=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=s.URL||s.webkitURL,h=l.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),l.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),l.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!XO[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return pMe(o,new YIe(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob<"u"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return TMe}},{key:"PLUGIN_PRIORITY",get:function(){return PMe}}]),r}(ot);function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function $Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IMe(n.key),n)}}function AMe(e,t,r){return t&&lN(e.prototype,t),r&&lN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IMe(e){var t=MMe(e,"string");return Rd(t)==="symbol"?t:String(t)}function MMe(e,t){if(Rd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dz=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;$Me(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Zm)}return AMe(e,[{key:"reset",value:function(){A(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();gt(dz,Mr);const yb=dz;var Ed={};function Mi(e,t){if(!Ed[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Ed[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function Oa(e){if(!Ed[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Ed[e].descriptor}function qt(e,t,r){r.key=e,Ed[e]={condition:t,descriptor:r}}var rr="none";function xMe(){return!0}qt(rr,xMe,{name:Jm,inputsCount:0,showOperators:!1});var Fc="empty";function DMe(e){return Xt(e.value)}qt(Fc,DMe,{name:hP,inputsCount:0,showOperators:!0});var $g="not_empty";function NMe(e,t){return!Mi(Fc,t)(e)}qt($g,NMe,{name:dP,inputsCount:0,showOperators:!0});function HMe(e,t){return BMe(e)||FMe(e,t)||jMe(e,t)||LMe()}function LMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jMe(e,t){if(e){if(typeof e=="string")return sN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sN(e,t)}}function sN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function BMe(e){if(Array.isArray(e))return e}var Bc="eq";function VMe(e,t){var r=HMe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale)===Dt(n)}qt(Bc,VMe,{name:vP,inputsCount:1,showOperators:!0});var Ag="neq";function WMe(e,t){return!Mi(Bc,t)(e)}qt(Ag,WMe,{name:yP,inputsCount:1,showOperators:!0});function UMe(e,t){return KMe(e)||GMe(e,t)||YMe(e,t)||zMe()}function zMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YMe(e,t){if(e){if(typeof e=="string")return uN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uN(e,t)}}function uN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function KMe(e){if(Array.isArray(e))return e}var vz="gt";function qMe(e,t){var r=UMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}qt(vz,qMe,{name:wP,inputsCount:1,showOperators:!0});function XMe(e,t){return exe(e)||JMe(e,t)||QMe(e,t)||ZMe()}function ZMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QMe(e,t){if(e){if(typeof e=="string")return fN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fN(e,t)}}function fN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function exe(e){if(Array.isArray(e))return e}var yz="gte";function txe(e,t){var r=XMe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}qt(yz,txe,{name:SP,inputsCount:1,showOperators:!0});function rxe(e,t){return axe(e)||ixe(e,t)||oxe(e,t)||nxe()}function nxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oxe(e,t){if(e){if(typeof e=="string")return cN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cN(e,t)}}function cN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ixe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function axe(e){if(Array.isArray(e))return e}var gz="lt";function lxe(e,t){var r=rxe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}qt(gz,lxe,{name:CP,inputsCount:1,showOperators:!0});function sxe(e,t){return hxe(e)||cxe(e,t)||fxe(e,t)||uxe()}function uxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fxe(e,t){if(e){if(typeof e=="string")return hN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hN(e,t)}}function hN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hxe(e){if(Array.isArray(e))return e}var pz="lte";function dxe(e,t){var r=sxe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}qt(pz,dxe,{name:_P,inputsCount:1,showOperators:!0});function vxe(e,t){return mxe(e)||pxe(e,t)||gxe(e,t)||yxe()}function yxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gxe(e,t){if(e){if(typeof e=="string")return dN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dN(e,t)}}function dN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function mxe(e){if(Array.isArray(e))return e}var ZP="date_after";function bxe(e,t){var r=vxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}qt(ZP,bxe,{name:EP,inputsCount:1,showOperators:!0});function wxe(e,t){return Oxe(e)||_xe(e,t)||Cxe(e,t)||Sxe()}function Sxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cxe(e,t){if(e){if(typeof e=="string")return vN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vN(e,t)}}function vN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _xe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Oxe(e){if(Array.isArray(e))return e}var QP="date_before";function Rxe(e,t){var r=wxe(t,1),n=r[0],o=ee(e.value,e.meta.dateFormat),i=ee(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}qt(QP,Rxe,{name:TP,inputsCount:1,showOperators:!0});function Exe(e,t){return $xe(e)||kxe(e,t)||Pxe(e,t)||Txe()}function Txe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pxe(e,t){if(e){if(typeof e=="string")return yN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yN(e,t)}}function yN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $xe(e){if(Array.isArray(e))return e}var qp="between";function Axe(e,t){var r=Exe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if(e.meta.type==="date"){var u=Mi(QP,[a]),f=Mi(ZP,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}qt(qp,Axe,{name:OP,inputsCount:2,showOperators:!0});var mz="not_between";function Ixe(e,t){return!Mi(qp,t)(e)}qt(mz,Ixe,{name:RP,inputsCount:2,showOperators:!0});function Mxe(e,t){return Hxe(e)||Nxe(e,t)||Dxe(e,t)||xxe()}function xxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dxe(e,t){if(e){if(typeof e=="string")return gN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gN(e,t)}}function gN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Hxe(e){if(Array.isArray(e))return e}var bz="begins_with";function Lxe(e,t){var r=Mxe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Dt(n))}qt(bz,Lxe,{name:gP,inputsCount:1,showOperators:!0});var jxe=$e,wz=hv,Fxe=zn.f,Bxe=ol,pN=Kt,Vxe=mE,Wxe=Ar,Uxe=bE,mN=wz("".endsWith),zxe=wz("".slice),Yxe=Math.min,Sz=Uxe("endsWith"),Gxe=!Sz&&!!function(){var e=Fxe(String.prototype,"endsWith");return e&&!e.writable}();jxe({target:"String",proto:!0,forced:!Gxe&&!Sz},{endsWith:function(t){var r=pN(Wxe(this));Vxe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:Yxe(Bxe(n),o),a=pN(t);return mN?mN(r,a,i):zxe(r,i-a.length,i)===a}});function Kxe(e,t){return Qxe(e)||Zxe(e,t)||Xxe(e,t)||qxe()}function qxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xxe(e,t){if(e){if(typeof e=="string")return bN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bN(e,t)}}function bN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Qxe(e){if(Array.isArray(e))return e}var Cz="ends_with";function Jxe(e,t){var r=Kxe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Dt(n))}qt(Cz,Jxe,{name:pP,inputsCount:1,showOperators:!0});function eDe(e,t){return oDe(e)||nDe(e,t)||rDe(e,t)||tDe()}function tDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rDe(e,t){if(e){if(typeof e=="string")return wN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wN(e,t)}}function wN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function oDe(e){if(Array.isArray(e))return e}var JP="contains";function iDe(e,t){var r=eDe(t,1),n=r[0];return Dt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Dt(n))>=0}qt(JP,iDe,{name:mP,inputsCount:1,showOperators:!0});var _z="not_contains";function aDe(e,t){return!Mi(JP,t)(e)}qt(_z,aDe,{name:bP,inputsCount:1,showOperators:!0});var Oz="date_tomorrow";function lDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}qt(Oz,lDe,{name:kP,inputsCount:0});var Rz="date_today";function sDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().startOf("day"),"d"):!1}qt(Rz,sDe,{name:PP,inputsCount:0});var Ez="date_yesterday";function uDe(e){var t=ee(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}qt(Ez,uDe,{name:$P,inputsCount:0});qV();function fDe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var QO=new Set([1]).has(1),cDe=QO&&typeof Array.from=="function";function Bv(e){var t=e;return QO&&(t=new Set(t)),function(r){var n;return QO?n=t.has(r):n=!!~t.indexOf(r),n}}function Tz(e){return e??""}function JO(e){var t=e;return cDe?t=Array.from(new Set(t)):t=SE(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function SN(e,t,r,n){var o=[],i=e===t,a;return i||(a=Bv(t)),A(e,function(l){var s=!1;(i||a(l))&&(s=!0);var u={checked:s,value:l,visualValue:fDe(l,r)};n&&n(u),o.push(u)}),o}function Pz(e,t){return yDe(e)||vDe(e,t)||dDe(e,t)||hDe()}function hDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dDe(e,t){if(e){if(typeof e=="string")return CN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CN(e,t)}}function CN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yDe(e){if(Array.isArray(e))return e}var Ra="by_value";function gDe(e,t){var r=Pz(t,1),n=r[0];return n(e.value)}qt(Ra,gDe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=Pz(t,1),n=r[0];return[Bv(n)]},showOperators:!1});var Td={};function pDe(e){if(!Td[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Td[e].func;return function(r,n){return t(r,n)}}function mDe(e){return Td[e].name}function ek(e,t,r){Td[e]={name:t,func:r}}var Ci="conjunction",bDe=MP;function wDe(e,t){return e.every(function(r){return r.func(t)})}ek(Ci,bDe,wDe);var Xp="disjunction",SDe=eb;function CDe(e,t){return e.some(function(r){return r.func(t)})}ek(Xp,SDe,CDe);var tk="disjunctionWithExtraCondition",_De=eb;function ODe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}ek(tk,_De,ODe);function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}var fc;function wS(e,t,r){return t=RDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RDe(e){var t=EDe(e,"string");return Pd(t)==="symbol"?t:String(t)}function EDe(e,t){if(Pd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TDe="numeric",kz="text",PDe="date",_N=(fc={},wS(fc,TDe,[rr,qe,Fc,$g,qe,Bc,Ag,qe,vz,yz,gz,pz,qp,mz]),wS(fc,kz,[rr,qe,Fc,$g,qe,Bc,Ag,qe,bz,Cz,qe,JP,_z]),wS(fc,PDe,[rr,qe,Fc,$g,qe,Bc,Ag,qe,QP,ZP,qp,qe,Oz,Rz,Ez]),fc);function kDe(e){var t=[],r=e;return _N[r]||(r=kz),A(_N[r],function(n){var o;n===qe?o={name:qe}:o=Sr(Oa(n)),t.push(o)}),t}function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function $De(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ON(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IDe(n.key),n)}}function ADe(e,t,r){return t&&ON(e.prototype,t),r&&ON(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IDe(e){var t=MDe(e,"string");return kd(t)==="symbol"?t:String(t)}function MDe(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SS="built",CS="building",RN=["click","input","keydown","keypress","keyup","focus","blur","change"],$z=function(){function e(t,r){$De(this,e),this.hot=t,this.eventManager=new kt(this),this.options=zt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return ADe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===CS?this._element:this.buildState===SS?(this.update(),this._element):(this.buildState=CS,this.build(),this.buildState=SS,this._element)}},{key:"isBuilt",value:function(){return this.buildState===SS}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Or)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,l){r.eventManager.addEventListener(a,l,function(s){return r.runLocalHooks(l,s,r)})};if(this.buildState||(this.buildState=CS),this.options.className&&te(this._element,this.options.className),this.options.children.length)A(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);ze(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),A(RN,function(i){return n(o,i)})}else A(RN,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Sr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();gt($z,Mr);const _i=$z;function Au(e){"@babel/helpers - typeof";return Au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(e)}function xDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NDe(n.key),n)}}function DDe(e,t,r){return t&&EN(e.prototype,t),r&&EN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NDe(e){var t=HDe(e,"string");return Au(t)==="symbol"?t:String(t)}function HDe(e,t){if(Au(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ig(){return typeof Reflect<"u"&&Reflect.get?Ig=Reflect.get.bind():Ig=function(t,r,n){var o=LDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ig.apply(this,arguments)}function LDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Iu(e),e!==null););return e}function jDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eR(e,t)}function eR(e,t){return eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eR(e,t)}function FDe(e){var t=VDe();return function(){var n=Iu(e),o;if(t){var i=Iu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BDe(this,o)}}function BDe(e,t){if(t&&(Au(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Az(e)}function Az(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(e){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iu(e)}var Ny=new WeakMap,WDe=function(e){jDe(r,e);var t=FDe(r);function r(n,o){var i;return xDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Ny.set(Az(i),{}),i.registerHooks(),i}return DDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){Ig(Iu(r.prototype),"build",this).call(this);var o=Ny.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,te(this._element,"htUIInput"),te(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Ny.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&Ny.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return Sr({placeholder:"",type:"text",tagName:"input"})}}]),r}(_i);const ls=WDe;function Mu(e){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function UDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YDe(n.key),n)}}function zDe(e,t,r){return t&&TN(e.prototype,t),r&&TN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YDe(e){var t=GDe(e,"string");return Mu(t)==="symbol"?t:String(t)}function GDe(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ss(){return typeof Reflect<"u"&&Reflect.get?ss=Reflect.get.bind():ss=function(t,r,n){var o=KDe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ss.apply(this,arguments)}function KDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oi(e),e!==null););return e}function qDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tR(e,t)}function XDe(e){var t=QDe();return function(){var n=Oi(e),o;if(t){var i=Oi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ZDe(this,o)}}function ZDe(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iz(e)}function Iz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oi(e){return Oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oi(e)}var Hy=new WeakMap,JDe=function(e){qDe(r,e);var t=XDe(r);function r(n,o){var i;return UDe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Hy.set(Iz(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return zDe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return A(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;ss(Oi(r.prototype),"build",this).call(this),this.menu=new qP(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new _i(this.hot,{className:"htUISelectCaption"}),a=new _i(this.hot,{className:"htUISelectDropdown"}),l=Hy.get(this);l.caption=i,l.captionElement=i.element,l.dropdown=a,A([i,a],function(s){return o._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return o.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(Jm),Hy.get(this).captionElement.textContent=o,ss(Oi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?o.left-5:o.left-31,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==qe&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=Hy.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),ss(Oi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUISelect",wrapIt:!1})}}]),r}(_i);const PN=JDe;function xu(e){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xu(e)}function eNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rNe(n.key),n)}}function tNe(e,t,r){return t&&kN(e.prototype,t),r&&kN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rNe(e){var t=nNe(e,"string");return xu(t)==="symbol"?t:String(t)}function nNe(e,t){if(xu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mg(){return typeof Reflect<"u"&&Reflect.get?Mg=Reflect.get.bind():Mg=function(t,r,n){var o=oNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Mg.apply(this,arguments)}function oNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Du(e),e!==null););return e}function iNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rR(e,t)}function aNe(e){var t=uNe();return function(){var n=Du(e),o;if(t){var i=Du(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lNe(this,o)}}function lNe(e,t){if(t&&(xu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sNe(e)}function sNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(e){return Du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Du(e)}var fNe=function(e){iNe(r,e);var t=aNe(r);function r(n,o){var i;return eNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new PN(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new ls(i.hot,{placeholder:jP})),i.elements.push(new ls(i.hot,{placeholder:FP})),i.registerHooks(),i}return tNe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),A(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=Sr(o.command);a.name.startsWith(Ht)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),A(o.args,function(l,s){if(s>a.inputsCount-1)return!1;var u=i.getInputElement(s);u.setValue(l),u[a.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||Oa(rr),i=[];return A(this.getInputElements(),function(a,l){o.inputsCount>l&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=Oa(o?o.name:rr);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||A(this.getInputElements(),function(l){return l.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof PN})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof ls})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuCondition"),o.addSeparator&&te(l.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=[Oa(rr)];if(o!==null){var a=o.visualIndex;i=kDe(this.hot.getDataType(0,a,this.hot.countRows(),a))}A(this.getInputElements(),function(l){return l.hide()}),this.getSelectElement().setItems(i),Mg(Du(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(i[0])}},{key:"onConditionSelect",value:function(o){A(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){ms(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),wn(o)):ms(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wn(o))}}]),r}(yb);const _S=fNe;function Nu(e){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(e)}function cNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dNe(n.key),n)}}function hNe(e,t,r){return t&&$N(e.prototype,t),r&&$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dNe(e){var t=vNe(e,"string");return Nu(t)==="symbol"?t:String(t)}function vNe(e,t){if(Nu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xg(){return typeof Reflect<"u"&&Reflect.get?xg=Reflect.get.bind():xg=function(t,r,n){var o=yNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xg.apply(this,arguments)}function yNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hu(e),e!==null););return e}function gNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nR(e,t)}function pNe(e){var t=bNe();return function(){var n=Hu(e),o;if(t){var i=Hu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mNe(this,o)}}function mNe(e,t){if(t&&(Nu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mz(e)}function Mz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hu(e){return Hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hu(e)}var Ly=new WeakMap,wNe=function(e){gNe(r,e);var t=pNe(r);function r(n,o){var i;return cNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),Ly.set(Mz(i),{}),i}return hNe(r,[{key:"build",value:function(){xg(Hu(r.prototype),"build",this).call(this);var o=Ly.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var o=Ly.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Ly.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Sr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(_i);const AN=wNe;function Lu(e){"@babel/helpers - typeof";return Lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lu(e)}var IN;function SNe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function CNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ONe(n.key),n)}}function _Ne(e,t,r){return t&&MN(e.prototype,t),r&&MN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ONe(e){var t=RNe(e,"string");return Lu(t)==="symbol"?t:String(t)}function RNe(e,t){if(Lu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ENe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oR(e,t)}function TNe(e){var t=$Ne();return function(){var n=Zp(e),o;if(t){var i=Zp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return PNe(this,o)}}function PNe(e,t){if(t&&(Lu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kNe(e)}function kNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zp(e){return Zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zp(e)}var xN=0,ANe=function(e){ENe(r,e);var t=TNe(r);function r(n,o){var i;return CNe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return _Ne(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuOperators"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[Ci,Xp];A(i,function(a){var l=new AN(o.hot,{name:"operator",label:{htmlFor:a,textContent:mDe(a)},value:a,checked:a===i[xN],id:a});l.addLocalHook("change",function(s){return o.onRadioInputChange(s)}),o.elements.push(l)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(dt(IN||(IN=SNe(["Radio button with index "," doesn't exist."])),o));A(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof AN&&i.isChecked()});return o?o.getValue():Ci}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&A(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ci,i=arguments.length>1?arguments[1]:void 0,a=o;a===tk&&(a=Xp),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(xN)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(yb);const INe=ANe;var MNe=Ye,xNe=Ar,DN=Kt,DNe=/"/g,NNe=MNe("".replace),HNe=function(e,t,r,n){var o=DN(xNe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+NNe(DN(n),DNe,"&quot;")+'"'),i+">"+o+"</"+t+">"},LNe=je,jNe=function(e){return LNe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},FNe=$e,BNe=HNe,VNe=jNe;FNe({target:"String",proto:!0,forced:VNe("link")},{link:function(t){return BNe(this,"a","href",t)}});function ju(e){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(e)}function WNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zNe(n.key),n)}}function UNe(e,t,r){return t&&NN(e.prototype,t),r&&NN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zNe(e){var t=YNe(e,"string");return ju(t)==="symbol"?t:String(t)}function YNe(e,t){if(ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dg(){return typeof Reflect<"u"&&Reflect.get?Dg=Reflect.get.bind():Dg=function(t,r,n){var o=GNe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Dg.apply(this,arguments)}function GNe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fu(e),e!==null););return e}function KNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iR(e,t)}function iR(e,t){return iR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iR(e,t)}function qNe(e){var t=ZNe();return function(){var n=Fu(e),o;if(t){var i=Fu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return XNe(this,o)}}function XNe(e,t){if(t&&(ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xz(e)}function xz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fu(e){return Fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fu(e)}var OS=new WeakMap,QNe=function(e){KNe(r,e);var t=qNe(r);function r(n,o){var i;return WNe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),OS.set(xz(i),{}),i}return UNe(r,[{key:"build",value:function(){Dg(Fu(r.prototype),"build",this).call(this);var o=OS.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(OS.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Sr({href:"#",tagName:"a"})}}]),r}(_i);const HN=QNe;function Bu(e){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}function LN(e){return rHe(e)||tHe(e)||eHe(e)||JNe()}function JNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eHe(e,t){if(e){if(typeof e=="string")return aR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aR(e,t)}}function tHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rHe(e){if(Array.isArray(e))return aR(e)}function aR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iHe(n.key),n)}}function oHe(e,t,r){return t&&jN(e.prototype,t),r&&jN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iHe(e){var t=aHe(e,"string");return Bu(t)==="symbol"?t:String(t)}function aHe(e,t){if(Bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function us(){return typeof Reflect<"u"&&Reflect.get?us=Reflect.get.bind():us=function(t,r,n){var o=lHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},us.apply(this,arguments)}function lHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ri(e),e!==null););return e}function sHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lR(e,t)}function uHe(e){var t=cHe();return function(){var n=Ri(e),o;if(t){var i=Ri(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fHe(this,o)}}function fHe(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dz(e)}function Dz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ri(e){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ri(e)}var hHe=new WeakMap,dHe="multipleSelect.itemBox",vHe=function(e){sHe(r,e);var t=uHe(r);function r(n,o){var i;return nHe(this,r),i=t.call(this,n,zt(r.DEFAULTS,o)),hHe.set(Dz(i),{}),i.searchInput=new ls(i.hot,{placeholder:LP,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new HN(i.hot,{textContent:xP,className:"htUISelectAll"}),i.clearAllUI=new HN(i.hot,{textContent:DP,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return oHe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return LN(this.items)}},{key:"getValue",value:function(){return gHe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;us(Ri(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),l=new _i(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(l.element),this._element.appendChild(a);var s=function(f){if(o._element){o.itemsBox&&o.itemsBox.destroy(),te(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,y,m,w,S,C){v.title=C.instance.getDataAtRowProp(y,C.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-Jt(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:o.hot.isRtl()?"rtl":"ltr"}),o.itemsBox.init();var c=o.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){o.runLocalHooks("keydown",v,o)},group:dHe})}};s(a),setTimeout(function(){return s(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(yHe(this.items,this.options.value)),us(Ri(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,us(Ri(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),l;a===""?l=LN(this.items):l=Wr(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(l)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=LE(ms,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(wn(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!0,i.push(AO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),A(this.itemsBox.getSourceData(),function(a,l){a.checked=!1,i.push(AO(a,l)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return Sr({className:"htUIMultipleSelect",value:[]})}}]),r}(_i);const FN=vHe;function yHe(e,t){var r=Bv(t);return We(e,function(n){return n.checked=r(n.value),n})}function gHe(e){var t=[];return A(e,function(r){r.checked&&t.push(r.value)}),t}function Vu(e){"@babel/helpers - typeof";return Vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vu(e)}function pHe(e,t){return SHe(e)||wHe(e,t)||bHe(e,t)||mHe()}function mHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bHe(e,t){if(e){if(typeof e=="string")return BN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BN(e,t)}}function BN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SHe(e){if(Array.isArray(e))return e}function CHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OHe(n.key),n)}}function _He(e,t,r){return t&&VN(e.prototype,t),r&&VN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OHe(e){var t=RHe(e,"string");return Vu(t)==="symbol"?t:String(t)}function RHe(e,t){if(Vu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ng(){return typeof Reflect<"u"&&Reflect.get?Ng=Reflect.get.bind():Ng=function(t,r,n){var o=EHe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ng.apply(this,arguments)}function EHe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wu(e),e!==null););return e}function THe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sR(e,t)}function sR(e,t){return sR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sR(e,t)}function PHe(e){var t=AHe();return function(){var n=Wu(e),o;if(t){var i=Wu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kHe(this,o)}}function kHe(e,t){if(t&&(Vu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $He(e)}function $He(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wu(e){return Wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wu(e)}var IHe=function(e){THe(r,e);var t=PHe(r);function r(n,o){var i;return CHe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new FN(i.hot)),i.registerHooks(),i}return _He(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===Ra){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?rr:Ra},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(s,u,f,c,h){var d=Wr(u,function(N){return N.name===Ra}),v=pHe(d,1),y=v[0],m={},w=i.hot.getTranslatedPhrase(Wp);if(y){var S=JO(We(c(s,h),function(N){return N.value}));f&&(y.args[0]=f);var C=[],k=SN(S,y.args[0],w,function(N){N.checked&&C.push(N.value)}),_=o.editedConditionStack.column;m.locale=i.hot.getCellMeta(0,_).locale,m.args=[C],m.command=Oa(Ra),m.itemsSnapshot=k}else m.args=[],m.command=Oa(rr);i.state.setValueAtIndex(s,m)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof FN})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l,s,u,f,c){te(l.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return te(h,"htFiltersMenuLabel"),h.textContent=c,l.appendChild(h),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(d){return l.appendChild(d.element)}),l}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(Wp),i=JO(this._getColumnVisibleValues()),a=SN(i,i,o);this.getMultipleSelectElement().setItems(a),Ng(Wu(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}},{key:"onInputKeyDown",value:function(o){ms(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wn(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn();return o===null?[]:We(this.hot.getDataAtCol(o.visualIndex),function(i){return Tz(i)})}}]),r}(yb);const MHe=IHe;function Uu(e){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(e)}function xHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NHe(n.key),n)}}function DHe(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NHe(e){var t=HHe(e,"string");return Uu(t)==="symbol"?t:String(t)}function HHe(e,t){if(Uu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},uR(e,t)}function jHe(e){var t=VHe();return function(){var n=Qp(e),o;if(t){var i=Qp(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FHe(this,o)}}function FHe(e,t){if(t&&(Uu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BHe(e)}function BHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qp(e)}var WHe=function(e){LHe(r,e);var t=jHe(r);function r(n,o){var i;return xHe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new ls(i.hot,{type:"button",value:NP,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new ls(i.hot,{type:"button",value:HP,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return DHe(r,[{key:"registerHooks",value:function(){var o=this;A(this.elements,function(i){i.addLocalHook("click",function(a,l){return o.onButtonClick(a,l)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,l){return te(l.parentNode,"htFiltersMenuActionBar"),l.parentNode.hasAttribute("ghost-table")||A(o.elements,function(s){return l.appendChild(s.element)}),l}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(yb);const UHe=WHe;function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}var UN,zN;function YN(e,t){return KHe(e)||GHe(e,t)||YHe(e,t)||zHe()}function zHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YHe(e,t){if(e){if(typeof e=="string")return GN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GN(e,t)}}function GN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function KHe(e){if(Array.isArray(e))return e}function KN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function qHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZHe(n.key),n)}}function XHe(e,t,r){return t&&qN(e.prototype,t),r&&qN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZHe(e){var t=QHe(e,"string");return $d(t)==="symbol"?t:String(t)}function QHe(e,t){if($d(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XN="ConditionCollection.filteringStates",Nz=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;qHe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Zm,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(XN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return XHe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],l=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,l)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ci;return r.length?pDe(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ci,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,l=We(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),s=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(dt(UN||(UN=KN(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(bt(Td[o]))throw new Error(dt(zN||(zN=KN(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:s,args:l,func:Mi(s,l)}]},i):f.push({name:s,args:l,func:Mi(s,l)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=YN(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Ft(this.filteringStates.getEntries(),function(r,n){var o=YN(n,2),i=o[0],a=o[1],l=a.operation,s=a.conditions;return r.push({column:i,operation:l,conditions:We(s,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),A(r,function(o){A(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(XN),this.filteringStates=null,this.clearLocalHooks()}}]),e}();gt(Nz,Mr);const Hz=Nz;function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function JHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tLe(n.key),n)}}function eLe(e,t,r){return t&&ZN(e.prototype,t),r&&ZN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tLe(e){var t=rLe(e,"string");return Ad(t)==="symbol"?t:String(t)}function rLe(e,t){if(Ad(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nLe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};JHe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return eLe(e,[{key:"filter",value:function(){var r=this,n=[];return A(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return A(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return A(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}();const Lz=nLe;function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function oLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aLe(n.key),n)}}function iLe(e,t,r){return t&&QN(e.prototype,t),r&&QN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aLe(e){var t=lLe(e,"string");return Id(t)==="symbol"?t:String(t)}function lLe(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jz=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};oLe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return iLe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,A(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var l=i.slice(0,a),s=i.slice(a);s.length&&s[0].column===r&&s.shift();var u=vW(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new Hz(o.hot,!1),y=[].concat(c,d);v.importAllConditions(y);var m=o.columnDataFactory(h),w;v.isEmpty()?w=m:w=new Lz(v,function(C){return o.columnDataFactory(C)}).filter(),w=We(w,function(C){return C.meta.visualRow});var S=Bv(w);return v.destroy(),Wr(m,function(C){return S(C.meta.visualRow)})})(l),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:s,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;A(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),ze(this,function(n,o){r[o]=null})}}]),e}();gt(jz,Mr);const sLe=jz;function zu(e){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}var JN;function uLe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function fLe(e,t){return vLe(e)||dLe(e,t)||hLe(e,t)||cLe()}function cLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hLe(e,t){if(e){if(typeof e=="string")return eH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eH(e,t)}}function eH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function vLe(e){if(Array.isArray(e))return e}function yLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pLe(n.key),n)}}function gLe(e,t,r){return t&&tH(e.prototype,t),r&&tH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pLe(e){var t=mLe(e,"string");return zu(t)==="symbol"?t:String(t)}function mLe(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fs(){return typeof Reflect<"u"&&Reflect.get?fs=Reflect.get.bind():fs=function(t,r,n){var o=bLe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fs.apply(this,arguments)}function bLe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ei(e),e!==null););return e}function wLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fR(e,t)}function fR(e,t){return fR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},fR(e,t)}function SLe(e){var t=_Le();return function(){var n=Ei(e),o;if(t){var i=Ei(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CLe(this,o)}}function CLe(e,t){if(t&&(zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fz(e)}function Fz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _Le(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ei(e)}var rH="filters",OLe=250,RLe=function(e){wLe(r,e);var t=SLe(r);function r(n){var o;return yLe(this,r),o=t.call(this,n),o.eventManager=new kt(Fz(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return gLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[rH]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Dv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,l=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},s=function(){return"".concat(o.hot.getTranslatedPhrase(AP),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(IP),":")};if(!this.components.get("filter_by_condition")){var f=new _S(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",l(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new INe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new _S(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",l(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",l(new MHe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",l(new UHe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Hz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new sLe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),fs(Ei(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,l){a.destroy(),o.components.set(l,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}fs(Ei(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ci,s=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(s,{command:{key:i},args:a},l)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),l=[],s=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",s);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),l=We(i.filter(),function(h){return h.meta.visualRow});var c=Bv(l);Ce(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),A(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),l.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;return i?{visualIndex:i.col,physicalIndex:this.hot.toPhysicalColumn(i.col)}:null}},{key:"clearColumnSelection",value:function(){var o=this.getSelectedColumn();o!==null&&this.hot.selectCell(0,o.visualIndex)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),l=[];return A(this.hot.getSourceDataAtCol(a),function(s,u){var f,c=i.hot.getCellMeta(u,a),h=c.row,d=c.col,v=c.visualCol,y=c.visualRow,m=c.type,w=c.instance,S=c.dateFormat,C=c.locale,k=(f=i.hot.getDataAtCell(i.hot.toVisualRow(u),a))!==null&&f!==void 0?f:s;l.push({meta:{row:h,col:d,visualCol:v,visualRow:y,type:m,instance:w,dateFormat:S,locale:C},value:Tz(k)})}),l}},{key:"onAfterChange",value:function(o){var i=this;o&&A(o,function(a){var l=fLe(a,2),s=l[1],u=i.hot.propToCol(s);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=JO(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(l){l.isHidden()||l.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:qe}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,l){var s=o;return s===Xp&&i.command.key!==rr&&a.command.key!==rr&&l.command.key!==rr?s=tk:l.command.key!==rr&&(i.command.key===rr||a.command.key===rr)&&(s=Ci),s}},{key:"onActionBarSubmit",value:function(o){var i;if(o==="accept"){var a=this.getSelectedColumn();if(a===null){var l;(l=this.dropdownMenuPlugin)===null||l===void 0||l.close();return}var s=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),u.command.key!==rr&&(this.conditionCollection.addCondition(s,u,h,d),f.command.key!==rr&&this.conditionCollection.addCondition(s,f,h,d)),c.command.key!==rr&&this.conditionCollection.addCondition(s,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(i=this.dropdownMenuPlugin)===null||i===void 0||i.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===_S&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,l=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,l):this.hideComponents.apply(this,l)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?te(i,"htFiltersActive"):Le(i,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Lz(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled){var a=o.editedConditionStack,l=a.conditions,s=a.column,u=l.filter(function(h){return h.name===Ra}),f=l.filter(function(h){return h.name!==Ra});if(u.length>=2||f.length>=3)wt(dt(JN||(JN=uLe([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(f[0],s),this.components.get("filter_by_condition2").updateState(f[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return A(l,function(u){A(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,l=a.getPlugin("hiddenRows"),s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?l.showRows(c):l.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),fs(Ei(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rH}},{key:"PLUGIN_PRIORITY",get:function(){return OLe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(ot);function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function nH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Vc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nH(Object(r),!0).forEach(function(n){ELe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ELe(e,t,r){return t=TLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TLe(e){var t=PLe(e,"string");return Md(t)==="symbol"?t:String(t)}function PLe(e,t){if(Md(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bz="internal-use-in-handsontable",cR={licenseKey:Bz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Vz(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[ar])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Wz(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function kLe(e){var t,r=e[ar],n=Wz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=Vz(e);return Vc(Vc(Vc({},cR),n),o)}function $Le(e){var t,r=e[ar],n=Wz(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=Vz(e);return Vc(Vc({},n),o)}function ALe(e,t){return Object.keys(t).some(function(r){return t[r]!==void 0&&t[r]!==e[r]})}var oH;function ILe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hR(e){"@babel/helpers - typeof";return hR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hR(e)}function gb(){var e="engine_relationship",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function rk(){var e="shared_engine_usage",t=on(ar);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function MLe(e){var t=e.getSettings(),r=t[ar],n=r==null?void 0:r.engine;if(r===!0||bt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return xLe((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(hR(n)==="object"&&bt(n.hyperformula)){var i=gb(),a=rk().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Bz}),(n.getConfig().leapYear1900!==cR.leapYear1900||Fm(n.getConfig().nullDate,cR.nullDate)===!1)&&wt(dt(oH||(oH=ILe(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function xLe(e,t,r){var n=t[ar],o=kLe(t),i=gb(),a=rk();DLe(e,n.functions),NLe(e,n.language);var l=e.buildEmpty(o);return i.set(l,[r]),a.set(l,[r.guid]),HLe(l,n.namedExpressions),l.on("sheetAdded",function(){l.rebuildAndRecalculate()}),l.on("sheetRemoved",function(){l.rebuildAndRecalculate()}),l}function iH(e){var t,r=gb(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function aH(e,t){if(e){var r=gb(),n=r.get(e),o=rk(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function DLe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){wt(a.message)}})}function NLe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){wt(n.message)}}}function HLe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(l){wt(l.message)}}),e.resumeEvaluation())}function LLe(e,t){return(bt(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var Uz="DD/MM/YYYY";function zz(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function jLe(e){return zz(e)?e.substr(1):e}function FLe(e){return typeof e=="string"&&e.startsWith("=")}function RS(e,t){return typeof e=="string"&&t==="date"}function lH(e,t){return ee(e,t,!0).isValid()}function sH(e,t){return ee(e,t,!0).format(Uz)}function BLe(e,t){return ee(e,Uz,!0).format(t)}function uH(e,t){var r=-1,n=new Date(Date.UTC(0,0,e+r));return ee(n).format(t)}function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function VLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ULe(n.key),n)}}function WLe(e,t,r){return t&&fH(e.prototype,t),r&&fH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ULe(e){var t=zLe(e,"string");return xd(t)==="symbol"?t:String(t)}function zLe(e,t){if(xd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qi(e,t,r){YLe(e,t),t.set(e,r)}function YLe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _t(e,t){var r=Yz(e,t,"get");return GLe(e,r)}function GLe(e,t){return t.get?t.get.call(e):t.value}function ti(e,t,r){var n=Yz(e,t,"set");return KLe(e,n,r),r}function Yz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function KLe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var cc=new WeakMap,ri=new WeakMap,Nr=new WeakMap,jy=new WeakMap,ES=new WeakMap,TS=new WeakMap,Fy=new WeakMap,qLe=function(){function e(t,r,n){VLe(this,e),Qi(this,cc,{writable:!0,value:void 0}),Qi(this,ri,{writable:!0,value:void 0}),Qi(this,Nr,{writable:!0,value:void 0}),Qi(this,jy,{writable:!0,value:[]}),Qi(this,ES,{writable:!0,value:[]}),Qi(this,TS,{writable:!0,value:void 0}),Qi(this,Fy,{writable:!0,value:[]}),ti(this,cc,t),ti(this,ri,r),ti(this,Nr,n)}return WLe(e,[{key:"setRemovedHfIndexes",value:function(r){var n=this;return ti(this,Fy,r.map(function(o){var i=_t(n,ri).getVisualFromPhysicalIndex(o);return n.getHfIndexFromVisualIndex(i)})),_t(this,Fy)}},{key:"getRemovedHfIndexes",value:function(){return _t(this,Fy)}},{key:"getHfIndexFromVisualIndex",value:function(r){var n=_t(this,ri).getIndexesSequence(),o=_t(this,ri).getNotTrimmedIndexes();return n.indexOf(o[r])}},{key:"syncMoves",value:function(r){var n=this,o=1,i="move".concat(ur(_t(this,cc)),"s");_t(this,Nr).getEngine().batch(function(){r.forEach(function(a){var l=a.from!==a.to,s=a.from+1!==a.to;l&&s&&_t(n,Nr).getEngine()[i](_t(n,Nr).getSheetId(),a.from,o,a.to)})})}},{key:"storeMovesInformation",value:function(r,n,o){var i=this;o!==!1&&(ti(this,ES,r.map(function(a){return i.getHfIndexFromVisualIndex(a)})),ti(this,TS,this.getHfIndexFromVisualIndex(n)))}},{key:"getMoveLine",value:function(r,n){var o=_t(this,ri).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(function(l){return r.includes(l)===!1});if(n===0){var a;return(a=i[n])!==null&&a!==void 0?a:0}return i[n-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(r,n){var o=this.getMoveLine(r,n),i=[];return r.forEach(function(a){var l={from:a,to:o};i.forEach(function(s){var u=s.from>s.to,f=s.to<=l.from,c=s.from>l.from;c&&f&&u&&(l.from+=1)}),l.from>=o&&(o+=1),i.push(l)}),i}},{key:"adjustedCalculatedMoves",value:function(r){return r.forEach(function(n,o){var i=r.slice(o+1);i.forEach(function(a){var l=a.from<a.to;a.from>n.from&&l&&(a.from-=1)})}),r}},{key:"calculateAndSyncMoves",value:function(r,n){var o=this;if(!_t(this,Nr).isPerformingUndoRedo()&&!(r===!1||n===!1)){var i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(_t(this,ES),_t(this,TS)));_t(this,Nr).getSheetId()===null?_t(this,Nr).getPostponeAction(function(){return o.syncMoves(i)}):this.syncMoves(i)}}},{key:"getIndexesChangeSyncMethod",value:function(){var r=this,n="set".concat(ur(_t(this,cc)),"Order");return function(o){if(!_t(r,Nr).isPerformingUndoRedo()){var i=_t(r,ri).getIndexesSequence();if(o==="update"){var a=_t(r,jy).map(function(c){return i.indexOf(c)}),l=_t(r,Nr).getEngine().getSheetDimensions(_t(r,Nr).getSheetId()),s;_t(r,cc)==="row"?s=l.height:s=l.width;for(var u=a.length,f=u;f<s;f+=1)a.push(f);_t(r,Nr).getEngine()[n](_t(r,Nr).getSheetId(),a)}ti(r,jy,i)}}}},{key:"init",value:function(){ti(this,jy,_t(this,ri).getIndexesSequence())}}]),e}();const cH=qLe;function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function XLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QLe(n.key),n)}}function ZLe(e,t,r){return t&&hH(e.prototype,t),r&&hH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QLe(e){var t=JLe(e,"string");return Dd(t)==="symbol"?t:String(t)}function JLe(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ji(e,t,r){eje(e,t),t.set(e,r)}function eje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eo(e,t){var r=Gz(e,t,"get");return tje(e,r)}function tje(e,t){return t.get?t.get.call(e):t.value}function ea(e,t,r){var n=Gz(e,t,"set");return rje(e,n,r),r}function Gz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function rje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var By=new WeakMap,Vy=new WeakMap,PS=new WeakMap,kS=new WeakMap,$S=new WeakMap,AS=new WeakMap,IS=new WeakMap,nje=function(){function e(t,r,n){XLe(this,e),Ji(this,By,{writable:!0,value:void 0}),Ji(this,Vy,{writable:!0,value:void 0}),Ji(this,PS,{writable:!0,value:void 0}),Ji(this,kS,{writable:!0,value:!1}),Ji(this,$S,{writable:!0,value:!1}),Ji(this,AS,{writable:!0,value:null}),Ji(this,IS,{writable:!0,value:null}),ea(this,By,new cH("row",t,this)),ea(this,Vy,new cH("column",r,this)),ea(this,PS,n)}return ZLe(e,[{key:"getForAxis",value:function(r){return r==="row"?eo(this,By):eo(this,Vy)}},{key:"setPerformUndo",value:function(r){ea(this,kS,r)}},{key:"setPerformRedo",value:function(r){ea(this,$S,r)}},{key:"isPerformingUndoRedo",value:function(){return eo(this,kS)||eo(this,$S)}},{key:"getSheetId",value:function(){return eo(this,IS)}},{key:"getEngine",value:function(){return eo(this,AS)}},{key:"getPostponeAction",value:function(){return eo(this,PS)}},{key:"setupSyncEndpoint",value:function(r,n){ea(this,AS,r),ea(this,IS,n),eo(this,By).init(),eo(this,Vy).init()}}]),e}();const oje=nje;function ije(e){return sje(e)||lje(e)||Kz(e)||aje()}function aje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sje(e){if(Array.isArray(e))return dR(e)}function xi(e){"@babel/helpers - typeof";return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(e)}function Nl(e,t){return cje(e)||fje(e,t)||Kz(e,t)||uje()}function uje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kz(e,t){if(e){if(typeof e=="string")return dR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dR(e,t)}}function dR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cje(e){if(Array.isArray(e))return e}function hje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qz(n.key),n)}}function dje(e,t,r){return t&&dH(e.prototype,t),r&&dH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ea(){return typeof Reflect<"u"&&Reflect.get?Ea=Reflect.get.bind():Ea=function(t,r,n){var o=vje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ea.apply(this,arguments)}function vje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function yje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vR(e,t)}function vR(e,t){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vR(e,t)}function gje(e){var t=mje();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pje(this,o)}}function pje(e,t){if(t&&(xi(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nn(e)}function Nn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}function Hl(e,t,r){return t=qz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qz(e){var t=bje(e,"string");return xi(t)==="symbol"?t:String(t)}function bje(e,t){if(xi(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MS(e,t,r){wje(e,t),t.set(e,r)}function wje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ni(e,t,r){var n=Xz(e,t,"set");return Sje(e,n,r),r}function Sje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ll(e,t){var r=Xz(e,t,"get");return Cje(e,r)}function Xz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Cje(e,t){return t.get?t.get.call(e):t.value}var ar="formulas",_je=["maxRows","maxColumns","language"],Oje=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");var jl=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},to=new WeakMap,xS=new WeakMap,hc=new WeakMap,Rje=function(e){yje(r,e);var t=gje(r);function r(){var n;hje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),MS(Nn(n),to,{writable:!0,value:!1}),MS(Nn(n),xS,{writable:!0,value:!1}),MS(Nn(n),hc,{writable:!0,value:[["valuesUpdated",function(){var l;return(l=n).onEngineValuesUpdated.apply(l,arguments)}],["namedExpressionAdded",function(){var l;return(l=n).onEngineNamedExpressionsAdded.apply(l,arguments)}],["namedExpressionRemoved",function(){var l;return(l=n).onEngineNamedExpressionsRemoved.apply(l,arguments)}],["sheetAdded",function(){var l;return(l=n).onEngineSheetAdded.apply(l,arguments)}],["sheetRenamed",function(){var l;return(l=n).onEngineSheetRenamed.apply(l,arguments)}],["sheetRemoved",function(){var l;return(l=n).onEngineSheetRemoved.apply(l,arguments)}]]}),Hl(Nn(n),"staticRegister",on("formulas")),Hl(Nn(n),"engine",null),Hl(Nn(n),"sheetName",null),Hl(Nn(n),"indexSyncer",null),Hl(Nn(n),"rowAxisSyncer",null),Hl(Nn(n),"columnAxisSyncer",null),n}return dje(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ar]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=MLe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){wt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeUpdateData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterUpdateData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.indexSyncer=new oje(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(l){i.hot.addHookOnce("init",function(){l()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(l,s,u,f){i.rowAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("beforeColumnMove",function(l,s,u,f){i.columnAxisSyncer.storeMovesInformation(l,s,f)}),this.hot.addHook("afterRowMove",function(l,s,u,f,c){i.rowAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("afterColumnMove",function(l,s,u,f,c){i.columnAxisSyncer.calculateAndSyncMoves(f,c)}),this.hot.addHook("beforeColumnFreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(l,s){i.columnAxisSyncer.storeMovesInformation([l],i.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(l,s){i.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return i.onAfterCellMetaReset.apply(i,arguments)}),this.addHook("beforeUndo",function(){i.indexSyncer.setPerformUndo(!0),i.engine.undo()}),this.addHook("beforeRedo",function(){i.indexSyncer.setPerformRedo(!0),i.engine.redo()}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){i.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),Ll(this,hc).forEach(function(l){var s=Nl(l,2),u=s[0],f=s[1];return i.engine.on(u,f)}),Ea(Eo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;Ll(this,hc).forEach(function(i){var a=Nl(i,2),l=a[0],s=a[1];return o.engine.off(l,s)}),aH(this.engine,this.hot),this.engine=null,Ea(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){var i=$Le(this.hot.getSettings());ALe(this.engine.getConfig(),i)&&this.engine.updateConfig(i);var a=this.hot.getSettings()[ar];if(ve(a)&&ve(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!o.data&&this.sheetName===null){var l=this.hot.getSettings()[ar].sheetName;l&&this.engine.doesSheetExist(l)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(l??void 0,this.hot.getSourceDataArray())}Ea(Eo(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;Ll(this,hc).forEach(function(i){var a,l=Nl(i,2),s=l[0],u=l[1];return(a=o.engine)===null||a===void 0?void 0:a.off(s,u)}),ni(this,hc,null),aH(this.engine,this.hot),this.engine=null,Ea(Eo(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(o,i){if(ve(i)&&!RU(i))return wt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return wt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o??void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(l){return wt(l.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){DE("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(ur(ar),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,l=this.hot.toPhysicalRow(o),s=this.hot.toPhysicalColumn(i);return l!==null&&s!==null?this.engine.getCellType({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:a,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i)})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=new Set;o.forEach(function(s){var u,f=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(l.has(f)||l.add(f))}),iH(this.engine).forEach(function(s,u){if((a||u!==i.sheetId)&&l.has(u)){var f;s.render(),(f=s.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,y=h.sheet;return ve(y)?"".concat(y,":").concat(d,"x").concat(v):""},s=new Set(a.map(function(u){return l(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col;if(!(ve(d)===!1||ve(v)===!1||d>=i.hot.countRows()||v>=i.hot.countCols())){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=l(u);if(y!==void 0&&!s.has(m)){var w=iH(i.engine).get(y);if(!w)return;w.validateCell(w.getDataAtCell(d,v),w.getCellMeta(d,v),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){wt("Not possible to set cell data at ".concat(JSON.stringify(l)));return}var s=this.hot.getCellMeta(o,i);return RS(a,s.type)&&(lH(a,s.dateFormat)?a=sH(a,s.dateFormat):FLe(a)===!1&&(a="'".concat(a))),this.engine.setCellContents(l,a)}},{key:"onBeforeValidate",value:function(o,i,a){var l=this.hot.propToCol(a);if(this.isFormulaCellType(i,l)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},u=this.hot.getCellMeta(i,l),f=this.engine.getCellValue(s);return u.type==="date"&&wr(f)&&(f=uH(f,u.dateFormat)),xi(f)==="object"&&f!==null?f.value:f}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var l=i.getTopStartCorner(),s=l.row,u=l.col,f=i.getBottomEndCorner(),c=f.row,h=f.col,d=a.getTopStartCorner(),v=d.row,y=d.col,m=a.getBottomEndCorner(),w=m.row,S=m.col,C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}},k={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(w),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(k)===!1)return!1;for(var _=this.engine.getFillRangeData(C,k),N=C.start,V=N.row,X=N.col,Y=C.end,q=Y.row,Q=Y.col,ne=q-V+1,J=Q-X+1,ue=0;ue<_.length;ue+=1)for(var he=0;he<_[ue].length;he+=1){var Oe=_[ue][he],we=ue%ne,$=he%J,P=this.hot.getCellMeta(we,$);RS(Oe,P.type)&&(Oe.startsWith("'")?_[ue][he]=Oe.slice(1):this.isFormulaCellType(we,$,this.sheetId)===!1&&(_[ue][he]=BLe(Oe,P.dateFormat)))}return _}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ur(ar))||ni(this,xS,bt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var o=this,i=this.hot.getSourceDataArray(),a=!1;i.forEach(function(l,s){l.forEach(function(u,f){var c=o.hot.getCellMeta(s,f),h=c.dateFormat;RS(u,c.type)&&(a=!0,lH(u,h)?i[s][f]=sH(u,h):o.isFormulaCellType(s,f)===!1&&(i[s][f]="'".concat(u)))})}),a===!0&&(ni(this,to,!0),this.engine.setSheetContent(this.sheetId,i),ni(this,to,!1))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ur(ar)))if(this.sheetName=LLe(this.engine,this.hot.getSettings()[ar].sheetName),Ll(this,xS))this.switchSheet(this.sheetName);else{var l=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,l)){ni(this,to,!0);var s=this.engine.setSheetContent(this.sheetId,l);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),ni(this,to,!1)}}}},{key:"onModifyData",value:function(o,i,a,l){if(!(l!=="get"||Ll(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o);if(!(s===null||i===null)){var u=this.isFormulaCellType(s,i);if(!u){var f=this.getCellType(s,i);if(f!=="ARRAY"){zz(a.value)&&(a.value=jLe(a.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=this.hot.getCellMeta(s,i);d.type==="date"&&wr(h)&&(h=uH(h,d.dateFormat));var v=xi(h)==="object"&&h!==null?h.value:h;a.value=v}}}},{key:"onModifySourceData",value:function(o,i,a,l){if(!(l!=="get"||Ll(this,to)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(o),u=this.hot.propToCol(i);if(!(s===null||u===null)){var f=this.isFormulaCellType(s,u);if(!f){var c=this.getCellType(s,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!jl(i)){var l=[],s=[],u=this.engine.batch(function(){o.forEach(function(f){var c=Nl(f,4),h=c[0],d=c[1],v=c[3],y=a.hot.propToCol(d),m=a.hot.toPhysicalRow(h),w=a.hot.toPhysicalColumn(y),S={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:a.sheetId};m!==null&&w!==null?a.syncChangeWithEngine(h,y,v):l.push([h,y,v]),s.push({address:S})})});l.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){l.forEach(function(c){var h=Nl(c,3),d=h[0],v=h[1],y=h[2];a.syncChangeWithEngine(d,v,y)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!jl(i)){var l=[],s=[];o.forEach(function(u){var f=Nl(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(wr(v)){var y={row:a.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:a.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(y)){wt("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),l.push.apply(l,ije(a.engine.setCellContents(y,d)))}}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onBeforeCreateRow",value:function(o,i){var a=this.rowAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countRows()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[a,i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){var a=this.columnAxisSyncer.getHfIndexFromVisualIndex(o);if(o>=this.hot.countCols()&&(a=o),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[a,i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=this.rowAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveRows(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var l=this,s=this.columnAxisSyncer.setRemovedHfIndexes(a),u=s.every(function(f){return l.engine.isItPossibleToRemoveColumns(l.sheetId,[f,1])});return u===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!jl(a)){var l=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!jl(a)){var l=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(o),i]);this.renderDependentSheets(l)}}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(!jl(l)){var u=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,l){var s=this;if(!jl(l)){var u=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var l,s=this;ni(this,to,!0);var u=this.hot.getSourceDataArray(a,0,a+(((l=i.__children)===null||l===void 0?void 0:l.length)||0),this.hot.countSourceCols());ni(this,to,!1),u.forEach(function(f,c){f.forEach(function(h,d){s.engine.setCellContents({col:d,row:a+c,sheet:s.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return ar}},{key:"PLUGIN_PRIORITY",get:function(){return Oje}},{key:"SETTING_KEYS",get:function(){return[ar].concat(_je)}}]),r}(ot);function Eje(e,t){return $je(e)||kje(e,t)||Pje(e,t)||Tje()}function Tje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pje(e,t){if(e){if(typeof e=="string")return vH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vH(e,t)}}function vH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $je(e){if(Array.isArray(e))return e}function Aje(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=Eje(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(sP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),l=[],s=i;s<=a;s+=1)l.push(s);e.hideColumns(l);var u=l[l.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Wy(e){return Dje(e)||xje(e)||Mje(e)||Ije()}function Ije(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mje(e,t){if(e){if(typeof e=="string")return yR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yR(e,t)}}function xje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dje(e){if(Array.isArray(e))return yR(e)}function yR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nje(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(uP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countCols();l||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,s=this.columnIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Wy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Wy(c.slice(0,a)));else if(u===null)h.push.apply(h,Wy(c.slice(0,this.countCols())));else{var m=this.countCols()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,Wy(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function Hje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jje(n.key),n)}}function Lje(e,t,r){return t&&yH(e.prototype,t),r&&yH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jje(e){var t=Fje(e,"string");return Yu(t)==="symbol"?t:String(t)}function Fje(e,t){if(Yu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ta(){return typeof Reflect<"u"&&Reflect.get?Ta=Reflect.get.bind():Ta=function(t,r,n){var o=Bje(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ta.apply(this,arguments)}function Bje(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function Vje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gR(e,t)}function gR(e,t){return gR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},gR(e,t)}function Wje(e){var t=zje();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uje(this,o)}}function Uje(e,t){if(t&&(Yu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pR(e)}function pR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}function gH(e,t,r){Yje(e,t),t.set(e,r)}function Yje(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(e,t){var r=Zz(e,t,"get");return Gje(e,r)}function Gje(e,t){return t.get?t.get.call(e):t.value}function dc(e,t,r){var n=Zz(e,t,"set");return Kje(e,n,r),r}function Zz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Kje(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");var DS="hiddenColumns",qje=310,An=new WeakMap,In=new WeakMap,Xje=function(e){Vje(r,e);var t=Wje(r);function r(){var n;Hje(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),gH(pR(n),An,{writable:!0,value:{}}),gH(pR(n),In,{writable:!0,value:null}),n}return Lje(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[DS];Ue(i)&&(dc(this,An,i),bt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),dc(this,In,new Xm),Hr(this,In).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Hr(this,In)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyColWidth",function(a,l){return o.onModifyColWidth(a,l)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Ta(To(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ta(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),dc(this,An,{}),Ta(To(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a,u=Hr(this,In).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualColumn(y)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,s,l&&f);h!==!1&&(l&&f&&Hr(this,In).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,s,l&&f,l&&s.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){Hr(i,In).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,s,l,l&&s.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return We(Hr(this,In).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Hr(this,In).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Hr(this,An).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Hr(this,An).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenColumn");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Hr(this,An).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startCol,s.endCol,function(c){i.isHidden(c)?(u||l(s.startRow,s.endRow,f,c-1),u=!0):(u&&(f=c),c===s.endCol&&l(s.startRow,s.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Hr(this,An).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},Aje(this),Nje(this))}},{key:"onMapInit",value:function(){Array.isArray(Hr(this,An).columns)&&this.hideColumns(Hr(this,An).columns)}},{key:"destroy",value:function(){dc(this,An,null),dc(this,In,null),Ta(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DS}},{key:"PLUGIN_PRIORITY",get:function(){return qje}}]),r}(ot);function Zje(e,t){return tFe(e)||eFe(e,t)||Jje(e,t)||Qje()}function Qje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jje(e,t){if(e){if(typeof e=="string")return pH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pH(e,t)}}function pH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tFe(e){if(Array.isArray(e))return e}function rFe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=Zje(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(fP,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),l=[],s=i;s<=a;s+=1)l.push(s);e.hideRows(l);var u=l[l.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Uy(e){return aFe(e)||iFe(e)||oFe(e)||nFe()}function nFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oFe(e,t){if(e){if(typeof e=="string")return mR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mR(e,t)}}function iFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aFe(e){if(Array.isArray(e))return mR(e)}function mR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lFe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(cP,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var l=a-i+1===this.countRows();l||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=We(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopStartCorner().row,l=i.getBottomEndCorner().row,s=this.rowIndexMapper,u=s.getRenderableFromVisualIndex(a),f=s.getRenderableFromVisualIndex(l),c=s.getNotTrimmedIndexes(),h=[];if(a!==l){var d=l-a+1,v=f-u+1;if(d>v){var y=c.slice(a,l+1);h.push.apply(h,Uy(y.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Uy(c.slice(0,a)));else if(u===null)h.push.apply(h,Uy(c.slice(0,this.countRows())));else{var m=this.countRows()-1,w=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(m,-1));f===w&&m>l&&h.push.apply(h,Uy(c.slice(l+1)))}return A(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function Gu(e){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(e)}function sFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fFe(n.key),n)}}function uFe(e,t,r){return t&&mH(e.prototype,t),r&&mH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fFe(e){var t=cFe(e,"string");return Gu(t)==="symbol"?t:String(t)}function cFe(e,t){if(Gu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pa(){return typeof Reflect<"u"&&Reflect.get?Pa=Reflect.get.bind():Pa=function(t,r,n){var o=hFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pa.apply(this,arguments)}function hFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function dFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bR(e,t)}function bR(e,t){return bR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},bR(e,t)}function vFe(e){var t=gFe();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yFe(this,o)}}function yFe(e,t){if(t&&(Gu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wR(e)}function wR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}function bH(e,t,r){pFe(e,t),t.set(e,r)}function pFe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(e,t){var r=Qz(e,t,"get");return mFe(e,r)}function mFe(e,t){return t.get?t.get.call(e):t.value}function vc(e,t,r){var n=Qz(e,t,"set");return bFe(e,n,r),r}function Qz(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bFe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");var NS="hiddenRows",wFe=320,ro=new WeakMap,Mn=new WeakMap,SFe=function(e){dFe(r,e);var t=vFe(r);function r(){var n;sFe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),bH(wR(n),ro,{writable:!0,value:{}}),bH(wR(n),Mn,{writable:!0,value:null}),n}return uFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[NS];Ue(i)&&(vc(this,ro,i),bt(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),vc(this,Mn,new Xm),qr(this,Mn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,qr(this,Mn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,l,s){return o.onAfterGetCellMeta(a,l,s)}),this.addHook("modifyRowHeight",function(a,l){return o.onModifyRowHeight(a,l)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),Pa(Po(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Pa(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),vc(this,ro,{}),Pa(Po(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a,u=qr(this,Mn).getValues().slice(),f=o.length>0;if(l&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});A(c,function(d){u[d]=!1}),s=Ft(u,function(d,v,y){return v&&d.push(i.hot.toVisualRow(y)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,s,l&&f);h!==!1&&(l&&f&&qr(this,Mn).setValues(u),this.hot.runHooks("afterUnhideRows",a,s,l&&f,l&&s.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){qr(i,Mn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,s,l,l&&s.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return We(qr(this,Mn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return qr(this,Mn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){A(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(qr(this,ro).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var l=a.className.split(" ");if(l.length>0){var s=l.indexOf("afterHiddenRow");s>-1&&l.splice(s,1),a.className=l.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(qr(this,ro).copyPasteEnabled)return o;var a=[],l=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return A(o,function(s){var u=!0,f=0;Ce(s.startRow,s.endRow,function(c){i.isHidden(c)?(u||l(f,c-1,s.startCol,s.endCol),u=!0):(u&&(f=c),c===s.endRow&&l(f,c,s.startCol,s.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!qr(this,ro).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),te(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:qe},rFe(this),lFe(this))}},{key:"onMapInit",value:function(){Array.isArray(qr(this,ro).rows)&&this.hideRows(qr(this,ro).rows)}},{key:"destroy",value:function(){vc(this,ro,null),vc(this,Mn,null),Pa(Po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NS}},{key:"PLUGIN_PRIORITY",get:function(){return wFe}}]),r}(ot);function CFe(e,t){return EFe(e)||RFe(e,t)||OFe(e,t)||_Fe()}function _Fe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OFe(e,t){if(e){if(typeof e=="string")return wH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wH(e,t)}}function wH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function EFe(e){if(Array.isArray(e))return e}function TFe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(LT)},callback:function(r,n){var o=CFe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function PFe(e,t){return IFe(e)||AFe(e,t)||$Fe(e,t)||kFe()}function kFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Fe(e,t){if(e){if(typeof e=="string")return SH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(e,t)}}function SH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function IFe(e){if(Array.isArray(e))return e}function MFe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(jT)},callback:function(r,n){var o=PFe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ku(e){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(e)}function xFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NFe(n.key),n)}}function DFe(e,t,r){return t&&CH(e.prototype,t),r&&CH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NFe(e){var t=HFe(e,"string");return Ku(t)==="symbol"?t:String(t)}function HFe(e,t){if(Ku(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cs(){return typeof Reflect<"u"&&Reflect.get?cs=Reflect.get.bind():cs=function(t,r,n){var o=LFe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cs.apply(this,arguments)}function LFe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ti(e),e!==null););return e}function jFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SR(e,t)}function SR(e,t){return SR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},SR(e,t)}function FFe(e){var t=VFe();return function(){var n=Ti(e),o;if(t){var i=Ti(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BFe(this,o)}}function BFe(e,t){if(t&&(Ku(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jz(e)}function Jz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ti(e){return Ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ti(e)}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");var _H="manualColumnFreeze",WFe=110,yc=new WeakMap,UFe=function(e){jFe(r,e);var t=FFe(r);function r(n){var o;return xFe(this,r),o=t.call(this,n),yc.set(Jz(o),{afterFirstUse:!1}),o}return DFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[_H]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),cs(Ti(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=yc.get(this);o.afterFirstUse=!1,cs(Ti(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),cs(Ti(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=yc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart<this.hot.countCols()&&o>a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",o,l);s!==!1&&(l&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",o,l))}},{key:"unfreezeColumn",value:function(o){var i=yc.get(this),a=this.hot.getSettings(),l=a.fixedColumnsStart>0&&o<=a.fixedColumnsStart-1;i.afterFirstUse||(i.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",o,l);s!==!1&&(l&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",o,l))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},TFe(this),MFe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=yc.get(this);if(a.afterFirstUse){var l=this.hot.getSettings().fixedColumnsStart;if(i<l||o.some(function(s){return s<l}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return _H}},{key:"PLUGIN_PRIORITY",get:function(){return WFe}}]),r}(ot);function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}function zFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GFe(n.key),n)}}function YFe(e,t,r){return t&&OH(e.prototype,t),r&&OH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GFe(e){var t=KFe(e,"string");return Nd(t)==="symbol"?t:String(t)}function KFe(e,t){if(Nd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HS=0,RH=1,EH=2,Fl="px",qFe=function(){function e(t){zFe(this,e),this.hot=t,this._element=null,this.state=HS,this.inlineProperty=t.isRtl()?"right":"left"}return YFe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=EH}},{key:"build",value:function(){this.state===HS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=RH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=HS}},{key:"isAppended",value:function(){return this.state===EH}},{key:"isBuilt",value:function(){return this.state>=RH}},{key:"setPosition",value:function(r,n){wr(r)&&(this._element.style.top=r+Fl),wr(n)&&(this._element.style[this.inlineProperty]=n+Fl)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){wr(r)&&(this._element.style.width=r+Fl),wr(n)&&(this._element.style.height=n+Fl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){wr(r)&&(this._element.style.marginTop=r+Fl),wr(n)&&(this._element.style["margin".concat(ur(this.inlineProperty))]=n+Fl)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ur(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const eY=qFe;function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}function XFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QFe(n.key),n)}}function ZFe(e,t,r){return t&&TH(e.prototype,t),r&&TH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QFe(e){var t=JFe(e,"string");return qu(t)==="symbol"?t:String(t)}function JFe(e,t){if(qu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hg(){return typeof Reflect<"u"&&Reflect.get?Hg=Reflect.get.bind():Hg=function(t,r,n){var o=eBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hg.apply(this,arguments)}function eBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xu(e),e!==null););return e}function tBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CR(e,t)}function CR(e,t){return CR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},CR(e,t)}function rBe(e){var t=iBe();return function(){var n=Xu(e),o;if(t){var i=Xu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return nBe(this,o)}}function nBe(e,t){if(t&&(qu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oBe(e)}function oBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xu(e){return Xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xu(e)}var aBe="ht__manualColumnMove--backlight",lBe=function(e){tBe(r,e);var t=rBe(r);function r(){return XFe(this,r),t.apply(this,arguments)}return ZFe(r,[{key:"build",value:function(){Hg(Xu(r.prototype),"build",this).call(this),te(this._element,aBe)}}]),r}(eY);const sBe=lBe;function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function uBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cBe(n.key),n)}}function fBe(e,t,r){return t&&PH(e.prototype,t),r&&PH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cBe(e){var t=hBe(e,"string");return Zu(t)==="symbol"?t:String(t)}function hBe(e,t){if(Zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lg(){return typeof Reflect<"u"&&Reflect.get?Lg=Reflect.get.bind():Lg=function(t,r,n){var o=dBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Lg.apply(this,arguments)}function dBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qu(e),e!==null););return e}function vBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_R(e,t)}function _R(e,t){return _R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_R(e,t)}function yBe(e){var t=mBe();return function(){var n=Qu(e),o;if(t){var i=Qu(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gBe(this,o)}}function gBe(e,t){if(t&&(Zu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pBe(e)}function pBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qu(e){return Qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qu(e)}var bBe="ht__manualColumnMove--guideline",wBe=function(e){vBe(r,e);var t=yBe(r);function r(){return uBe(this,r),t.apply(this,arguments)}return fBe(r,[{key:"build",value:function(){Lg(Qu(r.prototype),"build",this).call(this),te(this._element,bBe)}}]),r}(eY);const SBe=wBe;function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function CBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OBe(n.key),n)}}function _Be(e,t,r){return t&&kH(e.prototype,t),r&&kH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OBe(e){var t=RBe(e,"string");return Ju(t)==="symbol"?t:String(t)}function RBe(e,t){if(Ju(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(){return typeof Reflect<"u"&&Reflect.get?ka=Reflect.get.bind():ka=function(t,r,n){var o=EBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ka.apply(this,arguments)}function EBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function TBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OR(e,t)}function OR(e,t){return OR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},OR(e,t)}function PBe(e){var t=$Be();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kBe(this,o)}}function kBe(e,t){if(t&&(Ju(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RR(e)}function RR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Be(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");var LS="manualColumnMove",ABe=120,oi=new WeakMap,$H="ht__manualColumnMove",zy="show-ui",jS="on-moving--columns",FS="after-selection--columns",IBe=function(e){TBe(r,e);var t=PBe(r);function r(n){var o;return CBe(this,r),o=t.call(this,n),oi.set(RR(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new kt(RR(o)),o.backlight=new sBe(n),o.guideline=new SBe(n),o}return _Be(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[LS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,$H),ka(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ka(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,$H),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ka(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=oi.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=s&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,l,s,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),l=oi.get(this);return l.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=0,s=o;s<=i;s+=1){var u=a.getRenderableFromVisualIndex(s);s<0?l+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(l+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[LS];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsStart",value:function(o){return o<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Ce(o,i,function(l){a.push(l)}),a}},{key:"refreshPositions",value:function(){var o=oi.get(this),i=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(o.hoveredColumn)&&i>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1));var a=this.hot.view._wt.wtTable,l=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.hoveredColumn-1),f=a.hider.offsetWidth,c=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,y=0;if(this.hot.isRtl()){var m=this.hot.rootWindow,w=ht(this.hot.rootElement),S=m.innerWidth-o.rootElementOffset-w;y=m.innerWidth-o.target.eventPageX-S-(l.scrollX===void 0?s:0)}else y=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?s:0));if(o.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(o.hoveredColumn)&&(u+=s),u+=v,o.hoveredColumn<0)o.fixedColumnsStart>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+u<=y){var C=o.hoveredColumn>=o.countCols?o.countCols-1:o.hoveredColumn;o.target.col=C+1,u+=o.target.TD.offsetWidth}else o.target.col=o.hoveredColumn;var k=y,_=u;y+d+h>=f?k=f-d-h:y+h<c+v&&(k=c+v+Math.abs(h)),u>=f-1?_=f-1:_===0?_=1:l.scrollX!==void 0&&o.hoveredColumn<o.fixedColumnsStart&&(_-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,k),this.guideline.setPosition(null,_)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=oi.get(this),h=xe(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Le(this.hot.rootElement,[jS,zy]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=f.from,m=f.to,w=Math.min(y.col,m.col),S=Math.max(y.col,m.col);if(i.row<0&&i.col>=w&&i.col<=S){l.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.target.eventOffsetX=o.offsetX,c.hoveredColumn=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(w,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Ut(this.hot.rootElement).left;var C=c.hasRowHeaders?-1:0,k=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,_=i.col<c.fixedColumnsStart,N=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),V=Math.abs(o.offsetX-(this.hot.isRtl()?o.target.offsetWidth:0)),X=this.getColumnsWidth(w,i.col-1)+V,Y=this.getColumnsWidth(C,w-1)+(_?N:0)+X;this.backlight.setPosition(k,Y),this.backlight.setSize(this.getColumnsWidth(w,S),s.hider.offsetHeight-k),this.backlight.setOffset(null,-X),te(this.hot.rootElement,jS)}else Le(this.hot.rootElement,FS),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=oi.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=oi.get(this);!s||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Le(this.hot.rootElement,zy):te(this.hot.rootElement,zy),l.row=!0,l.column=!0,l.cell=!0,u.hoveredColumn=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=oi.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.hoveredColumn=void 0,o.pressed=!1,o.backlightWidth=0,Le(this.hot.rootElement,[jS,zy,FS]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,FS),!(a<1||i===void 0)){var l=o.columnsToMove[0],s=this.hot.toPhysicalColumn(l),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(s),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view._wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,l=i+a;this.backlight.setPosition(l),this.backlight.setSize(null,o.hider.offsetHeight-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ka(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LS}},{key:"PLUGIN_PRIORITY",get:function(){return ABe}}]),r}(ot);function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function MBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DBe(n.key),n)}}function xBe(e,t,r){return t&&AH(e.prototype,t),r&&AH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DBe(e){var t=NBe(e,"string");return ef(t)==="symbol"?t:String(t)}function NBe(e,t){if(ef(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ef(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $a(){return typeof Reflect<"u"&&Reflect.get?$a=Reflect.get.bind():$a=function(t,r,n){var o=HBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$a.apply(this,arguments)}function HBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function LBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ER(e,t)}function ER(e,t){return ER=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ER(e,t)}function jBe(e){var t=BBe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FBe(this,o)}}function FBe(e,t){if(t&&(ef(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TR(e)}function TR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}var Yy="manualColumnResize",VBe=130,IH="manualColumnWidths",BS=new WeakMap,WBe=function(e){LBe(r,e);var t=jBe(r);function r(n){var o;MBe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new kt(TR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,BS.set(TR(o),{config:void 0}),te(o.handle,"manualColumnResizer"),te(o.guide,"manualColumnResizerGuide"),o}return xBe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Yy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new Li,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,l){return o.onBeforeColumnResize(i,a,l)}),this.bindEvents(),$a($o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$a($o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=BS.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),$a($o(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",IH,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",IH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),l=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(l,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=BS.get(this),a=this.hot.getSettings()[Yy],l=this.loadManualColumnWidths();typeof l<"u"?this.hot.batchExecution(function(){l.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(s,u){o.columnWidthsMap.setValueAtIndex(u,s)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(o.parentNode){this.currentTH=o;var a=this.hot.view._wt,l=a.wtTable.getCoords(this.currentTH),s=l.col;if(!(s<0)){var u=Pt(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=s<a.getSetting("fixedColumnsStart"),h;c&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();A(v,function(y){var m=y.getTopStartCorner().col,w=y.getBottomEndCorner().col;Ce(m,w,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Pt(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!pi(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!xE(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;if(this.pressed){var a=(o.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,A(this.selectedCols,function(l){i.newSize=i.setManualSize(l,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var l=this.selectedCols.length;l>1?(A(this.selectedCols,function(s){a(s)}),i()):A(this.selectedCols,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,l=i.rootElement;this.eventManager.addEventListener(l,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(l,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalColumn(i),s=this.columnWidthsMap.getValueAtIndex(l);this.hot.getSettings()[Yy]&&s&&(a=s)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){$a($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Yy}},{key:"PLUGIN_PRIORITY",get:function(){return VBe}}]),r}(ot);function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}function UBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YBe(n.key),n)}}function zBe(e,t,r){return t&&MH(e.prototype,t),r&&MH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YBe(e){var t=GBe(e,"string");return Hd(t)==="symbol"?t:String(t)}function GBe(e,t){if(Hd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VS=0,xH=1,DH=2,Bl="px",KBe=function(){function e(t){UBe(this,e),this.hot=t,this._element=null,this.state=VS}return zBe(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=DH}},{key:"build",value:function(){this.state===VS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=xH)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=VS}},{key:"isAppended",value:function(){return this.state===DH}},{key:"isBuilt",value:function(){return this.state>=xH}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+Bl),n!==void 0&&(this._element.style.left=n+Bl)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+Bl),n&&(this._element.style.height=n+Bl)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+Bl),n&&(this._element.style.marginLeft=n+Bl)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const tY=KBe;function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function qBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZBe(n.key),n)}}function XBe(e,t,r){return t&&NH(e.prototype,t),r&&NH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZBe(e){var t=QBe(e,"string");return tf(t)==="symbol"?t:String(t)}function QBe(e,t){if(tf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jg(){return typeof Reflect<"u"&&Reflect.get?jg=Reflect.get.bind():jg=function(t,r,n){var o=JBe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jg.apply(this,arguments)}function JBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=rf(e),e!==null););return e}function eVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PR(e,t)}function PR(e,t){return PR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},PR(e,t)}function tVe(e){var t=oVe();return function(){var n=rf(e),o;if(t){var i=rf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rVe(this,o)}}function rVe(e,t){if(t&&(tf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nVe(e)}function nVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rf(e){return rf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rf(e)}var iVe="ht__manualRowMove--backlight",aVe=function(e){eVe(r,e);var t=tVe(r);function r(){return qBe(this,r),t.apply(this,arguments)}return XBe(r,[{key:"build",value:function(){jg(rf(r.prototype),"build",this).call(this),te(this._element,iVe)}}]),r}(tY);const lVe=aVe;function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function sVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fVe(n.key),n)}}function uVe(e,t,r){return t&&HH(e.prototype,t),r&&HH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fVe(e){var t=cVe(e,"string");return nf(t)==="symbol"?t:String(t)}function cVe(e,t){if(nf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fg(){return typeof Reflect<"u"&&Reflect.get?Fg=Reflect.get.bind():Fg=function(t,r,n){var o=hVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fg.apply(this,arguments)}function hVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=of(e),e!==null););return e}function dVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kR(e,t)}function kR(e,t){return kR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},kR(e,t)}function vVe(e){var t=pVe();return function(){var n=of(e),o;if(t){var i=of(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return yVe(this,o)}}function yVe(e,t){if(t&&(nf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gVe(e)}function gVe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function of(e){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},of(e)}var mVe="ht__manualRowMove--guideline",bVe=function(e){dVe(r,e);var t=vVe(r);function r(){return sVe(this,r),t.apply(this,arguments)}return uVe(r,[{key:"build",value:function(){Fg(of(r.prototype),"build",this).call(this),te(this._element,mVe)}}]),r}(tY);const wVe=bVe;function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function SVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ve(n.key),n)}}function CVe(e,t,r){return t&&LH(e.prototype,t),r&&LH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ve(e){var t=OVe(e,"string");return af(t)==="symbol"?t:String(t)}function OVe(e,t){if(af(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(af(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aa(){return typeof Reflect<"u"&&Reflect.get?Aa=Reflect.get.bind():Aa=function(t,r,n){var o=RVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Aa.apply(this,arguments)}function RVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function EVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$R(e,t)}function $R(e,t){return $R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},$R(e,t)}function TVe(e){var t=kVe();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return PVe(this,o)}}function PVe(e,t){if(t&&(af(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AR(e)}function AR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");var WS="manualRowMove",$Ve=140,ii=new WeakMap,jH="ht__manualRowMove",Gy="show-ui",US="on-moving--rows",zS="after-selection--rows",AVe=function(e){EVe(r,e);var t=TVe(r);function r(n){var o;return SVe(this,r),o=t.call(this,n),ii.set(AR(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new kt(AR(o)),o.backlight=new lVe(n),o.guideline=new wVe(n),o}return CVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[WS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,jH),Aa(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Aa(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Le(this.hot.rootElement,jH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Aa(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=ii.get(this),l=a.cachedDropIndex,s=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,l,s);if(a.cachedDropIndex=void 0,u!==!1){s&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=s&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,l,s,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),l=ii.get(this);return l.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),l=o.length+i>a,s=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(l||s||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,l){return a-l!==i})}},{key:"countFinalIndex",value:function(o,i){var a=Ft(o,function(l,s){return s<i&&(l+=1),l},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=0,s=o;s<=i;s++){var u=a.getRenderableFromVisualIndex(s);u!==null&&(l+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return l}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[WS];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,l=o.to,s=Math.min(a.row,l.row),u=Math.max(a.row,l.row);return Ce(s,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=ii.get(this),i=o.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),l=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(i.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(i.row)&&l<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(l+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=o.target.TD,c=this.hot.rootElement,h=Ut(c),d=Ua(c),v=u.holder.scrollTop,y;this.hot.rootWindow===d?y=d.scrollY:y=d.scrollTop;var m=h.top-y,w=o.target.eventPageY-m+v,S=u.hider.offsetHeight,C=u.TBODY.offsetTop,k=this.backlight.getOffset().top,_=this.backlight.getSize().height,N=f.offsetHeight/2,V=f.offsetHeight,X=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),Y=w>=X+N;this.isFixedRowTop(i.row)&&(X+=u.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:Y?(o.target.row=i.row+1,X+=i.row===0?V-1:V):o.target.row=i.row;var q=w,Q=X;w+_+k>=S?q=S-_-k:w+k<C&&(q=C+Math.abs(k)),X>=S-1&&(Q=S-1),this.backlight.setPosition(q),this.guideline.setPosition(Q)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this.hot.view._wt,u=s.wtTable,f=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=ii.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Le(this.hot.rootElement,[US,Gy]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&y&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var m=h.from,w=h.to,S=Math.min(m.row,w.row),C=Math.max(m.row,w.row);if(i.col<0&&i.row>=S&&i.row<=C){l.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var k=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,k),this.backlight.setSize(u.hider.offsetWidth-k,this.getRowsHeight(S,C)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),te(this.hot.rootElement,US),this.refreshPositions()}else Le(this.hot.rootElement,zS),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=ii.get(this);if(i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s=this.hot.getSelectedRangeLast(),u=ii.get(this);!s||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Le(this.hot.rootElement,Gy):te(this.hot.rootElement,Gy),l.row=!0,l.column=!0,l.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=ii.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Le(this.hot.rootElement,[US,Gy,zS]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,zS),!(a<1||i===void 0)){var l=o.rowsToMove[0],s=this.hot.toPhysicalRow(l),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(s),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,l=i+a;this.backlight.setPosition(null,l),this.backlight.setSize(o.hider.offsetWidth-l)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Aa(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return WS}},{key:"PLUGIN_PRIORITY",get:function(){return $Ve}}]),r}(ot);function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}function IVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xVe(n.key),n)}}function MVe(e,t,r){return t&&FH(e.prototype,t),r&&FH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xVe(e){var t=DVe(e,"string");return lf(t)==="symbol"?t:String(t)}function DVe(e,t){if(lf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ia(){return typeof Reflect<"u"&&Reflect.get?Ia=Reflect.get.bind():Ia=function(t,r,n){var o=NVe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ia.apply(this,arguments)}function NVe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function HVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IR(e,t)}function IR(e,t){return IR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},IR(e,t)}function LVe(e){var t=FVe();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jVe(this,o)}}function jVe(e,t){if(t&&(lf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MR(e)}function MR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}var Ky="manualRowResize",BVe=30,BH="manualRowHeights",YS=new WeakMap,VVe=function(e){HVe(r,e);var t=LVe(r);function r(n){var o;IVe(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new kt(MR(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,YS.set(MR(o),{config:void 0}),te(o.handle,"manualRowResizer"),te(o.guide,"manualRowResizerGuide"),o}return MVe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Ky]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new Li,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),Ia(Io(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ia(Io(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=YS.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ia(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",BH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",BH,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=Math.max(i,UW.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,l),l}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,l=a._wt,s=l.wtTable.getCoords(this.currentTH),u=s.row;if(!(u<0)){var f=ht(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<l.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-l.getSetting("fixedRowsBottom"),v;h?v=l.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):d&&(v=l.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),v||(v=l.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var m=this.hot.getSelectedRange();A(m,function(w){var S=w.getTopStartCorner().row,C=w.getBottomStartCorner().row;Ce(S,C,function(k){i.selectedRows.includes(k)||i.selectedRows.push(k)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(ht(this.handle),10),i=parseInt(this.handle.style[this.inlineDir],10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Le(this.handle,"active"),Le(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,l=pi(o,["TH"],this.hot.rootElement);return l&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view._wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!xE(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;xe(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),A(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var l=this.selectedRows.length;l>1?(A(this.selectedRows,function(s){a(s)}),i()):A(this.selectedRows,function(s){a(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,l=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(s){return o.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return o.onMouseDown(s)}),this.eventManager.addEventListener(l,"mousemove",function(s){return o.onMouseMove(s)}),this.eventManager.addEventListener(l,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var l=this.hot.toPhysicalRow(i),s=this.rowHeightsMap.getValueAtIndex(l);this.hot.getSettings()[Ky]&&s&&(a=s)}return a}},{key:"onMapInit",value:function(){var o=this,i=YS.get(this),a=this.hot.getSettings()[Ky],l=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof l<"u"?l.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}):Array.isArray(a)?(a.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(s,u){o.rowHeightsMap.setValueAtIndex(u,s)})},!0)}},{key:"destroy",value:function(){Ia(Io(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ky}},{key:"PLUGIN_PRIORITY",get:function(){return BVe}}]),r}(ot);function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}var VH,WH,UH,zH;function qy(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function WVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zVe(n.key),n)}}function UVe(e,t,r){return t&&YH(e.prototype,t),r&&YH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zVe(e){var t=YVe(e,"string");return Ld(t)==="symbol"?t:String(t)}function YVe(e,t){if(Ld(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GVe=function(){function e(t,r,n,o,i,a){WVe(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return UVe(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",l=r[0]?"col":"row",s=Math.min(n,i),u=Math.max(n,i),f=this[l],c=this[l]+this[a]-1;if(f>=n&&(this[l]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(s<=f&&u>=c)return this.removed=!0,!1;if(f>=s&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[l]-=d+o,this[a]-=h}else if(f<=s&&c>=u)this[a]+=o;else if(f<=s&&c>=s&&c<u){var v=c-s+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return dt(VH||(VH=qy(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return dt(WH||(WH=qy(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return dt(UH||(UH=qy(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return dt(zH||(zH=qy(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}();const Ln=GVe;function xR(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}var GH;function KVe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function KH(e){return QVe(e)||ZVe(e)||XVe(e)||qVe()}function qVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XVe(e,t){if(e){if(typeof e=="string")return DR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DR(e,t)}}function ZVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QVe(e){if(Array.isArray(e))return DR(e)}function DR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tWe(n.key),n)}}function eWe(e,t,r){return t&&qH(e.prototype,t),r&&qH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tWe(e){var t=rWe(e,"string");return jd(t)==="symbol"?t:String(t)}function rWe(e,t){if(jd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nWe=function(){function e(t){JVe(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return eWe(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return A(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return A(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,a=[],l=r;if(!l.includesRange){var s=this.hot._createCellCoords(l.from.row,l.from.col),u=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(s,s,u)}return A(i,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);o?l.overlaps(d)&&a.push(f):l.includesRange(d)&&a.push(f)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,l=r.colspan,s=new Ln(o,i,a,l,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(o,i),f=this.isOverlapping(s);return!u&&!f?(this.hot&&s.normalize(this.hot),n.push(s),s):(wt(e.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];A(n,function(a){var l=r.hot.getCell(a.row,a.col);l&&o.push([l,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,A(o,function(a,l){Ce(0,a.rowspan-1,function(s){Ce(0,a.colspan-1,function(u){if(u!==0||s!==0){var f=r.hot.getCell(a.row+s,a.col+u);f&&i.push([f,null,null,null])}})}),o[l][1]=null}),A(o,function(a){xR.apply(void 0,KH(a))}),A(i,function(a){xR.apply(void 0,KH(a))})}},{key:"isOverlapping",value:function(r){var n=this,o=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),i=!1;return A(this.mergedCells,function(a){var l=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return l.overlaps(o)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}A(this.mergedCells,function(l){l.shift(a,n)}),lp(this.mergedCells.length-1,0,function(l){var s=i.mergedCells[l];s&&s.removed&&i.mergedCells.splice(i.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return dt(GH||(GH=KVe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const oWe=nWe;function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function ta(e,t){return sWe(e)||lWe(e,t)||aWe(e,t)||iWe()}function iWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aWe(e,t){if(e){if(typeof e=="string")return XH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XH(e,t)}}function XH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function sWe(e){if(Array.isArray(e))return e}function uWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cWe(n.key),n)}}function fWe(e,t,r){return t&&ZH(e.prototype,t),r&&ZH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cWe(e){var t=hWe(e,"string");return Fd(t)==="symbol"?t:String(t)}function hWe(e,t){if(Fd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dWe=function(){function e(t){uWe(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return fWe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),l=this.getAutofillSize(r,n,o),s=ta(r,4),u=s[0],f=s[1],c=s[2],h=s[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,y=Math.floor(l/v)*v,m=l-y,w=this.getFarthestCollection(r,n,o,i);if(w){if(o==="down"){var S=w.row+w.rowspan-u-m,C=a[2]+S;C>=this.plugin.hot.countRows()?a[2]-=m:a[2]+=m?S:0}else if(o==="right"){var k=w.col+w.colspan-f-m,_=a[3]+k;_>=this.plugin.hot.countCols()?a[3]-=m:a[3]+=m?k:0}else if(o==="up"){var N=c-m-w.row+1,V=a[0]+N;V<0?a[0]+=m:a[0]-=m?N:0}else if(o==="left"){var X=h-m-w.col+1,Y=a[1]+X;Y<0?a[1]+=m:a[1]-=m?X:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:l,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),zt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=ta(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ta(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-s;case"left":return l-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=ta(r,4),a=i[0],l=i[1],s=i[2],u=i[3],f=ta(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[s+1,l,d,u];case"left":return[c,h,s,l-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=ta(r,4),l=a[0],s=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?l:s,v=this.getAutofillSize(r,n,o),y=c?u-l+1:f-s+1,m=Math.floor(v/y)*y,w=v-m,S=null,C=null,k=null;switch(o){case"up":S="includesVertically",k=h-w+1;break;case"left":S="includesHorizontally",k=h-w+1;break;case"down":S="includesVertically",k=d+w-1;break;case"right":S="includesHorizontally",k=d+w-1;break}return A(i,function(_){_[S](k)&&_.isFarther(C,o)&&(C=_)}),C}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},l=0,s=null,u=1;do for(var f=0;f<o.length;f+=1){if(s=o[f],l=u*this.currentFillData.cycleLength,a(s,l))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+l,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-l,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+l,colspan:s.colspan});break}f===o.length-1&&(u+=1)}while(a(s,l));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return A(r,function(a){var l=a[0],s=n.plugin.hot.propToCol(a[1]);(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=ta(i,4),l=a[0],s=a[1],u=a[2],f=a[3],c=this.plugin.hot._createCellCoords(l,s),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const vWe=dWe;function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function yWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pWe(n.key),n)}}function gWe(e,t,r){return t&&QH(e.prototype,t),r&&QH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pWe(e){var t=mWe(e,"string");return Bd(t)==="symbol"?t:String(t)}function mWe(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bWe=function(){function e(t){yWe(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return gWe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,l=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,l)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,l=null,s=null;r.row?(a=n.includesVertically(o),l=n.row,s=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),l=n.col,s=n.getLastColumn()),i!==0&&(i>0?a&&o!==l&&(i+=s-o+1):a&&o!==s&&(i-=o-l+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&l<=c.col&&s>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(this.hot._createCellCoords(r.row+i,r.col+a));for(var l=0;l<o.length;l+=1){for(var s=[],u=0;u<n.length;u+=1)s[u]=n[u].includes(o[l]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const wWe=bWe;function SWe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(BT)}return this.getTranslatedPhrase(FT)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Ln.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function CWe(e,t){return RWe(e)||OWe(e,t)||rY(e,t)||_We()}function _We(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function RWe(e){if(Array.isArray(e))return e}function EWe(e){return kWe(e)||PWe(e)||rY(e)||TWe()}function TWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rY(e,t){if(e){if(typeof e=="string")return NR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NR(e,t)}}function PWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kWe(e){if(Array.isArray(e))return NR(e)}function NR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JH(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IWe(n.key),n)}}function AWe(e,t,r){return t&&JH(e.prototype,t),r&&JH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IWe(e){var t=MWe(e,"string");return sf(t)==="symbol"?t:String(t)}function MWe(e,t){if(sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hs(){return typeof Reflect<"u"&&Reflect.get?hs=Reflect.get.bind():hs=function(t,r,n){var o=xWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},hs.apply(this,arguments)}function xWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pi(e),e!==null););return e}function DWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HR(e,t)}function HR(e,t){return HR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},HR(e,t)}function NWe(e){var t=LWe();return function(){var n=Pi(e),o;if(t){var i=Pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return HWe(this,o)}}function HWe(e,t){if(t&&(sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nY(e)}function nY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pi(e)}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");var Oc="mergeCells",jWe=150,eL=new WeakMap,tL=Oc,FWe=function(e){DWe(r,e);var t=NWe(r);function r(n){var o;return $We(this,r),o=t.call(this,n),eL.set(nY(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return AWe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Oc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new oWe(this),this.autofillCalculations=new vWe(this),this.selectionCalculations=new wWe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),hs(Pi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),hs(Pi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[Oc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),hs(Pi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var o=this;if(CE()){var i=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(l){for(var s=l.row,u=l.rowspan,f=s+1;f<s+u;f++)a.push(f)}),a=EWe(new Set(a)),a.forEach(function(l){var s=o.hot.rowIndexMapper.getRenderableFromVisualIndex(l);o.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(s);f&&(f.style.background=Ss(f,"backgroundColor").replace(")",", 0.99)"),i.push(f))})}),this.hot._registerTimeout(function(){i.forEach(function(l){l.style.background=Ss(l,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(o){var i=!0;return o?(Ln.containsNegativeValues(o)?(wt(Ln.NEGATIVE_VALUES_WARNING(o)),i=!1):Ln.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(wt(Ln.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Ln.isSingleCell(o)?(wt(Ln.IS_SINGLE_CELL(o)),i=!1):Ln.containsZeroSpan(o)&&(wt(Ln.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a=[];if(A(o,function(l){if(i.validateSetting(l)){var s=i.hot._createCellCoords(l.row,l.col),u=i.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1),f=i.hot._createCellRange(s,s,u);i.mergeRange(f,!0,!0),Ce(l.row,l.row+l.rowspan-1,function(c){Ce(l.col,l.col+l.colspan-1,function(h){c===l.row&&h===l.col||a.push([c,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){o.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=o.getTopStartCorner(),u=o.getBottomEndCorner(),f={row:s.row,col:s.col,rowspan:u.row-s.row+1,colspan:u.col-s.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Ce(0,f.rowspan-1,function(v){Ce(0,f.colspan-1,function(y){var m=null;c[v]||(c[v]=[]),v===0&&y===0?m=i.hot.getSourceDataAtCell(i.hot.toPhysicalRow(f.row),i.hot.toPhysicalColumn(f.col)):i.hot.setCellMeta(f.row+v,f.col+y,"hidden",!0),c[v][y]=m})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(l?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=this.mergedCellsCollection.getWithinRange(o);l&&(this.hot.runHooks("beforeUnmergeCells",o,a),A(l,function(s){i.mergedCellsCollection.remove(s.row,s.col),Ce(0,s.rowspan-1,function(u){Ce(0,s.colspan-1,function(f){i.hot.removeCellMeta(s.row+u,s.col+f,"hidden")})}),i.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.mergeRange(this.hot._createCellRange(s,s,u))}},{key:"unmerge",value:function(o,i,a,l){var s=this.hot._createCellCoords(o,i),u=this.hot._createCellCoords(a,l);this.unmergeRange(this.hot._createCellRange(s,s,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Oc]),this.hot.render()}},{key:"registerShortcuts",value:function(){var o=this,i=this.hot.getShortcutManager(),a=i.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){o.toggleMerge(o.hot.getSelectedRangeLast()),o.hot.render()},runOnlyIf:function(s){return!s.altKey},group:tL})}},{key:"unregisterShortcuts",value:function(){var o=this.hot.getShortcutManager(),i=o.getContext("grid");i.removeShortcutsByGroup(tL)}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),l=0;l<i.length;l+=1)if(a.from.row===i[l].row&&a.from.col===i[l].col&&a.to.row===i[l].row+i[l].rowspan-1&&a.to.col===i[l].col+i[l].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=eL.get(this),a=this.hot.getSelectedRangeLast(),l={row:o.row,col:o.col},s=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=this.hot._createCellCoords(null,null)),l.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:l.row,l.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:l.col,o.row>0?l.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(l.row=u.row-f.row+o.row),o.col>0?l.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(l.col=u.col-f.col+o.col)}s=this.hot._createCellCoords(a.highlight.row+l.row,a.highlight.col+l.col);var v=this.mergedCellsCollection.get(s.row,s.col);if(v){var y=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=s,l={row:y.row-u.row,col:y.col-u.col}}l.row!==0&&(o.row=l.row),l.col!==0&&(o.col=l.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),l=Sr(o),s=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=Sr(l),f=this.mergedCellsCollection.getWithinRange(s,!0);do u=Sr(l),this.selectionCalculations.getUpdatedSelectionRange(a,l),A(f,function(c){i.selectionCalculations.snapDelta(l,a,c)});while(l.row!==u.row||l.col!==u.col);o.row=l.row,o.col=l.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(a){var l=a.row,s=a.col,u=a.colspan,f=a.rowspan;return[l,s,l+f-1,s+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},SWe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var l=this.mergedCellsCollection.get(i,a),s=Ue(l)?Sr(l):void 0;if(Ue(s)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=s.row,d=s.col,v=s.colspan,y=s.rowspan,m=this.translateMergedCellToRenderable(h,y,d,v),w=CWe(m,2),S=w[0],C=w[1],k=f.getRenderableFromVisualIndex(i),_=c.getRenderableFromVisualIndex(a),N=S-k+1,V=C-_+1;s.row=f.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,N),s.colspan=Math.min(s.colspan,V)}xR(o,s,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=this.hot._createCellCoords(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var l=0;l<this.mergedCellsCollection.mergedCells.length;l+=1){var s=this.mergedCellsCollection.mergedCells[l],u=s.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var l=this.mergedCellsCollection.get(o,i);l&&(l.row!==o||l.col!==i?a.copyable=!1:(a.rowspan=l.rowspan,a.colspan=l.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.startRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,l=a.getVisualFromRenderableIndex(o.endRow),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(l,s);if(Ue(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.startColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,l=a.getVisualFromRenderableIndex(o.endColumn),s=0;s<i;s+=1){var u=this.mergedCellsCollection.get(s,l);if(Ue(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,l){var s=this.hot,u=s.rowIndexMapper,f=s.columnIndexMapper,c,h;i===0?c=u.getNearestNotHiddenIndex(o,1):c=u.getNearestNotHiddenIndex(o+i-1,-1),l===0?h=f.getNearestNotHiddenIndex(a,1):h=f.getNearestNotHiddenIndex(a+l-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),l=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,l,a))return l=i,l;var s=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return s&&(l=this.autofillCalculations.snapDragArea(i,l,a,s)),l}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),l=this.mergedCellsCollection.getWithinRange(a);A(l,function(s){a.getBottomEndCorner().row===s.getLastRow()&&a.getBottomEndCorner().col===s.getLastColumn()&&(o[2]=s.row,o[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(this.enabled){var l=this.mergedCellsCollection.get(o.row,o.col);if(l){var s=i>0,u=i<0,f=a<0,c=a>0,h=l.row+l.rowspan-1===this.hot.countRows()-1,d=l.row===0,v=l.col+l.colspan-1===this.hot.countCols()-1,y=l.col===0;(s&&h||u&&d||c&&v||f&&y)&&(o.row=l.row,o.col=l.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,l){if(a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,l)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Oc}},{key:"PLUGIN_PRIORITY",get:function(){return jWe}}]),r}(ot);function rL(e){return UWe(e)||WWe(e)||VWe(e)||BWe()}function BWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VWe(e,t){if(e){if(typeof e=="string")return nL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nL(e,t)}}function nL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function UWe(e){if(Array.isArray(e))return e}function zWe(e,t){return function(r,n){var o=rL(r),i=o.slice(1),a=rL(n),l=a.slice(1);return function s(u){var f=e[u],c=t[u],h=i[u],d=l[u],v=c.multiColumnSorting,y=v.compareFunctionFactory?v.compareFunctionFactory:Q2(c.type),m=y(f,c,v)(h,d);if(m===Vn){var w=u+1;if(typeof t[w]<"u")return s(w)}return m}(0)}}var oL;function YWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function iL(){wt(dt(oL||(oL=YWe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var oY="sort";function GWe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(oY,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function KWe(e){var t=e.className.split(" "),r=new RegExp("^".concat(oY,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function qWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZWe(n.key),n)}}function XWe(e,t,r){return t&&aL(e.prototype,t),r&&aL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZWe(e){var t=QWe(e,"string");return uf(t)==="symbol"?t:String(t)}function QWe(e,t){if(uf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jr(){return typeof Reflect<"u"&&Reflect.get?jr=Reflect.get.bind():jr=function(t,r,n){var o=JWe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jr.apply(this,arguments)}function JWe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=br(e),e!==null););return e}function e2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LR(e,t)}function LR(e,t){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},LR(e,t)}function t2e(e){var t=o2e();return function(){var n=br(e),o;if(t){var i=br(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return r2e(this,o)}}function r2e(e,t){if(t&&(uf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n2e(e)}function n2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},br(e)}var jR="multiColumnSorting",i2e=170,a2e="append",lL="columnSorting";Z2(jR,zWe);var l2e=function(e){e2e(r,e);var t=t2e(r);function r(n){var o;return qWe(this,r),o=t.call(this,n),o.pluginKey=jR,o}return XWe(r,[{key:"isEnabled",value:function(){return jr(br(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[lL]&&iL(),jr(br(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){jr(br(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){jr(br(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){jr(br(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return jr(br(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return jr(br(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){jr(br(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,l=new Array(a>1?a-1:0),s=1;s<a;s++)l[s-1]=arguments[s];(i=jr(br(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(l)),Le(o,KWe(o)),this.enabled!==!1&&te(o,GWe.apply(void 0,l))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[lL]&&iL(),jr(br(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){dO(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,a2e))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return jR}},{key:"PLUGIN_PRIORITY",get:function(){return i2e}}]),r}(eU);function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function s2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f2e(n.key),n)}}function u2e(e,t,r){return t&&sL(e.prototype,t),r&&sL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f2e(e){var t=c2e(e,"string");return ff(t)==="symbol"?t:String(t)}function c2e(e,t){if(ff(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bg(){return typeof Reflect<"u"&&Reflect.get?Bg=Reflect.get.bind():Bg=function(t,r,n){var o=h2e(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Bg.apply(this,arguments)}function h2e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cf(e),e!==null););return e}function d2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FR(e,t)}function FR(e,t){return FR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},FR(e,t)}function v2e(e){var t=p2e();return function(){var n=cf(e),o;if(t){var i=cf(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return y2e(this,o)}}function y2e(e,t){if(t&&(ff(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g2e(e)}function g2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cf(e){return cf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cf(e)}var m2e="multipleSelectionHandles",b2e=160,w2e=function(e){d2e(r,e);var t=v2e(r);function r(n){var o;return s2e(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return u2e(r,[{key:"isEnabled",value:function(){return pn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new kt(this)),this.registerListeners(),Bg(cf(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function l(s){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(s);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(s){var u;if(xe(s.target,"topSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("top"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottom"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(s){if(xe(s.target,"topSelectionHandle-HitArea"))return l.call(i,"top"),i.touchStartRange=void 0,s.preventDefault(),!1;if(xe(s.target,"bottomSelectionHandle-HitArea"))return l.call(i,"bottom"),i.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(s){var u=o.hot.rootDocument,f,c,h,d,v,y;if(i.dragged.length!==0){var m=u.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!m||m===i.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(f=i.hot.getCoords(m),f.col===-1&&(f.col=0),c=i.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&i.hot.selection.setRangeEnd(f),y=i.getCurrentRangeCoords(c,f,i.touchStartRange.direction,v,i.dragged[0]),y.start!==null&&i.hot.selection.setRangeStart(y.start),i.hot.selection.setRangeEnd(y.end),i.lastSetCell=m),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,l,s){var u=o.getTopStartCorner(),f=o.getBottomEndCorner(),c=o.getBottomStartCorner(),h=o.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(l){case"NE-SW":case"NW-SE":s==="top"?d={start:this.hot._createCellCoords(i.row,o.highlight.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,u.col)};break;case"SE-NW":s==="bottom"&&(d={start:this.hot._createCellCoords(f.row,i.col),end:this.hot._createCellCoords(i.row,u.col)});break}break;case"NW-SE":switch(l){case"NE-SW":s==="top"?d={start:i,end:c}:d.end=i;break;case"NW-SE":s==="top"?d={start:i,end:f}:d.end=i;break;case"SE-NW":s==="top"?d={start:i,end:u}:d.end=i;break;case"SW-NE":s==="top"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(l){case"NW-SE":s==="bottom"?d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(c.row,i.col)}:d={start:this.hot._createCellCoords(u.row,i.col),end:this.hot._createCellCoords(i.row,f.col)};break;case"SW-NE":s==="top"?d={start:this.hot._createCellCoords(o.highlight.row,i.col),end:this.hot._createCellCoords(i.row,f.col)}:d={start:this.hot._createCellCoords(i.row,u.col),end:this.hot._createCellCoords(u.row,i.col)};break;case"SE-NW":s==="bottom"?d={start:this.hot._createCellCoords(i.row,h.col),end:this.hot._createCellCoords(u.row,i.col)}:s==="top"&&(d={start:c,end:i});break}break;case"SE-NW":switch(l){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(d.end=i);break;case"SE-NW":s==="top"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return m2e}},{key:"PLUGIN_PRIORITY",get:function(){return b2e}}]),r}(ot);function BR(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,l=e.collapsible,s=l===void 0?!1:l,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,y=e.isRoot,m=y===void 0?!1:y,w=e.isPlaceholder,S=w===void 0?!1:w;return{label:r,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:m,isPlaceholder:S}}function iY(){return{label:"",isPlaceholder:!0}}function uL(e){return O2e(e)||_2e(e)||C2e(e)||S2e()}function S2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C2e(e,t){if(e){if(typeof e=="string")return VR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VR(e,t)}}function _2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function O2e(e){if(Array.isArray(e))return VR(e)}function VR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R2e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;A(e,function(o){var i=[],a=0;r.push(i),A(o,function(l){var s=BR();if(Ue(l)){var u=l.label,f=l.colspan;s.label=Dt(u),typeof f=="number"&&f>1&&(s.colspan=f,s.origColspan=f)}else s.label=Dt(l);a+=s.origColspan;var c=!1;if(a>=t&&(s.colspan=s.origColspan-(a-t),s.origColspan=s.colspan,c=!0),i.push(s),s.colspan>1)for(var h=0;h<s.colspan-1;h++)i.push(iY());return!c})});var n=Math.max.apply(Math,uL(We(r,function(o){return o.length})));return A(r,function(o){if(o.length<n){var i=We(new Array(n-o.length),function(){return BR()});o.splice.apply(o,[o.length,0].concat(uL(i)))}}),r}function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vd(e)}var E2e=["row","col"];function fL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function T2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fL(Object(r),!0).forEach(function(n){P2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P2e(e,t,r){return t=aY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k2e(e,t){if(e==null)return{};var r=$2e(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function A2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aY(n.key),n)}}function I2e(e,t,r){return t&&cL(e.prototype,t),r&&cL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aY(e){var t=M2e(e,"string");return Vd(t)==="symbol"?t:String(t)}function M2e(e,t){if(Vd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GS(e,t,r){x2e(e,t),t.set(e,r)}function x2e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(e,t){var r=lY(e,t,"get");return D2e(e,r)}function D2e(e,t){return t.get?t.get.call(e):t.value}function gc(e,t,r){var n=lY(e,t,"set");return N2e(e,n,r),r}function lY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function N2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var hL=["label","collapsible"],no=new WeakMap,ra=new WeakMap,KS=new WeakMap,H2e=function(){function e(){A2e(this,e),GS(this,no,{writable:!0,value:[]}),GS(this,ra,{writable:!0,value:0}),GS(this,KS,{writable:!0,value:1/0})}return I2e(e,[{key:"setColumnsLimit",value:function(r){gc(this,KS,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];gc(this,no,R2e(r,un(this,KS))),gc(this,ra,un(this,no).length)}},{key:"getData",value:function(){return un(this,no)}},{key:"mergeWith",value:function(r){var n=this;A(r,function(o){var i=o.row,a=o.col,l=k2e(o,E2e),s=n.getHeaderSettings(i,a);s!==null&&zt(s,l,hL)})}},{key:"map",value:function(r){A(un(this,no),function(n){A(n,function(o){var i=r(T2e({},o));Ue(i)&&zt(o,i,hL)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=un(this,ra)||r<0)return null;var i=un(this,no)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=un(this,ra)||r<0)return i;for(var a=un(this,no)[r],l=0,s=n;s<a.length;s++){var u=a[s];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=u.colspan,i.push(u),u.colspan>1&&(s+=u.colspan-1),l===o)break;if(l>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return un(this,ra)}},{key:"getColumnsCount",value:function(){return un(this,ra)>0?un(this,no)[0].length:0}},{key:"clear",value:function(){gc(this,no,[]),gc(this,ra,0)}}]),e}();function Wd(e){"@babel/helpers - typeof";return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wd(e)}function dL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function vL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dL(Object(r),!0).forEach(function(n){Vg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sY(n.key),n)}}function j2e(e,t,r){return t&&yL(e.prototype,t),r&&yL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vg(e,t,r){return t=sY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sY(e){var t=F2e(e,"string");return Wd(t)==="symbol"?t:String(t)}function F2e(e,t){if(Wd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B2e(e){return z2e(e)||U2e(e)||W2e(e)||V2e()}function V2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W2e(e,t){if(e){if(typeof e=="string")return WR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WR(e,t)}}function U2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function z2e(e){if(Array.isArray(e))return WR(e)}function WR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Y2e="DF-pre-order";function uY(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=uY.call(this.childs[n],e,t)}return r}var G2e="DF-post-order";function fY(e,t){for(var r=0;r<this.childs.length;r++){var n=fY.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var cY="BF";function K2e(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,B2e(o.childs)),e.call(t,o)!==!1&&n()}}n()}var q2e=cY,gL=new Map([[Y2e,uY],[G2e,fY],[cY,K2e]]),pL=function(){function e(t){L2e(this,e),Vg(this,"data",{}),Vg(this,"parent",null),Vg(this,"childs",[]),this.data=t}return j2e(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(vL({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=vL({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:q2e;if(!gL.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));gL.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var l=r.call(n,a);l!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function Ud(e){"@babel/helpers - typeof";return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}function mL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function bL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mL(Object(r),!0).forEach(function(n){X2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X2e(e,t,r){return t=hY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z2e(e,t){return tUe(e)||eUe(e,t)||J2e(e,t)||Q2e()}function Q2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J2e(e,t){if(e){if(typeof e=="string")return wL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wL(e,t)}}function wL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function tUe(e){if(Array.isArray(e))return e}function rUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hY(n.key),n)}}function nUe(e,t,r){return t&&SL(e.prototype,t),r&&SL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hY(e){var t=oUe(e,"string");return Ud(t)==="symbol"?t:String(t)}function oUe(e,t){if(Ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qS(e,t,r){iUe(e,t),t.set(e,r)}function iUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(e,t){var r=dY(e,t,"get");return aUe(e,r)}function aUe(e,t){return t.get?t.get.call(e):t.value}function lUe(e,t,r){var n=dY(e,t,"set");return sUe(e,n,r),r}function dY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function sUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Vl=new WeakMap,na=new WeakMap,Wl=new WeakMap,uUe=function(){function e(t){rUe(this,e),qS(this,Vl,{writable:!0,value:new Map}),qS(this,na,{writable:!0,value:new Map}),qS(this,Wl,{writable:!0,value:null}),lUe(this,Wl,t)}return nUe(e,[{key:"getRoots",value:function(){return Array.from(gr(this,Vl).values())}},{key:"getRootByColumn",value:function(r){var n;return gr(this,na).has(r)&&(n=gr(this,Vl).get(gr(this,na).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(o){var i=n-gr(this,na).get(n),a=0,l;return o.walkDown(function(s){var u=s.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return l=s,l.data.isRoot=n===l.data.columnIndex,!1;a+=f}}),l}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;gr(this,na).clear(),A(gr(this,Vl),function(o){for(var i=Z2e(o,2),a=i[1].data.colspan,l=n;l<n+a;l++)gr(r,na).set(l,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=gr(this,Wl).getColumnsCount(),n=0;n<r;){var o=gr(this,Wl).getHeaderSettings(0,n),i=new pL;gr(this,Vl).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,l=gr(this,Wl).getHeadersSettings(o,n,a);o+=1,A(l,function(s){var u=bL(bL({},s),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new pL(u),r.addChild(f)),o<gr(i,Wl).getLayersCount()&&i.buildLeaves(f,n,o,s.origColspan),n+=s.origColspan})}},{key:"clear",value:function(){gr(this,Vl).clear(),gr(this,na).clear()}}]),e}();function vY(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Jp(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function em(e){return Jp(e,"origColspan")===e.data.origColspan}function nk(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=em(e);if(n)return nk(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)A(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,vY(c,function(d){i.add(d)})});else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var f=1;f<s;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):em(c)&&(h.isCollapsed=Jp(c,"isCollapsed"))}),{rollbackModification:function(){return ok(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function ok(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=em(e);if(o)return ok(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)A(i,function(h){vY(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var l=r.origColspan,s=r.columnIndex,u=1;u<l;u++){var f=s+u;a.add(f)}var c=r.colspan-((t=Jp(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):em(h)&&(d.isCollapsed=Jp(h,"isCollapsed"))}),{rollbackModification:function(){return nk(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var CL;function fUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function cUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(CL||(CL=fUe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var _L;function hUe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function dUe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(dt(_L||(_L=hUe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var OL=new Map([["collapse",ok],["expand",nk],["hide-column",cUe],["show-column",dUe]]);function vUe(e,t,r){if(!OL.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return OL.get(e)(t,r)}var yUe=["crossHiddenColumns"];function gUe(e,t){if(e==null)return{};var r=pUe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pUe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Xy(e){var t=[];return A(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,l=o.headerLevel,s=o.crossHiddenColumns,u=bUe(t,l),f=!1,c=a;c<a+i;c++){var h=s.includes(c);if(h||f)u.push(iY());else{var d=mUe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function mUe(e){var t=BR(e);t.crossHiddenColumns;var r=gUe(t,yUe);return r}function bUe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}var wUe=["row"];function RL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function EL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RL(Object(r),!0).forEach(function(n){SUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SUe(e,t,r){return t=yY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CUe(e,t){if(e==null)return{};var r=_Ue(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Ue(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function OUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yY(n.key),n)}}function RUe(e,t,r){return t&&TL(e.prototype,t),r&&TL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yY(e){var t=EUe(e,"string");return zd(t)==="symbol"?t:String(t)}function EUe(e,t){if(zd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XS(e,t,r){TUe(e,t),t.set(e,r)}function TUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pc(e,t,r){var n=gY(e,t,"set");return PUe(e,n,r),r}function PUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Lt(e,t){var r=gY(e,t,"get");return kUe(e,r)}function gY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function kUe(e,t){return t.get?t.get.call(e):t.value}var xn=new WeakMap,Lr=new WeakMap,oa=new WeakMap,$Ue=function(){function e(){OUe(this,e),XS(this,xn,{writable:!0,value:new H2e}),XS(this,Lr,{writable:!0,value:new uUe(Lt(this,xn))}),XS(this,oa,{writable:!0,value:[[]]})}return RUe(e,[{key:"setState",value:function(r){Lt(this,xn).setData(r);var n=!1;try{Lt(this,Lr).buildTree()}catch{Lt(this,Lr).clear(),Lt(this,xn).clear(),n=!0}return pc(this,oa,Xy(Lt(this,Lr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Lt(this,xn).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=We(r,function(i){var a=i.row,l=CUe(i,wUe);return EL({row:a<0?n.rowCoordsToLevel(a):a},l)});Lt(this,xn).mergeWith(o),Lt(this,Lr).buildTree(),pc(this,oa,Xy(Lt(this,Lr).getRoots()))}},{key:"mapState",value:function(r){Lt(this,xn).map(r),Lt(this,Lr).buildTree(),pc(this,oa,Xy(Lt(this,Lr).getRoots()))}},{key:"mapNodes",value:function(r){return Ft(Lt(this,Lr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Lt(this,Lr).getNode(n,o),a;return i&&(a=vUe(r,i,o),pc(this,oa,Xy(Lt(this,Lr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(o=(i=Lt(this,oa)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var o=Lt(this,Lr).getNode(r,n);return o?EL({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var l=n-1;l>=0;){var s,u=(s=this.getHeaderSettings(r,l))!==null&&s!==void 0?s:{isRoot:!0},f=u.isRoot;if(f)break;l-=1}return l}},{key:"getLayersCount",value:function(){return Lt(this,xn).getLayersCount()}},{key:"getColumnsCount",value:function(){return Lt(this,xn).getColumnsCount()}},{key:"clear",value:function(){pc(this,oa,[]),Lt(this,xn).clear(),Lt(this,Lr).clear()}}]),e}();function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}function AUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pY(n.key),n)}}function IUe(e,t,r){return t&&PL(e.prototype,t),r&&PL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mc(e,t,r){return t=pY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pY(e){var t=MUe(e,"string");return Yd(t)==="symbol"?t:String(t)}function MUe(e,t){if(Yd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xUe=function(){function e(t,r){AUe(this,e),mc(this,"hot",void 0),mc(this,"nestedHeaderSettingsGetter",void 0),mc(this,"layersCount",0),mc(this,"container",void 0),mc(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return IUe(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var o=0;o<n;o++){var i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),a=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(a,r[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,o=n.rootDocument,i=n.columnIndexMapper,a=o.createDocumentFragment(),l=o.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=o.createElement("tr"),h=0;h<u;h++){var d=i.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=o.createElement("th"),y=this.nestedHeaderSettingsGetter(f,d);if(y&&(!y.isPlaceholder||y.isHidden)){var m=y.label;s&&(m+='<button class="changeType"></button>'),fl(v,m),v.colSpan=y.colspan,c.appendChild(v)}}l.appendChild(c)}a.appendChild(l),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const DUe=xUe;function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}var kL,$L;function AL(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function NUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mY(n.key),n)}}function HUe(e,t,r){return t&&IL(e.prototype,t),r&&IL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ma(){return typeof Reflect<"u"&&Reflect.get?Ma=Reflect.get.bind():Ma=function(t,r,n){var o=LUe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ma.apply(this,arguments)}function LUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mo(e),e!==null););return e}function jUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UR(e,t)}function UR(e,t){return UR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},UR(e,t)}function FUe(e){var t=VUe();return function(){var n=Mo(e),o;if(t){var i=Mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return BUe(this,o)}}function BUe(e,t){if(t&&(hf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rc(e)}function Rc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mo(e)}function ML(e,t,r){return t=mY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mY(e){var t=WUe(e,"string");return hf(t)==="symbol"?t:String(t)}function WUe(e,t){if(hf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xL(e,t,r){UUe(e,t),t.set(e,r)}function UUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zy(e,t,r){var n=bY(e,t,"set");return zUe(e,n,r),r}function zUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function $t(e,t){var r=bY(e,t,"get");return YUe(e,r)}function bY(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function YUe(e,t){return t.get?t.get.call(e):t.value}var DL="nestedHeaders",GUe=280,Vt=new WeakMap,ai=new WeakMap,KUe=function(e){jUe(r,e);var t=FUe(r);function r(){var n;NUe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),xL(Rc(n),Vt,{writable:!0,value:new $Ue}),xL(Rc(n),ai,{writable:!0,value:null}),ML(Rc(n),"ghostTable",new DUe(n.hot,function(l,s){return n.getHeaderSettings(l,s)})),ML(Rc(n),"detectedOverlappedHeaders",!1),n}return HUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DL]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&wt(dt(kL||(kL=AL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(l){return o.onAfterGetColumnHeaderRenderers(l)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return o.onModifyColumnHeaderValue.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("beforeCopy",function(){return o.onBeforeCopy.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),Ma(Mo(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;$t(this,Vt).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=$t(this,Vt).setState(a)),this.detectedOverlappedHeaders&&wt(dt($L||($L=AL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(l,s){var u=l===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(u,s)}),!$t(this,ai)&&this.enabled&&Zy(this,ai,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(l){l.forEach(function(s){var u=s.op,f=s.index,c=s.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";$t(o,Vt).triggerColumnModification(h,f)}}),o.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Ma(Mo(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),$t(this,Vt).clear(),$t(this,ai).unsubscribe(),Zy(this,ai,null),this.ghostTable.clear(),Ma(Mo(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return $t(this,Vt)}},{key:"getLayersCount",value:function(){return $t(this,Vt).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return $t(this,Vt).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var o=this.hot.view._wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,l=o.wtOverlays.topOverlay.clone.wtTable.THEAD,s=o.wtOverlays.topInlineStartCornerOverlay?o.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=l.childNodes[u],h=s?s.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Le(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Le(c.childNodes[d],"hiddenHeader")),s&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Le(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(l,s){var u,f=i.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(l);d===null&&(d=l),s.removeAttribute("colspan"),Le(s,"hiddenHeader");var v=(u=$t(i,Vt).getHeaderSettings(o,d))!==null&&u!==void 0?u:{label:""},y=v.colspan,m=v.isHidden,w=v.isPlaceholder;if(w||m)te(s,"hiddenHeader");else if(y>1){var S,C,k=h._wt.wtOverlays,_=(S=k.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),N=(C=k.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(s),V=_||N?Math.min(y,a-l):y;V>1&&s.setAttribute("colspan",V)}i.hot.view.appendColHeader(d,s,function(){return i.getColumnHeaderValue.apply(i,arguments)},o)}}},{key:"getColumnHeaderValue",value:function(o,i){var a,l=(a=$t(this,Vt).getHeaderSettings(i,o))!==null&&a!==void 0?a:{},s=l.isHidden,u=l.isPlaceholder;return u||s?"":this.hot.getColHeader(o,i)}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var l=$t(this,Vt).getHeaderTreeNodeData(i,o);if(!l)return o;var s=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=$t(this,Vt).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===Fv){if(!d)return l.columnIndex}else f===cb&&(v>c-u||!d)&&(s.length=0);return o}},{key:"onBeforeCopy",value:function(o,i,a){var l=a.columnHeadersCount;if(l!==0)for(var s=0;s<i.length;s++){var u=i[s],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,y=c-d+1;if(f>=0||y===1)break;for(var m=c;m<=d;m++)for(var w=f;w<=h;w++){var S,C=v+w,k=m-c;if(k!==0){var _=(S=$t(this,Vt).getHeaderTreeNodeData(w,m))===null||S===void 0?void 0:S.isRoot;_===!1&&(o[C][k]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,l){var s=this._getHeaderTreeNodeDataByCoords(i);s&&(l.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(a){var l=this.hot.selection,s=l.isSelected()?l.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!l.inInSelection(i);o.shiftKey&&s?i.col<s.from.col?u.push(s.getTopEndCorner().col,f,i.row):i.col>s.from.col?u.push(s.getTopStartCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):(Vm(o)||$i(o)&&h)&&u.push(f,f+c-1,i.row),l.selectColumns.apply(l,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,l){var s;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),y=h.from;l.column=!0,l.cell=!0;var m=[];i.col<y.col?m.push(v.col,f):i.col>y.col?m.push(d.col,f+c-1):m.push(f,f+c-1),(s=this.hot).selectColumns.apply(s,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){o.length=0;for(var i=0;i<$t(this,Vt).getLayersCount();i++)o.push(this.headerRendererFactory(i))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=$t(this,Vt).getLayersCount(),a=o.startColumn,l=!!i,s=0;s<i;s++){var u=$t(this,Vt).findLeftMostColumnIndex(s,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(l=!1),wr(f)&&f<o.startColumn){a=f;break}}o.startColumn=l?$t(this,Vt).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.getWidth(i);return o>a?o:a}},{key:"onModifyColumnHeaderValue",value:function(o,i,a){var l,s=(l=$t(this,Vt).getHeaderTreeNodeData(a,i))!==null&&l!==void 0?l:{label:""},u=s.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Zy(this,Vt,null),$t(this,ai)!==null&&($t(this,ai).unsubscribe(),Zy(this,ai,null)),Ma(Mo(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return $t(this,Vt).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return DL}},{key:"PLUGIN_PRIORITY",get:function(){return GUe}}]),r}(ot);function NL(e){return QUe(e)||ZUe(e)||XUe(e)||qUe()}function qUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XUe(e,t){if(e){if(typeof e=="string")return zR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zR(e,t)}}function ZUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QUe(e){if(Array.isArray(e))return zR(e)}function zR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}function JUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tze(n.key),n)}}function eze(e,t,r){return t&&HL(e.prototype,t),r&&HL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tze(e){var t=rze(e,"string");return df(t)==="symbol"?t:String(t)}function rze(e,t){if(df(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nze=function(){function e(t,r){JUe(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return eze(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&A(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,l=!1,s=n;if(isNaN(s)&&s.end)return s;var u=r;return u||(u={__children:this.data},l=!0,s-=1),o!=null&&s===o?{result:u,end:!0}:i!=null&&u===i?{result:s,end:!0}:(s+=1,u.__children&&A(u.__children,function(f){if(a.parentReference.set(f,l?null:u),s=a.readTreeNodes(f,s,o,i),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return ze(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(A(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||df(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var l=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(l,1),this.hot.runHooks("afterCreateRow",l,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var l=this.getRowIndex(r),s=l+n+1;this.hot.runHooks("beforeCreateRow",s,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),a=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Ce(r[0],r[2],function(w){var S=n.translateTrimmedRow(w);a.push(n.getDataObject(S))}),Ce(0,a.length-2,function(w){n.detachFromParent(a[w],!1)}),i=a[a.length-1]):i=r;var l=this.getRowIndex(i),s=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(l+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",l,s+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",l,s+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),m=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];A(o,function(l){a.push(i.getDataObject(l))}),A(a,function(l){var s=i.getRowIndexWithinParent(l),u=i.getRowParent(l);u===null?i.data.splice(s,1):u.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,l=r;if(i&&i.__children&&i.__children.length===0?(a=i,l=0):r<this.countAllRows()&&(a=this.getRowParent(r),l=this.getRowIndexWithinParent(r)),a)if(o){var s;(s=a.__children).splice.apply(s,[l,n].concat(NL(o)))}else a.__children.splice(l,n);else if(o){var u;(u=this.data).splice.apply(u,[l,n].concat(NL(o)))}else this.data.splice(l,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),l=this.getRowParent(r),s=this.getRowIndexWithinParent(r),u=l.__children.slice(s,s+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=l===c;c.__children.splice(h,0,u[0]),l.__children.splice(s+(f&&d?1:0),1),this.syncRowWithRawSource(l),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const oze=nze;function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}function LL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aze(n.key),n)}}function ize(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aze(e){var t=lze(e,"string");return Gd(t)==="symbol"?t:String(t)}function lze(e,t){if(Gd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var uze=ize(function e(t,r){sze(this,e),this.hot=r,this.plugin=t});const ik=uze;function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function fze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hze(n.key),n)}}function cze(e,t,r){return t&&jL(e.prototype,t),r&&jL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hze(e){var t=dze(e,"string");return vf(t)==="symbol"?t:String(t)}function dze(e,t){if(vf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YR(e,t)}function YR(e,t){return YR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},YR(e,t)}function yze(e){var t=mze();return function(){var n=tm(e),o;if(t){var i=tm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return gze(this,o)}}function gze(e,t){if(t&&(vf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pze(e)}function pze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tm(e)}var bze=function(e){vze(r,e);var t=yze(r);function r(n,o){var i;return fze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return cze(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),l=this.dataManager.getRowLevel(a),s=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(A(c,function(y){y&&u.removeChild(y)}),te(i,r.CSS_CLASSES.indicatorContainer),l){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Ce(0,l-1,function(){var y=h.createElement("SPAN");te(y,r.CSS_CLASSES.emptyIndicator),u.appendChild(y)}),u.appendChild(d)}if(this.dataManager.hasChildren(s)){var v=this.hot.rootDocument.createElement("DIV");te(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):te(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(ik);const wY=bze;function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function FL(e){return _ze(e)||Cze(e)||Sze(e)||wze()}function wze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sze(e,t){if(e){if(typeof e=="string")return GR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GR(e,t)}}function Cze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _ze(e){if(Array.isArray(e))return GR(e)}function GR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eze(n.key),n)}}function Rze(e,t,r){return t&&BL(e.prototype,t),r&&BL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eze(e){var t=Tze(e,"string");return yf(t)==="symbol"?t:String(t)}function Tze(e,t){if(yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KR(e,t)}function KR(e,t){return KR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},KR(e,t)}function kze(e){var t=Ize();return function(){var n=rm(e),o;if(t){var i=rm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ze(this,o)}}function $ze(e,t){if(t&&(yf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aze(e)}function Aze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ize(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rm(e){return rm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rm(e)}var Mze=function(e){Pze(r,e);var t=kze(r);function r(n,o){var i;return Oze(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,l)},shiftStash:function(l,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),A(i.lastCollapsedRows,function(f,c){f>=l&&f<s&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,l),i.lastCollapsedRows=void 0},trimStash:function(l,s){Ce(l,l+s-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return Rze(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&A(u.__children,function(h){s.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(s,!0,!1),l&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,FL(i.collapseChildren(u,!1,!1)))}),l&&this.trimRows(s),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.collapseChildRows(u,s)}),l&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}l&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return A(o,function(u){s.push(u),a&&i.expandChildRows(u,s)}),l&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var s=this.dataManager.getDataObject(o);A(s.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}l&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&A(u.__children,function(h){var d=i.dataManager.getRowIndex(h);s.push(d)}),c=this.expandRows(s,!0,!1),l&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];A(o,function(u){s.push.apply(s,FL(i.expandChildren(u,!1,!1)))}),l&&this.untrimRows(s),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];A(i,function(l){o.dataManager.hasChildren(l)&&a.push(l)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){A(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),l=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&A(a.__children,function(s){var u=i.dataManager.getRowIndex(s);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return l=!1,!1}),l}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);xe(o.target,wY.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),wn(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(ik);const xze=Mze;function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function Dze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hze(n.key),n)}}function Nze(e,t,r){return t&&VL(e.prototype,t),r&&VL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hze(e){var t=Lze(e,"string");return gf(t)==="symbol"?t:String(t)}function Lze(e,t){if(gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qR(e,t)}function qR(e,t){return qR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qR(e,t)}function Fze(e){var t=Vze();return function(){var n=nm(e),o;if(t){var i=nm(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bze(this,o)}}function Bze(e,t){if(t&&(gf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SY(e)}function SY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nm(e){return nm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nm(e)}var WL=new WeakMap,Wze=function(e){jze(r,e);var t=Fze(r);function r(n,o){var i;return Dze(this,r),i=t.call(this,n,o),WL.set(SY(i),{row_above:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(l,s){var u=s[s.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return Nze(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(aP)},callback:function(){var s=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(s);i.dataManager.addChild(u)},disabled:function(){var s=i.hot.getSelectedLast();return!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(lP)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var s=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(s[0]),f=i.dataManager.getRowParent(u);return!f||!s||s[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,o.items.length-1,function(l){if(l===0)return A(a,function(s,u){o.items.splice(l+u,0,s)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=WL.get(this);return Ce(0,o.items.length-1,function(a){var l=i[o.items[a].key];l!=null&&(o.items[a].callback=l)}),o}}]),r}(ik);const Uze=Wze;function Kd(e){"@babel/helpers - typeof";return Kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kd(e)}var UL;function zL(e){return Kze(e)||Gze(e)||Yze(e)||zze()}function zze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yze(e,t){if(e){if(typeof e=="string")return XR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XR(e,t)}}function Gze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kze(e){if(Array.isArray(e))return XR(e)}function XR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qze(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Xze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qze(n.key),n)}}function Zze(e,t,r){return t&&YL(e.prototype,t),r&&YL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qze(e){var t=Jze(e,"string");return Kd(t)==="symbol"?t:String(t)}function Jze(e,t){if(Kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eYe=function(){function e(t){Xze(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return Zze(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,l=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(l)return!1;this.movedToCollapsed=!1;var s=o===this.hot.countRows(),u=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(m){if(!f)return!1;var w=a.dataManager.translateTrimmedRow(m);return f=a.shouldAllowMoving(w,u),w}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(s,u),y=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,y),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,l=!1;return bt(i)&&(wt(dt(UL||(UL=qze([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,zL(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(l){i.dataManager.moveRow(l,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],l=Math.max.apply(Math,zL(r))<n;r.forEach(function(s){a.push(o.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(l?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,l=null,s=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);l=this.hot.selection,s=this.hot.countCols()-1,l.setRangeStart(this.hot._createCellCoords(i,0)),l.setRangeEnd(this.hot._createCellCoords(a,s),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function tYe(e){return iYe(e)||oYe(e)||nYe(e)||rYe()}function rYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nYe(e,t){if(e){if(typeof e=="string")return ZR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZR(e,t)}}function oYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iYe(e){if(Array.isArray(e))return ZR(e)}function ZR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sYe(n.key),n)}}function lYe(e,t,r){return t&&GL(e.prototype,t),r&&GL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sYe(e){var t=uYe(e,"string");return pf(t)==="symbol"?t:String(t)}function uYe(e,t){if(pf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xa(){return typeof Reflect<"u"&&Reflect.get?xa=Reflect.get.bind():xa=function(t,r,n){var o=fYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xa.apply(this,arguments)}function fYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xo(e),e!==null););return e}function cYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QR(e,t)}function QR(e,t){return QR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},QR(e,t)}function hYe(e){var t=vYe();return function(){var n=xo(e),o;if(t){var i=xo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dYe(this,o)}}function dYe(e,t){if(t&&(pf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CY(e)}function CY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xo(e){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xo(e)}var ZS="nestedRows",yYe=300,oo=new WeakMap,gYe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",pYe=function(e){cYe(r,e);var t=hYe(r);function r(n){var o;return aYe(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,oo.set(CY(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return lYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ZS]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Dv),this.dataManager=new oze(this,this.hot),this.collapsingUI=new xze(this,this.hot),this.headersUI=new wY(this,this.hot),this.contextMenuUI=new Uze(this,this.hot),this.rowMoveController=new eYe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),this.addHook("beforeUpdateData",function(i){return o.onBeforeLoadData(i)}),xa(xo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),xa(xo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),xa(xo(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,l){return this.rowMoveController.onBeforeRowMove(o,i,a,l)}},{key:"disableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=oo.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=oo.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=oo.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var l=oo.get(this);return l.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var l=oo.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),l.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,l){var s=this;if(l!==this.pluginName){var u=oo.get(this);setTimeout(function(){u.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var l=this,s=Array.from(a.reduce(function(u,f){if(l.dataManager.isParent(f)){var c=l.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(l.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,tYe(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=oo.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){xa(xo(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!EU(o)){DE(gYe),this.hot.getSettings()[ZS]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return ZS}},{key:"PLUGIN_PRIORITY",get:function(){return yYe}}]),r}(ot);function qd(e){"@babel/helpers - typeof";return qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qd(e)}function mYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wYe(n.key),n)}}function bYe(e,t,r){return t&&KL(e.prototype,t),r&&KL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wYe(e){var t=SYe(e,"string");return qd(t)==="symbol"?t:String(t)}function SYe(e,t){if(qd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CYe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;mYe(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return bYe(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r>"u"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;A(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const _Ye=CYe;function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function OYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EYe(n.key),n)}}function RYe(e,t,r){return t&&qL(e.prototype,t),r&&qL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EYe(e){var t=TYe(e,"string");return mf(t)==="symbol"?t:String(t)}function TYe(e,t){if(mf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Da(){return typeof Reflect<"u"&&Reflect.get?Da=Reflect.get.bind():Da=function(t,r,n){var o=PYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Da.apply(this,arguments)}function PYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Do(e),e!==null););return e}function kYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JR(e,t)}function JR(e,t){return JR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},JR(e,t)}function $Ye(e){var t=MYe();return function(){var n=Do(e),o;if(t){var i=Do(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return AYe(this,o)}}function AYe(e,t){if(t&&(mf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IYe(e)}function IYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Do(e){return Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Do(e)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");var XL="persistentState",xYe=0,DYe=function(e){kYe(r,e);var t=$Ye(r);function r(n){var o;return OYe(this,r),o=t.call(this,n),o.storage=void 0,o}return RYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[XL]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new _Ye(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Da(Do(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Da(Do(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Da(Do(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o>"u"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Da(Do(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return XL}},{key:"PLUGIN_PRIORITY",get:function(){return xYe}}]),r}(ot);function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function NYe(e){return FYe(e)||jYe(e)||LYe(e)||HYe()}function HYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LYe(e,t){if(e){if(typeof e=="string")return e0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e0(e,t)}}function jYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FYe(e){if(Array.isArray(e))return e0(e)}function e0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WYe(n.key),n)}}function VYe(e,t,r){return t&&ZL(e.prototype,t),r&&ZL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WYe(e){var t=UYe(e,"string");return bf(t)==="symbol"?t:String(t)}function UYe(e,t){if(bf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Na(){return typeof Reflect<"u"&&Reflect.get?Na=Reflect.get.bind():Na=function(t,r,n){var o=zYe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Na.apply(this,arguments)}function zYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=No(e),e!==null););return e}function YYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t0(e,t)}function t0(e,t){return t0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},t0(e,t)}function GYe(e){var t=XYe();return function(){var n=No(e),o;if(t){var i=No(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return KYe(this,o)}}function KYe(e,t){if(t&&(bf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qYe(e)}function qYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function No(e){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},No(e)}var QS="search",ZYe=190,QYe="htSearchResult",JYe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},eGe=function(t,r,n){return bt(t)||t===null||!t.toLocaleLowerCase||t.length===0||bt(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},tGe=function(e){YYe(r,e);var t=GYe(r);function r(n){var o;return BYe(this,r),o=t.call(this,n),o.callback=JYe,o.queryMethod=eGe,o.searchResultClass=QYe,o}return VYe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[QS]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[QS];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),Na(No(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),Na(No(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Na(No(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Ce(0,s-1,function(h){Ce(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),y=i.hot.getCellMeta(h,d),m=y.search.callback||a,w=y.search.queryMethod||l,S=w(o,v,y);if(S){var C={row:h,col:d,data:v};f.push(C)}m&&m(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ue(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,l,s,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,NYe(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){Na(No(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return QS}},{key:"PLUGIN_PRIORITY",get:function(){return ZYe}}]),r}(ot);function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function rGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oGe(n.key),n)}}function nGe(e,t,r){return t&&QL(e.prototype,t),r&&QL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oGe(e){var t=iGe(e,"string");return wf(t)==="symbol"?t:String(t)}function iGe(e,t){if(wf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ds(){return typeof Reflect<"u"&&Reflect.get?ds=Reflect.get.bind():ds=function(t,r,n){var o=aGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ds.apply(this,arguments)}function aGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ki(e),e!==null););return e}function lGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r0(e,t)}function r0(e,t){return r0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},r0(e,t)}function sGe(e){var t=cGe();return function(){var n=ki(e),o;if(t){var i=ki(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return uGe(this,o)}}function uGe(e,t){if(t&&(wf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fGe(e)}function fGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ki(e){return ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ki(e)}var hGe="touchScroll",dGe=200,vGe=function(e){lGe(r,e);var t=sGe(r);function r(n){var o;return rGe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return nGe(r,[{key:"isEnabled",value:function(){return TE()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),ds(ki(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,ds(ki(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ds(ki(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view._wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,l=o.inlineStartOverlay,s=o.topInlineStartCornerOverlay,u=o.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(l),s&&this.scrollbars.push(s),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),l.needFullRender&&this.clones.push(l.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,A(this.clones,function(o){te(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,A(this.clones,function(i){Le(i,"hide-tween"),te(i,"show-tween")}),this.hot._registerTimeout(function(){A(o.clones,function(i){Le(i,"show-tween")})},400),A(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return hGe}},{key:"PLUGIN_PRIORITY",get:function(){return dGe}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(ot);function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function yGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JL(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pGe(n.key),n)}}function gGe(e,t,r){return t&&JL(e.prototype,t),r&&JL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pGe(e){var t=mGe(e,"string");return Sf(t)==="symbol"?t:String(t)}function mGe(e,t){if(Sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ha(){return typeof Reflect<"u"&&Reflect.get?Ha=Reflect.get.bind():Ha=function(t,r,n){var o=bGe(t,r);if(o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ha.apply(this,arguments)}function bGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ho(e),e!==null););return e}function wGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n0(e,t)}function n0(e,t){return n0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},n0(e,t)}function SGe(e){var t=OGe();return function(){var n=Ho(e),o;if(t){var i=Ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CGe(this,o)}}function CGe(e,t){if(t&&(Sf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ge(e)}function _Ge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ho(e){return Ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ho(e)}var Qy="trimRows",RGe=330,EGe=function(e){wGe(r,e);var t=SGe(r);function r(n){var o;return yGe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return gGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Qy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Dv),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Ha(Ho(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[Qy];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Ha(Ho(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Ha(Ho(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),l=this.isValidConfig(o),s=a;l&&(s=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,s,l);u!==!1&&(l&&this.hot.batchExecution(function(){A(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,s,l,l&&s.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),l=i,s=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(A(o,function(c){s[c]=!1}),l=Ft(s,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,l,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",i,l,a&&u,a&&l.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[Qy];Array.isArray(i)&&this.hot.batchExecution(function(){A(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Ha(Ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Qy}},{key:"PLUGIN_PRIORITY",get:function(){return RGe}}]),r}(ot);function Cf(e){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(e)}function _Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ej(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TGe(n.key),n)}}function OY(e,t,r){return t&&ej(e.prototype,t),r&&ej(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TGe(e){var t=PGe(e,"string");return Cf(t)==="symbol"?t:String(t)}function PGe(e,t){if(Cf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o0(e,t)}function o0(e,t){return o0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o0(e,t)}function EY(e){var t=AGe();return function(){var n=om(e),o;if(t){var i=om(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kGe(this,o)}}function kGe(e,t){if(t&&(Cf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ge(e)}function $Ge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function om(e){return om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},om(e)}function IGe(e){return DGe(e)||xGe(e)||PY(e)||MGe()}function MGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DGe(e){if(Array.isArray(e))return i0(e)}function TY(e,t){return LGe(e)||HGe(e,t)||PY(e,t)||NGe()}function NGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PY(e,t){if(e){if(typeof e=="string")return i0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i0(e,t)}}function i0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(f){u=!0,o=f}finally{try{if(!s&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function LGe(e){if(Array.isArray(e))return e}var kY="undoRedo",jGe="undoRedo";function ye(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(s){var u=TY(s,4),f=u[2],c=u[3];return f!==c});if(a){var l=function(){var u=r.reduce(function(c,h){return c.push(IGe(h)),c},[]);A(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new ye.ChangeAction(u,f)};t.done(l,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new ye.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=e.toPhysicalRow(r),u=fr(t.instance.getSourceData(s,0,s+n-1,t.instance.countSourceCols()-1));return new ye.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new ye.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Ce(s.length-1,function(y){var m=[],w=s[y];Ce(u,u+(n-1),function(S){m.push(w[e.toPhysicalColumn(S)])}),f.push(m)}),Ce(n-1,function(y){h.push(e.toPhysicalColumn(u+y))}),Array.isArray(e.getSettings().colHeaders)&&Ce(n-1,function(y){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+y)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ye.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new ye.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ye.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ye.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ye.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ye.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ye.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};ye.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ye.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=fr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ye.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ye.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ye.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ye.prototype.isEnabled=function(){return this.enabled};ye.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,VGe(e),this.registerShortcuts(),e.addHook("afterChange",$Y)}};ye.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,WGe(e),this.unregisterShortcuts(),e.removeHook("afterChange",$Y)}};ye.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ye.Action=function(){};ye.Action.prototype.undo=function(){};ye.Action.prototype.redo=function(){};ye.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Ko(ye.ChangeAction,ye.Action);ye.ChangeAction.prototype.undo=function(e,t){for(var r=fr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var l=0,s=r.length;l<s;l++){var u=TY(r[l],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ye.ChangeAction.prototype.redo=function(e,t){for(var r=fr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ye.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Ko(ye.CreateRowAction,ye.Action);ye.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ye.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ye.RemoveRowAction=function(e,t,r,n,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Ko(ye.RemoveRowAction,ye.Action);ye.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(l){var s=parseInt(l,10);o.push([r.index+a,isNaN(s)?l:s,i[l]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ye.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ye.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Ko(ye.CreateColumnAction,ye.Action);ye.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ye.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ye.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Ko(ye.RemoveColumnAction,ye.Action);ye.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(We(this.data[s],i));var u=We(this.headers,i),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(e.getSourceDataArray(),function(c,h){A(o,function(d,v){c[d]=l[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&A(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ye.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ye.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ye.CellAlignmentAction.prototype.undo=function(e,t){var r=this;A(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ye.CellAlignmentAction.prototype.redo=function(e,t){si(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};ye.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Ko(ye.FiltersAction,ye.Action);ye.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ye.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var FGe=function(e){RY(r,e);var t=EY(r);function r(n,o){var i;_Y(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),l=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,l.row,l.col),i}return OY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var l=this.cellRange.getTopStartCorner();o.populateFromArray(l.row,l.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(ye.Action);ye.MergeCellsAction=FGe;var BGe=function(e){RY(r,e);var t=EY(r);function r(n,o){var i;return _Y(this,r),i=t.call(this),i.cellRange=o,i}return OY(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(ye.Action);ye.UnmergeCellsAction=BGe;ye.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Ko(ye.RowMoveAction,ye.Action);ye.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),l=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);n.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ye.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ye.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ye.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(a){return!a.altKey},o={runOnlyIf:n,group:kY};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)};ye.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(kY)};function $Y(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function VGe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function WGe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Vv=ge.getSingleton();Vv.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Vv.register("beforeUndo");Vv.register("afterUndo");Vv.register("beforeRedo");Vv.register("afterRedo");ye.PLUGIN_KEY=jGe;ye.SETTING_KEYS=!0;function UGe(){rt(JSe),rt(_Ce),rt(BCe),rt(x_e),rt(J_e),rt(eU),rt(BRe),rt(C0e),rt(ez),rt(BAe),rt(vIe),rt(RIe),rt(hz),rt(kMe),rt(RLe),rt(Rje),rt(Xje),rt(SFe),rt(UFe),rt(IBe),rt(WBe),rt(AVe),rt(VVe),rt(FWe),rt(l2e),rt(w2e),rt(KUe),rt(pYe),rt(DYe),rt(tGe),rt(vGe),rt(EGe),rt(ye)}function AY(){Ffe(),oce(),_ce(),Uce(),UGe()}var zGe=$e,YGe=je,GGe=dm.f,KGe=YGe(function(){return!Object.getOwnPropertyNames(1)});zGe({target:"Object",stat:!0,forced:KGe},{getOwnPropertyNames:GGe});cn(DW);Te.editors={BaseEditor:Mf};function Te(e,t){var r=new KP(e,t||{},WP);return r.init(),r}Te.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new KP(e,t,WP)};Te.DefaultSettings=WU();Te.hooks=ge.getSingleton();Te.CellCoords=cp;Te.CellRange=oT;Te.packageName="handsontable";Te.buildDate="22/06/2023 12:51:08";Te.version="13.0.0";Te.languages={dictionaryKeys:h0e,getLanguageDictionary:MU,getLanguagesDictionaries:hPe,registerLanguageDictionary:IU,getTranslatedPhrase:xU};function qGe(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]<"u"){for(var l,s=arguments.length,u=new Array(s>1?s-1:0),f=1;f<s;f++)u[f-1]=arguments[f];a=(l=o[r]).call.apply(l,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var JS,eC,tC,rC,nC;AY();qGe(Te);Te.__GhostTable=rT;Te._getListenersCounter=Xle;Te._getRegisteredMapsCounter=rSe;Te.EventManager=kt;var XGe=[Loe,cie,zTe,vce,Zie,Ple,Voe,Ase,lie,Pae,vie,CTe],ZGe=[jae,yie];Te.helper={};Te.dom={};A(XGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.helper[t]=e[t])})});A(ZGe,function(e){A(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Te.dom[t]=e[t])})});Te.cellTypes=(JS=Te.cellTypes)!==null&&JS!==void 0?JS:{};A(Wce(),function(e){Te.cellTypes[e]=JE(e)});Te.cellTypes.registerCellType=cn;Te.cellTypes.getCellType=JE;Te.editors=(eC=Te.editors)!==null&&eC!==void 0?eC:{};A(Vle(),function(e){Te.editors["".concat(ur(e),"Editor")]=ip(e)});Te.editors.registerEditor=Pr;Te.editors.getEditor=ip;Te.renderers=(tC=Te.renderers)!==null&&tC!==void 0?tC:{};A(nce(),function(e){var t=fp(e);e==="base"&&(Te.renderers.cellDecorator=t),Te.renderers["".concat(ur(e),"Renderer")]=t});Te.renderers.registerRenderer=Hn;Te.renderers.getRenderer=fp;Te.validators=(rC=Te.validators)!==null&&rC!==void 0?rC:{};A(Cce(),function(e){Te.validators["".concat(ur(e),"Validator")]=QE(e)});Te.validators.registerValidator=Zl;Te.validators.getValidator=QE;Te.plugins=(nC=Te.plugins)!==null&&nC!==void 0?nC:{};A(tT(),function(e){Te.plugins[e]=Iv(e)});Te.plugins["".concat(ur(ot.PLUGIN_KEY),"Plugin")]=ot;Te.plugins.registerPlugin=rt;Te.plugins.getPlugin=Iv;const tj="selected",rj="odd",QGe=(e,t,r,n,o,i)=>{if(r!==0)return;const a=e.parentElement;if(a===null)return;i.instance.getSourceDataAtRow(t).checked?Te.dom.addClass(a,tj):Te.dom.removeClass(a,tj),t%2===0?Te.dom.addClass(a,rj):Te.dom.removeClass(a,rj)},JGe=function(t,r){const n=document.createElement("input"),o=this.getSourceDataAtRow(t);n.type="checkbox",n.checked=!!o.checked,Te.dom.empty(r),r.appendChild(n)};function e3e(e,t,r){if(t<0||!r.firstChild)return;const n=e.isRtl()?"htRight":"htLeft";Te.dom.addClass(r.firstChild,n)}const t3e=function(t,r){const n=t.target;r.col===-1&&t.target&&n.nodeName==="INPUT"&&(t.preventDefault(),this.setSourceDataAtCell(r.row,"checked",!n.checked))},r3e=(...e)=>{const[t,r,n,o,i,a,l]=e;xf(...e),a?r.innerHTML='<div class="circle critical"></div>':r.innerHTML='<div class="circle"></div>'};var vs=Symbol("unassigned"),n3e="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function im(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function IY(e){var t=Te.hooks.getRegistered(),r={};Object.assign(r,Te.DefaultSettings);for(var n in r)r[n]={default:vs};for(var o=0;o<t.length;o++)r[t[o]]={default:vs};return r.settings={default:vs},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function MY(e){var t={},r=e.settings;if(r!==vs)for(var n in r)im(r,n)&&r[n]!==vs&&(t[n]=r[n]);for(var o in e)im(e,o)&&o!=="settings"&&e[o]!==vs&&(t[o]=e[o]);return t}function nj(e,t){var r=MY(e),n=e.settings?e.settings:r,o=e.settings?r:null,i={};for(var a in n)im(n,a)&&n[a]!==void 0&&(!(t&&a!=="data")||!oj(t[a],n[a]))&&(i[a]=n[a]);for(var l in o)im(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(t&&l!=="data")||!oj(t[l],o[l]))&&(i[l]=o[l]);return i}function oj(e,t){return JSON.stringify(e)===JSON.stringify(t)}var o3e="13.0.0",ak=lj({name:"HotTable",props:IY("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=nj(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(n3e),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=nj(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=LY(new Te.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(r&&r.length!==i&&r.length<i)for(var s=r.length;s<i;s++)n.push(s);if(a){var u;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==l&&r[0].length<l)for(var f=r[0].length;f<l;f++)o.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,r.length-i),a&&r.length!==0&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,r[0].length-l))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:o3e}),i3e=["id"];function a3e(e,t,r,n,o,i){return ua(),Jl("div",{id:e.id},[jY(e.$slots,"default")],8,i3e)}ak.render=a3e;ak.__file="src/HotTable.vue";function ij(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function l3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ij(Object(r),!0).forEach(function(n){s3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ij(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s3e(e,t,r){return t=f3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u3e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f3e(e){var t=u3e(e,"string");return typeof t=="symbol"?t:String(t)}var At=lj({name:"HotColumn",props:IY("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=MY(this.$props),r=l3e({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});At.__file="src/HotColumn.vue";const oC={__name:"Table",props:["tableOptions"],setup(e){const t=e;AY();const r=ia(()=>e3e),n=ia(()=>QGe),o=ia(()=>JGe),i=ia(()=>t3e),a=ia(()=>t.tableOptions.data),l=ia(()=>r3e);return FY(()=>{}),(s,u)=>(ua(),BY(ft(ak),{data:a.value,style:{width:"100%"},height:400,colWidths:e.tableOptions.colWidths,colHeaders:e.tableOptions.colHeaders,dropdownMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:r.value,beforeRenderer:n.value,afterGetRowHeader:o.value,afterOnCellMouseDown:i.value,manualRowMove:!0,readOnly:!0,licenseKey:"non-commercial-and-evaluation"},{default:Dn(()=>[e.tableOptions.tableName=="one"?(ua(),Jl(eg,{key:0},[Je(ft(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),Je(ft(At),{data:"Code"}),Je(ft(At),{data:"Name"}),Je(ft(At),{data:"Duration(Baseline)"}),Je(ft(At),{data:"Duration(New)"}),Je(ft(At),{data:"Ratio"})],64)):wb("",!0),e.tableOptions.tableName=="two"?(ua(),Jl(eg,{key:1},[Je(ft(At),{data:"ID",style:{display:"flex","justify-content":"center"}}),Je(ft(At),{data:"Code"}),Je(ft(At),{data:"Type"}),Je(ft(At),{data:"Name"}),Je(ft(At),{data:"Distribution(Min)"}),Je(ft(At),{data:"Distribution(Max)"}),Je(ft(At),{data:"Span"})],64)):wb("",!0),e.tableOptions.tableName=="three"?(ua(),Jl(eg,{key:2},[Je(ft(At),{data:"Critical",renderer:l.value,style:{display:"flex","justify-content":"center"}},null,8,["renderer"]),Je(ft(At),{data:"Task Code"}),Je(ft(At),{data:"Resource Name"}),Je(ft(At),{data:"Task Name"}),Je(ft(At),{data:"Duration(Old)"}),Je(ft(At),{data:"Duration(New)"}),Je(ft(At),{data:"UnitsPerHour(Old)"}),Je(ft(At),{data:"UnitsPerHour(New)"}),Je(ft(At),{data:"Total Planned Units"})],64)):wb("",!0)]),_:1},8,["data","colWidths","colHeaders","afterGetColHeader","beforeRenderer","afterGetRowHeader","afterOnCellMouseDown"]))}};const c3e=e=>(fj("data-v-d140605b"),e=e(),cj(),e),h3e={class:"content"},d3e=c3e(()=>pt("div",{id:"luckysheet"},null,-1)),v3e={id:"tip"},y3e={__name:"Lucksheettable",props:{url:Object},setup(e){const t=e;uj(async()=>{setTimeout(async()=>{const o=t.url,i="test";r.value=!0,setTimeout(()=>{QY.transformExcelToLuckyByUrl(o,i,(a,l)=>{var s;if(a.sheets==null||a.sheets.length==0){alert("Failed to read the content of the excel file, currently does not support xls files!");return}n.value=a,r.value=!1,JY((s=window==null?void 0:window.luckysheet)==null?void 0:s.destroy)&&window.luckysheet.destroy(),window.luckysheet.create({container:"luckysheet",showinfobar:!1,data:a.sheets,title:a.info.name,userInfo:a.info.name.creator,editable:!1})})},0)},1500)});const r=fa(!1);fa("");const n=fa({});return(o,i)=>(ua(),Jl("div",h3e,[d3e,VY(pt("div",v3e,"Downloading",512),[[WY,r.value]])]))}},g3e=sj(y3e,[["__scopeId","data-v-d140605b"]]);const p3e=e=>(fj("data-v-6c26e780"),e=e(),cj(),e),m3e={class:"optimize-content"},b3e={class:"content-row"},w3e={style:{"text-transform":"capitalize",color:"rgba(130, 181, 199, 0.9)"}},S3e={class:"chip primary"},C3e={class:"chip primary"},_3e={class:"content-box"},O3e=p3e(()=>pt("h3",null,"Online Excel",-1)),R3e={class:"sheet"},E3e={class:"content-box"},T3e={class:"sub-content"},P3e={class:"content-row"},k3e=XY('<div class="legend" data-v-6c26e780><div style="display:flex;justify-content:flex-start;align-items:center;margin-right:10px;" data-v-6c26e780><div class="circle critical" data-v-6c26e780></div> Critical </div><div style="display:flex;justify-content:flex-start;align-items:center;" data-v-6c26e780><div class="circle" data-v-6c26e780></div> Non-Critical </div></div>',1),$3e={class:"table"},A3e={class:"sub-content"},I3e={class:"content-row"},M3e={class:"table"},x3e={class:"sub-content"},D3e={class:"content-row"},N3e={class:"table"},H3e={class:"content-row"},L3e={__name:"optimizedReport",setup(e){let t=fa(!1);function r(){t.value=!1}fa(!1);function n(){i.value=!1}const o=UY();zY(()=>{}),uj(()=>{f()});let i=fa(!1);function a(){o.loginStatus===!0?i.value=!0:(t.value=!1,ZY({showClose:!0,message:"Restricted to logged-in users only.",type:"error"}),t.value=!0)}const l=YY();function s(){o.SummaryData.group=="baseline"&&(console.log("触发"),o.SummaryData.group="Balanced");let _=`${o.SummaryData.group}-${o.file.name.split(".")[0]}_FrontlineExport.${o.file.name.split(".")[1]}`;Sb.getProjectReport(_,o.truefile)}let u=fa({});async function f(){o.SummaryData.group=="baseline"&&(o.SummaryData.group="Balanced");let _=`${o.SummaryData.group}-${o.file.name.split(".")[0]}_FrontlineExport.${o.file.name.split(".")[1]}`;u.value=await Sb.getUrl(_,o.truefile),console.log(u.value)}function c(){o.SummaryData.group=="baseline"&&(o.SummaryData.group="Balanced");let _=`${o.SummaryData.group}-${o.file.name.split(".")[0]}_FrontlineExport.${o.file.name.split(".")[1]}`;Sb.getExcelReport(_,o.truefile)}function h(){l.push({name:"optimizedSummary"}),o.active=2}GY((_,N)=>{_.name=="InputData"});function d(N){if(!N)return"0.00";var N=Math.round(parseFloat(N)*100)/100,V=N.toString().split(".");if(V.length==1)return N=N.toString()+".00",N;if(V.length>1)return V[1].length<2&&(N=N.toString()+"0"),N}function v(N){if(!N)return"0.0";var N=Math.round(parseFloat(N)*10)/10,V=N.toString().split(".");return V.length==1&&(N=N.toString()+".0"),N}let y=o.selectedData.tasks.filter(_=>_.durationRatio!==1).map(_=>(_.critical?_.critical=!0:_.critical=!1,{Critical:_.critical,Code:_.ID,Name:_.name,"Duration(Baseline)":v(_.remainingDuration),"Duration(New)":v(_.newDuration),Ratio:d(_.durationRatio)})),m=o.selectedData.newResources.map(_=>({ID:_.id,Code:_.ID,Type:_.type,Name:_.name,"Distribution(Min)":v(_.distribution.min),"Distribution(Max)":d(_.distribution.max),Span:d(_.distribution.span)})),w=ia(()=>o.selectedData.tasks.filter(V=>Object.keys(V.resources).length!==0).flatMap(V=>{let X=Object.values(V.resources),Y=o.selectedData.tasks.find(q=>q.id==V.id);return X.map(q=>{var Q;return{Critical:Y.critical,"Task Code":Y.ID,"Resource Name":(Q=o.selectedData.newResources.find(ne=>ne.id==q.resourceId))==null?void 0:Q.name,"Task Name":Y.name,"Duration(Old)":v(Y.plannedDuration),"Duration(New)":v(Y.newDuration),"UnitsPerHour(Old)":d(q.plannedUnitsPerHour),"UnitsPerHour(New)":d(Number(q.newUnitsPerHour)),"Total Planned Units":d(Y.plannedDuration*q.plannedUnitsPerHour)}})}));const S=Uv({data:y,colWidths:[100,245,250,250,250,250],colHeaders:["Critical","Code","Name","Duration(Baseline)","Duration(New)","Ratio"],tableName:"one"}),C=Uv({data:m,colWidths:[100,245,250,250,250,250,250,100],colHeaders:["ID","Code","Type","Name","Distribution(Min)","Distribution(Max)","Span"],tableName:"two"}),k=Uv({data:w.value,colWidths:[100,245,250,150,150,150,150,150,150],colHeaders:["Critical","Task Code","Resource Name","Task Name","Duration(Old)","Duration(New)","UnitsPerHour(Old)","UnitsPerHour(New)","Total Planned Units"],tableName:"three"});return Uv({data:w.value,colWidths:[100,245,250,150,150,150,150,150,150],colHeaders:["Resource Name","Estimated Quantity/Area (Unit)","Estimated Unit Price (Unit)","Estimated Total Cost (Unit)","Actual Quantity/Area (Unit)","Actual Unit Price (Unit)","Actual Total Cost (Unit)"],tableName:"three"}),(_,N)=>{const V=Bf("v-btn"),X=Bf("v-card-text"),Y=Bf("v-card-actions"),q=Bf("v-card"),Q=Bf("v-dialog");return ua(),Jl(eg,null,[pt("div",m3e,[pt("div",b3e,[pt("h2",null,[Fi(an(_.$t("optimizedReport.title[0]"))+"  ",1),pt("span",w3e,an(ft(o).SummaryData.group.replace("_"," ")),1),pt("div",S3e,[pt("small",null,an(ft(o).setting.Steps)+" "+an(_.$t("optimizedReport.title[1]")),1)]),pt("div",C3e,[pt("small",null,an(`${ft(o).setting.Ratio[0]*100}% - ${ft(o).setting.Ratio[1]*100}% ${_.$t("optimizedReport.title[2]")}`),1)])]),Je(V,{onClick:a,class:"row-btn"},{default:Dn(()=>[Fi(an(_.$t("optimizedReport.btn[1]")),1)]),_:1})]),pt("div",_3e,[O3e,pt("div",R3e,[Je(g3e,{url:ft(u)},null,8,["url"])])]),pt("div",E3e,[pt("div",T3e,[pt("div",P3e,[pt("h3",null,an(_.$t("optimizedReport.tableName[0]")),1)]),k3e,pt("div",$3e,[Je(oC,{tableOptions:S},null,8,["tableOptions"])])]),pt("div",A3e,[pt("div",I3e,[pt("h3",null,an(_.$t("optimizedReport.tableName[1]")),1)]),pt("div",M3e,[Je(oC,{tableOptions:C},null,8,["tableOptions"])])]),pt("div",x3e,[pt("div",D3e,[pt("h3",null,an(_.$t("optimizedReport.tableName[2]")),1)]),pt("div",N3e,[Je(oC,{tableOptions:k},null,8,["tableOptions"])])])]),pt("div",H3e,[Je(V,{onClick:h,class:"back"},{default:Dn(()=>[Fi(an(_.$t("optimizedReport.btn[0]")),1)]),_:1}),Je(V,{onClick:a,class:"report"},{default:Dn(()=>[Fi(an(_.$t("optimizedReport.btn[1]")),1)]),_:1})]),Je(Q,{onClose:n,modelValue:ft(i),"onUpdate:modelValue":N[2]||(N[2]=ne=>KY(i)?i.value=ne:i=ne),width:"auto"},{default:Dn(()=>[Je(q,{style:{"border-radius":"50px",width:"400px"}},{default:Dn(()=>[Je(X,{style:{"text-align":"center"}},{default:Dn(()=>[Fi(" Export Optimized File ")]),_:1}),Je(Y,{style:{"justify-content":"center"}},{default:Dn(()=>[Je(V,{color:"rgb(64, 170, 151)",onClick:N[0]||(N[0]=()=>{s()})},{default:Dn(()=>[Fi(" Original Format ")]),_:1}),Je(V,{color:"rgb(64, 170, 151)",onClick:N[1]||(N[1]=()=>{c()})},{default:Dn(()=>[Fi(" EXCEL ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),Je(qY,{onClose:r,dialogVisible:ft(t)},null,8,["dialogVisible"])],64)}}},U3e=sj(L3e,[["__scopeId","data-v-6c26e780"]]);export{U3e as default};
